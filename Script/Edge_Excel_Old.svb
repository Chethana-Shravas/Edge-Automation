
Public DescText,strSource_Name,strLevel2src_Name,strLevel3src_Name,intRowHandle1,blnFlag,intchildcnt,strUnit,strCategory,strTPDate
Public sLoadGrid,strWrkSpaceDateTime

Sub sOpenSTP(strParameters)

On Error Resume Next

    Dim GridControl,GridSourceTree
    Dim intTotNodeCnt
    Dim intI,intJ,intK
    Dim intRow,strObject,objEdgeMDI,strTemp
    Dim strSource_Name,strWorkspace_Name,strSTP_Name,strQC_Name,ObjGridLoad,ObjGridClose,blnFlag

    blnFlag=True
    strSource_Name=getSplitValue(strParameters,"SOURCE")''Source Name
    strQC_Name=getSplitValue(strParameters,"QCNAME")''QC Name
    strWorkspace_Name=getSplitValue(strParameters,"WORKSPACE")''Workspace Name 
    strSTP_Name=getSplitValue(strParameters,"STP")''STP Name 

'    strSource_Name="Test"
'    strQC_Name="Test_may_09(1)"
'    strWorkspace_Name="Test_may_09"
'    strSTP_Name="Test_may_09"

    strTemp="WPFObject(""SourceTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""SourceTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    Delay 8000,"Pls Wait.."
      ''First level(Source Name)
      intTotNodeCnt=GridControl.Nodes_2.Count
      For intI=0 to intTotNodeCnt-1         
          If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource_Name) then
            GridControl.Nodes_2.Item(intI).Expand(True)
            log.Message "First Level- " & GridControl.Nodes_2.Item(intI).Content.Description       
            blnFlag=False  
            Exit For
          End If
      Next
      If blnFlag = True then
        strTCRemarks="Source Node not found"
        strTestCaseResult="FAIL"
        Exit Sub
      End If
      Delay 8000,"Pls Wait.."
        blnFlag = True 
      ''Second level(QC Name)
      intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
      For intJ=0 to intTotNodeCnt-1
        If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strQC_Name) then
          GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
          log.Message "Second Level- " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description 
          blnFlag = False 
          Exit For
        End If
      Next
      If blnFlag = True then
        strTCRemarks="QC Name not found"
        strTestCaseResult="FAIL"
        Exit Sub
      End If
     Delay 8000,"Pls Wait.."
  
      blnFlag = True    
      ''Third Level(Workspace Name)  
      intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count
      For intK=0 to intTotNodeCnt-1
        If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description)=Ucase(strWorkspace_Name) then
          GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Expand(True)
          log.Message "Third Level- " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description
          blnFlag = False
          Exit For   
        End If 
      Next
      If blnFlag = True then
        strTCRemarks="Workspace not found"
        strTestCaseResult="FAIL"
        Exit Sub
      End If
      Delay 8000,"Pls Wait.."
       blnFlag = True
      ''Fourth Level(STP Name)
      intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Nodes.Count
      For intl=0 to intTotNodeCnt-1
        If Instr(Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Nodes.Item(intl).Content.Description),Ucase(strSTP_Name))>0 then
          intRow =GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Nodes.Item(intl).get_RowHandle
'          Call GridSourceTree.ClickCell(intRow, "Description") 
          Call GridControl.ClearSelectionCore
          Call GridControl.FocusViewAndRow(GridControl,intRow)
          GridControl.SetFocusOnCurrentItem
          Call GridControl.SelectRowCore(intRow)
          log.Message "Third Level- " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Nodes.Item(intl).Content.Description
          blnFlag = False
          Exit For   
        End If 
      Next    
     If blnFlag = True then
        strTCRemarks="STP Name not found"
        strTestCaseResult="FAIL"
        Exit Sub
      End If
  
      ''Open STP and Full History
       Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 6).WPFObject("BarButtonItemLinkControl", "", 1).Click
       Delay 6000,"Opening STP.. Pls wait.."
       ''Selecting Full History in STP
       Call sExcelFullHistory
   
    Set GridControl=Nothing
    Set GridSourceTree=Nothing
   
End Sub


Sub sExcelFullHistory()

  Dim strTemp,CreateSTP,PropArray,ValuesArray,strTemp1,ReplaceFile 
  Dim objProgress, objTemp,objRecovery,intCount
  'IntNumber = CInt(strCount)
  
On Error Resume Next
  'Delay 8000,"Pls wait.."
   
  'Set CreateSTP=Sys.Process("EXCEL", 2).WinFormsObject("TimeRangePickerForm") 
  'Set CreateSTP=Sys.Process("EXCEL", 2).WinFormsObject("TimeRangePickerForm")
  
  Delay 4000, "Pls Wait..."
  
  'strTemp = "WinFormsObject(""TimeRangePickerForm"")"
  'Set CreateSTP=Sys.Process("EXCEL", 2).WinFormsObject("TimeRangePickerForm")
  'Sys.Process("EXCEL", 4).WinFormsObject("TimeRangePickerForm")
  
  strTemp = "WinFormsObject(""TimeRangePickerForm"")"
  Set CreateSTP=Sys.Process("EXCEL",2).WaitChild(strTemp,120000)
  
  If CreateSTP.Exists = True  Then
    PropArray = Array("WndCaption", "Visible")
    ValuesArray = Array("Full History", True)
    Set objTemp = CreateSTP.FindChild(PropArray, ValuesArray, 50)  
    If objTemp.Exists = True Then
      objTemp.Click
      log.Message "Selected Full History Radio button"
    Else
      log.Message "Full History Radio button not found"
    End If    

    PropArray = Array("WndCaption", "Visible")
    ValuesArray = Array("Open", True)
    Set objTemp = CreateSTP.FindChild(PropArray, ValuesArray, 10)
  '  Delay 2000,"Opening STP.. Pls wait.."
     'Delay 500
    If objTemp.Exists = True Then
      objTemp.Click
    End If
    
     'Delay 40000,"Pls Wait..." 
      strTemp="WinFormsObject(""SelectFreqForm"")"      
      Set objTemp=Sys.Process("EXCEL",2).WaitChild(strTemp,40000)    
       If objTemp.Exists Then
          strTemp="WinFormsObject(""radButton1"")"
          Set objTemp=objTemp.FindChild("Name",strTemp,5)
          If objTemp.Exists = True then
            objTemp.Click
            Delay 10000,"Pls Wait..."
          End If
      End If
'     If  Ucase(Trim(strTestCase_no)) = Ucase(Trim("TC_RS_PRT13"))Then
'      strTimeDelay = 100000
'     Else
'      strTimeDelay = 10000
'     End If
      Set File = Sys.Process("EXCEL", 2).Waitchild("WPFObject(""HwndSource: CustomMessageBoxWindow"", ""Warning"")",100000)       
            If (File.Exists) Then
              strTemp = "WPFObject(""Button_Yes"")"         
                 Set objYes = File.FindChild("Name", strTemp,50, True)
                 If objYes.Exists = True Then
                    objYes.Click
                 End If
                 Delay 5000              
            End If  
   Else
    log.Message "STP File not found"
    strTCRemarks="STP File not found"
    blnCriticalErrorFound = True
    strCriticalError = "Unable to find STP file"
    strTestCaseResult = "FAIL"
    blnSTPfile=True
    Call ExcelProcessKill
    Exit Sub
  End If

  Set CreateSTP=Nothing  
  Set objTemp=Nothing
End Sub

Sub ExcelProcessKill()
Dim objArray,oSTP_ExcelObj,ReplaceFile,strTemp

objArray = Sys.FindAllChildren("ProcessName","EXCEL", 1,True)
For i=0 to ubound(objArray)
  log.Message objArray(i).FullName
  set oSTP_ExcelObj = objArray(i).FindChild("WndCaption", "*RUN*",1,True)
  If oSTP_ExcelObj.Exists = False Then
    objArray(i).Terminate()
  End If
Next

End Sub

Sub sLoadLayout()

Dim objEdge,strTemp,objTemp

On Error Resume Next

 ' strEnvi = "Edge ( US Integration )" 
   
  strTemp="WPFObject(""LayoutPanel"", """", 1)"
  Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,50,True)
  If objTemp.Exists = False then  
    Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("RibbonControl").WPFObject("RibbonSelectedPageControl", "", 1).WPFObject("RibbonPagesControl", "", 1).WPFObject("RibbonPageGroupsControl", "", 1).WPFObject("RibbonPageGroupControl", "", 1).WPFObject("BarItemLinkInfo", "", 7).WPFObject("BarButtonItemLinkControl", "", 1).Click
    Call sEdgeProcessor
    strTemp="WPFObject(""LayoutPanel"", """", 1)"
    Set objTemp=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,true)
    If objTemp.Exists = False then
      strTestCaseResult= "FAIL"
      Exit Sub
    End If
    strTCRemarks="Layout Form Loaded"
   ElseIF objTemp.Exists = True then   
      'Msgbox objTemp.Caption
      If objTemp.Caption <> "Layout" then
        Call sCloseLayout()
        Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("RibbonControl").WPFObject("RibbonSelectedPageControl", "", 1).WPFObject("RibbonPagesControl", "", 1).WPFObject("RibbonPageGroupsControl", "", 1).WPFObject("RibbonPageGroupControl", "", 1).WPFObject("BarItemLinkInfo", "", 7).WPFObject("BarButtonItemLinkControl", "", 1).Click
        Call sEdgeProcessor
        strTemp="WPFObject(""LayoutPanel"", """", 1)"
        Set objTemp=objEdge.WaitChild(strTemp,50000)
        If objTemp.Exists = False then
          strTestCaseResult = "FAIL"
          Exit Sub
        End If
        strTCRemarks="Layout Form Loaded successfully"
        log.message "Layout Form Loaded successfully"
        strTestCaseResult = "PASS"
      End if 
  End If
  
End Sub

Sub sFindTree(strParameters,sLoadGrid)
'Sub sFindTree()

On Error Resume Next
  
  Dim strSource_Name,strQC_Name,strWorkspace_Name
  Dim blnFlag,GridControl,GridSourceTree
  Dim intTotNodeCnt,intI,intJ,intK,intRow
  
  blnFlag = True
  
  strSource_Name=getSplitValue(strParameters,"SOURCE")''Level1 Source 
  strQC_Name=getSplitValue(strParameters,"QCNAME")''Level2 Source 
  strWorkspace_Name=getSplitValue(strParameters,"WORKSPACE")''Workspace Name 
  
'  strSource_Name="Test"
'  strQC_Name="Automation_Source01"
'  strWorkspace_Name="DM"
'  sLoadGrid="Source"

  
  Delay(2000)
  'Setting grid Objects
  if sLoadGrid="New" then 
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("LayoutTreeControl").WPFObject("LayoutTreeListView")
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("LayoutTreeControl")
  Elseif sLoadGrid="Edit" then 
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("LayoutTreeListControl").WPFObject("LayoutTreeListView")
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("LayoutTreeListControl")
  Elseif sLoadGrid="Source" then 
    strTemp="WPFObject(""SourceTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,true)
    strTemp="WPFObject(""SourceTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,true)  
 End if 
  Delay(5000)
  ''First level(Source Name)
  intTotNodeCnt=GridControl.Nodes_2.Count
  For intI=0 to intTotNodeCnt-1         
      If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource_Name) then
        GridControl.Nodes_2.Item(intI).ExpandAll
        intRow =GridControl.Nodes_2.Item(intI).get_RowHandle
        Call GridControl.ClearSelectionCore
        Call GridControl.FocusViewAndRow(GridControl,intRow)
        GridControl.SetFocusOnCurrentItem
        Call GridControl.SelectRowCore(intRow)
        log.Message "First Level- " & GridControl.Nodes_2.Item(intI).Content.Description       
        blnFlag=False  
        Exit For
      End If
  Next
  If blnFlag = True then
    strTCRemarks="Source Node not found"
    strTestCaseResult="FAIL"
    Exit Sub
  End If
  Delay(5000)
  blnFlag = True 
  ''Second level(QC Name)
  intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
  For intJ=0 to intTotNodeCnt-1
    If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strQC_Name) then
      GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).ExpandAll 
      intRow =GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
        Call GridControl.ClearSelectionCore
        Call GridControl.FocusViewAndRow(GridControl,intRow)
        GridControl.SetFocusOnCurrentItem
        Call GridControl.SelectRowCore(intRow)  
      log.Message "Second Level- " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description 
      blnFlag = False 
      Exit For
    End If
  Next
  If blnFlag = True then
    strTCRemarks="QC Name not found"
    strTestCaseResult="FAIL"
    Exit Sub
  End If
  Delay(5000)
  blnFlag = True    
  ''Third Level(Workspace Name)  
  intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count
  For intK=0 to intTotNodeCnt-1
    If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description)=Ucase(strWorkspace_Name) then
      GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).ExpandAll
      intRow =GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).get_RowHandle
      if sLoadGrid="New" then 
        Call GridControl.ClearSelectionCore
        Call GridControl.FocusViewAndRow(GridControl,intRow)
        GridControl.SetFocusOnCurrentItem
        Call GridControl.SelectRowCore(intRow)
      elseif sLoadGrid="Edit" then 
        Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("LayoutTreeListControl").WPFObject("LayoutTreeListView").WPFObject("HierarchyPanel", "", 1).WPFObject("GridRow", "", 3).WPFObject("ScrollablePart").WPFObject("CellItemsControl", "", 1).WPFObject("GridCellContentPresenter", "", 1).WPFObject("TextEdit", "", 1).Click
      elseif sLoadGrid="Source" then
        Call GridControl.ClearSelectionCore
        Call GridControl.FocusViewAndRow(GridControl,intRow)
        GridControl.SetFocusOnCurrentItem
        Call GridControl.SelectRowCore(intRow)
      End if  
      log.Message "Third Level- " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description     
      blnFlag = False
      Exit For   
    End If 
  Next
  Delay(2000)
'  If blnFlag = True then
'    strTCRemarks="Workspace not found"
'    strTestCaseResult="FAIL"
'    Exit Sub
'  End If
End Sub

Sub sLoadSource(strParameters)

On Error Resume Next

  Dim strTemp,strObject
  Dim ObjGridLoad,ObjGridClose,objEdgeMDI,objTemp,objEdge

  'Open Source Module
  Call sHome_Source()
  Call sFindtree(strParameters,"Source")
   
  Delay 2000,"Opening Source.. Pls wait.."
   ''Open STP and Full History
  Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 6).WPFObject("BarButtonItemLinkControl", "", 1).WPFObject("ContentControlEx", "Open Global STP", 2).Click
  'Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 6).WPFObject("BarButtonItemLinkControl", "", 1).Click
  Delay 2000,"Opening STP.. Pls wait.."
   ''Selecting Full History in STP
   Call sExcelFullHistory()
      
   If Ucase(strTestCase_no) = Ucase("TC_BENCHMARK_STP") OR Ucase(strTestCase_no) = Ucase("TC_BENCHMARK_STP40")  Then
      Delay 20000, "Please Wait Form is loading"
   Else
      Delay 10000, "Please Wait Form is Loading"
   End If

End Sub

Sub sPendingSTP(strParameters)

On Error Resume Next

  Dim edgeClient
  Dim objGridControl,objTemp
  Dim tableView,strTemp,StrSource,StrCountryname
  Dim objArray,oSTP_ExcelObj,ReplaceFile
  
  StrCountryname=getSplitValue(strParameters,"COUNTRY")''Country Name
  StrSource=getSplitValue(strParameters,"SOURCE")''Source
  
'   StrCountryname="Country: Test"
'   StrSource="Automation"
   
  Set edgeClient = Aliases.EdgeClient
 
  Call sAutoHideGroupName("Pending STP")

  strTemp="WPFObject(""LayoutPanel"", """", 1)"
  Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").FindChild("Name",strTemp,50)
  If objTemp.Exists = TRUE then
    Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutPanel", "", 1).Click
    Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("DockPanel", "", 1).WPFObject("StackPanel", "", 1).WPFObject("Button", "Refresh", 1).Click
    Call sEdgeProcessor
  End if 
  
  Set objGridControl =Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("DockPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("GridControl")
  If objGridControl.Exists = TRUE then
    Call objGridControl.ClickColumnHeaderRXY("Top Source Description", 101, 12)
  End if

 ' "Show Search Panel"
  Dim objEdgeFilter
  set objEdgeFilter= Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1)
  strTemp="WPFObject(""ContentControlEx"", ""Show Search Panel"", 2)"
  Set objTemp=objEdgeFilter.FindChild("Name",strTemp,50)
  If objTemp.Exists = TRUE then
   Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 13).WPFObject("BarButtonItemLinkControl", "", 1).WPFObject("ContentControlEx", "Show Search Panel", 2).Click
  Else
    strTestCaseResult = "ABORT"
    Exit Sub  
  End If
  
'  Delay(5000)
  If objGridControl.Exists = TRUE then
    Set  tableView = objGridControl.SourceLogTableView
    If tableView.Exists = TRUE then
      Call tableView.Click(95, 21)
      Delay(8000)
      Call tableView.Keys(StrCountryname)
      'Delay(18000)
      Call objGridControl.SelectAll
      Call objGridControl.ExpandGroup(0)

      Delay(30000)
      Call tableView.Click(95, 21)
      Call tableView.Keys("[Home]![End][Del]")
      'Delay(20000)
      Call tableView.Click(95, 21)
      Call tableView.Keys(StrSource)
      Call tableView.Click(83, 17)
      Delay(6000)
      Call tableView.Drag(277, 251, 7, -134)
      Call tableView.Drag(277, 262, 4, -151)
      Call objGridControl.ClickCell(0, "Top Source Description")
      Call objGridControl.ClickCellR(0, "Top Source Description")
    End if 
  End if
  Log.Message("Pending STP and Open STP are Matched")
  
  set objEdgeFilter= Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("ContextMenu", "", 1)
  strTemp="WPFObject(""MenuItem"", ""Drop"", 3)"
  Set objTemp=objEdgeFilter.FindChild("Name",strTemp,50)
  If objTemp.Exists = TRUE then
    'Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("ContextMenu", "", 1).WPFObject("MenuItem", "Drop", 2).Click
    Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("ContextMenu", "", 1).WPFObject("MenuItem", "Drop", 3).Click
  Else
    strTestCaseResult = "ABORT"
    Exit Sub  
  End If

  Dim strOk,strClose

  strTemp="WPFObject(""DXMessageBox"", """", 1)"
  Set strOk=Sys.Process("EdgeClient").WPFObject("HwndSource: WindowContentHolder", "Confirm").WPFObject("WindowContentHolder", "Confirm", 1).WPFObject("NonLogicalDecorator", "", 1).WPFObject("ThemedManagedContentPresenter", "", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WaitChild(strTemp,500000)
  If strOk.Exists Then
    SYS.Keys "[Enter]"
  End If

 ' Set strClose=Sys.Process("EdgeClient").WPFObject("HwndSource: WindowContentHolder", "", 1).WPFObject("WindowContentHolder", "", 1).WPFObject("NonLogicalDecorator", "", 1).WPFObject("ThemedManagedContentPresenter", "", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground")
  strTemp="WPFObject(""PART_ContainerContent"")"
  Set strClose=Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "Todo List").WPFObject("CustomMessageBoxWindow", "Todo List", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,500000)
  If strClose.Exists Then
     SYS.Keys "[Enter]"
  End If
  Call sEdgeProcessor

  strTCRemarks = "Dropped STP Successfully"
   
  objArray = Sys.FindAllChildren("ProcessName","EXCEL", 5,True)
  For i=0 to ubound(objArray)
    log.Message objArray(i).FullName
    set oSTP_ExcelObj = objArray(i).FindChild("WndCaption", "*RUN*",1,True)
    If oSTP_ExcelObj.Exists = True Then
    Else
      objArray(i).Close
    End If
  Next
  'Delay(5000)
   If tableView.Exists = TRUE then
    Set  tableView = objGridControl.SourceLogTableView
    Call tableView.Click(95, 21)
    Call tableView.Keys("[Home]![End][Del]")
    Delay(10000)
    Call tableView.Click(95, 21)
    Call tableView.Keys(StrCountryname)
   End if 
   
   'Delay(20000)
   If objGridControl.Exists = TRUE then
    Call objGridControl.ClickCell(0, "Top Source Description")
    Call objGridControl.ClickCellR(0, "Top Source Description")
   End if
   
  set objEdgeFilter= Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("ContextMenu", "", 1)
  strTemp="WPFObject(""MenuItem"", ""Open Global STP"", 1)"
  'strTemp="WPFObject(""MenuItem"", ""Open STP"", 1)"
  Set objTemp=objEdgeFilter.FindChild("Name",strTemp,50)
  If objTemp.Exists = TRUE then
    'Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("ContextMenu", "", 1).WPFObject("MenuItem", "Open STP", 1).Click
    Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("ContextMenu", "", 1).WPFObject("MenuItem", "Open Global STP", 1).Click
  Else
    strTestCaseResult = "ABORT"
    Exit Sub  
  End If
  
  Delay 3000,"Opening STP.. Pls wait.."
   'Selecting Full History in STP
  Call sExcelFullHistory
  Delay 6000,"Opening STP.. Pls wait.."
  
  strTCRemarks =strTCRemarks & "<br />" & "Dropped STP Successfully"
   ' "Hide Search Panel"
  Call tableView.Click(202, 61)
  Call tableView.Drag(277, 123, 5, -20)
  Call tableView.Click(278, 123)
  Call objGridControl.CollapseGroup(0)

  Call objGridControl.ClickColumnHeaderRXY("Top Source Description", 101, 12)
  
  set objEdgeFilter= Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1)
  strTemp="WPFObject(""ContentControlEx"", ""Hide Search Panel"", 2)"
  Set objTemp=objEdgeFilter.FindChild("Name",strTemp,50)
  If objTemp.Exists = TRUE then
    Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 13).WPFObject("BarButtonItemLinkControl", "", 1).WPFObject("ContentControlEx", "Hide Search Panel", 2).Click
  Else
    strTestCaseResult = "ABORT"
    Exit Sub  
  End If
  
  objArray = Sys.FindAllChildren("ProcessName","EXCEL", 5,True)
  For i=0 to ubound(objArray)
    log.Message objArray(i).FullName
    set oSTP_ExcelObj = objArray(i).FindChild("WndCaption", "*RUN*",1,True)
    If oSTP_ExcelObj.Exists = True Then
    Else
      objArray(i).Close
    End If
  Next
  'Delay(5000)
  
  strTCRemarks = strTCRemarks & "<br />" & "Checked in PendingSTP Successfully"
  Set objGridControl = Nothing
  'Delay(5000)
   
  Call SClosesource()
  Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).Click
End Sub 

' ****************************************************************************
Sub LogintoCDM(keyword, UserSettings) 
  ' Open Run.xls.  If not present create one
  dim aArray          ' To segregate username/password/rememberYesNo/loginYesNo from test data
  dim aSubArray       ' To further split parameter=value strings.
  dim sUserName       ' CDM Username
  dim sPassWord       ' CDM Password
  dim blnRemember     ' Remember Username - Yes/No
  dim blnLogin        ' Login into CDM - Yes (login)/No (cancel)
  dim intI            ' Temp integer
  dim PicObj
  dim oTemp 
  Dim sClearcache,sCheck,sURL

On Error Resume Next
  blnRemember = False   ' Remember username Password is unchecked by default.
  blnLogin = True       ' Login by default unless specified   
  blnCDM_Login = False  ' Object not loaded
  ' Click on CDM Login  ' using Sys.Keys
  Log.Message("Executing login - keyword " & keyword)
  Log.Message ("Current active window : " & objExcel.ActiveWindow.caption)
  ' If already logged in - logout -
  If fCDM_Already_Exists = True Then 
    Delay status_wait, "CDM application is running.. Performing logout .. Please wait.."  
    ' release all objects
    Call LogOutCDM(keyword)
  End  If   
 
' Parse username, password, rememberYesNo, LoginYesNo
  strTemp = cstr(UserSettings)      ' From Test.xls - test data for login keyword
  If strTemp <> "" Then   ' Login using credential from Test sheet
    aArray = split(strTemp,Chr(10)) ' Split test data first by Alt + Enter
    For intI =0 to UBound(aArray) ' Split array and get all usersettings into respective variables
      aSubArray = split(aArray(intI),"=")
      If trim(ucase(aSubArray(0))) = "USERNAME" Then 
        sUserName = aSubArray(1)
      ElseIf trim(ucase(aSubArray(0))) = "PASSWORD" Then 
        sPassWord = aSubArray(1)
      ElseIf trim(ucase(aSubArray(0))) = "REMEMBER" Then 
        If Trim(Ucase(aSubArray(1))) = "ON" Then 
          blnRemember = True
        End  If                 
      ElseIf trim(ucase(aSubArray(0))) = "SUBMIT" Then 
        If Trim(Ucase(aSubArray(1))) = "OFF" Then 
          blnLogin = False
        End  If                 
     ElseIf trim(ucase(aSubArray(0))) = "CHECK" Then 
        sCheck=Ucase(aSubArray(1))   
     ElseIf trim(ucase(aSubArray(0))) = "CLEARCACHE" Then 
        sClearCache=Ucase(aSubArray(1)) 
     ElseIf trim(ucase(aSubArray(0))) = "URL" Then 
        sURL=aSubArray(1)
     End  If 
    Next
  End  If   
 
  If sCheck="LAUNCH" Then 
       If fCDM_MDI_Loaded=true Then 
            Call LogOutCDM(keyword)
       End  If 
  End  If 
 If  fCDM_Process_Running = False Then  ' Make sure CDM MDI is loaded
      Delay status_wait, "CDM application not started.. Launching CDM"
      Call sLaunch_CDM  
 End  If 
 If sCheck="LAUNCH" Then      
     Exit Sub 
 End  If 
 
 If sClearCache="TRUE" Then 
    'To close the Login form
    
    Set Otemp=Sys.Process("ISI.CeicDataManager.Startup").WaitChild("WinFormsObject(""Login_Dialog"")",2000)
    If Otemp.Exists=true Then 
       Otemp.Close
    End  If 
    'To do Clear Cache function 
   objCDM_MDI.Activate
   delay 100, "ClearCache" 
   objCDM_MDI.Keys("~n[Down]a")   
   delay 50, "Clearing Cache"
   set otemp= Sys.Process("ISI.CeicDataManager.Startup").Waitchild("WinFormsObject(""ClearCacheMsgBox_Form"")",2000) 
      If otemp.exists=true Then 
          otemp.WinFormsObject("TableLayoutPanel2").WinFormsObject("UiButton_OK").click()
      else
          strTestCaseResult="ABORT"
          exit sub
      End  If 
  End  If  

  If sURL <> "" Then 
      'To close the Login form
      Set Otemp=Sys.Process("ISI.CeicDataManager.Startup").WaitChild("WinFormsObject(""Login_Dialog"")",2000)
      If Otemp.Exists=true Then 
         Otemp.Close
      End  If 
      ' Open connection setup and change URL
      If fCDM_MDI_Loaded=true then
        objCDM_MDI.Activate
      End If
      objCDM_MDI.Keys("~nu")   
      set otemp= Sys.Process("ISI.CeicDataManager.Startup").waitchild("WinFormsObject(""ConnectionSetup_Form"")",2000) 
        if otemp.exists=true then
           delay(50)         
           otemp.WinFormsObject("UserProxySettings1").WinFormsObject("ComboBox_WebServiceURL").WinFormsObject("TextBox", "").wText = sURL
           otemp.WinFormsObject("Panel1").WinFormsObject("Button_OK").click
         end if
  End  If  
  If fIs_Login_Loaded = False Then   
    'Delay status_wait, "CDM MDI found.. but no login form.  Opening Login form"
    Call ExcelActions("LOGIN") '
  Else
    Delay status_wait, "CDM Login form found!"
  End  If   
  If keyword = "LOGIN" Then  
    If sUsername = "" and sPassWord = "" Then     ' Login details not provided
      sUsername = strUsername
      sPassWord = strPassword
      Log.Message("Login values not defined in Test sheet. Using values from INI.")
    End  If 
  End  If 
  ' Load Login Page
  blnCDM_Login = True   
  strTemp = "WinFormsObject(""Login_Dialog"")"
  Delay Status_Wait, "CDM Login page is getting loaded.  Please wait... - " & Status_Wait & "ms" 
  Set objCDM_login = Sys.Process("ISI.CeicDataManager.Startup").WaitChild(strTemp, LoginPage_Wait)  ' reset to 60 seconds in final version
  If objCDM_login.Exists = True Then 
  Else 
    strTemp = "CDM login not loaded as 'Login_Dialog'.  Please wait while we try to search for CDM login instance.." & Status_Wait & "ms"
    Delay Status_Wait, strTemp
    Log.Message(strTemp)
    Set objCDM_login = Sys.Process("ISI.CeicDataManager.Startup").Find("WebCaption","CDM Login",1,True)   
    ' Login page has not loaded yet - Look for connectivity issue.
    If objCDM_login.Exists = True Then 
      Log.Message (objCDM_login.Name & " Loaded successfully")
    Else
      Log.Message ("Couldnot find login page. Waited for more than " & LoginPage_Wait & " ms") 
      If sLookFor_ErrorMsg = True Then 
        ' Error before loading login page
        call sCancel_Login
        Exit Sub
      End  If 
    End  If 
  End  If 
  If keyword = "IS_LOGIN_AUTO_FILLED" or keyword = "IS_LOGIN_EMPTY" or keyword = "CHECK_PASSWORD_PROPERTY" Then 
    Log.Message("Login page is loaded.. but no need to login")
    Exit sub  ' don't fill anything. let's check If values are filled up or empty
  End  If 
  If strTestCaseResult = "PASS" AND objCDM_Login.Exists = True Then 
    objCDM_login.WinFormsObject("TxBox_User").Clear
    objCDM_login.WinFormsObject("TxBox_Pass").Clear
    objCDM_login.WinFormsObject("UiCheckBox_RememberUser").Checked = False  
    ' Intiate Login page controls
    ' Login using give credentials
    objCDM_login.WinFormsObject("TxBox_User").Text = sUserName
    objCDM_login.WinFormsObject("TxBox_Pass").Text = sPassWord
    If blnRemember = True Then  
      objCDM_login.WinFormsObject("UiCheckBox_RememberUser").Checked = True   
    Else
      ' Unchecked by default
    End  If  

    If blnLogin = False Then  
      objCDM_login.WinFormsObject("Panel1").WinFormsObject("Button_Cancel").Click
      blnCDM_Login = False 
      strTCRemarks = strTCRemarks & "  " & "'Cancel' button in login window is working fine"
      Delay Status_wait, "Please wait.. Unloading Login Window Object"
      ' See If login window goes off
      If objCDM_Login.Exists = True Then 
        strTestCaseResult = "FAIL"
        strTCRemarks = strTCRemarks & "  " & "Failed to cancel login window"
      End  If   
    Else         
      If sExStart="LOGIN" Then 
         dtTCStartTime = aqDateTime.Now
         If blnTimeRecorded = False Then
          Watch.Start
         End IF
       End  If  
      objCDM_login.WinFormsObject("Panel1").WinFormsObject("Button_OK").Click         ' Login by default 

      '.WinFormsObject("Panel1")
  
      blnCDM_Login = False   
      If keyword = "LOGIN" or keyword = "CRM_VALID_CREDENTIALS" Then 
        Log.Message ("Proceeding to verify CDM Load")
        Call VerifyCDMLoad(keyword)
      End  If  
    End  If 
  Else
    ' Abort Login & goto next testcase
    Set PicObj = Utils.Picture
    Set PicObj = Sys.Desktop.ActiveWindow.Picture()
    If strTestCase_No <> "" Then
      PicObj.SavetoFile(strLogFolder & "Screenshots\" & strTestCase_No &  "_" & picCount & ".jpg")
      picCount = picCount + 1     
    Else
      PicObj.SavetoFile(strLogFolder & "Screenshots\" & framework_error & ".jpg")  
    End IF   
    Log.Message ("Failed to load Login Window.")                       
    strTestCaseResult = "ABORT"     
    Exit Sub 
  End  If 
If Err.Number <> 0 Then 
  Log.Error("Error in 'LoginToCDM' - " & Err.Description)
  Err.Clear
End  If  
End Sub 

' Purpose : To Log out form CDM.
Sub LogOutCDM(keyword)  

' Author        : Guru
' Date          : 14-09-2009
' Last Modified : 10-05-2012 - By Mohanakshi

On Error Resume Next
dim oTemp,i,j
delay Status_Wait, "Preparing to Exit CDM.  Please wait.." & Status_Wait & "ms"
  
 If fCDM_MDI_Loaded = True  Then 
      strTemp = "WinFormsObject(""Login_Dialog"")"
      Delay Status_Wait, "Looking for Login page..   Please wait... " 
      Set objCDM_login = Sys.Process("ISI.CeicDataManager.Startup").WaitChild(strTemp, 3000)  ' reset to 60 seconds in final version
      If objCDM_login.Exists = True Then 
        Sys.Process("ISI.CeicDataManager.Startup").WinFormsObject("Login_Dialog").WinFormsObject("Panel1").WinFormsObject("Button_Cancel").click
      End  If   
  Else
      Exit Sub ' Nothing to logout
  End  If 
  for J=0 to 2
 ' Call Log.Message("Executing [LogOutCDM] - Keyword " & keyword)
  objCDM_MDI.Activate
  
  objCDM_MDI.Keys "~[F4]"   ' Closing MDI 
  'wait for the object to load.
  Delay(2000)
  strTemp = "WinFormsObject(""TableLayoutPanel1"")"
  Set objTemp = Sys.Process("ISI.CeicDataManager.Startup").WinFormsObject("CDMYesNoDialog").Waitchild(strTemp,Status_LongWait)  ' Wait for 5 Secs.
  set otemp=Sys.Process("ISI.CeicDataManager.Startup")
  If objTemp.Exists=True Then 
    Log.Message (objTemp.Name & " Loaded successfully")
    objTemp.WinFormsObject("UiButton_Yes").Click
    If sExStart="LOGOUT" Then 
  
     If blnTimeRecorded = False Then
        Watch.Start
     End IF
     'msgbox dtTCStartTime
    End  If 
   ' Delay Status_Wait,"Unloading CDM - Thank YOU!"
  Else  
    Log.Warning "Exit confirmation not loaded"
    Delay Status_LongWait,"Pls wait while CDM is unloaded"    
  End  If 
  blnCDM_MDI = False
 I=0
      while I<500 and otemp.Exists=true 
         I=I+1
         Delay(100)
    
      wEnd 
      If i<500  Then 
         exit for
      End  If 
  
  next
  If sExStop="PROCEND" Then  
     Watch.Stop
     blnTimeRecorded = True
     'msgbox dtTCEnd Time
  End  If 
     
  If fCDM_Process_Running = True Then 
    If sLookFor_ErrorMsg = True Then 
    ':( some problem
    End  If 
  End  If 

If Err.Number > 0 Then 
  Log.Error("Error in 'LogOutCDM' - " & Err.Description)
  Err.Clear
End  If  
End Sub 


Sub sPendingMGReleased(strParameters)
On Error Resume Next

  Dim objGridControl,objTemp,objArray,i
  Dim StrCountryname,StrSource,strOk,strTemp
  Dim edgeClient,gridControl,tableView
  Dim objEdgeFilter

'  StrCountryname="Country: Test"
'  StrSource="QC_Test"
  

'  StrCountryname="Country: Test"
'  StrSource="Automation"

  StrCountryname=getSplitValue(strParameters,"COUNTRY")''Country Name
  StrSource=getSplitValue(strParameters,"SOURCE")''Source
 
  Call sAutoHideGroupName("Pending MG/Released")
  'Delay(10000)
  
  'Set objGridControl =Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("DockPanel", "", 1).WPFObject("GridControl")
  
  strTemp="WPFObject(""GridControl"")"
  Set objGridControl=Sys.Process("EdgeClient").FindChild("Name",strTemp,60,True)
  'Delay(2000)
  if objGridControl.Exists = TRUE then 
    Call objGridControl.ClickColumnHeaderRXY("Top Source Description",70, 10)
  End if 
  
  set objEdgeFilter= Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1)
  strTemp="WPFObject(""ContentControlEx"", ""Hide Search Panel"", 2)"
  Set objTemp=objEdgeFilter.FindChild("Name",strTemp,50)
  If objTemp.Exists = TRUE then
    Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 13).WPFObject("BarButtonItemLinkControl", "", 1).WPFObject("ContentControlEx", "Hide Search Panel", 2).Click 
  End If
  if objGridControl.Exists = TRUE then 
    Call objGridControl.ClickColumnHeaderRXY("Top Source Description",70, 10)
  End if
  set objEdgeFilter= Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1)
  strTemp="WPFObject(""ContentControlEx"", ""Show Search Panel"", 2)"
  Set objTemp=objEdgeFilter.FindChild("Name",strTemp,50)
  If objTemp.Exists = TRUE then
    Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 13).WPFObject("BarButtonItemLinkControl", "", 1).WPFObject("ContentControlEx", "Show Search Panel", 2).Click
  Else
    strTestCaseResult = "ABORT"
    Exit Sub  
  End If
  
  Delay(5000)
  Set  tableView = objGridControl.TodoListCounterTableView
  if tableView.Exists = TRUE then 
    Call tableView.Click(95, 21)
    Delay(2000)
    Call tableView.Keys(StrCountryname)
  End if 
 
  If objGridControl.ExpandGroup(0)=False then
    Call objGridControl.ExpandGroup(0)
  End If 
 
  
  Call sCloseSource()
  'Delay(10000)
  ''Opening Source
  if objGridControl.Exists = TRUE then 
    Call objGridControl.ClickCell(0, "Top Source Description")
    Call objGridControl.ClickCellR(0, "Top Source Description")
  End if
'  Delay(15000)
'  SYS.Keys "[Down][Enter]"

  set objEdgeFilter= Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("ContextMenu", "", 1)
  strTemp="WPFObject(""MenuItem"", ""Open Source"", 1)"
  Set objTemp=objEdgeFilter.FindChild("Name",strTemp,50)
  If objTemp.Exists = TRUE then
    Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("ContextMenu", "", 1).WPFObject("MenuItem", "Open Source", 1).Click
  Else
    strTestCaseResult = "ABORT"
    Exit Sub  
  End If
  Call sEdgeProcessor
   
  Set objGridControl =Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("DockPanel", "", 1).WPFObject("GridControl")
  Call objGridControl.ClickCell(0, "Top Source Description")
  Call objGridControl.ClickCellR(0, "Top Source Description")
  
  'Delay(15000)
  
  '' Force Release
  set objEdgeFilter= Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("ContextMenu", "", 1)
  strTemp="WPFObject(""MenuItem"", ""Force Release"", 4)"
  Set objTemp=objEdgeFilter.FindChild("Name",strTemp,50)
  If objTemp.Exists = TRUE then
    IF objTemp.Enabled = True then
      Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("ContextMenu", "", 1).WPFObject("MenuItem", "Force Release", 4).Click
     
    Else
      Call objGridControl.ClickColumnHeaderXY("Not Released", 110, 13)
      Delay(1000)
      Set objGridControl =Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("DockPanel", "", 1).WPFObject("GridControl")
      Call objGridControl.ClickCell(0, "Top Source Description")
      Call objGridControl.ClickCellR(0, "Top Source Description") 
      
      set objEdgeFilter= Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("ContextMenu", "", 1)
      strTemp="WPFObject(""MenuItem"", ""Force Release"", 3)"
      Set objTemp=objEdgeFilter.FindChild("Name",strTemp,50)
      If objTemp.Exists = TRUE then
        IF objTemp.Enabled = True then 
          Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("ContextMenu", "", 1).WPFObject("MenuItem", "Force Release", 3).Click
        Else
          strTCRemarks =  "Force Release is disabled"
          strTestCaseResult = "ABORT"
          Exit Sub        
        End if 
      Else
        strTCRemarks =  "Force Release is disabled"
        strTestCaseResult = "ABORT"
        Exit Sub
      End if    
    End if 
  Else
    strTCRemarks =  "Force Release is not found"
    strTestCaseResult = "ABORT"
    Exit Sub  
  End If
  

  strTemp="WPFObject(""DXMessageBox"", """", 1)"
  Set strOk=Sys.Process("EdgeClient").WPFObject("HwndSource: WindowContentHolder", "Confirm").WPFObject("WindowContentHolder", "Confirm", 1).WPFObject("NonLogicalDecorator", "", 1).WPFObject("ThemedManagedContentPresenter", "", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WaitChild(strTemp,850000)
  If strOk.Exists Then
    SYS.Keys "[Enter]"
  End If
         
  strTemp="WPFObject(""PART_ContainerContent"")"
  'Set strOk=Sys.Process("EdgeClient").WPFObject("HwndSource: WindowContentHolder", "Todo List").WPFObject("WindowContentHolder", "Todo List", 1).WPFObject("NonLogicalDecorator", "", 1).WPFObject("ThemedManagedContentPresenter", "", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WaitChild(strTemp,990000)
  Set strOk=Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "Todo List").WPFObject("CustomMessageBoxWindow", "Todo List", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,990000)
  If strOk.Exists Then
    SYS.Keys "[Enter]"
  End If
   strTCRemarks =  "Force Released Successfully"
   
   ''Opening STP
  Call sEdgeProcessor
  If objGridControl.Exists = TRUE then
    Call objGridControl.ClickCell(0, "Top Source Description")
    Call objGridControl.ClickCellR(0, "Top Source Description")
  End if 

  set objEdgeFilter= Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("ContextMenu", "", 1)
  strTemp="WPFObject(""MenuItem"", ""Open STP"", 2)"
  Set objTemp=objEdgeFilter.FindChild("Name",strTemp,50)
  If objTemp.Exists = TRUE then
    Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("ContextMenu", "", 1).WPFObject("MenuItem", "Open STP", 2).Click
  Else
    strTestCaseResult = "ABORT"
    Exit Sub  
  End If
  
  Delay 900000,"Opening STP.. Pls wait.."
  strTCRemarks = strTCRemarks & "<br />" & "Opened STP Successfully"
   
 ' Delay (2000)
   If objGridControl.Exists = TRUE then
      Call objGridControl.ClickColumnHeaderXY("Top Source Description", 82, 15)
      Call objGridControl.ClickColumnHeaderRXY("Top Source Description", 82, 15)
   End if 

   '"Hide Search Panel"

  set objEdgeFilter= Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1)
  strTemp="WPFObject(""ContentControlEx"", ""Hide Search Panel"", 2)"
  Set objTemp=objEdgeFilter.FindChild("Name",strTemp,50)
  If objTemp.Exists = TRUE then
    Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 13).WPFObject("BarButtonItemLinkControl", "", 1).WPFObject("ContentControlEx", "Hide Search Panel", 2).Click
  Else
    strTestCaseResult = "ABORT"
    Exit Sub  
  End If
   
  strTCRemarks = strTCRemarks & "<br />" & "Checked in PendingMG/REleased Successfully"
  
  objArray = Sys.FindAllChildren("ProcessName","EXCEL", 5,True)
  For i=0 to ubound(objArray)
    log.Message objArray(i).FullName
    set oSTP_ExcelObj = objArray(i).FindChild("WndCaption", "*RUN*",1,True)
    If oSTP_ExcelObj.Exists = True Then
    Else
      objArray(i).Close
    End If
  Next
  
  Set objGridControl=Nothing
  Call SClosesource()
  Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).Click
End Sub 

Sub sUpdatelog(strParameters)
On Error Resume Next
  Dim edgeClient
  Dim objGridControl,objTemp,objAutoHide
  Dim tableView,strTemp,StrSource,StrCountryname,intHeader,objFilter
  Dim layoutPanel,gridControl
  
  StrCountryname=getSplitValue(strParameters,"COUNTRY")''Country Name
  StrSource=getSplitValue(strParameters,"SOURCE")''Source
' 
'  StrCountryname="Country: Test"
'  StrSource="Automation"

  Call sAutoHideGroupName("Update Log")
  'Delay(10000)
  
  strTemp="WPFObject(""LayoutPanel"", """", 1)"
  Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").FindChild("Name",strTemp,50)
    If objTemp.Exists = TRUE then
    Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutPanel", "", 1).Click
    Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("DockPanel", "", 1).WPFObject("StackPanel", "", 1).WPFObject("Button", "Refresh", 1).Click
    'Delay 500000,"Refreshing Updating log.. Pls Wait..."
    Call sEdgeProcessor
  End if 
  
  Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("DockPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("GridControl").WPFObject("SourceLogTableView").Click
  Set objGridControl =Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("DockPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("GridControl")
  'Set objGridControl =Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("DockPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("GridControl")
  Delay (5000)
  If objGridControl.Exists = TRUE then
    Call objGridControl.ClickColumnHeaderRXY("Top Source Description", 94, 8)
  End if
 
   Delay (5000)
   ' "Show Search Panel"
   Dim objEdgeFilter
    set objEdgeFilter= Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1)
    'set objEdgeFilter= Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1)
    strTemp="WPFObject(""ContentControlEx"", ""Show Search Panel"", 2)"
    Set objTemp=objEdgeFilter.FindChild("Name",strTemp,50)
    If objTemp.Exists = TRUE then
      Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 11).WPFObject("BarButtonItemLinkControl", "", 1).WPFObject("ContentControlEx", "Show Search Panel", 2).Click
    Else
      strTestCaseResult = "ABORT"
      Exit Sub  
    End If
    
    Call sCloseSource()
    Set tableView = objGridControl.SourceLogTableView
    Call tableView.Drag(108, 496, -86, -3)
    Call tableView.Drag(97, 495, -97, 0) 
    'Delay(5000)
   If objGridControl.Exists = TRUE then
    Set  tableView = objGridControl.SourceLogTableView
    If tableView.Exists = TRUE then
      Call tableView.Click(95, 21)
      Call tableView.Keys(StrCountryname)
      Call objGridControl.SelectAll
    End if
    'Call objGridControl.ExpandGroup(0)
   End if 

   If tableView.Exists = TRUE then
      Call tableView.Click(95, 21)
      Call tableView.Keys("[Home]![End][Del]")
      Delay(1000)
      Call tableView.Click(95, 21)
      Call tableView.Keys(StrSource)
   End if 
    Delay(15000)
   Set objGridControl =Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("DockPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("GridControl")
  if objGridControl.ExpandGroup(0)=False then
    Call objGridControl.ExpandGroup(0)
    'Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("DockPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("GridControl").WPFObject("SourceLogTableView").WPFObject("HierarchyPanel", "", 1).WPFObject("GroupGridRow", "", 1).WPFObject("MeasurePixelSnapper", "", 1).WPFObject("PART_GroupRowContent").DblClick
  End if
  Delay(30000)

  Dim intValue
  
  If objGridControl.Exists = TRUE then  
    Call objGridControl.ClickCell(0, "Released Timepoint")
  End if 
  If objGridControl.Exists = TRUE then
    Call objGridControl.ClickCell(0, "Record Count - New")
  End if 
  If objGridControl.Exists = TRUE then
    Call objGridControl.ClickCell(0, "Record Count - Revised")
  End if 
  If objGridControl.Exists = TRUE then
    Call objGridControl.ClickCell(0, "Record Count - Deleted")
  End if 
  If objGridControl.Exists = TRUE then
    Call objGridControl.ClickCell(0, "QC Result - Failed")
  End if 
  If objGridControl.Exists = TRUE then
    Call objGridControl.ClickCell(0, "QC Result - Not MG")
  End if 
  If objGridControl.Exists = TRUE then
    Call objGridControl.ClickCell(0, "QC Result - Pass")
  End if
    
  Call objGridControl.ClickColumnHeaderRXY("Top Source Description", 90, 15)
  
  set objEdgeFilter= Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1)
  strTemp="WPFObject(""ContentControlEx"", ""Hide Search Panel"", 2)"
  Set objTemp=objEdgeFilter.FindChild("Name",strTemp,50)
  If objTemp.Exists = TRUE then
    Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 11).WPFObject("BarButtonItemLinkControl", "", 1).WPFObject("ContentControlEx", "Hide Search Panel", 2).Click
  Else
    strTestCaseResult = "ABORT"
    Exit Sub  
  End If
  'Delay(10000)
  strTCRemarks = "Verified Updated logs"
  Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).Click
  
End Sub

Sub sLayout_FileRepAddLink()
  
  On Error Resume Next
  Dim strTemp,objFileRepMenuItem,objFileRepUsage,objLayoutFileGridControl,intFootnoteRowIndex
  
  'strFooter="http://test6-15-2017 11:44:08 AM"
   
  strTemp="WPFObject(""ContentControlEx"", ""File Repository"", 2)"	
  Set objFileRepMenuItem=Sys.Process("EdgeClient").FindChild("Name",strTemp,30,true)
  If objFileRepMenuItem.Exists=True then
    objFileRepMenuItem.Click
  End If
  
  strTemp="WPFObject(""ContentControlEx"", ""File Repository Usage"", 2)"
	 Set objFileRepUsage=Sys.Process("EdgeClient").FindChild("Name",strTemp,30,true)
  If objFileRepUsage.Exists=True then
   objFileRepUsage.Click
  End If
  
  'Remove associated footnote if present
  strTemp="WPFObject(""LayoutFileGridControl"")"	
  Set objLayoutFileGridControl=Sys.Process("EdgeClient").FindChild("Name",strTemp,30,true)
  intFootnoteRowIndex=objLayoutFileGridControl.FindRow("Group","FOOTNOTE")
  
  If intFootnoteRowIndex>=0 then
    Call objLayoutFileGridControl.ClickCell(intFootnoteRowIndex,"Group")
    Delay 5000
    strTemp="WPFObject(""RemoveLinkButton"")"
    Set objRemoveLinkButton=Sys.Process("EdgeClient").FindChild("Name",strTemp,30,true)
    If objRemoveLinkButton.Enabled=true then
     objRemoveLinkButton.Click
     Set objMessageWindow = Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "File Repository Usage")
     If objMessageWindow.Exists=True then
      Sys.Keys("Y")
     End If
     Delay 5000
     Set objMessageWindow = Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "File Repository Usage")
     If objMessageWindow.Exists=True then
      Sys.Keys("O")
     End If     
    End If 'Removelb  
  End If 'footnote
  
  'Add footnote link
  strTemp="WPFObject(""AddLinkButton"")"
  Set objAddLinkButton=Sys.Process("EdgeClient").FindChild("Name",strTemp,30,true)
  If objAddLinkButton.Enabled=True then
  Call objAddLinkButton.ClickButton  
  End If
  
  Set objAddFileLinkView = Sys.Process("EdgeClient").WPFObject("HwndSource: AddFileLinkView", "Add New Link")
  If objAddFileLinkView.Exists=True then
   strTemp="WPFObject(""SelectionGrid"")"
   Set objSelectionGrid=Sys.Process("EdgeClient").FindChild("Name",strTemp,30,true)
   strTemp="WPFObject(""SelectionGridTableView"")"
   Set objSelectionGridTableView=Sys.Process("EdgeClient").FindChild("Name",strTemp,30,true)
   intGroupCount=objSelectionGrid.wGroupCount
   For i = 0 to intGroupCount-1
    If objSelectionGrid.DataController.GroupInfo.Item(i).GroupValue.OleValue="YYY" then
     intRowHandle=objSelectionGrid.DataController.GroupInfo.Item(i).Handle
     Call objSelectionGrid.ExpandGroup(i,true)
     Delay 5000
     Call objSelectionGridTableView.set_FocusedRowHandle(intRowHandle)
     Delay 5000 
     Call objSelectionGrid.Keys("[Enter]")
     Call objSelectionGrid.Keys("[Enter]")
     Sys.Keys("[Down]")
     Sys.Keys("[Down]")
     Sys.Keys("[Down]")    
     Delay 5000     
    Exit For
   End If
   Next
   Do
'    If objSelectionGrid.CurrentItem Is Nothing then
'      Delay 5000
'    End If
    If Trim(objSelectionGrid.CurrentItem.FileName.OleValue)=Trim(strFooter) Then
     If Err.Number>0 then
        Delay 10000
     End If
    End If
    If Trim(objSelectionGrid.CurrentItem.FileName.OleValue) = Trim(strFooter) Then     
      strTemp="WPFObject(""OkButton"")"						
      Set objOkButton=objAddFileLinkView.FindChild("Name",strTemp,30,true)
      If objOkButton.Exists=True then
       Call objOkButton.ClickButton
       strTCRemarks="Footnote added to Layout folder"
      End If
      Do
      Delay 2000      
      Loop While objAddFileLinkView.Exists=true
      Exit Do
     Else      
      Sys.Keys("[Down]")
      'Delay 2000
     End If
   Loop Until IsNull(objSelectionGrid.CurrentItem)
   Else
    strTestCaseResult="ABORT"
    strTCRemarks="Add New File Link window is not found"
  End If
  Call CloseWindow
  Call CloseWindow  
End Sub

Sub sExpandLayout(strParameters)
'Sub sExpandLayout()

On Error Resume Next 
    Dim strLevel1layout,strLevel2layout,strLevel3layout,strWrkSpaceName
    Dim objNewWrkSpace_okbtn,objNewWrkSpace_Name
    Dim objNewWrkSpace_Txtbox,objopenforEdit,objWrkspace_popup
    Dim strTemp,objTemp,intRow,barManager,intTotNodeCnt,Text,objCellText,intl,intK,strDesc1,strDesc2
    Dim objWrkSpace,objwrkspacepop,objwrkspcUpload,objConfirm,objGridCell,DescLocalText,intSeriesID

    strLevel1layout=getSplitValue(strParameters,"LEVEL1LAYOUT")
    strLevel2layout=getSplitValue(strParameters,"LEVEL2LAYOUT")
    strLevel3layout=getSplitValue(strParameters,"LEVEL3LAYOUT")
				
'				strLevel1layout="dX Non-Asia Database (Current Eng Version)"
'    strLevel2layout="Z-Testing Topic(IT-use only)"
'    strLevel3layout="Automation"
    
    'Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("LayoutTreeControl").WPFObject("LayoutTreeListView")
    'Set GridControl = Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("LayoutTreeControl").WPFObject("LayoutTreeListView")
				strTemp =  "WPFObject(""LayoutTreeListView"")"
				Set GridControl = Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).FindChild("Name",strTemp,50,True)
								'Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("LayoutTreeControl")
				'Set GridSourceTree= Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("LayoutTreeControl")
    strTemp = "WPFObject(""LayoutTreeControl"")"
	 		Set GridSourceTree = Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).FindChild("Name",strTemp,50,True)
		 	Delay 2000,"Please Wait..."
    ''Selecting Level1 layout
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strLevel1layout) then
									  GridControl.Nodes_2.Item(intI).ExpandAll	        							
          log.Message "Level 1 Layout - " & GridControl.Nodes_2.Item(intI).Content.Description       
          blnFlag=False  
          Exit For
        End If
    Next
'    Delay 3000,"Please Wait..."
    If blnFlag = True then
      strTCRemarks="Level 1 Layout not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
  
    Delay 5000,"Please Wait..."
    blnFlag = True 
    ''Selecting Level2 Layout
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
    For intJ=0 to intTotNodeCnt-1
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strLevel2layout) then
        GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).ExpandAll
        log.Message "Level2 layout Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
        blnFlag = False 
        Exit For
      End If
    Next
    If blnFlag = True then
      strTCRemarks="Level2 Source Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If

    Delay 5000,"Please Wait..."
    blnFlag = True    
    ''Selecting Level3 Layout
      intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count
      For intK=0 to intTotNodeCnt-1
        If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description)=Ucase(strLevel3layout) then
          GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Expand(True)
          intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).get_RowHandle
          
            Call GridControl.ClearSelectionCore
            Call GridControl.FocusViewAndRow(GridControl,intRow)
            GridControl.SetFocusOnCurrentItem
            Call GridControl.SelectRowCore(intRow)
         
          log.Message "Level3 layout Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description
          blnFlag = False
          Exit For   
        End If 
      Next
      If blnFlag = True then
        strTCRemarks="Level3 Source Name not found"
        strTestCaseResult="FAIL"
        Exit Sub
      End If

End Sub

Sub sLayoutModule(strParameters)
'Sub sLayoutModule

On Error Resume Next 
    Dim strLevel1layout,strLevel2layout,strLevel3layout,strWrkSpaceName
    Dim objNewWrkSpace_okbtn,objNewWrkSpace_Name
    Dim objNewWrkSpace_Txtbox,objopenforEdit,objWrkspace_popup
    Dim strTemp,objTemp,intRow,barManager,intTotNodeCnt,Text,objCellText,intl,intK,strDesc1,strDesc2
    Dim objWrkSpace,objwrkspacepop,objwrkspcUpload,objConfirm,objGridCell,DescLocalText,intSeriesID

    strLevel1layout=getSplitValue(strParameters,"LEVEL1LAYOUT")
    strLevel2layout=getSplitValue(strParameters,"LEVEL2LAYOUT")
    strLevel3layout=getSplitValue(strParameters,"LEVEL3LAYOUT")
    intSeriesID=getSplitValue(strParameters,"SERIESID")
    
'    strLevel1layout="dX Non-Asia Database (Current Eng Version)"
'    strLevel2layout="Z-Testing Topic(IT-use only)"
'    strLevel3layout="Sandbox (Benny)"
'    intSeriesID="369145097"

    strDesc1=aqDateTime.Now
    strDesc2=aqDateTime.Now
    DescText=Replace(strDesc1,"/","-")
    DescText=Replace(DescText,":","_")
    DescLocalText=DescText
    strWrkSpaceName=DescText
    'msgbox DescText
   
   
    'For PRT testcase    
    if intSeriesID=0 then
      intSeriesID=strSeriesID
    End if 

    Delay 3000,"Please Wait..."

    ''Setting grid Objects
    strTemp="WPFObject(""LayoutTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""LayoutTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,True)
    
    'Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("LayoutTreeControl").WPFObject("LayoutTreeListView")
    'Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("LayoutTreeControl")

    Delay 2000,"Please Wait..."
    ''Selecting Level1 layout
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strLevel1layout) then
          GridControl.Nodes_2.Item(intI).ExpandAll
          log.Message "Level 1 Layout - " & GridControl.Nodes_2.Item(intI).Content.Description       
          blnFlag=False  
          Exit For
        End If
    Next
    Delay 3000,"Please Wait..."
    If blnFlag = True then
      strTCRemarks="Level 1 Layout not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
  
    Delay 5000,"Please Wait..."
    blnFlag = True 
    ''Selecting Level2 Layout
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
    For intJ=0 to intTotNodeCnt-1
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strLevel2layout) then
        GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).ExpandAll
        log.Message "Level2 layout Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
        blnFlag = False 
        Exit For
      End If
    Next
    If blnFlag = True then
      strTCRemarks="Level2 Source Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If

    Delay 5000,"Please Wait..."
    blnFlag = True    
    ''Selecting Level3 Layout
      intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count
      For intK=0 to intTotNodeCnt-1
        If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description)=Ucase(strLevel3layout) then
          GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).ExpandAll
          intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).get_RowHandle
          
            Call GridControl.ClearSelectionCore
            Call GridControl.FocusViewAndRow(GridControl,intRow)
            GridControl.SetFocusOnCurrentItem
            Call GridControl.SelectRowCore(intRow)
         
          log.Message "Level3 layout Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description
          blnFlag = False
          Exit For   
        End If 
      Next
      If blnFlag = True then
        strTCRemarks="Level3 Source Name not found"
        strTestCaseResult="FAIL"
        Exit Sub
      End If
      'Call sCheckLayoutModule(strParameters)
      ''Clicking on "New Workspace" Button and selecting "Open for Edit(Souce)" option   
      strTemp="WPFObject(""ContentControlEx"", ""New Workspace"", 2)"
      Set objNewWorkspace=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,True)
      If objNewWorkspace.Exists = True then
      objNewWorkspace.Click
'      strTemp="WPFObject(""BarPopupBorderControl"", """", 1)"
'      Set objWrkspace_popup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").FindChild("Name",strTemp,5,True)
      If objNewWorkspace.Exists = True then
        strTemp="WPFObject(""ContentControlEx"", ""Open For Edit"", 2)"
        Set objopenforEdit=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,True)
        If objopenforEdit.Exists then
          objopenforEdit.Click    
          'Delay 30000,"Please Wait..."
        End If
      End If
      
      strTemp1="WPFObject(""HwndSource: WorkspaceNamePrompt"", ""Please provide a new Workspace Name"")"
      Set objNewWrkSpaceName=Sys.Process("EdgeClient").WaitChild(strTemp1,80000)
      If objNewWrkSpaceName.Exists = True then

          ''Waiting for Workspace Name prompt
          'strTemp="WPFObject(""FloatingContainerBorder"")"
          Set objNewWrkSpace_Name=Sys.Process("EdgeClient").WPFObject("HwndSource: WorkspaceNamePrompt", "Please provide a new Workspace Name")'.WPFObject("WorkspaceNamePrompt", "Please provide a new Workspace Name", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,1500000)
          If objNewWrkSpace_Name.Exists = True then
            strTemp="WPFObject(""ChangeNameTextEdit"")"
            ''Entering Workspace Name
            Set objNewWrkSpace_Txtbox=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
              'Delay 30000,"Please Wait..."
              If objNewWrkSpace_Txtbox.Exists = True then
                objNewWrkSpace_Txtbox.Click
                objNewWrkSpace_Txtbox.Text=strWrkSpaceName
                ''Clicking on Ok Button 
                strTemp="WPFObject(""OkButton"")"
                Set objNewWrkSpace_okbtn=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
                If objNewWrkSpace_okbtn.Exists = True then
                  objNewWrkSpace_okbtn.Click
                  'Delay 10000,"Please wait..."
                End If
               End If
          End If
      End if 
    End If

'    ''Handling Validation for Layout
'    strTemp="WPFObject(""HwndSource: WindowContentHolder"", """")"
'    Set objTemp=Sys.Process("EdgeClient").WaitChild(strTemp,20000)
'    If objTemp.Exists = True then
'      objTemp.Keys "[Enter]"
'      strTestCaseResult = "FAIL"
'      Exit Sub
'    End If

    Delay 2000, "Please Wait Form is loading...."
    
    
    ''WorkSpace Edit Window
    strTemp="WPFObject(""LayoutPanel"", """", 2)"
    Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WaitChild(strTemp,15000)
    If objTemp.Exists then
        Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("LayoutTreeListControl").WPFObject("LayoutTreeListView")
        'Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("LayoutTreeListControl").WPFObject("LayoutTreeListView")
        Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("LayoutTreeListControl")
        'Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("LayoutTreeListControl")

        ''Selecting Level1 layout
        intTotNodeCnt=GridControl.Nodes_2.Count
        For intI=0 to intTotNodeCnt-1         
            If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strLevel1layout) then
              GridControl.Nodes_2.Item(intI).ExpandAll
              log.Message "Level 1 Layout - " & GridControl.Nodes_2.Item(intI).Content.Description       
              blnFlag=False  
              Exit For
            End If
        Next
  
        blnFlag = True 
        ''Selecting Level2 Layout
        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
        For intJ=0 to intTotNodeCnt-1
          If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strLevel2layout) then
            GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).ExpandAll
            log.Message "Level2 layout Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
            blnFlag = False 
            Exit For
          End If
        Next
   
        ''Selecting Level3 Layout
          intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count
          For intK=0 to intTotNodeCnt-1
            If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description)=Ucase(strLevel3layout) then
              GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).ExpandAll
              intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).get_RowHandle
              GridControl.Keys "^[Home]"
              intRow=intRow+1
              
             Set objGridCell=GridControl.WPFObject("HierarchyPanel", "", 1).WPFObject("RowControl", "", 3).WPFObject("CellsControl", "", 1).WPFObject("LightweightCellEditor", "", 2).WPFObject("InplaceBaseEdit", "", 1)
              If objGridCell.Exists = True then
                objGridCell.Click
              End If
              log.Message "Level3 layout Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description
              blnFlag = False
              Exit For   
            End If 
          Next
         
    
        ''Clicking on New Folder
        strTemp="WPFObject(""ContentControlEx"", ""Add Folder"", 2)"
        Set objTemp=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,true)
        'Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 4).WPFObject("BarButtonItemLinkControl", "", 1)
        If objTemp.Exists = True then    
          objTemp.Click  
          Call sEdgeProcessor
          Delay 1000,"New Folder..."
        End If
    
        ''Getting no. of Rows under level 3
        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(0).Nodes.Count
        intl=intTotNodeCnt-1
        
        Set objCellText=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Nodes.Item(intL)
        'Aliases.EdgeClient.HwndSource_RibbonWindow.RibbonWindow.ContentControl.Grid.Grid.ContentControl.Grid.ContentControl.PART_ContainerContent.BarManager.DockPanel.DockLayoutManager.LayoutGroup.LayoutPanel2.Root.BarManager.AdornerDecorator.AdornedControl.Grid.DockPanel.WPFObject("LayoutTreeListControl").WPFObject("LayoutTreeListView").Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Nodes.Item(intL)
          Call objCellText.Content.set_Description(DescText)    
          Call objCellText.Content.set_DescriptionLocal(DescLocalText)
          Call objCellText.Content.set_DisabledFlag(True)
      
        
        ''Attach Series
        strTemp="WPFObject(""ContentControlEx"", ""Attach Series"", 2)"
        Set objTemp=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,true)
        'Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").FindChild("Name",strTemp,15,True)
        If objTemp.Exists = True then
          objTemp.DblClick
          ''Entering Series      
          'Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: LayoutSeriesPrompt", "Attach Layout Series").WPFObject("LayoutSeriesPrompt", "Attach Layout Series", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("SeriesIdTextEdit")
          Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: LayoutSeriesPrompt", "Attach Layout Series").WPFObject("LayoutSeriesPrompt", "Attach Layout Series", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContentOffset").WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("SeriesIdTextEdit")
          If objTemp.Exists = True then 
            If  Ucase(Trim(strTestCase_no)) = Ucase(Trim("TC_PRT_05"))Then
               objTemp.Text=strSeriesID
            Else
               objTemp.Text=intSeriesID
            End If

           
            Delay 3000
            'Delay(10000)
             ''Clicking on OK Button
             'Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: LayoutSeriesPrompt", "Attach Layout Series").WPFObject("LayoutSeriesPrompt", "Attach Layout Series", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 1).WPFObject("OkButton")
             Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: LayoutSeriesPrompt", "Attach Layout Series").WPFObject("LayoutSeriesPrompt", "Attach Layout Series", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContentOffset").WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 1).WPFObject("OkButton")
             If objTemp.Exists = True then
                objTemp.Click
             End If
          End If            
        End If
        Delay 3000, "Please Wait.."
        Call sEdgeProcessor()
         Delay 3000, "Please Wait.."
           Set objTemp =  Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("LayoutTreeListControl").WPFObject("LayoutTreeListView").WPFObject("HierarchyPanel", "", 1).WPFObject("RowControl", "", 8).WPFObject("CellsControl", "", 1).WPFObject("LightweightCellEditor", "", 3).WPFObject("PART_Editor") 
       If objTemp.Exists Then 
          objTemp.clickButton(cbUnchecked)
          objTemp.clickButton(cbchecked)
        End If
       
       
       
       ' Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", "Edge ( US Integration )").WPFObject("Shell", "Edge ( US Integration )", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("LayoutTreeListControl").WPFObject("LayoutTreeListView").WPFObject("HierarchyPanel", "", 1).WPFObject("RowControl", "", 8).WPFObject("CellsControl", "", 1).WPFObject("LightweightCellEditor", "", 3).WPFObject("PART_Editor").clickButton(cbChecked)
'        Call objCellText.Content.set_DisabledFlag(False)
'        Call objCellText.Content.set_DisabledFlag(True)

      Call sCloseLayout
      Call sEdgeProcessor()
      Delay 20000 , "Please Wait..."
'      strTemp="WPFObject(""RowControl"", """", 1)"
'      Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("SourceSeriesViewControl").WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("SourceSeriesGridControl").WPFObject("SourceSeriesTableView").WPFObject("HierarchyPanel", "", 1).WaitChild(strTemp,30000)
'  
'      If objTemp.Exists Then 
'         Delay 2000
'      End If
      'Delay 10000,"Closing Layout..." 
  
'      ''Disable Flag
'      Dim objAttGrid,objAttGridTree,intRowcnt,intAttRow,objAttCell
''      intSeriesID=getSplitValue(strParameters,"SERIESID")
''      if intSeriesID=0 then 
''      Else
'          'Set objAttGrid=Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("LayoutSeriesViewControl").WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("LayoutSeriesGridControl")
'          'Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("LayoutSeriesViewControl").WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("LayoutSeriesGridControl")
'          Set objAttGrid = Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", "Edge ( US Integration )").WPFObject("Shell", "Edge ( US Integration )", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("LayoutTreeListControl").WPFObject("LayoutTreeListView").WPFObject("HierarchyPanel", "", 1).WPFObject("RowControl", "", 8).WPFObject("CellsControl", "", 1).WPFObject("LightweightCellEditor", "", 3)
'          'objAttGrid.
'          Delay 2000,"Pls Wait.."
'          Call objAttGrid.ClickCell(0,"Disabled Flag")
''           objAttGrid.Keys "^[END]"
''         objAttGrid.Click
''        objAttGrid.Keys("[PageDown]")
''      End if 

   ' Delay 5000, "Please Wait..."
    ''Uploading WorkSpace
    strTemp="WPFObject(""ContentControlEx"", ""Workspace"", 2)"
    Set objWrkSpace=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,true)
    'Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 11).WaitChild(strTemp,10000)
    If objWrkSpace.Exists = True then
      objWrkSpace.Click
      'strTemp="WPFObject(""BarPopupBorderControl"", """", 1)" 
      'Set objwrkspacepop=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1)
      If objWrkSpace.Exists = True then
        strTemp="WPFObject(""ContentControlEx"", ""Upload Workspace"", 2)"
        set objwrkspcUpload=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,true)
        'Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).FindChild("Name",strTemp,5,True)
        If objwrkspcUpload.Exists = True then
          objwrkspcUpload.Click
          'Delay 5000,"Pls Wait.."
          'strTemp="WPFObject(""PART_ContainerContent"")"
          Set objConfirm=Sys.Process("EdgeClient").WPFObject("HwndSource: WindowContentHolder", "Confirm")'.WPFObject("WindowContentHolder", "Confirm", 1).WPFObject("NonLogicalDecorator", "", 1).WPFObject("ThemedManagedContentPresenter", "", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,100000)
         
            If objConfirm.Exists = True then
              Sys.Keys "[Enter]"
              Delay 8000,"Uploading..."
              
            Set objConfirm = Sys.Process("EdgeClient")._
            Waitchild("WPFObject(""HwndSource: CustomMessageBoxWindow"", ""Upload Workspace"")",600000)
'           
            If objConfirm.Exists = True then
              Sys.Keys("O")
              Call sEdgeProcessor
            
          'Exit Sub for PRT_TC_06
'          if intSeriesID=0 then 
'          Call sCloseLayout
'          Exit Sub
'          End If
             
              'Reopen Layout and Checking whether the new series is created
            
              Call sHome_Layout    
              Call sEdgeProcessor()
              Delay 2000,"Pls Wait.."          
'              strObject = "WPFObject(""HwndSource: RibbonWindow"")"
'              Set objEdgeMDI = Sys.Process("EdgeClient").WaitChild(strObject, 600000)
'              If objEdgeMDI.Exists then
'                Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("RibbonControl").WPFObject("RibbonSelectedPageControl", "", 1).WPFObject("RibbonPagesControl", "", 1).WPFObject("RibbonPageGroupsControl", "", 1).WPFObject("RibbonPageGroupControl", "", 1).WPFObject("BarItemLinkInfo", "", 7).WPFObject("BarButtonItemLinkControl", "", 1)
'                objTemp.Click
'                Call sEdgeProcessor
'              Else
'                log.Message "RibbonWindow not found"
'              End If
                      
            ''Tree Trace              
            ''Setting grid Objects
            
            strTemp="WPFObject(""LayoutTreeListView"")"
            Set GridControl=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,true)
            'Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("LayoutTreeControl").WPFObject("LayoutTreeListView")
            strTemp="WPFObject(""LayoutTreeControl"")"
            Set GridSourceTree=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,true)
            'Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("LayoutTreeControl")
            
            ''Selecting Level1 layout
        intTotNodeCnt=GridControl.Nodes_2.Count
        For intI=0 to intTotNodeCnt-1         
            If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strLevel1layout) then
              GridControl.Nodes_2.Item(intI).ExpandAll
              intRow=GridControl.Nodes_2.Item(intI).get_RowHandle
              objGridControl.Keys "^[Home]"
              Call GridControl.ClearSelectionCore
              Call GridControl.FocusViewAndRow(GridControl,intRow)
              GridControl.SetFocusOnCurrentItem
              Call GridControl.SelectRowCore(intRow) 
              log.Message "Level 1 Layout - " & GridControl.Nodes_2.Item(intI).Content.Description       
              blnFlag=False  
              Exit For
            End If
        Next
        If blnFlag = True then
          strTCRemarks="Level 1 Layout not found"
          strTestCaseResult="FAIL"
          Exit Sub
        End If
  
        blnFlag = True 
        ''Selecting Level2 Layout
        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
        For intJ=0 to intTotNodeCnt-1
          If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strLevel2layout) then
            GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).ExpandAll
            intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
            objGridControl.Keys "^[Home]"
              Call GridControl.ClearSelectionCore
              Call GridControl.FocusViewAndRow(GridControl,intRow)
              GridControl.SetFocusOnCurrentItem
              Call GridControl.SelectRowCore(intRow) 
            log.Message "Level2 layout Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
            blnFlag = False 
            Exit For
          End If
        Next
        If blnFlag = True then
          strTCRemarks="Level2 Source Name not found"
          strTestCaseResult="FAIL"
          Exit Sub
        End If

        blnFlag = True    
        ''Selecting Level3 Layout
          intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count
          For intK=0 to intTotNodeCnt-1
            If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description)=Ucase(strLevel3layout) then
              GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).ExpandAll
              intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).get_RowHandle
              objGridControl.Keys "^[Home]"
              Call GridControl.ClearSelectionCore
              Call GridControl.FocusViewAndRow(GridControl,intRow)
              GridControl.SetFocusOnCurrentItem
              Call GridControl.SelectRowCore(intRow) 
              'Call GridSourceTree.ClickCell(intRow, "Description")
'               GridControl.set_FocusedRowHandle(intRow)
'                GridControl.set_FocusedRowData(intRow)
'                delay(1000)
'                GridControl.Keys("[Down]")
'                GridControl.Keys("[Up]")
'         
              log.Message "Level3 layout Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description
              blnFlag = False
              Exit For   
            End If 
          Next
          If blnFlag = True then
            strTCRemarks="Level3 Source Name not found"
            strTestCaseResult="FAIL"
            Exit Sub
          End If
          
         'Call sCheckLayoutModule(strParameters)
  
          ''Clicking on "New Workspace" Button and selecting "Open for Edit(Souce)" option   
          strTemp="WPFObject(""ContentControlEx"", ""New Workspace"", 2)"
          Set objNewWorkspace=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,true)
          'Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarSubItemLinkControl", "", 1).FindChild("Name",strTemp,2,True)
          If objNewWorkspace.Exists = True then
          objNewWorkspace.Click
          'strTemp="WPFObject(""BarPopupBorderControl"", """", 1)"
          'Set objWrkspace_popup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").FindChild("Name",strTemp,5,True)
          If objNewWorkspace.Exists = True then
            strTemp="WPFObject(""ContentControlEx"", ""Open For Edit"", 2)"
            Set objopenforEdit=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,true)
            If objopenforEdit.Exists then
              objopenforEdit.Click    
             ' Delay 30000,"Please Wait..."
            End If
          End If
   
          strTemp1="WPFObject(""HwndSource: WorkspaceNamePrompt"", ""Please provide a new Workspace Name"")"
          Set objNewWrkSpaceName=Sys.Process("EdgeClient").WaitChild(strTemp1,80000)
          If objNewWrkSpaceName.Exists = True then
          
              ''Waiting for Workspace Name prompt
              strTemp="WPFObject(""FloatingContainerBorder"")"
              Set objNewWrkSpace_Name=Sys.Process("EdgeClient").WPFObject("HwndSource: WorkspaceNamePrompt", "Please provide a new Workspace Name")'.WPFObject("WorkspaceNamePrompt", "Please provide a new Workspace Name", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,1900000)
              If objNewWrkSpace_Name.Exists = True then
                strTemp="WPFObject(""ChangeNameTextEdit"")"
                ''Entering Workspace Name
                Set objNewWrkSpace_Txtbox=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
                  If objNewWrkSpace_Txtbox.Exists = True then
                    objNewWrkSpace_Txtbox.Click
                    objNewWrkSpace_Txtbox.Text=strWrkSpaceName
                    ''Clicking on Ok Button 
                    strTemp="WPFObject(""OkButton"")"
                    Set objNewWrkSpace_okbtn=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
                    If objNewWrkSpace_okbtn.Exists = True then
                      objNewWrkSpace_okbtn.Click
                      'Delay 5000,"Please wait..."
                       Call sEdgeProcessor
                    End If
                   End If
              End If
          End if 
        End If

        ''WorkSpace Edit Window
        strTemp="WPFObject(""LayoutPanel"", """", 2)"
        Set objTemp=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,True)
        If objTemp.Exists then
            Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("LayoutTreeListControl").WPFObject("LayoutTreeListView")
            Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("LayoutTreeListControl")
            'Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("LayoutTreeListControl").WPFObject("LayoutTreeListView")
            'Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("LayoutTreeListControl")

            ''Selecting Level1 layout
            intTotNodeCnt=GridControl.Nodes_2.Count
            For intI=0 to intTotNodeCnt-1         
                If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strLevel1layout) then
                  GridControl.Nodes_2.Item(intI).ExpandAll
                  log.Message "Level 1 Layout - " & GridControl.Nodes_2.Item(intI).Content.Description       
                  blnFlag=False  
                  Exit For
                End If
            Next
  
            blnFlag = True 
            ''Selecting Level2 Layout
            intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
            For intJ=0 to intTotNodeCnt-1
              If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strLevel2layout) then
                GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).ExpandAll
                log.Message "Level2 layout Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
                blnFlag = False 
                Exit For
              End If
            Next
   
            ''Selecting Level3 Layout
              intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count
              For intK=0 to intTotNodeCnt-1
                If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description)=Ucase(strLevel3layout) then
                  GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).ExpandAll
                  intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).get_RowHandle
                  log.Message "Level3 layout Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description
                  blnFlag = False
                  Exit For   
                End If 
              Next
          
              ''Selecting Level4 Layout
              intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Nodes.Count
              For intl=0 to intTotNodeCnt-1
                If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Nodes.Item(intl).Content.Description)=UCase(DescText) then
                  intRow =GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Nodes.Item(intl).get_RowHandle
                  GridControl.Keys "^[Home]"
                  GridControl.set_FocusedRowHandle(intRow)
                  'Checking for series Id
                      Dim objLayoutSeriesTable,objRowControl
                      strTemp = "WPFObject(""LayoutSeriesTableView"")"
                      objLayoutSeriesTable = Sys.Process("EdgeClient").FindChild("Name",strTemp,30,True)
                      If objLayoutSeriesTable.exists = True Then
                        strTemp="WPFObject(""RowControl"", """", 1)"
                        objRowControl = objLayoutSeriesTable.FindChild("Name",strTemp,10,True)
                        If objRowControl.DataContext.Row.SeriesId = intSeriesID Then
                          strTCRemarks="Upload successful" & "<br />" & "Level4 Layout Created - " & DescText & "<br />" & "Attach Series - " & intSeriesID
                        Else
                          strTCRemarks="Series not matching"                          
                        End If
                      Else
                        strTCRemarks="LayoutSeriesTable does not exist"
                      End If
                  log.Message "Third Level- " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Nodes.Item(intl).Content.Description
                  blnFlag = False
                  Exit For   
                End If 
              Next              
          End If
          End If
          End If
          End If
          End If
          End If
          End If
       
        Call sCloseLayout
        Delay 4000,"Closing Layout..." 
        Call sCloseLayout
        Delay 4000,"Closing Layout..." 
        Call sLayoutWorkSpacevwr 
       ' LayoutModule
       ' msgbox "LoadLayout is completed"

End Sub


Sub sCDMTree(strParameters)
'Sub sCDMTree
  On Error Resume Next
  Dim objGrid,intRow,strTopic,intSectionCount,intI,intJ,intK,strSearch1,strs,strSearch2,strSearch3

    strSearch1=getSplitValue(strParameters,"SEARCH1")
    strSearch2=getSplitValue(strParameters,"SEARCH2")
    strSearch3=getSplitValue(strParameters,"SEARCH3")
    
'    strSearch1="Albania"
'    strSearch2="Albania: National Accounts"
'    'strSearch3="Sample1"
'    strCategory= aqdatetime.Now
'     DescText="6-21-2017 12_20_42 PM"

    Set objGrid=Sys.Process("ISI.CeicDataManager.Startup").WinFormsObject("CDMMain_MDIParent").WinFormsObject("MdiClient", "").WinFormsObject("Layout_Form").WinFormsObject("Panel_Rebar").WinFormsObject("GridEX_Tree")
    intRow=objGrid.get_RowCount

    ''Expanding Topic
    For IntI=0 to intRow-1
        objGrid.set_Row(intI)
        strTopic=objGrid.CurrentRow.DataRow.Row.TP_WSValue_Name.ToString
        If strTopic=strSearch1 then        
            objGrid.CurrentRow.set_Expanded(True)
            Exit For
        End If
    Next
    ''Expanding Section
    For IntJ=1 to intRow
        objGrid.set_Row(intI + intJ)
        strTopic=objGrid.CurrentRow.DataRow.Row.SC_WSValue_Name.ToString
        If strTopic=strSearch2 then
            objGrid.CurrentRow.set_Expanded(True)
            Exit For
        End If
    Next
    ''Expanding Section Table
    dim intId
    intId= ""
    For IntK=1 to intRow
        objGrid.set_Row(intI + intJ + intK)
        strTopic=objGrid.CurrentRow.DataRow.Row.TB_WSValue_Name.ToString         
     If strTopic=DescText then   
         'Refresh to get Data 
         Delay 2000,"Refresh.."
         
         objGrid.CurrentRow.set_Expanded(True)
         sys.Keys "~s+A"    
         Delay 4000,"Refresh.." 
         objGrid.set_Row(intI + intJ + intK+1)
         intId=objGrid.CurrentRow.DataRow.Row.SR_SeriesId
         Exit For
     End If
    Next
    
    Delay 2000,"New Table Created"
    ''Closing    
    Set objTemp=Sys.WaitChild("Process(""ISI.CeicDataManager.Startup"")",120000)
    sys.Keys "~[F4]"
    If objTemp.Exists = True then
        strTemp="WinFormsObject(""CDMYesNoDialog"")"
        Set objTemp=Sys.Process("ISI.CeicDataManager.Startup").WaitChild(strTemp,120000)
        If objTemp.Exists = True then
          Sys.Process("ISI.CeicDataManager.Startup").WinFormsObject("CDMYesNoDialog").WinFormsObject("TableLayoutPanel1").WinFormsObject("UiButton_Yes").Click
        Else
          strTestCaseResult = "ABORT"
  	      strTCRemarks="CDM Closing Dialog box not found"
          Exit Sub  
        End If
    Else
        strTestCaseResult = "ABORT"
	      strTCRemarks="CDM Dialog box not found"
        Exit Sub  
    End If
    Delay 15000,"Closing CDM"
    strTCRemarks="New Table Created" & "<br />" &  "Series Id :" & intId 
    log.Message(intId&":"&strSeriesId)
    If NOT IsEmpty(strSeriesId) then
      If Cstr(intId)=Cstr(strSeriesId) then
        strTCRemarks=strTCRemarks& "<br />" & "Series Id verified in Source/Layout/CDM"
        log.Message strTCRemarks
        strTestCaseResult= "PASS"
       Else 
        strTCRemarks=strTCRemarks& "<br />" & "Series Id is not match Source/Layout and CDM"
        log.Message strTCRemarks
        strTestCaseResult = "FAIL"
      End If      
    End If
    
   
    'msgbox "CDMTree is completed"
End Sub

Sub sCDMTree1(strParameters)
'Sub sCDMTree1
On Error Resume Next 

  Dim objGrid,intRow,strTopic,intSectionCount,intI,intJ,intK,strSearch1,strs,strSearch2,strSearch3

    strSearch1=getSplitValue(strParameters,"SEARCH1")
    strSearch2=getSplitValue(strParameters,"SEARCH2")
    strSearch3=getSplitValue(strParameters,"SEARCH3")

'    strSearch1="Z-Testing Topic(IT-use only)"
'    strSearch2="Automation"
'    strSearch3="Sample1"

    Set objGrid=Sys.Process("ISI.CeicDataManager.Startup").WinFormsObject("CDMMain_MDIParent").WinFormsObject("MdiClient", "").WinFormsObject("Layout_Form").WinFormsObject("Panel_Rebar").WinFormsObject("GridEX_Tree")
    intRow=objGrid.get_RowCount

    ''Expanding Topic
    For IntI=0 to intRow-1
        objGrid.set_Row(intI)
        strTopic=objGrid.CurrentRow.DataRow.Row.TP_WSValue_Name.ToString
        If strTopic=strSearch1 then        
            objGrid.CurrentRow.set_Expanded(True)
            Exit For
        End If
    Next
    ''Expanding Section
    For IntJ=1 to intRow
        objGrid.set_Row(intI + intJ)
        strTopic=objGrid.CurrentRow.DataRow.Row.SC_WSValue_Name.ToString
        If strTopic=strSearch2 then
           'Double-click on search icon to get Datatalk window and save screenshot
            objGrid.Col = 1 'grid.currentrow.getcells
            intX = objGrid.CurrentRow.Position
            Set objBounds = objGrid.GetCellBounds(intX, objGrid.CurrentColumn)
            Call objGrid.DblClick(objBounds.Left,objBounds.Top)
            Delay 20000
            Set PicObj = Utils.Picture
            Set PicObj = Sys.Desktop.Picture
            PicObj.SavetoFile(strLogFolder & "Screenshots\" & strTestCase_No &  "_" & picCount & ".jpg")
            picCount = picCount + 1
            strTCRemarks="Screenshot of Datatalk window is captured"
            

            'Activate first tab
            Set objCDMTabs = Sys.Process("ISI.CeicDataManager.Startup").WinFormsObject("CDMMain_MDIParent").WinFormsObject("UIMdiTabGroup", "", 2)
            Call objCDMTabs.Click(40,12)
            Delay 5000
            
            'Right-click on current row for Footnotes window and save screenshot
            objGrid.Col = 2 'grid.currentrow.getcells
            intX = objGrid.CurrentRow.Position
            Set objBounds = objGrid.GetCellBounds(intX, objGrid.CurrentColumn)
            Call objGrid.ClickR(objBounds.Left,objBounds.Top)
            Delay 2000
            Set objContextMenu = Sys.Process("ISI.CeicDataManager.Startup").WinFormsObject("JNSO", "")
            If objContextMenu.Exists = true then
             Call objContextMenu.Click(5,5) 'Clicking on footnote option
             Delay 20000
            Set PicObj = Utils.Picture
            Set PicObj = Sys.Desktop.Picture
            PicObj.SavetoFile(strLogFolder & "Screenshots\" & strTestCase_No &  "_" & picCount & ".jpg")
            picCount = picCount + 1
            strTCRemarks=strTCRemarks & "<br/>" &"Screenshot of Footnote window is captured."
            sys.Keys "~[F4]" 
            Delay 3000,"Closing window..."            
            End If            
            Exit For
        End If
    Next
  
    ''Closing
    sys.Keys "~[F4]"
    Set objTemp=Sys.WaitChild("Process(""ISI.CeicDataManager.Startup"")",1200000)
    If objTemp.Exists = True then
        strTemp="WinFormsObject(""CDMYesNoDialog"")"
        Set objTemp=Sys.Process("ISI.CeicDataManager.Startup").WaitChild(strTemp,1200000)
        If objTemp.Exists = True then
          Sys.Process("ISI.CeicDataManager.Startup").WinFormsObject("CDMYesNoDialog").WinFormsObject("TableLayoutPanel1").WinFormsObject("UiButton_Yes").Click
        Else
          strTestCaseResult = "ABORT"
  	      strTCRemarks="CDM Closing Dialog box not found"
          Exit Sub  
        End If
    Else
        strTestCaseResult = "ABORT"
	      strTCRemarks="CDM Dialog box not found"
        Exit Sub  
    End If
    Delay 15000,"Closing CDM"
    
End Sub



Sub sReadCDMTree(strParameters)

On Error Resume Next 
  'msgbox DescText

  Dim objGrid,intRow,strTopic,intSectionCount,intI,intJ,intK,strSearch1,strs,strSearch2,strSearch3
  Dim FirstObsDate,LastObsDate,NumOfTP

    strSearch1=getSplitValue(strParameters,"SEARCH1")
    strSearch2=getSplitValue(strParameters,"SEARCH2")
    strSearch3=getSplitValue(strParameters,"SEARCH3")
    
    
    'DescText="9-26-2017 10_53_28 AM"
'    strSearch1="Z-Testing Topic(IT-use only)"
'    strSearch2="Sandbox (Benny)"
'    strSearch3="Sample1"

    Set objGrid=Sys.Process("ISI.CeicDataManager.Startup").WinFormsObject("CDMMain_MDIParent").WinFormsObject("MdiClient", "").WinFormsObject("Layout_Form").WinFormsObject("Panel_Rebar").WinFormsObject("GridEX_Tree")
    intRow=objGrid.get_RowCount

    ''Expanding Topic
    For IntI=0 to intRow-1
        objGrid.set_Row(intI)
        strTopic=objGrid.CurrentRow.DataRow.Row.TP_WSValue_Name.ToString
        If strTopic=strSearch1 then        
            objGrid.CurrentRow.set_Expanded(True)
            Exit For
        End If
    Next
    ''Expanding Section
    For IntJ=1 to intRow
        objGrid.set_Row(intI + intJ)
        strTopic=objGrid.CurrentRow.DataRow.Row.SC_WSValue_Name.ToString
        If strTopic=strSearch2 then        
            objGrid.CurrentRow.set_Expanded(True)
            Exit For
        End If
    Next
    ''Expanding Section Table
    For IntK=1 to intRow
        objGrid.set_Row(intI + intJ + intK)
        strTopic=objGrid.CurrentRow.DataRow.Row.TB_WSValue_Name.ToString
        If strTopic=DescText then    
            objGrid.CurrentRow.set_Expanded(True)
            'click On Refresh Button to get all details                     
              sys.Keys "~s+A"  
              Delay 5000,"Refresh.."   
            objGrid.set_Row(intI + intJ + intK+1)
            intId=objGrid.CurrentRow.DataRow.Row.SR_SeriesId
            FirstObsDate=objGrid.CurrentRow.DataRow.Row.SR_DisplayStartDate
            LastObsDate=objGrid.CurrentRow.DataRow.Row.SR_DisplayEndDate
            NumOfTP=objGrid.CurrentRow.DataRow.Row.SR_NumPoints
            Exit For
        End If
    Next

    Delay 5000,"New Table Created"
    ''Closing
    sys.Keys "~[F4]"
    Set objTemp=Sys.WaitChild("Process(""ISI.CeicDataManager.Startup"")",1200000)
    If objTemp.Exists = True then
        strTemp="WinFormsObject(""CDMYesNoDialog"")"
        Set objTemp=Sys.Process("ISI.CeicDataManager.Startup").WaitChild(strTemp,1200000)
        If objTemp.Exists = True then
          Sys.Process("ISI.CeicDataManager.Startup").WinFormsObject("CDMYesNoDialog").WinFormsObject("TableLayoutPanel1").WinFormsObject("UiButton_Yes").Click
        Else
          strTestCaseResult = "ABORT"
  	      strTCRemarks="CDM Closing Dialog box not found"
          Exit Sub  
        End If
    Else
        strTestCaseResult = "ABORT"
	      strTCRemarks="CDM Dialog box not found"
        Exit Sub  
    End If
    Delay 15000,"Closing CDM"
    strTCRemarks="FirstObsDate="&FirstObsDate&"   LastObsDate="&LastObsDate&"   NumOfTP="&NumOfTP
    log.Message strTCRemarks
End Sub


Sub SClosesource()

    On Error Resume Next 
    Dim objEdge,strTemp,objTemp, objStrClose , objClose 
    
  '  strEnvi = "Edge ( US Integration )"          
     strTemp = "WPFObject(""LayoutPanel"", """", 1)"
     Set objStrClose=Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).FindChild("Name", strTemp, 10, True)
     If objStrClose.Exists = True then
        objStrClose.set_Closed(True)
        Delay 200,"Closing Window..."   
        Log.message strTemp + "Is Closed"
    End If  
End Sub


Sub sFileRepository(strParameters)
'Sub sFileRepository()

  On Error Resume Next
		'strEnvi = "Edge ( US Integration )"


  Dim objDockPanel,objLayoutGroup,objFileRepositoryView,objGrid,objCombobox,objHwndSource,objGridView,objTemp,objCellItemsControl,gridCellContentPresenter
  Dim strCountry,objEdge,strTemp,objText
  
  strFooter=getSplitValue(strParameters,"FOOTER")''Footer Name
  strCountry=getSplitValue(strParameters,"COUNTRY")''Country Name
'		
'		strFooter = "http://test"
'		strCountry = "Test"

  Dim strDes,strText
  strDes=aqDateTime.Now
  strText=Replace(strDes,"/","-")
  DescText=Replace(strText,":","_")
  strFooter=strFooter &""& strText
  
  'strFooter="http://test and Description"
	 'set objEdge= Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1)
			set objEdge= Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1)
  If objEdge.Exists = False then
   	'Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("RibbonControl").WPFObject("RibbonSelectedPageControl", "", 1).WPFObject("RibbonPagesControl", "", 1).WPFObject("RibbonPageGroupsControl", "", 1).WPFObject("RibbonPageGroupControl", "", 1).WPFObject("BarItemLinkInfo", "", 15).WPFObject("BarButtonItemLinkControl", "", 1).Click
  	  Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("RibbonControl").WPFObject("RibbonSelectedPageControl", "", 1).WPFObject("RibbonPagesControl", "", 1).WPFObject("RibbonPageGroupsControl", "", 1).WPFObject("RibbonPageGroupControl", "", 1).WPFObject("BarItemLinkInfo", "", 15).WPFObject("BarButtonItemLinkControl", "", 1).Click
			  Call sEdgeProcessor 
				set objEdge= Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1)   
    If objEdge.Exists = False then
      strTestCaseResult = "FAIL"
      Exit Sub
    End If
  ElseIf objEdge.Exists = True then
    If objTemp.Caption<>"File Repository" then
       Call sCloseSource()
    	 Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("RibbonControl").WPFObject("RibbonSelectedPageControl", "", 1).WPFObject("RibbonPagesControl", "", 1).WPFObject("RibbonPageGroupsControl", "", 1).WPFObject("RibbonPageGroupControl", "", 1).WPFObject("BarItemLinkInfo", "", 15).WPFObject("BarButtonItemLinkControl", "", 1).Click
						'Delay 25000,"Opening File Repository Module.. Pls Wait..."
    			Set objEdge= Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1)
    	  If objEdge.Exists = False then
										strTestCaseResult = "FAIL"
       		 Exit Sub
     	 End If
    	End if 
  End If
  strTCRemarks="Opened File Repository Module"

		Set objCombobox = Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("Adorner").WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("WrapPanel", "", 1).WPFObject("StackPanel", "", 1).WPFObject("ComboBox", "", 1)
  objCombobox.DropDown
  Call objCombobox.Keys(strCountry)
  Delay(5000)
  Call objCombobox.Keys("[Enter]")  
  Call sEdgeProcessor
  Dim objEdgeLink
  Set objEdgeLink = Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("Adorner").WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 7).WPFObject("BarButtonItemLinkControl", "", 1).WPFObject("ContentControlEx", "Insert Link", 2)
		IF objEdgeLink.Enabled = True Then
      'Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("Adorner").WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 7).WPFObject("BarButtonItemLinkControl", "", 1).WPFObject("ContentControlEx", "Insert Link", 2).Click
      Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("Adorner").WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 7).WPFObject("BarButtonItemLinkControl", "", 1).WPFObject("ContentControlEx", "Insert Link", 2).Click
					 Call sEdgeProcessor
      strTCRemarks="Insert Link is opened to add the URL"
  Else
    strTCRemarks="Insert Link is Disabled"
    Exit Sub
  End if 
		
  
  Set objGridView= Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("LinkTableControl")
		Call objGridView.ClickCell(0, "Group")
  Call objGridView.ClickCell(0, "Group")
  Call objGridView.ClickCell(0, "Group")
  SYS.Keys "[Down][Enter]"
  Delay(1000)
  
  Call objGridView.ClickCell(0, "File Name / Address")
  Call objGridView.ClickCell(0, "File Name / Address")  
		Set objFileAddress =Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("LinkTableControl").WPFObject("LinkTableView").WPFObject("HierarchyPanel", "", 1).WPFObject("RowControl", "", 1).WPFObject("CellsControl", "", 1).WPFObject("LightweightCellEditor", "", 3).WPFObject("InplaceBaseEdit", "", 1).WPFObject("TextEdit", "", 1)  
		Call objFileAddress.Keys(strFooter)
		Call objFileAddress.Keys("[Tab]")
		Delay(1000)
		Set objFileAddress =Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("LinkTableControl").WPFObject("LinkTableView").WPFObject("HierarchyPanel", "", 1).WPFObject("RowControl", "", 1).WPFObject("CellsControl", "", 1).WPFObject("LightweightCellEditor", "", 4).WPFObject("InplaceBaseEdit", "", 1).WPFObject("TextEdit", "", 1)  
		Call objFileAddress.Keys(strFooter)
		Call objFileAddress.Keys("[Tab]")
		Delay(1000)
  Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarButtonItemLinkControl", "", 1).WPFObject("ContentControlEx", "Import", 2).Click
  Set objTemp = Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "Import Links").WPFObject("CustomMessageBoxWindow", "Import Links", 1).WPFObject("Grid", "", 1).WPFObject("PART_InactiveBorder")
 If objTemp.Exists = True then
      Sys.Keys("[Enter]")
   End If
  
  Call sCloseFileInsetLink()
  Delay(1000)
  Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("Adorner").WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 9).WPFObject("BarButtonItemLinkControl", "", 1).WPFObject("ContentControlEx", "Refresh", 2).Click
	 Call sEdgeProcessor 
  'Set gridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("Adorner").WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("FileRepositoryTableControl")
		strTemp = "WPFObject(""FileRepositoryTableControl"")"
		Set gridControl= Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).FindChild("Name",strTemp,50,True)
		intRowIndex=gridControl.FindRow("File Name / Address",strFooter)
  If intRowIndex>=0 then
   strTCRemarks="html / url in the country added Successfully"
			'msgbox intRowIndex &"Done"
  End If
		  
  Call sCloseFileMaintaince()
  
 
End Sub

Sub sLayoutFileRep(strParameters)

On Error Resume Next 
    Dim strLevel1layout,strLevel2layout,strLevel3layout,strWrkSpaceName
    Dim objNewWrkSpace_okbtn,objNewWrkSpace_Name
    Dim objNewWrkSpace_Txtbox,objopenforEdit,objWrkspace_popup
    Dim strTemp,objTemp,intRow,barManager,intTotNodeCnt,Text,objCellText,intl,intK,strDesc1,strDesc2
    Dim objWrkSpace,objwrkspacepop,objwrkspcUpload,objConfirm,objGridCell,DescLocalText,intSeriesID

    strLevel1layout=getSplitValue(strParameters,"LEVEL1LAYOUT")
    strLevel2layout=getSplitValue(strParameters,"LEVEL2LAYOUT")
    strLevel3layout=getSplitValue(strParameters,"LEVEL3LAYOUT")


    'strLevel1layout="dX Non-Asia Database (Current Eng Version)"
    'strLevel2layout="Z-Testing Topic(IT-use only)"
    'strLevel3layout="Sandbox (Benny)"

    strDesc1=aqDateTime.Now
    strDesc2=aqDateTime.Now
    DescText=Replace(strDesc1,"/","-")
    DescText=Replace(DescText,":","_")
    DescLocalText=DescText
    strWrkSpaceName=DescText
    'intSeriesID=getSplitValue(strParameters,"SERIESID")

    Delay 10000,"Please Wait..."

    ''Setting grid Objects
    call sloadLayout()
    'Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("LayoutTreeControl").WPFObject("LayoutTreeListView")
    Set GridControl = Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("LayoutTreeControl").WPFObject("LayoutTreeListView")
			 'Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("LayoutTreeControl")
				Set GridSourceTree = Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("LayoutTreeControl")
    Delay 10000,"Please Wait..."
    ''Selecting Level1 layout
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strLevel1layout) then
          GridControl.Nodes_2.Item(intI).ExpandAll
          log.Message "Level 1 Layout - " & GridControl.Nodes_2.Item(intI).Content.Description       
          blnFlag=False  
          Exit For
        End If
    Next
    Delay 10000,"Please Wait..."
    If blnFlag = True then
      strTCRemarks="Level 1 Layout not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
  
    blnFlag = True 
    ''Selecting Level2 Layout
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
    Delay 10000,"Please Wait..."
    For intJ=0 to intTotNodeCnt-1
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strLevel2layout) then
        GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).ExpandAll
        log.Message "Level2 layout Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
        blnFlag = False 
        Exit For
      End If
    Next
    Delay 10000,"Please Wait..."
    If blnFlag = True then
      strTCRemarks="Level2 Source Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If

    blnFlag = True    
    ''Selecting Level3 Layout
    Delay 10000,"Please Wait..."
      intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count
      For intK=0 to intTotNodeCnt-1
        If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description)=Ucase(strLevel3layout) then
          GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).ExpandAll
          intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).get_RowHandle
          'Call GridSourceTree.ClickCell(intRow, "Description")
          GridControl.set_FocusedRowHandle(intRow)
          GridControl.Keys("[Down]")
          GridControl.Keys("[Up]")  
          log.Message "Level3 layout Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description
          blnFlag = False
          Exit For   
        End If 
      Next
      If blnFlag = True then
        strTCRemarks="Level3 Source Name not found"
        strTestCaseResult="FAIL"
        Exit Sub
      End If
       Call sEdgeProcessor
 End Sub

Sub sFileRepositoryUsage(strParameters)
      On Error Resume Next   
      Dim edgeClient,tableView,hierarchyPanel,dockPanel,layoutGroup
      Dim objGrid,objGridControl
      Dim rowMarginControl,rowMarginControl2
      Dim objTemp,objRemoveButton,StrCountryname,strObject
      Dim objEdge,strTemp,objStrClose
      Dim ObjGridLoad,ObjGridClose,objEdgeMDI
      Dim objEdgeFilter
      
       CALL sLayoutFileRep(strParameters)
       StrCountry=getSplitValue(strParameters,"COUNTRY")
      'StrCountryname="Country: CHN"
  
        '' Opening File Repository Usage
      'set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1)
      Set objEdge= Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1)
						strTemp="WPFObject(""LayoutPanel"", """", 2)"					
      Set objTemp=objEdge.FindChild("Name",strTemp,5)
      If objTemp.Exists = False then
        'Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 2).WPFObject("BarSubItemLinkControl", "", 1).Click
        Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 2).WPFObject("BarSubItemLinkControl", "", 1).WPFObject("ContentControlEx", "File Repository", 2).Click
								Set objEdgeFilter= Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1)
       	strTemp="WPFObject(""ContentControlEx"", ""File Repository Usage"", 2)"
        Set objTemp=objEdgeFilter.FindChild("Name",strTemp,50)
        If objTemp.Exists = TRUE then
          Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarButtonItemLinkControl", "", 1).WPFObject("ContentControlEx", "File Repository Usage", 2).Click
          Call sEdgeProcessor
          strTemp="WPFObject(""LayoutPanel"", """", 2)"
          Set objTemp=objEdge.WaitChild(strTemp,50000)
          If objTemp.Exists = False then
            strTestCaseResult = "FAIL"
            Exit Sub
          End If
        else
          strTestCaseResult = "FAIL"
          Exit Sub
        End if
      End If
 
      strTCRemarks = "Opened File Repository Usage Form"
      Set edgeClient = Aliases.EdgeClient
      'Set objGridControl = Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("Adorner").WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 2).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 1).WPFObject("LayoutFileGridControl")
      'Set objGridControl = Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("Adorner").WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 2).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 1).WPFObject("LayoutFileGridControl")
						strTemp ="WPFObject(""LayoutFileGridControl"")"
						Set objGridControl = Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).FindChild("Name",strTemp,50,true)
						Call objGridControl.ClickColumnHeaderRXY("Group", 42, 9)
'						sys.Keys("^f")
'						Delay 500
     
      set objEdgeFilter= Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1)
      strTemp="WPFObject(""ContentControlEx"", ""Show Search Panel"", 2)"
      Set objTemp=objEdgeFilter.FindChild("Name",strTemp,50)
      If objTemp.Exists = TRUE then
        Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 11).WPFObject("BarButtonItemLinkControl", "", 1).WPFObject("ContentControlEx", "Show Search Panel", 2).Click
        Delay(10000)
      Else
        strTestCaseResult = "ABORT"
        Exit Sub  
      End If
      
      Set  tableView = objGridControl.WPFObject("LayoutFileTableView")
      Call tableView.Click(99, 17)
      Call tableView.Keys("Footnote")
      Delay(2000)
      'set objRemoveButton=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("Adorner").WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 2).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("RemoveLinkButton")
      Set objRemoveButton = Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("Adorner").WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 2).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("RemoveLinkButton")
						Delay(2000)
      If objRemoveButton.Enabled = True then
        Call objGridControl.ClickCell(0, "Group")
        Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("Adorner").WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 2).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("RemoveLinkButton").Click
        Delay(500)
        ''Clicking on Ok Button to Remove Footnote								
							'	Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: WindowContentHolder", "File Repository Usage").WPFObject("WindowContentHolder", "File Repository Usage", 1).WPFObject("NonLogicalDecorator", "", 1).WPFObject("ThemedManagedContentPresenter", "", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WaitChild(strTemp,50000)
        Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "File Repository Usage").WPFObject("CustomMessageBoxWindow", "File Repository Usage", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContentOffset").WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent")
        If objTemp.Exists Then
												strText =Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "File Repository Usage").WPFObject("CustomMessageBoxWindow", "File Repository Usage", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContentOffset").WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 1).WPFObject("DockPanel", "", 1).WPFObject("TextBlock_Message").Text
          		If Trim("Are you sure of removing this file association?") = Trim(strText) Then
													Sys.Keys("[Enter]")
												End If
								End If
        Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "File Repository Usage").WPFObject("CustomMessageBoxWindow", "File Repository Usage", 1).WPFObject("Grid", "", 1).WPFObject("PART_InactiveBorder")
'        Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "File Repository Usage").WPFObject("CustomMessageBoxWindow", "File Repository Usage", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContentOffset").WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent")
        If objTemp.Exists Then
												strText =Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "File Repository Usage").WPFObject("CustomMessageBoxWindow", "File Repository Usage", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContentOffset").WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 1).WPFObject("DockPanel", "", 1).WPFObject("TextBlock_Message").Text
		         		If Trim("Remove Successfully.") = Trim(strText) Then
														Sys.Keys("[Enter]")
												End If
        End If
        
        'Clicking on Close button(search)
        strTemp="WPFObject(""LayoutFileTableView"")"
        Set objTemp=Sys.Process("EdgeClient").FindChild("Name",strTemp,60,true)
        Call objTemp.Click(230, 16)
        Delay 5000
      Else
        'Clicking on Close button(search)
        strTemp="WPFObject(""LayoutFileTableView"")"
        Set objTemp=Sys.Process("EdgeClient").FindChild("Name",strTemp,60,true)
        Call objTemp.Click(230, 16)
        Delay 5000        
      End If 
      
      'Clicking on Add Link Button to add Datatalk
      strTemp="WPFObject(""AddLinkButton"")"
      Set objLinkButton=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,true)
      Call objLinkButton.Click
      
      Delay 5000,"Grid loading..."
      
    strTemp="WPFObject(""SelectionGrid"")"
    Set objGridControl = Sys.Process("EdgeClient").FindChild("Name",strTemp,50,true)    
    strTemp="WPFObject(""SelectionGridTableView"")"
    Set objTableView = Sys.Process("EdgeClient").FindChild("Name",strTemp,50,true)
    
    For i = 0 to objGridControl.wGroupCount-1
    If objGridControl.DataController.GroupInfo.Item(i).GroupValue.OleValue=strCountry then
        Call objGridControl.ExpandGroup(i,true)
        Call objTableView.set_FocusedRowHandle(objGridControl.DataController.GroupInfo.Item(i).Handle)
        Call objTableView.SelectRow(objGridControl.DataController.GroupInfo.Item(i).Handle)
        Delay 5000,"Loading Grid Rows"
        Exit For 
    End If
    Next
    
    Do While(objTableView.FocusedRowHandle<0)
    objTableView.Keys("[Down]")
    Loop
    
    blnTalk=False
    blnFootnote=False
    intCount=0
    
    Do While(blnTalk=False)
    If objTableView.FocusedRow.FileGroupId.OleValue="TALK" then
      strTemp="WPFObject(""OkButton"")"
      Set objOkButton=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,true)
      Call objOkButton.Click
      Delay 5000
      blnTalk=True
      strTCRemarks=strTCRemarks & "<br />" &"Datatalk added successfully"
      Exit Do
    Else
      objTableView.Keys("[Down]")
      intCount=intCount+1
      If intCount>100 then
        Exit Do
      End If
    End If
    Loop
    
    'Clicking on Add Link Button to add footnote
    strTemp="WPFObject(""AddLinkButton"")"
    Set objLinkButton=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,true)
    Call objLinkButton.Click
    
    Delay 5000,"Grid loading..."
    
    For i = 0 to objGridControl.wGroupCount-1
    If objGridControl.DataController.GroupInfo.Item(i).GroupValue.OleValue=strCountry then
        Call objGridControl.ExpandGroup(i,true)
        Call objTableView.set_FocusedRowHandle(objGridControl.DataController.GroupInfo.Item(i).Handle)
        Call objTableView.SelectRow(objGridControl.DataController.GroupInfo.Item(i).Handle)
        Delay 5000,"Loading Grid Rows"
        Exit For 
    End If
    Next
    
    Do While(objTableView.FocusedRowHandle<0)
    objTableView.Keys("[Down]")
    Loop
    
    intCount=0
    
    Do While(blnFootnote=False)
    If objTableView.FocusedRow.FileGroupId.OleValue="FOOTNOTE" then
      strTemp="WPFObject(""OkButton"")"
      Set objOkButton=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,true)
      Call objOkButton.Click
      Delay 5000
      blnFootnote=True
      strTCRemarks=strTCRemarks & "<br />" &"Footnote added successfully"
      Exit Do
    Else
      objTableView.Keys("[Down]")
      intCount=intCount+1
      If intCount>100 then
        Exit Do
      End If
    End If
    Loop
    
    Call CloseWindow
    Call CloseWindow
    
End Sub


Sub sCDMFootnote(strParameters)

On Error Resume Next 

  Dim objGrid,intRow,strTopic,intSectionCount,intI,intJ,intK,strSearch1,strs,strSearch2,strSearch3,strImage,strFootNote,strTemp

  strSearch1=getSplitValue(strParameters,"SEARCH1")
  strSearch2=getSplitValue(strParameters,"SEARCH2")
  
'  strSearch1="USA"
'  strSearch2="USA: National Accounts"

  strTemp="WinFormsObject(""GridEX_Tree"")"
  Set objGrid=Sys.Process("ISI.CeicDataManager.Startup").FindChild("Name",strTemp,15)
  If objGrid.Exists = True then
     intRow=objGrid.get_RowCount
  Else
    strTestCaseResult = "FAIL"
    Exit Sub
  End if
 ' Set objGrid=Sys.Process("ISI.CeicDataManager.Startup").WinFormsObject("CDMMain_MDIParent").WinFormsObject("MdiClient", "").WinFormsObject("Layout_Form").WinFormsObject("Panel_Rebar").WinFormsObject("GridEX_Tree")
  intRow=objGrid.get_RowCount

  ''Expanding Topic
  For IntI=0 to intRow-1
      objGrid.set_Row(intI)
      strTopic=objGrid.CurrentRow.DataRow.Row.TP_WSValue_Name.ToString
      If strTopic=strSearch1 then        
          objGrid.CurrentRow.set_Expanded(True)
          strFootNote=objGrid.CurrentRow.DataRow.Row.TP_HasFootnodes.OleValue
          Exit For
      End If
      'objGrid.CurrentRow.gr   
  Next
  ''Expanding Section
  For IntJ=1 to intRow
      objGrid.set_Row(intI + intJ)
      strTopic=objGrid.CurrentRow.DataRow.Row.SC_WSValue_Name.ToString
      If strTopic=strSearch2 then        
          objGrid.CurrentRow.set_Expanded(True)
          Exit For
      End If
  Next
  
  Dim ISI_CeicDataManager_Startup
  Dim objmdiClient
  Set ISI_CeicDataManager_Startup = Sys.Process("ISI.CeicDataManager.Startup")
  
  strTemp="WinFormsObject(""MdiClient"")"
  Set objmdiClient=Sys.Process("ISI.CeicDataManager.Startup").FindChild("Name",strTemp,15)
  If objmdiClient.Exists = True then
     If strFootNote = "Y" then
      Call objmdiClient.WinFormsObject("Layout_Form").WinFormsObject("Panel_Rebar").WinFormsObject("GridEX_Tree").Keys("~o")
  
      Dim objFootnote,strObject
  
      Set ISI_CeicDataManager_Startup = Sys.Process("ISI.CeicDataManager.Startup")
      strObject = "WinFormsObject(""Footnotes_Form"")"
      Set objFootnote = ISI_CeicDataManager_Startup.WaitChild(strObject, 650000)
      If objFootnote.Exists then
         objFootnote.Close
          sys.Keys("^[F4]")
          Delay 5000,"Footnote Created in CDM"
      End if
    End if   
  Else
    strTestCaseResult = "FAIL"
    Exit Sub
  End if
 
  strTemp="WinFormsObject(""GridEX_Tree"")"
  Set objGrid=Sys.Process("ISI.CeicDataManager.Startup").FindChild("Name",strTemp,15)
  If objGrid.Exists = True then
     intRow=objGrid.get_RowCount
  Else
    strTestCaseResult = "FAIL"
    Exit Sub
  End if

  ''Expanding Topic
  For IntI=0 to intRow-1
      objGrid.set_Row(intI)
      strTopic=objGrid.CurrentRow.DataRow.Row.TP_WSValue_Name.ToString
      If strTopic=strSearch1 then        
          objGrid.CurrentRow.set_Expanded(True)
          strImage=objGrid.CurrentRow.DataRow.Row.TP_HasDLinking.OleValue      
          Exit For
      End If
  Next
  ''Expanding Section
  For IntJ=1 to intRow
      objGrid.set_Row(intI + intJ)
      strTopic=objGrid.CurrentRow.DataRow.Row.SC_WSValue_Name.ToString
      If strTopic=strSearch2 then        
          objGrid.CurrentRow.set_Expanded(True)
          Exit For
      End If
  Next
  Dim objCDMMainMDIParent
  Dim objGridEX

  strTemp="WinFormsObject(""CDMMain_MDIParent"")"
  Set objCDMMainMDIParent=Sys.Process("ISI.CeicDataManager.Startup").FindChild("Name",strTemp,15)
  If objCDMMainMDIParent.Exists = True then
     strTemp="WinFormsObject(""GridEX_Tree"")"
     Set objGridEX=objCDMMainMDIParent.FindChild("Name",strTemp,15)
      if strImage="Y" then
         strTCRemarks = strTCRemarks & "<br />" & "Research Link Created Successfully in CDM"
      Else
         strTCRemarks = strTCRemarks & "<br />" &  "Research Link is not Created Successfully in CDM"  
      End if  
    
      'Delay(5000)
  Else
    strTestCaseResult = "FAIL"
    Exit Sub
  End if

  sys.Keys("~[F4]")
  strTemp="WinFormsObject(""CDMYesNoDialog"")"
  Set objTemp=Sys.Process("ISI.CeicDataManager.Startup").WaitChild(strTemp,5000)
  If objTemp.Exists = True then
    Sys.Process("ISI.CeicDataManager.Startup").WinFormsObject("CDMYesNoDialog").WinFormsObject("TableLayoutPanel1").WinFormsObject("UiButton_Yes").Click
    Delay 3000,"Closing CDM"
  End If
  
End Sub


Sub sLaunchANDClearCDM(strParameters)

On Error Resume Next 

  Dim objTemp,poProcess,strTemp,objtxtusr,objtxtpass,objCDM_MDI
  Dim strUserName,strPassword
  
'  strUserName="spoonguzhali"
'  strPassword="Alteer@20"
  
  strUserName=getSplitValue(strParameters,"USERNAME")
  strPassword=getSplitValue(strParameters,"PASSWORD")


  set objTemp = Sys.WaitProcess("ISI.CeicDataManager.Startup",2000)
  If objTemp.exists = False then
    Set wshShell = CreateObject ("WSCript.shell")
  	Set poProcess = wshShell.Exec("""C:\Program Files (x86)\ISI Emerging Markets\CEIC Data Manager\ISI.CeicDataManager.Startup.exe""")
  End If
  Set objTemp = Sys.WaitProcess("ISI.CeicDataManager.Startup",120000)
  If objTemp.exists = True then    
    while fCDM_MDI_Loaded = False    
    wend  
  End If

  strTemp="WinFormsObject(""Login_Dialog"")"
  Set objTemp=Sys.Process("ISI.CeicDataManager.Startup").WaitChild(strTemp,12000)
  If objTemp.Exists = True then
     strTemp="WinFormsObject(""TxBox_User"")"
     Set objtxtusr=objTemp.FindChild("Name",strTemp,1,True)
     If objtxtusr.Exists = True then
        objtxtusr.Text=""
        objtxtusr.Text=strUserName
     End If
     strTemp="WinFormsObject(""TxBox_Pass"")"
     Set objtxtpass=objTemp.FindChild("Name",strTemp,1,True)
     If objtxtpass.exists = True then
        objtxtpass.Text=""
        objtxtpass.Text=strPassword
     End If
     Sys.Process("ISI.CeicDataManager.Startup").WinFormsObject("Login_Dialog").WinFormsObject("Panel1").WinFormsObject("Button_OK")
     Call objTemp.WinFormsObject("Panel1").WinFormsObject("Button_OK").Click
      ''If Upgrade msg appears
       strTemp="WinFormsObject(""UpgradeWarning_From"")"
       Set objTemp=Sys.Process("ISI.CeicDataManager.Startup").WaitChild(strTemp,90000)
       If objTemp.Exists = True then
        Sys.Process("ISI.CeicDataManager.Startup").WinFormsObject("UpgradeWarning_From").WinFormsObject("TableLayoutPanel1").WinFormsObject("Panel4").WinFormsObject("Button_OK").Click
       End If
     
    Set objCDM_MDI=Sys.Process("ISI.CeicDataManager.Startup").WinFormsObject("CDMMain_MDIParent").WinFormsObject("TopRebar1").WinFormsObject("UiCommandBar1")
    Call objCDM_MDI.Keys("~n")
     
     Sys.Keys("[Down][Down][Down]") 
     Sys.KEYS("a")

    strTemp="WinFormsObject(""ClearCacheMsgBox_Form"")"
    Set objTemp=Sys.Process("ISI.CeicDataManager.Startup").WaitChild(strTemp,3000)
    If objtemp.Exists = True then
      Sys.Process("ISI.CeicDataManager.Startup").WinFormsObject("ClearCacheMsgBox_Form").WinFormsObject("TableLayoutPanel2").WinFormsObject("UiButton_OK").Click
    End If
     
     'Closing
    Sys.Process("ISI.CeicDataManager.Startup").WinFormsObject("CDMMain_MDIParent").Close

    strTemp="WinFormsObject(""CDMYesNoDialog"")"
    Set objTemp=Sys.Process("ISI.CeicDataManager.Startup").WaitChild(strTemp,5000)
    If objTemp.Exists = True then
      Sys.Process("ISI.CeicDataManager.Startup").WinFormsObject("CDMYesNoDialog").WinFormsObject("TableLayoutPanel1").WinFormsObject("UiButton_Yes").Click
      Delay 30000,"Closing CDM"
    End If
    strTCRemarks = "Cleared Cache in CDM Successfully"  
  End If
End Sub

'Sub sAutoHideGroupName(StrControlName)
Sub sAutoHideGroupName()
On Error Resume Next 

Dim objEdge,objCaption,i,objText,j

 StrControlName = "Check List"

  'Set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager")       
  Set objEdge =Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager")
  objText = objEdge.FindAllChildren("ClrClassName","AutoHideGroup", 10,True)
        For i=0 to ubound(objText)
          log.Message objText(i).FullName
          log.Message objText(i).Name
          objCaption = objText(i).FindAllChildren("ClrClassName", "AutoHidePaneHeaderItem",10,True)
          For j=0 to ubound(objCaption)
            log.Message objCaption(j).FullName
            log.Message objCaption(j).Name
            if objCaption(j).Content.Caption = StrControlName then 
                  log.Message objCaption(j).FullName
                  objCaption(j).Click
                  Exit For 
              End if 
          Next
        Next                      
End Sub 

Sub sLoadChineseKeySeries()
On Error Resume Next 
'strEnvi = "Edge ( US Integration )" 

  Dim strTemp,strObject
  Dim ObjGridLoad,ObjGridClose,objEdgeMDI,objTemp,objEdge,objEdgepopup

'    ''Opening Chinese Key Series
  'set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1)
	 Set objEdge= Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1)
	 If objEdge.Exists = False then
    'objEdgeMDI.WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("RibbonControl").WPFObject("RibbonSelectedPageControl", "", 1).WPFObject("RibbonPagesControl", "", 1).WPFObject("RibbonPageGroupsControl", "", 1).WPFObject("RibbonPageGroupControl", "", 1).WPFObject("BarItemLinkInfo", "", 23).WPFObject("BarSubItemLinkControl", "", 1).Click
    Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("RibbonControl").WPFObject("RibbonSelectedPageControl", "", 1).WPFObject("RibbonPagesControl", "", 1).WPFObject("RibbonPageGroupsControl", "", 1).WPFObject("RibbonPageGroupControl", "", 1).WPFObject("BarItemLinkInfo", "", 21).WPFObject("BarSubItemLinkControl", "", 1).Click
				'set objEdgepopup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarButtonItemLinkControl", "", 1)
    Set objEdgepopup= Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1)
				strTemp="WPFObject(""ContentControlEx"", ""Key Series Chinese Translation"", 2)"
    Set objTemp=objEdgepopup.FindChild("Name",strTemp,8,True)
    If objTemp.Exists = True then
      objTemp.Click
      'Call sEdgeProcessor
      log.Message "Opening Chinese Key Series"
    End if 
    strTemp="WPFObject(""LayoutPanel"", """", 1)"
    Set objTemp=objEdge.WaitChild(strTemp,50000)
    If objTemp.Exists = False then
      strTestCaseResult = "FAIL"
      Exit Sub
    End If
   ElseIf objTemp.Exists = True then
    If objTemp.Caption<>"Key Series Chinese Translation" then
      Call sCloseSource()
      'objEdgeMDI.WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("RibbonControl").WPFObject("RibbonSelectedPageControl", "", 1).WPFObject("RibbonPagesControl", "", 1).WPFObject("RibbonPageGroupsControl", "", 1).WPFObject("RibbonPageGroupControl", "", 1).WPFObject("BarItemLinkInfo", "", 23).WPFObject("BarSubItemLinkControl", "", 1).Click
      Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("RibbonControl").WPFObject("RibbonSelectedPageControl", "", 1).WPFObject("RibbonPagesControl", "", 1).WPFObject("RibbonPageGroupsControl", "", 1).WPFObject("RibbonPageGroupControl", "", 1).WPFObject("BarItemLinkInfo", "", 21).WPFObject("BarSubItemLinkControl", "", 1).Click
						Delay 1000,"Opening Chinese Key Series.."
      Sys.Keys "[Down][Enter]"
       Call sEdgeProcessor
      log.Message "Opening Chinese Key Series"
    
      strTemp="WPFObject(""LayoutPanel"", """", 1)"
      Set objTemp=objEdge.WaitChild(strTemp,50000)
      If objTemp.Exists = False then
        strTestCaseResult = "FAIL"
        Exit Sub
      End If
    End if 
  End If
 strTCRemarks = "Opened Chinese Key Series Form Successfully"  
 Set objTemp=Nothing
End Sub

Sub sUploadxlsfile(strParameters)
'Sub sUploadxlsfile()
On Error Resume Next 
 
  Dim strFileName,strFolderpath
  Dim strTemp,objEdge,objTemp ,strTemp1,strTemp2,strMyFileName
		Dim strOk,strClose
'  strEnvi = "Edge ( US Integration )"
'		strProjectFilesPath = aqEnvironment.GetEnvironmentVariable("USERPROFILE") & "\My Documents\EDGE Automation\EDGE\"
  strFileName=getSplitValue(strParameters,"Filename")
		strMyFileName = strFileName
  strFileName=strProjectFilesPath & "Files\" & strFileName
			
  
  Call sLoadChineseKeySeries()
 ' Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("DockPanel", "", 1).WPFObject("StackPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("TextBox", "", 1).Text=""
 	Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("DockPanel", "", 1).WPFObject("StackPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("TextBox", "", 1).Text = ""
	 Delay(200)

  strTemp="WPFObject(""Button"", ""..."", 1)"
  'set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("DockPanel", "", 1).WPFObject("StackPanel", "", 1).WPFObject("Grid", "", 1)
  set objEdge= Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("DockPanel", "", 1).WPFObject("StackPanel", "", 1).WPFObject("Grid", "", 1)
		Set objTemp=objEdge.FindChild("Name",strTemp,5)
  If objTemp.Exists = True then
    objTemp.Click
    Delay(500)
  Else 
    strTCRemarks="ABORT"
    Exit Sub
  End if 

  Sys.Process("EdgeClient").Window("#32770", "Open Key Series Chinese Translation File", 1).Window("ComboBoxEx32", "", 1).Window("ComboBox", "", 1).SetText(strFileName)
		Sys.Keys "[Enter]"
  Delay 3000,"Selecting a file,Pls Wait.."
  
  
		  'set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("DockPanel", "", 1).WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 1)
 	strTemp="WPFObject(""Button"", ""Upload"", 1)"
	 Set objEdge= Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("DockPanel", "", 1).WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 1)
		Set objTemp=objEdge.FindChild("Name",strTemp,5)
  If objTemp.Exists = True then
    objTemp.Click
    Call sEdgeProcessor
    'Delay 10000,"Uploading a file,Pls Wait.."
  Else 
    strTCRemarks="ABORT"
    Exit Sub
  End if 

  'Dim strOk,strClose
  Delay (500)
		strTemp="WPFObject(""PART_ContainerContent"")"
		WPFObject("PART_ContainerContent")
  'Set strOk=Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "Key Series Chinese Translation").WPFObject("CustomMessageBoxWindow", "Key Series Chinese Translation", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,50000)
  Set strOk= Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "Key Series Chinese Translation").WPFObject("CustomMessageBoxWindow", "Key Series Chinese Translation", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContentOffset").WPFObject("Grid", "", 1)
		If strOk.Exists Then
    Sys.Keys "Y"
  End If
  'Delay 10000,"Uploading a file,Pls Wait.."
   Call sEdgeProcessor
			strTemp =Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("DockPanel", "", 1).WPFObject("KeySeriesTranslationActionGridControl").WPFObject("KeySeriesTranslationActionTableView").WPFObject("HierarchyPanel", "", 1).WPFObject("RowControl", "", 1).WPFObject("CellsControl", "", 1).WPFObject("LightweightCellEditor", "", 4).WPFObject("PART_Editor").Text
			If strMyFileName = "test.xls" Then
						If Trim(strTemp)= Trim("Extension '.xls' is not supported. Supported extensions are '.xlsx' and '.xslm'.") Then
							strTCRemarks = "Vaildated File formate Successfully"
						End If
			ElseIf strMyFileName = "test1.xlsx" Then
				strTemp =Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("DockPanel", "", 1).WPFObject("KeySeriesTranslationActionGridControl").WPFObject("KeySeriesTranslationActionTableView").WPFObject("HierarchyPanel", "", 1).WPFObject("RowControl", "", 3).WPFObject("CellsControl", "", 1).WPFObject("LightweightCellEditor", "", 4).WPFObject("PART_Editor").Text
				strTemp1 =Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("DockPanel", "", 1).WPFObject("KeySeriesTranslationActionGridControl").WPFObject("KeySeriesTranslationActionTableView").WPFObject("HierarchyPanel", "", 1).WPFObject("RowControl", "", 2).WPFObject("CellsControl", "", 1).WPFObject("LightweightCellEditor", "", 4).WPFObject("PART_Editor").Text.OleValue
				strTemp2 = "Worksheet 'Topic_Changes' doesn't exist."
					If Trim(strTemp)= Trim("Couldn't found any changes in all worksheets.") And Instr(strTemp1,strTemp2) > 0 Then
							strTCRemarks = "Extension .xls is not supported. Supported extensions are .xlsx and .xslm." 
						End If
			
			End IF
		'strTCRemarks = "Vaildated File formate Successfully"  
  Call SCloseChinese()
End Sub

'Sub sUploadxlsxfile(strParameters)
Sub sUploadxlsxfile()
On Error Resume Next 
  Dim strFileName
  
  strFileName="test1.xlsx"
		'strEnvi = "Edge ( US Integration )"
 	strProjectFilesPath = aqEnvironment.GetEnvironmentVariable("USERPROFILE") & "\My Documents\EDGE Automation\EDGE\"
  
'  strFileName=getSplitValue(strParameters,"Filename")
'  strFileName=strProjectFilesPath & "Files\" & strFileName
  
  Call sLoadChineseKeySeries()
'  Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("DockPanel", "", 1).WPFObject("StackPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("TextBox", "", 1).Text=""
'  Delay(1000)
  Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("DockPanel", "", 1).WPFObject("StackPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("TextBox", "", 1).Text = ""
	 Delay(200)
		
  strTemp="WPFObject(""Button"", ""..."", 1)"
  'set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("DockPanel", "", 1).WPFObject("StackPanel", "", 1).WPFObject("Grid", "", 1)
  set objEdge= Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("DockPanel", "", 1).WPFObject("StackPanel", "", 1).WPFObject("Grid", "", 1)
		Set objTemp=objEdge.FindChild("Name",strTemp,5)
  If objTemp.Exists = True then
    objTemp.Click
    Delay(500)
  Else 
    strTCRemarks="ABORT"
    Exit Sub
  End if 

  'Sys.Process("EdgeClient").Window("#32770", "Open Key Series Chinese Translation File", 1)
  Sys.Process("EdgeClient").Window("#32770", "Open Key Series Chinese Translation File", 1).Window("ComboBoxEx32", "", 1).Window("ComboBox", "", 1).SetText(strFileName)
  Sys.Keys "[Enter]"
  Delay 5000,"Selecting a file,Pls Wait.."
  
  strTemp="WPFObject(""Button"", ""Upload"", 1)"
  'set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("DockPanel", "", 1).WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 1)
  Set objEdge= Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("DockPanel", "", 1).WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 1)
		Set objTemp=objEdge.FindChild("Name",strTemp,5)
  If objTemp.Exists = True then
    objTemp.Click
				Call sEdgeProcessor
    'Delay 10000,"Uploading a file,Pls Wait.."
  Else 
    strTCRemarks="ABORT"
    Exit Sub
  End if 
  
  'Delay(2000)
  Dim strOk,strClose
  
  strTemp="WPFObject(""PART_ContainerContent"")"
  'Set strOk=Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "Key Series Chinese Translation").WPFObject("CustomMessageBoxWindow", "Key Series Chinese Translation", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,50000)
  Set strOk= Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "Key Series Chinese Translation").WPFObject("CustomMessageBoxWindow", "Key Series Chinese Translation", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContentOffset").WPFObject("Grid", "", 1)
		If strOk.Exists Then
    Sys.Keys "Y"
  End If
  Call sEdgeProcessor
  'Delay 10000,"Uploading a file,Pls Wait.."
  Call SCloseChinese()
  strTCRemarks = "Extension .xls is not supported. Supported extensions are .xlsx and .xslm."  
End Sub

Sub SCloseChinese()
On Error Resume Next

  Dim objEdge,strTemp,objTemp, objStrClose
		'set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1)
		set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1)
  strTemp="WPFObject(""LayoutPanel"", """", 1)"
  Set objTemp=objEdge.FindChild("Name",strTemp,5)
  If objTemp.Exists = TRUE then
    If objTemp.Caption="Key Series Chinese Translation" Then
      set objStrClose= Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1)
      objStrClose.Closed=true
      Delay 2000,"Closing Key Series Chinese Translation..."
    End IF  
  End If 
End sub


Sub sCloseLayout()
On Error Resume Next
Dim objEdge,strTemp,objTemp, objStrClose
  'set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1)
  strTemp="WPFObject(""LayoutPanel"", """", 1)"
  Set objTemp=Sys.Process("EdgeClient").FindChild("Name",strTemp,50)
  If objTemp.Exists = TRUE then
      Set objStrClose=Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1)
						'Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1)
      objStrClose.Closed=true
      Delay 2000,"Closing Form..."
  Else
    log.message "No Window is opened to close"
    Exit Sub    
  End If  
End Sub

Sub sCloseFileInsetLink()

  On Error Resume Next
		'strEnvi = "Edge ( US Integration )"
  Dim objEdge,strTemp,objTemp, objStrClose
  
    strTemp ="WPFObject(""LayoutPanel"", """", 2)"
    Set objStrClose =Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).FindChild("Name",strTemp,10,True)
    objStrClose.Closed=true
    Delay(2000)
    
End Sub

Sub sCloseFileMaintaince()
		On Error Resume Next
		'strEnvi = "Edge ( US Integration )"
		Dim objEdge,strTemp,objTemp, objStrClose
  'set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1)
  Set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1)
	 If objEdge.Exists = True then
    'set objStrClose= Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1)
    objEdge.Closed=true
  End If  
End Sub

Sub sLaunchEDGE()

On Error Resume Next

    Dim objShell,WScript,objEdgeMDI,strObject,ObjCombo,objLoginOK,strObj,objsrc,strTemp,objTemp, objEDGEClient

    Set objTemp = Sys.FindChild("ProcessName","EdgeClient", 1,True)
    If objTemp.Exists then
      log.Message "EdgeClient application is already running"
      strTestCaseResult="PASS"
      strTCRemarks="EdgeClient application is already running"
      Exit Sub
    End If

    Set objShell = CreateObject("WScript.Shell")
    'strTemp = """" & aqEnvironment.GetEnvironmentVariable("USERPROFILE") & "\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\CEIC Data\Edge Client.appref-ms" & """"
    strTemp = """" & aqEnvironment.GetEnvironmentVariable("USERPROFILE") & "\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\CEIC Data\Edge Client.appref-ms" & """"
    objShell.Run(strTemp)
    Set objShell = Nothing
    Delay 15000,"Launching Edge..  Please wait.."

    Log.Message "Looking for Environment Combo"

    set objEDGEClient = Sys.WaitProcess("EdgeClient",600000,-1)

    If objEDGEClient.Exists = True Then
        Log.Message "Process 'EdgeClient' found " & objEDGEClient.Name 
    Else
        Log.Message "Unable to fetch 'EdgeClient' Process" 
        strTestCaseResult = "ABORT"
        strTCRemarks = "Unable to fetch 'EdgeClient' Process"
        Exit Sub                
    End If

    strTemp = "WPFObject(""ConnectionComboBox"")"
    Set objTemp=objEDGEClient.FindChild("Name",strTemp,15,True)
    If objTemp.Exists = True Then
      Log.Message "Combo box found " & objTemp.Name                 
      objTemp.Click
      objTemp.Keys "[Down][Down][Enter]"
      strTemp="WPFObject(""Button"", ""OK"", 1)"
      Set objTemp=objEDGEClient.FindChild("Name",strTemp,12,True)
      objTemp.Click  
    Else
      log.Message "Default Login"
    End If   
    strObject="WPFObject(""HwndSource: Shell"", """& strEnvi &""")"
    Set objEdgeMDI=Sys.Process("EdgeClient").WaitChild(strObject, 600000)
    If objEdgeMDI.Exists then
      Delay 10000,"Pls Wait.."
      strTemp="WPFObject(""HwndSource: Shell"", """& strEnvi &""")"
      Set objTemp=Sys.Process("EdgeClient").FindChild("Name",strTemp,25,True)
      If objTemp.Exists=True then
        Call objTemp.ClickR(614, 20)
        sys.Keys "[Down][Down][Down][Down][Down][Enter]"
        Delay 10000,"Pls Wait.."
      End If
    End If

    
    strTCRemarks = "EDGE is lauched"

    Set ObjCombo = Nothing
    Set ObjComboWindow = Nothing
   
End Sub


'Sub sHome_Source()
'On Error Resume Next
'
'  Call sOpenSourceDispalyViewer()
'  If Err.Number > 0 Then
'    Log.Error("Error in 'sHome_Source Fucntion is ' - " & Err.Description)
'    Err.Clear
'  End If
'
'End Sub 

Sub sAddMCFlag(strParameters)
'Sub sAddMCFlag
    
    On Error Resume Next
    Dim strSource_Name,strLevel2src_Name,objNewWrkSpace_okbtn,objNewWrkSpace_Name,strWrkSpaceName
    Dim objNewWrkSpace_Txtbox,objopenforEdit,objWrkspace_popup
    Dim strTemp,objTemp,intRow,barManager,intTotNodeCnt,Text,strDesc1,strDesc2
    Dim objWrkSpace,objwrkspacepop,objwrkspcUpload,objConfirm,objGridCell,DescLocalText,intSeriesID
    Dim layoutGroup
    Dim strTemp1,objNewWrkSpaceName

    strSource_Name=getSplitValue(strParameters,"SOURCE")
    strLevel2src_Name=getSplitValue(strParameters,"LEVEL2SOURCE")
'    strSource_Name="Test"
'    strLevel2src_Name="Automation"
'				strEnvi = "Edge ( US Integration )" 
    
       
    strDesc1=aqDateTime.Now
    strDesc2=aqDateTime.Now
    DescText=Replace(strDesc1,"/","-")
    DescText=Replace(DescText,":","_")
    MCFlag=Replace(DescText," ","K")
    MCFlag=Replace(MCFlag,"_","K")
    MCFlag=Replace(MCFlag,"-","K")
    DescLocalText=DescText
    strWrkSpaceName=DescText
				

   
   ' Call SelectLevel2Source(strSource_Name,strLevel2src_Name)   
   Call sGridSelection(strParameters)

''Clicking on "New Workspace" Button and selecting "Open for Edit(Souce)" option 
    strTemp="WPFObject(""ContentControlEx"", ""New Workspace"", 2)"
    Set objNewWorkspace=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,True)
    If objNewWorkspace.Exists = True then
      objNewWorkspace.Click
'      strTemp="WPFObject(""BarPopupBorderControl"", """", 1)"
'      Set objWrkspace_popup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").FindChild("Name",strTemp,5,True)
'      If objWrkspace_popup.Exists = True then
        strTemp="WPFObject(""ContentControlEx"", ""Open For Edit (Source)"", 2)"
        Set objopenforEdit=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,True)
        If objopenforEdit.Exists then
          objopenforEdit.Click    
          'Delay 20000,"Please Wait..."
        End If
'      End If




      strTemp1="WPFObject(""HwndSource: WorkspaceNamePrompt"", ""Please provide a new Workspace Name"")"
      Set objNewWrkSpaceName=Sys.Process("EdgeClient").WaitChild(strTemp1,50000)
      If objNewWrkSpaceName.Exists = True then
     
      ''Waiting for Workspace Name prompt
      strTemp="WPFObject(""HwndSource: WorkspaceNamePrompt"", ""Please provide a new Workspace Name"")"
      Set objNewWrkSpace_Name=Sys.Process("EdgeClient").WaitChild(strTemp,60000)
        If objNewWrkSpace_Name.Exists = True then
          strTemp="WPFObject(""ChangeNameTextEdit"")"
          ''Entering Workspace Name
          Set objNewWrkSpace_Txtbox=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
            If objNewWrkSpace_Txtbox.Exists = True then
              objNewWrkSpace_Txtbox.Click
              objNewWrkSpace_Txtbox.Text=strWrkSpaceName
      '        strTCRemarks=strTCRemarks & Chr(10) & "Entered Workspace Name - " & strWrkSpaceName
              ''Clicking on Ok Button 
              strTemp="WPFObject(""OkButton"")"
              Set objNewWrkSpace_okbtn=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
              If objNewWrkSpace_okbtn.Exists = True then
                objNewWrkSpace_okbtn.Click
                'Delay 5000,"Please wait..."
              End If
            End If
        End If
      End if
    End If

    ''Handling Validation for Source
    strTemp="WPFObject(""HwndSource: WindowContentHolder"", """")"
    Set objTemp=Sys.Process("EdgeClient").WaitChild(strTemp,10000)
    If objTemp.Exists = True then
      objTemp.Keys "[Enter]"
      strTestCaseResult = "FAIL"
      Exit Sub
    End If



    ''WorkSpace Edit Window
    strTemp="WPFObject(""LayoutPanel"", """", 2)"
    Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).FindChild("Name",strTemp,13,True)
    If objTemp.Exists then
'        Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WPFObject("SourceTreeListView")
'        Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl")
								Set GridControl= Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WPFObject("SourceTreeListView")
        Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl")
        ''Expanding First Node in Tree      
        intTotNodeCnt=GridControl.Nodes_2.Count  
        For intI=0 to intTotNodeCnt-1         
          If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource_Name) then
            GridControl.Nodes_2.Item(intI).ExpandAll
            blnFlag=False  
            Exit For
          End If
        Next
    
        ''Expanding Second Node in Tree
        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
        For intJ=0 to intTotNodeCnt-1
          If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strLevel2src_Name) then
            GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).ExpandAll
            intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(0).get_RowHandle
            GridControl.Keys "^[Home]"
'            Set objGridCell=GridControl.WPFObject("HierarchyPanel", "", 1).WPFObject("GridRow", "", intRow).WPFObject("ScrollablePart").WPFObject("CellItemsControl", "", 1).WPFObject("GridCellContentPresenter", "", 1).WPFObject("TextEdit", "", 1)
            Call GridControl.ClearSelectionCore
            Call GridControl.FocusViewAndRow(GridControl,intRow-1)
            GridControl.SetFocusOnCurrentItem
            Call GridControl.SelectRowCore(intRow-1)
        
'            If objGridCell.Exists = True then
'              objGridCell.Click
'    '          strTCRemarks=strTCRemarks & Chr(10) & "Selected - " & strLevel2src_Name
'            End If
            blnFlag = False 
            Exit For
          End If
        Next
    
        ''Clicking on New Folder
    '   strTemp="WPFObject(""BarButtonItemLinkControl"", """", 1)"
        Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 4).WPFObject("BarButtonItemLinkControl", "", 1)
        If objTemp.Exists = True then
          Delay 3000,"New Folder..."
          objTemp.Click
          Delay 8000,"New Folder..."
        End If
    
        ''Getting no. of Rows under level 2
        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count
        intK=intTotNodeCnt-1
    
        Set objDescCell=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK)
        Call objDescCell.Content.set_Description(DescText)
        Call objDescCell.Content.set_DescriptionLocal(DescLocalText)
        'Call objDescCell.Content.set_MacroCapFlag(MCFlag)
                
        Call sCloseSource
        'Adding macro cap flag
        Call GridControl.MoveFocusedRowToLastScrollRow
        Delay 1000
        Call GridControl.MoveFirstCell
        Delay 1000
        Sys.Keys "[Tab]"
        Delay 1000
        Sys.Keys "[Tab]"
        Delay 1000
        Sys.Keys "[Tab]"
        Delay 1000
        Sys.Keys "[Tab]"
        Delay 1000
        Sys.Keys "[Tab]"
        Delay 1000
        Sys.Keys "[Tab]"
        Delay 1000
        Sys.Keys "[Tab]"
        Delay 1000
        Sys.Keys "[Tab]"
        Delay 1000
        Sys.Keys "[Tab]"
        Delay 1000
        Sys.Keys "[Tab]"
        Delay 1000
        Sys.Keys "[Tab]"
        Delay 1000
        Sys.Keys(MCFlag)
        Delay 1000
        
'        'Adding macro cap flag
'        'Set objHPanel=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WPFObject("SourceTreeListView").WPFObject("HierarchyPanel", "", 1)
'        Set objHPanel=Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WPFObject("SourceTreeListView").WPFObject("HierarchyPanel", "", 1)
'				objRowControl = objHPanel.FindAllChildren("ClrClassName","RowControl",10,true)        
'        For i = 0 to ubound(objRowControl)
'         'If IsNull(objRowControl(i).DataContext.Row)=False and i>0 then
'         If Not IsEmpty(objRowControl(i).DataContext.Row) and Not IsNull(objRowControl(i).DataContext.Row)and Not objRowControl(i).DataContext.Row IS Nothing then
'          If objRowControl(i).DataContext.Row.Description=DescText then             
'            objCellArray = objRowControl(i).FindAllChildren("ClrClassName","LightweightCellEditor",10,true)
'            For j = 0 to ubound(objCellArray) + 10         
'            If Not IsEmpty(objCellArray(j).Column) and Not IsNull(objCellArray(j).Column)and Not objCellArray(j).Column IS Nothing then
'             If objCellArray(j).Column.Header.OleValue="Macro Cap Flag" then       
'              objCellArray(j).Click
'              Sys.Keys(MCFlag)             
'              Exit For
'             End If
'             End If
'             Next
'          End If          
'         End If 
'        Next
        
        'Clicking on workspace item to generate ATP confirmation
        strTemp="WPFObject(""ContentControlEx"", ""Workspace"", 2)"
        Set objWorkspace=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,true)
        objWorkspace.Click
        
        Delay 2000
        
        Set objConfirm=Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "Confirm")
        If objConfirm.Exists = true then
         strTemp="WPFObject(""Button_Yes"")"
         Set objYesButton=objConfirm.FindChild("Name",strTemp,50,true)
         objYesButton.Click
         'Sys.Keys("Y")
        End If
        
        'Attach series
        strTemp="WPFObject(""ContentControlEx"", ""Attach Series"", 2)"
        Set objAttach=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,true)
        objAttach.Click
        
        strTemp="WPFObject(""SeriesIdTextEdit"")"
        Set objText=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,true)
        If objText.Exists=True then
          objText.Text="368765647"
          strTemp="WPFObject(""OkButton"")"
          Set objOKButton=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,true)
          Call objOKButton.Click
        End If
        
        'Clicking on workspace to upload
        While Not objWorkspace.Enabled
         Delay 1000
        Wend
        Call objWorkspace.Click
        
        strTemp="WPFObject(""ContentControlEx"", ""Upload Workspace"", 2)"
        Set objUpload=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,true)
        objUpload.Click
        
        Set objConfirm=Sys.Process("EdgeClient").WPFObject("HwndSource: WindowContentHolder", "Confirm")
        If objConfirm.Exists = true then
         Sys.Keys("[Enter]")
        End If
        
        strTemp="WPFObject(""HwndSource: CustomMessageBoxWindow"", ""Upload Workspace"")"
        Set objUploadConfirm=Sys.Process("EdgeClient").WaitChild(strTemp,30000)
        If objUploadConfirm.Exists=true then
         Sys.Keys("O")         
        End If
                
        Call sEdgeProcessor
        
        'opening source window
        Call sHome_Source 
        
        'selecting level3 source to verify macro cap flag
        Call SelectLevel3Source(strSource_Name,strLevel2src_Name,DescText)
        Call sGridSelection(strParameters)
        
        strTemp="WPFObject(""SourceTreeListView"")"
        Set GridControl=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,True)
        
        set objRow=GridControl.get_SelectedRows
        
        If objRow.Item(0).MacroCapFlag.OleValue=MCFlag then
          strTCRemarks=MCFlag&" : Successfully added Macro CAP Flag to level3 source folder"
        End If
        
        Call sCloseSource
        
        'opening source window
        Call sHome_Source 
        
        'Selecting level2source
        Call SelectLevel2Source(strSource_Name,strLevel2src_Name)      

        
'        'Right-click on the selected level2 row
'        strTemp="WPFObject(""SourceTreeListView"")"
'        Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
'        strTemp="WPFObject(""SourceTreeControl"")"
'        Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
'         
'        objRowControl = GridControl.FindAllChildren("ClrClassName","RowControl",10,true)        
'        For i = 0 to ubound(objRowControl)
'        log.Message objRowControl(i).DataContext.Row.Description
'        If objRowControl(i).DataContext.Row.Description=strLevel2src_Name then 
'          objRowControl(i).ClickR
'          Exit For
'        End If
'        Next
'        
'        'Clicking/selecting ATP from context-menu        
'        strTemp="WPFObject(""ContentControlEx"", ""ATP"", 2)"
'        Set objATP=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,true)
'        objATP.Click
        
        intResult=SourceClickR(strLevel2src_Name)        
        If intResult<>0 then
          Call SourceClickR(strLevel2src_Name)
        End If
        intResult=SourceClickR(strLevel2src_Name)        
        If intResult<>0 then
          Call SourceClickR(strLevel2src_Name)
        End If
        intResult=SourceClickR(strLevel2src_Name)        
        If intResult<>0 then
          Call SourceClickR(strLevel2src_Name)
        End If
        intResult=SourceClickR(strLevel2src_Name)        
        If intResult<>0 then
          Call SourceClickR(strLevel2src_Name)
        End If
        intResult=SourceClickR(strLevel2src_Name)        
        If intResult<>0 then
          Call SourceClickR(strLevel2src_Name)
        End If
        
        'Clicking/selecting macro cap flag
        strTemp="WPFObject(""ContentControlEx"", """&MCFlag&""", 2)"
        Set objMCFlag=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,true)
        If objMCFlag.Exists=true then
          objMCFlag.Click
          strTCRemarks=strTCRemarks & "<br />" & "Added Macro CAP Flag is found under ATP menu"
        End If
        
        'opening ATP file
        strTemp="WPFObject(""ContentControlEx"", ""Open"", 2)"
        Set objOpen=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,true)
        If objOpen.Exists=true then
          objOpen.Click
        End If
        
        Delay 40000,"Opening ATP file..."
        
        'Close ATP file
        objArray = Sys.FindAllChildren("ProcessName","EXCEL", 5,True)
        For i=0 to ubound(objArray)
          set oSTP_ExcelObj = objArray(i).FindChild("WndCaption", "*"&MCFlag&"*",1,True)
          If oSTP_ExcelObj.Exists = True Then
            'Set netUIHWND = Aliases.EXCEL.wndXLMAIN.EXCEL2.toolbarRibbon.Ribbon.NUIPane.NetUIHWND
          '  Set netUIHWND =  Sys.Process("EXCEL", 2).Window("XLMAIN", strTestDataFile &"*", 1).Window("EXCEL2", "", 2).Window("MsoCommandBar", "Ribbon", 1).Window("MsoWorkPane", "Ribbon", 1).Window("NUIPane", "", 1).Window("NetUIHWND", "", 1)
            Set netUIHWND=  Aliases.EXCEL.wndXLMAIN.EXCEL2.Ribbon.Ribbon.NUIPane.NetUIHWND
            Call netUIHWND.Click(604, 40)
            Delay 10000,"ATP file..."
            objArray(i).Close
            strTCRemarks=strTCRemarks & "<br />" & "Successfully opened ATP file"
          End If
         Next       
        Call sCloseSource
    End If
End Sub

Function SourceClickR(strLevel2src_Name)
      'Right-click on the selected level2 row
      
			 'strEnvi = "Edge ( US Integration )" 
        strTemp="WPFObject(""SourceTreeListView"")"
        Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).FindChild("Name",strTemp,50,True)
        strTemp="WPFObject(""SourceTreeControl"")"
        Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).FindChild("Name",strTemp,50,True)
         
        objRowControl = GridControl.FindAllChildren("ClrClassName","RowControl",10,true)        
        For i = 0 to ubound(objRowControl)
        log.Message objRowControl(i).DataContext.Row.Description
        If objRowControl(i).DataContext.Row.Description=strLevel2src_Name then 
          objRowControl(i).ClickR
          Exit For
        End If
        Next
        
        'Clicking/selecting ATP from context-menu        
        strTemp="WPFObject(""ContentControlEx"", ""ATP"", 2)"
        Set objATP=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,true)
        objATP.Click
        
        SourceClickR=Err.Number

End Function

Function  SelectLevel3Source(strLevel1,strLevel2,strLevel3)
'Sub SelectLevel3Source()
'    strEnvi = "Edge ( US Integration )"   
'    strLevel1 = "Test"
'    strLevel2 = "CopySeries_1"
'    strLevel3 = "FirstFolder1"  

on Error Resume Next 

  Dim IntCount(4)
      
    strTemp="WPFObject(""SourceTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""SourceTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).FindChild("Name",strTemp,50,True)
    Delay 1000,"Pls Wait.."
    ''Selecting Country Name
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strLevel1) then
          GridControl.Nodes_2.Item(intI).ExpandAll                        
          intRow=GridControl.Nodes_2.Item(intI).get_RowHandle
          GridControl.Keys "^[Home]"
          Call GridControl.ClearSelectionCore
          Call GridControl.FocusViewAndRow(GridControl,intRow)
          GridControl.SetFocusOnCurrentItem
          Call GridControl.SelectRowCore(intRow)
          IntCount(0) = intI
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description                 
    '     strTCRemarks=strTCRemarks & Chr(10) & "Selected Node - " & GridControl.Nodes_2.Item(intI).Content.Description  
          blnFlag=False  
          Exit For
        End If
    Next
    If blnFlag = True then
      strTCRemarks="Country Name not found"
      strTestCaseResult="FAIL"
      Exit Function 
    End If
  
    Delay 1000,"Pls Wait.."
        blnFlag = True 
    ''Selecting Level2Source_Name
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
  For intJ=0 to intTotNodeCnt-1
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strLevel2) then
          '    intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(0).get_RowHandle        
'        Call GridSourceTree.ClickCell(intRow, "Edit")
        GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).ExpandAll
         intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
        'GridControl.Keys "^[Home]"       
        'Call GridControl.ClearSelectionCore
        Call GridControl.FocusViewAndRow(GridControl,intRow)
        GridControl.SetFocusOnCurrentItem
        Call GridControl.SelectRowCore(intRow)
        IntCount(1) = intJ
        log.Message "Level2 Source Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
        blnFlag = False 
        Exit For
      End If
    Next
    If blnFlag = True then
      log.Message "Level2 Source Name not found"
      strTCRemarks="Level2 Source Name not found"
      strTestCaseResult="FAIL"
      Exit Function 
    End If
    Delay 1000,"Pls Wait.."
    
    ''Selecting Level3Source_Name
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count
  For intK=0 to intTotNodeCnt-1
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description)=Ucase(strLevel3) then       
        intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).get_RowHandle
       ' Call GridControl.ClearSelectionCore
        Call GridControl.FocusViewAndRow(GridControl,intRow)
        GridControl.SetFocusOnCurrentItem
        Call GridControl.SelectRowCore(intRow)
        IntCount(2) = intK
        'log.Message "Level2 Source Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
        blnFlag = False 
        Exit For
      End If
    Next
    If blnFlag = True then
      'log.Message "Level2 Source Name not found"
      strTCRemarks="Level3 Source Name not found"
      strTestCaseResult="FAIL"
      Exit Function 
    End If
    Delay 2000,"Pls Wait.."  
    SelectLevel3Source = IntCount

End Function

Sub SelectLevel2Source(strLevel1,strLevel2)

    strSource_Name=strLevel1
    strLevel2src_Name=strLevel2
    
   
     strTemp="WPFObject(""SourceTreeListView"")" 
					'Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", "Edge ( US Integration )").WPFObject("Shell", "Edge ( US Integration )", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("SourceTreeControl").WPFObject("SourceTreeListView")   
     Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).FindChild("Name",strTemp,50,True)
     'Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
     strTemp="WPFObject(""SourceTreeControl"")"    
					'Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", "Edge ( US Integration )").WPFObject("Shell", "Edge ( US Integration )", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("SourceTreeControl")
     'Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").FindChild("Name",strTemp,50,True)
     Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).FindChild("Name",strTemp,50,True)
     Delay 5000,"Pls Wait.."
     ''Selecting Country Name
     intTotNodeCnt=GridControl.Nodes_2.Count
     For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource_Name) then
								 	'GridControl.Nodes_2.Item(intI).Expand(True)
										GridControl.Nodes_2.Item(intI).ExpandAll          
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description       
    '      strTCRemarks=strTCRemarks & Chr(10) & "Selected Node - " & GridControl.Nodes_2.Item(intI).Content.Description  
          blnFlag=False  
          Exit For
        End If
    Next
    If blnFlag = True then
      strTCRemarks="Country Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
  
    Delay 5000,"Pls Wait.."
        blnFlag = True 
    ''Selecting Level2Source_Name
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
  For intJ=0 to intTotNodeCnt-1
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strLevel2src_Name) then
        GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).ExpandAll
    '    intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(0).get_RowHandle
        intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
'        Call GridSourceTree.ClickCell(intRow, "Edit")
        Call GridControl.ClearSelectionCore
        Call GridControl.FocusViewAndRow(GridControl,intRow)
        GridControl.SetFocusOnCurrentItem
        Call GridControl.SelectRowCore(intRow)
        log.Message "Level2 Source Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
        blnFlag = False 
        Exit For
      End If
    Next
    If blnFlag = True then
      log.Message "Level2 Source Name not found"
      strTCRemarks="Level2 Source Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
    Delay 2000,"Pls Wait.."

End Sub




Sub DropSourceSchWS()

On Error Resume Next
  strTemp="WPFObject(""ContentControl"", ""Source Workspace"", 1)"
  Set objSourceWSVwr=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,true)
  Call objSourceWSVwr.Click
  Call sEdgeProcessor
  strTemp="WPFObject(""ContentControlEx"", ""Source Schedules"", 2)"
  Set objSourceSch=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,true)
  Call objSourceSch.Click
  Delay 5000
  ''Selecting Records
      strTemp="WPFObject(""PendingChangeGridControl"")"
      Set GridControl=Sys.Process("EdgeClient").FindChild("Name",strTemp,60,True)
      intRowcnt=GridControl.wRowCount
      For intI=0 to intRowcnt-1
        Call GridControl.ClickCell(0,1)
        strTemp="WPFObject(""ContentControlEx"", ""Drop"", 2)"
        Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,20,True)
        If objTemp.Exists = True then
          objTemp.Click
        End If
        strTemp="WPFObject(""PART_ContainerContent"")"
         Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "Please Confirm.").FindChild("Name",strTemp,50,True)
        If objTemp.Exists = True then
          Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "Please Confirm.").WPFObject("CustomMessageBoxWindow", "Please Confirm.", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").Click
          Sys.Keys("Y")
          Call sEdgeProcessor
          

        End If
      Next
      Call sCloseSource()
End Sub


Sub SourceWorkSpacevwr()

On Error Resume Next
  strLocalname=getSplitValue(strParameters,"WORKSPACENAME")
  'strEnvi = "Edge ( Development Test )" 

    Dim strObject,objEdgeMDI,strTemp,objTemp,GridControl,intRowcnt,intI,intRow

    'strObject = "WPFObject(""HwndSource: RibbonWindow"")"
    Set objEdgeMDI = Sys.Process("EdgeClient")
    If objEdgeMDI.Exists then
      strTemp="WPFObject(""TextBlock"", ""Layout"", 1)"
      Set objTemp=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,true)
      If objTemp.Exists = False then
        strTemp="WPFObject(""ContentControl"", ""Source Workspace"", 1)"
        Set objTemp=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,true)
        If objTemp.Exists = True then
          objTemp.Click
        End If
        'Delay 8000,"Opening Source Workspace.."
        Call sEdgeProcessor
        log.Message "Opening Source Workspace.."
'        strTCRemarks="Opening Source Workspace.."
      Else
        log.Message "Source Workspace is opened"
'        strTCRemarks="Source Workspace is opened"
        'Exit Sub 
      End If
  
      ''Selecting Records
      strTemp="WPFObject(""PendingChangeGridControl"")"
'      Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("SourcePendingChangeTabControl").WPFObject("BarManager", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 1).WPFObject("PendingChangeGridControl")
'                      Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("PendingChangeGridControl")
      Set GridControl=Sys.Process("EdgeClient").FindChild("Name",strTemp,60,True)
      'intRowcnt=GridControl.wRowCount
      intRowcnt=GridControl.VisibleRowCount
      For intI=0 to intRowcnt-1
        'intRow=GridControl.FindRow(1,"Workspace Name")
        'Call GridControl.ClickCell(0,1)
        Set objCell = Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("PendingChangeGridControl").WPFObject("PendingChangeTableView").WPFObject("HierarchyPanel", "", 1).WPFObject("RowControl", "", 1).WPFObject("CellsControl", "", 1).WPFObject("LightweightCellEditor", "", 1).WPFObject("InplaceBaseEdit", "", 1)
        objCell.Click   
        strWorkspaceNameActual = Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("PendingChangeGridControl").WPFObject("PendingChangeTableView").WPFObject("HierarchyPanel", "", 1).WPFObject("RowControl", "", 1).WPFObject("CellsControl", "", 1).WPFObject("LightweightCellEditor", "", 1).WPFObject("InplaceBaseEdit", "", 1).DisplayText
        strTemp="WPFObject(""ContentControlEx"", ""Drop"", 2)"
        Set objTemp=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,true)
        If objTemp.Exists = True then
          objTemp.Click
        End If
        strTemp="WPFObject(""HwndSource: CustomMessageBoxWindow"", ""Please Confirm."")"
       ' Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: WindowContentHolder", "Please Confirm.").FindChild("Name",strTemp,50,True)
        Set objTemp=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,True)
'        strTemp="WPFObject(""DXMessageBox"", """", 1)"
'        Set objTemp=objTemp.WaitChild(strTemp,50000)
        If objTemp.Exists = True then
          'Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "Please Confirm.").WPFObject("CustomMessageBoxWindow", "Please Confirm.", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").Click
          objTemp.Click
          Sys.Keys("Y")
          'Delay 15000,"Pls Wait..."
          Call sEdgeProcessor
          
          'Call Aliases.EdgeClient.HwndSource_RibbonWindow.RibbonWindow.ContentControl.Grid.Grid.ContentControl.Grid.ContentControl.PART_ContainerContent.BarManager.DockPanel.DockLayoutManager.LayoutGroup.LayoutPanel.Click(1296, 11)
          'Delay 5000,"Pls Wait..."
        End If 
      Next
      Call sCloseSource()
    Else
      log.Message "RibbonWindow not found"
    End If

End Sub


Sub SourceWorkSpacevwr_BM(strParameters)

On Error Resume Next
  strLocalname=getSplitValue(strParameters,"WORKSPACENAME")

    Dim strObject,objEdgeMDI,strTemp,objTemp,GridControl,intRowcnt,intI,intRow

    'strObject = "WPFObject(""HwndSource: RibbonWindow"")"
    Set objEdgeMDI = Sys.Process("EdgeClient")
    If objEdgeMDI.Exists then
      strTemp="WPFObject(""TextBlock"", ""Layout"", 1)"
      Set objTemp=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,true)
      If objTemp.Exists = False then
        strTemp="WPFObject(""ContentControl"", ""Source Workspace"", 1)"
        Set objTemp=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,true)
        If objTemp.Exists = True then
          objTemp.Click
        End If
        'Delay 8000,"Opening Source Workspace.."
        Call sEdgeProcessor
        log.Message "Opening Source Workspace.."
'        strTCRemarks="Opening Source Workspace.."
      Else
        log.Message "Source Workspace is opened"
'        strTCRemarks="Source Workspace is opened"
        'Exit Sub 
      End If
  
      ''Selecting Records
      strTemp="WPFObject(""PendingChangeGridControl"")"
'      Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("SourcePendingChangeTabControl").WPFObject("BarManager", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 1).WPFObject("PendingChangeGridControl")
'                      Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("PendingChangeGridControl")
      Set GridControl=Sys.Process("EdgeClient").FindChild("Name",strTemp,60,True)
      intRowcnt=GridControl.wRowCount
      For intI=0 to intRowcnt-1
        'intRow=GridControl.FindRow(1,"Workspace Name")
        Call GridControl.ClickCell(0,1)
        strWorkspaceNameActual = Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("PendingChangeGridControl").WPFObject("PendingChangeTableView").WPFObject("HierarchyPanel", "", 1).WPFObject("RowControl", "", 1).WPFObject("CellsControl", "", 1).WPFObject("LightweightCellEditor", "", 1).WPFObject("InplaceBaseEdit", "", 1).DisplayText
      If InStr(strWorkspaceNameActual,strLocalname)> 0 Then    
        strTemp="WPFObject(""ContentControlEx"", ""Drop"", 2)"
        Set objTemp=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,true)
        If objTemp.Exists = True then
          objTemp.Click
        End If
        strTemp="WPFObject(""HwndSource: CustomMessageBoxWindow"", ""Please Confirm."")"
       ' Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: WindowContentHolder", "Please Confirm.").FindChild("Name",strTemp,50,True)
        Set objTemp=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,True)
'        strTemp="WPFObject(""DXMessageBox"", """", 1)"
'        Set objTemp=objTemp.WaitChild(strTemp,50000)
        If objTemp.Exists = True then
          'Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "Please Confirm.").WPFObject("CustomMessageBoxWindow", "Please Confirm.", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").Click
          objTemp.Click
          Sys.Keys("Y")
          'Delay 15000,"Pls Wait..."
          Call sEdgeProcessor
          
          'Call Aliases.EdgeClient.HwndSource_RibbonWindow.RibbonWindow.ContentControl.Grid.Grid.ContentControl.Grid.ContentControl.PART_ContainerContent.BarManager.DockPanel.DockLayoutManager.LayoutGroup.LayoutPanel.Click(1296, 11)
          'Delay 5000,"Pls Wait..."
        End If
  End If
      Next
      Call sCloseSource()
    Else
      log.Message "RibbonWindow not found"
    End If

End Sub

Sub sHome_Layout()
 On Error Resume Next 
  
  Delay 2000 , "Please Wait"
    Dim objEdgeMDI,strObject,strObj,objsrc,strTemp
    'strEnvi = "Edge ( US Production Release Test )" 
    strEnvi = "Edge ( US Integration )"   
    strObject = "WPFObject(""HwndSource: Shell"", """& strEnvi &""")"
    Set objEdgeMDI = Sys.Process("EdgeClient").WaitChild(strObject, 600000)
    If objEdgeMDI.Exists then    
        strTemp="WPFObject(""TextBlock"", ""Layout"", 1)"      
        Set objTemp=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,True)
        If objTemp.Exists = False then
          Call SClosesource()        
          strTemp="WPFObject(""ContentControl"", ""Layout"", 1)"  
          Delay 200        
          Call sObjClick(strTemp)
          Call sEdgeProcessor
          log.Message "Layout Module is Openinig"       
        Else
		      strTemp="WPFObject(""ContentControl"", ""Layout"", 1)"
          Delay 200        
          Call sObjClick(strTemp)
          Call sEdgeProcessor
          log.Message "Layout Module is Openinig" 
        End If	
     Else
      log.Message "RibbonWindow not found"
      strTestCaseResult = "FAIL"
      Exit Sub
    End If

    If Err.Number <> 0 then
      Log.Message Err.Description 
    End If

    Set ObjSys=Nothing
    Set objsrc=Nothing
End Sub


Sub sLayoutWorkSpacevwr()
On Error Resume Next

    Dim strObject,objEdgeMDI,strTemp,objTemp,GridControl,intRowcnt,intI,intRow
    'strEnvi = "Edge ( Development Test )"  

    strObject = "WPFObject(""HwndSource: RibbonWindow"")"
    Set objEdgeMDI = Sys.Process("EdgeClient")'.WaitChild(strObject, 600000)
    If objEdgeMDI.Exists then
      strTemp="WPFObject(""TextBlock"", ""Layout"", 1)"
      Set objTemp=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,true)
      'Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,14,True)
      If objTemp.Exists = False then
        strTemp="WPFObject(""ContentControl"", ""Layout Workspace"", 1)"
        Set objTemp=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,true)
        'Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).FindChild("Name",strTemp,16,True)
        If objTemp.Exists = True then
          objTemp.Click
        End If
        'Delay 8000,"Opening Layout Workspace.."
        Call sEdgeProcessor
        log.Message "Opening Layout Workspace.."
'        strTCRemarks="Opening Layout Workspace.."
      Else
        log.Message "Layout Workspace is opened"
    '    strTCRemarks="Layout Workspace is opened"
        'Exit Sub 
      End If
  
      ''Selecting Records
      'Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 1).WPFObject("PendingChangeGridControl")
      strTemp="WPFObject(""PendingChangeGridControl"")"
      Set GridControl=Sys.Process("EdgeClient").FindChild("Name",strTemp,60,True)
      
     ' intRowcnt=GridControl.wRowCount
      intRowcnt=GridControl.VisibleRowCount
      For intI=0 to intRowcnt-1
        'intRow=GridControl.FindRow(1,"Workspace Name")
'        GridControl.ClickRowIndicator(intI)
         Set objCell = Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("PendingChangeGridControl").WPFObject("PendingChangeTableView").WPFObject("HierarchyPanel", "", 1).WPFObject("RowControl", "", intI+1).WPFObject("CellsControl", "", 1).WPFObject("LightweightCellEditor", "", 1).WPFObject("InplaceBaseEdit", "", 1)
         objCell.Click   
        'Call GridControl.ClickCell(intI,1)
        strTemp="WPFObject(""ContentControlEx"", ""Drop"", 2)"
        Set objTemp=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,true)
        'Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,20,True)
        If objTemp.Exists = True then
          objTemp.Click
        End If
        strTemp="WPFObject(""PART_ContainerContent"")"
        Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "Please Confirm.")'.WPFObject("CustomMessageBoxWindow", "Please Confirm.", 1).FindChild("Name",strTemp,50,True)
'        strTemp="WPFObject(""DXMessageBox"", """", 1)"
        'Set objTemp=objTemp.WaitChild(strTemp,50000)
        If objTemp.Exists = True then
          Sys.Keys "Y"
          'Delay 15000,"Pls Wait..."
          Call sEdgeProcessor
          'Call Aliases.EdgeClient.HwndSource_RibbonWindow.RibbonWindow.ContentControl.Grid.Grid.ContentControl.Grid.ContentControl.PART_ContainerContent.BarManager.DockPanel.DockLayoutManager.LayoutGroup.LayoutPanel.Click(1296, 11)
        End If
        Call sCloseLayout
        'Delay 10000,"Pls Wait.."
      Next
    Else
      log.Message "RibbonWindow not found"
    End If

End Sub

Sub sLaunchCDM(strParameters)
'Sub sLaunchCDM()

On Error Resume Next

    Dim objTemp,poProcess,strTemp,objtxtusr,objtxtpass,strUserName,strPassword
    Dim strEnvi
    
'    strEnvi= "Edge ( US Integration )" 
    
'    If Ucase(Trim(strRequiredTCName))=Ucase(Trim("TC_RELEASESCHEDULE_04")) and Ucase(Trim(strEnvi)) = Ucase(Trim("Edge ( US Production )"  )) Then
'      Exit Sub
'    End If    

    strUserName=getSplitValue(strParameters,"USERNAME")
    strPassword=getSplitValue(strParameters,"PASSWORD")
    

'     strUserName="rchethana"
'     strPassword="ZSErfv123$%^" 
    

    set objTemp = Sys.WaitProcess("ISI.CeicDataManager.Startup",2000)
    If objTemp.exists = False then
      Set wshShell = CreateObject ("WSCript.shell")
    	Set poProcess = wshShell.Exec("""C:\Program Files (x86)\ISI Emerging Markets\CEIC Data Manager\ISI.CeicDataManager.Startup.exe""")
    End If
    Set objTemp = Sys.WaitProcess("ISI.CeicDataManager.Startup",120000)
    If objTemp.exists = True then    
      cdm_time1=aqdatetime.Now
      intCount=0
      Do while fCDM_MDI_Loaded = False 
          If  DateDiff("s",cdm_time1,aqDateTime.Now)>180 then
            strTestCaseResult="ABORT"
            strTCRemarks="Unable to load CDM"
            Exit Sub
           End If
          If  DateDiff("s",cdm_time1,aqDateTime.Now)>60 and intCount=0 then
            Sys.Process("ISI.CeicDataManager.Startup").Close
            Sys.Process("ISI.CeicDataManager.Startup").Terminate
            Delay(5000)
            Set wshShell = CreateObject ("WSCript.shell")
    	      Set poProcess = wshShell.Exec("""C:\Program Files (x86)\ISI Emerging Markets\CEIC Data Manager\ISI.CeicDataManager.Startup.exe""")
            Delay(30000)
            intCount=1          
          End If
      Loop  
    End If

    strTemp="WinFormsObject(""Login_Dialog"")"
    Set objTemp=Sys.Process("ISI.CeicDataManager.Startup").WaitChild(strTemp,12000)
    If objTemp.Exists = True then
       strTemp="WinFormsObject(""TxBox_User"")"
       Set objtxtusr=objTemp.FindChild("Name",strTemp,1,True)
       If objtxtusr.Exists = True then
          objtxtusr.Text=""
          objtxtusr.Text=strUserName
           Delay 2000, ""
       End If
       strTemp="WinFormsObject(""TxBox_Pass"")"
       Set objtxtpass=objTemp.FindChild("Name",strTemp,1,True)
       If objtxtpass.exists = True then
          objtxtpass.Text=""
          objtxtpass.Text=strPassword
          Delay 2000, ""
       End If
       Sys.Process("ISI.CeicDataManager.Startup").WinFormsObject("Login_Dialog").WinFormsObject("Panel1").WinFormsObject("Button_OK")
       Call objTemp.WinFormsObject("Panel1").WinFormsObject("Button_OK").Click


      Set otemp=Sys.Process("ISI.CeicDataManager.Startup").WaitChild("WinFormsObject(""UpgradeWarning_From"")",15000)
      If otemp.exists = True Then  ' Annoucement >> Click OK. 
        Delay 2000, "Closing Annoucement Form"
        otemp.WinFormsObject("TableLayoutPanel1").WinFormsObject("Panel4").WinFormsObject("Button_OK").Click()      
      End If
       Delay 6000, "Pls Wait.."
       set otemp=Sys.Process("ISI.CeicDataManager.Startup").WinFormsObject("CDMMain_MDIParent").WinFormsObject("RibbonStatusBar1")
        StatusString=otemp.LeftPanelCommands.Item(0).Text

        cdm_time1=aqdatetime.Now
        Do while aqstring.find(ucase(StatusString),"READY")=-1
           Delay 1000,"Please wait"
           set otemp=Sys.Process("ISI.CeicDataManager.Startup").WinFormsObject("CDMMain_MDIParent").WinFormsObject("RibbonStatusBar1")
           StatusString=otemp.LeftPanelCommands.Item(0).Text
           log.Message StatusString
           If  DateDiff("s",cdm_time1,aqDateTime.Now)>120 then
            'strTestCaseResult="ABORT"
            Exit Do
           End If
        Loop
        
         ''Refresh
        Delay 1000,"Refresh.."
        sys.Keys "~SA"
        'sys.Keys "+A"
        Delay 10000,"Refresh..."
        sys.Keys "[F5]"

        set otemp=Sys.Process("ISI.CeicDataManager.Startup").WinFormsObject("CDMMain_MDIParent").WinFormsObject("RibbonStatusBar1")
        StatusString=otemp.LeftPanelCommands.Item(0).Text
        cdm_time1=aqdatetime.Now
        Do while aqstring.find(ucase(StatusString),"UPDATED")=-1
           Delay 1000,"Please wait till CDM Tab Refresh"
           set otemp=Sys.Process("ISI.CeicDataManager.Startup").WinFormsObject("CDMMain_MDIParent").WinFormsObject("RibbonStatusBar1")
           StatusString=otemp.LeftPanelCommands.Item(0).Text
           log.Message StatusString
           If  DateDiff("s",cdm_time1,aqDateTime.Now)>120 then
            'strTestCaseResult="ABORT"
            Exit Do
           End If
        Loop  
   
        
'       Call Aliases.ISI_CeicDataManager_Startup.CDMMain_MDIParent.TopRebar1.CommandBar_SeriesActions.Click(544, 12)
'       Delay 25000,"Refresh..."
'       Call sCDMTree(strParameters)
'     strTCRemarks="Opened CDM"
'      Dim strSearch3
'       strSearch3=getSplitValue(strParameters,"SEARCH3")
'       If strSearch3="0" then
'          Call sCDMFootnote(strParameters)
'       Else
'          Call sCDMTree(strParameters)
'       End If    
    End If
End Sub




Sub Expand(strSeriesID,strScheduleStatus)

  On Error Resume Next

    Dim intGrpCnt,strValue,objDescCell,objCombo,strDesc,intRowHandle,strPD
   
    Set GridControl = Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("Grid", "", 1).WPFObject("CheckListGridControl")
    intGrpCnt=GridControl.get_GroupCount
    GridControl.Click   
    intchildcnt=Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("Grid", "", 1).WPFObject("CheckListGridControl").WPFObject("CheckListTableView").WPFObject("HierarchyPanel", "", 1).Children.Count
    
    ''Expanding I Node
    For intI=0 to intchildcnt-1
     ' strValue=Aliases.EdgeClient.HwndSource_RibbonWindow.RibbonWindow.ContentControl.Grid.Grid.ContentControl.Grid.ContentControl.PART_ContainerContent.BarManager.DockPanel.DockLayoutManager.LayoutGroup.LayoutPanel.Root.AdornerDecorator.WaitControl.BarManager.Grid.CheckListGridControl.WPFObject("CheckListTableView").WPFObject("HierarchyPanel", "", 1).Children.Item(intI).DataContext.GroupValue.Value
      strTemp="WPFObject(""HierarchyPanel"", """", 1)"
      'Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,60,True)
      Set objTemp = Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").FindChild("Name",strTemp,60,True)
      If objTemp.Exists = True then
        strValue=objTemp.Children.Item(0).DataContext.GroupValue.Value
      End If
      If strValue=strSource_Name then 
'        intRowHandle1=Aliases.EdgeClient.HwndSource_RibbonWindow.RibbonWindow.ContentControl.Grid.Grid.ContentControl.Grid.ContentControl.PART_ContainerContent.BarManager.DockPanel.DockLayoutManager.LayoutGroup.LayoutPanel.Root.AdornerDecorator.WaitControl.BarManager.Grid.CheckListGridControl.WPFObject("CheckListTableView").WPFObject("HierarchyPanel", "", 1).Children.Item(intI).DataContext.GroupValue.Data.RowHandle.Value 
        intRowHandle1=objTemp.Children.Item(intI).DataContext.GroupValue.Data.RowHandle.Value
        Call GridControl.ExpandGroupRow(intRowHandle1)
        Exit For
      End If
    Next

    log.Message "Expanding"
    
    Delay 30000,"Refresh..."
    Call Wait(strSeriesID,strScheduleStatus)
    
    If blnFlag=False then
      Call Wait(strSeriesID,strScheduleStatus)
      log.Message "Level1"
    End If
    If blnFlag=False then
      Call Wait(strSeriesID,strScheduleStatus)
      log.Message "Level2"
    End If
    If blnFlag=False then
      Call Wait(strSeriesID,strScheduleStatus)
      log.Message "Level3"
    End If
    If blnFlag=False then
      Call Wait(strSeriesID,strScheduleStatus)
      log.Message "Level4"
    End If
    If blnFlag=False then
      Call Wait(strSeriesID,strScheduleStatus)
      log.Message "Level5"
    End If
    If blnFlag=False then
      Call Wait(strSeriesID,strScheduleStatus)
      log.Message "Level6"
    End If
    If blnFlag=False then
      Call Wait(strSeriesID,strScheduleStatus)
      log.Message "Level7"
    End If
    If blnFlag=False then
      Call Wait(strSeriesID,strScheduleStatus)
      log.Message "Level8"
    End If
    If blnFlag=False then
      Call Wait(strSeriesID,strScheduleStatus)
      log.Message "Level9"
    End If
    If blnFlag=False then
      Call Wait(strSeriesID,strScheduleStatus)
      log.Message "Level10"
    End If
    If blnFlag=False then
      Call Wait(strSeriesID,strScheduleStatus)
      log.Message "Level11"
    End If
    If blnFlag=False then
      Call Wait(strSeriesID,strScheduleStatus)
      log.Message "Level12"
    End If
    If blnFlag=False then
      Call Wait(strSeriesID,strScheduleStatus)
      log.Message "Level13"
    End If
    If blnFlag=False then
      Call Wait(strSeriesID,strScheduleStatus)
      log.Message "Level14"
    End If
    If blnFlag=False then
      Call Wait(strSeriesID,strScheduleStatus)
      log.Message "Level15"
    End If
    If blnFlag=False then
      Call Wait(strSeriesID,strScheduleStatus)
      log.Message "Level16"
    End If
    If blnFlag=False then
      Call Wait(strSeriesID,strScheduleStatus)
      log.Message "Level17"
    End If
    If blnFlag=False then
      Call Wait(strTimePoint)
      log.Message "Level18"
    End If
    If blnFlag=False then
      Call Wait(strSeriesID,strScheduleStatus)
      log.Message "Level19"
    End If
    If blnFlag=False then
      Call Wait(strSeriesID,strScheduleStatus)
      log.Message "Level20"
    End If
    If blnFlag=False then
      Call Wait(strSeriesID,strScheduleStatus)
      log.Message "Level21"
    End If
    If blnFlag=False then
      Call Wait(strSeriesID,strScheduleStatus)
      log.Message "Level22"
    End If
    If blnFlag=False then
      Call Wait(strSeriesID,strScheduleStatus)
      log.Message "Level23"
    End If
    If blnFlag=False then
      Call Wait(strSeriesID,strScheduleStatus)
      log.Message "Level24"
    End If
    If blnFlag=False then
      Call Wait(strSeriesID,strScheduleStatus)
      log.Message "Level25"
    End If
    If blnFlag=False then
      Call Wait(strSeriesID,strScheduleStatus)
      log.Message "Level26"
    End If
    If blnFlag=False then
      Call Wait(strSeriesID,strScheduleStatus)
      log.Message "Level27"
    End If
    If blnFlag=False then
      Call Wait(strSeriesID,strScheduleStatus)
      log.Message "Level28"
    End If
    If blnFlag=False then
      Call Wait(strSeriesID,strScheduleStatus)
      log.Message "Level29"
    End If
    If blnFlag=False then
      Call Wait(strSeriesID,strScheduleStatus)
      log.Message "Level30"
    End If
    
    If blnFlag=False then
     strTestCaseResult="ABORT"
     strTCRemarks=strTimePoint &" Timepoint added in Source Schedule is not found in Checklist"
    End If
'    Delay 10000,"Refresh.."
'    Call Refresh
'    Call GridControl.ExpandGroupRow(intRowHandle1)
'    ''Final Node
'    For intI=0 to intchildcnt-1
'      strValue=objTemp.Children.Item(intI).DataContext.GroupValue.Value
'      intRowHandle=objTemp.Children.Item(intI).DataContext.GroupValue.Data.RowHandle.Value
'      If strValue=strLevel2src_Name then            
'        Call GridControl.ExpandGroupRow_2(intRowHandle,True)
'    '    strTCRemarks=strRemarks & "<br/>"  & "Top source Description: " & strLevel2src_Name 
'        Exit For
'      End If
'    Next
    'strPD="Pending" 'Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("Grid", "", 1).WPFObject("CheckListGridControl").WPFObject("CheckListTableView").WPFObject("HierarchyPanel", "", 1).WPFObject("GridRow", "", 1).WPFObject("ScrollablePart").WPFObject("CellItemsControl", "", 1).WPFObject("GridCellContentPresenter", "", 4).WPFObject("TextEdit", "", 1).EditValue
    'strTCRemarks="Source schedule uploaded successfully" & "<br />" & strPD & " schedule found for series in Checklist" & "<br />"  & "Top source Description: " & strLevel2src_Name 

End Sub

Sub Refresh()
On Error Resume Next
    Dim objTemp,strTemp 
    strTemp= "WPFObject(""ContentControlEx"", ""Refresh"", 2)"
    Set objTemp = Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).FindChild("Name",strTemp,50,True)
'    strTemp="WPFObject(""ContentControlEx"", ""Refresh"", 2)"
'    Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarButtonItemLinkControl", "", 1).FindChild("Name",strTemp,21,True)
    ' Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarButtonItemLinkControl", "", 1).WPFObject("ContentControlEx", "Refresh", 2)
      If objTemp.Exists = True then
        objTemp.Click
        Call sEdgeProcessor
       ' Delay 15000,"Refresh"
      End If    
End Sub



Sub sSourceSchedule_Checklist(strParameters)


  On Error Resume Next

    Dim intRow,strTemp,objTemp,Grid,intI,strTimepoint
    Dim objEdge,objCaption,i,objText,j,strWrkSpaceName,strDesc1,strDesc2

    strSource_Name=getSplitValue(strParameters,"SOURCE")
    strLevel2src_Name=getSplitValue(strParameters,"LEVEL2SOURCE")
    strLevel3src_Name=getSplitValue(strParameters,"LEVEL3SOURCE")
    strSeriesID = getSplitValue(strParameters,"SeriesID")
    strScheduleStatus = getSplitValue(strParameters,"ScheduleStatus")
 
    
    '    strSource_Name="Test"
    '    strLevel2src_Name="Automation"
    '    strLevel3src_Name="Test Source 1"

    strDesc1=aqDateTime.Now
    strDesc2=aqDateTime.Now
    strWrkSpaceName=Replace(strDesc1,"/","-")
    strWrkSpaceName=Replace(strWrkSpaceName,":","_")
    
    ''Setting grid Objects
    
    strTemp="WPFObject(""SourceTreeListView"")"    
    Set GridControl=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""SourceTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,True)
    
    Delay 10000,"Pls Wait.."
    ''Selecting Country Name
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource_Name) then
          GridControl.Nodes_2.Item(intI).ExpandAll
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description       
    '      strTCRemarks=strTCRemarks & Chr(10) & "Selected Node - " & GridControl.Nodes_2.Item(intI).Content.Description  
          blnFlag=False  
          Exit For
        End If
    Next
    If blnFlag = True then
      strTCRemarks="Country Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
  
    Delay 10000,"Pls Wait.."
    blnFlag = True 
    ''Selecting Level2Source_Name
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
    For intJ=0 to intTotNodeCnt-1
      strTemp=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strLevel2src_Name) then
        GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).ExpandAll
        intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
        Call GridControl.ClearSelectionCore
        Call GridControl.FocusViewAndRow(GridControl,intRow)
        GridControl.SetFocusOnCurrentItem
        Call GridControl.SelectRowCore(intRow)
        log.Message "Level2 Source Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
        blnFlag = False 
        Exit For
      End If
    Next
    If blnFlag = True then
      log.Message "Level2 Source Name not found"
      strTCRemarks="Level2 Source Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
    Delay 10000,"Pls Wait.."
'    Delay 30000,"Please Wait..."
    'Call sEdgeProcessor
    ''Clicking on "New Workspace" Button and selecting "Open for Edit(Souce)" option 
    strTemp= "WPFObject(""ContentControlEx"", ""New Workspace"", 2)" '"WPFObject(""ArrowControl"", """", 1)"
    'Set objNewWorkspace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,20,True)
    Set objNewWorkspace = Sys.Process("EdgeClient").FindChild("Name",strTemp,50,True)
    If objNewWorkspace.Exists = True then
      objNewWorkspace.Click
'      Delay 5000,"Please Wait..."
      strTemp="WPFObject(""PopupMenuBarControl"", """", 1)"
      Set objWrkspace_popup=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,True)
      If objWrkspace_popup.Exists = True then
        strTemp="WPFObject(""ContentControlEx"", ""Open For Edit (Source Schedule)"", 2)"
        Set objopenforEdit=objWrkspace_popup.FindChild("Name",strTemp,50,True)
        If objopenforEdit.Exists then
          objopenforEdit.Click    
'          Delay 50000,"Please Wait..."
           strTemp="WPFObject(""FloatingContainerBorder"")"          
           Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: WaitProgressWindow", "Please Wait...").WPFObject("WaitProgressWindow", "Please Wait...", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,5000)
            Do until objTemp.Exists = False 
              If objTemp.Focusable=False then
                Delay 5000,"Pls Wait.."
              End if 
            Loop   
        End If
    End If
    End If
    

    ''Waiting for FloatingContainerBorder
     strTemp="WPFObject(""HwndSource: WorkspaceNamePrompt"", ""Please provide a new Workspace Name"")"
      Set objNewWrkSpace_Name=Sys.Process("EdgeClient").WaitChild(strTemp,50000)
      If objNewWrkSpace_Name.Exists = True then
        strTemp="WPFObject(""ChangeNameTextEdit"")"
        ''Entering Workspace Name
        Set objNewWrkSpace_Txtbox=objNewWrkSpace_Name.FindChild("Name",strTemp,50,True)
          If objNewWrkSpace_Txtbox.Exists = True then
            objNewWrkSpace_Txtbox.Click
            objNewWrkSpace_Txtbox.Text=strWrkSpaceName
    '        strTCRemarks=strTCRemarks & Chr(10) & "Entered Workspace Name - " & strWrkSpaceName
            ''Clicking on Ok Button 
            strTemp="WPFObject(""OkButton"")"
            Set objNewWrkSpace_okbtn=objNewWrkSpace_Name.FindChild("Name",strTemp,50,True)
            If objNewWrkSpace_okbtn.Exists = True then
              objNewWrkSpace_okbtn.Click
              Delay 5000,"Please wait..."
            End If
          End If
      End If

    
    ''Source Series Schedule (For Edit)
    'Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("SourceTreeListView").WPFObject("SourceTreeView")
    'Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("SourceTreeListView").WPFObject("SourceTreeView")
    'strTemp = "WPFObject(""SourceTreeView"")"
    'Set GridControl =Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("SourceTreeListView").FindChild("Name",strTemp,10,True)
    'Set GridSourceTree =Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("SourceTreeListView")

    ''Expand All
'    Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarButtonItemLinkControl", "", 1).Click

    strTemp="WPFObject(""ContentControlEx"", ""Expand All"", 2)"
   ' Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).FindChild("Name",strTemp,50,True)
   ' Set  Set objTemp Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarButtonItemLinkControl", "", 1)
    Set objTemp =Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).FindChild("Name", strTemp,50,True)
    If objTemp.Exists = True then
     strTemp="WPFObject(""ContentControlEx"", ""Expand All"", 2)"
   ' Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).FindChild("Name",strTemp,50,True)
     Set objTemp =Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarButtonItemLinkControl", "", 1)
      If objTemp.Exists = True then
        objTemp.Click
      End If
      Call sEdgeProcessor
      strTemp="WPFObject(""SourceTreeView"")"
      Set objGridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).FindChild("Name",strTemp,50,True)
     ''Selecting Country Name
      intTotNodeCnt=objGridControl.Nodes_2.Count
      For intI=0 to intTotNodeCnt-1         
        If Ucase(objGridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource_Name) then
          objGridControl.Nodes_2.Item(intI).ExpandAll
          log.Message "Country Name - " & objGridControl.Nodes_2.Item(intI).Content.Description       
    '      strTCRemarks=strTCRemarks & Chr(10) & "Selected Node - " & GridControl.Nodes_2.Item(intI).Content.Description  
          blnFlag=False  
          Exit For
          End If
      Next
    End If
    
    If blnFlag = True then
      strTCRemarks="Country Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
  
    blnFlag = True 
    ''Selecting Level2Source_Name
    intTotNodeCnt=objGridControl.Nodes_2.Item(intI).Nodes.Count
    For intJ=0 to intTotNodeCnt-1
      If Ucase(objGridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strLevel2src_Name) then
        objGridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
        log.Message "Level2 Source Name - " & objGridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
        blnFlag = False 
        Exit For
      End If
    Next
    
    ''Selecting Level3Source_Name
      intTotNodeCnt=objGridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count
      For intK=0 to intTotNodeCnt-1
        If Ucase(objGridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description)=Ucase(strLevel3src_Name) then
          objGridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Expand(True)
          intRow=objGridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).get_RowHandle
          Call objGridControl.ClearSelectionCore
          Call objGridControl.FocusViewAndRow(objGridControl,intRow)
          objGridControl.SetFocusOnCurrentItem
          Call objGridControl.SelectRowCore(intRow)
          Call sEdgeProcessor
          log.Message "Third Level- " & objGridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description
          blnFlag = False
          Exit For   
        End If 
      Next

      'Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 2).WPFObject("Grid", "", 1).WPFObject("SourceSeriesGridControl").WPFObject("TableView", "", 1).WPFObject("HierarchyPanel", "", 1).WPFObject("RowControl", "", 1).WPFObject("CellsControl", "", 1).WPFObject("LightweightCellEditor", "", 2).WPFObject("InplaceBaseEdit", "", 1)
      
      ''Minimize Window
      'Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("GridSplitter", "", 1)
      Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("GridSplitter", "", 1)
      Call objTemp.Drag(4, 19, -167, 14)
    
  strTemp="WPFObject(""ComboBoxEdit"", """", 1)"
    'Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,50,True)
    Set objTemp = Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 2).WPFObject("Grid", "", 2).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 7).WPFObject("BarEditItemLinkControl", "", 1).WPFObject("ContentControlEx", "", 1).WPFObject("ComboBoxEdit", "", 1)
    If objTemp.Exists = True then      
      'Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 2).WPFObject("Grid", "", 2).WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 7).WPFObject("BarEditItemLinkControl", "", 1).WPFObject("ContentControlEx", "", 1).WPFObject("ComboBoxEdit", "", 1).Click
       Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 2).WPFObject("Grid", "", 2).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 7).WPFObject("BarEditItemLinkControl", "", 1).WPFObject("ContentControlEx", "", 1).WPFObject("ComboBoxEdit", "", 1).Click
        Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("PopupBorderControl", "", 1).WPFObject("PopupContentContainer", "", 1).WPFObject("NonLogicalDecorator", "", 1).WPFObject("PopupContentControl", "", 1).WPFObject("ComboBoxEditItem", "", 2)
        If objTemp.Exists = True then
          objTemp.Click
        End If       
    End If    



    ''Clicking on Add Button
     Set objTemp = Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 2).WPFObject("Grid", "", 1).WPFObject("SourceSeriesGridControl").WPFObject("TableView", "", 1).WPFObject("HierarchyPanel", "", 1).WPFObject("RowControl", "", 1).WPFObject("CellsControl", "", 1).WPFObject("LightweightCellEditor", "", 2).WPFObject("InplaceBaseEdit", "", 1)
      Call objTemp.Click
      strTemp="WPFObject(""ContentControlEx"", ""Add"", 2)"
      Set objTemp = Sys.Process("EdgeClient").FindChild("Name",strTemp,50,True)
      If objTemp.Exists = True then
       objTemp.Click
       Delay 2000,"Add.."
      End If
      
       'Delay 3000,"Pls Wait.."
        Call SClosesource

    ''Entering Start and End Time   
    
'     Set objGrid = Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 2).WPFObject("Grid", "", 2).WPFObject("Grid", "", 1).WPFObject("SourceSeriesScheduleGridControl")
'     Dim intCellNumber
'     intCellNumber = objGrid.VisibleRowCount-1
'     'intCellNumber = objGrid.wRowCount-1
'     Call objGrid.ClickCell(0, "Timepoint Date")
'     Call objGrid.ClickCell(intCellNumber, "Estimated Release Start Time")
'     sys.Keys DatePart("m",aqDateTime.Now)
'     Call objGrid.ClickCell(intCellNumber, "Estimated Release End Time")
'     sys.Keys DatePart("m",aqDateTime.Now)


  'Enter Estimates Start Time and End Time  
   strTemp = "WPFObject(""SourceSeriesScheduleGridControl"")" 
   Set objGrid  = Sys.Process("EdgeClient").FindChild("Name", strTemp, 50, True)
   Set objRow = Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 2).WPFObject("Grid", "", 2).WPFObject("Grid", "", 1).WPFObject("SourceSeriesScheduleGridControl").WPFObject("SourceSeriesScheduleTableView").WPFObject("HierarchyPanel", "", 1).WPFObject("RowControl", "", objGrid.VisibleRowCount).WPFObject("CellsControl", "", 1).WPFObject("LightweightCellEditor", "", 3).WPFObject("InplaceBaseEdit", "", 1) 
   if objRow.DisplayText = "" then
      objRow.Click
    '  sys.Keys DatePart("m",aqDateTime.Now )
      sys.Keys Date
      sys.Keys "[Tab]"  
    End if  
   
'   For I = 1 to objGrid.VisibleRowCount
'     Set objRow = Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 2).WPFObject("Grid", "", 2).WPFObject("Grid", "", 1).WPFObject("SourceSeriesScheduleGridControl").WPFObject("SourceSeriesScheduleTableView").WPFObject("HierarchyPanel", "", 1).WPFObject("RowControl", "", I).WPFObject("CellsControl", "", 1).WPFObject("LightweightCellEditor", "", 3).WPFObject("InplaceBaseEdit", "", 1) 
'     if objRow.DisplayText = "" then
'      objRow.Click
'      sys.Keys DatePart("m",aqDateTime.Now )
'      sys.Keys "[Tab]"      
'
'    End if 
'  Next
     

    
    ''Upload in Prod
    strTemp="WPFObject(""ContentControlEx"", ""Upload"", 2)"
    Set objTemp=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,True)
    If objTemp.Exists = True then
            objTemp.Click
          strTemp="WPFObject(""DXMessageBox"", """", 1)"
          Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: WindowContentHolder", "").WPFObject("WindowContentHolder", "", 1).WPFObject("NonLogicalDecorator", "", 1).WPFObject("ThemedManagedContentPresenter", "", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WaitChild(strTemp,120000)
          If objTemp.Exists = True then
            Sys.Keys "Y"
            Delay 5000,"Uploading.."
            strTemp="WPFObject(""PART_ContainerContent"")"
            Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "Upload Workspace").WPFObject("CustomMessageBoxWindow", "Upload Workspace", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,180000)
            If objTemp.Exists = True then
              Sys.Keys "[Enter]"
              Call sEdgeProcessor
          '    strTCRemarks="Source schedule uploaded successfully"
            End If
          End If    
    
  Else  
           
      strTemp = "WPFObject(""ContentControlEx"", ""Workspace"", 2)"
      Set objTemp=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,True)
      If objTemp.Exists = True then
        objTemp.Click
        strTemp="WPFObject(""ContentControlEx"", ""Upload Workspace"", 2)"
        Set objTemp=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,True)
        If objTemp.Exists = True then
            objTemp.Click
            Set objTemp= Sys.Process("EdgeClient").WPFObject("HwndSource: WindowContentHolder", "Confirm").WPFObject("WindowContentHolder", "Confirm", 1).WPFObject("NonLogicalDecorator", "", 1).WPFObject("ThemedManagedContentPresenter", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ActiveBorder")
            If objTemp.Exists = True then
              Sys.Keys "[Enter]"
              Delay 5000,"Uploading.."
              'strTemp="WPFObject("PART_InactiveBorder")"
              Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "Upload Workspace").WPFObject("CustomMessageBoxWindow", "Upload Workspace", 1).WPFObject("Grid", "", 1).WPFObject("PART_InactiveBorder")
              If objTemp.Exists = True then         
                Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "Upload Workspace").WPFObject("CustomMessageBoxWindow", "Upload Workspace", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContentOffset").WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("Grid", "", 2).WPFObject("DockPanel", "", 1).WPFObject("Button_OK").Click
                Call sEdgeProcessor              
                strTCRemarks="Source schedule uploaded successfully"
                log.Message "Upload button found"
              End If
            Else
             log.Message "Upload button not found"
             strTCRemarks="Upload button not found"
             strTestCaseResult="FAIL"
            End If
        End If
     End If 
  End If
  
  Call DelayWait(strParameters) 
  'Call DelayWait(strParameters)  
  'Call DelayWait(strParameters)  
  'Call DelayWait(strParameters)   
  
  Call sAutoHideGroupName("Check List")
  
  'Set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager")       
   Set objEdge = Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager")
   objText = objEdge.FindAllChildren("ClrClassName","AutoHideGroup", 10,True)
        For i=0 to ubound(objText)
          log.Message objText(i).FullName
          log.Message objText(i).Name
          objCaption = objText(i).FindAllChildren("ClrClassName", "AutoHidePaneHeaderItem",10,True)
          For j=0 to ubound(objCaption)
            log.Message objCaption(j).FullName
            log.Message objCaption(j).Name
            if objCaption(j).Content.Caption = "Check List" then 
                  log.Message objCaption(j).FullName
                  objCaption(j).ClickR
                   Delay 2000,"Pls Wait.."
                  sys.Keys "[Down][Enter]"
                  Delay 5000,"Pls Wait.."
                  Exit For 
              End if 
          Next
        Next    
     Dim edgeClient,hwndSource
 
    Delay 10000,"Pls Wait.."
   
    '  Set hwndSource = Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow")
  Set hwndSource = Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"")  
  'Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("Grid", "", 1).WPFObject("RootGroup").WPFObject("Grid", "", 1).WPFObject("WrapPanel", "", 1).WPFObject("StackPanel", "", 1).WPFObject("ComboBox", "", 1).Click
  
'  Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("Grid", "", 1).WPFObject("RootGroup").WPFObject("Grid", "", 1).WPFObject("WrapPanel", "", 1).WPFObject("StackPanel", "", 1).WPFObject("ComboBox", "", 1).Click
'  Call hwndSource.Keys("Test[Enter]")

  'Call Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("Grid", "", 1).WPFObject("RootGroup").WPFObject("Grid", "", 1).WPFObject("WrapPanel", "", 1).WPFObject("StackPanel", "", 1).WPFObject("ComboBox", "", 1).set_Text(strSource_Name)
  set objTemp= Aliases.EdgeClient.HwndSource_Shell.Shell.Grid.ContentControl.Grid.PART_RibbonLayout.Part_WindowContent.Grid.ContentControl.PART_ContainerContent.BarManager.DockPanel.DockLayoutManager.LayoutGroup.LayoutPanel.LayoutPanelContentPresenter.Root.AdornerDecorator.AdornedControl.BarManager.Grid.RootGroup.Grid.ComboboxSourceCountry
  Call objTemp.set_Text(strSource_Name)
  Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("Grid", "", 1).WPFObject("RootGroup").WPFObject("Grid", "", 1).WPFObject("WrapPanel", "", 2).WPFObject("StackPanel", "", 1).WPFObject("DateFromDateEdit").Click
  Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("Grid", "", 1).WPFObject("RootGroup").WPFObject("Grid", "", 1).WPFObject("WrapPanel", "", 2).WPFObject("StackPanel", "", 2).WPFObject("DateToDateEdit").Click
  Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("Grid", "", 1).WPFObject("RootGroup").WPFObject("Grid", "", 1).WPFObject("WrapPanel", "", 4).WPFObject("StackPanel", "", 2).WPFObject("ComboBox", "", 1).Click
  Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("ComboBoxItem", "", 7).WPFObject("StackPanel", "", 1).WPFObject("CheckBox", "", 1).Click
  Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("Grid", "", 1).WPFObject("RootGroup").WPFObject("Grid", "", 1).WPFObject("WrapPanel", "", 4).WPFObject("StackPanel", "", 2).WPFObject("ComboBox", "", 1).Click
  Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("Grid", "", 1).WPFObject("RootGroup").WPFObject("Grid", "", 1).WPFObject("WrapPanel", "", 4).WPFObject("StackPanel", "", 2).WPFObject("ComboBox", "", 1).Click
  Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("ComboBoxItem", "", 7).WPFObject("StackPanel", "", 1).WPFObject("TextBlock", "Annually", 1).Click
  
    ''Refresh  
    strTemp= "WPFObject(""ContentControlEx"", ""Refresh"", 2)"
    Set objTemp = Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).FindChild("Name",strTemp,50,True)
  ' Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarButtonItemLinkControl", "", 1).FindChild("Name",strTemp,21,True)
   'Set objTemp = Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).FindChild("Name",strTemp,50,True)
    If objTemp.Exists = True then 
      objTemp.Click
      Call sEdgeProcessor
    End If
    
    'Call Refresh
    Delay 3000,"Refresh..."

    ''Expanding
    'strTimepoint = "Pending"
'    strSeriesID= "368765647"
'    strScheduleStatus = "Pending"
    'Call Expand(strSeriesID,strScheduleStatus)
    Call sExpandCheckList(strParameters)
    
    ''Closing Checklist
    Delay 10000,"Pls Wait.."
   Set objEdge = Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager")      
   objText = objEdge.FindAllChildren("ClrClassName","LayoutGroup", 10,True)
        For i=0 to ubound(objText)
          log.Message objText(i).FullName
          log.Message objText(i).Name
          objCaption = objText(i).FindAllChildren("ClrClassName", "LayoutPanel",10,True)
          For j=0 to ubound(objCaption)
            log.Message objCaption(j).FullName
            log.Message objCaption(j).Name
            if objCaption(j).Content.Caption = "Check List" then 
                  log.Message objCaption(j).FullName
                   Call objCaption(j).ClickR(objCaption(j).top/2,objCaption(j).left/30,0)
                   Call objCaption(j).ClickR(275, 8)
                   Delay 5000,"Pls Wait.."
                  sys.Keys "[Down][Down][Enter]"
                  Delay 5000,"Pls Wait.."
                  Exit For 
              End if 
          Next
        Next  
End Sub



Sub sExpandCheckList(strParameters)
  On Error Resume Next
  Dim strTemp , objTemp, objGrid   
  
  strLevel2src_Name=getSplitValue(strParameters,"LEVEL2SOURCE")
  strLevel3src_Name=getSplitValue(strParameters,"LEVEL3SOURCE")
  strSeriesID = getSplitValue(strParameters,"SeriesID")
  strScheduleStatus = getSplitValue(strParameters,"ScheduleStatus")

  
  strTemp = "WPFObject(""CheckListGridControl"")"
  Set objGrid  = Sys.Process("EdgeClient").FindChild("Name", strTemp, 50, True)
  'objGrid.click
  
  strTemp = "WPFObject(""HierarchyPanel"", "", 1)"
  Set objTemp  = Sys.Process("EdgeClient").FindChild("Name", strTemp, 50, True)
  intchildcnt=objTemp.Children.Count
  'msgbox intchildcnt
  
  For I = 0 to intchildcnt-1
    strValue=objTemp.Children.Item(I).DataContext.GroupValue.Value
    If strValue=strLevel2src_Name then     
      intRowHandle1=objTemp.Children.Item(I).DataContext.GroupValue.Data.RowHandle.Value      
      Call objGrid.ExpandGroupRow(intRowHandle1)    
      Call sEdgeProcessor()
      Delay 2000      
      For J= 0 to intchildcnt-1
        strValue = objTemp.Children.Item(J).DataContext.GroupValue.Value
        if strValue=strLevel3src_Name then 
          intRowHandle1=objTemp.Children.Item(J).DataContext.GroupValue.Data.RowHandle.Value
          Call objGrid.ExpandGroupRow(intRowHandle1)
           Exit For    
        End If           
      Next
      Call sEdgeProcessor()
      Delay 2000
      log.Message "Expanding"
      blnFlag= False
      
      'Verify SeriesID:
       objRowControl = objTemp.FindAllChildren("ClrClassName","RowControl",10,true)
       'msgbox ubound(objRowControl)
       Dim strRuntimeSeriesID , strRuntimeStatus
       strRuntimeSeriesID =""
       strRuntimeStatus =""
        For K = 0 to ubound(objRowControl)
          strRuntimeSeriesID = objRowControl(K).DataContext.Row.SeriesId
          strRuntimeStatus= objRowControl(K).DataContext.Row.ScheduleStatus
          If trim(cstr(strSeriesID)) = trim(cstr(strRuntimeSeriesID))And  trim(cstr(strScheduleStatus)) = trim(cstr()) then
              log.Message( cstr(strScheduleStatus) &" :  " &cstr(objRowControl(K).DataContext.Row.ScheduleStatus))
              strTCRemarks="Source schedule uploaded successfully" & "<br />" & "Pending schedule found for series in Checklist" & "<br />"  & "Top source Description: " & strLevel2src_Name 
              strTestCaseResult = "PASS"  
              blnFlag=True
              Exit For
          End If
        Next
        Exit For      
    End If 
  Next
  
  If blnFlag= False Then 
    strTCRemarks="Source schedule is not  uploaded successfully" & "<br />" & "Pending scheduleis found for series in Checklist" & "<br />"  & "Top source Description: " & strLevel2src_Name 
    strTestCaseResult = "FAIL"  
  End IF
  
End Sub 


'Sub Wait(strSeriesID,strScheduleStatus)
Sub Wait()
Dim strTemp,objTemp

On Error Resume Next

'    intRowHandle1="-1"
    strEnvi = "Edge ( US Integration )" 
    Delay 2000,"Refresh.."
    Call Refresh
     strTemp="WPFObject(""CheckListGridControl"")"
'    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("Grid", "", 1).WPFObject("CheckListGridControl")
    Set GridControl=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,True)
    Call GridControl.ExpandGroupRow(intRowHandle1)
    blnFlag=False
    strTemp="WPFObject(""HierarchyPanel"", """", 1)" 
    strTemp="WPFObject(""GroupRowControl"", """", 1)"   
    'Set objTemp=Aliases.EdgeClient.HwndSource_RibbonWindow.FindChild("Name",strTemp,50,True)
    'Set objTemp=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,True)
     Set objTemp =Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("Grid", "", 1).WPFObject("CheckListGridControl").WPFObject("CheckListTableView").WPFObject("HierarchyPanel", "", 1)
       intchildcnt=GridControl.wGroupCount
      strLevel2src_Name= "Automation_UIT4_1" 
      strScheduleStatus = "Pending"   
     For intI=1 to intchildcnt-1
     ' strValue=objTemp.WPFObject("GroupRowControl", "", Item(intI)).DataContext.GroupValue.Value
      strValue=objTemp.WPFObject("GroupRowControl", "", intI).WPFObject("GroupValuePresenter", "", 1).DataContext.GroupValue.Value
      intRowHandle=objTemp.Children.Item(intI).DataContext.GroupValue.Data.RowHandle.Value
      If strValue=strLevel2src_Name then            
        Call GridControl.ExpandGroupRow_2(intRowHandle,True)
        Delay 5000,"Loading Grid Rows"
        objRowControl = objTemp.FindAllChildren("ClrClassName","RowControl",10,true)
        For i = 0 to ubound(objRowControl)
          If trim(cstr(strSeriesID)) = trim(cstr(objRowControl(i).DataContext.Row.SeriesId)) then
            If trim(cstr(strScheduleStatus)) = trim(cstr(objRowControl(i).DataContext.Row.ScheduleStatus)) then
            'If trim(cstr(strTimepoint)) = trim(cstr(objRowControl(i).DataContext.Row.Timepoint)) then
  '            msgbox objRowControl(i).DataContext.Row.Timepoint
              log.Message( cstr(strScheduleStatus) &" :  " &cstr(objRowControl(i).DataContext.Row.ScheduleStatus))
              strTCRemarks="Source schedule uploaded successfully" & "<br />" & "Pending schedule found for series in Checklist" & "<br />"  & "Top source Description: " & strLevel2src_Name 
              blnFlag=True
              Exit For
            End If
          End If
        Next
      Exit For
      End If
    Next
    
End Sub

Sub sHome_MasterMaintenance()

On Error Resume Next
'strEnvi = "Edge ( US Integration )" 
Dim objEdgeMDI,strObject,strObj,objsrc,strTemp,objEdgeFilter,objUnitPannel
    'strObject = "WPFObject(""HwndSource: RibbonWindow"")"
				 strObject = "WPFObject(""HwndSource: Shell"", """& strEnvi &""")"
    Set objEdgeMDI = Sys.Process("EdgeClient").WaitChild(strObject, 600000)
    If objEdgeMDI.Exists then
      'Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("RibbonControl").WPFObject("RibbonSelectedPageControl", "", 1).WPFObject("RibbonPagesControl", "", 1).WPFObject("RibbonPageGroupsControl", "", 1).WPFObject("RibbonPageGroupControl", "", 1).WPFObject("BarItemLinkInfo", "", 11).WPFObject("BarSubItemLinkControl", "", 1).Click
      Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("RibbonControl").WPFObject("RibbonSelectedPageControl", "", 1).WPFObject("RibbonPagesControl", "", 1).WPFObject("RibbonPageGroupsControl", "", 1).WPFObject("RibbonPageGroupControl", "", 1).WPFObject("BarItemLinkInfo", "", 11).WPFObject("BarSubItemLinkControl", "", 1).Click
						Set objEdgeFilter= Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1)
						strTemp="WPFObject(""ContentControlEx"", ""Unit"", 2)"
      Set objTemp=objEdgeFilter.FindChild("Name",strTemp,50)
      If objTemp.Exists = TRUE then
        Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarButtonItemLinkControl", "", 1).WPFObject("ContentControlEx", "Unit", 2).Click
        	Delay 5000, "Please Wait"
								Call sEdgeProcessor							
								objUnitPannel = Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1)
        If objUnitPannel.Exists = True Then 
									log.Message "Opened Unit"
        	strTCRemarks="Opened Unit"
								End If
						Else
        strTestCaseResult = "ABORT"
        Exit Sub  
      End If
    End if
				
				If Err.Number <> 0 then
      Log.Message Err.Description 
    End If
 
    Set ObjSys=Nothing
    Set objsrc=Nothing

End Sub

Sub sUnit(strParameters)
'Sub sUnit()
On Error Resume Next
				'strEnvi = "Edge ( US Integration )" 
    Dim strTemp,objTemp,intI,strCategory,GridControl,strMultiplier,strLastUpdate,strMultiplier1,nRowCnt
    Dim objEdge,objStrClose

    strCategory=getSplitValue(strParameters,"CATEGORY")
				'strCategory = "Currency"
    ''Selecting Unit Category		
    'Set objtemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("WaitControl").WPFObject("DockPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("ComboBox", "", 1)
   	strTemp="WPFObject(""ComboBox"", """", 1)"   
				Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("WaitControl").WPFObject("DockPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("ComboBox", "", 1)
			 	If objTemp.Exists = True then
		      For intI=0 to objTemp.wItemCount
		          strDesc=objTemp.Items.Item(intI).Description
		          If Ucase(Trim(strDesc))=Ucase(Trim(strCategory)) then
		            objTemp.set_Text(strCategory)
		            ''Clicking on Add New
		            strTemp="WPFObject(""ContentControlEx"", ""Add New"", 2)"
		            Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).FindChild("Name",strTemp,50,true)
		            'Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("WaitControl").WPFObject("DockPanel", "", 1).WPFObject("StackPanel", "", 1).WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 5).WPFObject("BarButtonItemLinkControl", "", 1)
		            If objTemp.Exists = True then
		              objTemp.Click															
									Call sEdgeProcessor
		            End If
		            Exit For
		          End If
		      Next  
    End If

    ''Grid View
    'Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("WaitControl").WPFObject("DockPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("UnitsGridControl")
		Set GridControl = Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("WaitControl").WPFObject("DockPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("UnitsGridControl")
    nRowCnt = GridControl.wRowCount
				''Entering UMULTIPLIER ,AMTCUR
    Call GridControl.ClickCell(GridControl.wRowCount-1,"UMULTIPLIER")
    strMultiplier=DatePart("s",aqDateTime.Now) & DatePart("d",aqDateTime.Now)
    Sys.Keys strMultiplier
    Call GridControl.ClickCell(GridControl.wRowCount-1,"AMTCUR")
    Sys.Keys("aaa")
    Delay 1500,"Pls Wait.."
'    Call GridControl.ClickRowIndicator(GridControl.wRowCount-1)
    Call GridControl.ClickCell(GridControl.wRowCount-1,"UMULTIPLIER")
    Delay 1500,"Pls Wait.."
    Call GridControl.ClickCell(GridControl.wRowCount-1,"UMULTIPLIER")
    
    strUnit=GridControl.GetFocusedRowCellValue_2("Description")

    Delay 2000,"Pls Wait.."
    
    ''Upload
    'strTemp="WPFObject(""ContentControlEx"", ""Upload"", 2)"
    'Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,25,True)
    Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("WaitControl").WPFObject("DockPanel", "", 1).WPFObject("StackPanel", "", 1).WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 9).WPFObject("BarButtonItemLinkControl", "", 1).WPFObject("ContentControlEx", "Upload", 2)
				If objTemp.Exists = True then
      objTemp.Click
      Delay 3000,"Upload.."
  
      strTemp="WPFObject(""PART_ContainerContent"")"
      'Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: WindowContentHolder", "Unit Page").FindChild("Name",strTemp,50,True)
      Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "Unit Page").FindChild("Name",strTemp,50,True)
'      strTemp="WPFObject(""DXMessageBox"", """", 1)"
'      Set objTemp=objTemp.WaitChild(strTemp,10000)
      If objTemp.Exists = True then
        Sys.Keys "Y"
        'Delay 15000,"Uploading..."
									Delay 3000, "Please Wait"
										Set objOK =Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "Unit Page").WPFObject("CustomMessageBoxWindow", "Unit Page", 1).WPFObject("Grid", "", 1).WPFObject("PART_InactiveBorder")
		        If objOK.Exists = True then
											sys.Keys "[Enter]"
										End If
        Call sEdgeProcessor
								strTemp="WPFObject(""PART_ContainerContent"")"
        Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "Unit Page").FindChild("Name",strTemp,50,True)
'        strTemp="WPFObject(""DXMessageBox"", """", 1)"
'        Set objTemp=objTemp.WaitChild(strTemp,10000)
        If objTemp.Exists = True then
          Sys.Keys "[Enter]"
    '      objTemp.Click 
          Call sEdgeProcessor
          Delay 2000,"Uploading..."          
        End If
      End If
    End If
			
				''Closing Unit
    'Call Aliases.EdgeClient.HwndSource_RibbonWindow.RibbonWindow.ContentControl.Grid.Grid.ContentControl.Grid.ContentControl.PART_ContainerContent.BarManager.DockPanel.DockLayoutManager.LayoutGroup.LayoutPanel.Click(1295, 9)
'    Call sCloseLayout()
      
    ''Closing Unit
     Dim i,j,objCaption,objText,strOk
     'Set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager")     
   		Set objEdge = Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager")
			If objEdge.Exists = True then  
    objText = objEdge.FindAllChildren("ClrClassName","LayoutGroup", 10,True)
        For i=0 to ubound(objText)
          log.Message objText(i).FullName
          log.Message objText(i).Name
          objCaption = objText(i).FindAllChildren("ClrClassName", "LayoutPanel",10,True)
          For j=0 to ubound(objCaption)
           log.Message objCaption(j).FullName
            log.Message objCaption(j).Name
            if objCaption(j).Content.Caption = "Unit" then 
                  log.Message objCaption(j).FullName
                  'Call objCaption(j).ClickR(objCaption(j).top/2,objCaption(j).left/30,0)
                    Call objCaption(j).ClickR(275, 8)
                    Delay 2000,"Pls Wait.."
                    sys.Keys "[Down][Down][Down][Enter]"
                    Delay 2000,"Pls Wait.."
                    strTemp="WPFObject(""DXMessageBox"", """", 1)"
'                    Set strOk=Sys.Process("EdgeClient").WPFObject("HwndSource: WindowContentHolder", "", 1).WPFObject("WindowContentHolder", "", 1).WPFObject("NonLogicalDecorator", "", 1).WPFObject("ThemedManagedContentPresenter", "", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("DXMessageBox", "", 1)
                    Set strOk=Sys.Process("EdgeClient").FindChild("Name",strTemp,20,True)
                    Delay 4000, "Closing Form..Pls wait.."
                    If strOk.Exists Then
                      SYS.Keys "[Enter]"
                    End If
                  Exit For 
              End if 
          Next
        Next   
  End If    
    strTCRemarks="New Unit Created- " & strUnit
    Set objTemp=Nothing
End Sub


Sub sUnitSTP(sTestData1)
'Sub sUnitSTP()
On Error Resume Next
    
    Dim objArray,FilePath,objSTPXls,oSTP_ExcelObj,objTemp,strTemp,strList

    STP=getSplitValue(sTestData1,"STP")
    STPSheetName=getSplitValue(sTestData1,"STPSheetName")
    strUnit=trim("10 TON")

' 			STP="Test Source 1"
'    STPSheetName="A1_1"
'				strTestDataFile="YYY-Automation-Test Source 1"
'    strUnit=trim("10 TON")
'    STP=602
'    STPSheetName=M_1
    
    objArray = Sys.FindAllChildren("ProcessName","EXCEL", 1,True)
    For i=0 to ubound(objArray)
      log.Message objArray(i).FullName
      set oSTP_ExcelObj = objArray(i).FindChild("WndCaption", "*" & STP & "*",1,True)
      If oSTP_ExcelObj.Exists = True Then
        strFileName=oSTP_ExcelObj.WndCaption
        If instr(strFileName,"Microsoft Excel")>0 then
          strFileName=GetFileName(strFileName,"Microsoft Excel")
        Else
          strFileName=GetFileNameExcel13(strFileName," - Excel")
        End If
        FilePath = aqEnvironment.GetEnvironmentVariable("USERPROFILE") & "\Documents\Edge\EdgeAddinStorage\" & aqConvert.DateTimeToFormatStr(aqDateTime.Today,"%Y-%m-%d")
        FilePath=FilePath & "\" & iif(instr(strFileName,"xlsx") > 0,strFileName,strFileName & ".xlsx")  
        log.Message FilePath
        Exit For
      Else
        log.Message "STP file not found in " & objArray(i).FullName
      End If
    Next


    Set objSTPXls=GetObject(FilePath)
    objSTPXls.DisplayAlerts=False
    With objSTPXls
      With .WorkSheets(STPSheetName)
    '       strUnit=.cells(4,22)
           .Range("V4").Select
      End With
    End With   
    ''Opening Unit to check whether created
'    Call Aliases.EXCEL.wndXLMAIN.XLDESK.EXCEL7.DblClick(465, 74)
    Delay 5000,"Pls Wait.."
    sys.Keys ("[F2]")
    Delay 5000,"Pls Wait.."

    strTemp="WinFormsObject(""radTextBoxControl1"")"
'    Set objTemp=Sys.Process("EXCEL", 2).WinFormsObject("UnitTypeForm").WinFormsObject("mainPanel").WinFormsObject("radTextBoxControl1")
    Set objStp=Sys.Process("EXCEL", 2).FindChild("Name",strTemp,50,True)
    If objStp.Exists = true then
      objStp.set_Text(strUnit)
      Delay 2000,"Unit Created"
'      strList=objStp.wItemList
'      If strList=strUnit then
        strTCRemarks="Unit created in STP"
'      End If
'      Sys.Process("EXCEL", 2).WinFormsObject("UnitTypeForm").WinFormsObject("mainPanel").WinFormsObject("buttonPanel").WinFormsObject("cancelButton").Click
      strTemp="WinFormsObject(""saveButton"")"
     Set objTemp=Sys.Process("EXCEL", 2).FindChild("Name",strTemp,15,True)
     If objTemp.Exists = True then
      objTemp.Click
     End If
    End If
    ''Closing STP
    '  If Save Warning Message occurs then selecting don't save option
      objSTPXls.Quit
      objSTPXls.Close
      strTemp="WPFObject(""HwndSource: CustomMessageBoxWindow"", ""Warning"")"
      Set ExcelClose=Sys.Process("EXCEL",2).WaitChild(strTemp,3000)
      If ExcelClose.Exists then
         ExcelClose.Keys("Y") 
      End If
      strTemp="Window(""NUIDialog"", ""Microsoft Excel"", 1)"
      Set ExcelClose=Sys.Process("EXCEL",2).WaitChild(strTemp,3000)
      If ExcelClose.Exists then
         ExcelClose.Keys("N") 
      End If
      Call CloseWindow
End Sub

Sub sHome_ConfirmUpdateCompletion()

On Error Resume Next

    Dim objEdgeMDI,strObject,strObj,objsrc,strTemp

    strObject = "WPFObject(""HwndSource: RibbonWindow"")"
    Set objEdgeMDI = Sys.Process("EdgeClient").WaitChild(strObject, 600000)
    If objEdgeMDI.Exists then
      strTemp="WPFObject(""TextBlock"", ""Confirm Update Completion"", 1)"
      Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,14,True)
      If objTemp.Exists = False then
        strTemp="WPFObject(""ContentControl"", ""Confirm Update"", 1)"
        Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).FindChild("Name",strTemp,16,True)
        If objTemp.Exists = True then
          objTemp.Click
        End If
        'Delay 6000,"Opening Confirm Update Completion.."
        Call sEdgeProcessor
        log.Message "Opened Confirm Update Completion"
        strTCRemarks="Opened Confirm Update Completion"
      Else
        log.Message "Confirm Update Completion is already opened"
        strTCRemarks="Confirm Update Completion is already opened"
        Exit Sub  
      End If

    Else
      log.Message "RibbonWindow not found"
    End If

    strObj = "WPFObject(""HwndSource: RibbonWindow"")"
    set objsrc = Sys.Process("EdgeClient").WaitChild(strObj, 50000)
    If objsrc.Exists = True then
      strObj = "WPFObject(""RibbonWindow"")"
      set objsrc = objEdgeMDI.WaitChild(strObj, 50000)
    End If
    If objsrc.Exists = True then
      strObj = "WPFObject(""ContentControl"", """", 1)"                     
      set objsrc = objsrc.WaitChild(strObj, 50000)
    End If
    If objsrc.Exists = True then
      strObj = "WPFObject(""Grid"", """", 1)"                     
      set objsrc = objsrc.WaitChild(strObj, 50000)
    End If
    If objsrc.Exists = True then
      strObj = "WPFObject(""Grid"", """", 1)"                     
      set objsrc = objsrc.WaitChild(strObj, 50000)
    End If
    If objsrc.Exists = True then
      strobj=" WPFObject(""ContentControl"", """", 2)"
      set objsrc = objsrc.WaitChild(strObj, 50000)
    End If
    If objsrc.Exists = True then
      strobj=" WPFObject(""Grid"", """", 1)"
      set objsrc = objsrc.WaitChild(strObj, 50000)
    End If
    If objsrc.Exists = True then
      strobj="  WPFObject(""ContentControl"", """", 1)"
      set objsrc = objsrc.WaitChild(strObj, 50000)  
    End If
    If objsrc.Exists = True then
      strobj=" WPFObject(""PART_ContainerContent"")"
      set objsrc = objsrc.WaitChild(strObj, 50000)   
    End If
    If objsrc.Exists = True then
      strobj=" WPFObject(""BarManager"")"
      set objsrc = objsrc.WaitChild(strObj, 50000)
    End If      
    If objsrc.Exists = True then
      strobj="WPFObject(""DockPanel"", """", 1)"
      set objsrc = objsrc.WaitChild(strObj, 50000)
    End If      
    If objsrc.Exists = True then
      strobj="WPFObject(""RibbonControl"")"
      set objsrc = objsrc.WaitChild(strObj, 50000)
    End If      
    If objsrc.Exists = True then
      strobj="WPFObject(""RibbonSelectedPageControl"", """", 1)"
      set objsrc = objsrc.WaitChild(strObj, 50000)   
    End If   
    If objsrc.Exists = True then
      strobj="WPFObject(""RibbonPagesControl"", """", 1)"
      set objsrc = objsrc.WaitChild(strObj, 50000)
    End If       
    If objsrc.Exists = True then
      strobj="WPFObject(""RibbonPageGroupsControl"", """", 1)"
      set objsrc = objsrc.WaitChild(strObj, 50000)
    End If     
    If objsrc.Exists = True then
      strobj="WPFObject(""RibbonPageGroupControl"", """", 1)"
      set objsrc = objsrc.WaitChild(strObj, 50000)
    End If     
    If objsrc.Exists = True then
      strobj="WPFObject(""BarItemLinkInfo"", """", 1)"
      set objsrc = objsrc.WaitChild(strObj, 50000)
    End If     
    If objsrc.Exists = True then
      strobj="WPFObject(""BarButtonItemLinkControl"", """", 1)"
      set objsrc = objsrc.WaitChild(strObj, 50000)
    End If   
    If objsrc.Exists = True then
      strobj="WPFObject(""DXImage"", """", 1)"
      set objsrc = objsrc.WaitChild(strObj, 50000)   
    End If    

    If Err.Number <> 0 then
      Log.Message Err.Description 
    End If

    Call CloseWindow

    Set ObjSys=Nothing
    Set objsrc=Nothing

End Sub

Sub sClearCache()

On Error Resume Next

    Dim ISI_CeicDataManager_Startup,strTemp,objTemp
    Dim objCDM_MDI
    'Dim strEnvi
    strEnvi = "Edge ( US Integration )"
    
    'Skipping testcase if it in production for Release Schedule testcase
'    If Ucase(Trim(strRequiredTCName))=Ucase(Trim("TC_RELEASESCHEDULE_04")) and Ucase(Trim(strEnvi)) = Ucase(Trim("Edge ( US Production )"  )) Then
'      Exit Sub
'    End If

    ''Clear Cache

    strTemp="WinFormsObject(""UiCommandBar1"")"
    Set objCDM_MDI=Sys.Process("ISI.CeicDataManager.Startup").FindChild("Name",strTemp,5,True)
    If objCDM_MDI.Exists = False then
        strTestCaseResult="FAIL"
        log.Message "UiCommandBar1 not found"
    Else
      objCDM_MDI.SetFocus
    End If
'    Set objCDM_MDI=Sys.Process("ISI.CeicDataManager.Startup").WinFormsObject("CDMMain_MDIParent").WinFormsObject("TopRebar1").WinFormsObject("UiCommandBar1")
    Call sys.Keys("~n")
     Delay 2000,"Pls Wait.."
     Sys.Keys("[Down][Down][Down]") 
     Sys.KEYS("a")

    strTemp="WinFormsObject(""ClearCacheMsgBox_Form"")"
    Set objTemp=Sys.Process("ISI.CeicDataManager.Startup").WaitChild(strTemp,3000)
    If objtemp.Exists = True then
      Sys.Process("ISI.CeicDataManager.Startup").WinFormsObject("ClearCacheMsgBox_Form").WinFormsObject("TableLayoutPanel2").WinFormsObject("UiButton_OK").Click
    End If

   
    'Call Aliases.ISI_CeicDataManager_Startup.CDMMain_MDIParent.TopRebar1.UiCommandBar1.Click(221, 13)
'    Sys.Process("ISI.CeicDataManager.Startup").WinFormsObject("CDMMain_MDIParent").Close

    'Selecting The required Environment
     Call sys.Keys("~nu")
     Delay 1000,"Pls Wait.."           
     Set objTemp=Sys.Process("ISI.CeicDataManager.Startup").WinFormsObject("ConnectionSetup_Form")
     Set ObjPopup = Sys.Process("ISI.CeicDataManager.Startup").WinFormsObject("ConnectionSetup_Form").WinFormsObject("UserProxySettings1").WinFormsObject("ComboBox_WebServiceURL")
      
     If objTemp.Exists = True And Ucase(Trim(strEnvi)) = Ucase(Trim("Edge ( US Integration )")) Then            
        If Ucase(Trim(ObjPopup.Text)) = UCase(Trim("Default")) Then 
          ObjPopup.Keys "[Down][Down][Down]"
          If Ucase(Trim(ObjPopup.Text))= Ucase(Trim("Integration")) Then 
            Sys.Process("ISI.CeicDataManager.Startup").WinFormsObject("ConnectionSetup_Form").WinFormsObject("Panel1").WinFormsObject("Button_OK").Click
            log.Message "Integration Environment is Set"          
          End If                   
        End If 
        Else If  objTemp.Exists = True And Ucase(Trim(strEnvi)) = Ucase(Trim("Edge ( US Production )")) then 
          If Ucase(Trim(ObjPopup.Text)) = UCase(Trim("Integration")) Then
            ObjPopup.Keys ("[Up][Up][Up]") 
            If Ucase(Trim(ObjPopup.Text))= Ucase(Trim("Default")) Then 
             Sys.Process("ISI.CeicDataManager.Startup").WinFormsObject("ConnectionSetup_Form").WinFormsObject("Panel1").WinFormsObject("Button_OK").Click
              log.Message "Production Environment is Set"      
           End If 
          End If
        End If                
      End If
      If ObjPopup.Exists Then 
        sys.Keys "~[F4]"
      End If
      
     ''Closing CDM
    sys.Keys "~[F4]"
    Set objTemp=Sys.WaitChild("Process(""ISI.CeicDataManager.Startup"")",100000)
    If objTemp.Exists = True then
        strTemp="WinFormsObject(""CDMYesNoDialog"")"
        Set objTemp=Sys.Process("ISI.CeicDataManager.Startup").WaitChild(strTemp,10000)
        If objTemp.Exists = True then
          Sys.Process("ISI.CeicDataManager.Startup").WinFormsObject("CDMYesNoDialog").WinFormsObject("TableLayoutPanel1").WinFormsObject("UiButton_Yes").Click
        End If
    End If
    Delay 5000,"Closing CDM"
    strTCRemarks="Cleared Cache"
End Sub

Sub sReleaseScheduleModule(strParameters)

On Error Resume Next

    Dim strTemp,objTemp,strCountry,GridControl,GridTreeView,strIndicator,intSeriesId,Grid,intI,strFromDate,objRow

    strCountry=getSplitValue(strParameters,"COUNTRY")
    strCategory=Replace(Now,"/","-")
    strIndicator=Replace(Now,"/","-")
    DescText = strCategory
    intSeriesId=getSplitValue(strParameters,"SERIESID")
    strFrequency=getSplitValue(strParameters,"FREQUENCY")
    
'    strCountry = "Test"
'    strCategory = Replace(Now,"/","-")
'    strIndicator = Replace(Now,"/","-")
'    intSeriesId = "370044257"
'    strFrequency = "A1"
    
    '    Country=Test
    'SERIESID=370044257
    'Frequency=A1
'    strCountry="Test"
'    intSeriesId="352897057"
      
    ''Selecting Country
    Delay 2000,"Country"
    Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("GroupBox", "", 1).WPFObject("WrapPanel", "", 1).WPFObject("StackPanel", "", 1).WPFObject("ComboBox", "", 1)
    'Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("GroupBox", "", 1).WPFObject("WrapPanel", "", 1).WPFObject("StackPanel", "", 1).WPFObject("ComboBox", "", 1)
    If objTemp.Exists = True then
      objTemp.Set_Text(strCountry)
'      Delay 20000,"Pls Wait..."
      Call sEdgeProcessor
    End If

    ''Creating Category
    Delay 2000,"Category"
    Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("GroupBox", "", 1).WPFObject("WrapPanel", "", 1).WPFObject("StackPanel", "", 2).WPFObject("Button", "+", 1)
    'Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("GroupBox", "", 1).WPFObject("WrapPanel", "", 1).WPFObject("StackPanel", "", 2).WPFObject("Button", "+", 1)
    If objTemp.Exists = True then
      objTemp.Click
      Call sEdgeProcessor
    End If
'    Delay 10000,"Pls Wait..."

    ''Edit Category
    strTemp="WPFObject(""PART_ContainerContent"")"
    Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: Root").WPFObject("Root").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContentOffset").WPFObject("Grid", "", 1).WaitChild(strTemp,80000)
    'Sys.Process("EdgeClient").WPFObject("HwndSource: Root").WPFObject("Root").WPFObject("Grid", "", 1).WaitChild(strTemp,80000)
    If objTemp.Exists = True then
      ''Add Category
      strTemp="WPFObject(""Button"", ""Add"", 1)"
      Set objTemp=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,True)
      If objTemp.Exists = True then
        objTemp.Click
        Delay 3000,"Add.."
        Call sEdgeProcessor
      End If
    End If
    
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: Root").WPFObject("Root").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContentOffset").WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 2).WPFObject("GridControl", "", 1)
    Set GridTreeView=Sys.Process("EdgeClient").WPFObject("HwndSource: Root").WPFObject("Root").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContentOffset").WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 2).WPFObject("GridControl", "", 1).WPFObject("TableView", "", 1)
    'Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: Root").WPFObject("Root").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 2).WPFObject("GridControl", "", 1)    
    'Set GridTreeView=Sys.Process("EdgeClient").WPFObject("HwndSource: Root").WPFObject("Root").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 2).WPFObject("GridControl", "", 1).WPFObject("TableView", "", 1)

     'Navigating to last row
     Call GridTreeView.NavigateToLastRow
    
    ''Clicking on New Row

'    GridControl.ClickRowIndicator(GridControl.wRowCount-1)
'    GridTreeView.DataContext.CurrentItem.set_Description(strCategory)
'    GridTreeView.DataContext.CurrentItem.set_DescriptionLocal(strCategory)

    Set objRow=GridTreeView.DataContext.SourceCollection.Item(GridControl.wRowCount-1)
    Delay 2000,"Pls Wait..."
    objRow.set_Description(strCategory)
    objRow.set_DescriptionLocal(strCategory)
    
    
    ''Savez
    Sys.Process("EdgeClient").WPFObject("HwndSource: Root").WPFObject("Root").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContentOffset").WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 3).WPFObject("Button", "Save", 1).Click
    'Sys.Process("EdgeClient").WPFObject("HwndSource: Root").WPFObject("Root").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 3).WPFObject("Button", "Save", 1).Click
    strTemp="WPFObject(""PART_ContainerContent"")"
    Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "Please Confirm")'.WPFObject("CustomMessageBoxWindow", "Please Confirm", 1).FindChild("Name",strTemp,50,True)
'    strTemp="WPFObject(""DXMessageBox"", """", 1)"
'    Set objTemp=objTemp.WaitChild(strTemp,80000)
    If objTemp.Exists = True then
      Sys.Keys "Y"
      strTemp="WPFObject(""HwndSource: CustomMessageBoxWindow"", ""Release Schedule Success"")"      
      Set objTemp=Sys.Process("EdgeClient").WaitChild(strTemp,60000)'.WPFObject("CustomMessageBoxWindow", "Release Schedule Success", 1).FindChild("Name",strTemp,50,True)
      Call objTemp.Click
      If objTemp.Exists = True then
        Sys.keys "O"
      End If
      
    Delay 5000,"Pls Wait..."
'      Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: WaitProgressWindow", "Please Wait...").WPFObject("WaitProgressWindow", "Please Wait...", 1).WPFObject("Grid", "", 1).WPFObject("PART_InactiveBorder")
'      'strTemp="WPFObject(""FloatingContainerBorder"")"
'      'Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: WaitProgressWindow", "Please Wait...")'.WPFObject("WaitProgressWindow", "Please Wait...", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,50000)
'      If objTemp.Exists = True then
'        Do until objTemp.Exists = False 
'          If objTemp.Focusable=False then
'            Delay 1000,"Pls Wait.."
'          End if 
'        Loop 
'       End If
'      Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: WaitProgressWindow", "Please Wait...").WPFObject("WaitProgressWindow", "Please Wait...", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder")
      
      ''Close
      Sys.Process("EdgeClient").WPFObject("HwndSource: Root").WPFObject("Root").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContentOffset").WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 3).WPFObject("Button", "Cancel", 2).Click
      'Sys.Process("EdgeClient").WPFObject("HwndSource: Root").WPFObject("Root").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 3).WPFObject("Button", "Cancel", 2).Click
      strTemp="WPFObject(""PART_ContainerContent"")"
      Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "Please Confirm")'.FindChild("Name",strTemp,50,True)
'      strTemp="WPFObject(""DXMessageBox"", """", 1)"
'      Set objTemp=objTemp.WaitChild(strTemp,360000)
      If objTemp.Exists = True then
        Sys.keys "Y"
      End If
      Call sEdgeProcessor
'      Delay 20000,"Pls Wait.."
    End If
      ''Selecting Created Category 
      Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("GroupBox", "", 1).WPFObject("WrapPanel", "", 1).WPFObject("StackPanel", "", 2).WPFObject("ComboBox", "", 1)
      'Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("GroupBox", "", 1).WPFObject("WrapPanel", "", 1).WPFObject("StackPanel", "", 2).WPFObject("ComboBox", "", 1)
      If objTemp.Exists = True then
        objTemp.set_Text(strCategory)
      End If   
  
      ''Creating Indicator
      Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("GroupBox", "", 1).WPFObject("WrapPanel", "", 1).WPFObject("StackPanel", "", 3).WPFObject("Button", "+", 1)
'      Delay 10000,"Pls Wait.."
      Call sEdgeProcessor
      If objTemp.Exists = True then
        objTemp.Click
      End If
 
      ''Edit Indicator
        strTemp="WPFObject(""PART_InactiveBorder"")"                    
        Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: Root").WPFObject("Root").WPFObject("Grid", "", 1).WaitChild(strTemp,80000)
        If objTemp.Exists = True then
          ''Add Category
          strTemp="WPFObject(""Button"", ""Add"", 1)"
          Set objTemp=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,True)
          If objTemp.Exists = True then
            objTemp.Click
            Delay 3000,"Add.."
'            Call sEdgeProcessor
          End If
        End If

      ''Clicking on New Row
'      GridControl.ClickRowIndicator(GridControl.wRowCount-1)
'      GridTreeView.DataContext.CurrentItem.set_Description(strIndicator)
'      GridTreeView.DataContext.CurrentItem.set_DescriptionLocal(strIndicator)

      Set objRow=GridTreeView.DataContext.SourceCollection.Item(GridControl.wRowCount-1)
      Call objRow.set_Description(strIndicator)
      Call objRow.set_DescriptionLocal(strIndicator)

      ''Save
      Sys.Process("EdgeClient").WPFObject("HwndSource: Root").WPFObject("Root").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContentOffset").WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 3).WPFObject("Button", "Save", 1).Click
      strTemp="WPFObject(""PART_ContainerContent"")"
      Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "Please Confirm")'.FindChild("Name",strTemp,50,True)
'      strTemp="WPFObject(""DXMessageBox"", """", 1)"
'      Set objTemp=objTemp.WaitChild(strTemp,360000)
      If objTemp.Exists = True then
        Sys.Keys "Y"
'        Delay 6000,"Pls Wait.."
        'Call sEdgeProcessor
        strTemp="WPFObject(""HwndSource: CustomMessageBoxWindow"", ""Release Schedule Success"")"
        Set objTemp=Sys.Process("EdgeClient").WaitChild(strTemp,60000)
'        strTemp="WPFObject(""DXMessageBox"", """", 1)"
'        Set objTemp=objTemp.WaitChild(strTemp,360000)
        If objTemp.Exists = True then
          Sys.keys "O"
        End If
        Delay 5000,"Pls Wait..."
'        Call sEdgeProcessor
'          strTemp="WPFObject(""FloatingContainerBorder"")"
'         Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: WaitProgressWindow", "Please Wait...")'.WPFObject("WaitProgressWindow", "Please Wait...", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,50000)
'         If objTemp.Exists = True then
'          Do until objTemp.Exists = False 
'            If objTemp.Focusable=False then
'              Delay 1000,"Pls Wait.."
'            End if 
'          Loop 
'         End If
       
        ''Close
        Sys.Process("EdgeClient").WPFObject("HwndSource: Root").WPFObject("Root").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContentOffset").WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 3).WPFObject("Button", "Cancel", 2).Click
        strTemp="WPFObject(""PART_ContainerContent"")"
        Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "Please Confirm")'.FindChild("Name",strTemp,50,True)
'        strTemp="WPFObject(""DXMessageBox"", """", 1)"
'        Set objTemp=objTemp.WaitChild(strTemp,360000)
        If objTemp.Exists = True then
          Sys.keys "Y"
        End If
        Delay 2000,"Pls Wait.."
        Call sEdgeProcessor
      End If
  
      ''Selecting Created Indicator
      Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("GroupBox", "", 1).WPFObject("WrapPanel", "", 1).WPFObject("StackPanel", "", 3).WPFObject("ComboBox", "", 1)
      If objTemp.Exists = True then
        objTemp.set_Text(strIndicator)
      End If  

      ''Selecting Frequency      
      Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("GroupBox", "", 1).WPFObject("WrapPanel", "", 1).WPFObject("StackPanel", "", 4).WPFObject("ComboBox", "", 1)
      If objTemp.Exists = True then
        objTemp.set_SelectedValue(strFrequency)
'        Delay 20000,"Pls Wait.."
        Call sEdgeProcessor
      End If  

      ''Attach Series
      strTemp="WPFObject(""ContentControlEx"", ""Attach Series"", 2)"
      Set objTemp=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,True)
      If objTemp.Exists = True then
        objTemp.Click
'        Delay 2000,"Pls Wait..."
          Call sEdgeProcessor
        ''Entering Series ID
        strTemp="WPFObject(""SeriesIdTextEdit"")"
        Set objTemp=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,True)
        'Sys.Process("EdgeClient").WPFObject("HwndSource: AttachSeriesPromptView", "Attach Series").WPFObject("AttachSeriesPromptView", "Attach Series", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WaitChild(strTemp,80000)
        If objTemp.Exists = True then
          objTemp.Text=intSeriesId
          ''Save
          Sys.Process("EdgeClient").WPFObject("HwndSource: AttachSeriesPromptView", "Attach Series").WPFObject("AttachSeriesPromptView", "Attach Series", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContentOffset").WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 2).WPFObject("Button", "Save", 1).Click
          'Sys.Process("EdgeClient").WPFObject("HwndSource: AttachSeriesPromptView", "Attach Series").WPFObject("AttachSeriesPromptView", "Attach Series", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 2).WPFObject("Button", "Save", 1).Click
          Delay 2000,"Pls Wait..."
        End If
      End If
  
      ''Schedule Type
      Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("GroupBox", "", 3).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 7).WPFObject("BarEditItemLinkControl", "", 1).WPFObject("ContentControlEx", "", 1).WPFObject("ComboBoxEdit", "", 1)
      'Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("GroupBox", "", 3).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 7).WPFObject("BarEditItemLinkControl", "", 1).WPFObject("ContentControlEx", "", 1).WPFObject("ComboBoxEdit", "", 1)
      If objTemp.Exists = True then
        objTemp.set_Text("Final")
'        Delay 5000,"Pls Wait.."
          Call sEdgeProcessor
      End If
  
      ''Adding New Schedule
      Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("GroupBox", "", 3).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarButtonItemLinkControl", "", 1).WPFObject("ContentControlEx", "Add", 2)
      'Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("GroupBox", "", 3).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarButtonItemLinkControl", "", 1).WPFObject("ContentControlEx", "Add", 2)
      If objTemp.Exists = True then
        Delay 2000,"Pls Wait.."
        objTemp.Click
        Delay 2000,"Pls Wait.."
        Call sEdgeProcessor
      End If
  
      On Error Resume Next   
	
       Set Grid=Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("GroupBox", "", 3).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 1).WPFObject("ReleaseScheduleGridControl")
       'Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("GroupBox", "", 3).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 1).WPFObject("ReleaseScheduleGridControl")
       Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("GroupBox", "", 3).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 1).WPFObject("ReleaseScheduleGridControl").WPFObject("ReleaseScheduleTableView").WPFObject("HierarchyPanel", "", 1).WPFObject("RowControl", "", 1).WPFObject("CellsControl", "", 1).WPFObject("LightweightCellEditor", "", 2).WPFObject("InplaceBaseEdit", "", 1)
       'Aliases.EdgeClient.HwndSource_RibbonWindow.RibbonWindow.ContentControl.Grid.Grid.ContentControl.Grid.ContentControl.PART_ContainerContent.BarManager.DockPanel.DockLayoutManager.LayoutGroup.LayoutPanel.Root.AdornerDecorator.AdornedControl.Grid.WPFObject("GroupBox", "", 3).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 1).WPFObject("ReleaseScheduleGridControl").WPFObject("ReleaseScheduleTableView").WPFObject("HierarchyPanel", "", 1).WPFObject("RowControl", "", 1).WPFObject("CellsControl", "", 1).WPFObject("LightweightCellEditor", "", 2).WPFObject("InplaceBaseEdit", "", 1)
       Delay 200
       objTemp.Click
       'strTemp=DatePart("m",aqDateTime.Now)
       strTemp=DatePart(Date)
       Delay 200
       sys.Keys strTemp
       Delay 200
       Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("GroupBox", "", 3).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 1).WPFObject("ReleaseScheduleGridControl").WPFObject("ReleaseScheduleTableView").WPFObject("HierarchyPanel", "", 1).WPFObject("RowControl", "", 1).WPFObject("CellsControl", "", 1).WPFObject("LightweightCellEditor", "", 3).WPFObject("InplaceBaseEdit", "", 1)
       'Aliases.EdgeClient.HwndSource_RibbonWindow.RibbonWindow.ContentControl.Grid.Grid.ContentControl.Grid.ContentControl.PART_ContainerContent.BarManager.DockPanel.DockLayoutManager.LayoutGroup.LayoutPanel.Root.AdornerDecorator.AdornedControl.Grid.WPFObject("GroupBox", "", 3).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 1).WPFObject("ReleaseScheduleGridControl").WPFObject("ReleaseScheduleTableView").WPFObject("HierarchyPanel", "", 1).WPFObject("RowControl", "", 1).WPFObject("CellsControl", "", 1).WPFObject("LightweightCellEditor", "", 3).WPFObject("InplaceBaseEdit", "", 1)
       objTemp.Click
       Delay 200

	       
    ''Upload
    Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarButtonItemLinkControl", "", 1).WPFObject("ContentControlEx", "Upload", 2).Click
    'Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarButtonItemLinkControl", "", 1).WPFObject("ContentControlEx", "Upload", 2).Click
    strTemp="WPFObject(""PART_ContainerContent"")"
    Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "Please Confirm")'.FindChild("Name",strTemp,50,True)
'    strTemp="WPFObject(""DXMessageBox"", """", 1)"
'    Set objTemp=objTemp.WaitChild(strTemp,600000)
'    Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: WindowContentHolder", "").WPFObject("WindowContentHolder", "", 1).WPFObject("NonLogicalDecorator", "", 1).WPFObject("ThemedManagedContentPresenter", "", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WaitChild(strTemp,80000)
    If objTemp.Exists = True then
      Sys.Keys "Y"
      Delay 5000,"Uploading.."
'      Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: WindowContentHolder", "").WPFObject("WindowContentHolder", "", 1).WPFObject("NonLogicalDecorator", "", 1).WPFObject("ThemedManagedContentPresenter", "", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WaitChild(strTemp,80000)
        strTemp="WPFObject(""PART_ContainerContent"")"
        Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "Release Schedule Success")'.FindChild("Name",strTemp,50,True)
'        strTemp="WPFObject(""DXMessageBox"", """", 1)"
'        Set objTemp=objTemp.WaitChild(strTemp,360000)
      If objTemp.Exists = True then
        Sys.Keys "O"
'        Delay 25000,"Uploading.."
        Call sEdgeProcessor
      End If
    End If

'    strTPDate=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("GroupBox", "", 3).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 1).WPFObject("ReleaseScheduleGridControl").WPFObject("ReleaseScheduleTableView").WPFObject("HierarchyPanel", "", 1).WPFObject("GridRow", "", 1).WPFObject("ScrollablePart").WPFObject("CellItemsControl", "", 1).WPFObject("GridCellContentPresenter", "", 1).WPFObject("DateEdit", "", 1).Text
    strTPDate=Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("GroupBox", "", 3).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 1).WPFObject("ReleaseScheduleGridControl").WPFObject("ReleaseScheduleTableView").WPFObject("HierarchyPanel", "", 1).WPFObject("RowControl", "", 1).WPFObject("CellsControl", "", 1).WPFObject("LightweightCellEditor", "", 1).WPFObject("InplaceBaseEdit", "", 1).DisplayText
    'Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("GroupBox", "", 3).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 1).WPFObject("ReleaseScheduleGridControl").WPFObject("ReleaseScheduleTableView").WPFObject("HierarchyPanel", "", 1).WPFObject("RowControl", "", 1).WPFObject("CellsControl", "", 1).WPFObject("LightweightCellEditor", "", 1).WPFObject("InplaceBaseEdit", "", 1).DisplayText.OleValue
    strTCRemarks="Release Schedule marked Final is Uploaded" & "<br />" & "Timepoint Date - " & strTPDate
    
     'Call sLaunchCDM(strParameters)
End Sub



Sub sCDMRelSc(strParameters)
'Sub sCDMRelSc()


On Error Resume Next
  'msgbox DescText

    Dim strTemp,objTemp,objGrid,intRow,intI,strTopic,strCurrent1
    Dim strSearch1,strSearch2,intJ,intK
    Dim objCommand,objBounds
    Dim oTemp,objCDM_MDI,blnFlag
    Dim strDate, strDate1, strTopic1 
    
    If Ucase(Trim(strRequiredTCName))=Ucase(Trim("TC_RELEASESCHEDULE_04")) and Ucase(Trim(strEnvi)) = Ucase(Trim("Edge ( US Production )"  )) Then
      Exit Sub
    End If

    strSearch1=getSplitValue(strParameters,"SEARCH1")
    strSearch2=getSplitValue(strParameters,"SEARCH2")
    strCategory= aqdatetime.Now

'    strSearch1="Countries"
'    strSearch2="Test"
'    DescText = "TTT"


    ''Clicking on Release Schedule
           
'    Opening Release Schedule tab/window

      
      
      Sys.Keys("~r")
      Delay 2000,"Refresh.."
      sys.Keys "~s+A"
      Delay 5000,"Refresh.."
'     sys.Keys "+A"
      sys.Keys "[F5]"
      Delay 2000,"Refresh.."
'     msgbox ("I just refreshed")
'    Delay 20000,"Pls Wait.."
     Set objRSTab = Sys.Process("ISI.CeicDataManager.Startup").WinFormsObject("CDMMain_MDIParent")._
		 WinFormsObject("MdiClient", "").WaitChild("WinFormsObject(""ReleaseSchedule_Form"")", 15000)
		 If objRSTab.Exists = True Then 
			Set objTemp = Sys.Process("ISI.CeicDataManager.Startup").WinFormsObject("CDMMain_MDIParent")._
			WinFormsObject("RibbonStatusBar1").LeftPanelCommands.Item(0).Text
			strTemp = objTemp.OleValue
      log.Message strTemp
      intI = 0
			While (UCase(strTemp)) <> "READY" And intI<150 'Wait for 'Ready' Status
        If strTemp <> "READY" And intI<150 Then
          intI = intI+1
          Delay 800,"Pls Wait.."
        Else                    
        End If
        Set objTemp = Sys.Process("ISI.CeicDataManager.Startup").WinFormsObject("CDMMain_MDIParent")._
			  WinFormsObject("RibbonStatusBar1").LeftPanelCommands.Item(0).Text
				strTemp = objTemp.OleValue
        log.Message strTemp
			Wend  
    End If      
    

    strTemp="WinFormsObject(""GridEX_Indicators"")"
'    Set objGrid=Sys.Process("ISI.CeicDataManager.Startup").WinFormsObject("CDMMain_MDIParent").WinFormsObject("MdiClient", "").WinFormsObject("ReleaseSchedule_Form").WinFormsObject("uiPanel_SearchSchedule").WinFormsObject("uiPanel0Container").WinFormsObject("ReleaseSchemaOptions1").WinFormsObject("ExplorerBar1").WinFormsObject("ExplorerBarContainerControl7").WinFormsObject("UiTab1").WinFormsObject("UiTabPage1").WinFormsObject("GridEX_Indicators")
    Set objGrid=Sys.Process("ISI.CeicDataManager.Startup").FindChild("Name",strTemp,50,True)
    If objGrid.Exists = False then
        strTestCaseResult="FAIL"
        Exit Sub
    End If
    intRow=objGrid.get_RowCount

    For intI=0 to intRow-1
        objGrid.set_Row(intI)
        strTopic=objGrid.CurrentRow.DataRow.Row.RootID
        If strTopic=strSearch1 then 
             intX = objGrid.CurrentRow.Position
             objGrid.Col = 0
             'Get Cell Bounds
'						Set objBounds = objGrid.GetCellBounds(intX, objGrid.CurrentColumn)
						'Click the check box
'						Call objGrid.Click(objBounds.Left + objBounds.Width/20 , objBounds.Top + objBounds.Height/2)
            objGrid.CurrentRow.set_Expanded(True)
            Exit For
        End If
    Next

    For IntJ=1 to intRow
          objGrid.set_Row(intI + intJ)
          strTopic=objGrid.CurrentRow.DataRow.Row.CountryName
          If strTopic=strSearch2 then   
  '             objTemp1.set_SelectedIndex(intI-1)
              objGrid.CurrentRow.set_Expanded(True)
              Delay 3000,"Expanding.."
              Exit For
          End If
      Next
      blnFlag=True 
      intRow=500
      For IntK=1 to intRow
          objGrid.set_Row(intI + intJ + intK)
          strTopic=objGrid.CurrentRow.DataRow.Row.CategoryName 
          If strTopic=DescText then
            blnFlag=False
                objGrid.Col = 0     
                intX = objGrid.CurrentRow.Position
  '              Get Cell Bounds
  						Set objBounds = objGrid.GetCellBounds(intX, objGrid.CurrentColumn)
  '						Click the check box
              Delay 2000,"Pls Wait.."
  						Call objGrid.Click(objBounds.Left + objBounds.Width/20 , objBounds.Top + objBounds.Height/2)
              Exit For
          End If       
        Next

   
         
        
    
    If blnFlag=True then
      strTestCaseResult="FAIL"
      strTCRemarks="Schedule folder not found in CDM"
      strFailMesssage = "Schedule folder not found in CDM"
      log.Message "Schedule folder not found in CDM"
      ''Closing CD    
        Set objTemp = CreateObject("WScript.Shell")
        objTemp.AppActivate "CEIC Data Manager"
        Delay 3000,"Pls Wait"
        sys.Keys "~[F4]"
        Set objTemp=Sys.WaitChild("Process(""ISI.CeicDataManager.Startup"")",10000)
        If objTemp.Exists = True then
            strTemp="WinFormsObject(""CDMYesNoDialog"")"
            Set objTemp=Sys.Process("ISI.CeicDataManager.Startup").WaitChild(strTemp,10000)
            If objTemp.Exists = True then
              Sys.Process("ISI.CeicDataManager.Startup").WinFormsObject("CDMYesNoDialog").WinFormsObject("TableLayoutPanel1").WinFormsObject("UiButton_Yes").Click
            End If
        End If
        Delay 3000,"Closing CDM"
        
      'Call CloseWindow
      Exit Sub
    End If

    ''Status
'    Call Aliases.ISI_CeicDataManager_Startup.CDMMain_MDIParent.MdiClient.ReleaseSchedule_Form.uiPanel_SearchSchedule.uiPanel0Container.ReleaseSchemaOptions1.ExplorerBar1.ExplorerBarContainerControl3.GridEX_Status.Click(12, 11)
    strTemp = "WinFormsObject(""CDMMain_MDIParent"")"
    Set objCDM_MDI = Sys.Process("ISI.CeicDataManager.Startup").Waitchild(strTemp,40000)
    If objCDM_MDI.Exists = True then
    strTemp="WinFormsObject(""ExplorerBar1"")"
    Set objTemp =objCDM_MDI.FindChild("Name",strTemp,15,True)
        If objTemp.Exists = True then
          strTemp="WinFormsObject(""GridEX_Status"")"
          Set oTemp = objTemp.FindChild("Name",strTemp,5,True)
          If oTemp.Exists = True Then 
            For intI = 0 to oTemp.Rowcount - 1
              oTemp.Row = intI
              oTemp.CurrentRow.set_CheckState(0)         
              Delay 1000,"Pls Wait.." 
            Next    
          End  If 
        End If
    End If
'    Delay 5000,"Pls Wait.." 
    
    ''Search
    Set objTemp1 = objTemp.WinFormsObject("ExplorerBarContainerControl4")._
        WinFormsObject("UiButton_Search")
    If objTemp1.Exists = True then
				objTemp1.Click 
    End If
		Set objResults = objCDM_MDI.WinFormsObject("MdiClient", "")._
		WaitChild("WinFormsObject(""ScheduleSearchResults_Form"")", 15000)  
    
    ''Results loaded
      Set objTemp = objCDM_MDI.WinFormsObject("RibbonStatusBar1")._
				LeftPanelCommands.Item(0).Text
				strTemp = objTemp.OleValue
				While (UCase(strTemp)) <> "READY" 'Wait for 'Ready' Status
          Set objTemp = objCDM_MDI.WinFormsObject("RibbonStatusBar1")._
				  LeftPanelCommands.Item(0).Text
					strTemp = objTemp.OleValue
          log.Message strTemp
				Wend 
              
        
'    Sys.Process("ISI.CeicDataManager.Startup").WinFormsObject("CDMMain_MDIParent").WinFormsObject("MdiClient", "").WinFormsObject("ReleaseSchedule_Form").WinFormsObject("uiPanel_SearchSchedule").WinFormsObject("uiPanel0Container").WinFormsObject("ReleaseSchemaOptions1").WinFormsObject("ExplorerBar1").WinFormsObject("ExplorerBarContainerControl4").WinFormsObject("UiButton_Search").Click
'    Delay 20000,"Pls Wait..."
    
    'Checking Pending status
    strTemp="WinFormsObject(""GridEX_PendingSearchResults"")"
    Set objPendingGrid=Sys.Process("ISI.CeicDataManager.Startup").FindChild("Name",strTemp,50,true)
    If Not fCheckEmpty(objPendingGrid) then
      If objPendingGrid.Exists=True then    
       If objPendingGrid.CurrentRow.DataRow.Row.Item(8)="Pending" then
        If Err.Number=0 then
          log.Message "The status of schedule is Pending in CDM"
          strTCRemarks="The status of schedule is Pending in CDM"
        End If
       End If
      End If
    End If
    If strTCRemarks="" then
     strTestCaseResult="ABORT"
    End If
    
End Sub

Sub sCDMRelSc1(strParameters)
On Error Resume Next

     'get series id
     SeriesId=getSplitValue(strParameters,"SERIESID")
     
'     If Ucase(Trim(strRequiredTCName))=Ucase(Trim("TC_RELEASESCHEDULE_04")) and Ucase(Trim(strEnvi)) = Ucase(Trim("Edge ( US Production )"  )) Then
'      Exit Sub
'    End If
     'SeriesId="370044257"
     
     'Click Search till Release grid is seen
     Set objSearch=Sys.Process("ISI.CeicDataManager.Startup").WinFormsObject("CDMMain_MDIParent")._
                  WinFormsObject("MdiClient", "").WinFormsObject("ScheduleSearchResults_Form")._
                  WinFormsObject("uiPanel_SearchSchedule").WinFormsObject("uiPanel_SearchScheduleContainer")._
                  WinFormsObject("ReleaseSchemaOptions1").WinFormsObject("ExplorerBar1")._
                  WinFormsObject("ExplorerBarContainerControl4").WinFormsObject("UiButton_Search")
                  
'     strTemp="WinFormsObject(""GridEX_ReleasedSearchResults"")"
'     Set objRelGrid=Sys.Process("ISI.CeicDataManager.Startup").FindChild("Name",strTemp,50,true)  
     cdm_time1=aqdatetime.Now
     Do While (DateDiff("s",aqdatetime.Now,cdm_time1)<450)
      strTemp="WinFormsObject(""GridEX_ReleasedSearchResults"")"
      Set objRelGrid=Sys.Process("ISI.CeicDataManager.Startup").FindChild("Name",strTemp,50,true)
      If RouTime=0 then
        Exit Do
      End If
      Delay 5000,"Refreshing..."       
      If objRelGrid.CurrentRow.DataRow.Row.Item(8)=SeriesId then
        'If Err.Number=0 then
        strTCRemarks="The status of the schedule is 'Released' in CDM"
        log.message strTCRemarks
        strTestCaseResult = "PASS"
        Exit Do
       ' End If
      End If
      Call objSearch.Click           
     Loop
     
     'Check the series in Released Grid
'     If Not fCheckEmpty(objRelGrid) then
'       If objRelGrid.Exists=True then
'         If objRelGrid.CurrentRow.DataRow.Row.Item(8)=SeriesId then
'            If Err.Number=0 then
'            strTCRemarks="The status of the schedule is 'Released' in CDM"
'            End If
'         End If
'       End If
'     End If
     If strTCRemarks="" then
      strTCRemarks="Category = "&strCategory
      strTestCaseResult="FAIL"
     End If
 
    ''Closing CDM    
    Set objTemp = CreateObject("WScript.Shell")
    objTemp.AppActivate "CEIC Data Manager"
    Delay 3000,"Pls Wait"
    sys.Keys "~[F4]"
    Set objTemp=Sys.WaitChild("Process(""ISI.CeicDataManager.Startup"")",10000)
    If objTemp.Exists = True then
        strTemp="WinFormsObject(""CDMYesNoDialog"")"
        Set objTemp=Sys.Process("ISI.CeicDataManager.Startup").WaitChild(strTemp,10000)
        If objTemp.Exists = True then
          Sys.Process("ISI.CeicDataManager.Startup").WinFormsObject("CDMYesNoDialog").WinFormsObject("TableLayoutPanel1").WinFormsObject("UiButton_Yes").Click
        End If
    End If
    Delay 3000,"Closing CDM" 
End Sub


Sub sHome_SeriesSearch(strParameters)

On Error Resume Next

    Dim objEdgeMDI,strObject,strObj,objsrc,strTemp
    SERIESID=getSplitValue(strParameters,"SERIESID")

    strObject = "WPFObject(""HwndSource: RibbonWindow"")"
    Set objEdgeMDI = Sys.Process("EdgeClient")'.WaitChild(strObject, 600000)
    If objEdgeMDI.Exists then
      strTemp="WPFObject(""TextBlock"", ""Source Series"", 1)"
      Set objTemp=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,True)
      If objTemp.Exists = False then
        strTemp="WPFObject(""ContentControl"", ""Series"", 1)"
        Set objTemp=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,True)
        If objTemp.Exists = True then
          objTemp.Click
          strTemp="WPFObject(""BarPopupBorderControl"", """", 1)"
          Set objTemp=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,True)
          If objTemp.Exists = True then
            strTemp="WPFObject(""ContentControlEx"", ""Search on Source Tree"", 2)"   
            Set objTemp=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,True)
            If objTemp.Exists = True then
              objTemp.Click
              Call sEdgeProcessor
            End If
          End If
        End If
    
        Delay 5000,"Opening Source Series.."
        log.Message "Opened Source Series"
        strTCRemarks="Opened Source Series"
      Else
        log.Message "Source Series is opened"
        strTCRemarks="Source Series is opened"
        Exit Sub  
      End If

    Else
      log.Message "RibbonWindow not found"
    End If
  
    'Input seriesid
    Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("Grid", "", 1).WPFObject("GridControl").WPFObject("GridView").WPFObject("PART_FilterRow").WPFObject("ContentPresenter", "", 1).WPFObject("FilterCellContentPresenter", "", 1).WPFObject("TextEdit", "", 1).Click
    
    Sys.Keys(seriesid)
    Delay 6000,"Series loading..."
    
    'Click on Primary Source cell    
    strTemp = "WPFObject(""InplaceBaseEdit"", """", 1)"
    Set objPSCell=Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("Grid", "", 1).WPFObject("GridControl").WPFObject("GridView").WPFObject("HierarchyPanel", "", 1).WPFObject("RowControl", "", 1).WPFObject("CellsControl", "", 1).WPFObject("LightweightCellEditor", "", 2).Waitchild(strTemp,120000)
       
    If objPSCell.DisplayText="Primary Source" then
      objPSCell.Click
      Delay 2000,"Loading..."
    End If
    
    'open Global STP
    
'    strTemp="WPFObject(""ContentControlEx"", ""Open Global STP"", 2)"
'    Set objSTP=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,true)
    Set objSTP=Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 2).WPFObject("BarButtonItemLinkControl", "", 1).WPFObject("ContentControlEx", "Open Global STP", 2)
    
    If objSTP.Enabled=TRUE then
      objSTP.Click
    End If
    
    Call sExcelFullHistory
    
    strTCRemarks=strTCRemarks&"<br/>"& "Opened Global STP"
    
End Sub

Sub sRelSch_STP(strParameters)
'Sub sRelSch_STP()
  On Error Resume Next
  STP=getSplitValue(strParameters,"STP")
  STPSheetName=getSplitValue(strParameters,"STPSheetName")
  SeriesId=getSplitValue(strParameters,"SERIESID")
  
  'strTPDate="12/1/2026"
'  
'  strTPDate="12/1/2032" 
'  STP = "Test"
'  STPSheetName ="A1_1"
'  SeriesId="370044257"

'  FilePath="C:\Users\rchethana\Documents\Edge\EdgeAddinStorage\2019-08-27\YYY-Test-prod-Automation.xlsx"
'  strFileName="YYY-Test-prod-Automation"
  
''Getting STP Object
    objArray = Sys.FindAllChildren("ProcessName","EXCEL", 1,True)
    For i=0 to ubound(objArray)
      log.Message objArray(i).FullName
      set oSTP_ExcelObj = objArray(i).FindChild("WndCaption", "*" & STP & "*",1,True)
      If oSTP_ExcelObj.Exists = True Then
        strFileName=oSTP_ExcelObj.WndCaption
        If instr(strFileName,"Microsoft Excel")>0 then
          strFileName=GetFileName(strFileName,"Microsoft Excel")
        Else
          strFileName=GetFileNameExcel13(strFileName," - Excel")
        End If
        FilePath = aqEnvironment.GetEnvironmentVariable("USERPROFILE") & "\Documents\Edge\EdgeAddinStorage\" & aqConvert.DateTimeToFormatStr(aqDateTime.Today,"%Y-%m-%d")
        FilePath=FilePath & "\" & iif(instr(strFileName,"xlsx") > 0,strFileName,strFileName & ".xlsx")  
        log.Message FilePath
        Exit For
      Else
        log.Message "STP file not found in " & objArray(i).FullName
      End If
    Next
    
   ' Set netUIHWND = Aliases.EXCEL.wndXLMAIN.EXCEL2.toolbarRibbon.Ribbon.NUIPane.NetUIHWND
   Set netUIHWND =  Sys.Process("EXCEL", 2).Window("XLMAIN", strFileName &"*", 1).Window("EXCEL2", "", 2).Window("MsoCommandBar", "Ribbon", 1).Window("MsoWorkPane", "Ribbon", 1).Window("NUIPane", "", 1).Window("NetUIHWND", "", 1)

    
    Set objSTPXls=GetObject(FilePath)
    With objSTPXls
     .Sheets(STPSheetName).Select
    End With
    
    With objSTPXls
     With .WorkSheets(STPSheetName)
      .Cells(4,1).Select 
       For i=25 to 45
        If cstr(.Cells(2,i).Value)=cstr(strTPDate) then
         Exit For
        End If
       Next
       If clng(.Cells(4,1).Value)=clng(SeriesId) and cstr(.Cells(2,i).Value)=cstr(strTPDate) then
        .Cells(4,i).Select
        .Cells(4,i).Value=50
        .Cells(4,i+1).Select
        .Cells(4,i).Select
        Delay 10000, "Please Wait" 
        Call NetUIHWND.Click(589, 42)
        Call NetUIHWND.Click(589, 42)'Click on Edge Addin        
        Call netUIHWND.Click(622, 68) 'Click Timepoint Details
        Set objTPDetails=Sys.Process("EXCEL", 2).WinFormsObject("TPDetailsForm")
        If objTPDetails.Exists=True then
         Set objGridView=Sys.Process("EXCEL", 2).WinFormsObject("TPDetailsForm").WinFormsObject("mainPanel").WinFormsObject("gridView")
         Call objGridView.Click(313, 70)'Click the arrow in the combo-box
         Call objGridView.Click(313, 70)
         Delay 5000,"Selecting option..."
         Set objDropDown=Sys.Process("EXCEL", 2).WinFormsObject("DropDownPopupForm", "")
         If objDropDown.Exists=True then
          'Clicking the option in combo-box
          'Call objDropDown.Set_Text("Preliminary")
          Call objDropDown.Click(5,5)
       
          Call objGridView.Click(405, 123)'To click in empty area of grid to activate save button
          Delay 2000
          Set objSave=Sys.Process("EXCEL", 2).WinFormsObject("TPDetailsForm").WinFormsObject("mainPanel")._
                      WinFormsObject("buttonPanel").WinFormsObject("saveButton")
          Call objSave.Click
          Set objWarning=Sys.Process("EXCEL", 2).WPFObject("HwndSource: CustomMessageBoxWindow", "Warning")
          If objWarning.Exists=True then
           strTemp="WPFObject(""Button_Yes"")"
           Set objYesButton=objWarning.FindChild("Name",strTemp,50,true)
           Call objYesButton.Click
           strTCRemarks="The timepoint type is marked Preliminary."
          End If
         End If
        End If
        ''Mark Good
        Delay 1000,"Mark Good..."
        With objSTPXls
          With .WorkSheets(STPSheetName)
               .Cells.Select
          End With
        End With
        
         ''Mark Good
       Call sClicKMarkGood(2,strFileName)
       
        ''Upload Series
        Call sClickUpload(2,strFileName)
        
        'Click Yes to close ExcelFile
       Call sClickonInformation(2,"Yes")         

       Else
        strTCRemarks="Unable to find Timepoint"
        strTestCaseResult="ABORT"    
       End If
     End With
    End With
    
    'Closing Source Series Window
     Call CloseSearch()
     
     'Refresh Release status
     strTemp="WPFObject(""ContentControlEx"", ""Refresh"", 2)"
     Set objRefresh=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,true)
     Call objRefresh.Click
     Call sEdgeProcessor
 
     'Checking schedule(timepoint) status
     Set objStatus =	Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("GroupBox", "", 3).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 1).WPFObject("ReleaseScheduleGridControl").WPFObject("ReleaseScheduleTableView").WPFObject("HierarchyPanel", "", 1).WPFObject("RowControl", "", 1).WPFObject("CellsControl", "", 1).WPFObject("LightweightCellEditor", "", 7).WPFObject("PART_Editor")
     Call objStatus.Click
     Delay 2000,"Showing Status..."
     Call objStatus.Click
     If objStatus.Text="Pending" then
       strTCRemarks=strTCRemarks & "<br/>"  &"The 'Release status' of the schedule is 'Pending'  as timepoint type and schedule type are different"
       strTestCaseResult="PASS"
     Else
       strTCRemarks=strTCRemarks & "<br/>"  &"The 'Release status' of the schedule is not 'Pending'  as timepoint type and schedule type are not different"
       strTestCaseResult="FAIL"
     End If
 
     Call CloseWindow              
 
    
End Sub


'Sub sRelSch_STP1()
Sub sRelSch_STP1(strParameters)
On Error Resume Next
  
 
  strTestDataFile=getSplitValue(strParameters,"TestDataFile")
  STPSheetName=getSplitValue(strParameters,"STPSheetName")
  SeriesId=getSplitValue(strParameters,"SERIESID")
  
'  'strTPDate="12/1/2026"
'  strTPDate="12/1/2031"
'  STPSheetName="A1_1"
'  STP="Test"
'  SERIESID="370044257"
  

''Getting STP Object
    objArray = Sys.FindAllChildren("ProcessName","EXCEL", 1,True)
    For i=0 to ubound(objArray)
      log.Message objArray(i).FullName
      set oSTP_ExcelObj = objArray(i).FindChild("WndCaption", "*" & strTestDataFile & "*",1,True)
      If oSTP_ExcelObj.Exists = True Then
        strFileName=oSTP_ExcelObj.WndCaption
        If instr(strFileName,"Microsoft Excel")>0 then
          strFileName=GetFileName(strFileName,"Microsoft Excel")
        Else
          strFileName=GetFileNameExcel13(strFileName," - Excel")
        End If
        FilePath = aqEnvironment.GetEnvironmentVariable("USERPROFILE") & "\Documents\Edge\EdgeAddinStorage\" & aqConvert.DateTimeToFormatStr(aqDateTime.Today,"%Y-%m-%d")
        FilePath=FilePath & "\" & iif(instr(strFileName,"xlsx") > 0,strFileName,strFileName & ".xlsx")  
        log.Message FilePath
        Exit For
      Else
        log.Message "STP file not found in " & objArray(i).FullName
      End If
    Next
    
    
    Set objSTPXls=GetObject(FilePath)
    With objSTPXls
     .Sheets(STPSheetName).Select
     ' msgbox .Cells(2,25).Value
    End With
    
    
  With .WorkSheets(STPSheetName)
     lastColumn= .UsedRange.Columns.Count        
     For inti = 3 to lastColumn
          strText=.Cells(2,inti)
          .Cells(intlastRow,inti).Select
        If Cstr(strText)=Cstr(strTPDate)  then
          i=inti
          Exit For
        End if 
	   Next
'    'For i=25 to 45
'     For r = 1 To .UsedRange.Rows.Count
'      If cstr(.Cells(2,i).Value)=cstr(strTPDate) then
'       Exit For
'      End If
'    Next
    
    With objSTPXls
     With .WorkSheets(STPSheetName)
      .Cells(4,1).Select
       If clng(.Cells(4,1).Value)=clng(SeriesId) and cstr(.Cells(2,i).Value)=cstr(strTPDate) then
        .Cells(4,i).Select
        .Cells(4,i).Value=50
        .Cells(4,i+1).Select
        .Cells(4,i).Select        
        End If
     End With
    End With
      ''Mark Good
      Delay 1000,"Mark Good..."
      With objSTPXls
        With .WorkSheets(STPSheetName)
             .Cells.Select
        End With
      End With
      'Call netUIHWND.Click(32, 92)
      'clcik on Mark Good
      Delay 1000
      Call sClicKMarkGood(strExcelNumber,strTestDataFile) 
      Delay 2000, "Please wait"
      ''Upload Series
      'Call netUIHWND.Click(131, 69)
       Delay 1000
       Call sClickUpload(strExcelNumber,strTestDataFile)
       Delay 2000, "Please wait"
       
       'Click on Information 
       Call sClickonInformation(strExcelNumber,"Yes")  
      End With  
      

    
    'Closing Source Series Window
     Call CloseSearch()
     
     'Refresh Release status
     strTemp="WPFObject(""ContentControlEx"", ""Refresh"", 2)"
     Set objRefresh=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,true)
     Call objRefresh.Click
     Call sEdgeProcessor 
     'Checking schedule(timepoint) status
     Set objStatus=Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("GroupBox", "", 3).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 1).WPFObject("ReleaseScheduleGridControl").WPFObject("ReleaseScheduleTableView").WPFObject("HierarchyPanel", "", 1).WPFObject("RowControl", "", 1).WPFObject("CellsControl", "", 1).WPFObject("LightweightCellEditor", "", 7).WPFObject("PART_Editor")
     Call objStatus.Click
     Delay 2000,"Showing Status..."
     Call objStatus.Click
     If objStatus.Text="Released" then
      strTCRemarks=strTCRemarks & "<br/>"  &"The status of the schedule is 'Released' in EDGE."
      log.message strTCRemarks
      strTestCaseResult="PASS"
     Else
        strTCRemarks=strTCRemarks & "<br/>"  &"The status of the schedule is"+ objStatus.Text+" in EDGE."
        log.message strTCRemarks
        strTestCaseResult="FAIL"
     End If
 
     Call CloseWindow              
 
    
End Sub




''Closing Edge Window
Sub CloseWindow()
  'Call Aliases.EdgeClient.HwndSource_RibbonWindow.RibbonWindow.ContentControl.Grid.Grid.ContentControl.Grid.ContentControl.PART_ContainerContent.BarManager.DockPanel.DockLayoutManager.LayoutGroup.LayoutPanel.Click(1296, 10)
On Error Resume Next
      Dim objEdge,strTemp,objTemp, objStrClose
      
      
      strTemp = "WPFObject(""LayoutPanel"", """", 1)"
      Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).FindChild("Name",strTemp,10,true)
       If objTemp.Exists = TRUE then
          objTemp.Click
          objTemp.Closed=true
          Delay 5000,"Closing Form..." 
      End If
      
End Sub

Sub CloseSearch()

On Error Resume Next

    Dim objEdge,i,j,objCaption,objText,strOk
    Set objEdge=Sys.Process("EdgeClient")'.WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager")     
   If objEdge.Exists = True then  
    objText = objEdge.FindAllChildren("ClrClassName","LayoutGroup", 50,True)
        For i=0 to ubound(objText)
          log.Message objText(i).FullName
          log.Message objText(i).Name
          objCaption = objText(i).FindAllChildren("ClrClassName", "LayoutPanel",50,True)
          For j=0 to ubound(objCaption)
            log.Message objCaption(j).FullName
            log.Message objCaption(j).Name
            if objCaption(j).Content.Caption = "Source Series" then 
                  log.Message objCaption(j).FullName
                  'Call objCaption(j).ClickR(objCaption(j).top/2,objCaption(j).left/30,0)
                    Call objCaption(j).ClickR(275, 8)
                    Delay 2000,"Pls Wait.."
                    sys.Keys "[Down][Down][Down][Enter]"
                    Delay 2000,"Pls Wait.."
                    'Set strOk=Sys.Process("EdgeClient").WPFObject("HwndSource: WindowContentHolder", "Edge").WPFObject("WindowContentHolder", "Edge", 1).WPFObject("NonLogicalDecorator", "", 1).WPFObject("ThemedManagedContentPresenter", "", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("DXMessageBox", "", 1)
                    Set strOk=Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "Edge")
                    Delay 2000, "Closing Form..Pls wait.."
                    If strOk.Exists Then
                      SYS.Keys "[Enter]"
                    End If
                  Exit For 
              End if 
          Next
        Next   
  End If

      
End Sub


' Release Schedule 
' Author        : Sneha
' Date          : 10-7-2015
' Last Modified : 
' Purpose : Release Schedule 

Sub sHome_ReleaseSchedule()

On Error Resume Next

Dim objEdgeMDI,strObject,strObj,objsrc,strTemp


strObject = "WPFObject(""HwndSource: RibbonWindow"")"
Set objEdgeMDI = Sys.Process("EdgeClient")'.WaitChild(strObject, 600000)
If objEdgeMDI.Exists then
  strTemp="WPFObject(""TextBlock"", ""Release Schedule"", 1)"
  Set objTemp=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,true)
  'Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,14,True)
  If objTemp.Exists = False then
    strTemp="WPFObject(""ContentControl"", ""Release"", 1)"
    Set objTemp=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,true)
    'Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).FindChild("Name",strTemp,16,True)
    If objTemp.Enabled = True then
      If objTemp.Exists = True then
        objTemp.Click
      End if 
    Else
      log.Message "Release Schedule is Disabled"
      strTCRemarks="Release Schedule is Disabled"
      Exit Sub 
    End If
    Call sEdgeProcessor
    Delay 1000,"Opening Release Schedule.."
    log.Message "Opened Release Schedule"
    strTCRemarks="Opened Release Schedule"
  Else
    log.Message "Release Schedule is opened"
    strTCRemarks="Release Schedule is opened"
    strTestCaseResult = "ABORT"
    Exit Sub 
  End If

Else
  log.Message "RibbonWindow not found"
  strTCRemarks="Release Schedule not found"
  Exit Sub
End If

'strObj = "WPFObject(""HwndSource: RibbonWindow"")"
'set objsrc = Sys.Process("EdgeClient").WaitChild(strObj, 50000)
'If objsrc.Exists = True then
'  strObj = "WPFObject(""RibbonWindow"")"
'  set objsrc = objEdgeMDI.WaitChild(strObj, 50000)
'End If
'If objsrc.Exists = True then
'  strObj = "WPFObject(""ContentControl"", """", 1)"                     
'  set objsrc = objsrc.WaitChild(strObj, 50000)
'End If
'If objsrc.Exists = True then
'  strObj = "WPFObject(""Grid"", """", 1)"                     
'  set objsrc = objsrc.WaitChild(strObj, 50000)
'End If
'If objsrc.Exists = True then
'  strObj = "WPFObject(""Grid"", """", 1)"                     
'  set objsrc = objsrc.WaitChild(strObj, 50000)
'End If
'If objsrc.Exists = True then
'  strobj=" WPFObject(""ContentControl"", """", 2)"
'  set objsrc = objsrc.WaitChild(strObj, 50000)
'End If
'If objsrc.Exists = True then
'  strobj=" WPFObject(""Grid"", """", 1)"
'  set objsrc = objsrc.WaitChild(strObj, 50000)
'End If
'If objsrc.Exists = True then
'  strobj="  WPFObject(""ContentControl"", """", 1)"
'  set objsrc = objsrc.WaitChild(strObj, 50000)  
'End If
'If objsrc.Exists = True then
'  strobj=" WPFObject(""PART_ContainerContent"")"
'  set objsrc = objsrc.WaitChild(strObj, 50000)   
'End If
'If objsrc.Exists = True then
'  strobj=" WPFObject(""BarManager"")"
'  set objsrc = objsrc.WaitChild(strObj, 50000)
'End If      
'If objsrc.Exists = True then
'  strobj="WPFObject(""DockPanel"", """", 1)"
'  set objsrc = objsrc.WaitChild(strObj, 50000)
'End If      
'If objsrc.Exists = True then
'  strobj="WPFObject(""RibbonControl"")"
'  set objsrc = objsrc.WaitChild(strObj, 50000)
'End If      
'If objsrc.Exists = True then
'  strobj="WPFObject(""RibbonSelectedPageControl"", """", 1)"
'  set objsrc = objsrc.WaitChild(strObj, 50000)   
'End If   
'If objsrc.Exists = True then
'  strobj="WPFObject(""RibbonPagesControl"", """", 1)"
'  set objsrc = objsrc.WaitChild(strObj, 50000)
'End If       
'If objsrc.Exists = True then
'  strobj="WPFObject(""RibbonPageGroupsControl"", """", 1)"
'  set objsrc = objsrc.WaitChild(strObj, 50000)
'End If     
'If objsrc.Exists = True then
'  strobj="WPFObject(""RibbonPageGroupControl"", """", 1)"
'  set objsrc = objsrc.WaitChild(strObj, 50000)
'End If     
'If objsrc.Exists = True then
'  strobj="WPFObject(""BarItemLinkInfo"", """", 1)"
'  set objsrc = objsrc.WaitChild(strObj, 50000)
'End If     
'If objsrc.Exists = True then
'  strobj="WPFObject(""BarButtonItemLinkControl"", """", 1)"
'  set objsrc = objsrc.WaitChild(strObj, 50000)
'End If   
'If objsrc.Exists = True then
'  strobj="WPFObject(""DXImage"", """", 1)"
'  set objsrc = objsrc.WaitChild(strObj, 50000)   
'End If      

If Err.Number <> 0 then
  Log.Message Err.Description 
End If

Set ObjSys=Nothing
Set objsrc=Nothing

End Sub

Sub sHome_Report()


On Error Resume Next

Dim objEdgeMDI,strObject,strObj,objsrc,strTemp
'strEnvi = "Edge ( US Production )"  
  strObject = "WPFObject(""HwndSource: Shell"", """& strEnvi &""")"
  Set objEdgeMDI = Sys.Process("EdgeClient").WaitChild(strObject, 600000)
  If objEdgeMDI.Exists then
    strTemp="WPFObject(""TextBlock"", ""Report"", 1)"
    Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,14,True)
    If objTemp.Exists = False then
      '  Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("TextBlock", "Source", 1)
      'strTemp="WPFObject(""ContentControl"", ""Report"", 1)"
      Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("RibbonControl").WPFObject("RibbonSelectedPageControl", "", 1).WPFObject("RibbonPagesControl", "", 1).WPFObject("RibbonPageGroupsControl", "", 1).WPFObject("RibbonPageGroupControl", "", 1).WPFObject("BarItemLinkInfo", "", 17).WPFObject("BarButtonItemLinkControl", "", 1).WPFObject("TextSplitterControl", "", 1).WPFObject("ContentControl", "Report", 1)
      If objTemp.Exists = True then
        objTemp.Click
								Call sEdgeProcessor
      	log.Message "Report layout is opened"
      End If       
    Else
      log.Message "Report is already opened"
      strTCRemarks="Report is already opened"
      Exit Sub  
    End If
  Else
    log.Message "RibbonWindow not found"
  End If
		
    If Err.Number <> 0 then
    Log.Message Err.Description 
				'  Set ObjSys=Nothing
'  Set objsrc=Nothing
  
End If


End Sub


Sub sReport(strParameters)
'Sub sReport()
  Dim strTemp,objTemp,GridControl,GridSourceTree,strLevel1,strLevel2,intTotNodeCnt,intRow
  Dim strYear,strMonth,strOffice,strCountry,strLagtime,strSeriesStatus,strSourceOrder,strSeriesType,oSTP_ExcelObj

  strLevel1=getSplitValue(strParameters,"LEVEL1")
  strLevel2=getSplitValue(strParameters,"LEVEL2")
  strYear=getSplitValue(strParameters,"Year")
  strMonth=getSplitValue(strParameters,"Month")
		
		
'		strLevel1="Summary Report"
'  strLevel2="Layout Count Report"
'  strYear="2015"
'  strMonth="August"
		
		
'  strOffice=getSplitValue(strParameters,"Office")
'  strCountry=getSplitValue(strParameters,"Country")
'  strLagtime=getSplitValue(strParameters,"Lagtime")
'  strSeriesStatus=getSplitValue(strParameters,"SeriesStatus")
'  strSourceOrder=getSplitValue(strParameters,"SourceOrder")
'  strSeriesType=getSplitValue(strParameters,"SeriesType")

  'Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("ReportTreeLevel").WPFObject("ReportTreeView")
  'Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("ReportTreeLevel")
  Set GridControl= Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("ReportTreeLevel").WPFObject("ReportTreeView")
		Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("ReportTreeLevel")

  ''First level
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strLevel1) then
          GridControl.Nodes_2.Item(intI).ExpandAll
          log.Message "First Level- " & GridControl.Nodes_2.Item(intI).Content.Description       
          blnFlag=False  
          Exit For
        End If
    Next
  
    ''Second level
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
    For intJ=0 to intTotNodeCnt-1
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strLevel2) then
        intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
        Call GridSourceTree.ClickCell(intRow, "Group Name") 
        log.Message "Second Level- " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description 
        blnFlag = False 
        Exit For
      End If
    Next
  
    Delay 10000,"Pls Wait.."
  
  
    ''Report Filter
'    strTemp="WPFObject(""GroupBox"", """", 1)"
'    Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("GroupBox", "", 1)
    Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("GroupBox", "", 1)
				If objTemp.Exists = True then
      ''Year
      'Delay 1000,"Year"
     ' Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("GroupBox", "", 1).WPFObject("ScrollViewer", "", 1).WPFObject("grdMainSearch").WPFObject("CntCtrl").WPFObject("grdSearch").WPFObject("cbo1")
   		Set objTemp = Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("GroupBox", "", 1).WPFObject("ScrollViewer", "", 1).WPFObject("grdMainSearch").WPFObject("CntCtrl").WPFObject("grdSearch").WPFObject("cbo1")
					 If objTemp.Exists = True then
        objTemp.set_Text(strYear)
								Delay 1000,"Year"
      End If
     ''Month
     
      'Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("GroupBox", "", 1).WPFObject("ScrollViewer", "", 1).WPFObject("grdMainSearch").WPFObject("CntCtrl").WPFObject("grdSearch").WPFObject("cbo2")
      Set objTemp = Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("GroupBox", "", 1).WPFObject("ScrollViewer", "", 1).WPFObject("grdMainSearch").WPFObject("CntCtrl").WPFObject("grdSearch").WPFObject("cbo2")
						If objTemp.Exists = True then
        objTemp.set_Text(strMonth)
								Delay 1000,"Month"
      End If

      ''Clicking on Search button      
      Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("GroupBox", "", 1).WPFObject("ScrollViewer", "", 1).WPFObject("grdMainSearch").WPFObject("Grid", "", 1).WPFObject("btnSearch").Click
	     Call sEdgeProcessor
    
      ''Checking for Excel
      blnFlag=False
      objArray = Sys.FindAllChildren("ProcessName","EXCEL", 1,True)
      For i=0 to ubound(objArray)
        log.Message objArray(i).FullName
        set oSTP_ExcelObj = objArray(i).FindChild("WndCaption", "*" & strLevel2 & "*",1,True)
        If oSTP_ExcelObj.Exists = True Then
          strFileName=oSTP_ExcelObj.WndCaption 
          log.Message strFileName
          blnFlag=True
          Exit For
        Else
          log.Message "Excel file not found" 
        End If
      Next
      ''I
      If blnFlag=False then
          Delay 1000*60*1,"Opening Report...Pls Wait.."
          ''Checking for Excel
          objArray = Sys.FindAllChildren("ProcessName","EXCEL", 1,True)
          For i=0 to ubound(objArray)
            log.Message objArray(i).FullName
            set oSTP_ExcelObj = objArray(i).FindChild("WndCaption", "*" & strLevel2 & "*",1,True)
            If oSTP_ExcelObj.Exists = True Then
              strFileName=oSTP_ExcelObj.WndCaption 
              log.Message "Found Excel in level I-" & strFileName
              blnFlag=True
              Exit For
            Else
              log.Message "Excel file not found" 
            End If
          Next
      End If
      ''II
      If blnFlag=False then
        Delay 1000*60*1,"Opening Report...Pls Wait.."

        ''Checking for Excel
        objArray = Sys.FindAllChildren("ProcessName","EXCEL", 1,True)
        For i=0 to ubound(objArray)
          log.Message objArray(i).FullName
          set oSTP_ExcelObj = objArray(i).FindChild("WndCaption", "*" & strLevel2 & "*",1,True)
          If oSTP_ExcelObj.Exists = True Then
            strFileName=oSTP_ExcelObj.WndCaption 
            log.Message "Found Excel in level II-" & strFileName
            blnFlag=True
            Exit For
          Else
            log.Message "Excel file not found" 
          End If
        Next
      End If
      ''III
      If blnFlag=False then
        Delay 1000*60*1,"Opening Report...Pls Wait.."

        ''Checking for Excel
        objArray = Sys.FindAllChildren("ProcessName","EXCEL", 1,True)
        For i=0 to ubound(objArray)
          log.Message objArray(i).FullName
          set oSTP_ExcelObj = objArray(i).FindChild("WndCaption", "*" & strLevel2 & "*",1,True)
          If oSTP_ExcelObj.Exists = True Then
            strFileName=oSTP_ExcelObj.WndCaption 
            log.Message "Found Excel in level III-" & strFileName
            blnFlag=True
            Exit For
          Else
            log.Message "Excel file not found" 
          End If
        Next
      End If
      ''IV
      If blnFlag=False then
        Delay 1000*60*1,"Opening Report...Pls Wait.."

        ''Checking for Excel
        objArray = Sys.FindAllChildren("ProcessName","EXCEL", 1,True)
        For i=0 to ubound(objArray)
          log.Message objArray(i).FullName
          set oSTP_ExcelObj = objArray(i).FindChild("WndCaption", "*" & strLevel2 & "*",1,True)
          If oSTP_ExcelObj.Exists = True Then
            strFileName=oSTP_ExcelObj.WndCaption 
            log.Message "Found Excel in level IV-" & strFileName
            blnFlag=True
            Exit For
          Else
            log.Message "Excel file not found" 
          End If
        Next
      End If
      ''V
      If blnFlag=False then
        Delay 1000*60*1,"Opening Report...Pls Wait.."

        ''Checking for Excel
        objArray = Sys.FindAllChildren("ProcessName","EXCEL", 1,True)
        For i=0 to ubound(objArray)
          log.Message objArray(i).FullName
          set oSTP_ExcelObj = objArray(i).FindChild("WndCaption", "*" & strLevel2 & "*",1,True)
          If oSTP_ExcelObj.Exists = True Then
            strFileName=oSTP_ExcelObj.WndCaption 
            log.Message "Found Excel in level V-" & strFileName
            blnFlag=True
            Exit For
          Else
            log.Message "Excel file not found" 
          End If
        Next
      End If
      ''VI
      If blnFlag=False then
        Delay 1000*60*1,"Opening Report...Pls Wait.."
        ''Checking for Excel
        objArray = Sys.FindAllChildren("ProcessName","EXCEL", 1,True)
        For i=0 to ubound(objArray)
          log.Message objArray(i).FullName
          set oSTP_ExcelObj = objArray(i).FindChild("WndCaption", "*" & strLevel2 & "*",1,True)
          If oSTP_ExcelObj.Exists = True Then
            strFileName=oSTP_ExcelObj.WndCaption 
            log.Message "Found Excel in level VI-" & strFileName
            blnFlag=True
            Exit For
          Else
            log.Message "Excel file not found" 
          End If
        Next
      End If  

    
    End If
    If blnFlag=True then
				 'Sys.Process("EXCEL", 2).Close
      strTCRemarks="Report found for " & strlevel2
      Call CloseWindow
      oSTP_ExcelObj.Close
    End If
    Call CloseWindow
End Sub

Sub sSeriesOpenSTP(strParameters)

On Error Resume Next

    Dim strTemp,objTemp,objArray,strFileName,oSTP_ExcelObj,FilePath,objSTPXls,STPSheetName,netUIHWND,STP,strSTPCellValue
    Dim strStatus,strActualDate,intTP,intI,intRowcnt,strSrcId,strId,intRow,File

    strSearch1=getSplitValue(strParameters,"SEARCH1")
    STPSheetName=getSplitValue(strParameters,"STPSheetName")
    STP=getSplitValue(strParameters,"STP")
    intTP=getSplitValue(strParameters,"TP")

    
'    strTPDate="9/1/2015"
'    strSearch1="352897057"
'    STPSheetName="M_1"
'    STP="YYY-test-Test QA"
'    intTP="55"

   Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("Grid", "", 1).WPFObject("GridControl").WPFObject("GridView").WPFObject("ContentPresenter", "", 1).WPFObject("FilterCellContentPresenter", "", 1).WPFObject("TextEdit", "", 1)
    If objTemp.Exists = True then
      objTemp.Click
      objTemp.Keys strSearch1
      strTemp="WPFObject(""GridControl"")"
      Set objTemp=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,True)
      If objTemp.Exists = True then
        strTemp=objTemp.FilterString.OleValue
        while aqstring.Find(ucase(strTemp),strSearch1)=-1
          Delay 100,"Pls Wait.."
        Wend
      End If
      Delay 3000,"Pls Wait.."
'      Call sEdgeProcessor
    End If

'    Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("Grid", "", 1).WPFObject("GridControl").WPFObject("GridView").WPFObject("HierarchyPanel", "", 1).WPFObject("GridRow", "", 1).WPFObject("ScrollablePart").WPFObject("CellItemsControl", "", 1).WPFObject("GridCellContentPresenter", "", 1).WPFObject("TextEdit", "", 1)
                  
    strTemp="WPFObject(""GridControl"")"
    Set objTemp=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""GridView"")"
    Set GridControl=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,True)
    If objTemp.Exists = True then
      intRowcnt=objTemp.wRowCount
      For intI=0 to intRowcnt-1
          strTemp="WPFObject(""HierarchyPanel"", """", 1)"
          Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("Grid", "", 1).WPFObject("GridControl").WPFObject("GridView").WPFObject("HierarchyPanel", "", 1)
          strId=objTemp.Children.Item(intI).DataContext.Row.get_SeriesId
          If strSearch1=strId then
            strSrcId=objTemp.Children.Item(intI).DataContext.Row.get_SourceSeriesTypeId
            If strSrcId=1 then 
              strTemp="WPFObject(""GridControl"")"
              Set objTemp=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,True)
                If objTemp.Exists = True then
'                  objTemp.ClickRowIndicator(intI)
                  Call GridControl.ClearSelectionCore
                  Call GridControl.FocusViewAndRow(GridControl,intI)
                  GridControl.SetFocusOnCurrentItem
                  Call GridControl.SelectRowCore(intI)                  
                  Exit For
                End If
            End If
          End If
      Next
    End If

    
    
    If objTemp.Exists = True then
'      objTemp.Click
      ''Open STP
     ' Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 2).WPFObject("BarButtonItemLinkControl", "", 1).WPFObject("ContentControlEx", "Open STP", 2).Click
      Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 2).WPFObject("BarButtonItemLinkControl", "", 1).WPFObject("ContentControlEx", "Open Global STP", 2).Click
      Delay 10000,"Opening STP.."
      Call sExcelFullHistory1
      Delay 10000,"Opening STP.."
      ''Getting STP Object
      objArray = Sys.FindAllChildren("ProcessName","EXCEL", 1,True)
      For i=0 to ubound(objArray)
        log.Message objArray(i).FullName
        set oSTP_ExcelObj = objArray(i).FindChild("WndCaption", "*" & STP & "*",1,True)
        If oSTP_ExcelObj.Exists = True Then
          strFileName=oSTP_ExcelObj.WndCaption
          If instr(strFileName,"Microsoft Excel")>0 then
            strFileName=GetFileName(strFileName,"Microsoft Excel")
          Else
            strFileName=GetFileNameExcel13(strFileName," - Excel")
          End If
      '    strFileName=iif(instr(strFileName,"Microsoft Excel")>0,GetFileName(strFileName,"Microsoft Excel"),GetFileNameExcel13(strFileName,"- Excel.xlsx"))
          FilePath = aqEnvironment.GetEnvironmentVariable("USERPROFILE") & "\Documents\Edge\EdgeAddinStorage\" & aqConvert.DateTimeToFormatStr(aqDateTime.Today,"%Y-%m-%d")
          FilePath=FilePath & "\" & iif(instr(strFileName,"xlsx") > 0,strFileName,strFileName & ".xlsx")  
          log.Message FilePath
          Exit For
        Else
          log.Message "STP file not found in " & objArray(i).FullName
        End If
      Next

    On Error Resume Next
    Set objSTPXls=GetObject(FilePath)
    With objSTPXls
      With .Sheets(STPSheetName).Select
      End With
    End With 
      With objSTPXls
        With .WorkSheets(STPSheetName)    
    '          .Sheets("M_1").Select    
    '          strSTPCellValue=.cells(2,2)
      Call Aliases.EXCEL.wndXLMAIN.EXCEL2.toolbarRibbon.Ribbon.NUIPane.NetUIHWND.Click(231, 71)
      Delay 5000,"Pls Wait.."
      Sys.Process("EXCEL", 2).WinFormsObject("AddDateForm").WinFormsObject("tableLayoutPanel1").WinFormsObject("panel10").WinFormsObject("tableLayoutPanel3").WinFormsObject("futureEditor").WinFormsObject("futureEditor").set_WindowText(100)
      Sys.Process("EXCEL", 2).WinFormsObject("AddDateForm").WinFormsObject("tableLayoutPanel1").WinFormsObject("tableLayoutPanel2").WinFormsObject("okButton").Click
      Delay 10000,"Pls Wait.."
              For intI=1 to 500
                strSTPCellValue=iif(.Cells(intI,1)="" or isNull(.Cells(intI,1)),"N/A",.Cells(intI,1))
                If VarType(strSTPCellValue) <>8 then
                   If strSTPCellValue <> "N/A" then
                    If CInt(strSTPCellValue)=CInt(strSearch1) then
                       intRow=intI
                       Exit For
                    End If
                   End If 
                End If
              Next
              
              For intI= 25 to 500
                strSTPCellValue=.Cells(2,intI)
                strTPDate=FormatDateTime(strTPDate,2)
                strSTPCellValue=FormatDateTime(strSTPCellValue,2)
                If strSTPCellValue=strTPDate then
                  If .Cells(intRow,intI)=" " then
                    .Cells(intRow,intI)=intTP
                  Else
                    intTp=.Cells(intRow,intI)
                    .Cells(intRow,intI)=intTP+1
                  End If
                  Exit For
                End If
              Next         
        End With
      End With
  
    ''Mark Good
    Set netUIHWND=Sys.Process("EXCEL", 2).Window("XLMAIN", strSTPWndCaption , 1).Window("EXCEL2", "", 2).FindChild("Name","Window(""NetUIHWND"", """", 1)",5,True)
    Delay 1000,"Mark Good..."
    With objSTPXls
      With .WorkSheets(STPSheetName)
           .Cells.Select
      End With
    End With
    Call netUIHWND.Click(32, 92)
  
    ''Upload Series
    Call netUIHWND.Click(131, 71)
    Delay 15000 , "Uploading.."
    ''Waiting for Msgbox
    strTemp="WPFObject(""PART_ContainerContent"")"
    Set File = Sys.Process("EXCEL", 2)._
          Waitchild("WPFObject(""HwndSource: CustomMessageBoxWindow"", ""Information"")",600000)._
          Waitchild("WPFObject(""CustomMessageBoxWindow"", ""Information"", 1)",600000)._
          Waitchild("WPFObject(""Grid"", """", 1)",600000)._
          Waitchild("WPFObject(""FloatingContainerBorder"")",600000)._
          Waitchild("WPFObject(""FloatingContainerBackground"")",600000)._
          Waitchild("WPFObject(""Grid"", """", 1)",600000)._
          Waitchild("WPFObject(""FloatingContainerBody"")",600000)._
          Waitchild("WPFObject(""Grid"", """", 1)",600000)._
          Waitchild("WPFObject(""Grid"", """", 1)",600000)._
          Waitchild("WPFObject(""PART_ContainerContent"")",600000)
       
    If File.Exists =True Then
      'File.Window("Button", "OK", 1).Click
     Sys.Keys("[Enter]")
    End If
    ''Question Msgbox
    Set File = Sys.Process("EXCEL", 2)._
          Waitchild("WPFObject(""HwndSource: CustomMessageBoxWindow"", ""Question"")",60000)._
          Waitchild("WPFObject(""CustomMessageBoxWindow"", ""Question"", 1)",60000)._
          Waitchild("WPFObject(""Grid"", """", 1)",60000)._
          Waitchild("WPFObject(""FloatingContainerBorder"")",60000)._
          Waitchild("WPFObject(""FloatingContainerBackground"")",60000)._
          Waitchild("WPFObject(""Grid"", """", 1)",60000)._
          Waitchild("WPFObject(""FloatingContainerBody"")",60000)._
          Waitchild("WPFObject(""Grid"", """", 1)",60000)._
          Waitchild("WPFObject(""Grid"", """", 1)",60000)._
          Waitchild("WPFObject(""PART_ContainerContent"")",60000)
    If File.Exists Then
      Sys.Keys "N"
    End If
    objSTPXls.Close
    Call CloseSearch
'    Delay 5000,"Pls Wait.."
'    sys.Keys "Y"
'    Delay 2000,"Pls Wait.."
    
    ''Refreshing RS
    Delay 5000,"Refresh.."
    Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 1).WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarButtonItemLinkControl", "", 1).WPFObject("ContentControlEx", "Refresh", 2).Click
    Delay 2000,"Released.."
    Call sEdgeProcessor
          
    End If

    ''Closing Series search
     Dim objEdge,i,j,objCaption,objText,strOk
   Set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager")     
   If objEdge.Exists = True then  
    objText = objEdge.FindAllChildren("ClrClassName","LayoutGroup", 10,True)
        For i=0 to ubound(objText)
          log.Message objText(i).FullName
          log.Message objText(i).Name
          objCaption = objText(i).FindAllChildren("ClrClassName", "LayoutPanel",10,True)
          For j=0 to ubound(objCaption)
           log.Message objCaption(j).FullName
            log.Message objCaption(j).Name
            if objCaption(j).Content.Caption = "Source Series" then 
                  log.Message objCaption(j).FullName
                  'Call objCaption(j).ClickR(objCaption(j).top/2,objCaption(j).left/30,0)
                    Call objCaption(j).ClickR(275, 8)
                    Delay 5000,"Pls Wait.."
                    sys.Keys "[Down][Down][Down][Enter]"
                    Delay 5000,"Pls Wait.."
'                    Set strOk=Sys.Process("EdgeClient").WPFObject("HwndSource: WindowContentHolder", "", 1).WPFObject("WindowContentHolder", "", 1).WPFObject("NonLogicalDecorator", "", 1).WPFObject("ThemedManagedContentPresenter", "", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("DXMessageBox", "", 1)
                    Set strOk=Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "Edge").WPFObject("CustomMessageBoxWindow", "Edge", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent")
                    Delay 5000, "Closing Form..Pls wait.."
                    If strOk.Exists Then
                      SYS.Keys "[Enter]"
                    End If
                  Exit For 
              End If 
          Next
        Next   
  End If
    Call CloseWindow
End Sub



''Procedure to open STP and select Full History 
Sub sExcelFullHistory1()
  Dim strTemp,CreateSTP,PropArray,ValuesArray,objTemp,ReplaceFile
  On Error Resume Next

  strTemp = "WinFormsObject(""TimeRangePickerForm"")"
  Set CreateSTP=Sys.Process("EXCEL",2).WaitChild(strTemp,120000)
  If CreateSTP.Exists = True Then
    PropArray = Array("WndCaption", "Visible")
    ValuesArray = Array("Full History", True)
    Set objTemp = CreateSTP.FindChild(PropArray, ValuesArray, 10)
    If objTemp.Exists = True Then
      objTemp.Click
      log.Message "Selected Full History Radio button"
    Else
      log.Message "Full History Radio button not found"
    End If
    PropArray = Array("WndCaption", "Visible")
    ValuesArray = Array("Open", True)
    Set objTemp = CreateSTP.FindChild(PropArray, ValuesArray, 10)
    If objTemp.Exists = True Then
      objTemp.Click
    End If
    Set CreateSTP=Sys.Process("EXCEL",2).WaitChild(strTemp,120000)
'    strTemp="WPFObject(""PART_ContainerContent"")"
'    Set ReplaceFile=Sys.Process("EXCEL",2).WaitChild(strTemp,120000)

          Set ReplaceFile = Sys.Process("EXCEL", 2)._
          Waitchild("WPFObject(""HwndSource: CustomMessageBoxWindow"", ""Warning"")",18000)._
          Waitchild("WPFObject(""CustomMessageBoxWindow"", ""Warning"", 1)",18000)._
          Waitchild("WPFObject(""Grid"", """", 1)",18000)._
          Waitchild("WPFObject(""FloatingContainerBorder"")",18000)._
          Waitchild("WPFObject(""FloatingContainerBackground"")",18000)._
          Waitchild("WPFObject(""Grid"", """", 1)",18000)._
          Waitchild("WPFObject(""FloatingContainerBody"")",18000)._
          Waitchild("WPFObject(""Grid"", """", 1)",18000)._
          Waitchild("WPFObject(""Grid"", """", 1)",18000)._
          Waitchild("WPFObject(""PART_ContainerContent"")",18000)
    If ReplaceFile.Exists Then
      Sys.Keys "Y"
    End If
    blnSTPfile=False
    'strTCRemarks = "STP file opened"
  Else
    log.Message "STP File not found"
    strTCRemarks="STP File not found"
    blnCriticalErrorFound = True
    strCriticalError = "Unable to find STP file"
    strTestCaseResult = "FAIL"
    blnSTPfile=True
    Call ExcelProcessKill
    Exit Sub
  End If

  Set CreateSTP=Nothing  
  Set objTemp=Nothing
End Sub

Sub sExcelFullHistory2()
  Dim strTemp,CreateSTP,PropArray,ValuesArray,objTemp,ReplaceFile
  On Error Resume Next

  strTemp = "WinFormsObject(""TimeRangePickerForm"")"
  Set CreateSTP=Sys.Process("EXCEL",2).WaitChild(strTemp,120000)
  If CreateSTP.Exists = True Then
    PropArray = Array("WndCaption", "Visible")
    ValuesArray = Array("Full History", True)
    Set objTemp = CreateSTP.FindChild(PropArray, ValuesArray, 10)
    If objTemp.Exists = True Then
      objTemp.Click
      log.Message "Selected Full History Radio button"
    Else
      log.Message "Full History Radio button not found"
    End If
    PropArray = Array("WndCaption", "Visible")
    ValuesArray = Array("Open", True)
    Set objTemp = CreateSTP.FindChild(PropArray, ValuesArray, 10)
    If objTemp.Exists = True Then
      objTemp.Click
    End If
    Set CreateSTP=Sys.Process("EXCEL",2).WaitChild(strTemp,120000)
    'strTemp="WPFObject(""PART_ContainerContent"")"
    Set ReplaceFile = Sys.Process("EXCEL", 2)._
          Waitchild("WPFObject(""HwndSource: CustomMessageBoxWindow"", ""Warning"")",18000)._
          Waitchild("WPFObject(""CustomMessageBoxWindow"", ""Warning"", 1)",18000)._
          Waitchild("WPFObject(""Grid"", """", 1)",18000)._
          Waitchild("WPFObject(""FloatingContainerBorder"")",18000)._
          Waitchild("WPFObject(""FloatingContainerBackground"")",18000)._
          Waitchild("WPFObject(""Grid"", """", 1)",18000)._
          Waitchild("WPFObject(""FloatingContainerBody"")",18000)._
          Waitchild("WPFObject(""Grid"", """", 1)",18000)._
          Waitchild("WPFObject(""Grid"", """", 1)",18000)._
          Waitchild("WPFObject(""PART_ContainerContent"")",18000)
    If ReplaceFile.Exists=True Then
      'ReplaceFile.Click
      Sys.Keys("Y")
    End If
    blnSTPfile=False
    'strTCRemarks = "STP file opened"
  Else
    log.Message "STP File not found"
    strTCRemarks="STP File not found"
    blnCriticalErrorFound = True
    strCriticalError = "Unable to find STP file"
    strTestCaseResult = "FAIL"
    blnSTPfile=True
    Call ExcelProcessKill
    Exit Sub
  End If

  Set CreateSTP=Nothing  
  Set objTemp=Nothing
End Sub

Sub sEdgeProcessor()

On Error Resume Next

  Dim objEdgeWait,strTemp,objTemp
  
  'set objEdgeWait=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager")
  strTemp="WPFObject(""LoadingWaitControl"", """", 1)"
  Set objTemp=Sys.Process("EdgeClient").FindChild("Name",strTemp,50)
  Do until objTemp.Exists = False 
    If objTemp.Focusable=False then
      Delay 1000,"Pls Wait... Form is loading..."
     'msgbox "I m waiting"     
    End if 
  Loop   
  
End Sub

Sub sProgressBar()
  Dim objProgress, strTemp
  strTemp ="WinFormsObject(""WaitProgressForm"")"
  objProgress= Sys.Process("EXCEL", 2).FindChild("Name",strTemp,50)
  Do until objProgress.Exists = False 
     If objProgress.Focusable=False then
      Delay 1000,"Pls Wait... Form is loading..."
    End if 
  Loop 
End Sub


Sub sCheckLayoutButton()
On Error Resume Next

  Dim objEdge,strTemp,objTemp
  
  set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1)
  strTemp="WPFObject(""ContentControlEx"", ""New Workspace"", 2)"
  Set objTemp=objEdge.FindChild("Name",strTemp,50)
  If objTemp.Exists=True then
    strTCRemarks = "New Workspace Button is found in Layout"
    log.Message "New Workspace Button is found in Layout"
  else
    strTCRemarks =  "New Workspace Button is Not found in Layout"
  End if 
  strTemp="WPFObject(""ContentControlEx"", ""File Repository"", 2)"
  Set objTemp=objEdge.FindChild("Name",strTemp,50)
  If objTemp.Exists=True then
    strTCRemarks = strTCRemarks & "<br />" & "File Repository Button found in Layout"
    log.Message "File Repository Button found in Layout"
  else
    strTCRemarks = strTCRemarks & "<br />" & "File Repository Button Not found in Layout"
  End if
  strTemp="WPFObject(""ContentControlEx"", ""Refresh"", 2)"
  Set objTemp=objEdge.FindChild("Name",strTemp,50)
  If objTemp.Exists=True then
    strTCRemarks = strTCRemarks & "<br />" & "Refresh Button found in Layout"
    log.Message "Refresh Button found in Layout"
  else
    strTCRemarks = strTCRemarks & "<br />" & "Refresh Button Not found in Layout"
  End if
  strTemp="WPFObject(""ContentControlEx"", ""New Layout Topic"", 2)"
  Set objTemp=objEdge.FindChild("Name",strTemp,50)
  If objTemp.Exists=True then
    strTCRemarks = strTCRemarks & "<br />" & "New Layout Topic Button found in Layout"
    log.Message "New Layout Topic Button found in Layout"
  else
    strTCRemarks = strTCRemarks & "<br />" & "New Layout Topic Button Not found in Layout"
  End if  
  strTemp="WPFObject(""ContentControlEx"", ""Expand All"", 2)"
  Set objTemp=objEdge.FindChild("Name",strTemp,50)
  If objTemp.Exists=True then
    strTCRemarks = strTCRemarks & "<br />" & "Expand All Button found in Layout"
    log.Message "Expand All Button found in Layout"
  else
    strTCRemarks = strTCRemarks & "<br />" & "Expand All Button Not found in Layout"
  End if 
  strTemp="WPFObject(""ContentControlEx"", ""Collapse All"", 2)"
  Set objTemp=objEdge.FindChild("Name",strTemp,50)
  If objTemp.Exists=True then
    strTCRemarks = strTCRemarks & "<br />" & "Collapse All Button found in Layout"
    log.Message "Collapse All Button found in Layout"
  else
    strTCRemarks = strTCRemarks & "<br />" & "Collapse All Button Not found in Layout"
  End if
End Sub

Sub sCheckLayoutFields()
On Error Resume Next

  Dim objEdge,strTemp,objTemp,objEdgeTree,strLayoutHeader,GridControl,GridSourceTree,intTotNodeCnt,intI
              
  set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1)
  strTemp="WPFObject(""LayoutTreeListView"")"
  Set objTemp=objEdge.FindChild("Name",strTemp,50)
  If objTemp.Exists=True then
    strTCRemarks = "Layout Grid found in Layout"
    log.Message "Layout grid found in Layout"
    set objEdgeTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("LayoutTreeControl").WPFObject("LayoutTreeListView")
    
    strTemp="WPFObject(""GridColumnHeader"", """", 1)"
    Set objTemp=objEdgeTree.FindChild("Name",strTemp,50)
    if objTemp.Exists=True then
      if UCASE(objTemp.DataContext.Header)="DESCRIPTION" then
        strTCRemarks = strTCRemarks & "<br />" & "Description is found in Layout"
        log.Message "Description is found in Layout"
      Else
        strTCRemarks = strTCRemarks & "<br />" & "Description is not found in Layout"
        log.Message "Description is not found in Layout"
      End if
    Else 
      strTCRemarks = strTCRemarks & "<br />" & "Fields is not found in Layout"
    End if
       
    strTemp="WPFObject(""GridColumnHeader"", """", 2)"
    Set objTemp=objEdgeTree.FindChild("Name",strTemp,50)
    if objTemp.Exists=True then
      if UCASE(objTemp.DataContext.Header)="DESCRIPTION LOCAL" then
        strTCRemarks = strTCRemarks & "<br />" & "Description Local is found in Layout"
        log.Message "Description Local is found in Layout"
      Else
        strTCRemarks = strTCRemarks & "<br />" & "Description is not found in Layout"
        log.Message "Description Local is not found in Layout"
      End if 
    else
      strTCRemarks = strTCRemarks & "<br />" & "Fields is not found in Layout"
    End if
    
    strTemp="WPFObject(""GridColumnHeader"", """", 3)"
    Set objTemp=objEdgeTree.FindChild("Name",strTemp,50)
    if objTemp.Exists=True then
      if UCASE(objTemp.DataContext.Header)="DISPLAY ORDER" then
        strTCRemarks = strTCRemarks & "<br />" & "Display Order is found in Layout"
        log.Message "Display Order is found in Layout"
      Else
        strTCRemarks = strTCRemarks & "<br />" & "Display Order is not found in Layout"
        log.Message "Display Order is not found in Layout"
      End if 
    else
      strTCRemarks = strTCRemarks & "<br />" & "Fields is not found in Layout"
    End if
    
    strTemp="WPFObject(""GridColumnHeader"", """", 4)"
    Set objTemp=objEdgeTree.FindChild("Name",strTemp,50)
    if objTemp.Exists=True then
      if UCASE(objTemp.DataContext.Header)="SYSTEM ID" then
        strTCRemarks = strTCRemarks & "<br />" & "System ID is found in Layout"
        log.Message "System ID is found in Layout"
      Else
        strTCRemarks = strTCRemarks & "<br />" & "System ID is not found in Layout"
        log.Message "System ID is not found in Layout"
      End if 
    else
      strTCRemarks = strTCRemarks & "<br />" & "Fields is not found in Layout"
    End if
        
    strTemp="WPFObject(""GridColumnHeader"", """", 6)"
    Set objTemp=objEdgeTree.FindChild("Name",strTemp,50)
    if objTemp.Exists=True then
      if UCASE(objTemp.DataContext.Header)="EDIT" then
        strTCRemarks = strTCRemarks & "<br />" & "EDIT is found in Layout"
        log.Message "EDIT is found in Layout"
      Else
        strTCRemarks = strTCRemarks & "<br />" & "EDIT is not found in Layout"
        log.Message "EDIT is not found in Layout"
      End if 
    else
      strTCRemarks = strTCRemarks & "<br />" & "Fields is not found in Layout"
    End if
    
    strTemp="WPFObject(""GridColumnHeader"", """", 7)"
    Set objTemp=objEdgeTree.FindChild("Name",strTemp,50)
    if objTemp.Exists=True then
      if UCASE(objTemp.DataContext.Header)="DISABLED FLAG" then
        strTCRemarks = strTCRemarks & "<br />" & "Disabled Flag is found in Layout"
        log.Message "Disabled Flag found in Layout"
      Else
        strTCRemarks = strTCRemarks & "<br />" & "Disabled Flag is not found in Layout"
        log.Message "Disabled Flag is not found in Layout"
      End if 
    else
      strTCRemarks = strTCRemarks & "<br />" & "Fields is not found in Layout"
    End if
    
    strTemp="WPFObject(""GridColumnHeader"", """", 8)"
    Set objTemp=objEdgeTree.FindChild("Name",strTemp,50)
    if objTemp.Exists=True then
      if UCASE(objTemp.DataContext.Header)="OUTPUT FLAG" then
        strTCRemarks = strTCRemarks & "<br />" & "Output Flag is found in Layout"
        log.Message "Output Flag is found in Layout"
      Else
        strTCRemarks = strTCRemarks & "<br />" & "Output Flag is not found in Layout"
        log.Message "Output Flag is not found in Layout"
      End if 
    else
      strTCRemarks = strTCRemarks & "<br />" & "Fields is not found in Layout"
    End if
    
    strTemp="WPFObject(""GridColumnHeader"", """", 9)"
    Set objTemp=objEdgeTree.FindChild("Name",strTemp,50)
    if objTemp.Exists=True then
      if UCASE(objTemp.DataContext.Header)="DX FILE NAME" then
        strTCRemarks = strTCRemarks & "<br />" & "DX File Name is found in Layout"
        log.Message "DX File Name is found in Layout"
      Else
        strTCRemarks = strTCRemarks & "<br />" & "DX File Name is not found in Layout"
        log.Message "DX File Name is  not found in Layout"
      End if 
    else
      strTCRemarks = strTCRemarks & "<br />" & "Fields is not found in Layout"
    End if
    
    strTemp="WPFObject(""GridColumnHeader"", """", 10)"
    Set objTemp=objEdgeTree.FindChild("Name",strTemp,50)
    if objTemp.Exists=True then
      if UCASE(objTemp.DataContext.Header)="VER" then
        strTCRemarks = strTCRemarks & "<br />" & "Ver is found in Layout"
        log.Message "Ver is found in Layout"
      Else
        strTCRemarks = strTCRemarks & "<br />" & "Ver is not found in Layout"
        log.Message "Ver is not found in Layout"
      End if 
    else
      strTCRemarks = strTCRemarks & "<br />" & "Fields is not found in Layout"
    End if
    
    
    strTemp="WPFObject(""GridColumnHeader"", """", 11)"
    Set objTemp=objEdgeTree.FindChild("Name",strTemp,50)
    if objTemp.Exists=True then
      if UCASE(objTemp.DataContext.Header)="LAST UPDATED TIME" then
        strTCRemarks = strTCRemarks & "<br />" & "Last Updated Time is found in Layout"
        log.Message "Last Updated Time is found in Layout"
      Else
        strTCRemarks = strTCRemarks & "<br />" & "Last Updated Time is not found in Layout"
        log.Message "Last Updated Time is not found in Layout"
      End if 
    else
      strTCRemarks = strTCRemarks & "<br />" & "Fields is not found in Layout"
    End if
    
    
     strTemp="WPFObject(""GridColumnHeader"", """", 12)"
    Set objTemp=objEdgeTree.FindChild("Name",strTemp,50)
    if objTemp.Exists=True then
      if UCASE(objTemp.DataContext.Header)="LAST UPDATED USER ID" then
        strTCRemarks = strTCRemarks & "<br />" & "Last Updated User ID is found in Layout"
        log.Message "Last Updated User ID is found in Layout"
      Else
        strTCRemarks = strTCRemarks & "<br />" & "Last Updated User ID is not found in Layout"
        log.Message "Last Updated User ID is not found in Layout"
      End if 
    else
      strTCRemarks = strTCRemarks & "<br />" & "Fields is not found in Layout"
    End if
    
     strTemp="WPFObject(""GridColumnHeader"", """", 13)"
    Set objTemp=objEdgeTree.FindChild("Name",strTemp,50)
    if objTemp.Exists=True then
      if UCASE(objTemp.DataContext.Header)="TREE LEVEL" then
        strTCRemarks = strTCRemarks & "<br />" & "Tree Level is found in Layout"
        log.Message "Tree Level is found in Layout"
      Else
        strTCRemarks = strTCRemarks & "<br />" & "Tree Level is not found in Layout"
        log.Message "Tree Level is not found in Layout"
      End if 
    else
      strTCRemarks = strTCRemarks & "<br />" & "Fields is not found in Layout"
    End if    
  else
    strTCRemarks =  "Layout Grid Not found in Layout"
  End if 

End sub

Sub sCheckLayoutWorkspaceButton(strParameters)
On Error Resume Next
  Call sloadLayout
  Call sCheckLayoutExpandTree(strParameters)
  set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1)
  strTemp="WPFObject(""ContentControlEx"", ""New Workspace"", 2)"
  Set objTemp=objEdge.FindChild("Name",strTemp,50)
  If objTemp.Exists=True then
    if objTemp.Enabled= true then
      strTCRemarks = "New Workspace Button is found in Layout"
      log.Message "New Workspace Button is found in Layout"
      objTemp.Click
      set objEdgeFilter= Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarButtonItemLinkControl", "", 1)
      strTemp="WPFObject(""ContentControlEx"", ""Open For View"", 2)"
      Set objTemp=objEdgeFilter.FindChild("Name",strTemp,50)
      If objTemp.Exists = TRUE then
        strTCRemarks = strTCRemarks & "<br />" & "Open for View Button is found in Layout"
        log.Message "Open for View Button is found in Layout"
      Else
        strTCRemarks = strTCRemarks & "<br />" & "Open for View Button is not found in Layout"
        log.Message "Open for View Button is not found in Layout"
      End If
    
      set objEdgeFilter= Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 2).WPFObject("BarButtonItemLinkControl", "", 1)
      strTemp="WPFObject(""ContentControlEx"", ""Open For Edit"", 2)"
      Set objTemp=objEdgeFilter.FindChild("Name",strTemp,50)
      If objTemp.Exists = TRUE then
        strTCRemarks = strTCRemarks & "<br />" & "Open for Edit Button is found in Layout"
        log.Message "Open for Edit Button is found in Layout"
      Else
        strTCRemarks = strTCRemarks & "<br />" & "Open for Edit Button is not found in Layout"
        log.Message "Open for Edit Button is not found in Layout"
      End If
    Else
      strTCRemarks = strTCRemarks & "<br />" & "workspace button is disabled in Layout"
      log.Message "Workspace button is disabled in Layout"
    End if 
  else
    strTCRemarks =  "New Workspace Button is Not found in Layout"
  End if 
End Sub 


Sub sCheckLayoutFileRepositoryButton(strParameters)
On Error Resume Next

  Dim objEdge,strTemp,objTemp,objEdgeFilter
  
  Call sloadlayout
  Call sCheckLayoutExpandTree(strParameters)
  set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1)
  strTemp="WPFObject(""ContentControlEx"", ""File Repository"", 2)"
  Set objTemp=objEdge.FindChild("Name",strTemp,50)
  If objTemp.Exists=True then
    strTCRemarks = "File Repository Button is found in Layout"
    log.Message "File Repository Button is found in Layout"
    objTemp.Click
    'set objEdgeFilter= Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarButtonItemLinkControl", "", 1)
    set objEdgeFilter= Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1)
    strTemp="WPFObject(""ContentControlEx"", ""File Repository Usage"", 2)"
    Set objTemp=objEdgeFilter.FindChild("Name",strTemp,50)
    If objTemp.Exists = TRUE then
      strTCRemarks = strTCRemarks & "<br />" & "File Repository Usage Button is found in Layout"
      log.Message "File Repository Usage Button is found in Layout"
      If objTemp.Enabled = TRUE then
        strTCRemarks = strTCRemarks & "<br />" & "File Repository Usage Button is Enabled"
        log.Message "File Repository Usage Button is found in Layout"
      Else
        strTCRemarks = strTCRemarks & "<br />" & "File Repository Usage Button is Disabled"
        log.Message "File Repository Usage Button is found in Layout"
      End if 
    Else
      strTCRemarks = strTCRemarks & "<br />" & "File Repository Usage Button is not found in Layout"
      log.Message "File Repository Usage Button is not found in Layout"
    End If
    
    set objEdgeFilter= Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarButtonItemLinkControl", "", 1)
    strTemp="WPFObject(""ContentControlEx"", ""Add New Link"", 2)"
    Set objTemp=objEdgeFilter.FindChild("Name",strTemp,50)
    If objTemp.Exists = TRUE then
      strTCRemarks = strTCRemarks & "<br />" & "Add New Link Button is found in Layout"
      log.Message "Add New Link Button is found in Layout"
      If objTemp.Enabled = TRUE then
        strTCRemarks = strTCRemarks & "<br />" & "Add New Link Button is Enabled"
        log.Message "Add New Link Button  is found in Layout"
      Else
        strTCRemarks = strTCRemarks & "<br />" & "Add New Link Button is Disabled"
        log.Message "Add New Link Button is found in Layout"
      End if 
    Else
      strTCRemarks = strTCRemarks & "<br />" & "Add New Link Button is not found in Layout"
      log.Message "Add New Link Button is not found in Layout"
    End If
    set objEdgeFilter= Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarButtonItemLinkControl", "", 1)
    strTemp="WPFObject(""ContentControlEx"", ""Refresh Attachment Status"", 2)"
    Set objTemp=objEdgeFilter.FindChild("Name",strTemp,50)
    If objTemp.Exists = TRUE then
      strTCRemarks = strTCRemarks & "<br />" & "Refresh Attachment Status Button is found in Layout"
      log.Message "Refresh Attachment Status Button is found in Layout"
      If objTemp.Enabled = TRUE then
        strTCRemarks = strTCRemarks & "<br />" & "Refresh Attachment Status is Enabled"
        log.Message "Refresh Attachment Status is found in Layout"
      Else
        strTCRemarks = strTCRemarks & "<br />" & "Refresh Attachment Status is Disabled"
        log.Message "Refresh Attachment Status is found in Layout"
      End if 
    Else
      strTCRemarks = strTCRemarks & "<br />" & "Refresh Attachment Status Button is not found in Layout"
      log.Message "Refresh Attachment Status Button is not found in Layout"
    End If
    
    set objEdgeFilter= Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarButtonItemLinkControl", "", 1)
    strTemp="WPFObject(""ContentControlEx"", ""Show / Hide Attachment Status"", 2)"
    Set objTemp=objEdgeFilter.FindChild("Name",strTemp,50)
    If objTemp.Exists = TRUE then
      strTCRemarks = strTCRemarks & "<br />" & "Show / Hide Attachment Status Button is found in Layout"
      log.Message "Show / Hide Attachment Status Button is found in Layout"
      If objTemp.Enabled = TRUE then
        strTCRemarks = strTCRemarks & "<br />" & "Show / Hide Attachment Status is Enabled"
        log.Message "Show / Hide Attachment Status Button is found in Layout"
      Else
        strTCRemarks = strTCRemarks & "<br />" & "Show / Hide Attachment Status Button is Disabled"
        log.Message "Show / Hide Attachment Status Button is found in Layout"
      End if 
    Else
      strTCRemarks = strTCRemarks & "<br />" & "Show / Hide Attachment Status Button is not found in Layout"
      log.Message "Show / Hide Attachment Status Button is not found in Layout"
    End If
  else
    strTCRemarks =  "File Repository Button is Not found in Layout"
  End if 
  call scloselayout()
End Sub
Sub sCheckLayoutDatabase()
On Error Resume Next 
    Dim strLevel1layout,strLevel2layout,strLevel3layout,strWrkSpaceName
    Dim objNewWrkSpace_okbtn,objNewWrkSpace_Name
    Dim objNewWrkSpace_Txtbox,objopenforEdit,objWrkspace_popup
    Dim strTemp,objTemp,intRow,barManager,intTotNodeCnt,Text,objCellText,intl,intK,strDesc1,strDesc2
    Dim objWrkSpace,objwrkspacepop,objwrkspcUpload,objConfirm,objGridCell,DescLocalText,intSeriesID

    'strLevel1layout=getSplitValue(strParameters,"LEVEL1LAYOUT")
    'strLevel1layout="dX Non-Asia Database (Current Eng Version)"

    ''Setting grid Objects

    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("LayoutTreeControl").WPFObject("LayoutTreeListView")
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("LayoutTreeControl")

    Delay 1000,"Please Wait..."
    ''Selecting Level1 layout
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        log.Message GridControl.Nodes_2.Item(intI).Content.Description
        strTCRemarks=strTCRemarks & "<br />" & GridControl.Nodes_2.Item(intI).Content.Description
        blnFlag = False
    Next
    If blnFlag = True then
      strTCRemarks="Database are not found"
    End If
    
End Sub

Sub sCheckLayoutExpandTree(strParameters)

    Dim objEdge,objEdgeFilter
    Dim strLevel1layout,strLevel2layout,strLevel3layout,strWrkSpaceName
    Dim objNewWrkSpace_okbtn,objNewWrkSpace_Name
    Dim objNewWrkSpace_Txtbox,objopenforEdit,objWrkspace_popup
    Dim strTemp,objTemp,intRow,barManager,intTotNodeCnt,Text,objCellText,intI,intK,strDesc1,strDesc2,intJ
    Dim objWrkSpace,objwrkspacepop,objwrkspcUpload,objConfirm,objGridCell,DescLocalText,intSeriesID,GridControl,GridSourceTree

    call sLoadLayout
    strLevel1layout=getSplitValue(strParameters,"LEVEL1LAYOUT")
    strLevel2layout=getSplitValue(strParameters,"LEVEL2LAYOUT")  
    strLevel3layout=getSplitValue(strParameters,"LEVEL3LAYOUT")

'    strLevel1layout="dX Non-Asia Database (Current Eng Version)"
'    strLevel2layout="Z-Testing Topic(IT-use only)"
'    strLevel3layout="Sandbox (Benny)" 

'    strLevel1layout="dX Non-Asia Database (Current Eng Version)"
'    strLevel2layout=""
'    strLevel3layout=""

     Delay 10000,"Please Wait..."
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("LayoutTreeControl").WPFObject("LayoutTreeListView")
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("LayoutTreeControl")
    if strLevel1layout <> "" and strLevel2layout <> "" AND strLevel3layout <> "" then
        Delay 1000,"Please Wait..."
        ''Selecting Level1 layout
        intTotNodeCnt=GridControl.Nodes_2.Count
        For intI=0 to intTotNodeCnt-1         
            If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strLevel1layout) then
              GridControl.Nodes_2.Item(intI).Expand(True)
              log.Message "Level 1 Layout - " & GridControl.Nodes_2.Item(intI).Content.Description       
              blnFlag=False  
              Exit For
            End If
        Next
        Delay 10000,"Please Wait..."
        If blnFlag = True then
          strTCRemarks="Level 1 Layout not found"
          strTestCaseResult="FAIL"
          Exit Sub
        End If
  
        blnFlag = True 
        ''Selecting Level2 Layout
        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
        For intJ=0 to intTotNodeCnt-1
          If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strLevel2layout) then
            GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
            log.Message "Level2 layout Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
            blnFlag = False 
            Exit For
          End If
        Next
        If blnFlag = True then
          strTCRemarks="Level2 Source Name not found"
          strTestCaseResult="FAIL"
          Exit Sub
        End If
        delay(10000)
        blnFlag = True    
        ''Selecting Level3 Layout
          intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count
          For intK=0 to intTotNodeCnt-1
            If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description)=Ucase(strLevel3layout) then
              GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Expand(True)
              intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).get_RowHandle
''                  GridControl.set_FocusedRowHandle(intRow)
''                  'GridControl.Click
''                  'Delay(1000)
''                  GridControl.Keys("[Down]")
''                  GridControl.Keys("[Up]")

              Call GridControl.ClearSelectionCore
              Call GridControl.FocusViewAndRow(GridControl,intRow)
              GridControl.SetFocusOnCurrentItem
              Call GridControl.SelectRowCore(intRow)
              log.Message "Level3 layout Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description
              blnFlag = False
              Exit For   
            End If 
          Next
          If blnFlag = True then
            strTCRemarks="Level3 Source Name not found"
            strTestCaseResult="FAIL"
            Exit Sub
          End If
    Elseif strLevel2layout<> "" AND strLevel3layout = "" then
       Delay 1000,"Please Wait..."
        ''Selecting Level1 layout
        intTotNodeCnt=GridControl.Nodes_2.Count
        For intI=0 to intTotNodeCnt-1         
            If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strLevel1layout) then
              GridControl.Nodes_2.Item(intI).Expand(True)
              log.Message "Level 1 Layout - " & GridControl.Nodes_2.Item(intI).Content.Description       
              blnFlag=False  
              Exit For
            End If
        Next
        Delay 10000,"Please Wait..."
        If blnFlag = True then
          strTCRemarks="Level 1 Layout not found"
          strTestCaseResult="FAIL"
          Exit Sub
        End If
  
        blnFlag = True 
        ''Selecting Level2 Layout
        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
        For intJ=0 to intTotNodeCnt-1
          If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strLevel2layout) then
            GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
            intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
            GridControl.set_FocusedRowHandle(intRow)
            GridControl.Keys("[Down]")
            GridControl.Keys("[Up]")
            log.Message "Level2 layout Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
            blnFlag = False 
            Exit For
          End If
        Next
        If blnFlag = True then
          strTCRemarks="Level2 Source Name not found"
          strTestCaseResult="FAIL"
          Exit Sub
        End If 
    Elseif strLevel2layout="" then
      Delay 10000,"Please Wait..."
        ''Selecting Level1 layout
        intTotNodeCnt=GridControl.Nodes_2.Count
        For intI=0 to intTotNodeCnt-1         
            If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strLevel1layout) then
              GridControl.Nodes_2.Item(intI).Expand(True)
              intRow=GridControl.Nodes_2.Item(intI).get_RowHandle
              GridControl.set_FocusedRowHandle(intRow)
              GridControl.Keys("[Down]")
              GridControl.Keys("[Up]")
              log.Message "Level 1 Layout - " & GridControl.Nodes_2.Item(intI).Content.Description       
              blnFlag=False  
              Exit For
            End If
        Next
        Delay 9000,"Please Wait..."
        If blnFlag = True then
          strTCRemarks="Level 1 Layout not found"
          strTestCaseResult="FAIL"
          Exit Sub
        End If
    End if
End Sub


Sub sCheckLayoutModule(strParameters)

On Error Resume Next 
''    Dim strLevel1layout,strLevel2layout,strLevel3layout,strWrkSpaceName
''    Dim objNewWrkSpace_okbtn,objNewWrkSpace_Name
''    Dim objNewWrkSpace_Txtbox,objopenforEdit,objWrkspace_popup
''    Dim strTemp,objTemp,intRow,barManager,intTotNodeCnt,Text,objCellText,intl,intK,strDesc1,strDesc2
''    Dim objWrkSpace,objwrkspacepop,objwrkspcUpload,objConfirm,objGridCell,DescLocalText,intSeriesID
''    Call sLoadLayout()
''    
''    strLevel1layout=getSplitValue(strParameters,"LEVEL1LAYOUT")
''    strLevel2layout=getSplitValue(strParameters,"LEVEL2LAYOUT")
''    strLevel3layout=getSplitValue(strParameters,"LEVEL3LAYOUT")
''    
''    Delay 3000,"Please Wait..."
''
''    ''Setting grid Objects
''
''    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("LayoutTreeControl").WPFObject("LayoutTreeListView")
''    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("LayoutTreeControl")
''
''    
''    Delay 1000,"Please Wait..."
''    ''Selecting Level1 layout
''    intTotNodeCnt=GridControl.Nodes_2.Count
''    For intI=0 to intTotNodeCnt-1         
''        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strLevel1layout) then
''          GridControl.Nodes_2.Item(intI).Expand(True)
''          log.Message "Level 1 Layout - " & GridControl.Nodes_2.Item(intI).Content.Description       
''          blnFlag=False  
''          Exit For
''        End If
''    Next
''    Delay 3000,"Please Wait..."
''    If blnFlag = True then
''      strTCRemarks="Level 1 Layout not found"
''      strTestCaseResult="FAIL"
''      Exit Sub
''    End If
''  
''    blnFlag = True 
''    ''Selecting Level2 Layout
''    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
''    For intJ=0 to intTotNodeCnt-1
''      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strLevel2layout) then
''        GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
''        log.Message "Level2 layout Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
''        blnFlag = False 
''        Exit For
''      End If
''    Next
''    Delay 3000,"Please Wait..."
''    If blnFlag = True then
''      strTCRemarks="Level2 Source Name not found"
''      strTestCaseResult="FAIL"
''      Exit Sub
''    End If
''
''    blnFlag = True    
''    ''Selecting Level3 Layout
''      intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count
''      For intK=0 to intTotNodeCnt-1
''        If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description)=Ucase(strLevel3layout) then
''          GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Expand(True)
''          intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).get_RowHandle
''          'GridControl.Keys "^[Home]"
''     
''          GridControl.set_FocusedRowHandle(intRow)
''          GridControl.set_FocusedRowData(intRow)
''          delay(1000)
''          GridControl.Keys("[Down]")
''          GridControl.Keys("[Up]")
'''         
''          'GridControl.Click
''          'GridControl.Click
''          log.Message "Level3 layout Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description
''          blnFlag = False
''          Exit For   
''        End If 
''      Next
''      If blnFlag = True then
''        strTCRemarks="Level3 Source Name not found"
''        strTestCaseResult="FAIL"
''        Exit Sub
''      End If
''      
''      
      
       Dim objEdge,objEdgeFilter
    Dim strLevel1layout,strLevel2layout,strLevel3layout,strWrkSpaceName
    Dim objNewWrkSpace_okbtn,objNewWrkSpace_Name
    Dim objNewWrkSpace_Txtbox,objopenforEdit,objWrkspace_popup
    Dim strTemp,objTemp,intRow,barManager,intTotNodeCnt,Text,objCellText,intl,intK,strDesc1,strDesc2
    Dim objWrkSpace,objwrkspacepop,objwrkspcUpload,objConfirm,objGridCell,DescLocalText,intSeriesID

    call sLoadLayout
    strLevel1layout=getSplitValue(strParameters,"LEVEL1LAYOUT")
    strLevel2layout=getSplitValue(strParameters,"LEVEL2LAYOUT")  
    strLevel3layout=getSplitValue(strParameters,"LEVEL3LAYOUT")

'    strLevel1layout="dX Non-Asia Database (Current Eng Version)"
'    strLevel2layout="Z-Testing Topic(IT-use only)"
'    strLevel3layout="Sandbox (Benny)" 

'    strLevel1layout="dX Non-Asia Database (Current Eng Version)"
'    strLevel2layout=""
'    strLevel3layout=""

     Delay 10000,"Please Wait..."
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("LayoutTreeControl").WPFObject("LayoutTreeListView")
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("LayoutTreeControl")
    if strLevel1layout <> "" and strLevel2layout <> "" AND strLevel3layout <> "" then
        Delay 1000,"Please Wait..."
        ''Selecting Level1 layout
        intTotNodeCnt=GridControl.Nodes_2.Count
        For intI=0 to intTotNodeCnt-1         
            If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strLevel1layout) then
              GridControl.Nodes_2.Item(intI).Expand(True)
              log.Message "Level 1 Layout - " & GridControl.Nodes_2.Item(intI).Content.Description       
              blnFlag=False  
              Exit For
            End If
        Next
        Delay 10000,"Please Wait..."
        If blnFlag = True then
          strTCRemarks="Level 1 Layout not found"
          strTestCaseResult="FAIL"
          Exit Sub
        End If
  
        blnFlag = True 
        ''Selecting Level2 Layout
        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
        For intJ=0 to intTotNodeCnt-1
          If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strLevel2layout) then
            GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
            log.Message "Level2 layout Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
            blnFlag = False 
            Exit For
          End If
        Next
        If blnFlag = True then
          strTCRemarks="Level2 Source Name not found"
          strTestCaseResult="FAIL"
          Exit Sub
        End If
        delay(10000)
        blnFlag = True    
        ''Selecting Level3 Layout
          intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count
          For intK=0 to intTotNodeCnt-1
            If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description)=Ucase(strLevel3layout) then
              GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Expand(True)
              intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).get_RowHandle
''                  GridControl.set_FocusedRowHandle(intRow)
''                  'GridControl.Click
''                  'Delay(1000)
''                  GridControl.Keys("[Down]")
''                  GridControl.Keys("[Up]")

              Call GridControl.ClearSelectionCore
              Call GridControl.FocusViewAndRow(GridControl,intRow)
              GridControl.SetFocusOnCurrentItem
              Call GridControl.SelectRowCore(intRow)
              log.Message "Level3 layout Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description
              blnFlag = False
              Exit For   
            End If 
          Next
          If blnFlag = True then
            strTCRemarks="Level3 Source Name not found"
            strTestCaseResult="FAIL"
            Exit Sub
          End If
    Elseif strLevel2layout<> "" AND strLevel3layout = "" then
       Delay 1000,"Please Wait..."
        ''Selecting Level1 layout
        intTotNodeCnt=GridControl.Nodes_2.Count
        For intI=0 to intTotNodeCnt-1         
            If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strLevel1layout) then
              GridControl.Nodes_2.Item(intI).Expand(True)
              log.Message "Level 1 Layout - " & GridControl.Nodes_2.Item(intI).Content.Description       
              blnFlag=False  
              Exit For
            End If
        Next
        Delay 10000,"Please Wait..."
        If blnFlag = True then
          strTCRemarks="Level 1 Layout not found"
          strTestCaseResult="FAIL"
          Exit Sub
        End If
  
        blnFlag = True 
        ''Selecting Level2 Layout
        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
        For intJ=0 to intTotNodeCnt-1
          If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strLevel2layout) then
            GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
            intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
            GridControl.set_FocusedRowHandle(intRow)
            GridControl.Keys("[Down]")
            GridControl.Keys("[Up]")
            log.Message "Level2 layout Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
            blnFlag = False 
            Exit For
          End If
        Next
        If blnFlag = True then
          strTCRemarks="Level2 Source Name not found"
          strTestCaseResult="FAIL"
          Exit Sub
        End If 
    Elseif strLevel2layout="" then
      Delay 10000,"Please Wait..."
        ''Selecting Level1 layout
        intTotNodeCnt=GridControl.Nodes_2.Count
        For intI=0 to intTotNodeCnt-1         
            If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strLevel1layout) then
              GridControl.Nodes_2.Item(intI).Expand(True)
              intRow=GridControl.Nodes_2.Item(intI).get_RowHandle
              GridControl.set_FocusedRowHandle(intRow)
              GridControl.Keys("[Down]")
              GridControl.Keys("[Up]")
              log.Message "Level 1 Layout - " & GridControl.Nodes_2.Item(intI).Content.Description       
              blnFlag=False  
              Exit For
            End If
        Next
        Delay 9000,"Please Wait..."
        If blnFlag = True then
          strTCRemarks="Level 1 Layout not found"
          strTestCaseResult="FAIL"
          Exit Sub
        End If
    End if

End Sub

Sub  sCheckLayoutExpandAll(strParameters)
On Error Resume Next 
    Dim objEdge,objEdgeFilter
    Dim strLevel1layout,strLevel2layout,strLevel3layout,strWrkSpaceName
    Dim objNewWrkSpace_okbtn,objNewWrkSpace_Name
    Dim objNewWrkSpace_Txtbox,objopenforEdit,objWrkspace_popup
    Dim strTemp,objTemp,intRow,barManager,intTotNodeCnt,Text,objCellText,intl,intK,strDesc1,strDesc2
    Dim objWrkSpace,objwrkspacepop,objwrkspcUpload,objConfirm,objGridCell,DescLocalText,intSeriesID
  
    strLevel1layout=getSplitValue(strParameters,"LEVEL1LAYOUT")
    'strLevel1layout="dX Non-Asia Database (Current Eng Version)"
    Delay 3000,"Please Wait..."
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("LayoutTreeControl").WPFObject("LayoutTreeListView")
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("LayoutTreeControl")

    Delay 1000,"Please Wait..."
    ''Selecting Level1 layout
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strLevel1layout) then
          'GridControl.Nodes_2.Item(intI).Expand(True)
          log.Message "Level 1 Layout - " & GridControl.Nodes_2.Item(intI).Content.Description
          intRow=GridControl.Nodes_2.Item(intI).get_RowHandle
          GridControl.set_FocusedRowHandle(intRow)
          GridControl.Keys("[Down]")
          GridControl.Keys("[Up]")       
          blnFlag=False  
          Exit For
        End If
    Next
    Delay 3000,"Please Wait..."
    If blnFlag = True then
      strTCRemarks="Level 1 Layout not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
  set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1)
  strTemp="WPFObject(""ContentControlEx"", ""Expand All"", 2)"
  Set objTemp=objEdge.FindChild("Name",strTemp,50)
  If objTemp.Exists=True then
    strTCRemarks = "Expand All Button is found in Layout"
    log.Message "Expand All Button is found in Layout"
    objTemp.Click
    strTCRemarks = strTCRemarks & "<br />" &  "Expanded All the tree in Layout"
  else
    strTCRemarks =  "Expand All is Not found in Layout"
  End if 
End Sub

Sub  sCheckLayoutCollapseAll(strParameters)
On Error Resume Next 
  Dim objEdge,objEdgeFilter
    Dim strLevel1layout,strLevel2layout,strLevel3layout,strWrkSpaceName
    Dim objNewWrkSpace_okbtn,objNewWrkSpace_Name
    Dim objNewWrkSpace_Txtbox,objopenforEdit,objWrkspace_popup
    Dim strTemp,objTemp,intRow,barManager,intTotNodeCnt,Text,objCellText,intl,intK,strDesc1,strDesc2
    Dim objWrkSpace,objwrkspacepop,objwrkspcUpload,objConfirm,objGridCell,DescLocalText,intSeriesID
  
    strLevel1layout=getSplitValue(strParameters,"LEVEL1LAYOUT")
'    strLevel1layout="dX Non-Asia Database (Current Eng Version)"
    Delay 3000,"Please Wait..."
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("LayoutTreeControl").WPFObject("LayoutTreeListView")
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("LayoutTreeControl")

    Delay 1000,"Please Wait..."
    ''Selecting Level1 layout
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strLevel1layout) then
          'GridControl.Nodes_2.Item(intI).Expand(True)
          log.Message "Level 1 Layout - " & GridControl.Nodes_2.Item(intI).Content.Description
          intRow=GridControl.Nodes_2.Item(intI).get_RowHandle
          GridControl.set_FocusedRowHandle(intRow)
          GridControl.Keys("[Down]")
          GridControl.Keys("[Up]")       
          blnFlag=False  
          Exit For
        End If
    Next
    Delay 3000,"Please Wait..."
    If blnFlag = True then
      strTCRemarks="Level 1 Layout not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If

  set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1)
  strTemp="WPFObject(""ContentControlEx"", ""Collapse All"", 2)"
  Set objTemp=objEdge.FindChild("Name",strTemp,50)
  If objTemp.Exists=True then
    strTCRemarks = "Collapse All Button is found in Layout"
    log.Message "Collapse All Button is found in Layout"
    objTemp.Click
    strTCRemarks = strTCRemarks & "<br />" &  "Collapse All the tree in Layout"
  else
    strTCRemarks =  "Collapse All is Not found in Layout"
  End if 
End Sub

Sub  sCheckLayoutViewWorkspace(strParameters)
On Error Resume Next 

    Dim strTemp,objNewWorkspace,objopenforEdit,strTemp1,objNewWrkSpaceName
    Dim intTotNodeCnt,intI,intJ,intK,strOk
     
    Call sloadlayout 
    Call sCheckLayoutExpandTree(strParameters)
    strLevel1layout=getSplitValue(strParameters,"LEVEL1LAYOUT")
    strLevel2layout=getSplitValue(strParameters,"LEVEL2LAYOUT")
    strLevel3layout=getSplitValue(strParameters,"LEVEL3LAYOUT")

'    strLevel1layout="dX Non-Asia Database (Current Eng Version)"
'    strLevel2layout="Z-Testing Topic(IT-use only)"
'    strLevel3layout="Sandbox (Benny)"
    
      strTemp="WPFObject(""ArrowControl"", """", 1)"
      Set objNewWorkspace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarSubItemLinkControl", "", 1).FindChild("Name",strTemp,2,True)
      If objNewWorkspace.Exists = True then
        objNewWorkspace.Click
        strTemp="WPFObject(""BarPopupBorderControl"", """", 1)"
        Set objWrkspace_popup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").FindChild("Name",strTemp,15,True)
        If objWrkspace_popup.Exists = True then
          strTemp="WPFObject(""ContentControlEx"", ""Open For View"", 2)"
          Set objopenforEdit=objWrkspace_popup.FindChild("Name",strTemp,8,True)
          If objopenforEdit.Exists then
            objopenforEdit.Click
            Call sEdgeProcessor
            log.Message "Workspace created for view only"
            strTCRemarks="Workspace created for view only"
          Else
            Exit Sub 
          End If
        End If
      End if
      Call sCloseLayout
      Call sCloseLayout
End sub

Sub  sCheckLayoutEditWorkspace(strParameters)
On Error Resume Next

    Dim objNewWorkspace,strTemp1,objNewWrkSpaceName
    Dim strLevel1layout,strLevel2layout,strLevel3layout,strWrkSpaceName
    Dim objNewWrkSpace_okbtn,objNewWrkSpace_Name
    Dim objNewWrkSpace_Txtbox,objopenforEdit,objWrkspace_popup
    Dim strTemp,objTemp,intRow,barManager,intTotNodeCnt,Text,objCellText,intI,intJ,intK,strDesc1,strDesc2
    Dim objWrkSpace,objwrkspacepop,objwrkspcUpload,objConfirm,objGridCell,DescLocalText,intSeriesID
    
    Call sLoadLayout
    Call sCheckLayoutExpandTree(strParameters)
    
    strLevel1layout=getSplitValue(strParameters,"LEVEL1LAYOUT")
    strLevel2layout=getSplitValue(strParameters,"LEVEL2LAYOUT")
    strLevel3layout=getSplitValue(strParameters,"LEVEL3LAYOUT")
    
'    strLevel1layout="dX Non-Asia Database (Current Eng Version)"
'    strLevel2layout="Z-Testing Topic(IT-use only)"
'    strLevel3layout="Sandbox (Benny)"
    
'    strLevel1layout="dX Non-Asia Database (Current Eng Version)"
'    strLevel2layout="Z-Topic Test(IT-use only)"
'    strLevel3layout="Automation"

    strDesc1=aqDateTime.Now
    strDesc2=aqDateTime.Now
    DescText=Replace(strDesc1,"/","-")
    DescText=Replace(DescText,":","_")
    DescLocalText=DescText
    strWrkSpaceName=DescText
'    intSeriesID=getSplitValue(strParameters,"SERIESID")
'    if intSeriesID=0 then
'      intSeriesID=strSeriesID
'    End if 
    strTemp="WPFObject(""ArrowControl"", """", 1)"
    Set objNewWorkspace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarSubItemLinkControl", "", 1).FindChild("Name",strTemp,2,True)
    If objNewWorkspace.Exists = True then
      objNewWorkspace.Click
      strTemp="WPFObject(""BarPopupBorderControl"", """", 1)"
      Set objWrkspace_popup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").FindChild("Name",strTemp,5,True)
      If objWrkspace_popup.Exists = True then
        strTemp="WPFObject(""ContentControlEx"", ""Open For Edit"", 2)"
        Set objopenforEdit=objWrkspace_popup.FindChild("Name",strTemp,8,True)
        If objopenforEdit.Exists then
          objopenforEdit.Click    
        End If
      End If
      strTemp1="WPFObject(""HwndSource: WorkspaceNamePrompt"", ""Please provide a new Workspace Name"")"
      Set objNewWrkSpaceName=Sys.Process("EdgeClient").WaitChild(strTemp1,80000)
      If objNewWrkSpaceName.Exists = True then
          ''Waiting for Workspace Name prompt
          strTemp="WPFObject(""FloatingContainerBorder"")"
          Set objNewWrkSpace_Name=Sys.Process("EdgeClient").WPFObject("HwndSource: WorkspaceNamePrompt", "Please provide a new Workspace Name").WPFObject("WorkspaceNamePrompt", "Please provide a new Workspace Name", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,1500000)
          If objNewWrkSpace_Name.Exists = True then
            strTemp="WPFObject(""ChangeNameTextEdit"")"
            ''Entering Workspace Name
            Set objNewWrkSpace_Txtbox=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
            If objNewWrkSpace_Txtbox.Exists = True then
                objNewWrkSpace_Txtbox.Click
                objNewWrkSpace_Txtbox.Text=strWrkSpaceName
                ''Clicking on Ok Button 
                strTemp="WPFObject(""OkButton"")"
                Set objNewWrkSpace_okbtn=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
                If objNewWrkSpace_okbtn.Exists = True then
                  objNewWrkSpace_okbtn.Click
                  Call sEdgeProcessor
                End If
            End If
          End If
          
          
          strTemp="WPFObject(""ContentControlEx"", ""Size of changes:"", 1)"
          Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarStaticItemLinkControl", "", 1).FindChild("Name",strTemp,9,True)
          If objNewWrkSpace_okbtn.Exists = True then
            strTCRemarks = strTCRemarks & "<br />" & "Size of change is found in Layout"
            log.Message "Size of Change is found in Layout"
          Else
            strTCRemarks = strTCRemarks & "<br />" & "Size of change is  not found in Layout"
            log.Message "Size of Change is not found in Layout"
          End If
          
          strTemp="WPFObject(""ContentControlEx"", ""Add Folder"", 2)"
          Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 4).WPFObject("BarButtonItemLinkControl", "", 1).FindChild("Name",strTemp,50,True)
          If objNewWrkSpace_okbtn.Exists = True then
            strTCRemarks = strTCRemarks & "<br />" & "Add Folder is found in Layout"
            log.Message "Add Folder is found in Layout"
          Else
            strTCRemarks = strTCRemarks & "<br />" & "Add Folder is  not found in Layout"
            log.Message "Add Folder is not found in Layout"
          End If
          
          strTemp="WPFObject(""ContentControlEx"", ""Delete Folder"", 2)"
          Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).FindChild("Name",strTemp,50,True)
          If objNewWrkSpace_okbtn.Exists = True then
            strTCRemarks = strTCRemarks & "<br />" & "Delete Folder is found in Layout"
            log.Message "Delete Folder is found in Layout"
          Else
            strTCRemarks = strTCRemarks & "<br />" & "Delete Folder is  not found in Layout"
            log.Message "Delete Folder is not found in Layout"
          End If
          
          strTemp="WPFObject(""ContentControlEx"", ""Copy Folder"", 2)"
           Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).FindChild("Name",strTemp,50,True)
          If objNewWrkSpace_okbtn.Exists = True then
            strTCRemarks = strTCRemarks & "<br />" & "Copy Folder is found in Layout"
            log.Message "Copy Folder is found in Layout"
          Else
            strTCRemarks = strTCRemarks & "<br />" & "Copy Folder is  not found in Layout"
            log.Message "Copy Folder is not found in Layout"
          End If

          strTemp="WPFObject(""ContentControlEx"", ""Cut Folder"", 2)"
          Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).FindChild("Name",strTemp,50,True)
          If objNewWrkSpace_okbtn.Exists = True then
            strTCRemarks = strTCRemarks & "<br />" & "Cut Folder is found in Layout"
            log.Message "Cut Folder is found in Layout"
          Else
            strTCRemarks = strTCRemarks & "<br />" & "Cut Folder is  not found in Layout"
            log.Message "Cut Folder is not found in Layout"
          End If
          call scloselayout
          strTemp="WPFObject(""ContentControlEx"", ""Paste Folder"", 2)"
          Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).FindChild("Name",strTemp,50,True)
          If objNewWrkSpace_okbtn.Exists = True then
            strTCRemarks = strTCRemarks & "<br />" & "Paste button is found in Layout"
            log.Message "Paste button is found in Layout"
          Else
            strTCRemarks = strTCRemarks & "<br />" & "Paste button is  not found in Layout"
            log.Message "Paste button is not found in Layout"
          End If
          
          strTemp="WPFObject(""ContentControlEx"", ""Workspace"", 2)"
          Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).FindChild("Name",strTemp,50,True)
          If objNewWrkSpace_okbtn.Exists = True then
            strTCRemarks = strTCRemarks & "<br />" & "Workspace button is found in Layout"
            log.Message "Workspace button is found in Layout"
          Else
            strTCRemarks = strTCRemarks & "<br />" & "Workspace button is  not found in Layout"
            log.Message "Workspace button is not found in Layout"
          End If
          
          strTemp="WPFObject(""ContentControlEx"", ""Find & Replace"", 2)"
          Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).FindChild("Name",strTemp,50,True)
          If objNewWrkSpace_okbtn.Exists = True then
            strTCRemarks = strTCRemarks & "<br />" & "Find & Replace  is found in Layout"
            log.Message "Find & Replace is found in Layout"
          Else
            strTCRemarks = strTCRemarks & "<br />" & "Find & Replace is  not found in Layout"
            log.Message "Find & Replace is not found in Layout"
          End If
          
          strTemp="WPFObject(""ContentControlEx"", ""Expand All"", 2)"
          Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).FindChild("Name",strTemp,50,True)
          If objNewWrkSpace_okbtn.Exists = True then
            strTCRemarks = strTCRemarks & "<br />" & "Expand All is found in Layout"
            log.Message "Expand All is found in Layout"
          Else
            strTCRemarks = strTCRemarks & "<br />" & "Expand All is  not found in Layout"
            log.Message "Expand All is not found in Layout"
          End If
          
          strTemp="WPFObject(""ContentControlEx"", ""Collapse All"", 2)"
          Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).FindChild("Name",strTemp,50,True)
          If objNewWrkSpace_okbtn.Exists = True then
            strTCRemarks = strTCRemarks & "<br />" & "Collapse All is found in Layout"
            log.Message "Collapse All is found in Layout"
          Else
            strTCRemarks = strTCRemarks & "<br />" & "Collapse All is  not found in Layout"
            log.Message "Collapse All is not found in Layout"
          End If
          
          strTemp="WPFObject(""ContentControlEx"", ""Number Table"", 2)"
          Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).FindChild("Name",strTemp,50,True)
          If objNewWrkSpace_okbtn.Exists = True then
            strTCRemarks = strTCRemarks & "<br />" & "Number Table is found in Layout"
            log.Message "Number Table is found in Layout"
          Else
            strTCRemarks = strTCRemarks & "<br />" & "Number Table is  not found in Layout"
            log.Message "Number Table is not found in Layout"
          End If
           
          Call scloseLayout
          Call LayoutWorkSpacevwr
      End if 
  End If

End sub 

Sub sCheckLayoutEditFields()
On Error Resume Next

  Dim objEdge,strTemp,objTemp,objEdgeTree,strLayoutHeader,GridControl,GridSourceTree,intTotNodeCnt,intI
              
  set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1)
  strTemp="WPFObject(""LayoutTreeListView"")"
  Set objTemp=objEdge.FindChild("Name",strTemp,50)
  If objTemp.Exists=True then
    strTCRemarks = "Layout Grid found in Layout"
    log.Message "Layout grid found in Layout"
    set objEdgeTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("LayoutTreeListControl").WPFObject("LayoutTreeListView")
    strTemp="WPFObject(""GridColumnHeader"", """", 1)"
    Set objTemp=objEdgeTree.FindChild("Name",strTemp,50)
    if objTemp.Exists=True then
      if UCASE(objTemp.DataContext.Header)="DESCRIPTION *" then
        strTCRemarks = strTCRemarks & "<br />" & "Description is found in Layout"
        log.Message "Description is found in Layout"
      Else
        strTCRemarks = strTCRemarks & "<br />" & "Description is not found in Layout"
        log.Message "Description is not found in Layout"
      End if
    Else 
      strTCRemarks = strTCRemarks & "<br />" & "Fields is not found in Layout"
    End if
       
    strTemp="WPFObject(""GridColumnHeader"", """", 2)"
    Set objTemp=objEdgeTree.FindChild("Name",strTemp,50)
    if objTemp.Exists=True then
      if UCASE(objTemp.DataContext.Header)="DESCRIPTION LOCAL" then
        strTCRemarks = strTCRemarks & "<br />" & "Description Local is found in Layout"
        log.Message "Description Local is found in Layout"
      Else
        strTCRemarks = strTCRemarks & "<br />" & "Description is not found in Layout"
        log.Message "Description Local is not found in Layout"
      End if 
    else
      strTCRemarks = strTCRemarks & "<br />" & "Fields is not found in Layout"
    End if
    
    strTemp="WPFObject(""GridColumnHeader"", """", 3)"
    Set objTemp=objEdgeTree.FindChild("Name",strTemp,50)
    if objTemp.Exists=True then
      if UCASE(objTemp.DataContext.Header)="DISABLED FLAG" then
        strTCRemarks = strTCRemarks & "<br />" & "Disabled Flag is found in Layout"
        log.Message "Disabled Flag is found in Layout"
      Else
        strTCRemarks = strTCRemarks & "<br />" & "Disabled Flag is not found in Layout"
        log.Message "Disabled Flag is not found in Layout"
      End if 
    else
      strTCRemarks = strTCRemarks & "<br />" & "Fields is not found in Layout"
    End if
    
    strTemp="WPFObject(""GridColumnHeader"", """", 4)"
    Set objTemp=objEdgeTree.FindChild("Name",strTemp,50)
    if objTemp.Exists=True then
      if UCASE(objTemp.DataContext.Header)="OUTPUT FLAG" then
        strTCRemarks = strTCRemarks & "<br />" & "Output Flag is found in Layout"
        log.Message "Output Flag is found in Layout"
      Else
        strTCRemarks = strTCRemarks & "<br />" & "Output Flag is not found in Layout"
        log.Message "Output Flag is not found in Layout"
      End if 
    else
      strTCRemarks = strTCRemarks & "<br />" & "Fields is not found in Layout"
    End if
        
    strTemp="WPFObject(""GridColumnHeader"", """", 5)"
    Set objTemp=objEdgeTree.FindChild("Name",strTemp,50)
    if objTemp.Exists=True then
      if UCASE(objTemp.DataContext.Header)="DX FILE NAME" then
        strTCRemarks = strTCRemarks & "<br />" & "DX File Name is found in Layout"
        log.Message "DX File Name is found in Layout"
      Else
        strTCRemarks = strTCRemarks & "<br />" & "DX File Name is not found in Layout"
        log.Message "DX File Name is not found in Layout"
      End if 
    else
      strTCRemarks = strTCRemarks & "<br />" & "Fields is not found in Layout"
    End if
    
    strTemp="WPFObject(""GridColumnHeader"", """", 6)"
    Set objTemp=objEdgeTree.FindChild("Name",strTemp,50)
    if objTemp.Exists=True then
      if UCASE(objTemp.DataContext.Header)="VER" then
        strTCRemarks = strTCRemarks & "<br />" & "Ver is found in Layout"
        log.Message "Ver found in Layout"
      Else
        strTCRemarks = strTCRemarks & "<br />" & "Ver is not found in Layout"
        log.Message "Ver is not found in Layout"
      End if 
    else
      strTCRemarks = strTCRemarks & "<br />" & "Fields is not found in Layout"
    End if
    
    strTemp="WPFObject(""GridColumnHeader"", """", 7)"
    Set objTemp=objEdgeTree.FindChild("Name",strTemp,50)
    if objTemp.Exists=True then
      if UCASE(objTemp.DataContext.Header)="LAST UPDATED TIME" then
        strTCRemarks = strTCRemarks & "<br />" & "Last Updated Time is found in Layout"
        log.Message "Last Updated Time is found in Layout"
      Else
        strTCRemarks = strTCRemarks & "<br />" & "Last Updated Time is not found in Layout"
        log.Message "Last Updated Time is not found in Layout"
      End if 
    else
      strTCRemarks = strTCRemarks & "<br />" & "Fields is not found in Layout"
    End if
    
    strTemp="WPFObject(""GridColumnHeader"", """", 8)"
    Set objTemp=objEdgeTree.FindChild("Name",strTemp,50)
    if objTemp.Exists=True then
      if UCASE(objTemp.DataContext.Header)="LAST UPDATED USER ID" then
        strTCRemarks = strTCRemarks & "<br />" & "Last Updated User ID is found in Layout"
        log.Message "Last Updated User ID is found in Layout"
      Else
        strTCRemarks = strTCRemarks & "<br />" & "Last Updated User ID is not found in Layout"
        log.Message "Last Updated User ID is  not found in Layout"
      End if 
    else
      strTCRemarks = strTCRemarks & "<br />" & "Fields is not found in Layout"
    End if
    
    strTemp="WPFObject(""GridColumnHeader"", """", 9)"
    Set objTemp=objEdgeTree.FindChild("Name",strTemp,50)
    if objTemp.Exists=True then
      if UCASE(objTemp.DataContext.Header)="TREE LEVEL" then
        strTCRemarks = strTCRemarks & "<br />" & "Tree Level is found in Layout"
        log.Message "Tree Level is found in Layout"
      Else
        strTCRemarks = strTCRemarks & "<br />" & "Tree Level is not found in Layout"
        log.Message "Tree Level is not found in Layout"
      End if 
    else
      strTCRemarks = strTCRemarks & "<br />" & "Fields is not found in Layout"
    End if
    
    
'    strTemp="WPFObject(""GridColumnHeader"", """", 11)"
'    Set objTemp=objEdgeTree.FindChild("Name",strTemp,50)
'    if objTemp.Exists=True then
'      if UCASE(objTemp.DataContext.Header)="LAST UPDATED TIME" then
'        strTCRemarks = strTCRemarks & "<br />" & "Last Updated Time is found in Layout"
'        log.Message "Last Updated Time is found in Layout"
'      Else
'        strTCRemarks = strTCRemarks & "<br />" & "Last Updated Time is not found in Layout"
'        log.Message "Last Updated Time is not found in Layout"
'      End if 
'    else
'      strTCRemarks = strTCRemarks & "<br />" & "Fields is not found in Layout"
'    End if
    
    
     strTemp="WPFObject(""GridColumnHeader"", """", 10)"
    Set objTemp=objEdgeTree.FindChild("Name",strTemp,50)
    if objTemp.Exists=True then
      if UCASE(objTemp.DataContext.Header)="DISPLAY ORDER" then
        strTCRemarks = strTCRemarks & "<br />" & "Display Order is found in Layout"
        log.Message "Display Order is found in Layout"
      Else
        strTCRemarks = strTCRemarks & "<br />" & "Display Order is not found in Layout"
        log.Message "Display Order is not found in Layout"
      End if 
    else
      strTCRemarks = strTCRemarks & "<br />" & "Fields is not found in Layout"
    End if
    
     strTemp="WPFObject(""GridColumnHeader"", """", 11)"
    Set objTemp=objEdgeTree.FindChild("Name",strTemp,50)
    if objTemp.Exists=True then
      if UCASE(objTemp.DataContext.Header)="SYSTEM ID" then
        strTCRemarks = strTCRemarks & "<br />" & "System ID is found in Layout"
        log.Message "System ID is found in Layout"
      Else
        strTCRemarks = strTCRemarks & "<br />" & "System ID is not found in Layout"
        log.Message "System ID is not found in Layout"
      End if 
    else
      strTCRemarks = strTCRemarks & "<br />" & "Fields is not found in Layout"
    End if    
  else
    strTCRemarks =  "Layout Grid Not found in Layout"
  End if 

End sub

Sub sCheckLayoutEditCopyFolder()
On Error Resume Next
Dim strTemp,objCopyfolder, objPopup
    strTemp="WPFObject(""ContentControlEx"", ""Copy Folder"", 2)"
    Set objCopyfolder=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).FindChild("Name",strTemp,50,True)
    If objCopyfolder.Exists = True then
      strTCRemarks = strTCRemarks & "<br />" & "Copy Folder is found in Layout"
      log.Message "Copy Folder is found in Layout"
      objCopyfolder.Click
      strTemp="WPFObject(""ContentControlEx"", ""Copy Folder Only"", 2)"
      Set objPopup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarButtonItemLinkControl", "", 1)
      If objPopup.Exists = True then
        strTCRemarks = strTCRemarks & "<br />" & "Copy Folder  only is found in Layout"
        log.Message "Copy Folder only is found in Layout"
      End if 
      strTemp="WPFObject(""ContentControlEx"", ""Copy Folder with Series"", 2)"
      Set objPopup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 2).WPFObject("BarButtonItemLinkControl", "", 1)
      If objPopup.Exists = True then
        strTCRemarks = strTCRemarks & "<br />" & "Copy Folder with Series is found in Layout"
        log.Message "Copy Folder with Series is found in Layout"
      End if 
    Else
      strTCRemarks = strTCRemarks & "<br />" & "Copy Folder is not found in Layout"
      log.Message "Copy Folder is not found in Layout"
    End If
End Sub
Sub sCheckLayoutEditPasteFolder()
On Error Resume Next
Dim strTemp,objCopyfolder, objPopup
    strTemp="WPFObject(""ContentControlEx"", ""Paste Folder"", 2)"
    Set objCopyfolder=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).FindChild("Name",strTemp,50,True)
    If objCopyfolder.Exists = True then
      strTCRemarks = strTCRemarks & "<br />" & "Paste Folder is found in Layout"
      log.Message "Paste Folder is found in Layout"
      objCopyfolder.Click
      strTemp="WPFObject(""ContentControlEx"", ""Paste Above"", 2)"
      Set objPopup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarButtonItemLinkControl", "", 1)
      If objPopup.Exists = True then
        strTCRemarks = strTCRemarks & "<br />" & "Paste Above is found in Layout"
        log.Message "Paste Above is found in Layout"
      End if 
      strTemp="WPFObject(""ContentControlEx"", ""Paste Inside"", 2)"
      Set objPopup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 2).WPFObject("BarButtonItemLinkControl", "", 1)
      If objPopup.Exists = True then
        strTCRemarks = strTCRemarks & "<br />" & "Paste Inside is found in Layout"
        log.Message "Paste Inside is found in Layout"
      End if 

      strTemp="WPFObject(""ContentControlEx"", ""Paste Below"", 2)"
      Set objPopup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 3).WPFObject("BarButtonItemLinkControl", "", 1)
      If objPopup.Exists = True then
        strTCRemarks = strTCRemarks & "<br />" & "Paste Below is found in Layout"
        log.Message "Paste Below is found in Layout"
      End if 
    Else
      strTCRemarks = strTCRemarks & "<br />" & "Paste Folder is not found in Layout"
      log.Message "Paste Folder is not found in Layout"
    End If
End Sub
Sub sCheckLayoutEditWorkspaceFolder()
On Error Resume Next
    Dim strTemp,objCopyfolder, objPopup
    strTemp="WPFObject(""ContentControlEx"", ""Workspace"", 2)"
    Set objCopyfolder=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).FindChild("Name",strTemp,50,True)
    If objCopyfolder.Exists = True then
      strTCRemarks = strTCRemarks & "<br />" & "Workspace is found in Layout"
      log.Message "Workspace is found in Layout"
      objCopyfolder.Click
      strTemp="WPFObject(""ContentControlEx"", ""Save Workspace"", 2)"
      Set objPopup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarButtonItemLinkControl", "", 1)
      If objPopup.Exists = True then
        strTCRemarks = strTCRemarks & "<br />" & "Save Workspace is found in Layout"
        log.Message "Save Workspace is found in Layout"
      End if 
      strTemp="WPFObject(""ContentControlEx"", ""Upload Workspace"", 2)"
      Set objPopup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 2).WPFObject("BarButtonItemLinkControl", "", 1)
      If objPopup.Exists = True then
        strTCRemarks = strTCRemarks & "<br />" & "Upload Workspace is found in Layout"
        log.Message "Upload Workspace is found in Layout"
      End if 

    Else
      strTCRemarks = strTCRemarks & "<br />" & "Workspace Folder is not found in Layout"
      log.Message "Workspace Folder is not found in Layout"
    End If
End Sub
Sub sCheckLayoutEditSeriesFields()
On Error Resume Next
    Dim strTemp,objCopyfolder, objPopup
    strTemp="WPFObject(""ContentControlEx"", ""Attach Series"", 2)"
    Set objCopyfolder=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).FindChild("Name",strTemp,50,True)
    If objCopyfolder.Exists = True then
      strTCRemarks = strTCRemarks & "<br />" & "Attach Series is found in Layout"
      log.Message "Attach Series is found in Layout"
    Else
      strTCRemarks = strTCRemarks & "<br />" & "Attach Series is not found in Layout"
      log.Message "Attach Series is not found in Layout"
    End If
    
    strTemp="WPFObject(""ContentControlEx"", ""Detach Series"", 2)"
    Set objCopyfolder=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).FindChild("Name",strTemp,50,True)
    If objCopyfolder.Exists = True then
      strTCRemarks = strTCRemarks & "<br />" & "Detach Series is found in Layout"
      log.Message "Detach Series is found in Layout"
    Else
      strTCRemarks = strTCRemarks & "<br />" & "Detach Series is not found in Layout"
      log.Message "Detach Series is not found in Layout"
    End If
    
    strTemp="WPFObject(""ContentControlEx"", ""Add Separator"", 2)"
    Set objCopyfolder=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).FindChild("Name",strTemp,50,True)
    If objCopyfolder.Exists = True then
      strTCRemarks = strTCRemarks & "<br />" & "Add Separator is found in Layout"
      log.Message "Add Separator is found in Layout"
    Else
      strTCRemarks = strTCRemarks & "<br />" & "Add Separator is not found in Layout"
      log.Message "Add Separator is not found in Layout"
    End If
    
    strTemp="WPFObject(""ContentControlEx"", ""Copy Series"", 2)"
    Set objCopyfolder=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).FindChild("Name",strTemp,50,True)
    If objCopyfolder.Exists = True then
      strTCRemarks = strTCRemarks & "<br />" & "Copy Series is found in Layout"
      log.Message "Copy Series is found in Layout"
    Else
      strTCRemarks = strTCRemarks & "<br />" & "Copy Series is not found in Layout"
      log.Message "Copy Series is not found in Layout"
    End If
    
    strTemp="WPFObject(""ContentControlEx"", ""Cut Series"", 2)"
    Set objCopyfolder=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).FindChild("Name",strTemp,50,True)
    If objCopyfolder.Exists = True then
      strTCRemarks = strTCRemarks & "<br />" & "Cut Series is found in Layout"
      log.Message "Cut Series is found in Layout"
    Else
      strTCRemarks = strTCRemarks & "<br />" & "Cut Series is not found in Layout"
      log.Message "Cut Series is not found in Layout"
    End If
    strTemp="WPFObject(""ContentControlEx"", ""Paste Series"", 2)"
    Set objCopyfolder=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).FindChild("Name",strTemp,50,True)
    If objCopyfolder.Exists = True then
      strTCRemarks = strTCRemarks & "<br />" & "Paste Series is found in Layout"
      log.Message "Paste Series is found in Layout"
    Else
      strTCRemarks = strTCRemarks & "<br />" & "Paste Series is not found in Layout"
      log.Message "Paste Series is not found in Layout"
    End If
    strTemp="WPFObject(""ContentControlEx"", ""Find & Replace"", 2)"
    Set objCopyfolder=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).FindChild("Name",strTemp,50,True)
    If objCopyfolder.Exists = True then
      strTCRemarks = strTCRemarks & "<br />" & "Find & Replace is found in Layout"
      log.Message "Attach Series is found in Layout"
    Else
      strTCRemarks = strTCRemarks & "<br />" & "Find & Replace is not found in Layout"
      log.Message "Find & Replace is not found in Layout"
    End If
End Sub
Sub sCheckLayoutEditSeriesGrid()
On Error Resume Next

  Dim objEdge,strTemp,objTemp,objEdgeTree,strLayoutHeader,GridControl,GridSourceTree,intTotNodeCnt,intI
              
  set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1)
  strTemp="WPFObject(""LayoutTreeListView"")"
  Set objTemp=objEdge.FindChild("Name",strTemp,50)
  If objTemp.Exists=True then
    strTCRemarks = "Layout Edit Grid found in Layout"
    log.Message "Layout Edit grid found in Layout"
    set objEdgeTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("LayoutSeriesViewControl").WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("LayoutSeriesGridControl").WPFObject("LayoutSeriesTableView")
    strTemp="WPFObject(""GridColumnHeader"", """", 1)"
    Set objTemp=objEdgeTree.FindChild("Name",strTemp,50)
    if objTemp.Exists=True then
      if UCASE(objTemp.DataContext.Header)="SERIES ID" then
        strTCRemarks = strTCRemarks & "<br />" & "Series ID is found in Layout"
        log.Message "Series ID is found in Layout"
      Else
        strTCRemarks = strTCRemarks & "<br />" & "Series ID is not found in Layout"
        log.Message "Series ID is not found in Layout"
      End if
    Else 
      strTCRemarks = strTCRemarks & "<br />" & "Fields is not found in Layout"
    End if
    
    strTemp="WPFObject(""GridColumnHeader"", """", 2)"
    Set objTemp=objEdgeTree.FindChild("Name",strTemp,50)
    if objTemp.Exists=True then
      if UCASE(objTemp.DataContext.Header)="DX CODE" then
        strTCRemarks = strTCRemarks & "<br />" & "DX CODE is found in Layout"
        log.Message "DX CODE is found in Layout"
      Else
        strTCRemarks = strTCRemarks & "<br />" & "DX CODE is not found in Layout"
        log.Message "DX CODE is not found in Layout"
      End if
    Else 
      strTCRemarks = strTCRemarks & "<br />" & "Fields is not found in Layout"
    End if
    
      
    strTemp="WPFObject(""GridColumnHeader"", """", 3)"
    Set objTemp=objEdgeTree.FindChild("Name",strTemp,50)
    if objTemp.Exists=True then
      if UCASE(objTemp.DataContext.Header)="SERIES NAME" then
        strTCRemarks = strTCRemarks & "<br />" & "Series Name is found in Layout"
        log.Message "Series Name is found in Layout"
      Else
        strTCRemarks = strTCRemarks & "<br />" & "Series Name is not found in Layout"
        log.Message "Series Name is not found in Layout"
      End if 
    else
      strTCRemarks = strTCRemarks & "<br />" & "Fields is not found in Layout"
    End if
    
    strTemp="WPFObject(""GridColumnHeader"", """", 4)"
    Set objTemp=objEdgeTree.FindChild("Name",strTemp,50)
    if objTemp.Exists=True then
      if UCASE(objTemp.DataContext.Header)="SERIES NAME LOCAL" then
        strTCRemarks = strTCRemarks & "<br />" & "Series Name Local is found in Layout"
        log.Message "Series Name Local is found in Layout"
      Else
        strTCRemarks = strTCRemarks & "<br />" & "Series Name Local is not found in Layout"
        log.Message "Series Name Local is not found in Layout"
      End if 
    else
      strTCRemarks = strTCRemarks & "<br />" & "Fields is not found in Layout"
    End if
    
    strTemp="WPFObject(""GridColumnHeader"", """", 5)"
    Set objTemp=objEdgeTree.FindChild("Name",strTemp,50)
    if objTemp.Exists=True then
      if UCASE(objTemp.DataContext.Header)="OUTPUT SERIES NAME" then
        strTCRemarks = strTCRemarks & "<br />" & "Output Series Name is found in Layout"
        log.Message "Output Series Name is found in Layout"
      Else
        strTCRemarks = strTCRemarks & "<br />" & "Output Series Name is not found in Layout"
        log.Message "Output Series Name is not found in Layout"
      End if 
    else
      strTCRemarks = strTCRemarks & "<br />" & "Fields is not found in Layout"
    End if
    
    strTemp="WPFObject(""GridColumnHeader"", """", 6)"
    Set objTemp=objEdgeTree.FindChild("Name",strTemp,50)
    if objTemp.Exists=True then
      if UCASE(objTemp.DataContext.Header)="OUTPUT SERIES NAME LOCAL" then
        strTCRemarks = strTCRemarks & "<br />" & "Output Series Name Local is found in Layout"
        log.Message "Output Series Name Local is found in Layout"
      Else
        strTCRemarks = strTCRemarks & "<br />" & "Output Series Name Local is not found in Layout"
        log.Message "Output Series Name Local is not found in Layout"
      End if 
    else
      strTCRemarks = strTCRemarks & "<br />" & "Fields is not found in Layout"
    End if
    
    strTemp="WPFObject(""GridColumnHeader"", """", 7)"
    Set objTemp=objEdgeTree.FindChild("Name",strTemp,50)
    if objTemp.Exists=True then
      if UCASE(objTemp.DataContext.Header)="SERIES TYPE" then
        strTCRemarks = strTCRemarks & "<br />" & "Series Type is found in Layout"
        log.Message "Series Type is found in Layout"
      Else
        strTCRemarks = strTCRemarks & "<br />" & "Series Type is not found in Layout"
        log.Message "Series Type is not found in Layout"
      End if 
    else
      strTCRemarks = strTCRemarks & "<br />" & "Fields is not found in Layout"
    End if
    
    strTemp="WPFObject(""GridColumnHeader"", """", 8)"
    Set objTemp=objEdgeTree.FindChild("Name",strTemp,50)
    if objTemp.Exists=True then
      if UCASE(objTemp.DataContext.Header)="SERIES FREQ" then
        strTCRemarks = strTCRemarks & "<br />" & "Series Freq is found in Layout"
        log.Message "Series Freq is found in Layout"
      Else
        strTCRemarks = strTCRemarks & "<br />" & "Series Freq is not found in Layout"
        log.Message "Series Freq is not found in Layout"
      End if 
    else
      strTCRemarks = strTCRemarks & "<br />" & "Fields is not found in Layout"
    End if
    
    
    strTemp="WPFObject(""GridColumnHeader"", """", 9)"
    Set objTemp=objEdgeTree.FindChild("Name",strTemp,50)
    if objTemp.Exists=True then
      if UCASE(objTemp.DataContext.Header)="DX FREQUENCY" then
        strTCRemarks = strTCRemarks & "<br />" & "DX Frequency is found in Layout"
        log.Message "DX Frequency is found in Layout"
      Else
        strTCRemarks = strTCRemarks & "<br />" & "DX Frequency is not found in Layout"
        log.Message "DX Frequency is not found in Layout"
      End if 
    else
      strTCRemarks = strTCRemarks & "<br />" & "Fields is not found in Layout"
    End if
    
    strTemp="WPFObject(""GridColumnHeader"", """", 10)"
    Set objTemp=objEdgeTree.FindChild("Name",strTemp,50)
    if objTemp.Exists=True then
      if UCASE(objTemp.DataContext.Header)="UNIT TYPE" then
        strTCRemarks = strTCRemarks & "<br />" & "Unit Type is found in Layout"
        log.Message "Unit Type is found in Layout"
      Else
        strTCRemarks = strTCRemarks & "<br />" & "Unit Type is not found in Layout"
        log.Message "Unit Type is not found in Layout"
      End if 
    else
      strTCRemarks = strTCRemarks & "<br />" & "Fields is not found in Layout"
    End if
    
    strTemp="WPFObject(""GridColumnHeader"", """", 11)"
    Set objTemp=objEdgeTree.FindChild("Name",strTemp,50)
    if objTemp.Exists=True then
      if UCASE(objTemp.DataContext.Header)="DX UNIT" then
        strTCRemarks = strTCRemarks & "<br />" & "Dx Unit is found in Layout"
        log.Message "Dx Unit is found in Layout"
      Else
        strTCRemarks = strTCRemarks & "<br />" & "Dx Unit is not found in Layout"
        log.Message "Dx Unit is not found in Layout"
      End if 
    else
      strTCRemarks = strTCRemarks & "<br />" & "Fields is not found in Layout"
    End if
    
        
    strTemp="WPFObject(""GridColumnHeader"", """", 12)"
    Set objTemp=objEdgeTree.FindChild("Name",strTemp,50)
    if objTemp.Exists=True then
      if UCASE(objTemp.DataContext.Header)="OUTPUT DECIMAL" then
        strTCRemarks = strTCRemarks & "<br />" & "Output Decimal is found in Layout"
        log.Message "Output Decimal is found in Layout"
      Else
        strTCRemarks = strTCRemarks & "<br />" & "Output Decimal is not found in Layout"
        log.Message "Output Decimal is not found in Layout"
      End if 
    else
      strTCRemarks = strTCRemarks & "<br />" & "Fields is not found in Layout"
    End if
    
    strTemp="WPFObject(""GridColumnHeader"", """", 13)"
    Set objTemp=objEdgeTree.FindChild("Name",strTemp,50)
    if objTemp.Exists=True then
      if UCASE(objTemp.DataContext.Header)="OUTPUT UNIT" then
        strTCRemarks = strTCRemarks & "<br />" & "Output Unit is found in Layout"
        log.Message "Output Unit found in Layout"
      Else
        strTCRemarks = strTCRemarks & "<br />" & "Output Unit is not found in Layout"
        log.Message "Output Unit is not found in Layout"
      End if 
    else
      strTCRemarks = strTCRemarks & "<br />" & "Fields is not found in Layout"
    End if
    
    strTemp="WPFObject(""GridColumnHeader"", """", 14)"
    Set objTemp=objEdgeTree.FindChild("Name",strTemp,50)
    if objTemp.Exists=True then
      if UCASE(objTemp.DataContext.Header)="DISABLED FLAG" then
        strTCRemarks = strTCRemarks & "<br />" & "Disabled Flag is found in Layout"
        log.Message "Disabled Flag found in Layout"
      Else
        strTCRemarks = strTCRemarks & "<br />" & "Disabled Flag is not found in Layout"
        log.Message "Disabled Flag is not found in Layout"
      End if 
    else
      strTCRemarks = strTCRemarks & "<br />" & "Fields is not found in Layout"
    End if
   
    
    strTemp="WPFObject(""GridColumnHeader"", """", 15)"
    Set objTemp=objEdgeTree.FindChild("Name",strTemp,50)
    if objTemp.Exists=True then
      if UCASE(objTemp.DataContext.Header)="OUTPUT FLAG" then
        strTCRemarks = strTCRemarks & "<br />" & "Output Flag is found in Layout"
        log.Message "Output Flag found in Layout"
      Else
        strTCRemarks = strTCRemarks & "<br />" & "Output Flag is not found in Layout"
        log.Message "Output Flag is not found in Layout"
      End if 
    else
      strTCRemarks = strTCRemarks & "<br />" & "Fields is not found in Layout"
    End if
    
    objEdgeTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("LayoutSeriesViewControl").WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("LayoutSeriesGridControl").WPFObject("LayoutSeriesTableView")
    strTemp="WPFObject(""GridColumnHeader"", """", 16)"
    Set objTemp=objEdgeTree.FindChild("Name",strTemp,50)
    if objTemp.Exists=True then
      if UCASE(objTemp.DataContext.Header)="Series Status" then
        strTCRemarks = strTCRemarks & "<br />" & "Series Status is found in Layout"
        log.Message "Series Status found in Layout"
      Else
        strTCRemarks = strTCRemarks & "<br />" & "Series Status is not found in Layout"
        log.Message "Series Status is not found in Layout"
      End if 
    else
      strTCRemarks = strTCRemarks & "<br />" & "Fields is not found in Layout"
    End if
    objEdgeTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("LayoutSeriesViewControl").WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("LayoutSeriesGridControl").WPFObject("LayoutSeriesTableView")
    strTemp="WPFObject(""GridColumnHeader"", """", 1))"
    Set objTemp=objEdgeTree.FindChild("Name",strTemp,50)
    if objTemp.Exists=True then
      if UCASE(objTemp.DataContext.Header)="SERIES COUNTRY" then
        strTCRemarks = strTCRemarks & "<br />" & "Series Country is found in Layout"
        log.Message "Series Country is found in Layout"
      Else
        strTCRemarks = strTCRemarks & "<br />" & "Series Country is not found in Layout"
        log.Message "Series Country is not found in Layout"
      End if 
    else
      strTCRemarks = strTCRemarks & "<br />" & "Fields is not found in Layout"
    End if
    set objEdgeTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("LayoutSeriesViewControl").WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("LayoutSeriesGridControl").WPFObject("LayoutSeriesTableView")
    strTemp="WPFObject(""GridColumnHeader"", """", 2)"
    Set objTemp=objEdgeTree.FindChild("Name",strTemp,50)
    if objTemp.Exists=True then
      if UCASE(objTemp.DataContext.Header)="PRIME SOURCE DESCRIPTION" then
        strTCRemarks = strTCRemarks & "<br />" & "Prime Source Description is found in Layout"
        log.Message "Prime Source Description is found in Layout"
      Else
        strTCRemarks = strTCRemarks & "<br />" & "Prime Source Description is not found in Layout"
        log.Message "Prime Source Description is  not found in Layout"
      End if 
    else
      strTCRemarks = strTCRemarks & "<br />" & "Fields is not found in Layout"
    End if
    
    strTemp="WPFObject(""GridColumnHeader"", """", 3)"
    Set objTemp=objEdgeTree.FindChild("Name",strTemp,50)
    if objTemp.Exists=True then
      if UCASE(objTemp.DataContext.Header)="VER" then
        strTCRemarks = strTCRemarks & "<br />" & "VER is found in Layout"
        log.Message "VER is found in Layout"
      Else
        strTCRemarks = strTCRemarks & "<br />" & "VER is not found in Layout"
        log.Message "VER is not found in Layout"
      End if 
    else
      strTCRemarks = strTCRemarks & "<br />" & "Fields is not found in Layout"
    End if
    
    set objEdgeTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("LayoutSeriesViewControl").WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("LayoutSeriesGridControl").WPFObject("LayoutSeriesTableView")
    strTemp="WPFObject(""GridColumnHeader"", """", 4)"
    Set objTemp=objEdgeTree.FindChild("Name",strTemp,50)
    if objTemp.Exists=True then
      if UCASE(objTemp.DataContext.Header)="LAST UPDATED TIME" then
        strTCRemarks = strTCRemarks & "<br />" & "Last Updated Time is found in Layout"
        log.Message "Last Updated Time is found in Layout"
      Else
        strTCRemarks = strTCRemarks & "<br />" & "Last Updated Time is not found in Layout"
        log.Message "Last Updated Time is not found in Layout"
      End if 
    else
      strTCRemarks = strTCRemarks & "<br />" & "Fields is not found in Layout"
    End if
    
    strTemp="WPFObject(""GridColumnHeader"", """", 5)"
    Set objTemp=objEdgeTree.FindChild("Name",strTemp,50)
    if objTemp.Exists=True then
      if UCASE(objTemp.DataContext.Header)="LAST UPDATED USER ID" then
        strTCRemarks = strTCRemarks & "<br />" & "Last Updated User ID is found in Layout"
        log.Message "Last Updated User ID is found in Layout"
      Else
        strTCRemarks = strTCRemarks & "<br />" & "Last Updated User ID is not found in Layout"
        log.Message "Last Updated User ID is not found in Layout"
      End if 
    else
      strTCRemarks = strTCRemarks & "<br />" & "Fields is not found in Layout"
    End if
    
     strTemp="WPFObject(""GridColumnHeader"", """", 6)"
    Set objTemp=objEdgeTree.FindChild("Name",strTemp,50)
    if objTemp.Exists=True then
      if UCASE(objTemp.DataContext.Header)="DISPLAY ORDER" then
        strTCRemarks = strTCRemarks & "<br />" & "Display Order is found in Layout"
        log.Message "Display Order is found in Layout"
      Else
        strTCRemarks = strTCRemarks & "<br />" & "Display Order is not found in Layout"
        log.Message "Display Order is not found in Layout"
      End if 
    else
      strTCRemarks = strTCRemarks & "<br />" & "Fields is not found in Layout"
    End if
    
     strTemp="WPFObject(""GridColumnHeader"", """", 9)"
    Set objTemp=objEdgeTree.FindChild("Name",strTemp,50)
    if objTemp.Exists=True then
      if UCASE(objTemp.DataContext.Header)="SYSTEM ID" then
        strTCRemarks = strTCRemarks & "<br />" & "System ID is found in Layout"
        log.Message "System ID is found in Layout"
      Else
        strTCRemarks = strTCRemarks & "<br />" & "System ID is not found in Layout"
        log.Message "System ID is not found in Layout"
      End if 
    else
      strTCRemarks = strTCRemarks & "<br />" & "Fields is not found in Layout"
    End if    
  else
    strTCRemarks =  "Layout Grid Not found in Layout"
  End if 

End sub

Sub sCheckLayoutRefresh()
On Error Resume Next
    Dim objTemp,strTemp 
    Call sloadlayout
    strTemp="WPFObject(""ContentControlEx"", ""Refresh"", 2)"
    Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 3).WPFObject("BarButtonItemLinkControl", "", 1).FindChild("Name",strTemp,21,True)
    If objTemp.Exists = True then
      objTemp.Click
      Call sEdgeProcessor      
     End If    
End Sub

Sub sCheckLayoutNewLayout(strParameters)
On Error Resume Next
  Dim objEdge,objEdgeFilter
  Dim strLevel1layout,strLevel2layout,strLevel3layout,strWrkSpaceName
  Dim objNewWrkSpace_okbtn,objNewWrkSpace_Name
  Dim objNewWrkSpace_Txtbox,objopenforEdit,objWrkspace_popup
  Dim strTemp,objTemp,intRow,barManager,intTotNodeCnt,Text,objCellText,intI,intJ,intK,strDesc1,strDesc2
  Dim objWrkSpace,objwrkspacepop,objwrkspcUpload,objConfirm,objGridCell,DescLocalText,intSeriesID

  call sLoadlayout  
  strLevel1layout=getSplitValue(strParameters,"LEVEL1LAYOUT")
'  strLevel2layout=getSplitValue(strParameters,"LEVEL2LAYOUT")  
'  strLevel3layout=getSplitValue(strParameters,"LEVEL3LAYOUT") 
  call sCheckLayoutLevelExpandTree(strParameters)
  set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("LayoutTreeControl").WPFObject("LayoutTreeListView").WPFObject("HierarchyPanel", "", 1).WPFObject("RowControl", "", 2).WPFObject("CellsControl", "", 1).WPFObject("LightweightCellEditor", "", 3)
  strTemp="WPFObject(""InplaceBaseEdit"", """", 1)"
  Set objTemp=objEdge.FindChild("Name",strTemp,50)
  If objTemp.Exists=True then 
    IF objTemp.DisplayText="Checked" then
      'set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 4).WPFObject("BarButtonItemLinkControl", "", 1).WPFObject("ContentControlEx", "New Layout Topic", 2)
      set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1)
      strTemp="WPFObject(""ContentControlEx"", ""New Layout Topic"", 2)"
      Set objTemp=objEdge.FindChild("Name",strTemp,50)
        If objTemp.Exists=True then
          If objTemp.Enabled=True then
            strTCRemarks = "New Layout Topic Button is found in Layout"
            log.Message "New Layout Topic Button is found in Layout"
            objTemp.Click
         else
            strTCRemarks = "New Layout Topic Button is Disabled in Layout"
            log.Message "New Layout Topic Button is Disabled in Layout"
          End if
        else
          strTCRemarks =  "New Layout Topic Button is Not found in Layout"
        End if 
    Else
        strTCRemarks =  "Edit is Not Checked in Layout"
        log.Message "Edit is Not Checked in Layout"
    End if
  End if
End Sub

Sub sCheckLayoutNewLayoutTopic(strParameters)
On Error Resume Next
  Dim objEdge,objEdgeFilter
  Dim strLevel1layout,strLevel2layout,strLevel3layout,strWrkSpaceName
  Dim objNewWrkSpace_okbtn,objNewWrkSpace_Name
  Dim objNewWrkSpace_Txtbox,objopenforEdit,objWrkspace_popup
  Dim strTemp,objTemp,intRow,barManager,intTotNodeCnt,Text,objCellText,intl,intK,strDesc1,strDesc2
  Dim objWrkSpace,objwrkspacepop,objwrkspcUpload,objConfirm,objGridCell,DescLocalText,intSeriesID

  strLevel1layout=getSplitValue(strParameters,"LEVEL1LAYOUT")
  strLevel2layout=getSplitValue(strParameters,"LEVEL2LAYOUT")  
  strLevel3layout=getSplitValue(strParameters,"LEVEL3LAYOUT") 
  
  Call sloadlayout 
  call sCheckLayoutLevelExpandTree(strParameters)
  
  set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("LayoutTreeControl").WPFObject("LayoutTreeListView").WPFObject("HierarchyPanel", "", 1).WPFObject("RowControl", "", 2).WPFObject("CellsControl", "", 1).WPFObject("LightweightCellEditor", "", 3)
  strTemp="WPFObject(""InplaceBaseEdit"", """", 1)"
  Set objTemp=objEdge.FindChild("Name",strTemp,50)
  If objTemp.Exists=True then 
    IF objTemp.DisplayText="Checked" then
      set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1)
      strTemp="WPFObject(""ContentControlEx"", ""New Layout Topic"", 2)"
      Set objTemp=objEdge.FindChild("Name",strTemp,50)
        If objTemp.Exists=True then
          If objTemp.Enabled=True then
            strTCRemarks = "New Layout Topic Button is found in Layout"
            log.Message "New Layout Topic Button is found in Layout"
            objTemp.Click
            Call sNewLayoutDescMandatoryFields()
          else
            strTCRemarks = "New Layout Topic Button is Disabled in Layout"
            log.Message "New Layout Topic Button is Disabled in Layout"
          End if
        else
          strTCRemarks =  "New Layout Topic Button is Not found in Layout"
        End if 
    Else
        strTCRemarks =  "Edit is Not Checked in Layout"
        log.Message "Edit is Not Checked in Layout"
    End if
  End if
End Sub
Sub sCheckViewWorkspaceLayout(strParameters)
On Error Resume Next
    Dim objEdge,objEdgeFilter
    Dim strLevel1layout,strLevel2layout,strLevel3layout,strWrkSpaceName
    Dim objNewWrkSpace_okbtn,objNewWrkSpace_Name
    Dim objNewWrkSpace_Txtbox,objopenforEdit,objWrkspace_popup
    Dim strTemp,objTemp,intRow,barManager,intTotNodeCnt,Text,objCellText,intl,intK,strDesc1,strDesc2
    Dim objWrkSpace,objwrkspacepop,objwrkspcUpload,objConfirm,objGridCell,DescLocalText,intSeriesID

    Call sloadLayout
    Call sCheckLayoutExpandTree(strParameters)
    strLevel1layout=getSplitValue(strParameters,"LEVEL1LAYOUT")
    strLevel2layout=getSplitValue(strParameters,"LEVEL2LAYOUT")  
    'strLevel3layout=getSplitValue(strParameters,"LEVEL3LAYOUT") 
    
'    strLevel1layout="dX Non-Asia Database (Current Eng Version)"
'    strLevel2layout="Z-Testing Topic(IT-use only)" 
    'strLevel3layout="Sandbox (Benny)"

     Delay 3000,"Please Wait..."
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("LayoutTreeControl").WPFObject("LayoutTreeListView")
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("LayoutTreeControl")

    Delay 1000,"Please Wait..."
    ''Selecting Level1 layout
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strLevel1layout) then
          GridControl.Nodes_2.Item(intI).Expand(True)
          log.Message "Level 1 Layout - " & GridControl.Nodes_2.Item(intI).Content.Description      
          blnFlag=False  
          Exit For
        End If
    Next
    Delay 3000,"Please Wait..."
    If blnFlag = True then
      strTCRemarks="Level 1 Layout not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
    
    blnFlag = True 
    ''Selecting Level2 Layout
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
    For intJ=0 to intTotNodeCnt-1
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strLevel2layout) then
        'GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
        log.Message "Level2 layout Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description 
          intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
''          GridControl.set_FocusedRowHandle(intRow)
''          GridControl.Keys("[Down]")
''          GridControl.Keys("[Up]")  

          GridControl.set_FocusedRowHandle(intRow)
          GridControl.set_FocusedRowData(intRow)
          delay(1000)
          GridControl.Keys("[Down]")
          GridControl.Keys("[Up]")
        blnFlag = False 
        Exit For
      End If
    Next
    If blnFlag = True then
      strTCRemarks="Level2 Source Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
    
     set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("LayoutTreeControl").WPFObject("LayoutTreeListView").WPFObject("HierarchyPanel", "", 1).WPFObject("RowControl", "", 2).WPFObject("CellsControl", "", 1).WPFObject("LightweightCellEditor", "", 3)
     strTemp="WPFObject(""InplaceBaseEdit"", """", 1)"
     Set objTemp=objEdge.FindChild("Name",strTemp,50)
    If objTemp.Exists=True then 
      IF objTemp.DisplayText="Checked" then
        strTemp="WPFObject(""ArrowControl"", """", 1)"
        Set objNewWorkspace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarSubItemLinkControl", "", 1).FindChild("Name",strTemp,2,True)
        If objNewWorkspace.Exists = True then
          IF objNewWorkspace.Enabled = True then
            objNewWorkspace.Click
            strTemp="WPFObject(""BarPopupBorderControl"", """", 1)"
            Set objWrkspace_popup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").FindChild("Name",strTemp,50,True)
            If objWrkspace_popup.Exists = True then
              strTemp="WPFObject(""ContentControlEx"", ""Open For View"", 2)"
              Set objTemp=objWrkspace_popup.FindChild("Name",strTemp,8,True)
              If objTemp.Exists = True then
                If objTemp.Enabled=True then
                  strTCRemarks = "Open For View is found in Layout"
                  log.Message "Open For View is found in Layout"
                else
                  strTCRemarks = "Open For View  is Disabled in Layout"
                  log.Message "Open For View is Disabled in Layout"
                End if
              else
                  strTCRemarks = "Open For View  is Not found in Layout"
                  log.Message "Open For View is Not found in Layout"
              End If
              strTemp="WPFObject(""ContentControlEx"", ""Open For Edit"", 2)"
              Set objTemp=objWrkspace_popup.FindChild("Name",strTemp,8,True)
              If objTemp.Exists = True then
                If objTemp.Enabled=True then
                  strTCRemarks = "Open For Edit is found in Layout"
                  log.Message "Open For Edit is found in Layout"
                else
                  strTCRemarks = "Open For Edit  is Disabled in Layout"
                  log.Message "Open For Edit is Disabled in Layout"
                End if
              else
                  strTCRemarks = "Open For Edit  is Not found in Layout"
                  log.Message "Open For Edit is Not found in Layout"
              End If

            End IF
              strTCRemarks = "New Workspace button is Not Disabled in Layout"
              log.Message "New Workspace button is Not found in Layout"
          End if
        Else
              strTCRemarks = "New workspace button is not found in Layout"
              log.Message "New Workspace button is not found in Layout"
        End if
      Else
        strTCRemarks = "Edit is unchecked in Layout"
        log.Message "Edit is unchecked in Layout"
        strTemp="WPFObject(""ArrowControl"", """", 1)"
        Set objNewWorkspace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarSubItemLinkControl", "", 1).FindChild("Name",strTemp,2,True)
        If objNewWorkspace.Exists = True then
          IF objNewWorkspace.Enabled = True then
            objNewWorkspace.Click
            strTemp="WPFObject(""BarPopupBorderControl"", """", 1)"
            Set objWrkspace_popup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").FindChild("Name",strTemp,50,True)
            If objWrkspace_popup.Exists = True then
              strTemp="WPFObject(""ContentControlEx"", ""Open For View"", 2)"
              Set objTemp=objWrkspace_popup.FindChild("Name",strTemp,8,True)
              If objTemp.Exists = True then
                If objTemp.Enabled=True then
                  strTCRemarks = "Open For View is found in Layout"
                  log.Message "Open For View is found in Layout"
                else
                  strTCRemarks = "Open For View  is Disabled in Layout"
                  log.Message "Open For View is Disabled in Layout"
                End if
              else
                  strTCRemarks = "Open For View  is Not found in Layout"
                  log.Message "Open For View is Not found in Layout"
              End If
              strTemp="WPFObject(""ContentControlEx"", ""Open For Edit"", 2)"
              Set objTemp=objWrkspace_popup.FindChild("Name",strTemp,8,True)
              If objTemp.Exists = True then
                If objTemp.Enabled=True then
                  strTCRemarks = "Open For Edit is found in Layout"
                  log.Message "Open For Edit is found in Layout"
                else
                  strTCRemarks = "Open For Edit  is Disabled in Layout"
                  log.Message "Open For Edit is Disabled in Layout"
                End if
              else
                  strTCRemarks = "Open For Edit  is Not found in Layout"
                  log.Message "Open For Edit is Not found in Layout"
              End If

            End If
          else
              strTCRemarks = "New Workspace button is Not Disabled in Layout"
              log.Message "New Workspace button is Not found in Layout"
          End if
      End if 
    End if 
    End if
     call scloseLayout 
End Sub

Sub sCheckLayoutFindButton()
Dim objEdge
  set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("LayoutTreeControl").WPFObject("LayoutTreeListView")
    If objEdge.Exists=True then
      IF objEdge.ShowSearchPanelFindButton=True then
        strTCRemarks = "Find button with text box is found in Layout"
        log.Message "Find button with text box is found in Layout"
      End if 
    End if
End sub

Sub sCheckLayoutPopup()
On Error Resume Next
    Dim objEdge,objEdgeFilter
    Dim strLevel1layout,strLevel2layout,strLevel3layout,strWrkSpaceName
    Dim objNewWrkSpace_okbtn,objNewWrkSpace_Name
    Dim objNewWrkSpace_Txtbox,objopenforEdit,objWrkspace_popup
    Dim strTemp,objTemp,intRow,barManager,intTotNodeCnt,Text,objCellText,intl,intK,strDesc1,strDesc2
    Dim objWrkSpace,objwrkspacepop,objwrkspcUpload,objConfirm,objGridCell,DescLocalText,intSeriesID

    
'    strLevel1layout=getSplitValue(strParameters,"LEVEL1LAYOUT")
'    strLevel2layout=getSplitValue(strParameters,"LEVEL2LAYOUT")  
'    strLevel3layout=getSplitValue(strParameters,"LEVEL3LAYOUT") 
    
   strLevel1layout="dX Non-Asia Database (Current Eng Version)"
    'strLevel2layout="Z-Testing Topic(IT-use only)"
    'strLevel3layout="Sandbox (Benny)"

     Delay 3000,"Please Wait..."
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("LayoutTreeControl").WPFObject("LayoutTreeListView")
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("LayoutTreeControl")

    Delay 1000,"Please Wait..."
    ''Selecting Level1 layout
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strLevel1layout) then
          log.Message "Level 1 Layout - " & GridControl.Nodes_2.Item(intI).Content.Description   
          intRow=GridControl.Nodes_2.Item(intI).get_RowHandle
          Call GridControl.ClearSelectionCore
          Call GridControl.FocusViewAndRow(GridControl,intRow)
          GridControl.SetFocusOnCurrentItem
          Call GridControl.SelectRowCore(intRow)
          blnFlag=False  
          Exit For
        End If
    Next
    Delay 3000,"Please Wait..."
    If blnFlag = True then
      strTCRemarks="Level 1 Layout not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
    'call GridControl.ClickR(83, 10)
    delay(5000)
   ' set objEdgeFilter= Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("LayoutTreeControl").WPFObject("LayoutTreeListView")
  strTemp=" WPFObject(""EditorControlStub"", """", 1)"
  Set objTemp=GridControl.FindChild("Name",strTemp,5)
    If objTemp.Exists = TRUE then
    objTemp.ClickR
    delay(3000)
    set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarSubItemLinkControl", "", 1)
    strTemp="WPFObject(""ContentControlEx"", ""New Workspace"", 2)"
    Set objTemp=objEdge.FindChild("Name",strTemp,50)
    If objTemp.Exists=True then
      If objTemp.Enabled=True then
        strTCRemarks = "New Workspace Button is found in Layout"
        log.Message "New Workspace Button is found in Layout"
      Else
        strTCRemarks = "New Workspace Button is Disabled in Layout"
        log.Message "New Workspace Button is Disabled in Layout"
      End if
    End if
    End if 
  
    
   
'  set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("LayoutTreeControl").WPFObject("LayoutTreeListView").WPFObject("HierarchyPanel", "", 1).WPFObject("RowControl", "", 2).WPFObject("CellsControl", "", 1).WPFObject("LightweightCellEditor", "", 3)
'  strTemp="WPFObject(""InplaceBaseEdit"", """", 1)"
'  Set objTemp=objEdge.FindChild("Name",strTemp,50)
'  If objTemp.Exists=True then 
'    IF objTemp.DisplayText="Checked" then
'      set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1)
'      strTemp="WPFObject(""ContentControlEx"", ""New Layout Topic"", 2)"
'      Set objTemp=objEdge.FindChild("Name",strTemp,50)
'        If objTemp.Exists=True then
'          If objTemp.Enabled=True then
'            strTCRemarks = "New Layout Topic Button is found in Layout"
'            log.Message "New Layout Topic Button is found in Layout"
'          else
'            strTCRemarks = "New Layout Topic Button is Disabled in Layout"
'            log.Message "New Layout Topic Button is Disabled in Layout"
'          End if
'        else
'          strTCRemarks =  "New Layout Topic Button is Not found in Layout"
'        End if 
'    Else
'        strTCRemarks =  "Edit is Not Checked in Layout"
'        log.Message "Edit is Not Checked in Layout"
'    End if
'  End if

End Sub

Sub sCheckLayoutFileRepository()
On Error Resume Next
  Dim objEdge,strTemp,objTemp,objEdgeFilter
  set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1)
  strTemp="WPFObject(""ContentControlEx"", ""File Repository"", 2)"
  Set objTemp=objEdge.FindChild("Name",strTemp,50)
  If objTemp.Exists=True then
    strTCRemarks = "File Repository Button is found in Layout"
    log.Message "File Repository Button is found in Layout"
    objTemp.Click
    set objEdgeFilter= Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarButtonItemLinkControl", "", 1)
    strTemp="WPFObject(""ContentControlEx"", ""File Repository Usage"", 2)"
    Set objTemp=objEdgeFilter.FindChild("Name",strTemp,50)
    If objTemp.Exists = TRUE then
      strTCRemarks = strTCRemarks & "<br />" & "File Repository Usage Button is found in Layout"
      log.Message "File Repository Usage Button is found in Layout"
    Else
      strTCRemarks = strTCRemarks & "<br />" & "File Repository Usage Button is not found in Layout"
      log.Message "File Repository Usage Button is not found in Layout"
    End If
    
    set objEdgeFilter= Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarButtonItemLinkControl", "", 1)
    strTemp="WPFObject(""ContentControlEx"", ""Add New Link"", 2)"
    Set objTemp=objEdgeFilter.FindChild("Name",strTemp,50)
    If objTemp.Exists = TRUE then
      strTCRemarks = strTCRemarks & "<br />" & "Add New Link Button is found in Layout"
      log.Message "Add New Link Button is found in Layout"
    Else
      strTCRemarks = strTCRemarks & "<br />" & "Add New Link Button is not found in Layout"
      log.Message "Add New Link Button is not found in Layout"
    End If
    set objEdgeFilter= Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarButtonItemLinkControl", "", 1)
    strTemp="WPFObject(""ContentControlEx"", ""Refresh Attachment Status"", 2)"
    Set objTemp=objEdgeFilter.FindChild("Name",strTemp,50)
    If objTemp.Exists = TRUE then
      strTCRemarks = strTCRemarks & "<br />" & "Refresh Attachment Status Button is found in Layout"
      log.Message "Refresh Attachment Status Button is found in Layout"
    Else
      strTCRemarks = strTCRemarks & "<br />" & "Refresh Attachment Status Button is not found in Layout"
      log.Message "Refresh Attachment Status Button is not found in Layout"
    End If
    
    set objEdgeFilter= Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarButtonItemLinkControl", "", 1)
    strTemp="WPFObject(""ContentControlEx"", ""Show / Hide Attachment Status"", 2)"
    Set objTemp=objEdgeFilter.FindChild("Name",strTemp,50)
    If objTemp.Exists = TRUE then
      strTCRemarks = strTCRemarks & "<br />" & "Show / Hide Attachment Status Button is found in Layout"
      log.Message "Show / Hide Attachment Status Button is found in Layout"
    Else
      strTCRemarks = strTCRemarks & "<br />" & "Show / Hide Attachment Status Button is not found in Layout"
      log.Message "Show / Hide Attachment Status Button is not found in Layout"
    End If
  else
    strTCRemarks =  "File Repository Button is Not found in Layout"
  End if 
End Sub

Sub sNewLayoutTopicPromptWindow()
  On Error Resume Next
  Dim objEdgeFilter
  set objEdgeFilter= Sys.Process("EdgeClient").WPFObject("HwndSource: NewLayoutTopicPrompt", "New Layout (Level 2)").WPFObject("NewLayoutTopicPrompt", "New Layout (Level 2)", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder")
  strTemp="WPFObject(""FloatingContainerBackground"")"
  Set objTemp=objEdgeFilter.FindChild("Name",strTemp,50)
    If objTemp.Exists = TRUE then
        set objEdgeFilter= Sys.Process("EdgeClient").WPFObject("HwndSource: NewLayoutTopicPrompt", "New Layout (Level 2)").WPFObject("NewLayoutTopicPrompt", "New Layout (Level 2)", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 1)
        strTemp="WPFObject(""Label"", ""Database:"", 1)"
        Set objTemp=objEdgeFilter.FindChild("Name",strTemp,50)
        If objTemp.Exists = TRUE then
          strTCRemarks = strTCRemarks & "<br />" & "Database is found in Layout"
          log.Message "Database is found in Layout"
        Else
          strTCRemarks = strTCRemarks & "<br />" & "Database is not found in Layout"
          log.Message "Database is not found in Layout"
        End If
      
        set objEdgeFilter= Sys.Process("EdgeClient").WPFObject("HwndSource: NewLayoutTopicPrompt", "New Layout (Level 2)").WPFObject("NewLayoutTopicPrompt", "New Layout (Level 2)", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 2)
        strTemp="WPFObject(""Label"", ""Layout Description:"", 1)"
        Set objTemp=objEdgeFilter.FindChild("Name",strTemp,50)
        If objTemp.Exists = TRUE then
          strTCRemarks = strTCRemarks & "<br />" & "Layout Description is found in Layout"
          log.Message "Layout Description is found in Layout"
        Else
          strTCRemarks = strTCRemarks & "<br />" & "Layout Description is not found in Layout"
          log.Message "Layout Description is not found in Layout"
        End If
      
        set objEdgeFilter= Sys.Process("EdgeClient").WPFObject("HwndSource: NewLayoutTopicPrompt", "New Layout (Level 2)").WPFObject("NewLayoutTopicPrompt", "New Layout (Level 2)", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 3)
        strTemp="WPFObject(""Label"", ""Layout Description Local:"", 1)"
        Set objTemp=objEdgeFilter.FindChild("Name",strTemp,50)
        If objTemp.Exists = TRUE then
          strTCRemarks = strTCRemarks & "<br />" & "Layout Description Local is found in Layout"
          log.Message "Layout Description Local is found in Layout"
        Else
          strTCRemarks = strTCRemarks & "<br />" & "Layout Description Local is not found in Layout"
          log.Message "Layout Description Local is not found in Layout"
        End If
      
        set objEdgeFilter= Sys.Process("EdgeClient").WPFObject("HwndSource: NewLayoutTopicPrompt", "New Layout (Level 2)").WPFObject("NewLayoutTopicPrompt", "New Layout (Level 2)", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 4)
        strTemp="WPFObject(""Label"", ""Disabled Flag:"", 1)"
        Set objTemp=objEdgeFilter.FindChild("Name",strTemp,50)
        If objTemp.Exists = TRUE then
          strTCRemarks = strTCRemarks & "<br />" & "Disabled Flag is found in Layout"
          log.Message "Disabled Flag is found in Layout"
        Else
          strTCRemarks = strTCRemarks & "<br />" & "Disabled Flag is not found in Layout"
          log.Message "Disabled Flag is not found in Layout"
        End If
     
        set objEdgeFilter= Sys.Process("EdgeClient").WPFObject("HwndSource: NewLayoutTopicPrompt", "New Layout (Level 2)").WPFObject("NewLayoutTopicPrompt", "New Layout (Level 2)", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 5)
        strTemp="WPFObject(""Label"", ""Output Flag:"", 1)"
        Set objTemp=objEdgeFilter.FindChild("Name",strTemp,50)
        If objTemp.Exists = TRUE then
          strTCRemarks = strTCRemarks & "<br />" & "Output Flag is found in Layout"
          log.Message "Output Flag is found in Layout"
        Else
          strTCRemarks = strTCRemarks & "<br />" & "Output Flag is not found in Layout"
          log.Message "Output Flag is not found in Layout"
        End If
      
        set objEdgeFilter= Sys.Process("EdgeClient").WPFObject("HwndSource: NewLayoutTopicPrompt", "New Layout (Level 2)").WPFObject("NewLayoutTopicPrompt", "New Layout (Level 2)", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 6)
        strTemp="WPFObject(""Label"", ""Insert Layout After:"", 1)"
        Set objTemp=objEdgeFilter.FindChild("Name",strTemp,50)
        If objTemp.Exists = TRUE then
          strTCRemarks = strTCRemarks & "<br />" & "Insert Layout After is found in Layout"
          log.Message "Insert Layout After is found in Layout"
        Else
          strTCRemarks = strTCRemarks & "<br />" & "Insert Layout After is not found in Layout"
          log.Message "Insert Layout After is not found in Layout"
        End If
      
        set objEdgeFilter= Sys.Process("EdgeClient").WPFObject("HwndSource: NewLayoutTopicPrompt", "New Layout (Level 2)").WPFObject("NewLayoutTopicPrompt", "New Layout (Level 2)", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1)
        strTemp="WPFObject(""Button"", ""Save"", 1)"
        Set objTemp=objEdgeFilter.FindChild("Name",strTemp,50)
        If objTemp.Exists = TRUE then
          strTCRemarks = strTCRemarks & "<br />" & "Save button found in Layout"
          log.Message "Save  button found in Layout"
        Else
          strTCRemarks = strTCRemarks & "<br />" & "Save button is not found in Layout"
          log.Message "Save button is not found in Layout"
        End If
      
        set objEdgeFilter= Sys.Process("EdgeClient").WPFObject("HwndSource: NewLayoutTopicPrompt", "New Layout (Level 2)").WPFObject("NewLayoutTopicPrompt", "New Layout (Level 2)", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1)
        strTemp="WPFObject(""Button"", ""Cancel"", 2)"
        Set objTemp=objEdgeFilter.FindChild("Name",strTemp,50)
        If objTemp.Exists = TRUE then
          strTCRemarks = strTCRemarks & "<br />" & "Cancel button is found in Layout"
          log.Message "Cancel buttonis found in Layout"
        Else
          strTCRemarks = strTCRemarks & "<br />" & "Cancel button is not found in Layout"
          log.Message "Cancel button is not found in Layout"
        End If 
      Else
      End if 
    ' Sys.Process("EdgeClient").WPFObject("HwndSource: NewLayoutTopicPrompt", "New Layout (Level 2)").WPFObject("NewLayoutTopicPrompt", "New Layout (Level 2)", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("PART_Header").WPFObject("Grid", "", 1).WPFObject("stackPanel").WPFObject("PART_CloseButton")
End Sub

Sub sCloseNewLayoutTopicPrompt()
  On Error Resume Next
  Dim objEdgeFilter  
  set objEdgeFilter= Sys.Process("EdgeClient").WPFObject("HwndSource: NewLayoutTopicPrompt", "New Layout (Level 2)").WPFObject("NewLayoutTopicPrompt", "New Layout (Level 2)", 1)
  strTemp="WPFObject(""PART_ContainerContent"")"
  Set objTemp=objEdgeFilter.FindChild("Name",strTemp,50)
    If objTemp.Exists = TRUE then
      set objEdgeFilter= Sys.Process("EdgeClient").WPFObject("HwndSource: NewLayoutTopicPrompt", "New Layout (Level 2)").WPFObject("NewLayoutTopicPrompt", "New Layout (Level 2)", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("PART_Header").WPFObject("Grid", "", 1).WPFObject("stackPanel")
      strTemp="WPFObject(""PART_CloseButton"")"
      Set objTemp=objEdgeFilter.FindChild("Name",strTemp,50)
      If objTemp.Exists = TRUE then
        strTCRemarks = strTCRemarks & "<br />" & "Close button is found in Layout"
        log.Message "Close button is found in Layout"
        objTemp.Click
      Else
        strTCRemarks = strTCRemarks & "<br />" & "Close button is not found in Layout"
        log.Message "Close button is not found in Layout"
      End If
  End if
End Sub

Sub sNewLayoutTopicPromptButton()
  On Error Resume Next
  Dim objEdgeFilter
  set objEdgeFilter= Sys.Process("EdgeClient").WPFObject("HwndSource: NewLayoutTopicPrompt", "New Layout (Level 2)").WPFObject("NewLayoutTopicPrompt", "New Layout (Level 2)", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder")
  strTemp="WPFObject(""PART_ContainerContent"")"
  Set objTemp=objEdgeFilter.FindChild("Name",strTemp,50)
    If objTemp.Exists = TRUE then
        set objEdgeFilter= Sys.Process("EdgeClient").WPFObject("HwndSource: NewLayoutTopicPrompt", "New Layout (Level 2)").WPFObject("NewLayoutTopicPrompt", "New Layout (Level 2)", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1)
        strTemp="WPFObject(""Button"", ""Save"", 1)"
        Set objTemp=objEdgeFilter.FindChild("Name",strTemp,50)
        If objTemp.Exists = TRUE then
          strTCRemarks = strTCRemarks & "<br />" & "Save button found in Layout"
          log.Message "Save  button found in Layout"
        Else
          strTCRemarks = strTCRemarks & "<br />" & "Save button is not found in Layout"
          log.Message "Save button is not found in Layout"
        End If
      
        set objEdgeFilter= Sys.Process("EdgeClient").WPFObject("HwndSource: NewLayoutTopicPrompt", "New Layout (Level 2)").WPFObject("NewLayoutTopicPrompt", "New Layout (Level 2)", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1)
        strTemp="WPFObject(""Button"", ""Cancel"", 2)"
        Set objTemp=objEdgeFilter.FindChild("Name",strTemp,50)
        If objTemp.Exists = TRUE then
          strTCRemarks = strTCRemarks & "<br />" & "Cancel button is found in Layout"
          log.Message "Cancel buttonis found in Layout"
        Else
          strTCRemarks = strTCRemarks & "<br />" & "Cancel button is not found in Layout"
          log.Message "Cancel button is not found in Layout"
        End If 
      Else
        strTCRemarks = strTCRemarks & "<br />" & "Cancel button is not found in Layout"
        log.Message "Cancel button is not found in Layout"
      End if       
End Sub
Sub sNewLayoutOutputMandatoryFields()
  On Error Resume Next
  Dim objEdgeFilter
  set objEdgeFilter= Sys.Process("EdgeClient").WPFObject("HwndSource: NewLayoutTopicPrompt", "New Layout (Level 2)").WPFObject("NewLayoutTopicPrompt", "New Layout (Level 2)", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder")
  strTemp="WPFObject(""PART_ContainerContent"")"
  Set objTemp=objEdgeFilter.FindChild("Name",strTemp,50)
    If objTemp.Exists = TRUE then
        set objEdgeFilter= Sys.Process("EdgeClient").WPFObject("HwndSource: NewLayoutTopicPrompt", "New Layout (Level 2)").WPFObject("NewLayoutTopicPrompt", "New Layout (Level 2)", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 2)
        strTemp="WPFObject(""TextEdit"", """", 1)"
        Set objTemp=objEdgeFilter.FindChild("Name",strTemp,50)
        If objTemp.Exists = TRUE then   
          objTemp.keys("T1")
          set objEdgeFilter= Sys.Process("EdgeClient").WPFObject("HwndSource: NewLayoutTopicPrompt", "New Layout (Level 2)").WPFObject("NewLayoutTopicPrompt", "New Layout (Level 2)", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1)
          strTemp="WPFObject(""Button"", ""Save"", 1)"
          Set objTemp=objEdgeFilter.FindChild("Name",strTemp,50)
          If objTemp.Exists = TRUE then
            objTemp.Click 
            set objEdgeFilter= Sys.Process("EdgeClient").WPFObject("HwndSource: NewLayoutTopicPrompt", "New Layout (Level 2)").WPFObject("NewLayoutTopicPrompt", "New Layout (Level 2)", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1)
            strTemp="WPFObject(""Label"", ""Output Flag must have an selected item"", 1)"
            Set objTemp=objEdgeFilter.FindChild("Name",strTemp,50)
            If objTemp.Exists = TRUE then
              if objTemp.Content="Output Flag must have an selected item" then
                strTCRemarks = strTCRemarks & "<br />" & "Output Flag must have an selected item"
                log.Message "Output Flag must have an selected item" 
              End if
            End If 
          End if
        End if  
    End if       
End Sub
Sub sNewLayoutDescMandatoryFields()
  On Error Resume Next
  Dim objEdgeFilter
  set objEdgeFilter= Sys.Process("EdgeClient").WPFObject("HwndSource: NewLayoutTopicPrompt", "New Layout (Level 2)").WPFObject("NewLayoutTopicPrompt", "New Layout (Level 2)", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder")
  strTemp="WPFObject(""PART_ContainerContent"")"
  Set objTemp=objEdgeFilter.FindChild("Name",strTemp,50)
    If objTemp.Exists = TRUE then
        set objEdgeFilter= Sys.Process("EdgeClient").WPFObject("HwndSource: NewLayoutTopicPrompt", "New Layout (Level 2)").WPFObject("NewLayoutTopicPrompt", "New Layout (Level 2)", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 5)
        strTemp="WPFObject(""ComboBoxEdit"", """", 1)"
        Set objTemp=objEdgeFilter.FindChild("Name",strTemp,50)
        If objTemp.Exists = TRUE then   
          objTemp.Keys("[Down]")
          set objEdgeFilter= Sys.Process("EdgeClient").WPFObject("HwndSource: NewLayoutTopicPrompt", "New Layout (Level 2)").WPFObject("NewLayoutTopicPrompt", "New Layout (Level 2)", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1)
          strTemp="WPFObject(""Button"", ""Save"", 1)"
          Set objTemp=objEdgeFilter.FindChild("Name",strTemp,50)
          If objTemp.Exists = TRUE then
            objTemp.Click 
            set objEdgeFilter= Sys.Process("EdgeClient").WPFObject("HwndSource: NewLayoutTopicPrompt", "New Layout (Level 2)").WPFObject("NewLayoutTopicPrompt", "New Layout (Level 2)", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1)
            strTemp="WPFObject(""Label"", ""Description cannot be empty. Please fill in."", 1)"
            Set objTemp=objEdgeFilter.FindChild("Name",strTemp,50)
            If objTemp.Exists = TRUE then
              if objTemp.Content="Description cannot be empty. Please fill in" then
                strTCRemarks = strTCRemarks & "<br />" & "Description cannot be empty"
                log.Message "Description cannot be empty" 
              End if
              'Sys.Process("EdgeClient").WPFObject("HwndSource: NewLayoutTopicPrompt", "New Layout (Level 2)").WPFObject("NewLayoutTopicPrompt", "New Layout (Level 2)", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("Button", "Cancel", 2).Click
            End If 
          End if
        End if  
    End if       
End Sub
Sub sNewLayoutSecondLevel()
  On Error Resume Next
  Dim objEdgeFilter
  set objEdgeFilter= Sys.Process("EdgeClient").WPFObject("HwndSource: NewLayoutTopicPrompt", "New Layout (Level 2)").WPFObject("NewLayoutTopicPrompt", "New Layout (Level 2)", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder")
  strTemp="WPFObject(""PART_ContainerContent"")"
  Set objTemp=objEdgeFilter.FindChild("Name",strTemp,50)
    If objTemp.Exists = TRUE then
         set objEdgeFilter= Sys.Process("EdgeClient").WPFObject("HwndSource: NewLayoutTopicPrompt", "New Layout (Level 2)").WPFObject("NewLayoutTopicPrompt", "New Layout (Level 2)", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 2)
        strTemp="WPFObject(""TextEdit"", """", 1)"
        Set objTemp=objEdgeFilter.FindChild("Name",strTemp,50)
        If objTemp.Exists = TRUE then   
          objTemp.keys("T1")
        End if
        set objEdgeFilter= Sys.Process("EdgeClient").WPFObject("HwndSource: NewLayoutTopicPrompt", "New Layout (Level 2)").WPFObject("NewLayoutTopicPrompt", "New Layout (Level 2)", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 5)
        strTemp="WPFObject(""ComboBoxEdit"", """", 1)"
        Set objTemp=objEdgeFilter.FindChild("Name",strTemp,50)
        If objTemp.Exists = TRUE then   
          objTemp.Keys("[Down]")
          set objEdgeFilter= Sys.Process("EdgeClient").WPFObject("HwndSource: NewLayoutTopicPrompt", "New Layout (Level 2)").WPFObject("NewLayoutTopicPrompt", "New Layout (Level 2)", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1)
          strTemp="WPFObject(""Button"", ""Save"", 1)"
          Set objTemp=objEdgeFilter.FindChild("Name",strTemp,50)
          If objTemp.Exists = TRUE then
            objTemp.Click 
            call sEdgeprocessor
          End if
        End if  
    End if       
End Sub
Sub sNewLayoutCancel()
  On Error Resume Next
  Dim objEdgeFilter
  set objEdgeFilter= Sys.Process("EdgeClient").WPFObject("HwndSource: NewLayoutTopicPrompt", "New Layout (Level 2)").WPFObject("NewLayoutTopicPrompt", "New Layout (Level 2)", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder")
  strTemp="WPFObject(""PART_ContainerContent"")"
  Set objTemp=objEdgeFilter.FindChild("Name",strTemp,50)
    If objTemp.Exists = TRUE then
        set objEdgeFilter= Sys.Process("EdgeClient").WPFObject("HwndSource: NewLayoutTopicPrompt", "New Layout (Level 2)").WPFObject("NewLayoutTopicPrompt", "New Layout (Level 2)", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1)
        strTemp="WPFObject(""Button"", ""Cancel"", 2)"
        Set objTemp=objEdgeFilter.FindChild("Name",strTemp,50)
        If objTemp.Exists = TRUE then
          objTemp.Click
          strTCRemarks = strTCRemarks & "<br />" & "NewLayoutTopic"
          log.Message "Cancel buttonis found in Layout"
        Else
          strTCRemarks = strTCRemarks & "<br />" & "Cancel button is not found in Layout"
          log.Message "Cancel button is not found in Layout"
        End If 
      Else
        strTCRemarks = strTCRemarks & "<br />" & "Cancel button is not found in Layout"
        log.Message "Cancel button is not found in Layout"
      End if       
End Sub
Sub sNewLayoutSecondLevelDuplicate(strParameters)
  On Error Resume Next
  Dim objEdgeFilter,strTemp,objTemp,strOk
  
  
  call sCheckLayoutLevelExpandTree(strParameters)
  
  set objEdgeFilter=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 4).WPFObject("BarButtonItemLinkControl", "", 1)
  strTemp="WPFObject(""ContentControlEx"", ""New Layout Topic"", 2)"
  Set objTemp=objEdgeFilter.FindChild("Name",strTemp,50)
    If objTemp.Exists = TRUE then
      objTemp.Click
      Delay(2000)
      set objEdgeFilter= Sys.Process("EdgeClient").WPFObject("HwndSource: NewLayoutTopicPrompt", "New Layout (Level 2)").WPFObject("NewLayoutTopicPrompt", "New Layout (Level 2)", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder")
      strTemp="WPFObject(""PART_ContainerContent"")"
      Set objTemp=objEdgeFilter.FindChild("Name",strTemp,50)
      If objTemp.Exists = TRUE then
           set objEdgeFilter= Sys.Process("EdgeClient").WPFObject("HwndSource: NewLayoutTopicPrompt", "New Layout (Level 2)").WPFObject("NewLayoutTopicPrompt", "New Layout (Level 2)", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 2)
          strTemp="WPFObject(""TextEdit"", """", 1)"
          Set objTemp=objEdgeFilter.FindChild("Name",strTemp,50)
          If objTemp.Exists = TRUE then   
            objTemp.keys("T1")
          End if
          set objEdgeFilter= Sys.Process("EdgeClient").WPFObject("HwndSource: NewLayoutTopicPrompt", "New Layout (Level 2)").WPFObject("NewLayoutTopicPrompt", "New Layout (Level 2)", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 5)
          strTemp="WPFObject(""ComboBoxEdit"", """", 1)"
          Set objTemp=objEdgeFilter.FindChild("Name",strTemp,50)
          If objTemp.Exists = TRUE then   
            objTemp.Keys("[Down]")
            set objEdgeFilter= Sys.Process("EdgeClient").WPFObject("HwndSource: NewLayoutTopicPrompt", "New Layout (Level 2)").WPFObject("NewLayoutTopicPrompt", "New Layout (Level 2)", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1)
            strTemp="WPFObject(""Button"", ""Save"", 1)"
            Set objTemp=objEdgeFilter.FindChild("Name",strTemp,50)
            If objTemp.Exists = TRUE then
              objTemp.Click 
              call sEdgeprocessor
              strTemp="WPFObject(""PART_ContainerContent"")"
              Set strOk=Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "Attention").WPFObject("CustomMessageBoxWindow", "Attention", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,850000)
              If strOk.Exists Then
                Sys.Keys "[Enter]"
              End If
            End if
          End if  
      End if  
    End if     
End Sub
Sub sNewLayoutExpand(strParameters)
  On Error Resume Next
    Dim objEdge,objEdgeFilter
    Dim strLevel1layout,strLevel2layout,strLevel3layout,strWrkSpaceName
    Dim objNewWrkSpace_okbtn,objNewWrkSpace_Name
    Dim objNewWrkSpace_Txtbox,objopenforEdit,objWrkspace_popup
    Dim strTemp,objTemp,intRow,barManager,intTotNodeCnt,Text,objCellText,intl,intK,strDesc1,strDesc2
    Dim objWrkSpace,objwrkspacepop,objwrkspcUpload,objConfirm,objGridCell,DescLocalText,intSeriesID

    call sLoadlayout
    strLevel1layout=getSplitValue(strParameters,"LEVEL1LAYOUT")    
    'strLevel1layout="dX Non-Asia Database (Current Eng Version)"
        
    Delay 3000,"Please Wait..."
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("LayoutTreeControl").WPFObject("LayoutTreeListView")
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("LayoutTreeControl")
    
    Delay 10000,"Please Wait..."
        ''Selecting Level1 layout
        intTotNodeCnt=GridControl.Nodes_2.Count
        For intI=0 to intTotNodeCnt-1         
            If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strLevel1layout) then
             intRow=GridControl.Nodes_2.Item(intI).get_RowHandle
              Call GridControl.ClearSelectionCore
              Call GridControl.FocusViewAndRow(GridControl,intRow)
              GridControl.SetFocusOnCurrentItem
              Call GridControl.SelectRowCore(intRow)
              log.Message "Level 1 Layout - " & GridControl.Nodes_2.Item(intI).Content.Description       
              blnFlag=False  
              Exit For
            End If
        Next
        Delay 3000,"Please Wait..."
        If blnFlag = True then
          strTCRemarks="Level 1 Layout not found"
          strTestCaseResult="FAIL"
          Exit Sub
        End If 
      GridControl.Keys "^[Enter]" 
      strTCRemarks="All the level1 nodes are Expanded"         
End Sub

Sub sNewLayoutCollapse(strParameters)
  On Error Resume Next
    Dim objEdge,objEdgeFilter
    Dim strLevel1layout,strLevel2layout,strLevel3layout,strWrkSpaceName
    Dim objNewWrkSpace_okbtn,objNewWrkSpace_Name
    Dim objNewWrkSpace_Txtbox,objopenforEdit,objWrkspace_popup
    Dim strTemp,objTemp,intRow,barManager,intTotNodeCnt,Text,objCellText,intl,intK,strDesc1,strDesc2
    Dim objWrkSpace,objwrkspacepop,objwrkspcUpload,objConfirm,objGridCell,DescLocalText,intSeriesID
    
    call sLoadlayout
    strLevel1layout=getSplitValue(strParameters,"LEVEL1LAYOUT")    
    'strLevel1layout="dX Non-Asia Database (Current Eng Version)"
        
    Delay 3000,"Please Wait..."
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("LayoutTreeControl").WPFObject("LayoutTreeListView")
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("LayoutTreeControl")
    
    Delay 7000,"Please Wait..."
        ''Selecting Level1 layout
        intTotNodeCnt=GridControl.Nodes_2.Count
        For intI=0 to intTotNodeCnt-1         
            If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strLevel1layout) then
              intRow=GridControl.Nodes_2.Item(intI).get_RowHandle
              Call GridControl.ClearSelectionCore
              Call GridControl.FocusViewAndRow(GridControl,intRow)
              GridControl.SetFocusOnCurrentItem
              Call GridControl.SelectRowCore(intRow)
              log.Message "Level 1 Layout - " & GridControl.Nodes_2.Item(intI).Content.Description       
              blnFlag=False  
              Exit For
            End If
        Next
        Delay 3000,"Please Wait..."
        If blnFlag = True then
          strTCRemarks="Level 1 Layout not found"
          strTestCaseResult="FAIL"
          Exit Sub
        End If 
      Delay 5000,"Please Wait..."
      GridControl.Keys "^[Enter]"   
      'Call sedgeProcessor
      GridControl.Keys "^[Enter]" 
      strTCRemarks="All the level1 nodes are Collapsed"     
End Sub
Sub sNewLayoutExpandSecondLevel(strParameters)
  On Error Resume Next
    Dim objEdge,objEdgeFilter
    Dim strLevel1layout,strLevel2layout,strLevel3layout,strWrkSpaceName
    Dim objNewWrkSpace_okbtn,objNewWrkSpace_Name
    Dim objNewWrkSpace_Txtbox,objopenforEdit,objWrkspace_popup
    Dim strTemp,objTemp,intRow,barManager,intTotNodeCnt,Text,objCellText,intl,intK,strDesc1,strDesc2
    Dim objWrkSpace,objwrkspacepop,objwrkspcUpload,objConfirm,objGridCell,DescLocalText,intSeriesID
    
    Call sloadlayout
    strLevel1layout=getSplitValue(strParameters,"LEVEL1LAYOUT")    
    'strLevel1layout="dX Non-Asia Database (Current Eng Version)"
        
    Delay 3000,"Please Wait..."
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("LayoutTreeControl").WPFObject("LayoutTreeListView")
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("LayoutTreeControl")
    
    Delay 10000,"Please Wait..."
        ''Selecting Level1 layout
        intTotNodeCnt=GridControl.Nodes_2.Count
        For intI=0 to intTotNodeCnt-1         
            If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strLevel1layout) then
              intRow=GridControl.Nodes_2.Item(intI).get_RowHandle
              Call GridControl.ClearSelectionCore
              Call GridControl.FocusViewAndRow(GridControl,intRow)
              GridControl.SetFocusOnCurrentItem
              Call GridControl.SelectRowCore(intRow)
              log.Message "Level 1 Layout - " & GridControl.Nodes_2.Item(intI).Content.Description       
              blnFlag=False  
              Exit For
            End If
        Next
        Delay 10000,"Please Wait..."
        If blnFlag = True then
          strTCRemarks="Level 1 Layout not found"
          strTestCaseResult="FAIL"
          Exit Sub
        End If 
      Delay 10000,"Please Wait..."
      GridControl.Keys "[Enter]" 
      strTCRemarks="All the level2  nodes are found"  
       
End Sub
Sub sNewLayoutCollapseSecondLevel(strParameters)
  On Error Resume Next
    Dim objEdge,objEdgeFilter
    Dim strLevel1layout,strLevel2layout,strLevel3layout,strWrkSpaceName
    Dim objNewWrkSpace_okbtn,objNewWrkSpace_Name
    Dim objNewWrkSpace_Txtbox,objopenforEdit,objWrkspace_popup
    Dim strTemp,objTemp,intRow,barManager,intTotNodeCnt,Text,objCellText,intl,intK,strDesc1,strDesc2
    Dim objWrkSpace,objwrkspacepop,objwrkspcUpload,objConfirm,objGridCell,DescLocalText,intSeriesID
    
    Call sloadlayout
    strLevel1layout=getSplitValue(strParameters,"LEVEL1LAYOUT")    
    'strLevel1layout="dX Non-Asia Database (Current Eng Version)"
        
    Delay 3000,"Please Wait..."
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("LayoutTreeControl").WPFObject("LayoutTreeListView")
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("LayoutTreeControl")
    
    Delay 1000,"Please Wait..."
        ''Selecting Level1 layout
        intTotNodeCnt=GridControl.Nodes_2.Count
        For intI=0 to intTotNodeCnt-1         
            If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strLevel1layout) then
              intRow=GridControl.Nodes_2.Item(intI).get_RowHandle
              Call GridControl.ClearSelectionCore
              Call GridControl.FocusViewAndRow(GridControl,intRow)
              GridControl.SetFocusOnCurrentItem
              Call GridControl.SelectRowCore(intRow)
              log.Message "Level 1 Layout - " & GridControl.Nodes_2.Item(intI).Content.Description       
              blnFlag=False  
              Exit For
            End If
        Next
        Delay 3000,"Please Wait..."
        If blnFlag = True then
          strTCRemarks="Level 1 Layout not found"
          strTestCaseResult="FAIL"
          Exit Sub
        End If 
      Delay 5000,"Please Wait..."
      GridControl.Keys "[Enter]"   
      Delay 2000,"Please Wait..."
      GridControl.Keys "[Enter]" 
       
End Sub
Sub sCheckLayout(strParameters)
    Dim strTestcase
    strTestcase=getSplitValue(strParameters,"TESTCASE") 
    If strTestcase=1 then
      Call sLoadLayout
    Elseif strTestcase=2 then
      Call sCheckLayoutFields
    Elseif strTestcase=3 then
      Call sCheckLayoutFields
    Elseif strTestcase=4 then
      Call sCheckLayoutWorkspaceButton(strParameters)
    Elseif strTestcase=5 then
      Call sCheckLayoutFindButton
    Elseif strTestcase=6 then
      Call sCheckViewWorkspaceLayout(strParameters)
    Elseif strTestcase=7 then
      Call sCheckViewWorkspaceLayout(strParameters)
    Elseif strTestcase=8 then
      Call sCheckLayoutWorkspaceButton(strParameters)
    Elseif strTestcase=9 then
      Call sCheckLayoutExpandTree(strParameters)
    Elseif strTestcase=10 then
      Call sCheckLayoutFileRepositoryButton(strParameters)
    Elseif strTestcase=11 then
      Call sCheckLayoutFileRepositoryButton(strParameters)
    Elseif strTestcase=12 then
      Call sCheckLayoutRefresh
    Elseif strTestcase=13 then
      Call sCheckLayoutExpandAll(strParameters)
    Elseif strTestcase=14then
      Call sCheckLayoutExpandAll(strParameters)
      Call sCheckLayoutCollapseAll(strParameters)
    Elseif strTestcase=15 then
      Call sCheckLayoutNewLayout(strParameters)
      Call sCloseNewLayoutTopicPrompt
    Elseif strTestcase=16 then
      Call sCheckLayoutNewLayout(strParameters)
      Call sCloseNewLayoutTopicPrompt
    Elseif strTestcase=17 then
      Call sCheckLayoutNewLayoutTopic(strParameters)
      Call sCloseNewLayoutTopicPrompt
    Elseif strTestcase=18 then
      Call sCheckViewWorkspaceLayout(strParameters)
    Elseif strTestcase=19 then
      Call sCheckViewWorkspaceLayout(strParameters)
    Elseif strTestcase=20 then
      Call sCheckLayoutFileRepositoryButton(strParameters)
    Elseif strTestcase=21 then
     Call  sCheckLayoutFileRepositoryButton(strParameters)
    Elseif strTestcase=22 then
      Call sCheckLayoutViewWorkspace(strParameters)
    Elseif strTestcase=23 then
      Call sCheckLayoutViewWorkspacePrompt(strParameters)
    Elseif strTestcase=24 then
      Call sCheckLayoutViewWorkspacePrompt(strParameters)
    Elseif strTestcase=25 then
      Call sCheckLayoutEditWs(strParameters)
    Elseif strTestcase=26 then
      Call sCheckLayoutEditWorkspace(strParameters)
    Elseif strTestcase=27 then
      Call sCheckLayoutNewLayoutTopic(strParameters)
      Call sCloseNewLayoutTopicPrompt    
    Elseif strTestcase=28 then
      Call sCheckLayoutNewLayout(strParameters)
      Call sNewLayoutTopicPromptButton
      Call sCloseNewLayoutTopicPrompt
    Elseif strTestcase=29 then
      Call sCheckLayoutNewLayout(strParameters)
      Call sNewLayoutTopicCheckbox
      Call sCloseNewLayoutTopicPrompt
    Elseif strTestcase=30 then
      Call sCheckLayoutNewLayout(strParameters)
      Call sNewLayoutOutputMandatoryFields 
      Call sCloseNewLayoutTopicPrompt
    Elseif strTestcase=31then
      Call sCheckLayoutNewLayout(strParameters)
      Call sNewLayoutDescMandatoryFields
      Call sCloseNewLayoutTopicPrompt
    Elseif strTestcase=32 then
      Call sCheckLayoutNewLayout(strParameters)
      Call sNewLayoutCancel
      'Call sCloseNewLayoutTopicPrompt
    Elseif strTestcase=33 then
      Call sCheckLayoutNewLayout(strParameters)
      Call sNewLayoutSecondLevel
      Call sCloseNewLayoutTopicPrompt
    Elseif strTestcase=34 then
      Call sCheckLayoutNewLayout(strParameters)
      Call sCloseNewLayoutTopicPrompt
    Elseif strTestcase=35 then
      Call sCheckLayoutNewLayout(strParameters)
      Call sNewLayoutSecondLevelDuplicate(strParameters)
    Elseif strTestcase=36 then
      Call sNewLayoutExpand(strParameters)
    Elseif strTestcase=37 then
      Call sNewLayoutCollapse(strParameters)
    Elseif strTestcase=38 then
      Call sNewLayoutExpandSecondLevel(strParameters)
    Elseif strTestcase=39 then
      Call sNewLayoutCollapseSecondLevel(strParameters)
    Elseif strTestcase=40 then
      Call sCheckLayoutViewWorkspace(strParameters)
    Elseif strTestcase=41 then
      Call sCheckLayoutRCViewWorkspace(strParameters)
    Elseif strTestcase=42 then
      Call sCheckLayoutAddfolderViewWorkspace(strParameters)
    Elseif strTestcase=43 then
      Call  sCheckLayoutAddfolderRCViewWorkspace(strParameters)
    Elseif strTestcase=44 then
      Call sCheckLayoutModulePopup(strParameters)
    Elseif strTestcase=45 then
      Call sCheckLayoutModulePopupCancel(strParameters)
    Elseif strTestcase=46 then
      Call sCheckLayoutModulePopupOk(strParameters)
    Elseif strTestcase=47 then
      Call sCheckLayoutModulePopupCancel(strParameters)
    Elseif strTestcase=48 then
      Call sCheckLayoutModuleWorkspace(strParameters)
    Elseif strTestcase=49 then
      Call sCheckLayoutModuleRCOpenEdit(strParameters)
    Elseif strTestcase=50 then
      Call sCheckLayoutRCViewWorkspace(strParameters)
    Elseif strTestcase=51 then
    
    Elseif strTestcase=52 then
    
    Elseif strTestcase=53 then
    
    Elseif strTestcase=54 then
      Call sCheckLayoutSecondLExpand(strParameters)
    Elseif strTestcase=55 then
      Call sCheckLayoutThirdLExpand(strParameters)
    Elseif strTestcase=56 then
    
    Elseif strTestcase=57 then
      'Call sCheckLayoutEditWrk(strParameters)
      Call sCheckLayoutModuleWorkspaceLocked(strParameters)
    Elseif strTestcase=58 then
    
    Elseif strTestcase=59 then
      Call sCheckLayoutEditWrk(strParameters)
      Call sCheckLayoutSecondEditWorkspace(strParameters)
    Elseif strTestcase=60 then
      Call sCheckLayoutFloatWindow
    Elseif strTestcase=61 then
      Call sCheckLayoutAutoHideWindow
    Elseif strTestcase=62 then
      Call sCheckLayoutCloseWindow
    Elseif strTestcase=63 then
      Call sCheckLayoutRefreshFileRepository(strParameters)
    Elseif strTestcase=64 then
      Call sCheckLayoutHideAttachmentFileRepository(strParameters)
    Elseif strTestcase=65 then
      Call sCheckLayoutFileRepositoryUsage(strParameters)
    Elseif strTestcase=66 then
      Call sCheckLayoutAddNewLink(strParameters)
    Elseif strTestcase=67 then
      Call sCheckLayoutAddNewLinkValidateFootnote(strParameters)
    Elseif strTestcase=68 then
      Call sCheckLayoutAddNewLinkFootnote(strParameters)
    Elseif strTestcase=69 then
      Call sCheckLayoutAddNewLinkFootnote(strParameters)
    Elseif strTestcase=70 then
      Call sCheckLayoutAddNewLinkDataLink(strParameters)
    Elseif strTestcase=71 then
      Call sCheckLayoutAddNewLinkAllLink(strParameters)
    End if
End sub

Sub  sCheckLayoutViewWorkspacePrompt(strParameters)
On Error Resume Next 

Dim strTemp,objNewWorkspace,objopenforEdit,strTemp1,objNewWrkSpaceName
Dim intTotNodeCnt,intI,intJ,intK,strOk 
     
    Call sloadlayout 
    Call sCheckLayoutExpandTree(strParameters)
    strLevel1layout=getSplitValue(strParameters,"LEVEL1LAYOUT")
    strLevel2layout=getSplitValue(strParameters,"LEVEL2LAYOUT")
    strLevel3layout=getSplitValue(strParameters,"LEVEL3LAYOUT")
'    strLevel1layout="dX Non-Asia Database (Current Eng Version)"
'    strLevel2layout="Z-Testing Topic(IT-use only)"
'    strLevel3layout="Sandbox (Benny)"
    
      strTemp="WPFObject(""ArrowControl"", """", 1)"
      Set objNewWorkspace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarSubItemLinkControl", "", 1).FindChild("Name",strTemp,2,True)
      If objNewWorkspace.Exists = True then
        objNewWorkspace.Click
        strTemp="WPFObject(""BarPopupBorderControl"", """", 1)"
        Set objWrkspace_popup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").FindChild("Name",strTemp,5,True)
        If objWrkspace_popup.Exists = True then
          strTemp="WPFObject(""ContentControlEx"", ""Open For View"", 2)"
          Set objopenforEdit=objWrkspace_popup.FindChild("Name",strTemp,8,True)
          If objopenforEdit.Exists then
            objopenforEdit.Click
            Call sEdgeProcessor
          Else
            Exit Sub 
          End If
        End If
      End if
      
      ''WorkSpace Layout View Window
        strTemp="WPFObject(""LayoutPanel"", """", 2)"
        Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,13,True)
        If objTemp.Exists then
            Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("LayoutTreeListControl").WPFObject("LayoutTreeListView")
            Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("LayoutTreeListControl")

            ''Selecting Level1 layout
            intTotNodeCnt=GridControl.Nodes_2.Count
            For intI=0 to intTotNodeCnt-1         
                If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strLevel1layout) then
                  GridControl.Nodes_2.Item(intI).Expand(True)
                  log.Message "Level 1 Layout - " & GridControl.Nodes_2.Item(intI).Content.Description       
                  blnFlag=False  
                  Exit For
                End If
            Next
  
            blnFlag = True 
            ''Selecting Level2 Layout
            intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
            For intJ=0 to intTotNodeCnt-1
              If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strLevel2layout) then
                GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
                log.Message "Level2 layout Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
                blnFlag = False 
                Exit For
              End If
            Next
   
            ''Selecting Level3 Layout
              intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count
              For intK=0 to intTotNodeCnt-1
                If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description)=Ucase(strLevel3layout) then
                  GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Expand(True)
                  intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).get_RowHandle
                  GridControl.Keys "^[Home]"
                  GridControl.set_FocusedRowHandle(intRow)
                  GridControl.Click
                  log.Message "Level3 layout Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description
                  blnFlag = False
                  Exit For   
                End If 
              Next            
          End If
      strTemp="WPFObject(""ContentControlEx"", ""Add Folder"", 2)"
      Set objNewWorkspace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 4).WPFObject("BarButtonItemLinkControl", "", 1).FindChild("Name",strTemp,2,True)
      If objNewWorkspace.Exists = True then
        objNewWorkspace.Click
      End if
      
      strTemp="WPFObject(""PART_ContainerContent"")"
      'Set strOk=Sys.Process("EdgeClient").WPFObject("HwndSource: WindowContentHolder", "Workspace").WPFObject("WindowContentHolder", "Workspace", 1).WPFObject("NonLogicalDecorator", "", 1).WPFObject("ThemedManagedContentPresenter", "", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WaitChild(strTemp,550000)
      Set strOk=Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "Workspace").WPFObject("CustomMessageBoxWindow", "Workspace", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,550000)
      If strOk.Exists Then
        Sys.Keys "[Enter]"
      End if
     strTemp="WPFObject(""EdittingInViewOnlyErrorMessageLabel"")"
     Set objNewWorkspace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 2).FindChild("Name",strTemp,2,True)
      If objNewWorkspace.Exists = True then
        log.Message "No modifications can be done"
        strTCRemarks="No modifications can be done"
      End if
      Call sCloseLayout
End sub

Sub  sCheckLayoutEditWs(strParameters)
On Error Resume Next

    Dim objNewWorkspace,strTemp1,objNewWrkSpaceName
    Dim strLevel1layout,strLevel2layout,strLevel3layout,strWrkSpaceName
    Dim objNewWrkSpace_okbtn,objNewWrkSpace_Name
    Dim objNewWrkSpace_Txtbox,objopenforEdit,objWrkspace_popup
    Dim strTemp,objTemp,intRow,barManager,intTotNodeCnt,Text,objCellText,intl,intK,strDesc1,strDesc2
    Dim objWrkSpace,objwrkspacepop,objwrkspcUpload,objConfirm,objGridCell,DescLocalText,intSeriesID
    
    Call sLoadLayout
    Call sCheckLayoutExpandTree(strParameters)
    
    strLevel1layout=getSplitValue(strParameters,"LEVEL1LAYOUT")
    strLevel2layout=getSplitValue(strParameters,"LEVEL2LAYOUT")
    strLevel3layout=getSplitValue(strParameters,"LEVEL3LAYOUT")

'    strLevel1layout="dX Non-Asia Database (Current Eng Version)"
'    strLevel2layout="Z-Testing Topic(IT-use only)"
'    strLevel3layout="Sandbox (Benny)"

'    strLevel1layout="dX Non-Asia Database (Current Eng Version)"
'    strLevel2layout="Z-Topic Test(IT-use only)"
'    strLevel3layout="Automation"
    
    strTemp="WPFObject(""ArrowControl"", """", 1)"
    Set objNewWorkspace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarSubItemLinkControl", "", 1).FindChild("Name",strTemp,2,True)
    If objNewWorkspace.Exists = True then
      objNewWorkspace.Click
      strTemp="WPFObject(""BarPopupBorderControl"", """", 1)"
      Set objWrkspace_popup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").FindChild("Name",strTemp,5,True)
      If objWrkspace_popup.Exists = True then
        strTemp="WPFObject(""ContentControlEx"", ""Open For Edit"", 2)"
        Set objopenforEdit=objWrkspace_popup.FindChild("Name",strTemp,8,True)
        If objopenforEdit.Exists then
          objopenforEdit.Click    
        End If
      End If
      strTemp1="WPFObject(""HwndSource: WorkspaceNamePrompt"", ""Please provide a new Workspace Name"")"
      Set objNewWrkSpaceName=Sys.Process("EdgeClient").WaitChild(strTemp1,80000)
      If objNewWrkSpaceName.Exists = True then
          ''Waiting for Workspace Name prompt
          strTemp="WPFObject(""FloatingContainerBorder"")"
          Set objNewWrkSpace_Name=Sys.Process("EdgeClient").WPFObject("HwndSource: WorkspaceNamePrompt", "Please provide a new Workspace Name").WPFObject("WorkspaceNamePrompt", "Please provide a new Workspace Name", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,1500000)
          If objNewWrkSpace_Name.Exists = True then
            strTemp="WPFObject(""ChangeNameTextEdit"")"
            ''Entering Workspace Name
            Set objNewWrkSpace_Txtbox=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
            If objNewWrkSpace_Txtbox.Exists = True then
                ''Clicking on Ok Button 
                strTemp="WPFObject(""CancelButton"")"
                Set objNewWrkSpace_okbtn=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
                If objNewWrkSpace_okbtn.Exists = True then
                  objNewWrkSpace_okbtn.Click
                  Call sEdgeProcessor
                End If
            End If
          End If
      End if 
  End If

End sub 

Sub sNewLayoutTopicCheckbox()
  On Error Resume Next
  Dim objEdgeFilter
  set objEdgeFilter= Sys.Process("EdgeClient").WPFObject("HwndSource: NewLayoutTopicPrompt", "New Layout (Level 2)").WPFObject("NewLayoutTopicPrompt", "New Layout (Level 2)", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder")
  strTemp="WPFObject(""PART_ContainerContent"")"
  Set objTemp=objEdgeFilter.FindChild("Name",strTemp,50)
    If objTemp.Exists = TRUE then
        set objEdgeFilter= Sys.Process("EdgeClient").WPFObject("HwndSource: NewLayoutTopicPrompt", "New Layout (Level 2)").WPFObject("NewLayoutTopicPrompt", "New Layout (Level 2)", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 4)
        strTemp="WPFObject(""CheckEdit"", """", 1)"
        Set objTemp=objEdgeFilter.FindChild("Name",strTemp,50)
        If objTemp.Exists = TRUE then
          If objTemp.ischecked = TRUE then
            If objTemp.Enabled = False then
              strTCRemarks = strTCRemarks & "<br />" & "Disabled Flag will be checked and disabled in Layout"
              log.Message "Save  button found in Layout"
            End if 
          End if 
        Else
          strTCRemarks = strTCRemarks & "<br />" & "Disabled Flag is not found in Layout"
          log.Message "Save button is not found in Layout"
        End If
      
        Elsse
        strTCRemarks = strTCRemarks & "<br />" & "Cancel button is not found in Layout"
        log.Message "Cancel button is not found in Layout"
      End if       
End Sub


Sub sCheckLayoutLevelExpandTree(strParameters)

    Dim objEdge,objEdgeFilter
    Dim strLevel1layout,strLevel2layout,strLevel3layout,strWrkSpaceName
    Dim objNewWrkSpace_okbtn,objNewWrkSpace_Name
    Dim objNewWrkSpace_Txtbox,objopenforEdit,objWrkspace_popup
    Dim strTemp,objTemp,intRow,barManager,intTotNodeCnt,Text,objCellText,intl,intK,strDesc1,strDesc2
    Dim objWrkSpace,objwrkspacepop,objwrkspcUpload,objConfirm,objGridCell,DescLocalText,intSeriesID,GridControl,GridSourceTree

    call sLoadLayout
    strLevel1layout=getSplitValue(strParameters,"LEVEL1LAYOUT")
'    strLevel2layout=getSplitValue(strParameters,"LEVEL2LAYOUT")  
'    strLevel3layout=getSplitValue(strParameters,"LEVEL3LAYOUT")

'    strLevel1layout="dX Non-Asia Database (Current Eng Version)"
'    strLevel2layout="Z-Testing Topic(IT-use only)"
'    strLevel3layout="Sandbox (Benny)" 

    'strLevel1layout="dX Non-Asia Database (Current Eng Version)"
   
    Delay 3000,"Please Wait..."
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("LayoutTreeControl").WPFObject("LayoutTreeListView")
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("LayoutTreeControl")
   
      Delay 10000,"Please Wait..."
        ''Selecting Level1 layout
        intTotNodeCnt=GridControl.Nodes_2.Count
        For intI=0 to intTotNodeCnt-1         
            If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strLevel1layout) then
              GridControl.Nodes_2.Item(intI).Expand(True)
              intRow=GridControl.Nodes_2.Item(intI).get_RowHandle
              Call GridControl.ClearSelectionCore
              Call GridControl.FocusViewAndRow(GridControl,intRow)
              GridControl.SetFocusOnCurrentItem
              Call GridControl.SelectRowCore(intRow)
              log.Message "Level 1 Layout - " & GridControl.Nodes_2.Item(intI).Content.Description       
              blnFlag=False  
              Exit For
            End If
        Next
        Delay 3000,"Please Wait..."
        If blnFlag = True then
          strTCRemarks="Level 1 Layout not found"
          strTestCaseResult="FAIL"
          Exit Sub
        End If
   
End Sub

Sub sExcelFullHistory3()

  Dim strTemp,CreateSTP,PropArray,ValuesArray,objTemp,ReplaceFile 
  
On Error Resume Next

  strTemp = "WinFormsObject(""TimeRangePickerForm"")"
  Set CreateSTP=Sys.Process("EXCEL",3).WaitChild(strTemp,120000)
  If CreateSTP.Exists = True Then
    PropArray = Array("WndCaption", "Visible")
    ValuesArray = Array("Full History", True)
    Set objTemp = CreateSTP.FindChild(PropArray, ValuesArray, 50)
    'Delay (20000)
    If objTemp.Exists = True Then
      objTemp.Click
      log.Message "Selected Full History Radio button"
    Else
      log.Message "Full History Radio button not found"
    End If    
'    strTemp="WinFormsObject(""FullHistoryButton"")"
'    Set objTemp = CreateSTP.FindChild(Name,strTemp,50)
'    If objTemp.Exists = True Then
'      objTemp.Click
'    End If
    PropArray = Array("WndCaption", "Visible")
    ValuesArray = Array("Open", True)
    Set objTemp = CreateSTP.FindChild(PropArray, ValuesArray, 10)
    Delay 5000,"Opening STP.. Pls wait.."
    If objTemp.Exists = True Then
      objTemp.Click
    End If

'    strTemp="WinFormsObject(""OpenButton"")"
'    Set objTemp = CreateSTP.FindChild(Name,strTemp,50)
'    If objTemp.Exists = True Then
'      objTemp.Click
'    End If
    
    'Set CreateSTP=Sys.Process("EXCEL",2).WaitChild(strTemp,95000)
    strTemp="WPFObject(""PART_ContainerContent"")"
    'Delay 25000,"Opening STP.. Pls wait.."
    Set ReplaceFile = Sys.Process("EXCEL",3)._
          Waitchild("WPFObject(""HwndSource: CustomMessageBoxWindow"", ""Warning"")",18000)._
          Waitchild("WPFObject(""CustomMessageBoxWindow"", ""Warning"", 1)",18000)._
          Waitchild("WPFObject(""Grid"", """", 1)",18000)._
          Waitchild("WPFObject(""FloatingContainerBorder"")",18000)._
          Waitchild("WPFObject(""FloatingContainerBackground"")",18000)._
          Waitchild("WPFObject(""Grid"", """", 1)",18000)._
          Waitchild("WPFObject(""FloatingContainerBody"")",18000)._
          Waitchild("WPFObject(""Grid"", """", 1)",18000)._
          Waitchild("WPFObject(""Grid"", """", 1)",18000)._
          Waitchild("WPFObject(""PART_ContainerContent"")",18000)
    If ReplaceFile.Exists=True Then
      'ReplaceFile.Click
      Sys.Keys("Y")
    End If
    blnSTPfile=False
    'strTCRemarks = "STP file opened"
  Else
    log.Message "STP File not found"
    strTCRemarks="STP File not found"
    blnCriticalErrorFound = True
    strCriticalError = "Unable to find STP file"
    strTestCaseResult = "FAIL"
    blnSTPfile=True
    Call ExcelProcessKill
    Exit Sub
  End If

  Set CreateSTP=Nothing  
  Set objTemp=Nothing
End Sub

Sub sLoadSTP(strParameters)

On Error Resume Next

  Dim strTemp,strObject
  Dim ObjGridLoad,ObjGridClose,objEdgeMDI,objTemp,objEdge
  strExcel = getSplitValue(strParameters,"ExcelValue")

'    ''Opening Source
'  'set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1)
'  strTemp="WPFObject(""LayoutPanel"", """", 1)"
'  Set objTemp=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,true)
'  If objTemp.Exists = False then
'    'Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("RibbonControl").WPFObject("RibbonSelectedPageControl", "", 1).WPFObject("RibbonPagesControl", "", 1).WPFObject("RibbonPageGroupsControl", "", 1).WPFObject("RibbonPageGroupControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarButtonItemLinkControl", "", 1).Click
'    'Delay 60000,"Opening Source.. Pls wait."
'    strTemp="WPFObject(""ContentControl"", ""Source"", 1)"
'    Set objSource=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,true)
'    Call objSource.Click
'    Call sEdgeProcessor
'    strTemp="WPFObject(""LayoutPanel"", """", 1)"
'    Set objTemp=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,true)
'    If objTemp.Exists = False then
'      strTestCaseResult = "FAIL"
'      Exit Sub
'    End If
'  ElseIF objTemp.Exists = True then
'    If objTemp.Caption<>"Source" then
'      call sCloseSource()
'      strTemp="WPFObject(""ContentControl"", ""Source"", 1)"
'      Set objSource=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,true)
'      Call objSource.Click
'      Call sEdgeProcessor
'      strTemp="WPFObject(""LayoutPanel"", """", 1)"
'      Set objTemp=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,true)    
'      If objTemp.Exists = False then
'        strTestCaseResult = "FAIL"
'        Exit Sub
'      End If
'    End if 
'  End If
'  
'  strTemp="WPFObject(""LayoutPanel"", """", 1)"
'  Set objTemp=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,true)
'  Call objTemp.Click
'  'Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).Click
'  'Delay(5000)


  'Open Source Module
  Call sHome_Source() 
  Call sFindtree(strParameters,"Source")
  
  Delay 2000,"Opening Source.. Pls wait.."
   ''Open STP and Full History
  Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 6).WPFObject("BarButtonItemLinkControl", "", 1).WPFObject("ContentControlEx", "Open Global STP", 2).Click
  
   Delay 3000,"Opening STP.. Pls wait.."
   
   ''Selecting Full History in STP
   strExcel = "3"
  Call sExcelFullHistorySTP(strExcel)
  Delay 60000, "Please Wait Form is loading"
  
  'Delay(5000)
  'Call sExcelFullHistory3()
  strTCRemarks = "Opened STP Successfully"
  log.Message "Opened STP Successfully"
End Sub

'Sub sSourceBM
Sub sSourceBM(strParameters)
On Error Resume Next

    Dim strSource_Name,strLevel2src_Name,objNewWrkSpace_okbtn,objNewWrkSpace_Name,strWrkSpaceName
    Dim objNewWrkSpace_Txtbox,objopenforEdit,objWrkspace_popup
    Dim strTemp,objTemp,intRow,barManager,intTotNodeCnt,Text,strDesc1,strDesc2
    Dim objWrkSpace,objwrkspacepop,objwrkspcUpload,objConfirm,objGridCell,DescLocalText,intSeriesID,strLocalname
    Dim layoutGroup
    Dim strTemp1,objNewWrkSpaceName

    strSource_Name=getSplitValue(strParameters,"SOURCE")
    strLevel2src_Name=getSplitValue(strParameters,"LEVEL2SOURCE")
    intSeriesID=getSplitValue(strParameters,"SERIESID")
    strLocalname=getSplitValue(strParameters,"WORKSPACENAME")
    
'     strSource_Name="Test" 
'     strLevel2src_Name="Automation_UIT3"
'     intSeriesID=0
     
    strDesc1=aqDateTime.Now
    strDesc2=aqDateTime.Now
    DescText=Replace(strDesc1,"/","-")
    DescText=Replace(DescText,":","_")
    DescLocalText=DescText
    strWrkSpaceName=DescText
    
    if intSeriesID=0 then
      Call sSourceseries
      intSeriesID=strSourceFileText
    End if 

    ''Setting grid Objects
        
'    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("SourceTreeControl").WPFObject("SourceTreeListView")
'    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("SourceTreeControl")

    strTemp="WPFObject(""SourceTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""SourceTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,True)
     
     Delay 5000,"Pls Wait.."
     
    ''Selecting Country Name
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource_Name) then
          GridControl.Nodes_2.Item(intI).ExpandAll
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description       
    '      strTCRemarks=strTCRemarks & Chr(10) & "Selected Node - " & GridControl.Nodes_2.Item(intI).Content.Description  
          blnFlag=False  
          Exit For
        End If
    Next
    If blnFlag = True then
      strTCRemarks="Country Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
  
    Delay 4000,"Pls Wait.."
        blnFlag = True 
    ''Selecting Level2Source_Name
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
    For intJ=0 to intTotNodeCnt-1
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strLevel2src_Name) then
        GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).ExpandAll
    '    intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(0).get_RowHandle
        intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
'        Call GridSourceTree.ClickCell(intRow, "Edit")
        Call GridControl.ClearSelectionCore
        Call GridControl.FocusViewAndRow(GridControl,intRow)
        GridControl.SetFocusOnCurrentItem
        Call GridControl.SelectRowCore(intRow)
        log.Message "Level2 Source Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
        blnFlag = False 
        Exit For
      End If
    Next
    If blnFlag = True then
      log.Message "Level2 Source Name not found"
      strTCRemarks="Level2 Source Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
    
   'Call sCheckSourceModule(strParameters)
    
    Delay 2000,"Pls Wait.."

    ''Clicking on "New Workspace" Button and selecting "Open for Edit(Souce)" option 
'    strTemp="WPFObject(""ArrowControl"", """", 1)"
'    Set objNewWorkspace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,20,True)
    strTemp="WPFObject(""ContentControlEx"", ""New Workspace"", 2)"
    Set objNewWorkspace=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,True)
    If objNewWorkspace.Exists = True then
      objNewWorkspace.Click
      strTemp="WPFObject(""BarPopupBorderControl"", """", 1)"
      Set objWrkspace_popup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").FindChild("Name",strTemp,5,True)
      If objWrkspace_popup.Exists = True then
        strTemp="WPFObject(""ContentControlEx"", ""Open For Edit (Source)"", 2)"
        Set objopenforEdit=objWrkspace_popup.FindChild("Name",strTemp,8,True)
        If objopenforEdit.Exists then
          objopenforEdit.Click    
          'Delay 20000,"Please Wait..."
        End If
      End If
     
    
      strTemp1="WPFObject(""HwndSource: WorkspaceNamePrompt"", ""Please provide a new Workspace Name"")"
      Set objNewWrkSpaceName=Sys.Process("EdgeClient").WaitChild(strTemp1,600000)
      If objNewWrkSpaceName.Exists = True then
     
      ''Waiting for Workspace Name prompt
      strTemp="WPFObject(""FloatingContainerBorder"")"
      'Set objNewWrkSpace_Name=Sys.Process("EdgeClient").WPFObject("HwndSource: WorkspaceNamePrompt", "Please provide a new Workspace Name").WPFObject("WorkspaceNamePrompt", "Please provide a new Workspace Name", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,15000000)
     ' Set objNewWrkSpace_Name=Sys.Process("EdgeClient").WaitChild(strTemp,15000000)
        If objNewWrkSpaceName.Exists = True then
          strTemp="WPFObject(""ChangeNameTextEdit"")"
          ''Entering Workspace Name
          Set objNewWrkSpace_Txtbox=objNewWrkSpaceName.FindChild("Name",strTemp,9,True)
            If objNewWrkSpace_Txtbox.Exists = True then
              objNewWrkSpace_Txtbox.Click  
              objNewWrkSpace_Txtbox.Text=strWrkSpaceName            
              'objNewWrkSpace_Txtbox.Text=strLocalname&"_"&strWrkSpaceName
              'msgbox strLocalname&"_"&strWrkSpaceName
      '        strTCRemarks=strTCRemarks & Chr(10) & "Entered Workspace Name - " & strWrkSpaceName
              ''Clicking on Ok Button 
              strTemp="WPFObject(""OkButton"")"
              Set objNewWrkSpace_okbtn=objNewWrkSpaceName.FindChild("Name",strTemp,9,True)
              If objNewWrkSpace_okbtn.Exists = True then
                objNewWrkSpace_okbtn.Click
                'Delay 5000,"Please wait..."
              End If
            End If
        End If
      End if
    End If

'    ''Handling Validation for Source
'    strTemp="WPFObject(""HwndSource: WindowContentHolder"", """")"
'    Set objTemp=Sys.Process("EdgeClient").WaitChild(strTemp,10000)
'    If objTemp.Exists = True then
'      objTemp.Keys "[Enter]"
'      strTestCaseResult = "FAIL"
'      Exit Sub
'    End If
    
   Delay 5000, "Please Wait Form is Loading"
   Call sEdgeProcessor()

    ''WorkSpace Edit Window
    strTemp="WPFObject(""LayoutPanel"", """", 2)"
    Set objLayoutPanel2=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,True)
    If objLayoutPanel2.Exists then
        strTemp="WPFObject(""SourceTreeListView"")"
        Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WPFObject("SourceTreeListView")
        'objLayoutPanel2.FindChild("Name",strTemp,50,True)
        strTemp="WPFObject(""SourceTreeListControl"")"
        'Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WPFObject("SourceTreeListView")
        Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl")
        'objLayoutPanel2.FindChild("Name",strTemp,50,True)
        'Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl")

        ''Expanding First Node in Tree      
        intTotNodeCnt=GridControl.Nodes_2.Count  
        For intI=0 to intTotNodeCnt-1         
          If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource_Name) then
            GridControl.Nodes_2.Item(intI).ExpandAll
            blnFlag=False  
            Exit For
          End If
        Next
    
        ''Expanding Second Node in Tree
        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
        For intJ=0 to intTotNodeCnt-1
          If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strLevel2src_Name) then
            GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).ExpandAll
            intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(0).get_RowHandle
            GridControl.Keys "^[Home]"
'            Set objGridCell=GridControl.WPFObject("HierarchyPanel", "", 1).WPFObject("GridRow", "", intRow).WPFObject("ScrollablePart").WPFObject("CellItemsControl", "", 1).WPFObject("GridCellContentPresenter", "", 1).WPFObject("TextEdit", "", 1)
            Call GridControl.ClearSelectionCore
            Call GridControl.FocusViewAndRow(GridControl,intRow-1)
            GridControl.SetFocusOnCurrentItem
            Call GridControl.SelectRowCore(intRow-1)
        
            If objGridCell.Exists = True then
              objGridCell.Click
    '          strTCRemarks=strTCRemarks & Chr(10) & "Selected - " & strLevel2src_Name
            End If
            blnFlag = False 
            Exit For
          End If
        Next
    
        ''Clicking on New Folder
    '   strTemp="WPFObject(""BarButtonItemLinkControl"", """", 1)"
        strTemp="WPFObject(""ContentControlEx"", ""Add Folder"", 2)"
        Set objAddFolder=Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 4).WPFObject("BarButtonItemLinkControl", "", 1).WPFObject("ContentControlEx", "Add Folder", 2)
        'objLayoutPanel2.FindChild("Name",strTemp,50,True)
        'Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 4).WPFObject("BarButtonItemLinkControl", "", 1)
        If objAddFolder.Exists = True then
          Delay 3000,"New Folder..."
          objAddFolder.Click
          Delay 8000,"New Folder..."
        End If
    
        ''Getting no. of Rows under level 2
        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count
        intK=intTotNodeCnt-1
    
        Set objDescCell=Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WPFObject("SourceTreeListView").Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK)
        'Aliases.EdgeClient.HwndSource_RibbonWindow.RibbonWindow.ContentControl.Grid.Grid.ContentControl.Grid.ContentControl.PART_ContainerContent.BarManager.DockPanel.DockLayoutManager.LayoutGroup.LayoutPanel2.Root.BarManager.AdornerDecorator.AdornedControl.Grid.DockPanel.SourceTreeListControl.SourceTreeListView.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK)
        Call objDescCell.Content.set_Description(DescText)
        Call objDescCell.Content.set_DescriptionLocal(DescLocalText)
    
   
        ''Attach Series
        Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("SourceSeriesViewControl").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarButtonItemLinkControl", "", 1).WPFObject("ContentControlEx", "Attach Series", 2)
        'Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("SourceSeriesViewControl").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarButtonItemLinkControl", "", 1)
        If objTemp.Exists = True then
          objTemp.DblClick
          ''Entering Series      
          'Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: SourceSeriesPrompt", "Attach Source Series").WPFObject("SourceSeriesPrompt", "Attach Source Series", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("SeriesIdTextEdit")
          Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: SourceSeriesPrompt", "Attach Source Series").WPFObject("SourceSeriesPrompt", "Attach Source Series", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContentOffset").WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("SeriesIdTextEdit")
          If objTemp.Exists = True then
             objTemp.Text=intSeriesID
             Delay(5000)
             ''Clicking on OK Button
             'Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: SourceSeriesPrompt", "Attach Source Series").WPFObject("SourceSeriesPrompt", "Attach Source Series", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 1).WPFObject("OkButton")
             Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: SourceSeriesPrompt", "Attach Source Series").WPFObject("SourceSeriesPrompt", "Attach Source Series", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContentOffset").WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 1).WPFObject("OkButton")
             If objTemp.Exists = True then
                objTemp.Click
    '            strTCRemarks=strTCRemarks & Chr(10) & "Attached Series- " & intSeriesID
             End If
          End If            
        End If
        
        
        'Set objTemp = Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("SourceSeriesViewControl").WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("SourceSeriesGridControl").WPFObject("SourceSeriesTableView").WPFObject("HierarchyPanel", "", 1).WPFObject("RowControl", "", 1).WPFObject("CellsControl", "", 1).WPFObject("LightweightCellEditor", "", 1).Waitchild("WPFObject(""InplaceBaseEdit"", """", 1)",600000)
        Set objTemp = Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("SourceSeriesViewControl").WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("SourceSeriesGridControl").WPFObject("SourceSeriesTableView").WPFObject("HierarchyPanel", "", 1).Waitchild("WPFObject(""RowControl"", """", 1)",600000)
	      Call SClosesource()
        
   'Delay 50000,"Pls Wait... Form is loading..."
    
      ''Closing Source
       'If objTemp.Exists = True then
       
      ' End If
      'Call sEdgeProcessor
      
    Dim objSaveWrk,objWait 
   '  set objSaveWrk=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 12).WPFObject("BarSubItemLinkControl", "", 1)
    'set objSaveWrk=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 12).WPFObject("BarSubItemLinkControl", "", 1)
    strTemp="WPFObject(""ContentControlEx"", ""Workspace"", 2)"
    Set objTemp=Sys.Process("EdgeClient").FindChild("Name",strTemp,50)
    objWait=1
    Do until objTemp.Enabled = true 
        If objWait < 20 Then
          Delay 1000,"Pls Wait... Form is loading..."
          objWait=objWait+1
        else
          Call SClosesource()
          Call SourceWorkSpacevwr()
          Exit Sub
        end if 
    Loop 
    
    ''Save WorkSpace
    strTemp="WPFObject(""ContentControlEx"", ""Workspace"", 2)"
    'Set objWrkSpace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 11).WPFObject("BarSubItemLinkControl", "", 1).WPFObject("ContentControlEx", "Workspace", 2)
    Set objWrkSpace=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,True)
    If objWrkSpace.Exists = True then
      objWrkSpace.Click
      Dim objEdgeFilter
      'set objEdgeFilter= Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarButtonItemLinkControl", "", 1)
      strTemp="WPFObject(""ContentControlEx"", ""Save Workspace"", 2)"
      Set objTemp=Sys.Process("EdgeClient").FindChild("Name",strTemp,50)
      If objTemp.Exists = TRUE then
        'Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarButtonItemLinkControl", "", 1).WPFObject("ContentControlEx", "Save Workspace", 2).Click
       objTemp.Click
        'strTemp="WPFObject(""PART_ContainerContent"")"
        Set objConfirm=Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "Confirm save.")'.FindChild("Name",strTemp,50,True)

          If objConfirm.Exists = True then
            objConfirm.Click
            Sys.Keys("Y")
            strTemp="WPFObject(""PART_ContainerContent"")"
           ' Set objConfirm=Sys.Process("EdgeClient").WPFObject("HwndSource: WindowContentHolder", "").WPFObject("WindowContentHolder", "", 1).WPFObject("NonLogicalDecorator", "", 1).WPFObject("ThemedManagedContentPresenter", "", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1)
            'strTemp="WPFObject(""DXMessageBox"", """", 1)"
           ' Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "").WPFObject("CustomMessageBoxWindow", "", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent")
            Set objConfirm = Sys.Process("EdgeClient")._
            Waitchild("WPFObject(""HwndSource: CustomMessageBoxWindow"", """")",600000)'._
'            Waitchild("WPFObject(""CustomMessageBoxWindow"", """", 1)",60000)._
'            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
'            Waitchild("WPFObject(""FloatingContainerBorder"")",60000)._
'            Waitchild("WPFObject(""FloatingContainerBackground"")",60000)._
'            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
'            Waitchild("WPFObject(""FloatingContainerBody"")",60000)._
'            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
'            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
'            Waitchild("WPFObject(""PART_ContainerContent"")",60000)
'            
            
'            Set objConfirm=objConfirm.WaitChild(strTemp,9000000000000)
'            strTemp="WPFObject(""DXMessageBox"", """", 1)"
'            'Set objConfirm=Sys.Process("EdgeClient").WPFObject("HwndSource: WindowContentHolder", "").WPFObject("WindowContentHolder", "", 1).WPFObject("NonLogicalDecorator", "", 1).WPFObject("ThemedManagedContentPresenter", "", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("DXMessageBox", "", 1)
'            Set objConfirm=Sys.Process("EdgeClient").WPFObject("HwndSource: WindowContentHolder", "").WPFObject("WindowContentHolder", "", 1).WPFObject("NonLogicalDecorator", "", 1).WPFObject("ThemedManagedContentPresenter", "", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WaitChild(strTemp,9000000000000)
            'Set objConfirm=Sys.Process("EdgeClient").WPFObject("HwndSource: WindowContentHolder", "").WPFObject("WindowContentHolder", "", 1).WPFObject("NonLogicalDecorator", "", 1).WPFObject("ThemedManagedContentPresenter", "", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("DXMessageBox", "", 1)
            If objConfirm.Exists = True Then
                objConfirm.Click
                SYS.Keys "[Enter]"
            End If
          End if 
      Else
        strTestCaseResult = "ABORT"
        Exit Sub  
      End If
 End if 
 End if 
    Call SClosesource()
End Sub

Sub sSourceWorkSpacevwrBM()

    Dim strObject,objEdgeMDI,strTemp,objTemp,GridControl,intRowcnt,intI,intRow,strTempsource,objTempSource
    Dim Watchstr,Watchstr1,Time1,Time2,Watch1
    Dim i,objText
    
   On Error Resume Next
    'strEnvi = "Edge ( Development Test )"    
   ' strLocalname=getSplitValue(strParameters,"WORKSPACENAME")
    'strLocalname="UIT1_1"
    Watchstr=""
    Watchstr1=""
    iTestCaseFirstRow = 0

    Set Watch = HISUtils.StopWatch
    Set Watch1 = HISUtils.StopWatch
  
    Time1="12/12/2012"& " "& "00:00:00"
    Time1=aqConvert.StrToDateTime(Time1)
    Time2=Time1
    new_time=Time
    blnTimeRecorded = False
  
   'strObject = "WPFObject(""HwndSource: RibbonWindow"")"
   Set objEdgeMDI = Sys.Process("EdgeClient")'.WaitChild(strObject, 600000)
   If objEdgeMDI.Exists then
      strTemp="WPFObject(""TextBlock"", ""Layout"", 1)"
      Set objTemp=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,True)
      If objTemp.Exists = False then
        strTemp="WPFObject(""ContentControl"", ""Source Workspace"", 1)"
        Set objTemp=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,True)
        If objTemp.Exists = True then
          objTemp.Click
        End If
        Call sEdgeProcessor
        log.Message "Opening Source Workspace.."
      Else
        log.Message "Source Workspace is opened"
      End If
  
      ''Selecting Records
      strTemp="WPFObject(""PendingChangeGridControl"")"
      Set GridControl=Sys.Process("EdgeClient").FindChild("Name",strTemp,60,True)
      'intRowcnt=GridControl.wRowCount
      intRowcnt=GridControl.VisibleRowCount
      'For intI=0 to intRowcnt-1
        intRow=GridControl.FindRow(1,"Workspace Name")
        
      'Next 
      
    Else
      log.Message "RibbonWindow not found"
    End If
     
     Set objCell = Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("PendingChangeGridControl").WPFObject("PendingChangeTableView").WPFObject("HierarchyPanel", "", 1).WPFObject("RowControl", "", 1).WPFObject("CellsControl", "", 1).WPFObject("LightweightCellEditor", "", 1).WPFObject("InplaceBaseEdit", "", 1)
     objCell.Click    
        
'  For i=1 to intRowcnt        
'    SYS.Keys("![Down]") 
'   
'  Next  
  
    strTemp="WPFObject(""ContentControlEx"", ""Upload Workspace"", 2)"
    Set objTemp=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,True)
      'Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 2).WPFObject("BarButtonItemLinkControl", "", 1).FindChild("Name",strTemp,16,True)
      If objTemp.Exists = True then
        objTemp.Click
        'Exit for
      End If 
      strTemp="WPFObject(""PART_ContainerContent"")"
      Set objConfirm=Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "Please Confirm.")
      If objConfirm.Exists = True then
      objConfirm.Click
        sys.Keys("Y")
        If blnTimeRecorded = False Then
          Watch.Start
          Log.Message("Start Execution time: "  & now)
        End IF
      End if 
 
      
 
'        intI = 0
'        Do Until intI > 3000
'          intI = intI + 1
'          Delay(10000)
        'Set objConfirm = Sys.Process("EdgeClient").Find("ClrClassName","ContentPresenter", 50,True)
      'strTemp="WPFObject(""PART_ContainerContent"")"
      'Set objConfirm=Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "Upload Workspace").FindChild("Name",strTemp,50,True)
      Set objConfirm= Sys.Process("EdgeClient")._
      Waitchild("WPFObject(""HwndSource: CustomMessageBoxWindow"", ""Upload Workspace"")",600000)   
         
         
          If objConfirm.Exists = True Then             
                  objConfirm.Click
                  SYS.Keys("O")                 
                  Watch.Stop
                  blnTimeRecorded = True                  
          End if       
'      
       
      Log.Message("End Source Execution time: "  & now)
      Log.Message("Source finished. Execution time: " & Watch.Tostring)
      strTCRemarks = "Source Execution Time"
      strTCRemarks = strTCRemarks & "  " & Watch.Tostring & " - uploaded a Source successfully"
      Call sEdgeProcessor      
      Call sCloseSWV()
End Sub



Sub sLayoutBM(strParameters)
On Error Resume Next 
    Dim strLevel1layout,strLevel2layout,strLevel3layout,strWrkSpaceName
    Dim objNewWrkSpace_okbtn,objNewWrkSpace_Name
    Dim objNewWrkSpace_Txtbox,objopenforEdit,objWrkspace_popup
    Dim strTemp,objTemp,intRow,barManager,intTotNodeCnt,Text,objCellText,intl,intK,strDesc1,strDesc2
    Dim objWrkSpace,objwrkspacepop,objwrkspcUpload,objConfirm,objGridCell,DescLocalText,intSeriesID,strLocalname

    strLevel1layout=getSplitValue(strParameters,"LEVEL1LAYOUT")
    strLevel2layout=getSplitValue(strParameters,"LEVEL2LAYOUT")
    strLevel3layout=getSplitValue(strParameters,"LEVEL3LAYOUT")
    strLocalname=getSplitValue(strParameters,"WORKSPACENAME")
    intSeriesID=0

'    strLevel1Layout="dX Non-Asia Database (Current Eng Version)"
'    strLevel2Layout="Z-Testing Topic(IT-use only)"
'    strLevel3Layout="Automation_UIT3"
'    strEnvi = "Edge ( US Integration )" 
'    intSeriesID=0



    strDesc1=aqDateTime.Now
    strDesc2=aqDateTime.Now
    DescText=Replace(strDesc1,"/","-")
    DescText=Replace(DescText,":","_")
    DescLocalText=DescText
    strWrkSpaceName=DescText
     
    if intSeriesID=0 then
      Call sLayoutseries
      intSeriesID=strLayoutFileText
    End if 

    Delay 3000,"Please Wait..."

    ''Setting grid Objects

    strTemp="WPFObject(""LayoutTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""LayoutTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,True)
    
    Delay 2000,"Please Wait..."
    ''Selecting Level1 layout
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strLevel1layout) then
          GridControl.Nodes_2.Item(intI).ExpandAll
          log.Message "Level 1 Layout - " & GridControl.Nodes_2.Item(intI).Content.Description       
          blnFlag=False  
          Exit For
        End If
    Next
'    Delay 3000,"Please Wait..."
    If blnFlag = True then
      strTCRemarks="Level 1 Layout not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
  
    Delay 5000,"Please Wait..."
    blnFlag = True 
    ''Selecting Level2 Layout
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
    For intJ=0 to intTotNodeCnt-1
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strLevel2layout) then
        GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).ExpandAll
        log.Message "Level2 layout Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
        blnFlag = False 
        Exit For
      End If
    Next
    If blnFlag = True then
      strTCRemarks="Level2 Source Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If

    Delay 2000,"Please Wait..."
    blnFlag = True    
    ''Selecting Level3 Layout
      intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count
      For intK=0 to intTotNodeCnt-1
        If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description)=Ucase(strLevel3layout) then
          GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).ExpandAll
          intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).get_RowHandle
            Call GridControl.ClearSelectionCore
            Call GridControl.FocusViewAndRow(GridControl,intRow)
            GridControl.SetFocusOnCurrentItem
            Call GridControl.SelectRowCore(intRow)
          log.Message "Level3 layout Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description
          blnFlag = False
          Exit For   
        End If 
      Next
      If blnFlag = True then
        strTCRemarks="Level3 Source Name not found"
        strTestCaseResult="FAIL"
        Exit Sub
      End If
      'Call sCheckLayoutModule(strParameters)
      ''Clicking on "New Workspace" Button and selecting "Open for Edit(Souce)" option   
      strTemp="WPFObject(""ContentControlEx"", ""New Workspace"", 2)"
      Set objNewWorkspace=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,True)
      If objNewWorkspace.Exists = True then
          objNewWorkspace.Click
          strTemp="WPFObject(""BarPopupBorderControl"", """", 1)"
          Set objWrkspace_popup=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,True)
          If objWrkspace_popup.Exists = True then
            strTemp="WPFObject(""ContentControlEx"", ""Open For Edit"", 2)"
            Set objopenforEdit=objWrkspace_popup.FindChild("Name",strTemp,8,True)
            If objopenforEdit.Exists then
              objopenforEdit.Click    
              'Delay 30000,"Please Wait..."
            End If
          End If
      
          strTemp1="WPFObject(""HwndSource: WorkspaceNamePrompt"", ""Please provide a new Workspace Name"")"
          Set objNewWrkSpaceName=Sys.Process("EdgeClient").WaitChild(strTemp1,80000)
          If objNewWrkSpaceName.Exists = True then
            ''Waiting for Workspace Name prompt
            'strTemp="WPFObject(""FloatingContainerBorder"")"
            'strTemp="WPFObject(""PART_ActiveBorder"")"
            'Set objNewWrkSpace_Name=Sys.Process("EdgeClient").WPFObject("HwndSource: WorkspaceNamePrompt", "Please provide a new Workspace Name").WPFObject("WorkspaceNamePrompt", "Please provide a new Workspace Name", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,1500000)
            If objNewWrkSpaceName.Exists = True then
              strTemp="WPFObject(""ChangeNameTextEdit"")"
              ''Entering Workspace Name
              Set objNewWrkSpace_Txtbox=objNewWrkSpaceName.FindChild("Name",strTemp,9,True)
                'Delay 30000,"Please Wait..."
                If objNewWrkSpace_Txtbox.Exists = True then
                  objNewWrkSpace_Txtbox.Click
                  objNewWrkSpace_Txtbox.Text=strWrkSpaceName  
                  'objNewWrkSpace_Txtbox.Text=strLocalname&"_"&strWrkSpaceName                 
                  'msgbox strLocalname&"_"&strWrkSpaceName
                  ''Clicking on Ok Button 
                  strTemp="WPFObject(""OkButton"")"
                  Set objNewWrkSpace_okbtn=objNewWrkSpaceName.FindChild("Name",strTemp,9,True)
                  If objNewWrkSpace_okbtn.Exists = True then
                    objNewWrkSpace_okbtn.Click
                    'Delay 10000,"Please wait..."
                  End If
                 End If
            End If
          End if 
    End If

'    ''Handling Validation for Layout
'    strTemp="WPFObject(""HwndSource: WindowContentHolder"", """")"
'    Set objTemp=Sys.Process("EdgeClient").WaitChild(strTemp,20000)
'    If objTemp.Exists = True then
'      objTemp.Keys "[Enter]"
'      strTestCaseResult = "FAIL"
'      Exit Sub
'    End If

   Delay 5000 

    ''WorkSpace Edit Window
    strTemp="WPFObject(""LayoutPanel"", """", 2)"
    Set objTemp=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,True)
    If objTemp.Exists then
        Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("LayoutTreeListControl").WPFObject("LayoutTreeListView")
        'Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("LayoutTreeListControl").WPFObject("LayoutTreeListView")
        Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("LayoutTreeListControl")
        'Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("LayoutTreeListControl")

        ''Selecting Level1 layout
        intTotNodeCnt=GridControl.Nodes_2.Count
        For intI=0 to intTotNodeCnt-1         
            If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strLevel1layout) then
              GridControl.Nodes_2.Item(intI).ExpandAll
              log.Message "Level 1 Layout - " & GridControl.Nodes_2.Item(intI).Content.Description       
              blnFlag=False  
              Exit For
            End If
        Next
  
        blnFlag = True 
        ''Selecting Level2 Layout
        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
        For intJ=0 to intTotNodeCnt-1
          If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strLevel2layout) then
            GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).ExpandAll
            log.Message "Level2 layout Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
            blnFlag = False 
            Exit For
          End If
        Next
   
        ''Selecting Level3 Layout
          intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count
          For intK=0 to intTotNodeCnt-1
            If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description)=Ucase(strLevel3layout) then
              GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).ExpandAll
              intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).get_RowHandle
              GridControl.Keys "^[Home]"
              intRow=intRow+1
             Set objGridCell=GridControl.WPFObject("HierarchyPanel", "", 1).WPFObject("RowControl", "", 3).WPFObject("CellsControl", "", 1).WPFObject("LightweightCellEditor", "", 2).WPFObject("InplaceBaseEdit", "", 1)
              If objGridCell.Exists = True then
                objGridCell.Click
              End If
              log.Message "Level3 layout Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description
              blnFlag = False
              Exit For   
            End If 
          Next
         
    
        ''Clicking on New Folder
        strTemp="WPFObject(""ContentControlEx"", ""Add Folder"", 2)"
        Set objTemp=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,true)
        If objTemp.Exists = True then
          objTemp.Click  
          Call sEdgeProcessor
          Delay 1000,"New Folder..."
        End If
        
        Dim intRowCount
      
        ''Getting no. of Rows under level 3
        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(0).Nodes.Count
        intl=intTotNodeCnt-1
        intRowCount=intTotNodeCnt
       
        
        Set objCellText=Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("LayoutTreeListControl").WPFObject("LayoutTreeListView").Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Nodes.Item(intL)
          Call objCellText.Content.set_Description(DescText)    
          Call objCellText.Content.set_DescriptionLocal(DescLocalText)
          Call objCellText.Content.set_DisabledFlag(True)
              

         
        ''Attach Series
        strTemp="WPFObject(""ContentControlEx"", ""Attach Series"", 2)"
        Set objTemp=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,true)
        'Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").FindChild("Name",strTemp,15,True)
        If objTemp.Exists = True then
          objTemp.DblClick
          ''Entering Series
          strTemp="WPFObject(""SeriesIdTextEdit"")"
          Set objTemp=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,true)
          'Sys.Process("EdgeClient").WPFObject("HwndSource: LayoutSeriesPrompt", "Attach Layout Series").WPFObject("LayoutSeriesPrompt", "Attach Layout Series", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("SeriesIdTextEdit")
          If objTemp.Exists = True then 
              objTemp.Text=intSeriesID
              Delay(5000)
             ''Clicking on OK Button
             Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: LayoutSeriesPrompt", "Attach Layout Series").WPFObject("LayoutSeriesPrompt", "Attach Layout Series", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContentOffset").WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 1).WPFObject("OkButton")
             'Sys.Process("EdgeClient").WPFObject("HwndSource: LayoutSeriesPrompt", "Attach Layout Series").WPFObject("LayoutSeriesPrompt", "Attach Layout Series", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 1).WPFObject("OkButton")
             If objTemp.Exists = True then
                objTemp.Click
             End If
          End If            
        End If
      
        Call SClosesource()
        Delay 5000
        
       ' Set objTemp = Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("SourceSeriesViewControl").WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("SourceSeriesGridControl").WPFObject("SourceSeriesTableView").WPFObject("HierarchyPanel", "", 1).Waitchild("WPFObject(""RowControl"", """", 1)",600000)
        'Set objTemp = Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("LayoutSeriesViewControl").WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("LayoutSeriesGridControl").WPFObject("LayoutSeriesTableView").WPFObject("HierarchyPanel", "", 1).WPFObject("RowControl", "", 1).WPFObject("CellsControl", "", 1).WPFObject("LightweightCellEditor", "", 1).Waitchild("WPFObject(""InplaceBaseEdit"", """", 1)",180000)  
        'Set objTemp = Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("LayoutSeriesViewControl").WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("LayoutSeriesGridControl").WPFObject("LayoutSeriesTableView").WPFObject("HierarchyPanel", "", 1).WPFObject("RowControl", "", 1).WPFObject("CellsControl", "", 1).WPFObject("LightweightCellEditor", "", 1).WPFObject("InplaceBaseEdit", "", 1)
       'Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", "Edge ( US Production Release Test )").WPFObject("Shell", "Edge ( US Production Release Test )", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("LayoutSeriesViewControl").WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("LayoutSeriesGridControl").WPFObject("LayoutSeriesTableView")
       
        Set objTemp = Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("LayoutSeriesViewControl").WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("LayoutSeriesGridControl").WPFObject("LayoutSeriesTableView").WPFObject("HierarchyPanel", "", 1).Waitchild("WPFObject(""RowControl"", """", 1)",300000)
'        Delay 10000,"Pls Wait... Form is loading..." 
      
       ' Set objTemp = Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("LayoutSeriesViewControl").WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("LayoutSeriesGridControl").WPFObject("LayoutSeriesTableView").Waitchild("WPFObject(""GridColumnHeader"", """", 1)",600000)
        'Set objTemp = Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("LayoutSeriesViewControl").WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("LayoutSeriesGridControl").WPFObject("LayoutSeriesTableView").Waitchild("WPFObject(""GridColumnHeader"", """", 1)",600000)
        Call sEdgeProcessor()
      
        Dim objSaveWrk,ObjWait 
       'set objSaveWrk=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 11).WPFObject("BarSubItemLinkControl", "", 1)
      strTemp="WPFObject(""ContentControlEx"", ""Workspace"", 2)"
      Set objTemp=Sys.Process("EdgeClient").FindChild("Name",strTemp,50)
      objWait=1
      Do until objTemp.Enabled = true 
          If objWait < 200 Then
            Delay 1000,"Pls Wait... Form is loading..."
            objWait=objWait+1
          else
            Call SClosesource()
            Call SourceWorkSpacevwr()
            Exit Sub
          end if 
      Loop  
      
   
      
      ''Disable Flag
      Dim objAttGrid,objAttGridTree,intRowcnt,intAttRow,objAttCell,intR
      'Set objAttGrid=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("LayoutSeriesViewControl").WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("LayoutSeriesGridControl")
      'Delay 1000,"Pls Wait.."
      
''      intR=0
''      For intR=0 to 999
''        Delay(1000)
''        Call objAttGrid.ClickCell(intR, "Disabled Flag")
''    Next 
      GridControl.Keys "^[END]"
      GridControl.Click
      GridControl.Keys("[PageDown]")
      
      
      Dim objLayoutTable,i,j,objRowControl,objCheckBox
      Set objLayoutTable = Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("LayoutTreeListControl").WPFObject("LayoutTreeListView").WPFObject("HierarchyPanel", "", 1)
      ' Set objLayoutTable = Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("LayoutTreeListControl").WPFObject("LayoutTreeListView")
      'Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("LayoutTreeListControl").WPFObject("LayoutTreeListView").WPFObject("HierarchyPanel", "", 1)
      
      objRowControl = objLayoutTable.FindAllChildren("ClrClassName","RowControl", 50,True)
      For i=0 to ubound(objRowControl)
        If objRowControl(i).DataContext.Node_2.Content.Description = DescText Then
           objCheckBox = objRowControl(i).FindAllChildren("ClrClassName","CheckBox", 50,True)
              For j=0 to ubound(objCheckBox)
                 objCheckBox(j).click
                 Call sEdgeProcessor()
                 Delay (2000)
                 objCheckBox(j).click
                 Call sEdgeProcessor()
                 Delay (15000)
              Next
           Exit For
        End If
      Next
      
'      Set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1)
'      objText = objEdge.FindAllChildren("ClrClassName","CheckBox", 50,True)
'        For i=0 to ubound(objText)
'          log.Message objText(i).FullName
'          log.Message objText(i).Name
          'log.Message i
'          If objText(i).Enabled=True Then
'          objText(i).click
'          End if          
'        Next
        
       
'               
'      log.Message i
''      ''Set objCellText= Aliases.EdgeClient.HwndSource_RibbonWindow.RibbonWindow.ContentControl.Grid.Grid.ContentControl.Grid.ContentControl.PART_ContainerContent.BarManager.DockPanel.DockLayoutManager.LayoutGroup.LayoutPanel.Root.BarManager.AdornerDecorator.AdornedControl.Grid.DockPanel2.LayoutTreeListControl.LayoutTreeListView.FindChild("Name",strTemp,150,True)
''      Set objCellText= Aliases.EdgeClient.HwndSource_RibbonWindow.RibbonWindow.ContentControl.Grid.Grid.ContentControl.Grid.ContentControl.PART_ContainerContent.BarManager.DockPanel.DockLayoutManager.LayoutGroup.LayoutPanel.Root.BarManager.AdornerDecorator.AdornedControl.Grid.FindChild("Name",strTemp,150,True)
''      If objCellText.Exists = True then
''        Delay (10000)
''       '' Call Aliases.EdgeClient.HwndSource_RibbonWindow.RibbonWindow.ContentControl.Grid.Grid.ContentControl.Grid.ContentControl.PART_ContainerContent.BarManager.DockPanel.DockLayoutManager.LayoutGroup.LayoutPanel.Root.BarManager.AdornerDecorator.AdornedControl.Grid.DockPanel2.LayoutTreeListControl.LayoutTreeListView.HierarchyPanel.RowControl2.CellsControl.LightweightCellEditor2.PART_Editor.ClickButton(cbUnChecked)
        'objText(i-1).Click
        'objText(1).ClickButton(cbUnChecked)
        'Delay (10000)

    
      'Set objCellText= Aliases.EdgeClient.HwndSource_RibbonWindow.RibbonWindow.ContentControl.Grid.Grid.ContentControl.Grid.ContentControl.PART_ContainerContent.BarManager.DockPanel.DockLayoutManager.LayoutGroup.LayoutPanel.Root.BarManager.AdornerDecorator.AdornedControl.Grid.DockPanel2.LayoutTreeListControl.LayoutTreeListView.FindChild("Name",strTemp,150,True)
    '  If objCellText.Exists = True then
'        Call Aliases.EdgeClient.HwndSource_RibbonWindow.RibbonWindow.ContentControl.Grid.Grid.ContentControl.Grid.ContentControl.PART_ContainerContent.BarManager.DockPanel.DockLayoutManager.LayoutGroup.LayoutPanel.Root.BarManager.AdornerDecorator.AdornedControl.Grid.DockPanel2.LayoutTreeListControl.LayoutTreeListView.HierarchyPanel.RowControl2.CellsControl.LightweightCellEditor2.PART_Editor.Click
'        Delay (10000)
'        Call Aliases.EdgeClient.HwndSource_RibbonWindow.RibbonWindow.ContentControl.Grid.Grid.ContentControl.Grid.ContentControl.PART_ContainerContent.BarManager.DockPanel.DockLayoutManager.LayoutGroup.LayoutPanel.Root.BarManager.AdornerDecorator.AdornedControl.Grid.DockPanel2.LayoutTreeListControl.LayoutTreeListView.HierarchyPanel.RowControl2.CellsControl.LightweightCellEditor2.PART_Editor.ClickButton(cbChecked)
'        Delay (10000)
        'objText(i-1).Click
        'objText(1).ClickButton(cbChecked)
        'Delay (10000)
       
    '  End If 
      
'      Call objCellText.Content.set_DisabledFlag(False)
'      Delay 1000
'      Call objCellText.Content.set_DisabledFlag(True)
      'Aliases.EdgeClient.HwndSource_RibbonWindow.RibbonWindow.ContentControl.Grid.Grid.ContentControl.Grid.ContentControl.PART_ContainerContent.BarManager.DockPanel.DockLayoutManager.LayoutGroup.LayoutPanel.Root.BarManager.AdornerDecorator.AdornedControl.Grid.DockPanel2.LayoutTreeListControl.LayoutTreeListView.HierarchyPanel.RowControl3.CellsControl.LightweightCellEditor.RowData.Row.DisabledFlag=True
      'GridControl.Keys "^[End]"
     ' GridControl.Click
      ''Call sEdgeProcessor  
     ' SYS.Keys("[Up]")
      Call sEdgeProcessor  
    ''Uploading WorkSpace
    strTemp="WPFObject(""ContentControlEx"", ""Workspace"", 2)"
    Set objWrkSpace=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,true)
    If objWrkSpace.Exists = True then
      objWrkSpace.Click
'      strTemp="WPFObject(""BarPopupBorderControl"", """", 1)"
'      Set objwrkspacepop=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1)
      If objWrkSpace.Exists = True then
        strTemp="WPFObject(""ContentControlEx"", ""Save Workspace"", 2)"
        set objwrkspcUpload=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,True)
        If objwrkspcUpload.Exists = True then
          objwrkspcUpload.Click
          'Delay 5000,"Pls Wait.."
          strTemp="WPFObject(""PART_ContainerContent"")"
          Set objConfirm=Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "Confirm save.").WPFObject("CustomMessageBoxWindow", "Confirm save.", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContentOffset").WPFObject("Grid", "", 1).WaitChild(strTemp,180000)
          If objConfirm.Exists = True then
            objConfirm.Click
            sys.Keys("Y")
            
            Set objConfirm = Sys.Process("EdgeClient")._
            Waitchild("WPFObject(""HwndSource: CustomMessageBoxWindow"", """")",180000)'._
'            Waitchild("WPFObject(""CustomMessageBoxWindow"", """", 1)",60000)._
'            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
'            Waitchild("WPFObject(""FloatingContainerBorder"")",60000)._
'            Waitchild("WPFObject(""FloatingContainerBackground"")",60000)._
'            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
'            Waitchild("WPFObject(""FloatingContainerBody"")",60000)._
'            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
'            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
'            Waitchild("WPFObject(""PART_ContainerContent"")",60000)
            
            If objConfirm.Exists = True Then
                objConfirm.Click
                SYS.Keys "[Enter]"
            End If
            
            End If                            
          End If
        End If
      End If
    End If
 'End if
    Call sCloseLayout
End Sub

'Sub sLayoutWorkSpacevwrBM()
'
'    Dim strObject,objEdgeMDI,strTemp,objTemp,GridControl,intRowcnt,intI,intRow
'    Dim Watchstr,Watchstr1,Time1,Time2,Watch1
'    Dim i,objText
'    
'On Error Resume Next
'
'    Watchstr=""
'    Watchstr1=""
'    iTestCaseFirstRow = 0
'
'    Set Watch = HISUtils.StopWatch
'    Set Watch1 = HISUtils.StopWatch
'  
'    Time1="12/12/2012"& " "& "00:00:00"
'    Time1=aqConvert.StrToDateTime(Time1)
'    Time2=Time1
'    new_time=Time
'    
'    strObject = "WPFObject(""HwndSource: RibbonWindow"")"
'    Set objEdgeMDI = Sys.Process("EdgeClient").WaitChild(strObject, 600000)
'    If objEdgeMDI.Exists then
'      strTemp="WPFObject(""TextBlock"", ""Layout"", 1)"
'      Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,14,True)
'      If objTemp.Exists = False then
'        strTemp="WPFObject(""ContentControl"", ""Layout Workspace"", 1)"
'        Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).FindChild("Name",strTemp,16,True)
'        If objTemp.Exists = True then
'          objTemp.Click
'        End If
'        Call sEdgeProcessor
'        log.Message "Opening Layout Workspace.."
'      Else
'        log.Message "Layout Workspace is opened"
'      End If
'  
'      ''Selecting Records
'      strTemp="WPFObject(""PendingChangeGridControl"")"
'      Set GridControl=Sys.Process("EdgeClient").FindChild("Name",strTemp,60,True)
'      intRowcnt=GridControl.wRowCount
'      'For intI=0 to intRowcnt-1
'        intRow=GridControl.FindRow(1,"Workspace Name")
'        Call GridControl.ClickCell(0,1)
'      'Next 
'      
'    Else
'      log.Message "RibbonWindow not found"
'    End If
'    
'    strObject = "WPFObject(""HwndSource: RibbonWindow"")"
'    Set objEdgeMDI = Sys.Process("EdgeClient").WaitChild(strObject, 600000)
'    If objEdgeMDI.Exists then
'      strTemp="WPFObject(""TextBlock"", ""Layout"", 1)"
'      Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,14,True)
'      If objTemp.Exists = False then
'        strTemp="WPFObject(""ContentControl"", ""Layout Workspace"", 1)"
'        Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).FindChild("Name",strTemp,16,True)
'        If objTemp.Exists = True then
'          objTemp.Click
'        End If
'       
'        Call sEdgeProcessor
'        log.Message "Opening Layout Workspace.."
'      Else
'        log.Message "Layout Workspace is opened"
'      End If
'  
'      ''Selecting Records
'      strTemp="WPFObject(""PendingChangeGridControl"")"
'      Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).FindChild("Name",strTemp,60,True)
'      intRowcnt=GridControl.wRowCount
'      'For intI=0 to intRowcnt-1
'        intRow=GridControl.FindRow(1,"Workspace Name")
'        Call GridControl.ClickCell(1,1)
'     ' Next 
'      
'    Else
'      log.Message "RibbonWindow not found"
'    End If
'    
'      strTemp="WPFObject(""ContentControlEx"", ""Upload Workspace"", 2)"
'     'Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 2).WPFObject("BarButtonItemLinkControl", "", 1).FindChild("Name",strTemp,16,True)
'     Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 2).WPFObject("BarButtonItemLinkControl", "", 1).FindChild("Name",strTemp,16,True)
'      If objTemp.Exists = True then
'        objTemp.Click
'      End If 
'      
'      strTemp="WPFObject(""PART_ContainerContent"")"
'      Set objConfirm=Sys.Process("EdgeClient").WPFObject("HwndSource: WindowContentHolder", "Please Confirm.").FindChild("Name",strTemp,50,True)
'      strTemp="WPFObject(""DXMessageBox"", """", 1)"
'      Set objConfirm=objConfirm.WaitChild(strTemp,300000)
'      If objConfirm.Exists = True then
'        sys.Keys("^Y")
'        If blnTimeRecorded = False Then
'          Watch.Start
'          Log.Message("Start Execution time: "  & now)
'        End IF
'      End if 
'    
'      strTemp="WPFObject(""ContentControlEx"", ""Upload Workspace"", 2)"
'      'Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 2).WPFObject("BarButtonItemLinkControl", "", 1).FindChild("Name",strTemp,16,True)
'      Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 2).WPFObject("BarButtonItemLinkControl", "", 1).FindChild("Name",strTemp,16,True)
'      If objTemp.Exists = True then
'        objTemp.Click
'      End If
'      
'      strTemp="WPFObject(""PART_ContainerContent"")"
'      Set objConfirm=Sys.Process("EdgeClient").WPFObject("HwndSource: WindowContentHolder", "Please Confirm.").WPFObject("WindowContentHolder", "Please Confirm.", 1).FindChild("Name",strTemp,50,True)
'      strTemp="WPFObject(""DXMessageBox"", """", 1)"
'      Set objConfirm=objConfirm.WaitChild(strTemp,300000)
'      If objConfirm.Exists = True then
'        sys.Keys("^Y")
'        If blnTimeRecorded = False Then
'          Watch1.Start
'          Log.Message("Start First Layout Execution time: "  & now)
'        End IF 
'      End if
' 
'        intI = 0
'        Do Until intI > 5000
'          intI = intI + 1
'          Delay(1000)
'        Set objConfirm = Sys.Process("EdgeClient").Find("ClrClassName","DXMessageBox", 50,True)
'          If objConfirm.Exists = True Then 
'            If objConfirm.Focusable=True  then
'                  SYS.Keys "[Enter]" 
'                  Watch.Stop
'                  blnTimeRecorded = True
'              Exit Do
'            End  If
'          End if       
'        Loop
'       
'      Log.Message("End First Layout Execution time: "  & now)
'      Log.Message("First Layout finished. Execution time: " & Watch.Tostring)
'            
'      strTCRemarks = strTCRemarks & "<br />" & "First Layout Execution Time"
'      strTCRemarks = strTCRemarks & "  " & Watch.Tostring & " - uploaded a Layout successfully"
'      
'      strTemp="WPFObject(""PART_ContainerContent"")"
'  
'      intI = 0
'        Do Until intI > 5000
'          intI = intI + 1
'          Delay(5000)
'          Set objConfirm = Sys.Process("EdgeClient").Find("ClrClassName","DXMessageBox", 50,True)
'          If objConfirm.Exists = True Then 
'            If objConfirm.Focusable=True then
'               objText = Sys.Process("EdgeClient").FindAllChildren("ClrClassName","DXMessageBox", 50,True)
'                For i=0 to ubound(objText)
'                  log.Message objText(i).FullName
'                  log.Message objText(i).Name
'                  objText(i).Click 
'                  SYS.Keys "[Enter]"
'                  Watch1.Stop
'                  blnTimeRecorded = True
'                  Exit For 
'                Next 
'              Exit Do
'            End  If
'          End if       
'        Loop
'  
'       
'        
'        Log.Message("End Second Layout Execution time: "  & now)
'        Log.Message("Second Layout finished. Execution time: " & Watch1.Tostring)
'        
'        strTCRemarks = strTCRemarks & "<br />" & "Second Layout Execution Time"
'        strTCRemarks = strTCRemarks & "  " & Watch1.Tostring & " - uploaded a Layout successfully"
'        
'        Call sEdgeProcessor
'        Call sCloseLayout
'        Call sCloseLayout
'
'End Sub

'Sub sLayoutWorkSpacevwrBM(strParameters)
Sub sLayoutWorkSpacevwrBM()

    Dim strObject,objEdgeMDI,strTemp,objTemp,GridControl,intRowcnt,intI,intRow
    Dim Watchstr,Watchstr1,Time1,Time2,Watch1,strLocalname
    Dim i,objText
    
On Error Resume Next
 ' strLocalname=getSplitValue(strParameters,"WORKSPACENAME")

    Watchstr=""
    Watchstr1=""
    iTestCaseFirstRow = 0

    Set Watch = HISUtils.StopWatch
    Set Watch1 = HISUtils.StopWatch
    
    blnTimeRecorded = False
  
    Time1="12/12/2012"& " "& "00:00:00"
    Time1=aqConvert.StrToDateTime(Time1)
    Time2=Time1
    new_time=Time
    
    'strObject = "WPFObject(""HwndSource: RibbonWindow"")"
    Set objEdgeMDI = Sys.Process("EdgeClient")'.WaitChild(strObject, 600000)
    If objEdgeMDI.Exists then
      strTemp="WPFObject(""TextBlock"", ""Layout"", 1)"
      Set objTemp=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,True)
      If objTemp.Exists = False then
        strTemp="WPFObject(""ContentControl"", ""Layout Workspace"", 1)"
        Set objTemp=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,True)
        If objTemp.Exists = True then
          objTemp.Click
        End If
        Call sEdgeProcessor
        log.Message "Opening Layout Workspace.."
      Else
        log.Message "Layout Workspace is opened"
      End If
  
      ''Selecting Records
      strTemp="WPFObject(""PendingChangeGridControl"")"
      Set GridControl=Sys.Process("EdgeClient").FindChild("Name",strTemp,60,True)
      'intRowcnt=GridControl.wRowCount
      'For intI=0 to intRowcnt-1
        'intRow=GridControl.FindRow(1,"Workspace Name")
        intRowcnt=GridControl.VisibleRowCount
        intRow=GridControl.FindRow(1,"Workspace Name")
       ' intRow=GridControl.VisibleRowCount
        Set objCell = Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("PendingChangeGridControl").WPFObject("PendingChangeTableView").WPFObject("HierarchyPanel", "", 1).WPFObject("RowControl", "", 1).WPFObject("CellsControl", "", 1).WPFObject("LightweightCellEditor", "", 1).WPFObject("InplaceBaseEdit", "", 1)
        objCell.Click
        'Call GridControl.ClickCell(0,1)
      'Next 
      
    Else
      log.Message "RibbonWindow not found"
    End If
    
   'r=0 
  'For i=1 to intRowcnt  
    'Call GridControl.ClickCell(r,1)   
      strTemp="WPFObject(""ContentControlEx"", ""Upload Workspace"", 2)"
      Set objTemp=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,True)
      If objTemp.Exists = True then
        objTemp.Click
       ' Exit for
      End If 
      'r=r+1
 ' Next  
      
      strTemp="WPFObject(""PART_ContainerContent"")"
      Set objConfirm=Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "Please Confirm.")'.FindChild("Name",strTemp,50,True)
'      strTemp="WPFObject(""DXMessageBox"", """", 1)"
'      Set objConfirm=objConfirm.WaitChild(strTemp,300000)
      If objConfirm.Exists = True then
        objConfirm.Click
        sys.Keys("Y")
        If blnTimeRecorded = False Then
          Watch.Start
          Log.Message("Start Execution time: "  & now)
        End IF
      End if 
    
'        intI = 0
'        Do Until intI > 5000
'          intI = intI + 1
'          Delay(1000)
'        Set objConfirm = Sys.Process("EdgeClient").Find("ClrClassName","ContentPresenter", 50,True)
'          If objConfirm.Exists = True Then 
'            If objConfirm.Focusable=True  then
'                  SYS.Keys "[Enter]" 
'                  Watch.Stop
'                  blnTimeRecorded = True
'              Exit Do
'            End  If
'          End if       
'        Loop
'       

 Set objConfirm= Sys.Process("EdgeClient")._
      Waitchild("WPFObject(""HwndSource: CustomMessageBoxWindow"", ""Upload Workspace"")",600000)

      If objConfirm.Exists = True Then 
        objConfirm.Click
        SYS.Keys("O")
        Watch.Stop
        blnTimeRecorded = True
      End if       

      Log.Message("Layout finished. Execution time: " & Watch.Tostring)
            
      strTCRemarks = strTCRemarks & "<br />" & "Layout Execution Time"
      strTCRemarks = strTCRemarks & "  " & Watch.Tostring & " - uploaded a Layout successfully"
      
        Call sEdgeProcessor       
        Call sCloseLayout

End Sub


Sub sExcelFullHistorySTP(strExcel)

  Dim strTemp,CreateSTP,PropArray,ValuesArray,objTemp,ReplaceFile 
  
On Error Resume Next

  strTemp = "WinFormsObject(""TimeRangePickerForm"")"  
  Set CreateSTP=Sys.Process("EXCEL",Cint(strExcel)).WaitChild(strTemp,100000)
  If CreateSTP.Exists = True Then
    PropArray = Array("WndCaption", "Visible")
    ValuesArray = Array("Full History", True)
    Set objTemp = CreateSTP.FindChild(PropArray, ValuesArray, 50)
    'Delay (20000)
    If objTemp.Exists = True Then
      objTemp.Click
      log.Message "Selected Full History Radio button"
    Else
      log.Message "Full History Radio button not found"
    End If    
'    strTemp="WinFormsObject(""FullHistoryButton"")"
'    Set objTemp = CreateSTP.FindChild(Name,strTemp,50)
'    If objTemp.Exists = True Then
'      objTemp.Click
'    End If
    PropArray = Array("WndCaption", "Visible")
    ValuesArray = Array("Open", True)
    Set objTemp = CreateSTP.FindChild(PropArray, ValuesArray, 10)
    Delay 200,"Opening STP.. Pls wait.."
    If objTemp.Exists = True Then
      objTemp.Click
    End If
    

     'Delay 40000,"Pls Wait..." 
    strTemp="WinFormsObject(""SelectFreqForm"")"      
    Set objTemp=Sys.Process("EXCEL",Cint(strExcel)).WaitChild(strTemp,50000)    
     If objTemp.Exists Then
        strTemp="WinFormsObject(""radButton1"")"
        Set objTemp=objTemp.FindChild("Name",strTemp,5)
        If objTemp.Exists = True then
          objTemp.Click
          Delay 30000,"Pls Wait..."
        End If
      Else
         Set File = Sys.Process("EXCEL", Cint(strExcel)).Waitchild("WPFObject(""HwndSource: CustomMessageBoxWindow"", ""Warning"")",20000)       
          If (File.Exists) Then
            strTemp = "WPFObject(""Button_Yes"")"         
               Set objYes = File.FindChild("Name", strTemp,50, True)
               If objYes.Exists = True Then
                  objYes.Click
               End If
               Delay 5000              
          End If
    End If
    
    
    'Delay 10000,"Pls Wait..." 

  Else
    log.Message "STP File not found"
    strTCRemarks="STP File not found"
    blnCriticalErrorFound = True
    strCriticalError = "Unable to find STP file"
    strTestCaseResult = "FAIL"
    blnSTPfile=True
    Call ExcelProcessKill
    Exit Sub
  End If

  Set CreateSTP=Nothing  
  Set objTemp=Nothing

End Sub

Sub sCheckSourceModule(strParameters)

On Error Resume Next 
    Dim strLevel1layout,strLevel2layout,strLevel3layout,strWrkSpaceName
    Dim objNewWrkSpace_okbtn,objNewWrkSpace_Name
    Dim objNewWrkSpace_Txtbox,objopenforEdit,objWrkspace_popup
    Dim strTemp,objTemp,intRow,barManager,intTotNodeCnt,Text,objCellText,intl,intK,strDesc1,strDesc2
    Dim objWrkSpace,objwrkspacepop,objwrkspcUpload,objConfirm,objGridCell,DescLocalText,intSeriesID
    Call sLoadLayout()
    
    strLevel1layout=getSplitValue(strParameters,"LEVEL1LAYOUT")
    strLevel2layout=getSplitValue(strParameters,"LEVEL2LAYOUT")
    strLevel3layout=getSplitValue(strParameters,"LEVEL3LAYOUT")

    Delay 3000,"Please Wait..."

    strTemp="WPFObject(""SourceTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""SourceTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    
    ''Selecting Country Name
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource_Name) then
          GridControl.Nodes_2.Item(intI).Expand(True)
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description       
          blnFlag=False  
          Exit For
        End If
    Next
    If blnFlag = True then
      strTCRemarks="Country Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
  
    Delay 2000,"Pls Wait.."
        blnFlag = True 
    ''Selecting Level2Source_Name
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
    For intJ=0 to intTotNodeCnt-1
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strLevel2src_Name) then
        GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
        intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
        Call GridControl.ClearSelectionCore
        Call GridControl.FocusViewAndRow(GridControl,intRow)
        GridControl.SetFocusOnCurrentItem
        Call GridControl.SelectRowCore(intRow)
        log.Message "Level2 Source Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
        blnFlag = False 
        Exit For
      End If
    Next
    If blnFlag = True then
      log.Message "Level2 Source Name not found"
      strTCRemarks="Level2 Source Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
End Sub
Sub  sCheckLayoutViewWorkspaceRightClick()
On Error Resume Next 

    Dim strTemp,objNewWorkspace,objopenforEdit,strTemp1,objNewWrkSpaceName
    Dim intTotNodeCnt,intI,intJ,intK,strOk
    Dim objBounds,rect

    strLevel1layout="dX Non-Asia Database (Current Eng Version)"
    strLevel2layout="Z-Topic Test(IT-use only)"
    strLevel3layout="Automation_UIT4"
    
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("LayoutTreeControl").WPFObject("LayoutTreeListView")
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("LayoutTreeControl")
    Delay 1000,"Please Wait..."
        ''Selecting Level1 layout
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        GridControl.SelectNode(GridControl.Nodes_2.Item(intI))        
        GridControl.set_FocusedNode(GridControl.Nodes_2.Item(intI))
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strLevel1layout) then
          GridControl.Nodes_2.Item(intI).Expand(True)
          log.Message "Level 1 Layout - " & GridControl.Nodes_2.Item(intI).Content.Description       
          blnFlag=False
          Exit For
        End If
        GridControl.ClearSelection
    Next
        Delay 3000,"Please Wait..."
        If blnFlag = True then
          strTCRemarks="Level 1 Layout not found"
          strTestCaseResult="FAIL"
          Exit Sub
        End If
  
        blnFlag = True 
        ''Selecting Level2 Layout
        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
        For intJ=0 to intTotNodeCnt-1
          GridControl.SelectNode(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ))          
          GridControl.set_FocusedNode(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ))
          If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strLevel2layout) then
            GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
            log.Message "Level2 layout Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
            blnFlag = False 
            Exit For
          End If
          GridControl.ClearSelection
        Next
        If blnFlag = True then
          strTCRemarks="Level2 Source Name not found"
          strTestCaseResult="FAIL"
          Exit Sub
        End If
        delay(3000)
        blnFlag = True    
        ''Selecting Level3 Layout
          intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count
          
          For intK=0 to intTotNodeCnt-1
            GridControl.SelectNode(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK))
            GridControl.set_FocusedNode(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK))
            
            If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description)=Ucase(strLevel3layout) then
              GridControl.SelectNode(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK + 1))
              
            dim PropArray,ValueArray, objTemp, left, Top
                   
              PropArray = Array("ClrClassName", "EditValue")
              ValuesArray = Array("EditorControlStub", "Automation_UIT4")
              Set objTemp = GridControl.FindChild(PropArray, ValuesArray, 8)
  
              If objTemp.Exists = True Then
                left =  objTemp.ActualWidth/2
                Top =  objTemp.ActualHeight/2    
                Call objTemp.ClickR(left, Top, 0)
              Else
                Msgbox "Required Cell doesn't found"
              End If
              log.Message "Level3 layout Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description
              blnFlag = False
              Exit For   
            End If 
            GridControl.ClearSelection
          Next
          If blnFlag = True then
            strTCRemarks="Level3 Source Name not found"
            strTestCaseResult="FAIL"
            Exit Sub
          End If
End sub
Sub  sCheckLayoutAddfolderViewWorkspace(strParameters)
On Error Resume Next 

    Dim strTemp,objNewWorkspace,objopenforEdit,strTemp1,objNewWrkSpaceName
    Dim intTotNodeCnt,intI,intJ,intK,strOk
     
    Call sloadlayout 
    Call sCheckLayoutExpandTree(strParameters)
    strLevel1layout=getSplitValue(strParameters,"LEVEL1LAYOUT")
    strLevel2layout=getSplitValue(strParameters,"LEVEL2LAYOUT")
    strLevel3layout=getSplitValue(strParameters,"LEVEL3LAYOUT")

'    strLevel1layout="dX Non-Asia Database (Current Eng Version)"
'    strLevel2layout="Z-Testing Topic(IT-use only)"
'    strLevel3layout=""
'    strLevel3layout="Sandbox (Benny)"
    
      strTemp="WPFObject(""ArrowControl"", """", 1)"
      Set objNewWorkspace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarSubItemLinkControl", "", 1).FindChild("Name",strTemp,2,True)
      If objNewWorkspace.Exists = True then
        objNewWorkspace.Click
        strTemp="WPFObject(""BarPopupBorderControl"", """", 1)"
        Set objWrkspace_popup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").FindChild("Name",strTemp,15,True)
        If objWrkspace_popup.Exists = True then
          strTemp="WPFObject(""ContentControlEx"", ""Open For View"", 2)"
          Set objopenforEdit=objWrkspace_popup.FindChild("Name",strTemp,8,True)
          If objopenforEdit.Exists then
            objopenforEdit.Click
            Call sEdgeProcessor
            log.Message "Workspace created for view only"
            strTCRemarks="Workspace created for view only"
          Else
            Exit Sub 
          End If
        End If
      End if
       ''Handling Validation for Layout
    strTemp="WPFObject(""HwndSource: WindowContentHolder"", """")"
    Set objTemp=Sys.Process("EdgeClient").WaitChild(strTemp,20000)
    If objTemp.Exists = True then
      objTemp.Keys "[Enter]"
      strTestCaseResult = "FAIL"
      Exit Sub
    End If

    ''WorkSpace Edit Window
    strTemp="WPFObject(""LayoutPanel"", """", 2)"
    Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,13,True)
    If objTemp.Exists then
        Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("LayoutTreeListControl").WPFObject("LayoutTreeListView")
        Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("LayoutTreeListControl")

        ''Selecting Level1 layout
        intTotNodeCnt=GridControl.Nodes_2.Count
        For intI=0 to intTotNodeCnt-1         
            If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strLevel1layout) then
              GridControl.Nodes_2.Item(intI).Expand(True)
              log.Message "Level 1 Layout - " & GridControl.Nodes_2.Item(intI).Content.Description       
              blnFlag=False  
              Exit For
            End If
        Next
  
        blnFlag = True 
        ''Selecting Level2 Layout
        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
        For intJ=0 to intTotNodeCnt-1
          If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strLevel2layout) then
            GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
            log.Message "Level2 layout Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
            GridControl.Keys "^[Home]"
            GridControl.Keys "[Down]"
            blnFlag = False 
            Exit For
          End If
        Next
       
        ''Clicking on New Folder
    '   strTemp="WPFObject(""BarButtonItemLinkControl"", """", 1)"
        Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 4).WPFObject("BarButtonItemLinkControl", "", 1)
        If objTemp.Exists = True then
'          objTemp.DblClick    
          objTemp.Click  
          'Call sEdgeProcessor
          Delay 1000,"New Folder..."
          
       strTemp="WPFObject(""PART_ContainerContent"")"
      Set strOk=Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "Workspace").WPFObject("CustomMessageBoxWindow", "Workspace", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,550000)
        strTemp="WPFObject(""DXMessageBox"", """", 1)"
        Set objConfirm=objConfirm.WaitChild(strTemp,300000)
        If objConfirm.Exists = True then
          sys.Keys "[Enter]"
        End if   
        End If
     End if 
      Call sCloseLayout
      Call sCloseLayout
End sub

Sub sCheckLayoutModulePopup(strParameters)

On Error Resume Next 
    Dim strLevel1layout,strLevel2layout,strLevel3layout,strWrkSpaceName
    Dim objNewWrkSpace_okbtn,objNewWrkSpace_Name,objNewWrkSpaceName
    Dim objNewWrkSpace_Txtbox,objopenforEdit,objWrkspace_popup
    Dim strTemp,objTemp,intRow,barManager,intTotNodeCnt,Text,objCellText,intI,intK,strDesc1,strDesc2,intJ
    Dim objWrkSpace,objwrkspacepop,objwrkspcUpload,objConfirm,objGridCell,DescLocalText,intSeriesID,GridControl,GridSourceTree

    Call sloadlayout 
    Call sCheckLayoutExpandTree(strParameters)
    
    strLevel1layout=getSplitValue(strParameters,"LEVEL1LAYOUT")
    strLevel2layout=getSplitValue(strParameters,"LEVEL2LAYOUT")
    strLevel3layout=getSplitValue(strParameters,"LEVEL3LAYOUT")
    
'    strLevel1layout="dX Non-Asia Database (Current Eng Version)"
'    strLevel2layout="Z-Testing Topic(IT-use only)"
'    strLevel3layout="Sandbox (Benny)"


    

   Delay 3000,"Please Wait..."
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("LayoutTreeControl").WPFObject("LayoutTreeListView")
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("LayoutTreeControl")
    if strLevel1layout <> "" and strLevel2layout <> "" AND strLevel3layout <> "" then
        Delay 1000,"Please Wait..."
        ''Selecting Level1 layout
        intTotNodeCnt=GridControl.Nodes_2.Count
        For intI=0 to intTotNodeCnt-1         
            If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strLevel1layout) then
              GridControl.Nodes_2.Item(intI).Expand(True)
              log.Message "Level 1 Layout - " & GridControl.Nodes_2.Item(intI).Content.Description       
              blnFlag=False  
              Exit For
            End If
        Next
        Delay 3000,"Please Wait..."
        If blnFlag = True then
          strTCRemarks="Level 1 Layout not found"
          strTestCaseResult="FAIL"
          Exit Sub
        End If
  
        blnFlag = True 
        ''Selecting Level2 Layout
        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
        For intJ=0 to intTotNodeCnt-1
          If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strLevel2layout) then
            GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
            log.Message "Level2 layout Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
            blnFlag = False 
            Exit For
          End If
        Next
        If blnFlag = True then
          strTCRemarks="Level2 Source Name not found"
          strTestCaseResult="FAIL"
          Exit Sub
        End If
        delay(3000)
        blnFlag = True    
        ''Selecting Level3 Layout
          intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count
          For intK=0 to intTotNodeCnt-1
            If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description)=Ucase(strLevel3layout) then
              GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Expand(True)
              intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).get_RowHandle

              Call GridControl.ClearSelectionCore
              Call GridControl.FocusViewAndRow(GridControl,intRow)
              GridControl.SetFocusOnCurrentItem
              Call GridControl.SelectRowCore(intRow)
              log.Message "Level3 layout Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description
              blnFlag = False
              Exit For   
            End If 
          Next
          If blnFlag = True then
            strTCRemarks="Level3 Source Name not found"
            strTestCaseResult="FAIL"
            Exit Sub
          End If
    Elseif strLevel2layout<> "" AND strLevel3layout = "" then
       Delay 1000,"Please Wait..."
        ''Selecting Level1 layout
        intTotNodeCnt=GridControl.Nodes_2.Count
        For intI=0 to intTotNodeCnt-1         
            If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strLevel1layout) then
              GridControl.Nodes_2.Item(intI).Expand(True)
              intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
              Call GridControl.ClearSelectionCore
              Call GridControl.FocusViewAndRow(GridControl,intRow)
              GridControl.SetFocusOnCurrentItem
              Call GridControl.SelectRowCore(intRow)
              log.Message "Level 1 Layout - " & GridControl.Nodes_2.Item(intI).Content.Description       
              blnFlag=False  
              Exit For
            End If
        Next
        Delay 3000,"Please Wait..."
        If blnFlag = True then
          strTCRemarks="Level 1 Layout not found"
          strTestCaseResult="FAIL"
          Exit Sub
        End If
  
        blnFlag = True 
        ''Selecting Level2 Layout
        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
        For intJ=0 to intTotNodeCnt-1
          If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strLevel2layout) then
            GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
            intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
            GridControl.set_FocusedRowHandle(intRow)
            GridControl.Keys("[Down]")
            GridControl.Keys("[Up]")
            log.Message "Level2 layout Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
            blnFlag = False 
            Exit For
          End If
        Next
        If blnFlag = True then
          strTCRemarks="Level2 Source Name not found"
          strTestCaseResult="FAIL"
          Exit Sub
        End If 
    Elseif strLevel2layout="" then
      Delay 1000,"Please Wait..."
        ''Selecting Level1 layout
        intTotNodeCnt=GridControl.Nodes_2.Count
        For intI=0 to intTotNodeCnt-1         
            If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strLevel1layout) then
              GridControl.Nodes_2.Item(intI).Expand(True)
              intRow=GridControl.Nodes_2.Item(intI).get_RowHandle
              GridControl.set_FocusedRowHandle(intRow)
              GridControl.Keys("[Down]")
              GridControl.Keys("[Up]")
              log.Message "Level 1 Layout - " & GridControl.Nodes_2.Item(intI).Content.Description       
              blnFlag=False  
              Exit For
            End If
        Next
        Delay 3000,"Please Wait..."
        If blnFlag = True then
          strTCRemarks="Level 1 Layout not found"
          strTestCaseResult="FAIL"
          Exit Sub
        End If
    End if
      Call sCheckLayoutModule(strParameters)
      
      ''Clicking on "New Workspace" Button and selecting "Open for Edit(Souce)" option   
      strTemp="WPFObject(""ArrowControl"", """", 1)"
      Set objNewWorkspace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarSubItemLinkControl", "", 1).FindChild("Name",strTemp,2,True)
      If objNewWorkspace.Exists = True then
        objNewWorkspace.Click
        strTemp="WPFObject(""BarPopupBorderControl"", """", 1)"
        Set objWrkspace_popup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").FindChild("Name",strTemp,5,True)
        If objWrkspace_popup.Exists = True then
          strTemp="WPFObject(""ContentControlEx"", ""Open For Edit"", 2)"
          Set objopenforEdit=objWrkspace_popup.FindChild("Name",strTemp,8,True)
          If objopenforEdit.Exists then
            objopenforEdit.Click    
            'Delay 30000,"Please Wait..."
          End If
        End If
      
      strTemp1="WPFObject(""HwndSource: WorkspaceNamePrompt"", ""Please provide a new Workspace Name"")"
      Set objNewWrkSpaceName=Sys.Process("EdgeClient").WaitChild(strTemp1,80000)
      If objNewWrkSpaceName.Exists = True then
        Sys.Process("EdgeClient").WPFObject("HwndSource: WorkspaceNamePrompt", "Please provide a new Workspace Name").WPFObject("WorkspaceNamePrompt", "Please provide a new Workspace Name", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 1).WPFObject("CancelButton").Click
      End if 
    End If
    
        Call sCloseLayout
        Delay 10000,"Closing Layout..." 
        
End Sub
Sub sCheckLayoutModulePopupOk(strParameters)

On Error Resume Next 
    Dim strLevel1layout,strLevel2layout,strLevel3layout,strWrkSpaceName
    Dim objNewWrkSpace_okbtn,objNewWrkSpace_Name
    Dim objNewWrkSpace_Txtbox,objopenforEdit,objWrkspace_popup
    Dim strTemp,objTemp,intRow,barManager,intTotNodeCnt,Text,objCellText,intl,intK,strDesc1,strDesc2
    Dim objWrkSpace,objwrkspacepop,objwrkspcUpload,objConfirm,objGridCell,DescLocalText,intSeriesID

    Call sloadlayout 
    Call sCheckLayoutExpandTree(strParameters)
    
    strLevel1layout=getSplitValue(strParameters,"LEVEL1LAYOUT")
    strLevel2layout=getSplitValue(strParameters,"LEVEL2LAYOUT")
    strLevel3layout=getSplitValue(strParameters,"LEVEL3LAYOUT")
    
'    strLevel1layout="dX Non-Asia Database (Current Eng Version)"
'    strLevel2layout="Z-Testing Topic(IT-use only)"
'    strLevel3layout="Sandbox (Benny)"
'    intSeriesID="369145097"

    strDesc1=aqDateTime.Now
    strDesc2=aqDateTime.Now
    DescText=Replace(strDesc1,"/","-")
    DescText=Replace(DescText,":","_")
    DescLocalText=DescText
    strWrkSpaceName=DescText
    intSeriesID=getSplitValue(strParameters,"SERIESID")
    if intSeriesID=0 then
      intSeriesID=strSeriesID
    End if 

      Call sCheckLayoutModule(strParameters)
      ''Clicking on "New Workspace" Button and selecting "Open for Edit(Souce)" option   
      strTemp="WPFObject(""ArrowControl"", """", 1)"
      Set objNewWorkspace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarSubItemLinkControl", "", 1).FindChild("Name",strTemp,2,True)
      If objNewWorkspace.Exists = True then
      objNewWorkspace.Click
      strTemp="WPFObject(""BarPopupBorderControl"", """", 1)"
      Set objWrkspace_popup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").FindChild("Name",strTemp,5,True)
      If objWrkspace_popup.Exists = True then
        strTemp="WPFObject(""ContentControlEx"", ""Open For Edit"", 2)"
        Set objopenforEdit=objWrkspace_popup.FindChild("Name",strTemp,8,True)
        If objopenforEdit.Exists then
          objopenforEdit.Click    
          'Delay 30000,"Please Wait..."
        End If
      End If
      
      strTemp1="WPFObject(""HwndSource: WorkspaceNamePrompt"", ""Please provide a new Workspace Name"")"
      Set objNewWrkSpaceName=Sys.Process("EdgeClient").WaitChild(strTemp1,80000)
      If objNewWrkSpaceName.Exists = True then

          ''Waiting for Workspace Name prompt
          strTemp="WPFObject(""FloatingContainerBorder"")"
          Set objNewWrkSpace_Name=Sys.Process("EdgeClient").WPFObject("HwndSource: WorkspaceNamePrompt", "Please provide a new Workspace Name").WPFObject("WorkspaceNamePrompt", "Please provide a new Workspace Name", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,1500000)
          If objNewWrkSpace_Name.Exists = True then
            strTemp="WPFObject(""ChangeNameTextEdit"")"
            ''Entering Workspace Name
            Set objNewWrkSpace_Txtbox=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
              'Delay 30000,"Please Wait..."
              If objNewWrkSpace_Txtbox.Exists = True then
                objNewWrkSpace_Txtbox.Click
                objNewWrkSpace_Txtbox.Text=strWrkSpaceName
                ''Clicking on Ok Button 
                strTemp="WPFObject(""OkButton"")"
                Set objNewWrkSpace_okbtn=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
                If objNewWrkSpace_okbtn.Exists = True then
                  objNewWrkSpace_okbtn.Click
                  'Delay 10000,"Please wait..."
                End If
               End If
          End If
      End if 
    End If
      
        Call sCloseLayout
        Delay 10000,"Closing Layout..." 
        Call sCloseLayout
        Delay 10000,"Closing Layout..." 
        Call LayoutWorkSpacevwr
  
End Sub

Sub sCheckLayoutModulePopupCancel(strParameters)

On Error Resume Next 
    Dim strLevel1layout,strLevel2layout,strLevel3layout,strWrkSpaceName
    Dim objNewWrkSpace_okbtn,objNewWrkSpace_Name
    Dim objNewWrkSpace_Txtbox,objopenforEdit,objWrkspace_popup
    Dim strTemp,objTemp,intRow,barManager,intTotNodeCnt,Text,objCellText,intl,intK,strDesc1,strDesc2
    Dim objWrkSpace,objwrkspacepop,objwrkspcUpload,objConfirm,objGridCell,DescLocalText,intSeriesID

    
     Call sloadlayout 
    Call sCheckLayoutExpandTree(strParameters)
    
    strLevel1layout=getSplitValue(strParameters,"LEVEL1LAYOUT")
    strLevel2layout=getSplitValue(strParameters,"LEVEL2LAYOUT")
    strLevel3layout=getSplitValue(strParameters,"LEVEL3LAYOUT")
    
'    strLevel1layout="dX Non-Asia Database (Current Eng Version)"
'    strLevel2layout="Z-Testing Topic(IT-use only)"
'    strLevel3layout="Sandbox (Benny)"
'    intSeriesID="369145097"

    strDesc1=aqDateTime.Now
    strDesc2=aqDateTime.Now
    DescText=Replace(strDesc1,"/","-")
    DescText=Replace(DescText,":","_")
    DescLocalText=DescText
    strWrkSpaceName=DescText
    intSeriesID=getSplitValue(strParameters,"SERIESID")
    if intSeriesID=0 then
      intSeriesID=strSeriesID
    End if 

    Delay 3000,"Please Wait..."

    ''Setting grid Objects

    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("LayoutTreeControl").WPFObject("LayoutTreeListView")
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("LayoutTreeControl")

    Delay 2000,"Please Wait..."
    ''Selecting Level1 layout
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strLevel1layout) then
          GridControl.Nodes_2.Item(intI).Expand(True)
          log.Message "Level 1 Layout - " & GridControl.Nodes_2.Item(intI).Content.Description       
          blnFlag=False  
          Exit For
        End If
    Next
'    Delay 3000,"Please Wait..."
    If blnFlag = True then
      strTCRemarks="Level 1 Layout not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
  
    Delay 5000,"Please Wait..."
    blnFlag = True 
    ''Selecting Level2 Layout
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
    For intJ=0 to intTotNodeCnt-1
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strLevel2layout) then
        GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
        GridControl.Keys "^[Home]"
        GridControl.Keys("[Down]")
        log.Message "Level2 layout Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
        blnFlag = False 
        Exit For
      End If
    Next
    If blnFlag = True then
      strTCRemarks="Level2 Source Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
      
      Call sCheckLayoutModule(strParameters)
      ''Clicking on "New Workspace" Button and selecting "Open for Edit(Souce)" option   
      strTemp="WPFObject(""ArrowControl"", """", 1)"
      Set objNewWorkspace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarSubItemLinkControl", "", 1).FindChild("Name",strTemp,2,True)
      If objNewWorkspace.Exists = True then
      objNewWorkspace.Click
      strTemp="WPFObject(""BarPopupBorderControl"", """", 1)"
      Set objWrkspace_popup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").FindChild("Name",strTemp,5,True)
      If objWrkspace_popup.Exists = True then
        strTemp="WPFObject(""ContentControlEx"", ""Open For Edit"", 2)"
        Set objopenforEdit=objWrkspace_popup.FindChild("Name",strTemp,8,True)
        If objopenforEdit.Exists then
          objopenforEdit.Click    
          'Delay 30000,"Please Wait..."
        End If
      End If
      
      strTemp1="WPFObject(""HwndSource: WorkspaceNamePrompt"", ""Please provide a new Workspace Name"")"
      Set objNewWrkSpaceName=Sys.Process("EdgeClient").WaitChild(strTemp1,80000)
      If objNewWrkSpaceName.Exists = True then

          ''Waiting for Workspace Name prompt
          strTemp="WPFObject(""FloatingContainerBorder"")"
          Set objNewWrkSpace_Name=Sys.Process("EdgeClient").WPFObject("HwndSource: WorkspaceNamePrompt", "Please provide a new Workspace Name").WPFObject("WorkspaceNamePrompt", "Please provide a new Workspace Name", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,1500000)
          If objNewWrkSpace_Name.Exists = True then
            strTemp="WPFObject(""ChangeNameTextEdit"")"
            ''Entering Workspace Name
            Set objNewWrkSpace_Txtbox=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
              'Delay 30000,"Please Wait..."
              If objNewWrkSpace_Txtbox.Exists = True then
                objNewWrkSpace_Txtbox.Click
                objNewWrkSpace_Txtbox.Text=strWrkSpaceName
                ''Clicking on Ok Button 
                strTemp="WPFObject(""CancelButton"")"
                Set objNewWrkSpace_okbtn=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
                If objNewWrkSpace_okbtn.Exists = True then
                  objNewWrkSpace_okbtn.Click
                  'Delay 10000,"Please wait..."
                End If
               End If
          End If
      End if 
    End If    
        Call sCloseLayout
        Delay 10000,"Closing Layout..." 

End Sub

Sub sCheckLayoutModuleDuplicateworkspace(strParameters)

On Error Resume Next 
    Dim strLevel1layout,strLevel2layout,strLevel3layout,strWrkSpaceName
    Dim objNewWrkSpace_okbtn,objNewWrkSpace_Name
    Dim objNewWrkSpace_Txtbox,objopenforEdit,objWrkspace_popup
    Dim strTemp,objTemp,intRow,barManager,intTotNodeCnt,Text,objCellText,intl,intK,strDesc1,strDesc2
    Dim objWrkSpace,objwrkspacepop,objwrkspcUpload,objConfirm,objGridCell,DescLocalText,intSeriesID
    
    Call sloadlayout 
    Call sCheckLayoutExpandTree(strParameters)
    strLevel1layout=getSplitValue(strParameters,"LEVEL1LAYOUT")
    strLevel2layout=getSplitValue(strParameters,"LEVEL2LAYOUT")
    strLevel3layout=getSplitValue(strParameters,"LEVEL3LAYOUT")
'    
'    strLevel1layout="dX Non-Asia Database (Current Eng Version)"
'    strLevel2layout="Z-Testing Topic(IT-use only)"
'    'strLevel3layout="Sandbox (Benny)"
'     strLevel3layout="CyrusTest"
'    intSeriesID="369145097"

    strDesc1=aqDateTime.Now
    strDesc2=aqDateTime.Now
    DescText=Replace(strDesc1,"/","-")
    DescText=Replace(DescText,":","_")
    DescLocalText=DescText
    strWrkSpaceName="Workspace1"
    
    Delay 3000,"Please Wait..."

    ''Setting grid Objects

    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("LayoutTreeControl").WPFObject("LayoutTreeListView")
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("LayoutTreeControl")

    Delay 2000,"Please Wait..."
    ''Selecting Level1 layout
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strLevel1layout) then
          GridControl.Nodes_2.Item(intI).Expand(True)
          log.Message "Level 1 Layout - " & GridControl.Nodes_2.Item(intI).Content.Description       
          blnFlag=False  
          Exit For
        End If
    Next
'    Delay 3000,"Please Wait..."
    If blnFlag = True then
      strTCRemarks="Level 1 Layout not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
  
    Delay 5000,"Please Wait..."
    blnFlag = True 
    ''Selecting Level2 Layout
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
    For intJ=0 to intTotNodeCnt-1
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strLevel2layout) then
        GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
        log.Message "Level2 layout Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
        blnFlag = False 
        Exit For
      End If
    Next
    If blnFlag = True then
      strTCRemarks="Level2 Source Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If

    Delay 5000,"Please Wait..."
    blnFlag = True    
    ''Selecting Level3 Layout
      intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count
      For intK=0 to intTotNodeCnt-1
        If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description)=Ucase(strLevel3layout) then
          GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Expand(True)
          intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).get_RowHandle
          Call GridControl.ClearSelectionCore
          Call GridControl.FocusViewAndRow(GridControl,intRow)
          GridControl.SetFocusOnCurrentItem
          Call GridControl.SelectRowCore(intRow)
          log.Message "Level3 layout Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description
          blnFlag = False
          Exit For   
        End If 
      Next
      If blnFlag = True then
        strTCRemarks="Level3 Source Name not found"
        strTestCaseResult="FAIL"
        Exit Sub
      End If
      Call sCheckLayoutModule(strParameters)
      ''Clicking on "New Workspace" Button and selecting "Open for Edit(Souce)" option   
      strTemp="WPFObject(""ArrowControl"", """", 1)"
      Set objNewWorkspace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarSubItemLinkControl", "", 1).FindChild("Name",strTemp,2,True)
      If objNewWorkspace.Exists = True then
      objNewWorkspace.Click
      strTemp="WPFObject(""BarPopupBorderControl"", """", 1)"
      Set objWrkspace_popup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").FindChild("Name",strTemp,5,True)
      If objWrkspace_popup.Exists = True then
        strTemp="WPFObject(""ContentControlEx"", ""Open For Edit"", 2)"
        Set objopenforEdit=objWrkspace_popup.FindChild("Name",strTemp,8,True)
        If objopenforEdit.Exists then
          objopenforEdit.Click    
          'Delay 30000,"Please Wait..."
        End If
      End If
      
      strTemp1="WPFObject(""HwndSource: WorkspaceNamePrompt"", ""Please provide a new Workspace Name"")"
      Set objNewWrkSpaceName=Sys.Process("EdgeClient").WaitChild(strTemp1,80000)
      If objNewWrkSpaceName.Exists = True then

          ''Waiting for Workspace Name prompt
          strTemp="WPFObject(""FloatingContainerBorder"")"
          Set objNewWrkSpace_Name=Sys.Process("EdgeClient").WPFObject("HwndSource: WorkspaceNamePrompt", "Please provide a new Workspace Name").WPFObject("WorkspaceNamePrompt", "Please provide a new Workspace Name", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,1500000)
          If objNewWrkSpace_Name.Exists = True then
            strTemp="WPFObject(""ChangeNameTextEdit"")"
            ''Entering Workspace Name
            Set objNewWrkSpace_Txtbox=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
              'Delay 30000,"Please Wait..."
              If objNewWrkSpace_Txtbox.Exists = True then
                objNewWrkSpace_Txtbox.Click
                objNewWrkSpace_Txtbox.Text=strWrkSpaceName
                
                ''Clicking on Ok Button 
                strTemp="WPFObject(""OkButton"")"
                Set objNewWrkSpace_okbtn=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
                If objNewWrkSpace_okbtn.Exists = True then
                  objNewWrkSpace_okbtn.Click
                  'Delay 10000,"Please wait..."
                End If
                
                'strTemp="WPFObject(""PART_ContainerContent"")"
               
                Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: WindowContentHolder", "New Workspace").WPFObject("WindowContentHolder", "New Workspace", 1).WPFObject("NonLogicalDecorator", "", 1).WPFObject("ThemedManagedContentPresenter", "", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("DXMessageBox", "", 1)
                ''Clicking on Ok Button  
                'Set objNewWrkSpace_okbtn=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
                If objNewWrkSpace_okbtn.Exists = True then
                   SYS.Keys "[Enter]"
                  'Delay 10000,"Please wait..."
                End If
               
                
                ''Clicking on Ok Button 
               
                strTemp="WPFObject(""FloatingContainerBorder"")"
                Set objNewWrkSpace_Name=Sys.Process("EdgeClient").WPFObject("HwndSource: WorkspaceNamePrompt", "Please provide a new Workspace Name").WPFObject("WorkspaceNamePrompt", "Please provide a new Workspace Name", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,1500000)
                strTemp="WPFObject(""CancelButton"")"
                Set objNewWrkSpace_okbtn=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
                If objNewWrkSpace_okbtn.Exists = True then
                  objNewWrkSpace_okbtn.Click
                  'Delay 10000,"Please wait..."
                End If
               End If
          End If
      End if 
    End If

        Call sCloseLayout
        Delay 10000,"Closing Layout..." 
        Call sCloseLayout
        Delay 10000,"Closing Layout..." 
        'Call LayoutWorkSpacevwr
  
End Sub
Sub sCheckLayoutModuleWorkspace(strParameters)

On Error Resume Next 
    Dim strLevel1layout,strLevel2layout,strLevel3layout,strWrkSpaceName
    Dim objNewWrkSpace_okbtn,objNewWrkSpace_Name
    Dim objNewWrkSpace_Txtbox,objopenforEdit,objWrkspace_popup
    Dim strTemp,objTemp,intRow,barManager,intTotNodeCnt,Text,objCellText,intl,intK,strDesc1,strDesc2
    Dim objWrkSpace,objwrkspacepop,objwrkspcUpload,objConfirm,objGridCell,DescLocalText,intSeriesID
    
    Call sloadlayout 
    Call sCheckLayoutExpandTree(strParameters)
    
    strLevel1layout=getSplitValue(strParameters,"LEVEL1LAYOUT")
    strLevel2layout=getSplitValue(strParameters,"LEVEL2LAYOUT")
    strLevel3layout=getSplitValue(strParameters,"LEVEL3LAYOUT")
    
'    strLevel1layout="dX Non-Asia Database (Current Eng Version)"
'    strLevel2layout="Z-Testing Topic(IT-use only)"
'    strLevel3layout="Sandbox (Benny)"
'    intSeriesID="369145097"

    strDesc1=aqDateTime.Now
    strDesc2=aqDateTime.Now
    DescText=Replace(strDesc1,"/","-")
    DescText=Replace(DescText,":","_")
    DescLocalText=DescText
    strWrkSpaceName="Workspace1"
    intSeriesID=getSplitValue(strParameters,"SERIESID")
    if intSeriesID=0 then
      intSeriesID=strSeriesID
    End if 

    Delay 3000,"Please Wait..."

    ''Setting grid Objects

    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("LayoutTreeControl").WPFObject("LayoutTreeListView")
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("LayoutTreeControl")

    Delay 2000,"Please Wait..."
    ''Selecting Level1 layout
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strLevel1layout) then
          GridControl.Nodes_2.Item(intI).Expand(True)
          log.Message "Level 1 Layout - " & GridControl.Nodes_2.Item(intI).Content.Description       
          blnFlag=False  
          Exit For
        End If
    Next
'    Delay 3000,"Please Wait..."
    If blnFlag = True then
      strTCRemarks="Level 1 Layout not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
  
    Delay 5000,"Please Wait..."
    blnFlag = True 
    ''Selecting Level2 Layout
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
    For intJ=0 to intTotNodeCnt-1
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strLevel2layout) then
        GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
        log.Message "Level2 layout Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
        blnFlag = False 
        Exit For
      End If
    Next
    If blnFlag = True then
      strTCRemarks="Level2 Source Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If

    Delay 5000,"Please Wait..."
    blnFlag = True    
    ''Selecting Level3 Layout
      intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count
      For intK=0 to intTotNodeCnt-1
        If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description)=Ucase(strLevel3layout) then
          GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Expand(True)
          intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).get_RowHandle
          Call GridControl.ClearSelectionCore
          Call GridControl.FocusViewAndRow(GridControl,intRow)
          GridControl.SetFocusOnCurrentItem
          Call GridControl.SelectRowCore(intRow)
          log.Message "Level3 layout Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description
          blnFlag = False
          Exit For   
        End If 
      Next
      If blnFlag = True then
        strTCRemarks="Level3 Source Name not found"
        strTestCaseResult="FAIL"
        Exit Sub
      End If
      Call sCheckLayoutModule(strParameters)
      ''Clicking on "New Workspace" Button and selecting "Open for Edit(Souce)" option   
      strTemp="WPFObject(""ArrowControl"", """", 1)"
      Set objNewWorkspace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarSubItemLinkControl", "", 1).FindChild("Name",strTemp,2,True)
      If objNewWorkspace.Exists = True then
      objNewWorkspace.Click
      strTemp="WPFObject(""BarPopupBorderControl"", """", 1)"
      Set objWrkspace_popup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").FindChild("Name",strTemp,5,True)
      If objWrkspace_popup.Exists = True then
        strTemp="WPFObject(""ContentControlEx"", ""Open For Edit"", 2)"
        Set objopenforEdit=objWrkspace_popup.FindChild("Name",strTemp,8,True)
        If objopenforEdit.Exists then
          objopenforEdit.Click    
          'Delay 30000,"Please Wait..."
        End If
      End If
      
      strTemp1="WPFObject(""HwndSource: WorkspaceNamePrompt"", ""Please provide a new Workspace Name"")"
      Set objNewWrkSpaceName=Sys.Process("EdgeClient").WaitChild(strTemp1,80000)
      If objNewWrkSpaceName.Exists = True then

          ''Waiting for Workspace Name prompt
          strTemp="WPFObject(""FloatingContainerBorder"")"
          Set objNewWrkSpace_Name=Sys.Process("EdgeClient").WPFObject("HwndSource: WorkspaceNamePrompt", "Please provide a new Workspace Name").WPFObject("WorkspaceNamePrompt", "Please provide a new Workspace Name", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,1500000)
          If objNewWrkSpace_Name.Exists = True then
            strTemp="WPFObject(""ChangeNameTextEdit"")"
            ''Entering Workspace Name
            Set objNewWrkSpace_Txtbox=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
              'Delay 30000,"Please Wait..."
              If objNewWrkSpace_Txtbox.Exists = True then
                objNewWrkSpace_Txtbox.Click
                objNewWrkSpace_Txtbox.Text=strWrkSpaceName
                ''Clicking on Ok Button 
                strTemp="WPFObject(""OkButton"")"
                Set objNewWrkSpace_okbtn=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
                If objNewWrkSpace_okbtn.Exists = True then
                  objNewWrkSpace_okbtn.Click
                  'Delay 10000,"Please wait..."
                End If
                
                strTemp="WPFObject(""PART_ContainerContent"")"
              Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "Warning").WPFObject("CustomMessageBoxWindow", "Warning", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,50000)
              If objNewWrkSpace_okbtn.Exists = True then
                SYS.Keys "N"
'                Call sCloseLayout
'                Exit Sub
              End If
               End If
          End If
      End if 
    End If

        Call sCloseLayout
        Delay 10000,"Closing Layout..." 
        Call sCloseLayout
        Delay 10000,"Closing Layout..." 
         Call LayoutWorkSpacevwr
 End Sub
 
 
Sub  sCheckLayoutRightViewWorkspace()
On Error Resume Next 

    Dim strTemp,objNewWorkspace,objopenforEdit,strTemp1,objNewWrkSpaceName
    Dim intTotNodeCnt,intI,intJ,intK,strOk
     
    Call sloadlayout 
'    Call sCheckLayoutExpandTree(strParameters)
'    strLevel1layout=getSplitValue(strParameters,"LEVEL1LAYOUT")
'    strLevel2layout=getSplitValue(strParameters,"LEVEL2LAYOUT")
'    strLevel3layout=getSplitValue(strParameters,"LEVEL3LAYOUT")

    strLevel1layout="dX Non-Asia Database (Current Eng Version)"
    strLevel2layout="Z-Testing Topic(IT-use only)"
    strLevel3layout="Sandbox (Benny)"
    
      strTemp="WPFObject(""ArrowControl"", """", 1)"
      Set objNewWorkspace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarSubItemLinkControl", "", 1).FindChild("Name",strTemp,2,True)
      If objNewWorkspace.Exists = True then
        objNewWorkspace.Click
        strTemp="WPFObject(""BarPopupBorderControl"", """", 1)"
        Set objWrkspace_popup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").FindChild("Name",strTemp,15,True)
        If objWrkspace_popup.Exists = True then
          strTemp="WPFObject(""ContentControlEx"", ""Open For View"", 2)"
          Set objopenforEdit=objWrkspace_popup.FindChild("Name",strTemp,8,True)
          If objopenforEdit.Exists then
            objopenforEdit.Click
            Call sEdgeProcessor
            log.Message "Workspace created for view only"
            strTCRemarks="Workspace created for view only"
          Else
            Exit Sub 
          End If
        End If
      End if
      Call sCloseLayout
      Call sCloseLayout
      
'      Set objBounds = objGridExStart.GetCellBounds_2(objGridExStart.CurrentRow.Position, objGridExStart.Col)
'		Call objGridExStart.ClickR(objBounds.Left+objBounds.Width/2, objBounds.Top+objBounds.Height/2)
End sub

Sub  sCheckLayoutMultiViewWorkspace()
On Error Resume Next 

    Dim strTemp,objNewWorkspace,objopenforEdit,strTemp1,objNewWrkSpaceName
    Dim intTotNodeCnt,intI,intJ,intK,strOk
     
    Call sloadlayout 
    Call sCheckLayoutExpandTree(strParameters)
'    strLevel1layout=getSplitValue(strParameters,"LEVEL1LAYOUT")
'    strLevel2layout=getSplitValue(strParameters,"LEVEL2LAYOUT")
'    strLevel3layout=getSplitValue(strParameters,"LEVEL3LAYOUT")

    strLevel1layout="dX Non-Asia Database (Current Eng Version)"
    strLevel2layout="Z-Testing Topic(IT-use only)"
    strLevel3layout="Sandbox (Benny)"
    
    strTemp="WPFObject(""ArrowControl"", """", 1)"
    Set objNewWorkspace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarSubItemLinkControl", "", 1).FindChild("Name",strTemp,2,True)
    If objNewWorkspace.Exists = True then
      objNewWorkspace.Click
      strTemp="WPFObject(""BarPopupBorderControl"", """", 1)"
      Set objWrkspace_popup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").FindChild("Name",strTemp,15,True)
      If objWrkspace_popup.Exists = True then
        strTemp="WPFObject(""ContentControlEx"", ""Open For View"", 2)"
        Set objopenforEdit=objWrkspace_popup.FindChild("Name",strTemp,8,True)
        If objopenforEdit.Exists then
          objopenforEdit.Click
          Call sEdgeProcessor
          log.Message "Workspace created for view only"
          strTCRemarks="Workspace created for view only"
        Else
          Exit Sub 
        End If
      End If
    End if
      Call sCloseLayout
      Call sCloseLayout
End sub


Sub  sCheckLayoutSecondEditWorkspace(strParameters)
On Error Resume Next

    Dim objNewWorkspace,strTemp1,objNewWrkSpaceName
    Dim strLevel1layout,strLevel2layout,strLevel3layout,strWrkSpaceName
    Dim objNewWrkSpace_okbtn,objNewWrkSpace_Name
    Dim objNewWrkSpace_Txtbox,objopenforEdit,objWrkspace_popup
    Dim strTemp,objTemp,intRow,barManager,intTotNodeCnt,Text,objCellText,intI,intK,strDesc1,strDesc2,intJ
    Dim objWrkSpace,objwrkspacepop,objwrkspcUpload,objConfirm,objGridCell,DescLocalText,intSeriesID
    
    Call sLoadLayout
    Call sCheckLayoutExpandTree(strParameters)
    
    strLevel1layout=getSplitValue(strParameters,"LEVEL1LAYOUT")
    strLevel2layout=getSplitValue(strParameters,"LEVEL2LAYOUT")
    strLevel3layout=getSplitValue(strParameters,"LEVEL3LAYOUT")
    
'    strLevel1layout="dX Non-Asia Database (Current Eng Version)"
'    strLevel2layout="Z-Testing Topic(IT-use only)"
'    strLevel3layout="Sandbox (Benny)"
    
'    strLevel1layout="dX Non-Asia Database (Current Eng Version)"
'    strLevel2layout="Z-Topic Test(IT-use only)"
'    strLevel3layout="Automation"

    strDesc1=aqDateTime.Now
    strDesc2=aqDateTime.Now
    DescText=Replace(strDesc1,"/","-")
    DescText=Replace(DescText,":","_")
    DescLocalText=DescText
    strWrkSpaceName=DescText
'    intSeriesID=getSplitValue(strParameters,"SERIESID")
'    if intSeriesID=0 then
'      intSeriesID=strSeriesID
'    End if 
    strTemp="WPFObject(""ArrowControl"", """", 1)"
    Set objNewWorkspace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarSubItemLinkControl", "", 1).FindChild("Name",strTemp,2,True)
    If objNewWorkspace.Exists = True then
      objNewWorkspace.Click
      strTemp="WPFObject(""BarPopupBorderControl"", """", 1)"
      Set objWrkspace_popup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").FindChild("Name",strTemp,5,True)
      If objWrkspace_popup.Exists = True then
        strTemp="WPFObject(""ContentControlEx"", ""Open For Edit"", 2)"
        Set objopenforEdit=objWrkspace_popup.FindChild("Name",strTemp,8,True)
        If objopenforEdit.Exists then
          objopenforEdit.Click    
        End If
      End If
      strTemp1="WPFObject(""HwndSource: WorkspaceNamePrompt"", ""Please provide a new Workspace Name"")"
      Set objNewWrkSpaceName=Sys.Process("EdgeClient").WaitChild(strTemp1,80000)
      If objNewWrkSpaceName.Exists = True then
          ''Waiting for Workspace Name prompt
          strTemp="WPFObject(""FloatingContainerBorder"")"
          Set objNewWrkSpace_Name=Sys.Process("EdgeClient").WPFObject("HwndSource: WorkspaceNamePrompt", "Please provide a new Workspace Name").WPFObject("WorkspaceNamePrompt", "Please provide a new Workspace Name", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,1500000)
          If objNewWrkSpace_Name.Exists = True then
            strTemp="WPFObject(""ChangeNameTextEdit"")"
            ''Entering Workspace Name
            Set objNewWrkSpace_Txtbox=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
            If objNewWrkSpace_Txtbox.Exists = True then
                objNewWrkSpace_Txtbox.Click
                objNewWrkSpace_Txtbox.Text=strWrkSpaceName
                ''Clicking on Ok Button 
                strTemp="WPFObject(""OkButton"")"
                Set objNewWrkSpace_okbtn=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
                If objNewWrkSpace_okbtn.Exists = True then
                  objNewWrkSpace_okbtn.Click
                  'Call sEdgeProcessor
                  Dim strOk,strClose
                  strTemp="WPFObject(""PART_ContainerContent"")"
                  Set strOk=Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "Warning").WPFObject("CustomMessageBoxWindow", "Warning", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,50000)
                  If strOk.Exists = True then
                    SYS.Keys "N"
                  ' End If
                  End If
                End If
            End If
          End If  
          Call scloseLayout
         ' Call sCheckOpenLayoutWorkSpacevwr
          Call LayoutWorkSpacevwr
      End if 
  End If

End sub 

Sub sCheckLayoutFloatWindow()
On Error Resume Next
  Dim objEdge,strTemp
  
  sLoadLayout
  set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1)
  strTemp="WPFObject(""LayoutPanel"", """", 1)"
  Set objTemp=objEdge.FindChild("Name",strTemp,5)
  Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1)
  IF objTemp.Exists = True then 
    IF objTemp.Caption="Layout" then
      objTemp.Click
      Call objTemp.ClickR(223, 9)
      Delay 2000,"Pls Wait.."
      sys.Keys "[Down][Enter]"
      Delay 5000,"Pls Wait.."
      strTCRemarks="Layout window is able to Float" 
      Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: FloatingPaneWindow", "").WPFObject("FloatingPaneWindow", "", 1).WPFObject("NonLogicalDecorator", "", 1).WPFObject("FloatingContentPresenter", "", 1).WPFObject("PART_FormBorderControl").WPFObject("LayoutPanel", "", 1)
      Call objTemp.ClickR(99, 18)
      Delay 2000,"Pls Wait.."
      sys.Keys "[Down][Down][Down][Enter]"
      Delay 5000,"Pls Wait.."
    End IF 
  End If   

End Sub

Sub sCheckLayoutAutoHideWindow()
On Error Resume Next
  Dim objEdge,strTemp
  
  sLoadLayout
  set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1)
  strTemp="WPFObject(""LayoutPanel"", """", 1)"
  Set objTemp=objEdge.FindChild("Name",strTemp,5)
  Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1)
  IF objTemp.Exists = True then 
    IF objTemp.Caption="Layout" then
      objTemp.Click
      Call objTemp.ClickR(223, 9)
      Delay 2000,"Pls Wait.."
       sys.Keys "[Down][Down][Enter]"
      Delay 5000,"Pls Wait.."
      strTCRemarks="Autohided the Window Successfully"
    End IF 
  End If   
      Call sAutoHideGroupName("Layout")
       Set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager")       
        objText = objEdge.FindAllChildren("ClrClassName","AutoHideGroup", 10,True)
        For i=0 to ubound(objText)
          log.Message objText(i).FullName
          log.Message objText(i).Name
          objCaption = objText(i).FindAllChildren("ClrClassName", "AutoHidePaneHeaderItem",10,True)
          For j=0 to ubound(objCaption)
            log.Message objCaption(j).FullName
            log.Message objCaption(j).Name
            if objCaption(j).Content.Caption = "Layout" then 
                  log.Message objCaption(j).FullName
                  objCaption(j).ClickR
                   Delay 2000,"Pls Wait.."
                  sys.Keys "[Down][Down][Down][Enter]"
                  Delay 5000,"Pls Wait.."
                  Exit For 
              End if 
          Next
        Next    
      
      strTCRemarks = strTCRemarks & "<br />" & "Autohided the Window Successfully"
      
End Sub

Sub sCheckLayoutCloseWindow()
On Error Resume Next
  Dim objEdge,strTemp
  
  sLoadLayout
  set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1)
  strTemp="WPFObject(""LayoutPanel"", """", 1)"
  Set objTemp=objEdge.FindChild("Name",strTemp,5)
  Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1)
  IF objTemp.Exists = True then 
    IF objTemp.Caption="Layout" then
      objTemp.Click
      Call objTemp.ClickR(223, 9)
      Delay 2000,"Pls Wait.."
     sys.Keys "[Down][Down][Down][Enter]"
      Delay 5000,"Pls Wait.."
      strTCRemarks="Closed Layout window Successfully"
    End IF 
  End If   

End Sub

Sub sCheckLayoutRefreshFileRepository(strParameters)
On Error Resume Next
    Dim objEdge,strTemp,objTemp,objEdgeFilter,strLevel1layout,strLevel2layout,GridControl,GridSourceTree,strLevel3layout,intTotNodeCnt
    Dim intI,intJ,intK
    Dim objEdgeTree,strLayoutHeader
    
    Call sloadlayout 
    
    set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1)
    strTemp="WPFObject(""ContentControlEx"", ""File Repository"", 2)"
    Set objTemp=objEdge.FindChild("Name",strTemp,50)
  
    
    'Call sCheckLayoutExpandTree(strParameters)
    
    strLevel1layout=getSplitValue(strParameters,"LEVEL1LAYOUT")
    strLevel2layout=getSplitValue(strParameters,"LEVEL2LAYOUT")
    strLevel3layout=getSplitValue(strParameters,"LEVEL3LAYOUT")
    
'    strLevel1layout="dX Non-Asia Database (Current Eng Version)"
'    strLevel2layout="Z-Topic Test(IT-use only)"


   Delay 3000,"Please Wait..."
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("LayoutTreeControl").WPFObject("LayoutTreeListView")
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("LayoutTreeControl")
    if strLevel1layout <> "" and strLevel2layout <> "" AND strLevel3layout <> "" then
        Delay 10000,"Please Wait..."
        ''Selecting Level1 layout
        intTotNodeCnt=GridControl.Nodes_2.Count
        For intI=0 to intTotNodeCnt-1         
            If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strLevel1layout) then
              GridControl.Nodes_2.Item(intI).Expand(True)
              log.Message "Level 1 Layout - " & GridControl.Nodes_2.Item(intI).Content.Description       
              blnFlag=False  
              Exit For
            End If
        Next
        Delay 3000,"Please Wait..."
        If blnFlag = True then
          strTCRemarks="Level 1 Layout not found"
          strTestCaseResult="FAIL"
          Exit Sub
        End If
  
        blnFlag = True 
        ''Selecting Level2 Layout
        Delay 10000,"Please Wait..."
        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
        For intJ=0 to intTotNodeCnt-1
          If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strLevel2layout) then
            GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
            log.Message "Level2 layout Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
            blnFlag = False 
            Exit For
          End If
        Next
        If blnFlag = True then
          strTCRemarks="Level2 Source Name not found"
          strTestCaseResult="FAIL"
          Exit Sub
        End If
        delay(3000)
        blnFlag = True    
        ''Selecting Level3 Layout
          intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count
          Delay 10000,"Please Wait..."
          For intK=0 to intTotNodeCnt-1
            If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description)=Ucase(strLevel3layout) then
              GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Expand(True)
              intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).get_RowHandle
''                  GridControl.set_FocusedRowHandle(intRow)
''                  'GridControl.Click
''                  'Delay(1000)
''                  GridControl.Keys("[Down]")
''                  GridControl.Keys("[Up]")
              Call GridControl.ClearSelectionCore
              Call GridControl.FocusViewAndRow(GridControl,intRow)
              GridControl.SetFocusOnCurrentItem
              Call GridControl.SelectRowCore(intRow)
              log.Message "Level3 layout Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description
              blnFlag = False
              Exit For   
            End If 
          Next
          If blnFlag = True then
            strTCRemarks="Level3 Source Name not found"
            strTestCaseResult="FAIL"
            Exit Sub
          End If
    Elseif strLevel2layout<> "" AND strLevel3layout = "" then
       Delay 1000,"Please Wait..."
        ''Selecting Level1 layout
        intTotNodeCnt=GridControl.Nodes_2.Count
        For intI=0 to intTotNodeCnt-1         
            If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strLevel1layout) then
              GridControl.Nodes_2.Item(intI).Expand(True)
              intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
              Call GridControl.ClearSelectionCore
              Call GridControl.FocusViewAndRow(GridControl,intRow)
              GridControl.SetFocusOnCurrentItem
              Call GridControl.SelectRowCore(intRow)
              log.Message "Level 1 Layout - " & GridControl.Nodes_2.Item(intI).Content.Description       
              blnFlag=False  
              Exit For
            End If
        Next
        Delay 3000,"Please Wait..."
        If blnFlag = True then
          strTCRemarks="Level 1 Layout not found"
          strTestCaseResult="FAIL"
          Exit Sub
        End If
  
        blnFlag = True 
        ''Selecting Level2 Layout
        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
        For intJ=0 to intTotNodeCnt-1
          If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strLevel2layout) then
            GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
            intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
            GridControl.set_FocusedRowHandle(intRow)
            GridControl.Keys("[Down]")
            GridControl.Keys("[Up]")
            log.Message "Level2 layout Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
            blnFlag = False 
            Exit For
          End If
        Next
        If blnFlag = True then
          strTCRemarks="Level2 Source Name not found"
          strTestCaseResult="FAIL"
          Exit Sub
        End If 
    Elseif strLevel2layout="" then
      Delay 10000,"Please Wait..."
        ''Selecting Level1 layout
        intTotNodeCnt=GridControl.Nodes_2.Count
        For intI=0 to intTotNodeCnt-1         
            If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strLevel1layout) then
              GridControl.Nodes_2.Item(intI).Expand(True)
              intRow=GridControl.Nodes_2.Item(intI).get_RowHandle
              GridControl.set_FocusedRowHandle(intRow)
              GridControl.Keys("[Down]")
              GridControl.Keys("[Up]")
              log.Message "Level 1 Layout - " & GridControl.Nodes_2.Item(intI).Content.Description       
              blnFlag=False  
              Exit For
            End If
        Next
        Delay 3000,"Please Wait..."
        If blnFlag = True then
          strTCRemarks="Level 1 Layout not found"
          strTestCaseResult="FAIL"
          Exit Sub
        End If
    End if
      Call sCheckLayoutModule(strParameters)
  
  If objTemp.Exists=True then
    strTCRemarks = "File Repository Button is found in Layout"
    log.Message "File Repository Button is found in Layout"
    objTemp.Click
    Delay(1000)
    set objEdgeFilter= Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 3).WPFObject("BarButtonItemLinkControl", "", 1)
    strTemp="WPFObject(""ContentControlEx"", ""Refresh Attachment Status"", 2)"
    Set objTemp=objEdgeFilter.FindChild("Name",strTemp,50)
    If objTemp.Exists = TRUE then
      objTemp.Click
    End If
    
  
              
  set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1)
  strTemp="WPFObject(""LayoutTreeListView"")"
  Set objTemp=objEdge.FindChild("Name",strTemp,50)
  If objTemp.Exists=True then
    strTCRemarks = "Layout Grid found in Layout"
    log.Message "Layout grid found in Layout"
    set objEdgeTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("LayoutTreeControl").WPFObject("LayoutTreeListView")
    strTemp="WPFObject(""GridColumnHeader"", """", 3)"
    Set objTemp=objEdgeTree.FindChild("Name",strTemp,50)
    if objTemp.Exists=True then
      Delay (1000)
      if UCASE(objTemp.DataContext.Header)="FOOTNOTE" then
        strTCRemarks = strTCRemarks & "<br />" & "Footnote is found in Layout"
        log.Message "Footnote is found in Layout"
      Else
        strTCRemarks = strTCRemarks & "<br />" & "Footnote is not found in Layout"
        log.Message "Footnote is not found in Layout"
      End if
    Else 
      strTCRemarks = strTCRemarks & "<br />" & "Fields is not found in Layout"
    End if
       
    strTemp="WPFObject(""GridColumnHeader"", """", 5)"
    Set objTemp=objEdgeTree.FindChild("Name",strTemp,50)
    if objTemp.Exists=True then
      if UCASE(objTemp.DataContext.Header)="TALK" then
        strTCRemarks = strTCRemarks & "<br />" & "TALK is found in Layout"
        log.Message "TALK is found in Layout"
      Else
        strTCRemarks = strTCRemarks & "<br />" & "TALK is not found in Layout"
        log.Message "TALK is not found in Layout"
      End if 
    else
      strTCRemarks = strTCRemarks & "<br />" & "Fields is not found in Layout"
    End if
    
    strTemp="WPFObject(""GridColumnHeader"", """", 4)"
    Set objTemp=objEdgeTree.FindChild("Name",strTemp,50)
    if objTemp.Exists=True then
      if UCASE(objTemp.DataContext.Header)="EMIS" then
        strTCRemarks = strTCRemarks & "<br />" & "EMIS is found in Layout"
        log.Message "EMIS is found in Layout"
      Else
        strTCRemarks = strTCRemarks & "<br />" & "EMIS is not found in Layout"
        log.Message "EMIS is not found in Layout"
      End if 
    else
      strTCRemarks = strTCRemarks & "<br />" & "Fields is not found in Layout"
    End if
  else
    strTCRemarks =  "Layout Grid Not found in Layout"
  End if 
'    
'    set objEdgeFilter= Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarButtonItemLinkControl", "", 1)
'    strTemp="WPFObject(""ContentControlEx"", ""Show / Hide Attachment Status"", 2)"
'    Set objTemp=objEdgeFilter.FindChild("Name",strTemp,50)
'    If objTemp.Exists = TRUE then
'       objTemp.Click
'    End If
  else
    strTCRemarks =  "File Repository Button is Not found in Layout"
  End if 
End Sub

Sub sCheckLayoutHideAttachmentFileRepository(strParameters)
On Error Resume Next

    Dim objEdge,strTemp,objTemp,objEdgeFilter,strLevel1layout,strLevel2layout
    Dim objEdgeTree,strLayoutHeader,GridControl,GridSourceTree,intTotNodeCnt,intI,intJ,intK
    
    set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1)
    strTemp="WPFObject(""ContentControlEx"", ""File Repository"", 2)"
    Set objTemp=objEdge.FindChild("Name",strTemp,50)
  
    Call sloadlayout 
    Call sCheckLayoutExpandTree(strParameters)
    
    strLevel1layout=getSplitValue(strParameters,"LEVEL1LAYOUT")
    strLevel2layout=getSplitValue(strParameters,"LEVEL2LAYOUT")

    
'    strLevel1layout="dX Non-Asia Database (Current Eng Version)"
'    strLevel2layout="Z-Topic Test(IT-use only)"


   Delay 3000,"Please Wait..."
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("LayoutTreeControl").WPFObject("LayoutTreeListView")
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("LayoutTreeControl")
    if strLevel1layout <> "" and strLevel2layout <> "" AND strLevel3layout <> "" then
        Delay 1000,"Please Wait..."
        ''Selecting Level1 layout
        intTotNodeCnt=GridControl.Nodes_2.Count
        For intI=0 to intTotNodeCnt-1         
            If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strLevel1layout) then
              GridControl.Nodes_2.Item(intI).Expand(True)
              log.Message "Level 1 Layout - " & GridControl.Nodes_2.Item(intI).Content.Description       
              blnFlag=False  
              Exit For
            End If
        Next
        Delay 3000,"Please Wait..."
        If blnFlag = True then
          strTCRemarks="Level 1 Layout not found"
          strTestCaseResult="FAIL"
          Exit Sub
        End If
  
        blnFlag = True 
        ''Selecting Level2 Layout
        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
        For intJ=0 to intTotNodeCnt-1
          If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strLevel2layout) then
            GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
            log.Message "Level2 layout Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
            blnFlag = False 
            Exit For
          End If
        Next
        If blnFlag = True then
          strTCRemarks="Level2 Source Name not found"
          strTestCaseResult="FAIL"
          Exit Sub
        End If
        delay(3000)
        blnFlag = True    
        ''Selecting Level3 Layout
          intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count
          For intK=0 to intTotNodeCnt-1
            If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description)=Ucase(strLevel3layout) then
              GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Expand(True)
              intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).get_RowHandle

              Call GridControl.ClearSelectionCore
              Call GridControl.FocusViewAndRow(GridControl,intRow)
              GridControl.SetFocusOnCurrentItem
              Call GridControl.SelectRowCore(intRow)
              log.Message "Level3 layout Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description
              blnFlag = False
              Exit For   
            End If 
          Next
          If blnFlag = True then
            strTCRemarks="Level3 Source Name not found"
            strTestCaseResult="FAIL"
            Exit Sub
          End If
    Elseif strLevel2layout<> "" AND strLevel3layout = "" then
       Delay 1000,"Please Wait..."
        ''Selecting Level1 layout
        intTotNodeCnt=GridControl.Nodes_2.Count
        For intI=0 to intTotNodeCnt-1         
            If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strLevel1layout) then
              GridControl.Nodes_2.Item(intI).Expand(True)
              intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
              Call GridControl.ClearSelectionCore
              Call GridControl.FocusViewAndRow(GridControl,intRow)
              GridControl.SetFocusOnCurrentItem
              Call GridControl.SelectRowCore(intRow)
              log.Message "Level 1 Layout - " & GridControl.Nodes_2.Item(intI).Content.Description       
              blnFlag=False  
              Exit For
            End If
        Next
        Delay 3000,"Please Wait..."
        If blnFlag = True then
          strTCRemarks="Level 1 Layout not found"
          strTestCaseResult="FAIL"
          Exit Sub
        End If
  
        blnFlag = True 
        ''Selecting Level2 Layout
        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
        For intJ=0 to intTotNodeCnt-1
          If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strLevel2layout) then
            GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
            intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
            GridControl.set_FocusedRowHandle(intRow)
            GridControl.Keys("[Down]")
            GridControl.Keys("[Up]")
            log.Message "Level2 layout Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
            blnFlag = False 
            Exit For
          End If
        Next
        If blnFlag = True then
          strTCRemarks="Level2 Source Name not found"
          strTestCaseResult="FAIL"
          Exit Sub
        End If 
    Elseif strLevel2layout="" then
      Delay 1000,"Please Wait..."
        ''Selecting Level1 layout
        intTotNodeCnt=GridControl.Nodes_2.Count
        For intI=0 to intTotNodeCnt-1         
            If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strLevel1layout) then
              GridControl.Nodes_2.Item(intI).Expand(True)
              intRow=GridControl.Nodes_2.Item(intI).get_RowHandle
              GridControl.set_FocusedRowHandle(intRow)
              GridControl.Keys("[Down]")
              GridControl.Keys("[Up]")
              log.Message "Level 1 Layout - " & GridControl.Nodes_2.Item(intI).Content.Description       
              blnFlag=False  
              Exit For
            End If
        Next
        Delay 3000,"Please Wait..."
        If blnFlag = True then
          strTCRemarks="Level 1 Layout not found"
          strTestCaseResult="FAIL"
          Exit Sub
        End If
    End if
    Call sCheckLayoutModule(strParameters)
  
    set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1)
    strTemp="WPFObject(""ContentControlEx"", ""File Repository"", 2)"
    Set objTemp=objEdge.FindChild("Name",strTemp,50)
    
    If objTemp.Exists=True then
      strTCRemarks = "File Repository Button is found in Layout"
      log.Message "File Repository Button is found in Layout"
      objTemp.Click
      Delay(1000)
      set objEdgeFilter= Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 3).WPFObject("BarButtonItemLinkControl", "", 1)
      strTemp="WPFObject(""ContentControlEx"", ""Refresh Attachment Status"", 2)"
      Set objTemp=objEdgeFilter.FindChild("Name",strTemp,50)
      If objTemp.Exists = TRUE then
        objTemp.Click
     
             
    set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1)
    strTemp="WPFObject(""LayoutTreeListView"")"
    Set objTemp=objEdge.FindChild("Name",strTemp,50)
    If objTemp.Exists=True then
      strTCRemarks = "Layout Grid found in Layout"
      log.Message "Layout grid found in Layout"
      set objEdgeTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("LayoutTreeControl").WPFObject("LayoutTreeListView")
      strTemp="WPFObject(""GridColumnHeader"", """", 3)"
      Set objTemp=objEdgeTree.FindChild("Name",strTemp,50)
      if objTemp.Exists=True then
        Delay (1000)
        if UCASE(objTemp.DataContext.Header)="FOOTNOTE" then
          strTCRemarks = strTCRemarks & "<br />" & "Footnote is found in Layout"
          log.Message "Footnote is found in Layout"
        Else
          strTCRemarks = strTCRemarks & "<br />" & "Footnote is not found in Layout"
          log.Message "Footnote is not found in Layout"
        End if
      Else 
        strTCRemarks = strTCRemarks & "<br />" & "Fields is not found in Layout"
      End if
       
      strTemp="WPFObject(""GridColumnHeader"", """", 5)"
      Set objTemp=objEdgeTree.FindChild("Name",strTemp,50)
      if objTemp.Exists=True then
        if UCASE(objTemp.DataContext.Header)="TALK" then
          strTCRemarks = strTCRemarks & "<br />" & "TALK is found in Layout"
          log.Message "TALK is found in Layout"
        Else
          strTCRemarks = strTCRemarks & "<br />" & "TALK is not found in Layout"
          log.Message "TALK is not found in Layout"
        End if 
      else
        strTCRemarks = strTCRemarks & "<br />" & "Fields is not found in Layout"
      End if
    
      strTemp="WPFObject(""GridColumnHeader"", """", 4)"
      Set objTemp=objEdgeTree.FindChild("Name",strTemp,50)
      if objTemp.Exists=True then
        if UCASE(objTemp.DataContext.Header)="EMIS" then
          strTCRemarks = strTCRemarks & "<br />" & "EMIS is found in Layout"
          log.Message "EMIS is found in Layout"
        Else
          strTCRemarks = strTCRemarks & "<br />" & "EMIS is not found in Layout"
          log.Message "EMIS is not found in Layout"
        End if 
      else
        strTCRemarks = strTCRemarks & "<br />" & "Fields is not found in Layout"
      End if
    else
      strTCRemarks =  "Layout Grid Not found in Layout"
    End if 
   End if 
  else
    strTCRemarks =  "File Repository Button is Not found in Layout"
  End if 
  
    set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1)
    strTemp="WPFObject(""ContentControlEx"", ""File Repository"", 2)"
    Set objTemp=objEdge.FindChild("Name",strTemp,50)
    If objTemp.Exists=True then
      strTCRemarks = "File Repository Button is found in Layout"
      log.Message "File Repository Button is found in Layout"
      objTemp.Click
      Delay(1000)
      set objEdgeFilter= Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarButtonItemLinkControl", "", 1)
      strTemp="WPFObject(""ContentControlEx"", ""Show / Hide Attachment Status"", 2)"
      Set objTemp=objEdgeFilter.FindChild("Name",strTemp,50)
      If objTemp.Exists = TRUE then
         objTemp.Click
         strTemp="WPFObject(""GridColumnHeader"", """", 3)"
      Set objTemp=objEdgeTree.FindChild("Name",strTemp,50)
      if objTemp.Exists=True then
        if UCASE(objTemp.DataContext.Header)="DISPLAY ORDER" then
          strTCRemarks = strTCRemarks & "<br />" & "Display Order is found in Layout"
          log.Message "Display Order is found in Layout"
        Else
          strTCRemarks = strTCRemarks & "<br />" & "Display Order is not found in Layout"
          log.Message "Display Order is not found in Layout"
        End if 
      else
        strTCRemarks = strTCRemarks & "<br />" & "Fields is not found in Layout"
      End if
    
      strTemp="WPFObject(""GridColumnHeader"", """", 4)"
      Set objTemp=objEdgeTree.FindChild("Name",strTemp,50)
        if objTemp.Exists=True then
          if UCASE(objTemp.DataContext.Header)="SYSTEM ID" then
            strTCRemarks = strTCRemarks & "<br />" & "System ID is found in Layout"
            log.Message "System ID is found in Layout"
          Else
            strTCRemarks = strTCRemarks & "<br />" & "System ID is not found in Layout"
            log.Message "System ID is not found in Layout"
          End if 
        else
          strTCRemarks = strTCRemarks & "<br />" & "Fields is not found in Layout"
        End if   
          strTemp="WPFObject(""GridColumnHeader"", """", 6)"
          Set objTemp=objEdgeTree.FindChild("Name",strTemp,50)
          if objTemp.Exists=True then
            if UCASE(objTemp.DataContext.Header)="EDIT" then
              strTCRemarks = strTCRemarks & "<br />" & "EDIT is found in Layout"
              log.Message "EDIT is found in Layout"
            Else
              strTCRemarks = strTCRemarks & "<br />" & "EDIT is not found in Layout"
              log.Message "EDIT is not found in Layout"
            End if 
          else
            strTCRemarks = strTCRemarks & "<br />" & "Fields is not found in Layout"
          End if
      End If
   End if 
   call sCloseLayout
End Sub

sub sCheckLayoutFileRepositoryUsage(strParameters)
      On Error Resume Next 
      Dim edgeClient,tableView,hierarchyPanel,dockPanel,layoutGroup
      Dim objGrid,objGridControl
      Dim rowMarginControl,rowMarginControl2
      Dim objTemp,objRemoveButton,StrCountryname,strObject
      Dim objEdge,strTemp,objStrClose
      Dim ObjGridLoad,ObjGridClose,objEdgeMDI
      Dim objEdgeFilter
      Dim objEdgeTree,strLayoutHeader,GridControl,GridSourceTree,intTotNodeCnt,intI,intJ,intK,strLevel1layout,strLevel2layout,strLevel3layout
    
'      set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1)
'      strTemp="WPFObject(""ContentControlEx"", ""File Repository"", 2)"
'      Set objTemp=objEdge.FindChild("Name",strTemp,50)
  
      Call sloadlayout 
      Call sCheckLayoutExpandTree(strParameters)
    
      strLevel1layout=getSplitValue(strParameters,"LEVEL1LAYOUT")
      strLevel2layout=getSplitValue(strParameters,"LEVEL2LAYOUT")
      strLevel3layout=getSplitValue(strParameters,"LEVEL3LAYOUT")

'    
'    strLevel1layout="dX Non-Asia Database (Current Eng Version)"
'    strLevel2layout="Z-Topic Test(IT-use only)"
'     strLevel3layout="Automation"

     Delay 3000,"Please Wait..."
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("LayoutTreeControl").WPFObject("LayoutTreeListView")
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("LayoutTreeControl")
    if strLevel1layout <> "" and strLevel2layout <> "" AND strLevel3layout <> "" then
        Delay 10000,"Please Wait..."
        ''Selecting Level1 layout
        intTotNodeCnt=GridControl.Nodes_2.Count
        For intI=0 to intTotNodeCnt-1         
            If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strLevel1layout) then
              GridControl.Nodes_2.Item(intI).Expand(True)
              log.Message "Level 1 Layout - " & GridControl.Nodes_2.Item(intI).Content.Description       
              blnFlag=False  
              Exit For
            End If
        Next
        Delay 3000,"Please Wait..."
        If blnFlag = True then
          strTCRemarks="Level 1 Layout not found"
          strTestCaseResult="FAIL"
          Exit Sub
        End If
  
        blnFlag = True 
        ''Selecting Level2 Layout
        Delay 10000,"Please Wait..."
        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
        For intJ=0 to intTotNodeCnt-1
          If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strLevel2layout) then
            GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
            log.Message "Level2 layout Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
            blnFlag = False 
            Exit For
          End If
        Next
        If blnFlag = True then
          strTCRemarks="Level2 Source Name not found"
          strTestCaseResult="FAIL"
          Exit Sub
        End If
        delay(3000)
        blnFlag = True    
        ''Selecting Level3 Layout
        Delay 3000,"Please Wait..."
          intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count
          For intK=0 to intTotNodeCnt-1
            If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description)=Ucase(strLevel3layout) then
              GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Expand(True)
              intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).get_RowHandle

              Call GridControl.ClearSelectionCore
              Call GridControl.FocusViewAndRow(GridControl,intRow)
              GridControl.SetFocusOnCurrentItem
              Call GridControl.SelectRowCore(intRow)
              log.Message "Level3 layout Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description
              blnFlag = False
              Exit For   
            End If 
          Next
          If blnFlag = True then
            strTCRemarks="Level3 Source Name not found"
            strTestCaseResult="FAIL"
            Exit Sub
          End If
    Elseif strLevel2layout<> "" AND strLevel3layout = "" then
       Delay 1000,"Please Wait..."
        ''Selecting Level1 layout
        intTotNodeCnt=GridControl.Nodes_2.Count
        For intI=0 to intTotNodeCnt-1         
            If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strLevel1layout) then
              GridControl.Nodes_2.Item(intI).Expand(True)
              intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
              Call GridControl.ClearSelectionCore
              Call GridControl.FocusViewAndRow(GridControl,intRow)
              GridControl.SetFocusOnCurrentItem
              Call GridControl.SelectRowCore(intRow)
              log.Message "Level 1 Layout - " & GridControl.Nodes_2.Item(intI).Content.Description       
              blnFlag=False  
              Exit For
            End If
        Next
        Delay 3000,"Please Wait..."
        If blnFlag = True then
          strTCRemarks="Level 1 Layout not found"
          strTestCaseResult="FAIL"
          Exit Sub
        End If
  
        blnFlag = True 
        ''Selecting Level2 Layout
        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
        For intJ=0 to intTotNodeCnt-1
          If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strLevel2layout) then
            GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
            intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
            GridControl.set_FocusedRowHandle(intRow)
            GridControl.Keys("[Down]")
            GridControl.Keys("[Up]")
            log.Message "Level2 layout Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
            blnFlag = False 
            Exit For
          End If
        Next
        If blnFlag = True then
          strTCRemarks="Level2 Source Name not found"
          strTestCaseResult="FAIL"
          Exit Sub
        End If 
    Elseif strLevel2layout="" then
      Delay 1000,"Please Wait..."
        ''Selecting Level1 layout
        intTotNodeCnt=GridControl.Nodes_2.Count
        For intI=0 to intTotNodeCnt-1         
            If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strLevel1layout) then
              GridControl.Nodes_2.Item(intI).Expand(True)
              intRow=GridControl.Nodes_2.Item(intI).get_RowHandle
              GridControl.set_FocusedRowHandle(intRow)
              GridControl.Keys("[Down]")
              GridControl.Keys("[Up]")
              log.Message "Level 1 Layout - " & GridControl.Nodes_2.Item(intI).Content.Description       
              blnFlag=False  
              Exit For
            End If
        Next
        Delay 3000,"Please Wait..."
        If blnFlag = True then
          strTCRemarks="Level 1 Layout not found"
          strTestCaseResult="FAIL"
          Exit Sub
        End If
    End if
        '' Opening File Repository Usage
      set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1)
      strTemp="WPFObject(""LayoutPanel"", """", 2)"
      Set objTemp=objEdge.FindChild("Name",strTemp,5)
      If objTemp.Exists = False then
        Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 2).WPFObject("BarSubItemLinkControl", "", 1).Click
        set objEdgeFilter= Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1)
        strTemp="WPFObject(""ContentControlEx"", ""File Repository Usage"", 2)"
        Set objTemp=objEdgeFilter.FindChild("Name",strTemp,50)
        If objTemp.Exists = TRUE then
          Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarButtonItemLinkControl", "", 1).WPFObject("ContentControlEx", "File Repository Usage", 2).Click
          Call sEdgeProcessor
          strTemp="WPFObject(""LayoutPanel"", """", 2)"
          Set objTemp=objEdge.WaitChild(strTemp,50000)
          If objTemp.Exists = False then
            strTestCaseResult = "FAIL"
            Exit Sub
          End If
        else
          strTestCaseResult = "FAIL"
          Exit Sub
        End if
      End If
 
      strTCRemarks = "Opened File Repository Usage Form"
     Call sCloseLayout   
     Call sCloseLayout

End Sub

sub sCheckLayoutAddNewLink(strParameters)
      On Error Resume Next 
      Dim edgeClient,tableView,hierarchyPanel,dockPanel,layoutGroup
      Dim objGrid,objGridControl
      Dim rowMarginControl,rowMarginControl2
      Dim objTemp,objRemoveButton,StrCountryname,strObject
      Dim objEdge,strTemp,objStrClose
      Dim ObjGridLoad,ObjGridClose,objEdgeMDI
      Dim objEdgeFilter
      Dim objEdgeTree,strLayoutHeader,GridControl,GridSourceTree,intTotNodeCnt,intI
    
'      set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1)
'      strTemp="WPFObject(""ContentControlEx"", ""File Repository"", 2)"
'      Set objTemp=objEdge.FindChild("Name",strTemp,50)
  
      Call sloadlayout 
      Call sCheckLayoutExpandTree(strParameters)
    
      strLevel1layout=getSplitValue(strParameters,"LEVEL1LAYOUT")
      strLevel2layout=getSplitValue(strParameters,"LEVEL2LAYOUT")
      strLevel3layout=getSplitValue(strParameters,"LEVEL3LAYOUT")

    
'    strLevel1layout="dX Non-Asia Database (Current Eng Version)"
'    strLevel2layout="Z-Topic Test(IT-use only)"
'    strLevel3layout="Automation"

     Delay 3000,"Please Wait..."
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("LayoutTreeControl").WPFObject("LayoutTreeListView")
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("LayoutTreeControl")
    if strLevel1layout <> "" and strLevel2layout <> "" AND strLevel3layout <> "" then
        Delay 1000,"Please Wait..."
        ''Selecting Level1 layout
        intTotNodeCnt=GridControl.Nodes_2.Count
        For intI=0 to intTotNodeCnt-1         
            If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strLevel1layout) then
              GridControl.Nodes_2.Item(intI).Expand(True)
              log.Message "Level 1 Layout - " & GridControl.Nodes_2.Item(intI).Content.Description       
              blnFlag=False  
              Exit For
            End If
        Next
        Delay 3000,"Please Wait..."
        If blnFlag = True then
          strTCRemarks="Level 1 Layout not found"
          strTestCaseResult="FAIL"
          Exit Sub
        End If
  
        blnFlag = True 
        ''Selecting Level2 Layout
        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
        For intJ=0 to intTotNodeCnt-1
          If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strLevel2layout) then
            GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
            log.Message "Level2 layout Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
            blnFlag = False 
            Exit For
          End If
        Next
        If blnFlag = True then
          strTCRemarks="Level2 Source Name not found"
          strTestCaseResult="FAIL"
          Exit Sub
        End If
        delay(3000)
        blnFlag = True    
        ''Selecting Level3 Layout
          intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count
          For intK=0 to intTotNodeCnt-1
            If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description)=Ucase(strLevel3layout) then
              GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Expand(True)
              intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).get_RowHandle

              Call GridControl.ClearSelectionCore
              Call GridControl.FocusViewAndRow(GridControl,intRow)
              GridControl.SetFocusOnCurrentItem
              Call GridControl.SelectRowCore(intRow)
              log.Message "Level3 layout Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description
              blnFlag = False
              Exit For   
            End If 
          Next
          If blnFlag = True then
            strTCRemarks="Level3 Source Name not found"
            strTestCaseResult="FAIL"
            Exit Sub
          End If
    Elseif strLevel2layout<> "" AND strLevel3layout = "" then
       Delay 1000,"Please Wait..."
        ''Selecting Level1 layout
        intTotNodeCnt=GridControl.Nodes_2.Count
        For intI=0 to intTotNodeCnt-1         
            If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strLevel1layout) then
              GridControl.Nodes_2.Item(intI).Expand(True)
              intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
              Call GridControl.ClearSelectionCore
              Call GridControl.FocusViewAndRow(GridControl,intRow)
              GridControl.SetFocusOnCurrentItem
              Call GridControl.SelectRowCore(intRow)
              log.Message "Level 1 Layout - " & GridControl.Nodes_2.Item(intI).Content.Description       
              blnFlag=False  
              Exit For
            End If
        Next
        Delay 3000,"Please Wait..."
        If blnFlag = True then
          strTCRemarks="Level 1 Layout not found"
          strTestCaseResult="FAIL"
          Exit Sub
        End If
  
        blnFlag = True 
        ''Selecting Level2 Layout
        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
        For intJ=0 to intTotNodeCnt-1
          If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strLevel2layout) then
            GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
            intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
            GridControl.set_FocusedRowHandle(intRow)
            GridControl.Keys("[Down]")
            GridControl.Keys("[Up]")
            log.Message "Level2 layout Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
            blnFlag = False 
            Exit For
          End If
        Next
        If blnFlag = True then
          strTCRemarks="Level2 Source Name not found"
          strTestCaseResult="FAIL"
          Exit Sub
        End If 
    Elseif strLevel2layout="" then
      Delay 1000,"Please Wait..."
        ''Selecting Level1 layout
        intTotNodeCnt=GridControl.Nodes_2.Count
        For intI=0 to intTotNodeCnt-1         
            If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strLevel1layout) then
              GridControl.Nodes_2.Item(intI).Expand(True)
              intRow=GridControl.Nodes_2.Item(intI).get_RowHandle
              GridControl.set_FocusedRowHandle(intRow)
              GridControl.Keys("[Down]")
              GridControl.Keys("[Up]")
              log.Message "Level 1 Layout - " & GridControl.Nodes_2.Item(intI).Content.Description       
              blnFlag=False  
              Exit For
            End If
        Next
        Delay 3000,"Please Wait..."
        If blnFlag = True then
          strTCRemarks="Level 1 Layout not found"
          strTestCaseResult="FAIL"
          Exit Sub
        End If
    End if
        '' Opening File Repository Usage
        Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 2).WPFObject("BarSubItemLinkControl", "", 1).WPFObject("ContentControlEx", "File Repository", 2).Click
        set objEdgeFilter= Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1)
        strTemp="WPFObject(""ContentControlEx"", ""Add New Link"", 2)"
        Set objTemp=objEdgeFilter.FindChild("Name",strTemp,50)
        If objTemp.Exists = TRUE then
          Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 2).WPFObject("BarButtonItemLinkControl", "", 1).WPFObject("ContentControlEx", "Add New Link", 2).Click
        else
          strTestCaseResult = "FAIL"
          Exit Sub
        End if 
      strTCRemarks = "Opened File Repository Usage Form"
     Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: AddFileLinkView", "Add New Link").WPFObject("AddFileLinkView", "Add New Link", 1).WPFObject("Grid", "", 1).WPFObject("PART_ResizeFrame")
     If objTemp.Exists = TRUE then
        Sys.Process("EdgeClient").WPFObject("HwndSource: AddFileLinkView", "Add New Link").WPFObject("AddFileLinkView", "Add New Link", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("CancelButton").Click
        Delay (5000)
     End if 
     Call sCloseLayout

End Sub

sub sCheckLayoutAddNewLinkValidateFootnote(strParameters)
      On Error Resume Next 
      Dim edgeClient,tableView,hierarchyPanel,dockPanel,layoutGroup
      Dim objGrid,objGridControl
      Dim rowMarginControl,rowMarginControl2
      Dim objTemp,objRemoveButton,StrCountryname,strObject
      Dim objEdge,strTemp,objStrClose
      Dim ObjGridLoad,ObjGridClose,objEdgeMDI
      Dim objEdgeFilter,strLevel1layout,strLevel2layout,strLevel3layout
      Dim objEdgeTree,strLayoutHeader,GridControl,GridSourceTree,intTotNodeCnt,intI,intJ,intK
    
      
  
      Call sloadlayout 
      Call sCheckLayoutExpandTree(strParameters)
      
      set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1)
      strTemp="WPFObject(""ContentControlEx"", ""File Repository"", 2)"
      Set objTemp=objEdge.FindChild("Name",strTemp,50)
    
      strLevel1layout=getSplitValue(strParameters,"LEVEL1LAYOUT")
      strLevel2layout=getSplitValue(strParameters,"LEVEL2LAYOUT")
      strLevel3layout=getSplitValue(strParameters,"LEVEL3LAYOUT")
    StrCountryname=getSplitValue(strParameters,"COUNTRY")
'    StrCountryname="Country: AGG"
'    strLevel1layout="dX Non-Asia Database (Current Eng Version)"
'    strLevel2layout="Z-Topic Test(IT-use only)"
'    strLevel3layout="Automation"

     Delay 3000,"Please Wait..."
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("LayoutTreeControl").WPFObject("LayoutTreeListView")
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("LayoutTreeControl")
    if strLevel1layout <> "" and strLevel2layout <> "" AND strLevel3layout <> "" then
        Delay 10000,"Please Wait..."
        ''Selecting Level1 layout
        intTotNodeCnt=GridControl.Nodes_2.Count
        For intI=0 to intTotNodeCnt-1         
            If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strLevel1layout) then
              GridControl.Nodes_2.Item(intI).Expand(True)
              log.Message "Level 1 Layout - " & GridControl.Nodes_2.Item(intI).Content.Description       
              blnFlag=False  
              Exit For
            End If
        Next
        Delay 3000,"Please Wait..."
        If blnFlag = True then
          strTCRemarks="Level 1 Layout not found"
          strTestCaseResult="FAIL"
          Exit Sub
        End If
  
        blnFlag = True 
        ''Selecting Level2 Layout
        Delay 10000,"Please Wait..."
        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
        For intJ=0 to intTotNodeCnt-1
          If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strLevel2layout) then
            GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
            log.Message "Level2 layout Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
            blnFlag = False 
            Exit For
          End If
        Next
        If blnFlag = True then
          strTCRemarks="Level2 Source Name not found"
          strTestCaseResult="FAIL"
          Exit Sub
        End If
       ' delay(3000)
        blnFlag = True    
        ''Selecting Level3 Layout
        Delay 10000,"Please Wait..."
          intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count
          For intK=0 to intTotNodeCnt-1
            If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description)=Ucase(strLevel3layout) then
              GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Expand(True)
              intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).get_RowHandle

              Call GridControl.ClearSelectionCore
              Call GridControl.FocusViewAndRow(GridControl,intRow)
              GridControl.SetFocusOnCurrentItem
              Call GridControl.SelectRowCore(intRow)
              log.Message "Level3 layout Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description
              blnFlag = False
              Exit For   
            End If 
          Next
          If blnFlag = True then
            strTCRemarks="Level3 Source Name not found"
            strTestCaseResult="FAIL"
            Exit Sub
          End If
    Elseif strLevel2layout<> "" AND strLevel3layout = "" then
      Delay 10000,"Please Wait..."
        ''Selecting Level1 layout
        intTotNodeCnt=GridControl.Nodes_2.Count
        For intI=0 to intTotNodeCnt-1         
            If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strLevel1layout) then
              GridControl.Nodes_2.Item(intI).Expand(True)
              intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
              Call GridControl.ClearSelectionCore
              Call GridControl.FocusViewAndRow(GridControl,intRow)
              GridControl.SetFocusOnCurrentItem
              Call GridControl.SelectRowCore(intRow)
              log.Message "Level 1 Layout - " & GridControl.Nodes_2.Item(intI).Content.Description       
              blnFlag=False  
              Exit For
            End If
        Next
        Delay 3000,"Please Wait..."
        If blnFlag = True then
          strTCRemarks="Level 1 Layout not found"
          strTestCaseResult="FAIL"
          Exit Sub
        End If
  
        blnFlag = True 
        ''Selecting Level2 Layout
        Delay 10000,"Please Wait..."
        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
        For intJ=0 to intTotNodeCnt-1
          If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strLevel2layout) then
            GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
            intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
            GridControl.set_FocusedRowHandle(intRow)
            GridControl.Keys("[Down]")
            GridControl.Keys("[Up]")
            log.Message "Level2 layout Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
            blnFlag = False 
            Exit For
          End If
        Next
        If blnFlag = True then
          strTCRemarks="Level2 Source Name not found"
          strTestCaseResult="FAIL"
          Exit Sub
        End If 
    Elseif strLevel2layout="" then
     Delay 10000,"Please Wait..."
        ''Selecting Level1 layout
        intTotNodeCnt=GridControl.Nodes_2.Count
        For intI=0 to intTotNodeCnt-1         
            If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strLevel1layout) then
              GridControl.Nodes_2.Item(intI).Expand(True)
              intRow=GridControl.Nodes_2.Item(intI).get_RowHandle
              GridControl.set_FocusedRowHandle(intRow)
              GridControl.Keys("[Down]")
              GridControl.Keys("[Up]")
              log.Message "Level 1 Layout - " & GridControl.Nodes_2.Item(intI).Content.Description       
              blnFlag=False  
              Exit For
            End If
        Next
        Delay 3000,"Please Wait..."
        If blnFlag = True then
          strTCRemarks="Level 1 Layout not found"
          strTestCaseResult="FAIL"
          Exit Sub
        End If
    End if
        '' Opening File Repository Usage
        Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 2).WPFObject("BarSubItemLinkControl", "", 1).WPFObject("ContentControlEx", "File Repository", 2).Click
        set objEdgeFilter= Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1)
        strTemp="WPFObject(""ContentControlEx"", ""Add New Link"", 2)"
        Set objTemp=objEdgeFilter.FindChild("Name",strTemp,50)
        If objTemp.Exists = TRUE then
          Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 2).WPFObject("BarButtonItemLinkControl", "", 1).WPFObject("ContentControlEx", "Add New Link", 2).Click
        else
          strTestCaseResult = "FAIL"
          Exit Sub
        End if 
      strTCRemarks = "Opened File Repository Usage Form"
     Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: AddFileLinkView", "Add New Link").WPFObject("AddFileLinkView", "Add New Link", 1).WPFObject("Grid", "", 1).WPFObject("PART_ResizeFrame")
     If objTemp.Exists = TRUE then
     Set edgeClient = Aliases.EdgeClient
      'Set objGrid = edgeClient.HwndSource_AddFileLinkView.AddFileLinkView.Grid.FloatingContainerBorder.FloatingContainerBackground.Grid.FloatingContainerBody.Grid.Grid.PART_ContainerContent.BarManager.AdornerDecorator.AdornedControl.Grid
      Set objGrid = Sys.Process("EdgeClient").WPFObject("HwndSource: AddFileLinkView", "Add New Link").WPFObject("AddFileLinkView", "Add New Link", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1)
      Set objGridControl = objGrid.WPFObject("SelectionGrid")
      Call objGridControl.ClickColumnHeaderRXY("Group", 64, 9)
      set objEdgeFilter= Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1)
      strTemp="WPFObject(""ContentControlEx"", ""Show Search Panel"", 2)"
      Set objTemp=objEdgeFilter.FindChild("Name",strTemp,50)
      If objTemp.Exists = TRUE then
        Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 13).WPFObject("BarButtonItemLinkControl", "", 1).WPFObject("ContentControlEx", "Show Search Panel", 2).Click
        Delay 10000,"Please Wait..."
      Else
        strTestCaseResult = "ABORT"
        Exit Sub  
      End If
      'Call edgeClient.HwndSource_PopupRoot.PopupRoot.Decorator.NonLogicalAdornerDecorator.BarPopupBorderControl.PopupMenuBarControl.BaritemlinkinfoShowSearchPanel.BarbuttonitemlinkcontrolShowSearchPanel.ContentcontrolexShowSearchPanel.Click(29, 6)
      Set tableView = objGridControl.WPFObject("SelectionGridTableView")
      Call tableView.Click(150, 21)
      Call tableView.Keys(StrCountryname)
      Delay(30000)
      'Set hierarchyPanel = tableView.HierarchyPanel
      Set hierarchyPanel = tableView.WPFObject("HierarchyPanel", "", 1)

      Sys.Process("EdgeClient").WPFObject("HwndSource: AddFileLinkView", "Add New Link").WPFObject("AddFileLinkView", "Add New Link", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("SelectionGrid").WPFObject("SelectionGridTableView").WPFObject("HierarchyPanel", "", 1).WPFObject("GroupGridRow", "", 1).WPFObject("MeasurePixelSnapper", "", 1).WPFObject("PART_GroupRowContent").WPFObject("DXDockPanel", "", 1).WPFObject("Toggle").Click
      'Sys.Process("EdgeClient").WPFObject("HwndSource: AddFileLinkView", "Add New Link").WPFObject("AddFileLinkView", "Add New Link", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("SelectionGrid").WPFObject("SelectionGridTableView").WPFObject("HierarchyPanel", "", 1).WPFObject("GridRow", "", 9).WPFObject("ScrollablePart").WPFObject("CellItemsControl", "", 1).WPFObject("GridCellContentPresenter", "", 1).WPFObject("ContentControl", "FOOTNOTE", 1).Click
      Sys.Process("EdgeClient").WPFObject("HwndSource: AddFileLinkView", "Add New Link").WPFObject("AddFileLinkView", "Add New Link", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("SelectionGrid").WPFObject("SelectionGridTableView").WPFObject("HierarchyPanel", "", 1).WPFObject("RowControl", "", 9).WPFObject("CellsControl", "", 1).WPFObject("LightweightCellEditor", "", 1).WPFObject("ContentControl", "FOOTNOTE", 1).Click
      'objGrid.StackPanel.OkButton.ClickButton
      Sys.Process("EdgeClient").WPFObject("HwndSource: AddFileLinkView", "Add New Link").WPFObject("AddFileLinkView", "Add New Link", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("OkButton").Click
      Delay(10000)
'      Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("Adorner").WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 2).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("AddLinkButton").Click
'      Delay(10000)
      End if 
      Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: AddFileLinkView", "Add New Link").WPFObject("AddFileLinkView", "Add New Link", 1).WPFObject("Grid", "", 1).WPFObject("PART_ResizeFrame")
     If objTemp.Exists = TRUE then
      strTemp="WPFObject(""DXMessageBox"", """", 1)"
      Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: WindowContentHolder", "Add file association failed.").WPFObject("WindowContentHolder", "Add file association failed.", 1).WPFObject("NonLogicalDecorator", "", 1).WPFObject("ThemedManagedContentPresenter", "", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WaitChild(strTemp,50000)
      If objTemp.Exists Then
        objTemp.Keys("[Enter]")
      End If
      strTemp="WPFObject(""Label"", ""Only 1 usage per language per layout node for FOOTNOTE group"", 1)"
      Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: AddFileLinkView", "Add New Link").WPFObject("AddFileLinkView", "Add New Link", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WaitChild(strTemp,50000)
      If objTemp.Exists Then
         strTCRemarks =strTCRemarks & "<br />" & "Only 1 usage per language per layout node for FOOTNOTE group"
         Sys.Process("EdgeClient").WPFObject("HwndSource: AddFileLinkView", "Add New Link").WPFObject("AddFileLinkView", "Add New Link", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("CancelButton").Click
      End If
     End if 
     Call sCloseLayout

End Sub


sub sCheckLayoutAddNewLinkFootnote(strParameters)
      On Error Resume Next 
      Dim edgeClient,tableView,hierarchyPanel,dockPanel,layoutGroup
      Dim objGrid,objGridControl
      Dim rowMarginControl,rowMarginControl2
      Dim objTemp,objRemoveButton,StrCountryname,strObject
      Dim objEdge,strTemp,objStrClose
      Dim ObjGridLoad,ObjGridClose,objEdgeMDI
      Dim objEdgeFilter
      
      Call sloadLayout
      Call sCheckLayoutExpandTree(strParameters)
       Call sLayoutFileRep(strParameters)
       StrCountryname=getSplitValue(strParameters,"COUNTRY")
'      StrCountryname="Country: CHN"
  
        '' Opening File Repository Usage
      set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1)
      strTemp="WPFObject(""LayoutPanel"", """", 2)"
      Set objTemp=objEdge.FindChild("Name",strTemp,5)
      If objTemp.Exists = False then
        Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 2).WPFObject("BarSubItemLinkControl", "", 1).Click
        set objEdgeFilter= Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1)
        strTemp="WPFObject(""ContentControlEx"", ""File Repository Usage"", 2)"
        Set objTemp=objEdgeFilter.FindChild("Name",strTemp,50)
        If objTemp.Exists = TRUE then
          Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarButtonItemLinkControl", "", 1).WPFObject("ContentControlEx", "File Repository Usage", 2).Click
          'Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).ClickItem("[0]|File Repository|File Repository Usage")
          'Delay 60000,"Opening File Repository Usage.. Pls wait."
          Call sEdgeProcessor
          strTemp="WPFObject(""LayoutPanel"", """", 2)"
          Set objTemp=objEdge.WaitChild(strTemp,50000)
          If objTemp.Exists = False then
            strTestCaseResult = "FAIL"
            Exit Sub
          End If
        else
          strTestCaseResult = "FAIL"
          Exit Sub
        End if
      End If
 
      strTCRemarks = "Opened File Repository Usage Form"
      Set edgeClient = Aliases.EdgeClient
      'Set objGridControl = edgeClient.HwndSource_RibbonWindow.RibbonWindow.ContentControl.Grid.Grid.ContentControl.Grid.ContentControl.PART_ContainerContent.BarManager.DockPanel.DockLayoutManager.LayoutGroup.LayoutPanel2.Root.BarManager.AdornerDecorator.AdornedControl.Grid.DockPanel2.Grid.DockPanel.LayoutFileGridControl
      Set objGridControl = Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("Adorner").WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 2).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 1).WPFObject("LayoutFileGridControl")
      Call objGridControl.ClickColumnHeaderRXY("Group", 42, 9)
      
      'Call edgeClient.HwndSource_PopupRoot.PopupRoot.Decorator.NonLogicalAdornerDecorator.BarPopupBorderControl.PopupMenuBarControl.BaritemlinkinfoShowSearchPanel.BarbuttonitemlinkcontrolShowSearchPanel.ContentcontrolexShowSearchPanel.Click(25, 8)
     
      set objEdgeFilter= Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1)
      strTemp="WPFObject(""ContentControlEx"", ""Show Search Panel"", 2)"
      Set objTemp=objEdgeFilter.FindChild("Name",strTemp,50)
      If objTemp.Exists = TRUE then
       ' Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 14).WPFObject("BarButtonItemLinkControl", "", 1).WPFObject("ItemBorderControl", "", 1).Click
        Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 11).WPFObject("BarButtonItemLinkControl", "", 1).WPFObject("ContentControlEx", "Show Search Panel", 2).Click
        Delay(10000)
      Else
        strTestCaseResult = "ABORT"
        Exit Sub  
      End If
      
      Set  tableView = objGridControl.WPFObject("LayoutFileTableView")
      Call tableView.Click(99, 17)
      Call tableView.Keys("Footnote")
      Delay(5000)
      set objRemoveButton=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("Adorner").WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 2).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("RemoveLinkButton")
      Delay(5000)
      If objRemoveButton.Enabled=True then
        Call objGridControl.ClickCell(0, "Group")
        Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("Adorner").WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 2).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("RemoveLinkButton").Click
        'Delay(10000)
          ''Clicking on OK Button
         strTemp="WPFObject(""PART_ContainerContent"")"
         Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "File Repository Usage").WPFObject("CustomMessageBoxWindow", "File Repository Usage", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,600000)
         If objTemp.Exists = True then
            objTemp.Click
            SYS.Keys("Y")
         End If
        
        strTemp="WPFObject(""PART_ContainerContent"")"
        Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "File Repository Usage").WPFObject("CustomMessageBoxWindow", "File Repository Usage", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,600000)
        If objTemp.Exists Then
          objTemp.Click
            SYS.Keys("O")
        End If
      End If 
  
      Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("Adorner").WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 2).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("AddLinkButton").Click
      DElay(10000)
  
      Set edgeClient = Aliases.EdgeClient
      'Set objGrid = edgeClient.HwndSource_AddFileLinkView.AddFileLinkView.Grid.FloatingContainerBorder.FloatingContainerBackground.Grid.FloatingContainerBody.Grid.Grid.PART_ContainerContent.BarManager.AdornerDecorator.AdornedControl.Grid
      Set objGrid = Sys.Process("EdgeClient").WPFObject("HwndSource: AddFileLinkView", "Add New Link").WPFObject("AddFileLinkView", "Add New Link", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1)
      Set objGridControl = objGrid.WPFObject("SelectionGrid")
      Call objGridControl.ClickColumnHeaderRXY("Group", 64, 9)
      set objEdgeFilter= Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1)
      strTemp="WPFObject(""ContentControlEx"", ""Show Search Panel"", 2)"
      Set objTemp=objEdgeFilter.FindChild("Name",strTemp,50)
      If objTemp.Exists = TRUE then
        Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 13).WPFObject("BarButtonItemLinkControl", "", 1).WPFObject("ContentControlEx", "Show Search Panel", 2).Click
        Delay(10000)
      Else
        strTestCaseResult = "ABORT"
        Exit Sub  
      End If
      'Call edgeClient.HwndSource_PopupRoot.PopupRoot.Decorator.NonLogicalAdornerDecorator.BarPopupBorderControl.PopupMenuBarControl.BaritemlinkinfoShowSearchPanel.BarbuttonitemlinkcontrolShowSearchPanel.ContentcontrolexShowSearchPanel.Click(29, 6)
      Set tableView = objGridControl.WPFObject("SelectionGridTableView")
      Call tableView.Click(150, 21)
      Call tableView.Keys(StrCountryname)
      Delay(30000)
      'Set hierarchyPanel = tableView.HierarchyPanel
      Set hierarchyPanel = tableView.WPFObject("HierarchyPanel", "", 1)

      Sys.Process("EdgeClient").WPFObject("HwndSource: AddFileLinkView", "Add New Link").WPFObject("AddFileLinkView", "Add New Link", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("SelectionGrid").WPFObject("SelectionGridTableView").WPFObject("HierarchyPanel", "", 1).WPFObject("GroupGridRow", "", 1).WPFObject("MeasurePixelSnapper", "", 1).WPFObject("PART_GroupRowContent").WPFObject("DXDockPanel", "", 1).WPFObject("Toggle").Click
      'Sys.Process("EdgeClient").WPFObject("HwndSource: AddFileLinkView", "Add New Link").WPFObject("AddFileLinkView", "Add New Link", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("SelectionGrid").WPFObject("SelectionGridTableView").WPFObject("HierarchyPanel", "", 1).WPFObject("GridRow", "", 9).WPFObject("ScrollablePart").WPFObject("CellItemsControl", "", 1).WPFObject("GridCellContentPresenter", "", 1).WPFObject("ContentControl", "FOOTNOTE", 1).Click
      Sys.Process("EdgeClient").WPFObject("HwndSource: AddFileLinkView", "Add New Link").WPFObject("AddFileLinkView", "Add New Link", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("SelectionGrid").WPFObject("SelectionGridTableView").WPFObject("HierarchyPanel", "", 1).WPFObject("RowControl", "", 9).WPFObject("CellsControl", "", 1).WPFObject("LightweightCellEditor", "", 1).WPFObject("ContentControl", "FOOTNOTE", 1).Click
      'objGrid.StackPanel.OkButton.ClickButton
      Sys.Process("EdgeClient").WPFObject("HwndSource: AddFileLinkView", "Add New Link").WPFObject("AddFileLinkView", "Add New Link", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("OkButton").Click
      Delay(10000)
      Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("Adorner").WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 2).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("AddLinkButton").Click
      Delay(10000)
    
      strTCRemarks = "ADDED FootNote Link in File Repository Usage Form"
  

       Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: AddFileLinkView", "Add New Link").WPFObject("AddFileLinkView", "Add New Link", 1).WPFObject("Grid", "", 1).WPFObject("PART_ResizeFrame")
       If objTemp.Exists = TRUE then
           Sys.Process("EdgeClient").WPFObject("HwndSource: AddFileLinkView", "Add New Link").WPFObject("AddFileLinkView", "Add New Link", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("CancelButton").Click
       End if 
     
      set objEdge= Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1)
      strTemp="WPFObject(""LayoutPanel"", """", 2)"
      Set objTemp=objEdge.FindChild("Name",strTemp,5)
      If objTemp.Exists = TRUE then
        set objStrClose= Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2)
        objStrClose.Closed=True
      End If 
  
  
      set objEdge= Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1)
      strTemp="WPFObject(""LayoutPanel"", """", 1)"
      Set objTemp=objEdge.FindChild("Name",strTemp,5)
      If objTemp.Exists = TRUE then
        set objStrClose= Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1)
        objStrClose.Closed=True
      End If


End Sub


sub sCheckLayoutAddNewLinkDataLink(strParameters)
     On Error Resume Next 
      Dim edgeClient,tableView,hierarchyPanel,dockPanel,layoutGroup
      Dim objGrid,objGridControl
      Dim rowMarginControl,rowMarginControl2
      Dim objTemp,objRemoveButton,StrCountryname,strObject
      Dim objEdge,strTemp,objStrClose
      Dim ObjGridLoad,ObjGridClose,objEdgeMDI
      Dim objEdgeFilter
      
       CALL sLayoutFileRep(strParameters)
       StrCountryname=getSplitValue(strParameters,"COUNTRY")
'      StrCountryname="Country: CHN"
  
        '' Opening File Repository Usage
      set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1)
      strTemp="WPFObject(""LayoutPanel"", """", 2)"
      Set objTemp=objEdge.FindChild("Name",strTemp,5)
      If objTemp.Exists = False then
        Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 2).WPFObject("BarSubItemLinkControl", "", 1).Click
        set objEdgeFilter= Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1)
        strTemp="WPFObject(""ContentControlEx"", ""File Repository Usage"", 2)"
        Set objTemp=objEdgeFilter.FindChild("Name",strTemp,50)
        If objTemp.Exists = TRUE then
          Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarButtonItemLinkControl", "", 1).WPFObject("ContentControlEx", "File Repository Usage", 2).Click
          'Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).ClickItem("[0]|File Repository|File Repository Usage")
          'Delay 60000,"Opening File Repository Usage.. Pls wait."
          Call sEdgeProcessor
          strTemp="WPFObject(""LayoutPanel"", """", 2)"
          Set objTemp=objEdge.WaitChild(strTemp,50000)
          If objTemp.Exists = False then
            strTestCaseResult = "FAIL"
            Exit Sub
          End If
        else
          strTestCaseResult = "FAIL"
          Exit Sub
        End if
      End If
 
      strTCRemarks = "Opened File Repository Usage Form"

      Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("Adorner").WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 2).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("AddLinkButton").Click
      Set edgeClient = Aliases.EdgeClient
     ' Set objGrid = edgeClient.HwndSource_AddFileLinkView.AddFileLinkView.Grid.FloatingContainerBorder.FloatingContainerBackground.Grid.FloatingContainerBody.Grid.Grid.PART_ContainerContent.BarManager.AdornerDecorator.AdornedControl.Grid
      Set objGrid = Sys.Process("EdgeClient").WPFObject("HwndSource: AddFileLinkView", "Add New Link").WPFObject("AddFileLinkView", "Add New Link", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1)
      'Set objGridControl = objGrid.SelectionGrid
      Set objGridControl = objGrid.WPFObject("SelectionGrid")
      Call objGridControl.ClickColumnHeaderRXY("Group", 64, 9)
      set objEdgeFilter= Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1)
      strTemp="WPFObject(""ContentControlEx"", ""Show Search Panel"", 2)"
      Set objTemp=objEdgeFilter.FindChild("Name",strTemp,50)
      If objTemp.Exists = TRUE then
        Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 13).WPFObject("BarButtonItemLinkControl", "", 1).WPFObject("ContentControlEx", "Show Search Panel", 2).Click
        Delay(10000)
      Else
        strTestCaseResult = "ABORT"
        Exit Sub  
      End If
      
      'Call edgeClient.HwndSource_PopupRoot.PopupRoot.Decorator.NonLogicalAdornerDecorator.BarPopupBorderControl.PopupMenuBarControl.BaritemlinkinfoShowSearchPanel.BarbuttonitemlinkcontrolShowSearchPanel.ContentcontrolexShowSearchPanel.Click(29, 6)
      'Set tableView = objGridControl.SelectionGridTableView
      Set tableView = objGridControl.WPFObject("SelectionGridTableView")
      Call tableView.Click(150, 21)
      Call tableView.Keys(StrCountryname)
      Delay(30000)
      Set hierarchyPanel = tableView.WPFObject("HierarchyPanel", "", 1)
      Sys.Process("EdgeClient").WPFObject("HwndSource: AddFileLinkView", "Add New Link").WPFObject("AddFileLinkView", "Add New Link", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("SelectionGrid").WPFObject("SelectionGridTableView").WPFObject("HierarchyPanel", "", 1).WPFObject("GroupGridRow", "", 1).WPFObject("MeasurePixelSnapper", "", 1).WPFObject("PART_GroupRowContent").WPFObject("DXDockPanel", "", 1).WPFObject("Toggle").Click
      Sys.Process("EdgeClient").WPFObject("HwndSource: AddFileLinkView", "Add New Link").WPFObject("AddFileLinkView", "Add New Link", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("SelectionGrid").WPFObject("SelectionGridTableView").WPFObject("HierarchyPanel", "", 1).WPFObject("RowControl", "", 1).WPFObject("CellsControl", "", 1).WPFObject("LightweightCellEditor", "", 1).WPFObject("ContentControl", "DATA TALK", 1).Click
      Delay(10000)
      'objGrid.StackPanel.OkButton.ClickButton
      Sys.Process("EdgeClient").WPFObject("HwndSource: AddFileLinkView", "Add New Link").WPFObject("AddFileLinkView", "Add New Link", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("OkButton").Click
      Delay(10000)
      strTCRemarks = strTCRemarks & "<br />" & "ADDED DATA TALK Link in File Repository Usage Form"
      Delay(10000)

'       Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: AddFileLinkView", "Add New Link").WPFObject("AddFileLinkView", "Add New Link", 1).WPFObject("Grid", "", 1).WPFObject("PART_ResizeFrame")
'       If objTemp.Exists = TRUE then
'           Sys.Process("EdgeClient").WPFObject("HwndSource: AddFileLinkView", "Add New Link").WPFObject("AddFileLinkView", "Add New Link", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("CancelButton").Click
'       End if 
'     
      set objEdge= Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1)
      strTemp="WPFObject(""LayoutPanel"", """", 2)"
      Set objTemp=objEdge.FindChild("Name",strTemp,5)
      If objTemp.Exists = TRUE then
        set objStrClose= Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2)
        objStrClose.Closed=True
      End If 
      set objEdge= Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1)
      strTemp="WPFObject(""LayoutPanel"", """", 1)"
      Set objTemp=objEdge.FindChild("Name",strTemp,5)
      If objTemp.Exists = TRUE then
        set objStrClose= Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1)
        objStrClose.Closed=True
      End If


End Sub
sub sCheckLayoutAddNewLinkAllLink(strParameters)
     On Error Resume Next 
      Dim edgeClient,tableView,hierarchyPanel,dockPanel,layoutGroup
      Dim objGrid,objGridControl
      Dim rowMarginControl,rowMarginControl2
      Dim objTemp,objRemoveButton,StrCountryname,strObject
      Dim objEdge,strTemp,objStrClose
      Dim ObjGridLoad,ObjGridClose,objEdgeMDI
      Dim objEdgeFilter
      
       CALL sLayoutFileRep(strParameters)
       StrCountryname=getSplitValue(strParameters,"COUNTRY")
'      StrCountryname="Country: CHN"
  
        '' Opening File Repository Usage
      set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1)
      strTemp="WPFObject(""LayoutPanel"", """", 2)"
      Set objTemp=objEdge.FindChild("Name",strTemp,5)
      If objTemp.Exists = False then
        Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 2).WPFObject("BarSubItemLinkControl", "", 1).Click
        set objEdgeFilter= Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1)
        strTemp="WPFObject(""ContentControlEx"", ""File Repository Usage"", 2)"
        Set objTemp=objEdgeFilter.FindChild("Name",strTemp,50)
        If objTemp.Exists = TRUE then
          Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarButtonItemLinkControl", "", 1).WPFObject("ContentControlEx", "File Repository Usage", 2).Click
          Call sEdgeProcessor
          strTemp="WPFObject(""LayoutPanel"", """", 2)"
          Set objTemp=objEdge.WaitChild(strTemp,50000)
          If objTemp.Exists = False then
            strTestCaseResult = "FAIL"
            Exit Sub
          End If
        else
          strTestCaseResult = "FAIL"
          Exit Sub
        End if
      End If
 
      strTCRemarks = "Opened File Repository Usage Form"
      Set edgeClient = Aliases.EdgeClient
      'Set objGridControl = edgeClient.HwndSource_RibbonWindow.RibbonWindow.ContentControl.Grid.Grid.ContentControl.Grid.ContentControl.PART_ContainerContent.BarManager.DockPanel.DockLayoutManager.LayoutGroup.LayoutPanel2.Root.BarManager.AdornerDecorator.AdornedControl.Grid.DockPanel2.Grid.DockPanel.LayoutFileGridControl
      Set objGridControl = Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("Adorner").WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 2).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 1).WPFObject("LayoutFileGridControl")
      Call objGridControl.ClickColumnHeaderRXY("Group", 42, 9)
      
      'Call edgeClient.HwndSource_PopupRoot.PopupRoot.Decorator.NonLogicalAdornerDecorator.BarPopupBorderControl.PopupMenuBarControl.BaritemlinkinfoShowSearchPanel.BarbuttonitemlinkcontrolShowSearchPanel.ContentcontrolexShowSearchPanel.Click(25, 8)
     
      set objEdgeFilter= Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1)
      strTemp="WPFObject(""ContentControlEx"", ""Show Search Panel"", 2)"
      Set objTemp=objEdgeFilter.FindChild("Name",strTemp,50)
      If objTemp.Exists = TRUE then
       ' Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 14).WPFObject("BarButtonItemLinkControl", "", 1).WPFObject("ItemBorderControl", "", 1).Click
        Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 11).WPFObject("BarButtonItemLinkControl", "", 1).WPFObject("ContentControlEx", "Show Search Panel", 2).Click
        Delay(10000)
      Else
        strTestCaseResult = "ABORT"
        Exit Sub  
      End If
      
      Set  tableView = objGridControl.WPFObject("LayoutFileTableView")
      Call tableView.Click(99, 17)
      Call tableView.Keys("Footnote")
      Delay(5000)
      set objRemoveButton=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("Adorner").WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 2).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("RemoveLinkButton")
      Delay(5000)
      If objRemoveButton.Enabled=True then
        Call objGridControl.ClickCell(0, "Group")
        Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("Adorner").WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 2).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("RemoveLinkButton").Click
        'Delay(10000)
          ''Clicking on OK Button
         'Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: WindowContentHolder", "").WPFObject("WindowContentHolder", "", 1).WPFObject("NonLogicalDecorator", "", 1).WPFObject("ThemedManagedContentPresenter", "", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent")
         strTemp="WPFObject(""PART_ContainerContent"")"
        Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "File Repository Usage").WPFObject("CustomMessageBoxWindow", "File Repository Usage", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,50000)
         If objTemp.Exists = True then
            Sys.Keys("[Enter]")
         End If
        'Delay(5000)
        ''Clicking on Ok Button to Remove Footnote
        'Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: WindowContentHolder", "").WPFObject("WindowContentHolder", "", 1).WPFObject("NonLogicalDecorator", "", 1).WPFObject("ThemedManagedContentPresenter", "", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("DXMessageBox", "", 1)
        'Delay 5000, "Removing FootNote..Pls wait.."
        strTemp="WPFObject(""PART_ContainerContent"")"
        Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "File Repository Usage").WPFObject("CustomMessageBoxWindow", "File Repository Usage", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,50000)
        If objTemp.Exists Then
          Sys.Keys("[Enter]")
        End If
      End If 
  
      Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("Adorner").WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 2).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("AddLinkButton").Click
      DElay(10000)
  
      Set edgeClient = Aliases.EdgeClient
      'Set objGrid = edgeClient.HwndSource_AddFileLinkView.AddFileLinkView.Grid.FloatingContainerBorder.FloatingContainerBackground.Grid.FloatingContainerBody.Grid.Grid.PART_ContainerContent.BarManager.AdornerDecorator.AdornedControl.Grid
      Set objGrid = Sys.Process("EdgeClient").WPFObject("HwndSource: AddFileLinkView", "Add New Link").WPFObject("AddFileLinkView", "Add New Link", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1)
      Set objGridControl = objGrid.WPFObject("SelectionGrid")
      Call objGridControl.ClickColumnHeaderRXY("Group", 64, 9)
      set objEdgeFilter= Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1)
      strTemp="WPFObject(""ContentControlEx"", ""Show Search Panel"", 2)"
      Set objTemp=objEdgeFilter.FindChild("Name",strTemp,50)
      If objTemp.Exists = TRUE then
        Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 13).WPFObject("BarButtonItemLinkControl", "", 1).WPFObject("ContentControlEx", "Show Search Panel", 2).Click
        Delay(10000)
      Else
        strTestCaseResult = "ABORT"
        Exit Sub  
      End If
      'Call edgeClient.HwndSource_PopupRoot.PopupRoot.Decorator.NonLogicalAdornerDecorator.BarPopupBorderControl.PopupMenuBarControl.BaritemlinkinfoShowSearchPanel.BarbuttonitemlinkcontrolShowSearchPanel.ContentcontrolexShowSearchPanel.Click(29, 6)
      Set tableView = objGridControl.WPFObject("SelectionGridTableView")
      Call tableView.Click(150, 21)
      Call tableView.Keys(StrCountryname)
      Delay(30000)
      'Set hierarchyPanel = tableView.HierarchyPanel
      Set hierarchyPanel = tableView.WPFObject("HierarchyPanel", "", 1)

      Sys.Process("EdgeClient").WPFObject("HwndSource: AddFileLinkView", "Add New Link").WPFObject("AddFileLinkView", "Add New Link", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("SelectionGrid").WPFObject("SelectionGridTableView").WPFObject("HierarchyPanel", "", 1).WPFObject("GroupGridRow", "", 1).WPFObject("MeasurePixelSnapper", "", 1).WPFObject("PART_GroupRowContent").WPFObject("DXDockPanel", "", 1).WPFObject("Toggle").Click
      'Sys.Process("EdgeClient").WPFObject("HwndSource: AddFileLinkView", "Add New Link").WPFObject("AddFileLinkView", "Add New Link", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("SelectionGrid").WPFObject("SelectionGridTableView").WPFObject("HierarchyPanel", "", 1).WPFObject("GridRow", "", 9).WPFObject("ScrollablePart").WPFObject("CellItemsControl", "", 1).WPFObject("GridCellContentPresenter", "", 1).WPFObject("ContentControl", "FOOTNOTE", 1).Click
      Sys.Process("EdgeClient").WPFObject("HwndSource: AddFileLinkView", "Add New Link").WPFObject("AddFileLinkView", "Add New Link", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("SelectionGrid").WPFObject("SelectionGridTableView").WPFObject("HierarchyPanel", "", 1).WPFObject("RowControl", "", 9).WPFObject("CellsControl", "", 1).WPFObject("LightweightCellEditor", "", 1).WPFObject("ContentControl", "FOOTNOTE", 1).Click
      'objGrid.StackPanel.OkButton.ClickButton
      Sys.Process("EdgeClient").WPFObject("HwndSource: AddFileLinkView", "Add New Link").WPFObject("AddFileLinkView", "Add New Link", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("OkButton").Click
      Delay(10000)
      Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("Adorner").WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 2).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("AddLinkButton").Click
      Delay(10000)
    
      strTCRemarks = "ADDED FootNote Link in File Repository Usage Form"
      
      
      Set edgeClient = Aliases.EdgeClient
     ' Set objGrid = edgeClient.HwndSource_AddFileLinkView.AddFileLinkView.Grid.FloatingContainerBorder.FloatingContainerBackground.Grid.FloatingContainerBody.Grid.Grid.PART_ContainerContent.BarManager.AdornerDecorator.AdornedControl.Grid
      Set objGrid = Sys.Process("EdgeClient").WPFObject("HwndSource: AddFileLinkView", "Add New Link").WPFObject("AddFileLinkView", "Add New Link", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1)
      'Set objGridControl = objGrid.SelectionGrid
      Set objGridControl = objGrid.WPFObject("SelectionGrid")
      Call objGridControl.ClickColumnHeaderRXY("Group", 64, 9)
      set objEdgeFilter= Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1)
      strTemp="WPFObject(""ContentControlEx"", ""Show Search Panel"", 2)"
      Set objTemp=objEdgeFilter.FindChild("Name",strTemp,50)
      If objTemp.Exists = TRUE then
        Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 13).WPFObject("BarButtonItemLinkControl", "", 1).WPFObject("ContentControlEx", "Show Search Panel", 2).Click
        Delay(10000)
      Else
        strTestCaseResult = "ABORT"
        Exit Sub  
      End If
      
      'Call edgeClient.HwndSource_PopupRoot.PopupRoot.Decorator.NonLogicalAdornerDecorator.BarPopupBorderControl.PopupMenuBarControl.BaritemlinkinfoShowSearchPanel.BarbuttonitemlinkcontrolShowSearchPanel.ContentcontrolexShowSearchPanel.Click(29, 6)
      'Set tableView = objGridControl.SelectionGridTableView
      Set tableView = objGridControl.WPFObject("SelectionGridTableView")
      Call tableView.Click(150, 21)
      Call tableView.Keys(StrCountryname)
      Delay(30000)
      Set hierarchyPanel = tableView.WPFObject("HierarchyPanel", "", 1)
      Sys.Process("EdgeClient").WPFObject("HwndSource: AddFileLinkView", "Add New Link").WPFObject("AddFileLinkView", "Add New Link", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("SelectionGrid").WPFObject("SelectionGridTableView").WPFObject("HierarchyPanel", "", 1).WPFObject("GroupGridRow", "", 1).WPFObject("MeasurePixelSnapper", "", 1).WPFObject("PART_GroupRowContent").WPFObject("DXDockPanel", "", 1).WPFObject("Toggle").Click
      Sys.Process("EdgeClient").WPFObject("HwndSource: AddFileLinkView", "Add New Link").WPFObject("AddFileLinkView", "Add New Link", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("SelectionGrid").WPFObject("SelectionGridTableView").WPFObject("HierarchyPanel", "", 1).WPFObject("RowControl", "", 1).WPFObject("CellsControl", "", 1).WPFObject("LightweightCellEditor", "", 1).WPFObject("ContentControl", "DATA TALK", 1).Click
      Delay(10000)
      'objGrid.StackPanel.OkButton.ClickButton
      Sys.Process("EdgeClient").WPFObject("HwndSource: AddFileLinkView", "Add New Link").WPFObject("AddFileLinkView", "Add New Link", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("OkButton").Click
      Delay(10000)
      strTCRemarks = strTCRemarks & "<br />" & "ADDED DATA TALK Link in File Repository Usage Form"
      Delay(10000)

      Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("Adorner").WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 2).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("AddLinkButton").Click
      Set edgeClient = Aliases.EdgeClient
     ' Set objGrid = edgeClient.HwndSource_AddFileLinkView.AddFileLinkView.Grid.FloatingContainerBorder.FloatingContainerBackground.Grid.FloatingContainerBody.Grid.Grid.PART_ContainerContent.BarManager.AdornerDecorator.AdornedControl.Grid
      Set objGrid = Sys.Process("EdgeClient").WPFObject("HwndSource: AddFileLinkView", "Add New Link").WPFObject("AddFileLinkView", "Add New Link", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1)
      'Set objGridControl = objGrid.SelectionGrid
      Set objGridControl = objGrid.WPFObject("SelectionGrid")
      Call objGridControl.ClickColumnHeaderRXY("Group", 64, 9)
      set objEdgeFilter= Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1)
      strTemp="WPFObject(""ContentControlEx"", ""Show Search Panel"", 2)"
      Set objTemp=objEdgeFilter.FindChild("Name",strTemp,50)
      If objTemp.Exists = TRUE then
        Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 13).WPFObject("BarButtonItemLinkControl", "", 1).WPFObject("ContentControlEx", "Show Search Panel", 2).Click
        Delay(10000)
      Else
        strTestCaseResult = "ABORT"
        Exit Sub  
      End If
      
      Set tableView = objGridControl.WPFObject("SelectionGridTableView")
      Call tableView.Click(150, 21)
      Call tableView.Keys(StrCountryname)
      Delay(30000)
      
      Call objGridControl.DblClickColumnHeaderXY("Group", 59, 17)
       
       Delay(30000)
      Set hierarchyPanel = tableView.WPFObject("HierarchyPanel", "", 1)
      Sys.Process("EdgeClient").WPFObject("HwndSource: AddFileLinkView", "Add New Link").WPFObject("AddFileLinkView", "Add New Link", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("SelectionGrid").WPFObject("SelectionGridTableView").WPFObject("HierarchyPanel", "", 1).WPFObject("GroupGridRow", "", 1).WPFObject("MeasurePixelSnapper", "", 1).WPFObject("PART_GroupRowContent").WPFObject("DXDockPanel", "", 1).WPFObject("Toggle").Click
      Sys.Process("EdgeClient").WPFObject("HwndSource: AddFileLinkView", "Add New Link").WPFObject("AddFileLinkView", "Add New Link", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("SelectionGrid").WPFObject("SelectionGridTableView").WPFObject("HierarchyPanel", "", 1).WPFObject("RowControl", "", 6).WPFObject("CellsControl", "", 1).WPFObject("LightweightCellEditor", "", 1).WPFObject("ContentControl", "EMIS", 1).Click
      Delay(10000)
      
      'objGrid.StackPanel.OkButton.ClickButton
      Sys.Process("EdgeClient").WPFObject("HwndSource: AddFileLinkView", "Add New Link").WPFObject("AddFileLinkView", "Add New Link", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("OkButton").Click
      Delay(10000)
      strTCRemarks = strTCRemarks & "<br />" & "ADDED EMIS in File Repository Usage Form"
      Delay(10000)
      
      set objEdge= Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1)
      strTemp="WPFObject(""LayoutPanel"", """", 2)"
      Set objTemp=objEdge.FindChild("Name",strTemp,5)
      If objTemp.Exists = TRUE then
        set objStrClose= Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2)
        objStrClose.Closed=True
      End If 
      
     
      set objEdge= Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1)
      strTemp="WPFObject(""LayoutPanel"", """", 1)"
      Set objTemp=objEdge.FindChild("Name",strTemp,5)
      If objTemp.Exists = TRUE then
        set objStrClose= Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1)
        objStrClose.Closed=True
      End If


End Sub

Sub scheckLayoutWorkSpaceVwr()

    Dim strObject,objEdgeMDI,strTemp,objTemp,GridControl,intRowcnt,intI,intRow
    Dim i,objText
    
On Error Resume Next
 
  set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1)
  strTemp="WPFObject(""LayoutPanel"", """", 1)"
  Set objTemp=objEdge.FindChild("Name",strTemp,5)
  If objTemp.Exists = False then
     Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("RibbonControl").WPFObject("RibbonSelectedPageControl", "", 1).WPFObject("RibbonPagesControl", "", 1).WPFObject("RibbonPageGroupsControl", "", 1).WPFObject("RibbonPageGroupControl", "", 1).WPFObject("BarItemLinkInfo", "", 9).WPFObject("BarButtonItemLinkControl", "", 1).Click
       'Delay(30000)
      Call sEdgeProcessor
      strTemp="WPFObject(""LayoutPanel"", """", 1)"
      Set objTemp=objEdge.WaitChild(strTemp,50000)
      If objTemp.Exists = False then
        strTestCaseResult= "FAIL"
        Exit Sub
      End If
      strTCRemarks="Layout Form Loaded"
  ElseIF objTemp.Exists = True then
      If objTemp.Caption<>"Layout Workspace Viewer" then
        call sCloseLayout()
        Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("RibbonControl").WPFObject("RibbonSelectedPageControl", "", 1).WPFObject("RibbonPagesControl", "", 1).WPFObject("RibbonPageGroupsControl", "", 1).WPFObject("RibbonPageGroupControl", "", 1).WPFObject("BarItemLinkInfo", "", 9).WPFObject("BarButtonItemLinkControl", "", 1).Click
        'Delay(30000)
        Call sEdgeProcessor
        strTemp="WPFObject(""LayoutPanel"", """", 1)"
        Set objTemp=objEdge.WaitChild(strTemp,50000)
        If objTemp.Exists = False then
          strTestCaseResult = "FAIL"
          Exit Sub
        End If
        strTCRemarks="Layout Form Loaded successfully"
      End if 
  End If
   
End Sub


Sub sCheckLayoutWorkspaceVwrFields()
On Error Resume Next

  Dim objEdge,strTemp,objTemp,objEdgeTree,strLayoutHeader,GridControl,GridSourceTree,intTotNodeCnt,intI
              
  set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1)             
  strTemp="WPFObject(""PendingChangeTableView"")"
  Set objTemp=objEdge.FindChild("Name",strTemp,50)
  If objTemp.Exists=True then
    strTCRemarks = "Layout workspace view found Grid found in Layout"
    log.Message "Layout grid found in Layout"
    set objEdgeTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("PendingChangeGridControl")
    
    strTemp="WPFObject(""GridColumnHeader"", """", 1)"
    Set objTemp=objEdgeTree.FindChild("Name",strTemp,50)
    if objTemp.Exists=True then
      if UCASE(objTemp.DataContext.Header)="WORKSPACE NAME" then
        strTCRemarks = strTCRemarks & "<br />" & "Workspace Name is found in Layout"
        log.Message "Workspace Name is found in Layout"
      Else
        strTCRemarks = strTCRemarks & "<br />" & "Workspace Name is not found in Layout"
        log.Message "Workspace Name is not found in Layout"
      End if
    Else 
      strTCRemarks = strTCRemarks & "<br />" & "Fields is not found in Layout"
    End if
    
    strTemp="WPFObject(""GridColumnHeader"", """", 2)"
    Set objTemp=objEdgeTree.FindChild("Name",strTemp,50)
    if objTemp.Exists=True then
      if UCASE(objTemp.DataContext.Header)="CREATED BY" then
        strTCRemarks = strTCRemarks & "<br />" & " Created by is found in Layout"
        log.Message " Created by Name is found in Layout"
      Else
        strTCRemarks = strTCRemarks & "<br />" & "Created by Name is not found in Layout"
        log.Message " Created by Name is not found in Layout"
      End if
    Else 
      strTCRemarks = strTCRemarks & "<br />" & "Fields is not found in Layout"
    End if
     
    strTemp="WPFObject(""GridColumnHeader"", """", 3)"
    Set objTemp=objEdgeTree.FindChild("Name",strTemp,50)
    if objTemp.Exists=True then
      if UCASE(objTemp.DataContext.Header)="OWNER" then
        strTCRemarks = strTCRemarks & "<br />" & "Owner is found in Layout"
        log.Message "Owner Name is found in Layout"
      Else
        strTCRemarks = strTCRemarks & "<br />" & "Owner Name is not found in Layout"
        log.Message "Owner Name is not found in Layout"
      End if
    Else 
      strTCRemarks = strTCRemarks & "<br />" & "Fields is not found in Layout"
    End if
    
    strTemp="WPFObject(""GridColumnHeader"", """", 4)"
    Set objTemp=objEdgeTree.FindChild("Name",strTemp,50)
    if objTemp.Exists=True then
      if UCASE(objTemp.DataContext.Header)="CREATED AT" then
        strTCRemarks = strTCRemarks & "<br />" & "Created At is found in Layout"
        log.Message "Created At Name is found in Layout"
      Else
        strTCRemarks = strTCRemarks & "<br />" & "Created At Name is not found in Layout"
        log.Message "Created At Name is not found in Layout"
      End if
    Else 
      strTCRemarks = strTCRemarks & "<br />" & "Fields is not found in Layout"
    End if
    
    strTemp="WPFObject(""GridColumnHeader"", """", 5)"
    Set objTemp=objEdgeTree.FindChild("Name",strTemp,50)
    if objTemp.Exists=True then
      if UCASE(objTemp.DataContext.Header)="UPDATED AT" then
        strTCRemarks = strTCRemarks & "<br />" & "Updated At is found in Layout"
        log.Message "Updated At is found in Layout"
      Else
        strTCRemarks = strTCRemarks & "<br />" & "Updated At is not found in Layout"
        log.Message "Updated At is not found in Layout"
      End if
    Else 
      strTCRemarks = strTCRemarks & "<br />" & "Fields is not found in Layout"
    End if
    
  End if 
  End Sub 
  
Sub sCheckLayoutWorkSpaceVwrFieldValue()
On Error Resume Next
    Dim strObject,objEdgeMDI,strTemp,objTemp,GridControl,intRowcnt,intI,intRow
    strObject = "WPFObject(""HwndSource: RibbonWindow"")"
    Set objEdgeMDI = Sys.Process("EdgeClient").WaitChild(strObject, 600000)
    If objEdgeMDI.Exists then
      strTemp="WPFObject(""TextBlock"", ""Layout"", 1)"
      Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,14,True)
      If objTemp.Exists = False then
        strTemp="WPFObject(""ContentControl"", ""Layout Workspace"", 1)"
        Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).FindChild("Name",strTemp,16,True)
        If objTemp.Exists = True then
          objTemp.Click
        End If
        Call sEdgeProcessor
        log.Message "Opening Layout Workspace.."
        strTCRemarks = strTCRemarks & "<br />" & "Opening Layout Workspace.."
      Else
        log.Message "Layout Workspace is opened"
        strTCRemarks = strTCRemarks & "<br />" & "Layout Workspace is opened"
      End If

      strTemp="WPFObject(""PendingChangeGridControl"")"
      Set GridControl=Sys.Process("EdgeClient").FindChild("Name",strTemp,60,True)
      
      intRowcnt=GridControl.wRowCount
      For intI=0 to intRowcnt-1
        intRow=GridControl.FindRow(1,"Workspace Name")
'        GridControl.ClickRowIndicator(intI)
         Call GridControl.ClickCell(intI,1)
        
        if Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("PendingChangeGridControl").WPFObject("PendingChangeTableView").WPFObject("HierarchyPanel", "", 1).WPFObject("RowControl", "", 1).WPFObject("CellsControl", "", 1).WPFObject("LightweightCellEditor", "", 1).WPFObject("InplaceBaseEdit", "", 1).DisplayText<>"" then 
           log.Message "Workspace Id is entered"
           strTCRemarks = strTCRemarks & "<br />" & "Workspace Id is entered"
        Else
           log.Message "Workspace Id is not entered"
           strTCRemarks = strTCRemarks & "<br />" & "Workspace Id is not entered"
        End if 
        if Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("PendingChangeGridControl").WPFObject("PendingChangeTableView").WPFObject("HierarchyPanel", "", 1).WPFObject("RowControl", "", 1).WPFObject("CellsControl", "", 1).WPFObject("LightweightCellEditor", "", 2).WPFObject("InplaceBaseEdit", "", 1).DisplayText<>"" then
          log.Message "Created by is entered"
          strTCRemarks = strTCRemarks & "<br />" & "Created by is entered"
        Else
          log.Message "Created by is not  entered"
          strTCRemarks = strTCRemarks & "<br />" & "Created by is  not entered"
        End if
        if Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("PendingChangeGridControl").WPFObject("PendingChangeTableView").WPFObject("HierarchyPanel", "", 1).WPFObject("RowControl", "", 1).WPFObject("CellsControl", "", 1).WPFObject("LightweightCellEditor", "", 3).WPFObject("PART_Editor").DataContext.Value<>"" then 
          log.Message "Owner is entered"
          strTCRemarks = strTCRemarks & "<br />" & "Owner is entered"
        Else
          log.Message "Owner is not entered"
          strTCRemarks = strTCRemarks & "<br />" & "Owner is not entered"
        end if
        if Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("PendingChangeGridControl").WPFObject("PendingChangeTableView").WPFObject("HierarchyPanel", "", 1).WPFObject("RowControl", "", 1).WPFObject("CellsControl", "", 1).WPFObject("LightweightCellEditor", "", 4).WPFObject("InplaceBaseEdit", "", 1).DisplayText<>"" then
          log.Message "Created at is entered"
          strTCRemarks = strTCRemarks & "<br />" & "Created at is entered"
        Else
          log.Message "Created at is not entered"
          strTCRemarks = strTCRemarks & "<br />" & "Created at is not entered"
        End if
        if Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("PendingChangeGridControl").WPFObject("PendingChangeTableView").WPFObject("HierarchyPanel", "", 1).WPFObject("RowControl", "", 1).WPFObject("CellsControl", "", 1).WPFObject("LightweightCellEditor", "", 5).WPFObject("InplaceBaseEdit", "", 1).DisplayText<>"" then
          log.Message "Updated at is entered"
          strTCRemarks = strTCRemarks & "<br />" & "Updated at is entered"
        Else
          log.Message "Updated at is not entered"
          strTCRemarks = strTCRemarks & "<br />" & "Updated at is not entered"
        End if
        strTemp="WPFObject(""ContentControlEx"", ""Drop"", 2)"
        Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,20,True)
        If objTemp.Exists = True then
          objTemp.Click
        End If
        strTemp="WPFObject(""PART_ContainerContent"")"
        'Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: WindowContentHolder", "Please Confirm.").FindChild("Name",strTemp,50,True)
        Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "Please Confirm.").WPFObject("CustomMessageBoxWindow", "Please Confirm.", 1).FindChild("Name",strTemp,50,True)
        If objTemp.Exists = True then
          Sys.Keys "Y"
          Call sEdgeProcessor
        End If
        Call sCloseLayout
      Next
    Else
      log.Message "RibbonWindow not found"
    End If

End Sub

Sub sCheckLayoutWorkspaceVwrButtons()
On Error Resume Next

  Dim objEdge,strTemp,objTemp,objEdgeTree,strLayoutHeader,GridControl,GridSourceTree,intTotNodeCnt,intI
              
  'set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1)            
  set objEdge = Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1)
  strTemp="WPFObject(""LayoutPanel"", """", 1)"
  Set objTemp=objEdge.FindChild("Name",strTemp,50)
  If objTemp.Exists=True then
    strTCRemarks = "Layout workspace view found Grid found in Layout"
    log.Message "Layout grid found in Layout"
   
    
    strTemp="WPFObject(""ContentControlEx"", ""Open Workspace"", 2)"
    Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,20,True)
    If objTemp.Exists = True then
      if objTemp.Enabled=True then
        strTCRemarks = "Open Workspace button  Enabled in Layout"
        log.Message "Open Workspace button Enabled in Layout"
      Else
        strTCRemarks = "Open Workspace button Disabled in Layout"
        log.Message "Open Workspace button Disabled in Layout"
      End if 
    End If  
    
    strTemp="WPFObject(""ContentControlEx"", ""Upload Workspace"", 2)"
    Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,20,True)
    If objTemp.Exists = True then
      if objTemp.Enabled=True then
        strTCRemarks = "Upload Workspace button  Enabled in Layout"
        log.Message "Upload Workspace button Enabled in Layout"
      Else
        strTCRemarks = "Upload Workspace button Disabled in Layout"
        log.Message "Upload Workspace button Disabled in Layout"
      End if 
    End If  
    
     
    strTemp="WPFObject(""ContentControlEx"", ""Drop"", 2)"
    Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,20,True)
    If objTemp.Exists = True then
      if objTemp.Enabled=True then
        strTCRemarks = "Drop button  Enabled in Layout"
        log.Message "Drop button Enabled in Layout"
      Else
        strTCRemarks = "Drop button Disabled in Layout"
        log.Message "Drop button Disabled in Layout"
      End if 
    End If  
    
     
    strTemp="WPFObject(""ContentControlEx"", ""Show Search Filter"", 2)"
    Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,20,True)
    If objTemp.Exists = True then
      if objTemp.Enabled=True then
        strTCRemarks = "Show Search Filter button  Enabled in Layout"
        log.Message "Show Search Filter button Enabled in Layout"
      Else
        strTCRemarks = "Show Search Filter button Disabled in Layout"
        log.Message "Show Search Filter button Disabled in Layout"
      End if 
    End If  
    
     strTemp="WPFObject(""ContentControlEx"", ""Refresh"", 2)"
    Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,20,True)
    If objTemp.Exists = True then
      if objTemp.Enabled=True then
        strTCRemarks = "Refresh button  Enabled in Layout"
        log.Message "Refresh button Enabled in Layout"
      Else
        strTCRemarks = "Refresh button Disabled in Layout"
        log.Message "Refresh button Disabled in Layout"
      End if 
    End If  
  End if 
  End Sub 
  
  Sub sCheckLayoutWorkspace(strParameters)
    Dim strTestcase
    strTestcase=getSplitValue(strParameters,"TESTCASE") 
    If strTestcase=1 then
      Call scheckLayoutWorkSpaceVwr
      Call sCloseLayout
    Elseif strTestcase=2 then
      Call sCheckLayoutWorkspaceVwrFields
      Call sCloseLayout
    Elseif strTestcase=3 then
      
    Elseif strTestcase=4 then
      Call sLoadLayout
      Call sCheckLayoutWorkspaceVwrLayout(strParameters)
      Call sCheckLayoutWorkSpaceVwrFieldValue
'      Call sCheckLayoutWorkSpaceVwrDropWorkspace
    Elseif strTestcase=5 then
      Call sLoadLayout
      Call sCheckLayoutWorkspaceVwrLayout(strParameters)
      Call sCheckLayoutWorkSpaceVwrFieldValue
'      Call sCheckLayoutWorkSpaceVwrDropWorkspace
    Elseif strTestcase=6 then
      Call sLoadLayout
      Call sCheckLayoutWorkspaceVwrLayout(strParameters)
      Call sCheckLayoutWorkSpaceVwrFieldValue
'      Call sCheckLayoutWorkSpaceVwrDropWorkspace
    Elseif strTestcase=7 then
      Call scheckLayoutWorkSpaceVwr
      Call sCheckLayoutWorkspaceVwrButtons
    Elseif strTestcase=8 then
      Call scheckLayoutWorkSpaceVwr
      Call sCheckLayoutWorkspaceVwrButtons
    Elseif strTestcase=9 then
      Call scheckLayoutWorkSpaceVwr
      Call sCheckLayoutWorkspaceVwrRefreshButtons
    Elseif strTestcase=10 then
      Call scheckLayoutWorkSpaceVwr
      Call sCheckLayoutWorkspaceVwrShowFilterButtons
    Elseif strTestcase=11 then
      Call scheckLayoutWorkSpaceVwr
      Call sCheckLayoutWorkspaceVwrShowFilterFields
    Elseif strTestcase=12 then
      Call scheckLayoutWorkSpaceVwr
      Call sCheckLayoutWorkspaceVwrShowFilterFields
    Elseif strTestcase=13 then
      Call scheckLayoutWorkSpaceVwr
      Call sCheckLayoutWorkspaceVwrCheckComboBox
    Elseif strTestcase=14 then
      Call scheckLayoutWorkSpaceVwr
      Call sCheckLayoutWorkspaceVwrCheckComboBox
    Elseif strTestcase=15 then
      Call sLoadLayout
      Call sCheckLayoutWorkspaceVwrSelectedLayout(strParameters)
      Call scheckLayoutWorkSpaceVwr
      Call sCheckLayoutWorkspaceVwrWorkspaceValidation
      Call sCheckLayoutWorkSpaceVwrDropWorkspace
    Elseif strTestcase=16 then
      Call sLoadLayout
     Call sCheckLayoutWorkspaceVwrLayout(strParameters)
     Call scheckLayoutWorkSpaceVwr
     Call sCheckLayoutWorkspaceVwrCurrentCheckComboBox
     Call sCheckLayoutWorkSpaceVwrDropWorkspace
    Elseif strTestcase=17 then
      Call sLoadLayout
      Call sCheckLayoutWorkspaceVwrLayout(strParameters)
      Call scheckLayoutWorkSpaceVwr
      Call sCheckLayoutWorkspaceVwrWorkspaceValidation
      Call sCheckLayoutWorkSpaceVwrDropWorkspace
    Elseif strTestcase=18 then
      Call scheckLayoutWorkSpaceVwr
     Call sCheckLayoutWorkspaceVwrResetValidation
    Elseif strTestcase=19 then
      Call scheckLayoutWorkSpaceVwr
      Call sCheckLayoutWorkspaceVwrResetValidation
    Elseif strTestcase=20 then
     Call sCheckLayoutWorkspaceVwrRCCheckOtherOwner
    Elseif strTestcase=21 then
     Call sCheckLayoutWorkspaceVwrRCCheckOtherOwner
    Elseif strTestcase=22 then
     Call sLoadLayout
     Call sCheckLayoutWorkspaceVwrLayout(strParameters)
     Call scheckLayoutWorkSpaceVwr
     Call sCheckLayoutWorkSpaceVwrWorkspaceButton
     Call sCheckLayoutWorkSpaceVwrDropWorkspace
    Elseif strTestcase=23 then
      Call sLoadLayout
      Call sCheckLayoutWorkspaceVwrLayout(strParameters)
      Call sCheckLayoutWorkSpaceVwrRCWorkspace
      Call sCheckLayoutWorkSpaceVwrDropWorkspace
    Elseif strTestcase=24 then
      Call sLoadLayout
      Call sCheckLayoutWorkspaceVwrLayout(strParameters)
      Call sCheckLayoutWorkSpaceVwrDropWorkspace
    Elseif strTestcase=25 then
      Call sLoadLayout
      Call sCheckLayoutWorkspaceVwrLayout(strParameters)
      Call sCheckLayoutWorkSpaceVwrDropWorkspace
    Elseif strTestcase=26 then
      Call sLoadLayout
      Call sCheckLayoutWorkspaceVwrLayout(strParameters)
      Call sCheckLayoutWorkSpaceVwrRCDropWorkspace
    Elseif strTestcase=27 then
      Call sLoadLayout
      Call sCheckLayoutWorkspaceVwrLayout(strParameters)
      Call scheckLayoutWorkSpaceVwr
      Call sCheckLayoutWorkSpaceVwrOpenWorkspace
      Call sCheckLayoutWorkSpaceVwrDropWorkspace
    Elseif strTestcase=28 then
      Call sLoadLayout
      Call sCheckLayoutWorkspaceVwrLayout(strParameters)
      Call scheckLayoutWorkSpaceVwr
      Call sCheckLayoutWorkSpaceVwrRCOpenWorkspace
      Call sCheckLayoutWorkSpaceVwrDropWorkspace
    Elseif strTestcase=29 then
      Call sLoadLayout
      Call sCheckLayoutWorkspaceVwrLayout(strParameters)
      Call sCheckLayoutWorkSpaceVwrDoubleClickWorkspace
      Call sCheckLayoutWorkSpaceVwrDropWorkspace
    Elseif strTestcase=30 then
      Call sLoadLayout
      Call sCheckLayoutWorkspaceVwrLayout(strParameters)
      Call sCheckLayoutWorkSpaceVwrDropOpenWorkspace
      Call sCheckLayoutWorkSpaceVwrDropWorkspace
    Elseif strTestcase=31 then
      Call sLoadLayout
      Call sCheckLayoutWorkspaceVwrSaveLayout(strParameters)
      Call sCheckLayoutWorkSpaceVwrUpdateWorkspace
    Elseif strTestcase=32 then
      Call sLoadLayout
      Call sCheckLayoutWorkspaceVwrSaveLayout(strParameters)
      Call sCheckLayoutWorkSpaceVwrUpdateWorkspace
    Elseif strTestcase=33 then
      Call sLoadLayout
      Call sCheckLayoutWorkspaceVwrSaveLayout(strParameters)
      Call sCheckLayoutWorkSpaceVwrRCUpdateWorkspace
    Elseif strTestcase=34 then
      Call sLoadLayout
     Call  sCheckLayoutWorkspaceVwrLayout(strParameters)
     Call  sCheckLayoutWorkSpacevwrUpdateWrk
     Call  sCheckLayoutWorkSpaceVwrDropWorkspace
    Elseif strTestcase=35 then
      Call sLoadLayout
      Call sCheckLayoutWorkspaceVwrLayout(strParameters)
      Call sCheckLayoutWorkSpaceVwrWSOpenWorkspace
      Call  sCheckLayoutWorkSpaceVwrDropWorkspace
    Elseif strTestcase=36 then
      Call sLoadLayout
      Call sCheckLayoutWorkspaceVwrSaveLayout(strParameters)
      Call sCheckLayoutWorkSpaceVwrWSUpdateWorkspace
    Elseif strTestcase=37 then
'      Call sLoadLayout
'     Call  sCheckLayoutWorkspaceVwrLayout(strParameters)
      Call sCheckLayoutWorkSpaceVwrDropMWorkspace
    Elseif strTestcase=38 then
'      Call sLoadLayout
'     Call  sCheckLayoutWorkspaceVwrLayout(strParameters)
      Call sCheckLayoutWorkSpaceVwrDropMWorkspace
    Elseif strTestcase=39 then
'      Call sLoadLayout
'     Call  sCheckLayoutWorkspaceVwrLayout(strParameters)
      Call sCheckLayoutWorkSpaceVwrDropMWorkspace
    Elseif strTestcase=40 then
      Call sLoadLayout
      Call sCheckLayoutWorkspaceVwrLayout(strParameters)
      Call sCheckLayoutWorkspaceVwrChangeOwner
      Call sCheckLayoutWorkSpaceVwrDropWorkspace
    Elseif strTestcase=41 then
      Call sLoadLayout
      Call sCheckLayoutWorkspaceVwrLayout(strParameters)
      Call sCheckLayoutWorkspaceVwrChangeOwner
      Call sCheckLayoutWorkSpaceVwrDropWorkspace
    Elseif strTestcase=42 then
      Call sLoadLayout
      Call sCheckLayoutWorkspaceVwrLayout(strParameters)
      Call sCheckLayoutWorkspaceVwrChangeOtherOwner
      Call sCheckLayoutWorkSpaceVwrDropWorkspace
    Elseif strTestcase=43 then
      sCheckLayoutWorkspaceVwrRefreshWorkspace
    Elseif strTestcase=44 then 
      Call sCheckLayoutWorkspaceVwrCheckOtherOwner
    Elseif strTestcase=45 then
      Call sCheckLayoutWorkSpaceVwrReSWorkspace
      Call sCheckLayoutWorkSpaceVwrDropWorkspace
    Elseif strTestcase=46 then
      Call sCheckLayoutWorkSpaceVwrOpenReSWorkspace
      Call sCheckLayoutWorkSpaceVwrDropWorkspace
    Elseif strTestcase=47 then
      Call sCheckLayoutWorkSpaceVwrOpenReSWorkspace
        Call sCheckLayoutWorkSpaceVwrDropWorkspace
    Elseif strTestcase=48 then
      Call sCheckLayoutWorkspaceVwrCheckOtherOwner
    Elseif strTestcase=49 then
      Call sCheckLayoutWorkspaceVwrRCCheckOtherOwner
    Elseif strTestcase=50 then
      Call sCheckLayoutWorkSpaceVwrOpenAndUpdateWorkspace(strParameters)
    End if
End sub

Sub sCheckLayoutWorkspaceVwrRefreshButtons()
On Error Resume Next

  Dim objEdge,strTemp,objTemp,objEdgeTree,strLayoutHeader,GridControl,GridSourceTree,intTotNodeCnt,intI
              
  set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1)            
  strTemp="WPFObject(""LayoutPanel"", """", 1)"
  Set objTemp=objEdge.FindChild("Name",strTemp,50)
  If objTemp.Exists=True then
    strTCRemarks = "Layout workspace view found Grid found in Layout"
    log.Message "Layout grid found in Layout"
   
    strTemp="WPFObject(""ContentControlEx"", ""Refresh"", 2)"
    Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,20,True)
    If objTemp.Exists = True then
      if objTemp.Enabled=True then
        log.Message "Refresh button Enabled in Layout"
       ' objTemp.Click
       Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 5).WPFObject("BarButtonItemLinkControl", "", 1).WPFObject("ContentControlEx", "Refresh", 2).Click
        strTCRemarks = "Refresh button is clicked in Layout"
      Else
        strTCRemarks = "Refresh button Disabled in Layout"
        log.Message "Refresh button Disabled in Layout"
      End if 
    End If  
  End if 
  End Sub 
  
Sub sCheckLayoutWorkspaceVwrShowFilterButtons()
On Error Resume Next

  Dim objEdge,strTemp,objTemp,objEdgeTree,strLayoutHeader,GridControl,GridSourceTree,intTotNodeCnt,intI
              
  set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1)            
  strTemp="WPFObject(""LayoutPanel"", """", 1)"
  Set objTemp=objEdge.FindChild("Name",strTemp,50)
  If objTemp.Exists=True then
    strTCRemarks = "Layout grid found in Layout workspace view"
    log.Message "Layout grid found in Layout"
   
    strTemp="WPFObject(""ContentControlEx"", ""Show Search Filter"", 2)"
    Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).FindChild("Name",strTemp,20,True)
    If objTemp.Exists = True then
      if objTemp.Enabled=True then
        log.Message "Show Search Filter button Enabled in Layout"
        Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 4).WPFObject("BarCheckItemLinkControl", "", 1).WPFObject("ContentControlEx", "Show Search Filter", 2).Click
        Delay(10000)
        strTCRemarks = "Clicked Show Search Filter button in Layout workspace Viewer"
        strTemp="WPFObject(""Border"", """", 1)"
        Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).FindChild("Name",strTemp,20,True)
        If objTemp.Exists = True then
            strTCRemarks = "Show Search Form is displayed in Layout workspace Viewer"
            Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 4).WPFObject("BarCheckItemLinkControl", "", 1).WPFObject("ContentControlEx", "Hide Search Filter", 2).Click
        End if
      Else
        strTCRemarks = "Show Search Filter button Disabled in Layout"
        log.Message "Show Search Filter button Disabled in Layout"
      End if 
    End If  
  End if 
  End Sub 
Sub sCheckLayoutWorkspaceVwrShowFilterFields()
On Error Resume Next

  Dim objEdge,strTemp,objTemp,objEdgeTree,strLayoutHeader,GridControl,GridSourceTree,intTotNodeCnt,intI
              
  set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1)            
  strTemp="WPFObject(""LayoutPanel"", """", 1)"
  Set objTemp=objEdge.FindChild("Name",strTemp,50)
  If objTemp.Exists=True then
    strTCRemarks = "Layout grid found in Layout workspace view"
    log.Message "Layout grid found in Layout"
   
    strTemp="WPFObject(""ContentControlEx"", ""Show Search Filter"", 2)"
    Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,20,True)
    If objTemp.Exists = True then
      if objTemp.Enabled=True then
        log.Message "Show Search Filter button Enabled in Layout"
        Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 4).WPFObject("BarCheckItemLinkControl", "", 1).WPFObject("ContentControlEx", "Show Search Filter", 2).Click
        Delay(5000)
        
        strTCRemarks = "Clicked Show Search Filter button in Layout workspace Viewer"
         strTemp="WPFObject(""Border"", """", 1)"
        Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).FindChild("Name",strTemp,20,True)
        If objTemp.Exists = True then
            strTCRemarks = "Show Search Form is displayed in Layout workspace Viewer"
            strTemp="WPFObject(""Label"", ""Workspace Name: "", 1)"
            Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Border", "", 1).WPFObject("SearchGrid").WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 1).FindChild("Name",strTemp,20,True)
            If objTemp.Exists = True then
              strTCRemarks = "Workspace Name Field is displayed in Layout workspace Viewer"
              log.Message "Workspace Name Field is displayed in Layout workspace Viewer"
            End if 
            
            strTemp="WPFObject(""Label"", ""Created By: "", 1)"
            Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Border", "", 1).WPFObject("SearchGrid").WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 2).FindChild("Name",strTemp,20,True)
            If objTemp.Exists = True then
              strTCRemarks = "Created By Field is displayed in Layout workspace Viewer"
              log.Message "Created By  Field is displayed in Layout workspace Viewer"
            End if 
            
            strTemp="WPFObject(""Label"", ""Owner: "", 1)"
            Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Border", "", 1).WPFObject("SearchGrid").WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 3).FindChild("Name",strTemp,20,True)
            If objTemp.Exists = True then
              strTCRemarks = "Owner Field is displayed in Layout workspace Viewer"
              log.Message "Owner Field is displayed in Layout workspace Viewer"
            End if 
            
            strTemp="WPFObject(""Label"", ""Created At: "", 1)"
            Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Border", "", 1).WPFObject("SearchGrid").WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 4).FindChild("Name",strTemp,20,True)
            If objTemp.Exists = True then
              strTCRemarks = "Created At Field is displayed in Layout workspace Viewer"
              log.Message "Created At is displayed in Layout workspace Viewer"
            End if 
            
            strTemp="WPFObject(""Label"", ""Updated At: "", 1)"
            Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Border", "", 1).WPFObject("SearchGrid").WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 5).FindChild("Name",strTemp,20,True)
            If objTemp.Exists = True then
              strTCRemarks = "Updated At Field is displayed in Layout workspace Viewer"
              log.Message "Updated At is displayed in Layout workspace Viewer"
            End if 
            
            strTemp="WPFObject(""Button"", ""Apply Filter"", 1)"
            Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Border", "", 1).WPFObject("SearchGrid").WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 6).FindChild("Name",strTemp,20,True)
            If objTemp.Exists = True then
              strTCRemarks = "Apply Filter button is displayed in Layout workspace Viewer"
              log.Message "Apply Filter button is displayed in Layout workspace Viewer"
            End if 
            
            strTemp="WPFObject(""Button"", ""Reset Default"", 2)"
            Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Border", "", 1).WPFObject("SearchGrid").WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 6).FindChild("Name",strTemp,20,True)
            If objTemp.Exists = True then
              strTCRemarks = "Reset Default button is displayed in Layout workspace Viewer"
              log.Message "Reset Default button is displayed in Layout workspace Viewer"
            End if 
            Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 4).WPFObject("BarCheckItemLinkControl", "", 1).WPFObject("ContentControlEx", "Hide Search Filter", 2).Click
        End if
      Else
        strTCRemarks = "Show Search Filter button Disabled in Layout"
        log.Message "Show Search Filter button Disabled in Layout"
      End if 
    End If  
  End if 
  End Sub 
Sub sCheckLayoutWorkspaceVwrCheckComboBox()
On Error Resume Next

  Dim objEdge,strTemp,objTemp,objEdgeTree,strLayoutHeader,GridControl,GridSourceTree,intTotNodeCnt,intI
              
  set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1)            
  strTemp="WPFObject(""LayoutPanel"", """", 1)"
  Set objTemp=objEdge.FindChild("Name",strTemp,50)
  If objTemp.Exists=True then
    strTCRemarks = "Layout grid found in Layout workspace view"
    log.Message "Layout grid found in Layout"
   
    strTemp="WPFObject(""ContentControlEx"", ""Show Search Filter"", 2)"
    Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,20,True)
    If objTemp.Exists = True then
      if objTemp.Enabled=True then
        log.Message "Show Search Filter button Enabled in Layout"
        Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 4).WPFObject("BarCheckItemLinkControl", "", 1).WPFObject("ContentControlEx", "Show Search Filter", 2).Click
        Delay(5000)
        
        strTCRemarks = "Clicked Show Search Filter button in Layout workspace Viewer"
         strTemp="WPFObject(""Border"", """", 1)"
        Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).FindChild("Name",strTemp,20,True)
        If objTemp.Exists = True then
'           
            Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Border", "", 1).WPFObject("SearchGrid").WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 2).WPFObject("ComboBox", "", 1).Click
            
            Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("ComboBoxItem", "", 1).WPFObject("StackPanel", "", 1).WPFObject("CheckBox", "", 1).Click
            delay(5000)
            strTCRemarks = "Unchecked all the option in CreatedBy Dropdown"
            Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("ComboBoxItem", "", 1).WPFObject("StackPanel", "", 1).WPFObject("CheckBox", "", 1).Click
            strTCRemarks = strTCRemarks & "<br />" & "Checked all the option in CreatedBy Dropdown"
            Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 4).WPFObject("BarCheckItemLinkControl", "", 1).WPFObject("ContentControlEx", "Hide Search Filter", 2).Click
        End if
      Else
        strTCRemarks = "Show Search Filter button Disabled in Layout"
        log.Message "Show Search Filter button Disabled in Layout"
      End if 
    End If  
  End if 
  End Sub  
  
  Sub sCheckLayoutWorkspaceVwrWorkspaceValidation()
On Error Resume Next

  Dim objEdge,strTemp,objTemp,objEdgeTree,strLayoutHeader,GridControl,GridSourceTree,intTotNodeCnt,intI,strClose
              
  set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1)            
  strTemp="WPFObject(""LayoutPanel"", """", 1)"
  Set objTemp=objEdge.FindChild("Name",strTemp,50)
  If objTemp.Exists=True then
    strTCRemarks = "Layout grid found in Layout workspace view"
    log.Message "Layout grid found in Layout"
   
    strTemp="WPFObject(""ContentControlEx"", ""Show Search Filter"", 2)"
    Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,20,True)
    If objTemp.Exists = True then
      if objTemp.Enabled=True then
        log.Message "Show Search Filter button Enabled in Layout"
        Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 4).WPFObject("BarCheckItemLinkControl", "", 1).WPFObject("ContentControlEx", "Show Search Filter", 2).Click
        Delay(5000)
        
        strTCRemarks = "Clicked Show Search Filter button in Layout workspace Viewer"
         strTemp="WPFObject(""Border"", """", 1)"
        Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).FindChild("Name",strTemp,20,True)
        If objTemp.Exists = True then
            
            Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Border", "", 1).WPFObject("SearchGrid").WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 1).WPFObject("TextBox", "", 1).Text="S4"
            Delay(5000)
            Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Border", "", 1).WPFObject("SearchGrid").WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 1).WPFObject("TextBox", "", 1).Click
           strTCRemarks = "Workspace is Entered"      
            strTemp="WPFObject(""Button"", ""Apply Filter"", 1)"
            Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Border", "", 1).WPFObject("SearchGrid").WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 6).FindChild("Name",strTemp,20,True)
            If objTemp.Exists = True then
             Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Border", "", 1).WPFObject("SearchGrid").WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 6).WPFObject("Button", "Apply Filter", 1).Click
              log.Message "Apply Filter button is Clicked in Layout workspace Viewer"
            End if 
            
           strTCRemarks = strTCRemarks & "<br />" & "Displayed only Selected Workspace" 
           
           strTemp="WPFObject(""Button"", ""Reset Default"", 2)"
            Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Border", "", 1).WPFObject("SearchGrid").WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 6).FindChild("Name",strTemp,20,True)
            If objTemp.Exists = True then
              Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Border", "", 1).WPFObject("SearchGrid").WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 6).WPFObject("Button", "Reset Default", 2).Click
              log.Message "Apply Filter button is Clicked in Layout workspace Viewer"
              
              
              
              strTemp="WPFObject(""PART_ContainerContent"")"
              Set strClose=Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "Please Confirm.").WPFObject("CustomMessageBoxWindow", "Please Confirm.", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,1800000)
              If strClose.Exists = True Then
                 strClose.Click
                 Sys.Keys "[Enter]"
              End If              
            End if   
            
            strTemp="WPFObject(""Button"", ""Apply Filter"", 1)"
            Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Border", "", 1).WPFObject("SearchGrid").WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 6).FindChild("Name",strTemp,20,True)
            If objTemp.Exists = True then
             Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Border", "", 1).WPFObject("SearchGrid").WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 6).WPFObject("Button", "Apply Filter", 1).Click
              log.Message "Apply Filter button is Clicked in Layout workspace Viewer"
            End if                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
           Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 4).WPFObject("BarCheckItemLinkControl", "", 1).WPFObject("ContentControlEx", "Hide Search Filter", 2).Click
        End if
      Else
        strTCRemarks = "Show Search Filter button Disabled in Layout"
        log.Message "Show Search Filter button Disabled in Layout"
      End if 
    End If  
  End if 
  End Sub  
  
Sub sCheckLayoutWorkspaceVwrResetValidation()
On Error Resume Next

  Dim objEdge,strTemp,objTemp,objEdgeTree,strLayoutHeader,GridControl,GridSourceTree,intTotNodeCnt,intI
              
  set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1)            
  strTemp="WPFObject(""LayoutPanel"", """", 1)"
  Set objTemp=objEdge.FindChild("Name",strTemp,50)
  If objTemp.Exists=True then
    strTCRemarks = "Layout grid found in Layout workspace view"
    log.Message "Layout grid found in Layout"
   
    strTemp="WPFObject(""ContentControlEx"", ""Show Search Filter"", 2)"
    Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,20,True)
    If objTemp.Exists = True then
      if objTemp.Enabled=True then
        log.Message "Show Search Filter button Enabled in Layout"
        Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 4).WPFObject("BarCheckItemLinkControl", "", 1).WPFObject("ContentControlEx", "Show Search Filter", 2).Click
        Delay(5000)
        
        strTCRemarks = "Clicked Show Search Filter button in Layout workspace Viewer"
         strTemp="WPFObject(""Border"", """", 1)"
        Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).FindChild("Name",strTemp,20,True)
        If objTemp.Exists = True then
            
            Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Border", "", 1).WPFObject("SearchGrid").WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 1).WPFObject("TextBox", "", 1).Text="S4"
            Delay(5000)
            Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Border", "", 1).WPFObject("SearchGrid").WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 1).WPFObject("TextBox", "", 1).Click
           strTCRemarks = "Workspace is Entered"      
            strTemp="WPFObject(""Button"", ""Apply Filter"", 1)"
            Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Border", "", 1).WPFObject("SearchGrid").WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 6).FindChild("Name",strTemp,20,True)
            If objTemp.Exists = True then
             Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Border", "", 1).WPFObject("SearchGrid").WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 6).WPFObject("Button", "Apply Filter", 1).Click
              log.Message "Apply Filter button is Clicked in Layout workspace Viewer"
            End if 
            
           strTCRemarks = strTCRemarks & "<br />" & "Displayed only Selected Workspace" 
           
           strTemp="WPFObject(""Button"", ""Reset Default"", 2)"
            Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Border", "", 1).WPFObject("SearchGrid").WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 6).FindChild("Name",strTemp,20,True)
            If objTemp.Exists = True then
              Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Border", "", 1).WPFObject("SearchGrid").WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 6).WPFObject("Button", "Reset Default", 2).Click
              log.Message "Apply Filter button is Clicked in Layout workspace Viewer"
              
              strTemp="WPFObject(""PART_ContainerContent"")"
        'Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: WindowContentHolder", "Please Confirm.").FindChild("Name",strTemp,50,True)
        Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "Please Confirm.").WPFObject("CustomMessageBoxWindow", "Please Confirm.", 1).FindChild("Name",strTemp,50,True)
              If strClose.Exists Then
                 SYS.Keys "[Enter]"
              End If              
            End if   
            
            strTemp="WPFObject(""Button"", ""Apply Filter"", 1)"
            Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Border", "", 1).WPFObject("SearchGrid").WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 6).FindChild("Name",strTemp,20,True)
            If objTemp.Exists = True then
             Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Border", "", 1).WPFObject("SearchGrid").WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 6).WPFObject("Button", "Apply Filter", 1).Click
              log.Message "Apply Filter button is Clicked in Layout workspace Viewer"
            End if                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
           Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 4).WPFObject("BarCheckItemLinkControl", "", 1).WPFObject("ContentControlEx", "Hide Search Filter", 2).Click
        End if
      Else
        strTCRemarks = "Show Search Filter button Disabled in Layout"
        log.Message "Show Search Filter button Disabled in Layout"
      End if 
    End If  
  End if 
  End Sub  
  
  
Sub sCheckLayoutWorkSpaceVwrWorkspaceButton()
On Error Resume Next

    Dim strObject,objEdgeMDI,strTemp,objTemp,GridControl,intRowcnt,intI,intRow

    strObject = "WPFObject(""HwndSource: RibbonWindow"")"
    Set objEdgeMDI = Sys.Process("EdgeClient").WaitChild(strObject, 600000)
    If objEdgeMDI.Exists then
      strTemp="WPFObject(""TextBlock"", ""Layout"", 1)"
      Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,14,True)
      If objTemp.Exists = False then
        strTemp="WPFObject(""ContentControl"", ""Layout Workspace"", 1)"
        Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).FindChild("Name",strTemp,16,True)
        If objTemp.Exists = True then
          objTemp.Click
        End If
        Call sEdgeProcessor
        log.Message "Opening Layout Workspace.."
      Else
        log.Message "Layout Workspace is opened"
      End If
  
      ''Selecting Records
      strTemp="WPFObject(""PendingChangeGridControl"")"
      Set GridControl=Sys.Process("EdgeClient").FindChild("Name",strTemp,60,True)
      
      intRowcnt=GridControl.wRowCount
      For intI=0 to intRowcnt-1
        intRow=GridControl.FindRow(1,"Workspace Name")
        Call GridControl.ClickCell(intI,1)
        
        strTemp="WPFObject(""ContentControlEx"", ""Drop"", 2)"
        Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,20,True)
        If objTemp.Exists = True then
          If objTemp.Enabled = True then
            log.Message "Drop Workspace is Active"
            strTCRemarks ="Drop Workspace is Active" 
          End if 
        End If
        
         strTemp="WPFObject(""ContentControlEx"", ""Open Workspace"", 2)"
        Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,20,True)
        If objTemp.Exists = True then
          If objTemp.Enabled = True then
            log.Message "Open Workspace is Active"
            strTCRemarks = strTCRemarks & "<br />" & "Open Workspace is Active" 
          End if 
        End If
        
         strTemp="WPFObject(""ContentControlEx"", ""Upload Workspace"", 2)"
        Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,20,True)
        If objTemp.Exists = True then
          If objTemp.Enabled = True then
            log.Message "Upload Workspace is Active"
            strTCRemarks = strTCRemarks & "<br />" & "Upload Workspace is Active" 
          End if 
        End If
        Call sCloseLayout
        Exit Sub 
      Next
    Else
      log.Message "RibbonWindow not found"
    End If

End Sub

Sub sCheckLayoutWorkSpaceVwrDropWorkspace()
On Error Resume Next

    Dim strObject,objEdgeMDI,strTemp,objTemp,GridControl,intRowcnt,intI,intRow


    strObject = "WPFObject(""HwndSource: Shell"", """& strEnvi &""")"  
    Set objEdgeMDI = Sys.Process("EdgeClient").WaitChild(strObject, 600000)
    If objEdgeMDI.Exists then
      strTemp="WPFObject(""TextBlock"", ""Layout"", 1)"
      Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,14,True)
      If objTemp.Exists = False then
        strTemp="WPFObject(""ContentControl"", ""Layout Workspace"", 1)"
        Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,16,True)
        If objTemp.Exists = True then
          objTemp.Click
        End If
        Call sEdgeProcessor
        log.Message "Opening Layout Workspace.."
      Else
        log.Message "Layout Workspace is opened"
      End If
  
      ''Selecting Records
      strTemp="WPFObject(""PendingChangeGridControl"")"
      Set GridControl=Sys.Process("EdgeClient").FindChild("Name",strTemp,60,True)
      
      intRowcnt=GridControl.wRowCount
      For intI=0 to intRowcnt-1
        intRow=GridControl.FindRow(1,"Workspace Name")
        Call GridControl.ClickCell(0,1)
        strTemp="WPFObject(""ContentControlEx"", ""Drop"", 2)"
        Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,20,True)
        If objTemp.Exists = True then
          objTemp.Click
        End If
        strTemp="WPFObject(""PART_ContainerContent"")"
        Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "Please Confirm.").WPFObject("CustomMessageBoxWindow", "Please Confirm.", 1).FindChild("Name",strTemp,50,True)
        If objTemp.Exists = True then
          Sys.Keys "Y"
          strTCRemarks = strTCRemarks & "<br />" & "Dropped Workspace Successfully" 
          Call sEdgeProcessor
        Else
        End If
        
         exit Sub 
      Next
      Call sCloseLayout
    Else
      log.Message "RibbonWindow not found"
    End If

End Sub
Sub sCheckLayoutWorkSpaceVwrOpenWorkspace()
On Error Resume Next

    Dim strObject,objEdgeMDI,strTemp,objTemp,GridControl,intRowcnt,intI,intRow

    strObject = "WPFObject(""HwndSource: RibbonWindow"")"
    Set objEdgeMDI = Sys.Process("EdgeClient").WaitChild(strObject, 600000)
    If objEdgeMDI.Exists then
      strTemp="WPFObject(""TextBlock"", ""Layout"", 1)"
      Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,14,True)
      If objTemp.Exists = False then
        strTemp="WPFObject(""ContentControl"", ""Layout Workspace"", 1)"
        Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).FindChild("Name",strTemp,16,True)
        If objTemp.Exists = True then
          objTemp.Click
        End If
        Call sEdgeProcessor
        log.Message "Opening Layout Workspace.."
      Else
        log.Message "Layout Workspace is opened"
      End If
  
      ''Selecting Records
      strTemp="WPFObject(""PendingChangeGridControl"")"
      Set GridControl=Sys.Process("EdgeClient").FindChild("Name",strTemp,60,True)
      
      intRowcnt=GridControl.wRowCount
      For intI=0 to intRowcnt-1
        intRow=GridControl.FindRow(1,"Workspace Name")
        Call GridControl.ClickCell(intI,1)
        strTemp="WPFObject(""ContentControlEx"", ""Open Workspace"", 2)"
        Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,20,True)
        If objTemp.Exists = True then
          If objTemp.Enabled = True then
            objTemp.Click
            Call sEdgeProcessor
            log.Message "Opened Workspace Successfully"
            strTCRemarks = "Opened Workspace Successfully" 
            Exit For 
          End if
        End If     
      Next
      Call sCloseLayout
      Call sCloseLayout
      
      strObject = "WPFObject(""HwndSource: RibbonWindow"")"
    Set objEdgeMDI = Sys.Process("EdgeClient").WaitChild(strObject, 600000)
    If objEdgeMDI.Exists then
      strTemp="WPFObject(""TextBlock"", ""Layout"", 1)"
      Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,14,True)
      If objTemp.Exists = False then
        strTemp="WPFObject(""ContentControl"", ""Layout Workspace"", 1)"
        Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,16,True)
        If objTemp.Exists = True then
          objTemp.Click
        End If
        Call sEdgeProcessor
        log.Message "Opening Layout Workspace.."
      Else
        log.Message "Layout Workspace is opened"
      End If
  
      ''Selecting Records
      strTemp="WPFObject(""PendingChangeGridControl"")"
      Set GridControl=Sys.Process("EdgeClient").FindChild("Name",strTemp,60,True)
      
      intRowcnt=GridControl.wRowCount
      For intI=0 to intRowcnt-1
        intRow=GridControl.FindRow(1,"Workspace Name")
        Call GridControl.ClickCell(intI,1)
        strTemp="WPFObject(""ContentControlEx"", ""Drop"", 2)"
        Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,20,True)
        If objTemp.Exists = True then
          objTemp.Click
        End If
        strTemp="WPFObject(""PART_ContainerContent"")"
        Set strOk=Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "Attention").WPFObject("CustomMessageBoxWindow", "Attention", 1).WaitChild(strTemp,850000)
        If objTemp.Exists = True then
          SYS.Keys "[Enter]"
          strTCRemarks = "Dropped Workspace Successfully" 
          Call sEdgeProcessor
        Else
        End If
        Call sCloseLayout
         exit Sub 
      Next
    
    End If
    Else
      log.Message "RibbonWindow not found"
    End If

End Sub

Sub sCheckLayoutWorkSpaceVwrOpnWrkRC()
On Error Resume Next

    Dim strObject,objEdgeMDI,strTemp,objTemp,GridControl,intRowcnt,intI,intRow

    strObject = "WPFObject(""HwndSource: RibbonWindow"")"
    Set objEdgeMDI = Sys.Process("EdgeClient").WaitChild(strObject, 600000)
    If objEdgeMDI.Exists then
      strTemp="WPFObject(""TextBlock"", ""Layout"", 1)"
      Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,14,True)
      If objTemp.Exists = False then
        strTemp="WPFObject(""ContentControl"", ""Layout Workspace"", 1)"
        Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).FindChild("Name",strTemp,16,True)
        If objTemp.Exists = True then
          objTemp.Click
        End If
        Call sEdgeProcessor
        log.Message "Opening Layout Workspace.."
      Else
        log.Message "Layout Workspace is opened"
      End If
  
      ''Selecting Records
      strTemp="WPFObject(""PendingChangeGridControl"")"
      Set GridControl=Sys.Process("EdgeClient").FindChild("Name",strTemp,60,True)
'      
'      intRowcnt=GridControl.wRowCount
      For intI=0 to intRowcnt-1
        intRow=GridControl.FindRow(1,"Workspace Name")
         GridControl.SelectRowCore(intRow).clickR
       Call GridControl.ClickCell(intI,1)
        strTemp="WPFObject(""ContentControlEx"", ""Open Workspace"", 2)"
        Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,20,True)
        If objTemp.Exists = True then
          If objTemp.Enabled = True then
            objTemp.Click
            Call sEdgeProcessor
            log.Message "Opened Workspace Successfully"
            strTCRemarks = "Opened Workspace Successfully" 
            Exit For 
          End if
        End If     
      Next
'      Call sCloseLayout
'      Call sCloseLayout
    Else
      log.Message "RibbonWindow not found"
    End If

End Sub


Sub sCheckLayoutWorkSpaceVwrDropMWorkspace()
On Error Resume Next

    Dim strObject,objEdgeMDI,strTemp,objTemp,GridControl,intRowcnt,intI,intRow

    strObject = "WPFObject(""HwndSource: RibbonWindow"")"
    Set objEdgeMDI = Sys.Process("EdgeClient").WaitChild(strObject, 600000)
    If objEdgeMDI.Exists then
      strTemp="WPFObject(""TextBlock"", ""Layout"", 1)"
      Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,14,True)
      If objTemp.Exists = False then
        strTemp="WPFObject(""ContentControl"", ""Layout Workspace"", 1)"
        Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).FindChild("Name",strTemp,16,True)
        If objTemp.Exists = True then
          objTemp.Click
        End If
        Call sEdgeProcessor
        log.Message "Opening Layout Workspace.."
      Else
        log.Message "Layout Workspace is opened"
      End If
  
      ''Selecting Records
      strTemp="WPFObject(""PendingChangeGridControl"")"
      Set GridControl=Sys.Process("EdgeClient").FindChild("Name",strTemp,60,True)
      
      intRowcnt=GridControl.wRowCount
      For intI=0 to intRowcnt-1
        intRow=GridControl.FindRow(1,"Workspace Name")
        'Call GridControl.ClickCell(intI,1)
        Call GridControl.ClickCell(0,1)
        Sys.Keys("^[Down]")
        Delay(5000)
        SYS.Keys("^ ")
        Delay(5000)
        'Call GridControl.ClickCell(0,1)
        
        strTemp="WPFObject(""ContentControlEx"", ""Open Workspace"", 2)"
        Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,20,True)
        If objTemp.Exists = True then
           If objTemp.Enabled = False then
            strTCRemarks = "Open Workspace button is disabled"
            log.Message "Open Workspace button is disabled"
           End if 
        End If
        
        strTemp="WPFObject(""ContentControlEx"", ""Upload Workspace"", 2)"
        Set objTemp= Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,20,True)
        If objTemp.Exists = True then
           If objTemp.Enabled = False then
            strTCRemarks = strTCRemarks & "<br />" & "Update Workspace button is disabled"
            log.Message "Update Workspace button is disabled"
           End if 
        End If
        strTemp="WPFObject(""ContentControlEx"", ""Drop"", 2)"
        Set objTemp= Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,20,True)
        If objTemp.Exists = True then
          objTemp.Click
        End If
        strTemp="WPFObject(""PART_ContainerContent"")"
        'Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: WindowContentHolder", "Please Confirm.").FindChild("Name",strTemp,50,True)
        Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "Please Confirm.").WPFObject("CustomMessageBoxWindow", "Please Confirm.", 1).FindChild("Name",strTemp,50,True)
        If objTemp.Exists = True then
          strTCRemarks = strTCRemarks & "<br />" & "Are you sure you want to drop the workspaces message shown successfully"
          Sys.Keys "Y"
          log.Message "Dropped multiple Workspace Successfully"
          strTCRemarks = strTCRemarks & "<br />" & "Dropped multiple Workspace Successfully" 
          Call sEdgeProcessor
        End If
        Call sCloseLayout
         exit Sub 
      Next
    Else
      log.Message "RibbonWindow not found"
    End If

End Sub

Sub sCheckLayoutWorkSpaceVwrWSOpenWorkspace()
On Error Resume Next

    Dim strObject,objEdgeMDI,strTemp,objTemp,GridControl,intRowcnt,intI,intRow

    strObject = "WPFObject(""HwndSource: RibbonWindow"")"
    Set objEdgeMDI = Sys.Process("EdgeClient").WaitChild(strObject, 600000)
    If objEdgeMDI.Exists then
      strTemp="WPFObject(""TextBlock"", ""Layout"", 1)"
      Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,14,True)
      If objTemp.Exists = False then
        strTemp="WPFObject(""ContentControl"", ""Layout Workspace"", 1)"
        Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).FindChild("Name",strTemp,16,True)
        If objTemp.Exists = True then
          objTemp.Click
        End If
        Call sEdgeProcessor
        log.Message "Opening Layout Workspace.."
      Else
        log.Message "Layout Workspace is opened"
      End If
  
      ''Selecting Records
      strTemp="WPFObject(""PendingChangeGridControl"")"
      Set GridControl=Sys.Process("EdgeClient").FindChild("Name",strTemp,60,True)
      
      intRowcnt=GridControl.wRowCount
      Call GridControl.ClickCell(0,1)
      SYS.Keys("^o")
      DElay (5000)
      Call sEdgeProcessor
      log.Message "Opened Workspace Successfully"
      strTCRemarks = "Opened Workspace Successfully" 
     ' Call sEdgeProcessor     
    
      Call sCloseLayout
      Call sCloseLayout
    Else
      log.Message "RibbonWindow not found"
    End If

End Sub

Sub sCheckLayoutWorkSpaceVwrWSUpdateWorkspace()
On Error Resume Next

    Dim strObject,objEdgeMDI,strTemp,objTemp,GridControl,intRowcnt,intI,intRow

    strObject = "WPFObject(""HwndSource: RibbonWindow"")"
    Set objEdgeMDI = Sys.Process("EdgeClient").WaitChild(strObject, 600000)
    If objEdgeMDI.Exists then
      strTemp="WPFObject(""TextBlock"", ""Layout"", 1)"
      Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,14,True)
      If objTemp.Exists = False then
        strTemp="WPFObject(""ContentControl"", ""Layout Workspace"", 1)"
        Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).FindChild("Name",strTemp,16,True)
        If objTemp.Exists = True then
          objTemp.Click
        End If
        Call sEdgeProcessor
        log.Message "Opening Layout Workspace.."
      Else
        log.Message "Layout Workspace is opened"
      End If
  
      ''Selecting Records
      strTemp="WPFObject(""PendingChangeGridControl"")"
      Set GridControl=Sys.Process("EdgeClient").FindChild("Name",strTemp,60,True)
      
      intRowcnt=GridControl.wRowCount
      Call GridControl.ClickCell(0,1)
      SYS.Keys("^u")
      DElay (5000)
      
      
      strTemp="WPFObject(""PART_ContainerContent"")"
      Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "Please Confirm.").FindChild("Name",strTemp,50,True)
'      strTemp="WPFObject(""DXMessageBox"", """", 1)"
'      Set objTemp=objTemp.WaitChild(strTemp,50000)
      If objTemp.Exists = True then
        Sys.Keys "Y"
        
            Set objConfirm = Sys.Process("EdgeClient")._
            Waitchild("WPFObject(""HwndSource: CustomMessageBoxWindow"", ""Upload Workspace"")",600000)._
            Waitchild("WPFObject(""CustomMessageBoxWindow"", ""Upload Workspace"", 1)",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""FloatingContainerBorder"")",60000)._
            Waitchild("WPFObject(""FloatingContainerBackground"")",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""FloatingContainerBody"")",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""PART_ContainerContent"")",60000)        
            
            If objConfirm.Exists = True Then
                objConfirm.Click
                SYS.Keys "[Enter]"
            End If
         log.Message "Updated Workspace Successfully"
        strTCRemarks = "Updated Workspace Successfully" 
      End If
     ' Call sEdgeProcessor     
    
      Call sCloseLayout
      Call sCloseLayout
    Else
      log.Message "RibbonWindow not found"
    End If

End Sub

Sub sCheckLayoutWorkSpaceVwrUpdateWorkspace()
On Error Resume Next

    Dim strObject,objEdgeMDI,strTemp,objTemp,GridControl,intRowcnt,intI,intRow,objwrkspacepop,objwrkspcUpload

    strObject = "WPFObject(""HwndSource: RibbonWindow"")"
    Set objEdgeMDI = Sys.Process("EdgeClient").WaitChild(strObject, 600000)
    If objEdgeMDI.Exists then
      strTemp="WPFObject(""TextBlock"", ""Layout"", 1)"
      Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,14,True)
      If objTemp.Exists = False then
        strTemp="WPFObject(""ContentControl"", ""Layout Workspace"", 1)"
        Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).FindChild("Name",strTemp,16,True)
        If objTemp.Exists = True then
          objTemp.Click
        End If
        Call sEdgeProcessor
        log.Message "Opening Layout Workspace.."
      Else
        log.Message "Layout Workspace is opened"
      End If
  
      ''Selecting Records
      strTemp="WPFObject(""PendingChangeGridControl"")"
      Set GridControl=Sys.Process("EdgeClient").FindChild("Name",strTemp,60,True)
      
      intRowcnt=GridControl.wRowCount
      Call GridControl.ClickCell(0,1)
'      SYS.Keys("^u")
'      DElay (5000)

     
        strTemp="WPFObject(""ContentControlEx"", ""Upload Workspace"", 2)"
        set objwrkspcUpload=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 2).WPFObject("BarButtonItemLinkControl", "", 1).FindChild("Name",strTemp,5,True)
        If objwrkspcUpload.Exists = True then
          objwrkspcUpload.Click
          strTemp="WPFObject(""PART_ContainerContent"")"
          'Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: WindowContentHolder", "Please Confirm.").FindChild("Name",strTemp,50,True)
          Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "Please Confirm.").WPFObject("CustomMessageBoxWindow", "Please Confirm.", 1).FindChild("Name",strTemp,50,True)
        If objTemp.Exists = True then
          Sys.Keys "Y"
          log.Message "System shown the confirmation message Successfully"
          strTCRemarks = "System shown the confirmation message Successfully" 
          Set objConfirm= Sys.Process("EdgeClient")._
      Waitchild("WPFObject(""HwndSource: CustomMessageBoxWindow"", ""Upload Workspace"")",600000)._
      Waitchild("WPFObject(""CustomMessageBoxWindow"", ""Upload Workspace"", 1)",600000)._
      Waitchild("WPFObject(""Grid"", """", 1)",600000)._
      Waitchild("WPFObject(""FloatingContainerBorder"")",600000)._
      Waitchild("WPFObject(""FloatingContainerBackground"")",600000)._
      Waitchild("WPFObject(""Grid"", """", 1)",600000)._
      Waitchild("WPFObject(""FloatingContainerBody"")",600000)._
      Waitchild("WPFObject(""Grid"", """", 1)",600000)._
      Waitchild("WPFObject(""Grid"", """", 1)",600000)._
      Waitchild("WPFObject(""PART_ContainerContent"")",60000)
              
      If objConfirm.Exists = True Then 
        objConfirm.Click
        SYS.Keys("O")
      End If
        log.Message "Updated Workspace Successfully"
        strTCRemarks = strTCRemarks & "<br />" & "Updated Workspace Successfully" 
      End if 
    End if
      Call sCloseLayout
      Call sCloseLayout
    Else
      log.Message "RibbonWindow not found"
    End If

End Sub

Sub sCheckLayoutWorkSpaceVwrSameOpenWorkspace()
On Error Resume Next

    Dim strObject,objEdgeMDI,strTemp,objTemp,GridControl,intRowcnt,intI,intRow

    strObject = "WPFObject(""HwndSource: RibbonWindow"")"
    Set objEdgeMDI = Sys.Process("EdgeClient").WaitChild(strObject, 600000)
    If objEdgeMDI.Exists then
      strTemp="WPFObject(""TextBlock"", ""Layout"", 1)"
      Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,14,True)
      If objTemp.Exists = False then
        strTemp="WPFObject(""ContentControl"", ""Layout Workspace"", 1)"
        Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).FindChild("Name",strTemp,16,True)
        If objTemp.Exists = True then
          objTemp.Click
        End If
        Call sEdgeProcessor
        log.Message "Opening Layout Workspace.."
      Else
        log.Message "Layout Workspace is opened"
      End If
  
      ''Selecting Records
      strTemp="WPFObject(""PendingChangeGridControl"")"
      Set GridControl=Sys.Process("EdgeClient").FindChild("Name",strTemp,60,True)
      
      intRowcnt=GridControl.wRowCount
      For intI=0 to intRowcnt-1
        intRow=GridControl.FindRow(1,"Workspace Name")
        Call GridControl.ClickCell(intI,1)
        strTemp="WPFObject(""ContentControlEx"", ""Open Workspace"", 2)"
        Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,20,True)
        If objTemp.Exists = True then
          If objTemp.Enabled = True then
            objTemp.Click
            Call sEdgeProcessor
            log.Message "Opened Workspace Successfully"
            strTCRemarks = "Opened Workspace Successfully" 
            Exit For 
          End if
        End If     
      Next
      
      intRowcnt=GridControl.wRowCount
      For intI=0 to intRowcnt-1
        intRow=GridControl.FindRow(1,"Workspace Name")
        Call GridControl.ClickCell(intI,1)
        strTemp="WPFObject(""ContentControlEx"", ""Open Workspace"", 2)"
        Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,20,True)
        If objTemp.Exists = True then
          If objTemp.Enabled = True then
            objTemp.Click
            Call sEdgeProcessor
           strTemp="WPFObject(""PART_ContainerContent"")"
              Set strOk=Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "Attention").WPFObject("CustomMessageBoxWindow", "Attention", 1).WaitChild(strTemp,850000)
             If objTemp.Exists = True then
                objTemp.Click
                SYS.Keys "[Enter]"
                 log.Message "Opened Workspace Already"
                 strTCRemarks = strTCRemarks & "<br />" & "Opened Workspace Already" 
             End if 
            Exit For 
          End if
        End If     
      Next
      
      Call sCloseLayout
      Call sCloseLayout
    Else
      log.Message "RibbonWindow not found"
    End If

End Sub

Sub sCheckLayoutWorkSpaceVwrDropOpenWorkspace()
On Error Resume Next

    Dim strObject,objEdgeMDI,strTemp,objTemp,GridControl,intRowcnt,intI,intRow

    strObject = "WPFObject(""HwndSource: RibbonWindow"")"
    Set objEdgeMDI = Sys.Process("EdgeClient").WaitChild(strObject, 600000)
    If objEdgeMDI.Exists then
      strTemp="WPFObject(""TextBlock"", ""Layout"", 1)"
      Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,14,True)
      If objTemp.Exists = False then
        strTemp="WPFObject(""ContentControl"", ""Layout Workspace"", 1)"
        Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).FindChild("Name",strTemp,16,True)
        If objTemp.Exists = True then
          objTemp.Click
        End If
        Call sEdgeProcessor
        log.Message "Opening Layout Workspace.."
      Else
        log.Message "Layout Workspace is opened"
      End If
  
      ''Selecting Records
      strTemp="WPFObject(""PendingChangeGridControl"")"
      Set GridControl=Sys.Process("EdgeClient").FindChild("Name",strTemp,60,True)
      
      intRowcnt=GridControl.wRowCount
      For intI=0 to intRowcnt-1
        intRow=GridControl.FindRow(1,"Workspace Name")
        Call GridControl.ClickCell(intI,1)
        strTemp="WPFObject(""ContentControlEx"", ""Open Workspace"", 2)"
        Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,20,True)
        If objTemp.Exists = True then
          If objTemp.Enabled = True then
            objTemp.Click
            Call sEdgeProcessor
            log.Message "Opened Workspace Successfully"
            strTCRemarks = "Opened Workspace Successfully" 
            Exit For 
          End if
        End If     
      Next
      intRowcnt=GridControl.wRowCount
      For intI=0 to intRowcnt-1
        intRow=GridControl.FindRow(1,"Workspace Name")
        Call GridControl.ClickCell(intI,1)
        strTemp="WPFObject(""ContentControlEx"", ""Drop"", 2)"
        Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,20,True)
        If objTemp.Exists = True then
          objTemp.Click
        End If
        Call sEdgeProcessor
        strTemp="WPFObject(""PART_ContainerContent"")"
        Set strOk=Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "Attention").WPFObject("CustomMessageBoxWindow", "Attention", 1).WaitChild(strTemp,850000)
         If objTemp.Exists = True then
            objTemp.Click
            SYS.Keys "[Enter]"
             log.Message "Opened Workspace Already"
             strTCRemarks = strTCRemarks & "<br />" & "Opened Workspace Already" 
         End if 
        Exit For  
      Next
      
      Call sCloseLayout
      Call sCloseLayout
    Else
      log.Message "RibbonWindow not found"
    End If

End Sub



Sub sCheckLayoutWorkSpaceVwrDoubleClickWorkspace()
On Error Resume Next

    Dim strObject,objEdgeMDI,strTemp,objTemp,GridControl,intRowcnt,intI,intRow

    strObject = "WPFObject(""HwndSource: RibbonWindow"")"
    Set objEdgeMDI = Sys.Process("EdgeClient").WaitChild(strObject, 600000)
    If objEdgeMDI.Exists then
      strTemp="WPFObject(""TextBlock"", ""Layout"", 1)"
      Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,14,True)
      If objTemp.Exists = False then
        strTemp="WPFObject(""ContentControl"", ""Layout Workspace"", 1)"
        Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).FindChild("Name",strTemp,16,True)
        If objTemp.Exists = True then
          objTemp.Click
        End If
        Call sEdgeProcessor
        log.Message "Opening Layout Workspace.."
      Else
        log.Message "Layout Workspace is opened"
      End If
  
      ''Selecting Records
      strTemp="WPFObject(""PendingChangeGridControl"")"
      Set GridControl=Sys.Process("EdgeClient").FindChild("Name",strTemp,60,True)
      
      intRowcnt=GridControl.wRowCount
      For intI=0 to intRowcnt-1
        intRow=GridControl.FindRow(1,"Workspace Name")
        Call GridControl.ClickCell(intI,1)
        Call GridControl.DblClick 
        Call sEdgeProcessor  
      Next
     
      Call sCloseLayout
      Call sCloseLayout
    Else
      log.Message "RibbonWindow not found"
    End If

End Sub

Sub sCheckLayoutWorkSpaceVwrRCOpenWorkspace()
On Error Resume Next

    Dim strObject,objEdgeMDI,strTemp,objTemp,GridControl,intRowcnt,intI,intRow

    strObject = "WPFObject(""HwndSource: RibbonWindow"")"
    Set objEdgeMDI = Sys.Process("EdgeClient").WaitChild(strObject, 600000)
    If objEdgeMDI.Exists then
      strTemp="WPFObject(""TextBlock"", ""Layout"", 1)"
      Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,14,True)
      If objTemp.Exists = False then
        strTemp="WPFObject(""ContentControl"", ""Layout Workspace"", 1)"
        Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).FindChild("Name",strTemp,16,True)
        If objTemp.Exists = True then
          objTemp.Click
        End If
        Call sEdgeProcessor
        log.Message "Opening Layout Workspace.."
      Else
        log.Message "Layout Workspace is opened"
      End If
  
      ''Selecting Records
      strTemp="WPFObject(""PendingChangeGridControl"")"
      Set GridControl=Sys.Process("EdgeClient").FindChild("Name",strTemp,60,True)
      
      intRowcnt=GridControl.wRowCount
      For intI=0 to intRowcnt-1
        intRow=GridControl.FindRow(1,"Workspace Name")
        Call GridControl.ClickCell(intI,1)
        'Call edgeClient.HwndSource_RibbonWindow.RibbonWindow.ContentControl.Grid.Grid.ContentControl.Grid.ContentControl.PART_ContainerContent.BarManager.DockPanel.DockLayoutManager.LayoutGroup.LayoutPanel.Root.AdornerDecorator.AdornedControl.Grid.BarManager.DockPanel.PendingChangeGridControl.PendingChangeTableView.HierarchyPanel.RowControl.CellsControl.LightweightCellEditor.InplaceBaseEdit.ClickR(81, 13)
        Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("PendingChangeGridControl").WPFObject("PendingChangeTableView").WPFObject("HierarchyPanel", "", 1).WPFObject("RowControl", "", 1).WPFObject("CellsControl", "", 1).WPFObject("LightweightCellEditor", "", 1).WPFObject("InplaceBaseEdit", "", 1).ClickR
        Delay (5000)
        'Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).Click
        Dim objEdgeFilter
        set objEdgeFilter= Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "", 1).WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarButtonItemLinkControl", "", 1)
        strTemp="WPFObject(""ContentControlEx"", ""Open Workspace"", 2)"
        Set objTemp=objEdgeFilter.FindChild("Name",strTemp,50)
        If objTemp.Exists = TRUE then
         Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "", 1).WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarButtonItemLinkControl", "", 1).WPFObject("ContentControlEx", "Open Workspace", 2).Click
           log.Message "Opened Workspace Successfully "
           strTCRemarks = strTCRemarks & "<br />" & "Opened Workspace Successfully" 
        Else
          strTestCaseResult = "ABORT"
          Exit Sub  
        End If
        Call sEdgeProcessor  
      Next
     
      Call sCloseLayout
      Call sCloseLayout
       strObject = "WPFObject(""HwndSource: RibbonWindow"")"
    Set objEdgeMDI = Sys.Process("EdgeClient").WaitChild(strObject, 600000)
    If objEdgeMDI.Exists then
      strTemp="WPFObject(""TextBlock"", ""Layout"", 1)"
      Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,14,True)
      If objTemp.Exists = False then
        strTemp="WPFObject(""ContentControl"", ""Layout Workspace"", 1)"
        Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).FindChild("Name",strTemp,16,True)
        If objTemp.Exists = True then
          objTemp.Click
        End If
        Call sEdgeProcessor
        log.Message "Opening Layout Workspace.."
      Else
        log.Message "Layout Workspace is opened"
      End If
  
      ''Selecting Records
      strTemp="WPFObject(""PendingChangeGridControl"")"
      Set GridControl=Sys.Process("EdgeClient").FindChild("Name",strTemp,60,True)
      
      intRowcnt=GridControl.wRowCount
      For intI=0 to intRowcnt-1
        intRow=GridControl.FindRow(1,"Workspace Name")
        Call GridControl.ClickCell(intI,1)
        strTemp="WPFObject(""ContentControlEx"", ""Drop"", 2)"
        Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,20,True)
        If objTemp.Exists = True then
          objTemp.Click
        End If
        strTemp="WPFObject(""PART_ContainerContent"")"
              Set strOk=Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "Attention").WPFObject("CustomMessageBoxWindow", "Attention", 1).WaitChild(strTemp,850000)
        If objTemp.Exists = True then
          SYS.Keys "[Enter]"
          strTCRemarks = "Dropped Workspace Successfully" 
          Call sEdgeProcessor
        Else
        End If
        Call sCloseLayout
         exit Sub 
      Next
    
    End If
    Else
      log.Message "RibbonWindow not found"
    End If

End Sub


Sub sCheckLayoutWorkSpaceVwrRCUpdateWorkspace()
On Error Resume Next

    Dim strObject,objEdgeMDI,strTemp,objTemp,GridControl,intRowcnt,intI,intRow

    strObject = "WPFObject(""HwndSource: RibbonWindow"")"
    Set objEdgeMDI = Sys.Process("EdgeClient").WaitChild(strObject, 600000)
    If objEdgeMDI.Exists then
      strTemp="WPFObject(""TextBlock"", ""Layout"", 1)"
      Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,14,True)
      If objTemp.Exists = False then
        strTemp="WPFObject(""ContentControl"", ""Layout Workspace"", 1)"
        Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).FindChild("Name",strTemp,16,True)
        If objTemp.Exists = True then
          objTemp.Click
        End If
        Call sEdgeProcessor
        log.Message "Opening Layout Workspace.."
      Else
        log.Message "Layout Workspace is opened"
      End If
  
      ''Selecting Records
      strTemp="WPFObject(""PendingChangeGridControl"")"
      Set GridControl=Sys.Process("EdgeClient").FindChild("Name",strTemp,60,True)
      
      intRowcnt=GridControl.wRowCount
      For intI=0 to intRowcnt-1
        intRow=GridControl.FindRow(1,"Workspace Name")
        Call GridControl.ClickCell(intI,1)
        Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("PendingChangeGridControl").WPFObject("PendingChangeTableView").WPFObject("HierarchyPanel", "", 1).WPFObject("RowControl", "", 1).WPFObject("CellsControl", "", 1).WPFObject("LightweightCellEditor", "", 1).WPFObject("InplaceBaseEdit", "", 1).ClickR
        Delay (5000)
        Dim objEdgeFilter
        set objEdgeFilter= Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 2).WPFObject("BarButtonItemLinkControl", "", 1)
        strTemp="WPFObject(""ContentControlEx"", ""Upload Workspace"", 2)"
        Set objTemp=objEdgeFilter.FindChild("Name",strTemp,50)
        If objTemp.Exists = TRUE then
            Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 2).WPFObject("BarButtonItemLinkControl", "", 1).WPFObject("ContentControlEx", "Upload Workspace", 2).Click
            strTemp="WPFObject(""PART_ContainerContent"")"
            Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "Please Confirm.").FindChild("Name",strTemp,50,True)
'            strTemp="WPFObject(""DXMessageBox"", """", 1)"
'            Set objTemp=objTemp.WaitChild(strTemp,50000)
            If objTemp.Exists = True then
              Sys.Keys "Y"
              log.Message "System shown the confirmation message Successfully"
              strTCRemarks = "System shown the confirmation message Successfully" 
              Set objConfirm = Sys.Process("EdgeClient")._
            Waitchild("WPFObject(""HwndSource: CustomMessageBoxWindow"", ""Upload Workspace"")",600000)._
            Waitchild("WPFObject(""CustomMessageBoxWindow"", ""Upload Workspace"", 1)",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""FloatingContainerBorder"")",60000)._
            Waitchild("WPFObject(""FloatingContainerBackground"")",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""FloatingContainerBody"")",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""PART_ContainerContent"")",60000)
            
            If objConfirm.Exists = True then
                  SYS.Keys "[Enter]"
              End If
            log.Message "Updated Workspace Successfully"
            strTCRemarks = strTCRemarks & "<br />" & "Updated Workspace Successfully" 
          End if 
        Else
          strTestCaseResult = "ABORT"
          Exit Sub  
        End If
        Call sEdgeProcessor  
      Next
     
      Call sCloseLayout
      Call sCloseLayout
    Else
      log.Message "RibbonWindow not found"
    End If

End Sub

Sub sCheckLayoutWorkSpaceVwrRCDropWorkspace()
On Error Resume Next

    Dim strObject,objEdgeMDI,strTemp,objTemp,GridControl,intRowcnt,intI,intRow

    strObject = "WPFObject(""HwndSource: RibbonWindow"")"
    Set objEdgeMDI = Sys.Process("EdgeClient").WaitChild(strObject, 600000)
    If objEdgeMDI.Exists then
      strTemp="WPFObject(""TextBlock"", ""Layout"", 1)"
      Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,14,True)
      If objTemp.Exists = False then
        strTemp="WPFObject(""ContentControl"", ""Layout Workspace"", 1)"
        Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).FindChild("Name",strTemp,16,True)
        If objTemp.Exists = True then
          objTemp.Click
        End If
        Call sEdgeProcessor
        log.Message "Opening Layout Workspace.."
      Else
        log.Message "Layout Workspace is opened"
      End If
  
      ''Selecting Records
      strTemp="WPFObject(""PendingChangeGridControl"")"
      Set GridControl=Sys.Process("EdgeClient").FindChild("Name",strTemp,60,True)
      
      intRowcnt=GridControl.wRowCount
      For intI=0 to intRowcnt-1
        intRow=GridControl.FindRow(1,"Workspace Name")
        Call GridControl.ClickCell(intI,1)
        Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("PendingChangeGridControl").WPFObject("PendingChangeTableView").WPFObject("HierarchyPanel", "", 1).WPFObject("RowControl", "", 1).WPFObject("CellsControl", "", 1).WPFObject("LightweightCellEditor", "", 1).WPFObject("InplaceBaseEdit", "", 1).ClickR
        Delay (5000)
        Dim objEdgeFilter
        set objEdgeFilter= Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 3).WPFObject("BarButtonItemLinkControl", "", 1)
        strTemp="WPFObject(""ContentControlEx"", ""Drop"", 2)"
        Set objTemp=objEdgeFilter.FindChild("Name",strTemp,50)
        If objTemp.Exists = TRUE then
            Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 3).WPFObject("BarButtonItemLinkControl", "", 1).WPFObject("ContentControlEx", "Drop", 2).Click
            strTemp="WPFObject(""PART_ContainerContent"")"
        'Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: WindowContentHolder", "Please Confirm.").FindChild("Name",strTemp,50,True)
        Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "Please Confirm.").WPFObject("CustomMessageBoxWindow", "Please Confirm.", 1).FindChild("Name",strTemp,50,True)
            If objTemp.Exists = True then
              Sys.Keys "Y"
              strTCRemarks = "Dropped Workspace Successfully" 
              Call sEdgeProcessor
            End If
        End if 
        Call sCloseLayout
        exit Sub 
      Next
    Else
      log.Message "RibbonWindow not found"
    End If

End Sub
Sub sCheckLayoutWorkspaceVwrCurrentCheckComboBox()
On Error Resume Next

  Dim objEdge,strTemp,objTemp,objEdgeTree,strLayoutHeader,GridControl,GridSourceTree,intTotNodeCnt,intI,strClose
              
  set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1)            
  strTemp="WPFObject(""LayoutPanel"", """", 1)"
  Set objTemp=objEdge.FindChild("Name",strTemp,50)
  If objTemp.Exists=True then
    strTCRemarks = "Layout grid found in Layout workspace view"
    log.Message "Layout grid found in Layout"
   
    strTemp="WPFObject(""ContentControlEx"", ""Show Search Filter"", 2)"
    Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,20,True)
    If objTemp.Exists = True then
      if objTemp.Enabled=True then
        log.Message "Show Search Filter button Enabled in Layout"
        Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 4).WPFObject("BarCheckItemLinkControl", "", 1).WPFObject("ContentControlEx", "Show Search Filter", 2).Click
        Delay(5000)
        
        strTCRemarks = "Clicked Show Search Filter button in Layout workspace Viewer"
         strTemp="WPFObject(""Border"", """", 1)"
        Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).FindChild("Name",strTemp,20,True)
        If objTemp.Exists = True then
'           
            Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Border", "", 1).WPFObject("SearchGrid").WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 2).WPFObject("ComboBox", "", 1).Click
            
            Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("ComboBoxItem", "", 1).WPFObject("StackPanel", "", 1).WPFObject("CheckBox", "", 1).Click
            delay(5000)
            strTCRemarks = "Unchecked all the option in CreatedBy Dropdown"
            
            Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("ComboBoxItem", "", 2).WPFObject("StackPanel", "", 1).WPFObject("CheckBox", "", 1).Click
            strTCRemarks = strTCRemarks & "<br />" & "Checked Current User option in CreatedBy Dropdown"
            
             strTemp="WPFObject(""Border"", """", 1)"
            Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).FindChild("Name",strTemp,20,True)
            If objTemp.Exists = True then
            
                Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Border", "", 1).WPFObject("SearchGrid").WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 1).WPFObject("TextBox", "", 1).Text="S4"
                Delay(5000)
                Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Border", "", 1).WPFObject("SearchGrid").WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 1).WPFObject("TextBox", "", 1).Click
               strTCRemarks = "Workspace is Entered"      
                strTemp="WPFObject(""Button"", ""Apply Filter"", 1)"
                Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Border", "", 1).WPFObject("SearchGrid").WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 6).FindChild("Name",strTemp,20,True)
                If objTemp.Exists = True then
                 Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Border", "", 1).WPFObject("SearchGrid").WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 6).WPFObject("Button", "Apply Filter", 1).Click
                  log.Message "Apply Filter button is Clicked in Layout workspace Viewer"
                End if 
            
               strTCRemarks = strTCRemarks & "<br />" & "Displayed only Selected Workspace" 
               Delay(15000)
               strTemp="WPFObject(""Button"", ""Reset Default"", 2)"
                Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Border", "", 1).WPFObject("SearchGrid").WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 6).FindChild("Name",strTemp,20,True)
                If objTemp.Exists = True then
                  Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Border", "", 1).WPFObject("SearchGrid").WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 6).WPFObject("Button", "Reset Default", 2).Click
                  log.Message "Apply Filter button is Clicked in Layout workspace Viewer"
              
                  strTemp="WPFObject(""PART_ContainerContent"")"
                  Set strClose=Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "Please Confirm.").WPFObject("CustomMessageBoxWindow", "Please Confirm.", 1).WaitChild(strTemp,500000)
                  If strClose.Exists Then
                    strClose.Click
                     SYS.Keys "[Enter]"
                  End If              
                End if   
            
                strTemp="WPFObject(""Button"", ""Apply Filter"", 1)"
                Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Border", "", 1).WPFObject("SearchGrid").WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 6).FindChild("Name",strTemp,20,True)
                If objTemp.Exists = True then
                 Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Border", "", 1).WPFObject("SearchGrid").WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 6).WPFObject("Button", "Apply Filter", 1).Click
                  log.Message "Apply Filter button is Clicked in Layout workspace Viewer"
                End if                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
               Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 4).WPFObject("BarCheckItemLinkControl", "", 1).WPFObject("ContentControlEx", "Hide Search Filter", 2).Click
            End if
            
          '  Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("ComboBoxItem", "", 2).WPFObject("StackPanel", "", 1).WPFObject("CheckBox", "", 1).Click
'            Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("ComboBoxItem", "", 1).WPFObject("StackPanel", "", 1).WPFObject("CheckBox", "", 1).Click
'            strTCRemarks = strTCRemarks & "<br />" & "Checked all the option in CreatedBy Dropdown"
'            Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 4).WPFObject("BarCheckItemLinkControl", "", 1).WPFObject("ContentControlEx", "Hide Search Filter", 2).Click
        End if
      Else
        strTCRemarks = "Show Search Filter button Disabled in Layout"
        log.Message "Show Search Filter button Disabled in Layout"
      End if 
    End If  
  End if 
  End Sub 
  
  
Sub sCheckLayoutWorkspaceVwrUserCheckComboBox()
On Error Resume Next

  Dim objEdge,strTemp,objTemp,objEdgeTree,strLayoutHeader,GridControl,GridSourceTree,intTotNodeCnt,intI
              
  set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1)            
  strTemp="WPFObject(""LayoutPanel"", """", 1)"
  Set objTemp=objEdge.FindChild("Name",strTemp,50)
  If objTemp.Exists=True then
    strTCRemarks = "Layout grid found in Layout workspace view"
    log.Message "Layout grid found in Layout"
   
    strTemp="WPFObject(""ContentControlEx"", ""Show Search Filter"", 2)"
    Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,20,True)
    If objTemp.Exists = True then
      if objTemp.Enabled=True then
        log.Message "Show Search Filter button Enabled in Layout"
        Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 4).WPFObject("BarCheckItemLinkControl", "", 1).WPFObject("ContentControlEx", "Show Search Filter", 2).Click
        Delay(5000)
        
        strTCRemarks = "Clicked Show Search Filter button in Layout workspace Viewer"
         strTemp="WPFObject(""Border"", """", 1)"
        Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).FindChild("Name",strTemp,20,True)
        If objTemp.Exists = True then
'           
            
            Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Border", "", 1).WPFObject("SearchGrid").WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 3).WPFObject("ComboBox", "", 1).Click
            Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("ComboBoxItem", "", 2).WPFObject("StackPanel", "", 1).WPFObject("CheckBox", "", 1).Click
            delay(5000)
            strTCRemarks = "Unchecked all the option in Owner Dropdown"
            
            Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("ComboBoxItem", "", 2).WPFObject("StackPanel", "", 1).WPFObject("CheckBox", "", 1).Click
            strTCRemarks = strTCRemarks & "<br />" & "Checked Current User option in CreatedBy Dropdown"
            
             strTemp="WPFObject(""Border"", """", 1)"
            Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).FindChild("Name",strTemp,20,True)
            If objTemp.Exists = True then
            
              Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("ComboBoxItem", "", 2).WPFObject("StackPanel", "", 1).WPFObject("CheckBox", "", 1).Click
             
                strTemp="WPFObject(""Button"", ""Apply Filter"", 1)"
                Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Border", "", 1).WPFObject("SearchGrid").WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 6).FindChild("Name",strTemp,20,True)
                If objTemp.Exists = True then
                 Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Border", "", 1).WPFObject("SearchGrid").WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 6).WPFObject("Button", "Apply Filter", 1).Click
                  log.Message "Apply Filter button is Clicked in Layout workspace Viewer"
                End if 
            
               strTCRemarks = strTCRemarks & "<br />" & "Displayed only Selected Workspace" 
               Delay(15000)
               strTemp="WPFObject(""Button"", ""Reset Default"", 2)"
                Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Border", "", 1).WPFObject("SearchGrid").WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 6).FindChild("Name",strTemp,20,True)
                If objTemp.Exists = True then
                  Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Border", "", 1).WPFObject("SearchGrid").WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 6).WPFObject("Button", "Reset Default", 2).Click
                  log.Message "Apply Filter button is Clicked in Layout workspace Viewer"
              
                 strTemp="WPFObject(""PART_ContainerContent"")"
        'Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: WindowContentHolder", "Please Confirm.").FindChild("Name",strTemp,50,True)
        Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "Please Confirm.").WPFObject("CustomMessageBoxWindow", "Please Confirm.", 1).FindChild("Name",strTemp,50,True)
                  If strClose.Exists Then
                     SYS.Keys "[Enter]"
                  End If              
                End if   
            
                strTemp="WPFObject(""Button"", ""Apply Filter"", 1)"
                Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Border", "", 1).WPFObject("SearchGrid").WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 6).FindChild("Name",strTemp,20,True)
                If objTemp.Exists = True then
                 Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Border", "", 1).WPFObject("SearchGrid").WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 6).WPFObject("Button", "Apply Filter", 1).Click
                  log.Message "Apply Filter button is Clicked in Layout workspace Viewer"
                End if                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
               Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 4).WPFObject("BarCheckItemLinkControl", "", 1).WPFObject("ContentControlEx", "Hide Search Filter", 2).Click
            End if
            
          '  Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("ComboBoxItem", "", 2).WPFObject("StackPanel", "", 1).WPFObject("CheckBox", "", 1).Click
'            Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("ComboBoxItem", "", 1).WPFObject("StackPanel", "", 1).WPFObject("CheckBox", "", 1).Click
'            strTCRemarks = strTCRemarks & "<br />" & "Checked all the option in CreatedBy Dropdown"
'            Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 4).WPFObject("BarCheckItemLinkControl", "", 1).WPFObject("ContentControlEx", "Hide Search Filter", 2).Click
        End if
      Else
        strTCRemarks = "Show Search Filter button Disabled in Layout"
        log.Message "Show Search Filter button Disabled in Layout"
      End if 
    End If  
  End if 
  End Sub 
  
  
Sub sCheckLayoutWorkSpaceVwrRCWorkspace()
On Error Resume Next

    Dim strObject,objEdgeMDI,strTemp,objTemp,GridControl,intRowcnt,intI,intRow

    strObject = "WPFObject(""HwndSource: RibbonWindow"")"
    Set objEdgeMDI = Sys.Process("EdgeClient").WaitChild(strObject, 600000)
    If objEdgeMDI.Exists then
      strTemp="WPFObject(""TextBlock"", ""Layout"", 1)"
      Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,14,True)
      If objTemp.Exists = False then
        strTemp="WPFObject(""ContentControl"", ""Layout Workspace"", 1)"
        Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).FindChild("Name",strTemp,16,True)
        If objTemp.Exists = True then
          objTemp.Click
        End If
        Call sEdgeProcessor
        log.Message "Opening Layout Workspace.."
      Else
        log.Message "Layout Workspace is opened"
      End If
  
      ''Selecting Records
      strTemp="WPFObject(""PendingChangeGridControl"")"
      Set GridControl=Sys.Process("EdgeClient").FindChild("Name",strTemp,60,True)
      
      intRowcnt=GridControl.wRowCount
      For intI=0 to intRowcnt-1
        intRow=GridControl.FindRow(1,"Workspace Name")
        Call GridControl.ClickCell(intI,1)
        'Call edgeClient.HwndSource_RibbonWindow.RibbonWindow.ContentControl.Grid.Grid.ContentControl.Grid.ContentControl.PART_ContainerContent.BarManager.DockPanel.DockLayoutManager.LayoutGroup.LayoutPanel.Root.AdornerDecorator.AdornedControl.Grid.BarManager.DockPanel.PendingChangeGridControl.PendingChangeTableView.HierarchyPanel.RowControl.CellsControl.LightweightCellEditor.InplaceBaseEdit.ClickR(81, 13)
        Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("PendingChangeGridControl").WPFObject("PendingChangeTableView").WPFObject("HierarchyPanel", "", 1).WPFObject("RowControl", "", 1).WPFObject("CellsControl", "", 1).WPFObject("LightweightCellEditor", "", 1).WPFObject("InplaceBaseEdit", "", 1).ClickR
        Delay (5000)
        'Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).Click
        Dim objEdgeFilter
        set objEdgeFilter= Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "", 1).WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarButtonItemLinkControl", "", 1)
        strTemp="WPFObject(""ContentControlEx"", ""Open Workspace"", 2)"
        Set objTemp=objEdgeFilter.FindChild("Name",strTemp,50)
        If objTemp.Exists = TRUE then
           log.Message "Opened Workspace Found "
           strTCRemarks = strTCRemarks & "<br />" & "Opened Workspace Found in Layout Workspace Viewer" 
        Else
          strTestCaseResult = "ABORT"
          Exit Sub  
        End If
        
        set objEdgeFilter= Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 3).WPFObject("BarButtonItemLinkControl", "", 1)
        strTemp="WPFObject(""ContentControlEx"", ""Drop"", 2)"
        Set objTemp=objEdgeFilter.FindChild("Name",strTemp,50)
        If objTemp.Exists = TRUE then
           log.Message "Drop Workspace Found "
           strTCRemarks = strTCRemarks & "<br />" & "Drop Workspace Found in Layout Workspace Viewer" 
        Else
          strTestCaseResult = "ABORT"
          Exit Sub  
        End If
        
        set objEdgeFilter= Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 2).WPFObject("BarButtonItemLinkControl", "", 1)
        strTemp="WPFObject(""ContentControlEx"", ""Upload Workspace"", 2)"
        Set objTemp=objEdgeFilter.FindChild("Name",strTemp,50)
        If objTemp.Exists = TRUE then
           log.Message "Update Workspace Found "
           strTCRemarks = strTCRemarks & "<br />" & "Update Workspace Found in Layout Workspace Viewer" 
        Else
          strTestCaseResult = "ABORT"
          Exit Sub  
        End If
        Call sEdgeProcessor  
      Next
     
      Call sCloseLayout
      Call sCloseLayout
    Else
      log.Message "RibbonWindow not found"
    End If

End Sub


Sub sCheckLayoutWorkspaceVwrLayout(strParameters)

On Error Resume Next 
    Dim strLevel1layout,strLevel2layout,strLevel3layout,strWrkSpaceName
    Dim objNewWrkSpace_okbtn,objNewWrkSpace_Name
    Dim objNewWrkSpace_Txtbox,objopenforEdit,objWrkspace_popup
    Dim strTemp,objTemp,intRow,barManager,intTotNodeCnt,Text,objCellText,intI,intK,strDesc1,strDesc2,intJ
    Dim objWrkSpace,objwrkspacepop,objwrkspcUpload,objConfirm,objGridCell,DescLocalText,intSeriesID,GridControl,GridSourceTree
'
    strLevel1layout=getSplitValue(strParameters,"LEVEL1LAYOUT")
    strLevel2layout=getSplitValue(strParameters,"LEVEL2LAYOUT")
    strLevel3layout=getSplitValue(strParameters,"LEVEL3LAYOUT")

'
'    strLevel1layout="dX Non-Asia Database (Current Eng Version)"
'    strLevel2layout="Z-Topic Test(IT-use only)"
''    strLevel3layout="Poo Benchmark"
'    strLevel3layout="Automation"
'    intSeriesID=0

    strDesc1=aqDateTime.Now
    strDesc2=aqDateTime.Now
    DescText=Replace(strDesc1,"/","-")
    DescText=Replace(DescText,":","_")
    DescLocalText=DescText
    strWrkSpaceName=DescText
     
    if intSeriesID=0 then
      Call sLayoutseries
      intSeriesID=strLayoutFileText
    End if 

    Delay 3000,"Please Wait..."

    ''Setting grid Objects

    strTemp="WPFObject(""LayoutTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""LayoutTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    
    Delay 10000,"Please Wait..."
    ''Selecting Level1 layout
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strLevel1layout) then
          GridControl.Nodes_2.Item(intI).Expand(True)
          log.Message "Level 1 Layout - " & GridControl.Nodes_2.Item(intI).Content.Description       
          blnFlag=False  
          Exit For
        End If
    Next
'    Delay 3000,"Please Wait..."
    If blnFlag = True then
      strTCRemarks="Level 1 Layout not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
  
    Delay 10000,"Please Wait..."
    blnFlag = True 
    ''Selecting Level2 Layout
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
    For intJ=0 to intTotNodeCnt-1
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strLevel2layout) then
        GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
        log.Message "Level2 layout Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
        blnFlag = False 
        Exit For
      End If
    Next
    If blnFlag = True then
      strTCRemarks="Level2 Source Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If

    Delay 10000,"Please Wait..."
    blnFlag = True    
    ''Selecting Level3 Layout
      intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count
      For intK=0 to intTotNodeCnt-1
        If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description)=Ucase(strLevel3layout) then
          GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Expand(True)
          intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).get_RowHandle
            Call GridControl.ClearSelectionCore
            Call GridControl.FocusViewAndRow(GridControl,intRow)
            GridControl.SetFocusOnCurrentItem
            Call GridControl.SelectRowCore(intRow)
          log.Message "Level3 layout Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description
          blnFlag = False
          Exit For   
        End If 
      Next
      If blnFlag = True then
        strTCRemarks="Level3 Source Name not found"
        strTestCaseResult="FAIL"
        Exit Sub
      End If
      Call sCheckLayoutModule(strParameters)
      ''Clicking on "New Workspace" Button and selecting "Open for Edit(Souce)" option   
      strTemp="WPFObject(""ArrowControl"", """", 1)"
      Set objNewWorkspace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarSubItemLinkControl", "", 1).FindChild("Name",strTemp,2,True)
      If objNewWorkspace.Exists = True then
          objNewWorkspace.Click
          strTemp="WPFObject(""BarPopupBorderControl"", """", 1)"
          Set objWrkspace_popup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").FindChild("Name",strTemp,5,True)
          If objWrkspace_popup.Exists = True then
            strTemp="WPFObject(""ContentControlEx"", ""Open For Edit"", 2)"
            Set objopenforEdit=objWrkspace_popup.FindChild("Name",strTemp,8,True)
            If objopenforEdit.Exists then
              objopenforEdit.Click    
              'Delay 30000,"Please Wait..."
            End If
          End If
      
          strTemp1="WPFObject(""HwndSource: WorkspaceNamePrompt"", ""Please provide a new Workspace Name"")"
          Set objNewWrkSpaceName=Sys.Process("EdgeClient").WaitChild(strTemp1,80000)
          If objNewWrkSpaceName.Exists = True then
            ''Waiting for Workspace Name prompt
            strTemp="WPFObject(""FloatingContainerBorder"")"
            Set objNewWrkSpace_Name=Sys.Process("EdgeClient").WPFObject("HwndSource: WorkspaceNamePrompt", "Please provide a new Workspace Name").WPFObject("WorkspaceNamePrompt", "Please provide a new Workspace Name", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,1500000)
            If objNewWrkSpace_Name.Exists = True then
              strTemp="WPFObject(""ChangeNameTextEdit"")"
              ''Entering Workspace Name
              Set objNewWrkSpace_Txtbox=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
                'Delay 30000,"Please Wait..."
                If objNewWrkSpace_Txtbox.Exists = True then
                  objNewWrkSpace_Txtbox.Click
                  objNewWrkSpace_Txtbox.Text=strWrkSpaceName
                  ''Clicking on Ok Button 
                  strTemp="WPFObject(""OkButton"")"
                  Set objNewWrkSpace_okbtn=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
                  If objNewWrkSpace_okbtn.Exists = True then
                    objNewWrkSpace_okbtn.Click
                    Call sEdgeProcessor
                  End If
                 End If
            End If
          End if 
    End If

    Call sCloseLayout
    Call sCloseLayout
End Sub

Sub sCheckLayoutWorkSpacevwrUpdateWrk()

    Dim strObject,objEdgeMDI,strTemp,objTemp,GridControl,intRowcnt,intI,intRow
    Dim i,objText
    
On Error Resume Next

    strObject = "WPFObject(""HwndSource: RibbonWindow"")"
    Set objEdgeMDI = Sys.Process("EdgeClient").WaitChild(strObject, 600000)
    If objEdgeMDI.Exists then
      strTemp="WPFObject(""TextBlock"", ""Layout"", 1)"
      Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,14,True)
      If objTemp.Exists = False then
        strTemp="WPFObject(""ContentControl"", ""Layout Workspace"", 1)"
        Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).FindChild("Name",strTemp,16,True)
        If objTemp.Exists = True then
          objTemp.Click
        End If
        Call sEdgeProcessor
        log.Message "Opening Layout Workspace.."
      Else
        log.Message "Layout Workspace is opened"
      End If
  
      ''Selecting Records
      strTemp="WPFObject(""PendingChangeGridControl"")"
      Set GridControl=Sys.Process("EdgeClient").FindChild("Name",strTemp,60,True)
      intRowcnt=GridControl.wRowCount
      'For intI=0 to intRowcnt-1
        intRow=GridControl.FindRow(1,"Workspace Name")
        Call GridControl.ClickCell(0,1)
      'Next 
      
    Else
      log.Message "RibbonWindow not found"
    End If
    
     strTemp="WPFObject(""ContentControlEx"", ""Upload Workspace"", 2)"
     Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 2).WPFObject("BarButtonItemLinkControl", "", 1).FindChild("Name",strTemp,16,True)
      If objTemp.Exists = True then
        objTemp.Click
      End If 
      
     strTemp="WPFObject(""PART_ContainerContent"")"
        'Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: WindowContentHolder", "Please Confirm.").FindChild("Name",strTemp,50,True)
        Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "Please Confirm.").WPFObject("CustomMessageBoxWindow", "Please Confirm.", 1).FindChild("Name",strTemp,50,True)
      If objConfirm.Exists = True then
        sys.Keys("Y")
      End if 
    
      strTemp="WPFObject(""PART_ContainerContent"")"
      Set objConfirm=Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "Upload Workspace").WPFObject("CustomMessageBoxWindow", "Upload Workspace", 1).FindChild("Name",strTemp,50,True)
'      strTemp="WPFObject(""DXMessageBox"", """", 1)"
'      Set objConfirm=objConfirm.WaitChild(strTemp,300000)
      If objConfirm.Exists = True then
        SYS.Keys "[Enter]"
      End if 
            
      strTCRemarks =  "No changes to upload in Layout"
      
       strTemp="WPFObject(""PendingChangeGridControl"")"
      Set GridControl=Sys.Process("EdgeClient").FindChild("Name",strTemp,60,True)
      
      intRowcnt=GridControl.wRowCount
      For intI=0 to intRowcnt-1
        intRow=GridControl.FindRow(1,"Workspace Name")
        Call GridControl.ClickCell(intI,1)
        strTemp="WPFObject(""ContentControlEx"", ""Drop"", 2)"
        Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,20,True)
        If objTemp.Exists = True then
          objTemp.Click
        End If
        strTemp="WPFObject(""PART_ContainerContent"")"
        Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "Please Confirm.").FindChild("Name",strTemp,50,True)
'        strTemp="WPFObject(""DXMessageBox"", """", 1)"
'        Set objTemp=objTemp.WaitChild(strTemp,50000)
        If objTemp.Exists = True then
          Sys.Keys "Y"
         ' strTCRemarks = "Dropped Workspace Successfully" 
          Call sEdgeProcessor
        End If
        Call sCloseLayout
         exit Sub 
      Next


End Sub

Sub sCheckLayoutWorkSpaceVwrOpenReSWorkspace()
On Error Resume Next

    Dim strObject,objEdgeMDI,strTemp,objTemp,GridControl,intRowcnt,intI,intRow

    strObject = "WPFObject(""HwndSource: RibbonWindow"")"
    Set objEdgeMDI = Sys.Process("EdgeClient").WaitChild(strObject, 600000)
    If objEdgeMDI.Exists then
      strTemp="WPFObject(""TextBlock"", ""Layout"", 1)"
      Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,14,True)
      If objTemp.Exists = False then
        strTemp="WPFObject(""ContentControl"", ""Layout Workspace"", 1)"
        Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).FindChild("Name",strTemp,16,True)
        If objTemp.Exists = True then
          objTemp.Click
        End If
        Call sEdgeProcessor
        log.Message "Opening Layout Workspace.."
      Else
        log.Message "Layout Workspace is opened"
      End If
  
      ''Selecting Records
      strTemp="WPFObject(""PendingChangeGridControl"")"
      Set GridControl=Sys.Process("EdgeClient").FindChild("Name",strTemp,60,True)
      
      intRowcnt=GridControl.wRowCount
      For intI=0 to intRowcnt-1
        intRow=GridControl.FindRow(1,"Workspace Name")
        Call GridControl.ClickCell(intI,1)
        strTemp="WPFObject(""ContentControlEx"", ""Open Workspace"", 2)"
        Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,20,True)
        If objTemp.Exists = True then
          If objTemp.Enabled = True then
            objTemp.Click
            Call sEdgeProcessor
            log.Message "Opened Workspace Successfully"
            strTCRemarks = "Opened Workspace Successfully" 
            Exit For 
          End if
        End If     
      Next
      strTemp="WPFObject(""PendingChangeGridControl"")"
      Set GridControl=Sys.Process("EdgeClient").FindChild("Name",strTemp,60,True)
      
      intRowcnt=GridControl.wRowCount
      For intI=0 to intRowcnt-1
        intRow=GridControl.FindRow(1,"Workspace Name")
        Call GridControl.ClickCell(0, "Owner")
        Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("PopupBorderControl", "", 1).WPFObject("PopupContentContainer", "", 1).WPFObject("NonLogicalDecorator", "", 1).WPFObject("PopupContentControl", "", 1).WPFObject("ComboBoxEditItem", "", 14).WPFObject("TextBlock", "Sharadhi Desai", 1).Click
        strTemp="WPFObject(""PART_ContainerContent"")"
        Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: WindowContentHolder", "Change Ownership").WPFObject("WindowContentHolder", "Change Ownership", 1).FindChild("Name",strTemp,50,True)
        strTemp="WPFObject(""DXMessageBox"", """", 1)"
        Set objTemp=objTemp.WaitChild(strTemp,50000)
        If objTemp.Exists = True then
          Sys.Keys "Y"
          Call sEdgeProcessor
          
          strTemp="WPFObject(""PART_ContainerContent"")"
          Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: WindowContentHolder", "Change Ownership").WPFObject("WindowContentHolder", "Change Ownership", 1).FindChild("Name",strTemp,50,True)
          strTemp="WPFObject(""DXMessageBox"", """", 1)"
          Set objTemp=objTemp.WaitChild(strTemp,50000)
          If objTemp.Exists = True then
            SYS.Keys "[Enter]"
            Call sEdgeProcessor
          End if 
        End If  
      Next
      Call sCloseLayout
      Call sCloseLayout
    Else
      log.Message "RibbonWindow not found"
    End If

End Sub

Sub sCheckLayoutWorkSpaceVwrReSWorkspace()
On Error Resume Next

    Dim strObject,objEdgeMDI,strTemp,objTemp,GridControl,intRowcnt,intI,intRow

    strObject = "WPFObject(""HwndSource: RibbonWindow"")"
    Set objEdgeMDI = Sys.Process("EdgeClient").WaitChild(strObject, 600000)
    If objEdgeMDI.Exists then
      strTemp="WPFObject(""TextBlock"", ""Layout"", 1)"
      Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,14,True)
      If objTemp.Exists = False then
        strTemp="WPFObject(""ContentControl"", ""Layout Workspace"", 1)"
        Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).FindChild("Name",strTemp,16,True)
        If objTemp.Exists = True then
          objTemp.Click
        End If
        Call sEdgeProcessor
        log.Message "Opening Layout Workspace.."
      Else
        log.Message "Layout Workspace is opened"
      End If
  
      strTemp="WPFObject(""PendingChangeGridControl"")"
      Set GridControl=Sys.Process("EdgeClient").FindChild("Name",strTemp,60,True)
      
      intRowcnt=GridControl.wRowCount
      For intI=0 to intRowcnt-1
        intRow=GridControl.FindRow(1,"Workspace Name")
        Call GridControl.ClickCell(0, "Owner")
       ' Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("PopupBorderControl", "", 1).WPFObject("PopupContentContainer", "", 1).WPFObject("NonLogicalDecorator", "", 1).WPFObject("PopupContentControl", "", 1).WPFObject("ComboBoxEditItem", "", 14).WPFObject("TextBlock", "Sharadhi Desai", 1).Click
        Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("PopupBorderControl", "", 1).WPFObject("PopupContentContainer", "", 1).WPFObject("NonLogicalDecorator", "", 1).WPFObject("PopupContentControl", "", 1).WPFObject("ComboBoxEditItem", "", 2).WPFObject("TextBlock", "ganesh maduru", 1).Click
        strTemp="WPFObject(""PART_ContainerContent"")"
        Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: WindowContentHolder", "Change Ownership").WPFObject("WindowContentHolder", "Change Ownership", 1).FindChild("Name",strTemp,50,True)
        strTemp="WPFObject(""DXMessageBox"", """", 1)"
        Set objTemp=objTemp.WaitChild(strTemp,50000)
        If objTemp.Exists = True then
          objTemp.Keys "N"
        End If  
      Next
      Call sCloseLayout
    Else
      log.Message "RibbonWindow not found"
    End If

End Sub


Sub sCheckLayoutWorkspaceVwrCheckOtherOwner()
On Error Resume Next

  Dim objEdge,strTemp,objTemp,objEdgeTree,strLayoutHeader,GridControl,GridSourceTree,intTotNodeCnt,intI
  Dim nonLogicalAdornerDecorator,stackPanel,comboBox,edgeClient
   
  Dim strObject,objEdgeMDI,intRowcnt,intRow

    strObject = "WPFObject(""HwndSource: RibbonWindow"")"
    Set objEdgeMDI = Sys.Process("EdgeClient").WaitChild(strObject, 600000)
    If objEdgeMDI.Exists then
      strTemp="WPFObject(""TextBlock"", ""Layout"", 1)"
      Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,14,True)
      If objTemp.Exists = False then
        strTemp="WPFObject(""ContentControl"", ""Layout Workspace"", 1)"
        Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).FindChild("Name",strTemp,16,True)
        If objTemp.Exists = True then
          objTemp.Click
        End If
        Call sEdgeProcessor
        log.Message "Opening Layout Workspace.."
      Else
        log.Message "Layout Workspace is opened"
      End If          
              set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1)            
              strTemp="WPFObject(""LayoutPanel"", """", 1)"
              Set objTemp=objEdge.FindChild("Name",strTemp,50)
              If objTemp.Exists=True then
                strTCRemarks = "Layout grid found in Layout workspace view"
                log.Message "Layout grid found in Layout"
   
                strTemp="WPFObject(""ContentControlEx"", ""Show Search Filter"", 2)"
                Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,20,True)
                If objTemp.Exists = True then
                  if objTemp.Enabled=True then
                    log.Message "Show Search Filter button Enabled in Layout"
                    Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 4).WPFObject("BarCheckItemLinkControl", "", 1).WPFObject("ContentControlEx", "Show Search Filter", 2).Click
                    Delay(5000)
        
                    strTCRemarks = "Clicked Show Search Filter button in Layout workspace Viewer"
                     strTemp="WPFObject(""Border"", """", 1)"
                    Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).FindChild("Name",strTemp,20,True)
                    If objTemp.Exists = True then
            '           
            '            Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Border", "", 1).WPFObject("SearchGrid").WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 2).WPFObject("ComboBox", "", 1).Click
           
            '            Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("ComboBoxItem", "", 1).WPFObject("StackPanel", "", 1).WPFObject("CheckBox", "", 1).Click
            '            strTCRemarks = strTCRemarks & "<br />" & "Checked all the option in CreatedBy Dropdown"
                        Set edgeClient =  Aliases.EdgeClient
                        'Set stackPanel = edgeClient.HwndSource_RibbonWindow.RibbonWindow.ContentControl.Grid.Grid.ContentControl.Grid.ContentControl.PART_ContainerContent.BarManager.DockPanel.DockLayoutManager.LayoutGroup.LayoutPanel.Root.AdornerDecorator.AdornedControl.Grid.BarManager.DockPanel.Border.SearchGrid.StackPanel
                        'set comboBox = stackPanel.StackPanel2.ComboboxOwner
                        
                        'Set edgeClient = Sys.Process("EdgeClient")
                        Set stackPanel = Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Border", "", 1).WPFObject("SearchGrid").WPFObject("StackPanel", "", 1)
                        set comboBox = stackPanel.WPFObject("StackPanel", "", 2).WPFObject("ComboBox", "", 1)
                        Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Border", "", 1).WPFObject("SearchGrid").WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 3).WPFObject("ComboBox", "", 1).DropDown
                        Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Border", "", 1).WPFObject("SearchGrid").WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 3).WPFObject("ComboBox", "", 1).CloseUp
                        Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Border", "", 1).WPFObject("SearchGrid").WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 3).WPFObject("ComboBox", "", 1).DropDown
            '            comboBox.DropDown
            '            comboBox.CloseUp
            '            comboBox.DropDown
            '            Set nonLogicalAdornerDecorator = edgeClient.HwndSource_PopupRoot.PopupRoot.Decorator.NonLogicalAdornerDecorator
            '            Call nonLogicalAdornerDecorator.ComboboxitemEdgeclientModulesInfrastructur2.StackPanel.CheckBox.ClickButton(cbUnChecked)
            '            Call nonLogicalAdornerDecorator.ComboboxitemEdgeclientModulesInfrastructur3.StackPanel.CheckBox.ClickButton(cbChecked)
           
                       'Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("ComboBoxItem", "", 198).WPFObject("StackPanel", "", 1).WPFObject("TextBlock", "CDM test account", 1).Click
                       Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("ComboBoxItem", "", 2).WPFObject("StackPanel", "", 1).WPFObject("CheckBox", "", 1).Click
                       'Combo values for Poo
                       'Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("ComboBoxItem", "", 184).WPFObject("StackPanel", "", 1).WPFObject("CheckBox", "", 1).Click
                       Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("ComboBoxItem", "", 198).WPFObject("StackPanel", "", 1).WPFObject("CheckBox", "", 1).Click
                       Delay(36000)
           
                        strTemp="WPFObject(""Button"", ""Apply Filter"", 1)"
                        Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Border", "", 1).WPFObject("SearchGrid").WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 6).FindChild("Name",strTemp,20,True)
                        If objTemp.Exists = True then
                         Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Border", "", 1).WPFObject("SearchGrid").WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 6).WPFObject("Button", "Apply Filter", 1).Click
                          Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Border", "", 1).WPFObject("SearchGrid").WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 6).WPFObject("Button", "Apply Filter", 1).Click
                          log.Message "Apply Filter button is Clicked in Layout workspace Viewer"
                        End if 
            '            
                      strTCRemarks = strTCRemarks & "<br />" & "Displayed only Selected User Workspace" 
          
    
  
                  ''Selecting Records
                  strTemp="WPFObject(""PendingChangeGridControl"")"
                  Set GridControl=Sys.Process("EdgeClient").FindChild("Name",strTemp,60,True)
      
                  intRowcnt=GridControl.wRowCount
                  For intI=0 to intRowcnt-1
                    intRow=GridControl.FindRow(1,"Workspace Name")
                    Call GridControl.ClickCell(intI,1)
                    
                    Dim objEdgeFilter
                     strTemp="WPFObject(""ContentControlEx"", ""Drop"", 2)"
                      Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,20,True)
                      If objTemp.Exists = True then
                      If objTemp.Enabled = TRUE then
                        strTCRemarks = "Dropped Workspace button is Enabled" 
                      Else
                        log.Message "Dropped Workspace button is disabled"
                        strTCRemarks = "Dropped Workspace button is Disabled" 
                      End if 
                    End if 
                    
                   strTemp="WPFObject(""ContentControlEx"", ""Open Workspace"", 2)"
                  Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,20,True)
                  If objTemp.Exists = True then
                     If objTemp.Enabled = False then
                      strTCRemarks = "Open Workspace button is disabled"
                      log.Message "Open Workspace button is disabled"
                     End if 
                  End If
        
                  strTemp="WPFObject(""ContentControlEx"", ""Upload Workspace"", 2)"
                  Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,20,True)
                  If objTemp.Exists = True then
                     If objTemp.Enabled = False then
                      strTCRemarks = strTCRemarks & "<br />" & "Update Workspace button is disabled"
                      log.Message "Update Workspace button is disabled"
                     End if 
                  End If
       
                    
                  Next
   

          
          'Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("PendingChangeGridControl").WPFObject("PendingChangeTableView")
           
           strTemp="WPFObject(""Button"", ""Reset Default"", 2)"
            Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Border", "", 1).WPFObject("SearchGrid").WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 6).FindChild("Name",strTemp,20,True)
            If objTemp.Exists = True then
              Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Border", "", 1).WPFObject("SearchGrid").WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 6).WPFObject("Button", "Reset Default", 2).Click
              log.Message "Apply Filter button is Clicked in Layout workspace Viewer"
              
              strTemp="WPFObject(""PART_ContainerContent"")"
            'Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: WindowContentHolder", "Please Confirm.").FindChild("Name",strTemp,50,True)
           Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "Please Confirm.").WPFObject("CustomMessageBoxWindow", "Please Confirm.", 1).FindChild("Name",strTemp,50,True)
              If strClose.Exists Then
                 SYS.Keys "[Enter]"
              End If              
            End if   
            
            strTemp="WPFObject(""Button"", ""Apply Filter"", 1)"
            Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Border", "", 1).WPFObject("SearchGrid").WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 6).FindChild("Name",strTemp,20,True)
            If objTemp.Exists = True then
             Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Border", "", 1).WPFObject("SearchGrid").WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 6).WPFObject("Button", "Apply Filter", 1).Click
              log.Message "Apply Filter button is Clicked in Layout workspace Viewer"
            End if                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
    
           Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 4).WPFObject("BarCheckItemLinkControl", "", 1).WPFObject("ContentControlEx", "Hide Search Filter", 2).Click
           Call sCloseLayout 
        End if
      Else
        strTCRemarks = "Show Search Filter button Disabled in Layout"
        log.Message "Show Search Filter button Disabled in Layout"
      End if 
    End If  
  End if 
  
   Else
      log.Message "RibbonWindow not found"
    End If
  End Sub  
  
  
Sub sCheckLayoutWorkspaceVwrRCCheckOtherOwner()
On Error Resume Next

  Dim objEdge,strTemp,objTemp,objEdgeTree,strLayoutHeader,GridControl,GridSourceTree,intTotNodeCnt,intI
  Dim nonLogicalAdornerDecorator,stackPanel,comboBox,edgeClient
   
  Dim strObject,objEdgeMDI,intRowcnt,intRow

    strObject = "WPFObject(""HwndSource: RibbonWindow"")"
    Set objEdgeMDI = Sys.Process("EdgeClient").WaitChild(strObject, 600000)
    If objEdgeMDI.Exists then
      strTemp="WPFObject(""TextBlock"", ""Layout"", 1)"
      Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,14,True)
      If objTemp.Exists = False then
        strTemp="WPFObject(""ContentControl"", ""Layout Workspace"", 1)"
        Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).FindChild("Name",strTemp,16,True)
        If objTemp.Exists = True then
          objTemp.Click
        End If
        Call sEdgeProcessor
        log.Message "Opening Layout Workspace.."
      Else
        log.Message "Layout Workspace is opened"
      End If          
              set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1)            
              strTemp="WPFObject(""LayoutPanel"", """", 1)"
              Set objTemp=objEdge.FindChild("Name",strTemp,50)
              If objTemp.Exists=True then
                strTCRemarks = "Layout grid found in Layout workspace view"
                log.Message "Layout grid found in Layout"
   
                strTemp="WPFObject(""ContentControlEx"", ""Show Search Filter"", 2)"
                Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,20,True)
                If objTemp.Exists = True then
                  if objTemp.Enabled=True then
                    log.Message "Show Search Filter button Enabled in Layout"
                    Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 4).WPFObject("BarCheckItemLinkControl", "", 1).WPFObject("ContentControlEx", "Show Search Filter", 2).Click
                    Delay(5000)
        
                    strTCRemarks = "Clicked Show Search Filter button in Layout workspace Viewer"
                     strTemp="WPFObject(""Border"", """", 1)"
                    Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).FindChild("Name",strTemp,20,True)
                    If objTemp.Exists = True then
                     '           
            '            Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Border", "", 1).WPFObject("SearchGrid").WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 2).WPFObject("ComboBox", "", 1).Click
           
            '            Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("ComboBoxItem", "", 1).WPFObject("StackPanel", "", 1).WPFObject("CheckBox", "", 1).Click
            '            strTCRemarks = strTCRemarks & "<br />" & "Checked all the option in CreatedBy Dropdown"
                        Set edgeClient =  Aliases.EdgeClient
                        'Set stackPanel = edgeClient.HwndSource_RibbonWindow.RibbonWindow.ContentControl.Grid.Grid.ContentControl.Grid.ContentControl.PART_ContainerContent.BarManager.DockPanel.DockLayoutManager.LayoutGroup.LayoutPanel.Root.AdornerDecorator.AdornedControl.Grid.BarManager.DockPanel.Border.SearchGrid.StackPanel
                        'set comboBox = stackPanel.StackPanel2.ComboboxOwner
                        
                        'Set edgeClient = Sys.Process("EdgeClient")
                        Set stackPanel = Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Border", "", 1).WPFObject("SearchGrid").WPFObject("StackPanel", "", 1)
                        set comboBox = stackPanel.WPFObject("StackPanel", "", 2).WPFObject("ComboBox", "", 1)
                        Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Border", "", 1).WPFObject("SearchGrid").WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 3).WPFObject("ComboBox", "", 1).DropDown
                        Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Border", "", 1).WPFObject("SearchGrid").WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 3).WPFObject("ComboBox", "", 1).CloseUp
                        Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Border", "", 1).WPFObject("SearchGrid").WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 3).WPFObject("ComboBox", "", 1).DropDown
            '            comboBox.DropDown
            '            comboBox.CloseUp
            '            comboBox.DropDown
            '            Set nonLogicalAdornerDecorator = edgeClient.HwndSource_PopupRoot.PopupRoot.Decorator.NonLogicalAdornerDecorator
            '            Call nonLogicalAdornerDecorator.ComboboxitemEdgeclientModulesInfrastructur2.StackPanel.CheckBox.ClickButton(cbUnChecked)
            '            Call nonLogicalAdornerDecorator.ComboboxitemEdgeclientModulesInfrastructur3.StackPanel.CheckBox.ClickButton(cbChecked)
           
                       'Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("ComboBoxItem", "", 198).WPFObject("StackPanel", "", 1).WPFObject("TextBlock", "CDM test account", 1).Click
                       Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("ComboBoxItem", "", 2).WPFObject("StackPanel", "", 1).WPFObject("CheckBox", "", 1).Click
                       'Combo values for Poo
                       'Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("ComboBoxItem", "", 184).WPFObject("StackPanel", "", 1).WPFObject("CheckBox", "", 1).Click
                       Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("ComboBoxItem", "", 198).WPFObject("StackPanel", "", 1).WPFObject("CheckBox", "", 1).Click
                       Delay(36000)
           
                        strTemp="WPFObject(""Button"", ""Apply Filter"", 1)"
                        Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Border", "", 1).WPFObject("SearchGrid").WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 6).FindChild("Name",strTemp,20,True)
                        If objTemp.Exists = True then
                         Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Border", "", 1).WPFObject("SearchGrid").WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 6).WPFObject("Button", "Apply Filter", 1).Click
                          Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Border", "", 1).WPFObject("SearchGrid").WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 6).WPFObject("Button", "Apply Filter", 1).Click
                          log.Message "Apply Filter button is Clicked in Layout workspace Viewer"
                        End if      
                      strTCRemarks = strTCRemarks & "<br />" & "Displayed only Selected User Workspace" 
          
                  ''Selecting Records
                  strTemp="WPFObject(""PendingChangeGridControl"")"
                  Set GridControl=Sys.Process("EdgeClient").FindChild("Name",strTemp,60,True)
      
                  intRowcnt=GridControl.wRowCount
                  For intI=0 to intRowcnt-1
                    intRow=GridControl.FindRow(1,"Workspace Name")
                    Call GridControl.ClickCell(intI,1)
                    Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("PendingChangeGridControl").WPFObject("PendingChangeTableView").WPFObject("HierarchyPanel", "", 1).WPFObject("RowControl", "", 1).WPFObject("CellsControl", "", 1).WPFObject("LightweightCellEditor", "", 1).WPFObject("InplaceBaseEdit", "", 1).ClickR
                    Delay (5000)
                    Dim objEdgeFilter
                    set objEdgeFilter= Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 3).WPFObject("BarButtonItemLinkControl", "", 1)
                    strTemp="WPFObject(""ContentControlEx"", ""Drop"", 2)"
                    Set objTemp=objEdgeFilter.FindChild("Name",strTemp,50)
                    If objTemp.Exists = TRUE then
                      If objTemp.Enabled = TRUE then
                        strTCRemarks = "Dropped Workspace button is Enabled" 
                      Else
                        log.Message "Dropped Workspace button is disabled"
                        strTCRemarks = "Dropped Workspace button is Disabled" 
                      End if 
                    End if 
                    
                  set objEdgeFilter= Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "", 1).WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarButtonItemLinkControl", "", 1)
                  strTemp="WPFObject(""ContentControlEx"", ""Open Workspace"", 2)"
                  Set objTemp=objEdgeFilter.FindChild("Name",strTemp,50)
                  If objTemp.Exists = TRUE then
                    If objTemp.Enabled = False then
                        strTCRemarks = "Open Workspace button is disabled"
                        log.Message "Open Workspace button is disabled"
                        strTCRemarks = strTCRemarks & "<br />" & "Open Workspace button is disabled"
                    Else
                        strTCRemarks = "Open Workspace button is Enabled"
                        log.Message "Open Workspace button is Enabled"
                        strTCRemarks = strTCRemarks & "<br />" & "Open Workspace button is Enabled"
                    End if 
                  Else
                    strTestCaseResult = "ABORT"
                    Exit Sub  
                  End If
        
                    set objEdgeFilter= Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 2).WPFObject("BarButtonItemLinkControl", "", 1)
                    strTemp="WPFObject(""ContentControlEx"", ""Upload Workspace"", 2)"
                    Set objTemp=objEdgeFilter.FindChild("Name",strTemp,50)
                    If objTemp.Exists = TRUE then
                       If objTemp.Enabled = False then
                        strTCRemarks = strTCRemarks & "<br />" & "Update Workspace button is disabled"
                        log.Message "Update Workspace button is disabled"
                       Else
                        strTCRemarks = strTCRemarks & "<br />" & "Update Workspace button is Enabled"
                        log.Message "Update Workspace button is Enabled"
                       End if 
                    End If     
                  Next
          
           strTemp="WPFObject(""Button"", ""Reset Default"", 2)"
            Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Border", "", 1).WPFObject("SearchGrid").WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 6).FindChild("Name",strTemp,20,True)
            If objTemp.Exists = True then
              Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Border", "", 1).WPFObject("SearchGrid").WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 6).WPFObject("Button", "Reset Default", 2).Click
              log.Message "Apply Filter button is Clicked in Layout workspace Viewer"
              
              strTemp="WPFObject(""PART_ContainerContent"")"
        'Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: WindowContentHolder", "Please Confirm.").FindChild("Name",strTemp,50,True)
        Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "Please Confirm.").WPFObject("CustomMessageBoxWindow", "Please Confirm.", 1).FindChild("Name",strTemp,50,True)
              If strClose.Exists Then
                 SYS.Keys "[Enter]"
              End If              
            End if   
            
            strTemp="WPFObject(""Button"", ""Apply Filter"", 1)"
            Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Border", "", 1).WPFObject("SearchGrid").WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 6).FindChild("Name",strTemp,20,True)
            If objTemp.Exists = True then
             Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Border", "", 1).WPFObject("SearchGrid").WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 6).WPFObject("Button", "Apply Filter", 1).Click
              log.Message "Apply Filter button is Clicked in Layout workspace Viewer"
            End if                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
           Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 4).WPFObject("BarCheckItemLinkControl", "", 1).WPFObject("ContentControlEx", "Hide Search Filter", 2).Click
            Call sCloseLayout
        End if
      Else
        strTCRemarks = "Show Search Filter button Disabled in Layout"
        log.Message "Show Search Filter button Disabled in Layout"
      End if 
    End If  
  End if 
  
   Else
      log.Message "RibbonWindow not found"
    End If
  End Sub  
  
  
  Sub sCheckLayoutWorkSpaceVwrOpenAndUpdateWorkspace(strParameters)
On Error Resume Next

    Dim strObject,objEdgeMDI,GridControl,intRowcnt,strUpdateDate
    Dim strLevel1layout,strLevel2layout,strLevel3layout,strWrkSpaceName
    Dim objNewWrkSpace_okbtn,objNewWrkSpace_Name
    Dim objNewWrkSpace_Txtbox,objopenforEdit,objWrkspace_popup
    Dim strTemp,objTemp,intRow,barManager,intTotNodeCnt,Text,objCellText,intI,intK,strDesc1,strDesc2
    Dim objWrkSpace,objwrkspacepop,objwrkspcUpload,objConfirm,objGridCell,DescLocalText,intSeriesID
    
    Call sLoadLayout
    Call sCheckLayoutWorkspaceVwrLayout(strParameters)

    strLevel1layout=getSplitValue(strParameters,"LEVEL1LAYOUT")
    strLevel2layout=getSplitValue(strParameters,"LEVEL2LAYOUT")
    strLevel3layout=getSplitValue(strParameters,"LEVEL3LAYOUT")


'    strLevel1layout="dX Non-Asia Database (Current Eng Version)"
'    strLevel2layout="Z-Topic Test(IT-use only)"
'    strLevel3layout="Automation_UIT4"


     strDesc1=aqDateTime.Now
    strDesc2=aqDateTime.Now
    DescText=Replace(strDesc1,"/","-")
    DescText=Replace(DescText,":","_")
    DescLocalText=DescText
    strWrkSpaceName=DescText
    
    strObject = "WPFObject(""HwndSource: RibbonWindow"")"
    Set objEdgeMDI = Sys.Process("EdgeClient").WaitChild(strObject, 600000)
    If objEdgeMDI.Exists then
      strTemp="WPFObject(""TextBlock"", ""Layout"", 1)"
      Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,14,True)
      If objTemp.Exists = False then
        strTemp="WPFObject(""ContentControl"", ""Layout Workspace"", 1)"
        Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).FindChild("Name",strTemp,16,True)
        If objTemp.Exists = True then
          objTemp.Click
        End If
        Call sEdgeProcessor
        log.Message "Opening Layout Workspace.."
        strTCRemarks ="Opening Layout Workspace.."
      Else
        log.Message "Layout Workspace is opened"
        strTCRemarks ="Layout Workspace is opened"
      End If
  
      ''Selecting Records
      strTemp="WPFObject(""PendingChangeGridControl"")"
      Set GridControl=Sys.Process("EdgeClient").FindChild("Name",strTemp,60,True)
      
      intRowcnt=GridControl.wRowCount
      For intI=0 to intRowcnt-1
        intRow=GridControl.FindRow(1,"Workspace Name")
        Call GridControl.ClickCell(intI,1)
        strUpdateDate=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("PendingChangeGridControl").WPFObject("PendingChangeTableView").WPFObject("HierarchyPanel", "", 1).WPFObject("RowControl", "", 1).WPFObject("CellsControl", "", 1).WPFObject("LightweightCellEditor", "", 5).WPFObject("InplaceBaseEdit", "", 1).DisplayText
        Log.Message("updated time: " & strUpdateDate)
        strTCRemarks = strTCRemarks & "  " & strUpdateDate & " - Updated date and time"
        strTemp="WPFObject(""ContentControlEx"", ""Open Workspace"", 2)"
        Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,20,True)
        If objTemp.Exists = True then
          If objTemp.Enabled = True then
            objTemp.Click
            Call sEdgeProcessor
            log.Message "Opened Workspace Successfully"
            strTCRemarks = "Opened Workspace Successfully"
                    
            Exit For  
          End if 
        End if 
      Next
              ''Handling Validation for Layout
            strTemp="WPFObject(""HwndSource: WindowContentHolder"", """")"
            Set objTemp=Sys.Process("EdgeClient").WaitChild(strTemp,20000)
            If objTemp.Exists = True then
              objTemp.Keys "[Enter]"
              strTestCaseResult = "FAIL"
              Exit Sub
            End If

    ''WorkSpace Edit Window
    strTemp="WPFObject(""LayoutPanel"", """", 2)"
    Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,13,True)
    If objTemp.Exists then
        Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("LayoutTreeListControl").WPFObject("LayoutTreeListView")
        Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("LayoutTreeListControl")

        ''Selecting Level1 layout
        intTotNodeCnt=GridControl.Nodes_2.Count
        For intI=0 to intTotNodeCnt-1         
            If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strLevel1layout) then
              GridControl.Nodes_2.Item(intI).Expand(True)
              log.Message "Level 1 Layout - " & GridControl.Nodes_2.Item(intI).Content.Description       
              blnFlag=False  
              Exit For
            End If
        Next
  
        blnFlag = True 
        ''Selecting Level2 Layout
        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
        For intJ=0 to intTotNodeCnt-1
          If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strLevel2layout) then
            GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
            log.Message "Level2 layout Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
            blnFlag = False 
            Exit For
          End If
        Next
   
        ''Selecting Level3 Layout
          intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count
          For intK=0 to intTotNodeCnt-1
            If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description)=Ucase(strLevel3layout) then
              GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Expand(True)
              intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).get_RowHandle
              GridControl.Keys "^[Home]"
              intRow=intRow+1
             Set objGridCell=GridControl.WPFObject("HierarchyPanel", "", 1).WPFObject("RowControl", "", 3).WPFObject("CellsControl", "", 1).WPFObject("LightweightCellEditor", "", 2).WPFObject("InplaceBaseEdit", "", 1)
              If objGridCell.Exists = True then
                objGridCell.Click
              End If
              log.Message "Level3 layout Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description
              blnFlag = False
              Exit For   
            End If 
          Next
  
          Call objGridCell.Keys("[PageDown]")
          Delay(5000)
          Call objGridCell.Keys("[Home][Enter]")
          Delay(5000)
          'Call objGridCell.DisplayText.Keys("ttt")
          
          
          'Getting no. of Rows under level 3
        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(0).Nodes.Count
        intl=intTotNodeCnt-1
        
        Set objCellText=Aliases.EdgeClient.HwndSource_RibbonWindow.RibbonWindow.ContentControl.Grid.Grid.ContentControl.Grid.ContentControl.PART_ContainerContent.BarManager.DockPanel.DockLayoutManager.LayoutGroup.LayoutPanel2.Root.BarManager.AdornerDecorator.AdornedControl.Grid.DockPanel.WPFObject("LayoutTreeListControl").WPFObject("LayoutTreeListView").Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Nodes.Item(intL)
          Call objCellText.Content.set_Description(DescText)    
          Call objCellText.Content.set_DescriptionLocal(DescLocalText)

'          Call objGridCell.Content.set_Description("TeTe")    
'          Call objGridCell.Content.set_DescriptionLocal("TeTe")
'          
        ''WorkSpace Edit Window
          Call sCloseLayout
        strTemp="WPFObject(""LayoutPanel"", """", 2)"
        Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,13,True)
        If objTemp.Exists then
            Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("LayoutTreeListControl").WPFObject("LayoutTreeListView")
            Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("LayoutTreeListControl")
            
                strTemp="WPFObject(""BarSubItemLinkControl"", """", 1)"
                Set objWrkSpace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 11).WaitChild(strTemp,10000)
                If objWrkSpace.Exists = True then
                  objWrkSpace.Click
                  strTemp="WPFObject(""BarPopupBorderControl"", """", 1)" 
                  Set objwrkspacepop=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1)
                  If objwrkspacepop.Exists = True then
                    strTemp="WPFObject(""ContentControlEx"", ""Save Workspace"", 2)"
                    set objwrkspcUpload=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarButtonItemLinkControl", "", 1).FindChild("Name",strTemp,5,True)
                    If objwrkspcUpload.Exists = True then
                      objwrkspcUpload.Click
                      'Delay 5000,"Pls Wait.."
                     strTemp="WPFObject(""PART_ContainerContent"")"
                     Set objConfirm=Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "Confirm save.").FindChild("Name",strTemp,50,True)

                      If objConfirm.Exists = True then
                        'objConfirm.Keys "[Enter]"
                        sys.Keys("Y")
                        'Delay 8000,"Saving..."
                        Set objConfirm = Sys.Process("EdgeClient")._
                            Waitchild("WPFObject(""HwndSource: CustomMessageBoxWindow"", """")",600000)._
                            Waitchild("WPFObject(""CustomMessageBoxWindow"", """", 1)",60000)._
                            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
                            Waitchild("WPFObject(""FloatingContainerBorder"")",60000)._
                            Waitchild("WPFObject(""FloatingContainerBackground"")",60000)._
                            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
                            Waitchild("WPFObject(""FloatingContainerBody"")",60000)._
                            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
                            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
                            Waitchild("WPFObject(""PART_ContainerContent"")",60000)
                        If objConfirm.Exists = True Then
                            objConfirm.Click
                            SYS.Keys "[Enter]"
                        End If
                      End If                            
                    End If
                  End If
                End If

          End if
        End If     

        Call sCloseLayout
        
        
        strObject = "WPFObject(""HwndSource: RibbonWindow"")"
        Set objEdgeMDI = Sys.Process("EdgeClient").WaitChild(strObject, 600000)
        If objEdgeMDI.Exists then
          strTemp="WPFObject(""TextBlock"", ""Layout"", 1)"
          Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,14,True)
          If objTemp.Exists = False then
            strTemp="WPFObject(""ContentControl"", ""Layout Workspace"", 1)"
            Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).FindChild("Name",strTemp,16,True)
            If objTemp.Exists = True then
              objTemp.Click
            End If
            Call sEdgeProcessor
            log.Message "Opening Layout Workspace.."
          Else
            log.Message "Layout Workspace is opened"
          End If
        Else
          log.Message "RibbonWindow not found"
        End If
        
        ''Selecting Records
      strTemp="WPFObject(""PendingChangeGridControl"")"
      Set GridControl=Sys.Process("EdgeClient").FindChild("Name",strTemp,60,True)
      
      intRowcnt=GridControl.wRowCount
      For intI=0 to intRowcnt-1
        intRow=GridControl.FindRow(1,"Workspace Name")
        Call GridControl.ClickCell(intI,1)
        strUpdateDate=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("PendingChangeGridControl").WPFObject("PendingChangeTableView").WPFObject("HierarchyPanel", "", 1).WPFObject("RowControl", "", 1).WPFObject("CellsControl", "", 1).WPFObject("LightweightCellEditor", "", 5).WPFObject("InplaceBaseEdit", "", 1).DisplayText
        Log.Message("updated time: " & strUpdateDate)
        strTCRemarks = strTCRemarks & "  " & strUpdateDate & " - Updated date and time successfully"
        
        Dim objEdgeFilter
         strTemp="WPFObject(""ContentControlEx"", ""Drop"", 2)"
          Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,20,True)
          If objTemp.Exists = True then
            If objTemp.Enabled = TRUE then
              objTemp.click
            End if 
           strTemp="WPFObject(""PART_ContainerContent"")"
        'Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: WindowContentHolder", "Please Confirm.").FindChild("Name",strTemp,50,True)
        Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "Please Confirm.").WPFObject("CustomMessageBoxWindow", "Please Confirm.", 1).FindChild("Name",strTemp,50,True)
            If objTemp.Exists = True then
              Sys.Keys "Y"
              strTCRemarks = "Dropped Workspace Successfully" 
              Call sEdgeProcessor
            End If
        End if 
      Next
         Call sCloseLayout
    Else
      log.Message "RibbonWindow not found"
    End If

End Sub

Sub sCheckLayoutWorkspaceVwrSelectedLayout(strParameters)

On Error Resume Next 
    Dim strLevel1layout,strLevel2layout,strLevel3layout,strWrkSpaceName
    Dim objNewWrkSpace_okbtn,objNewWrkSpace_Name
    Dim objNewWrkSpace_Txtbox,objopenforEdit,objWrkspace_popup
    Dim strTemp,objTemp,intRow,barManager,intTotNodeCnt,Text,objCellText,intl,intK,strDesc1,strDesc2
    Dim objWrkSpace,objwrkspacepop,objwrkspcUpload,objConfirm,objGridCell,DescLocalText,intSeriesID
'
    strLevel1layout=getSplitValue(strParameters,"LEVEL1LAYOUT")
    strLevel2layout=getSplitValue(strParameters,"LEVEL2LAYOUT")
    strLevel3layout=getSplitValue(strParameters,"LEVEL3LAYOUT")

'
'    strLevel1layout="dX Non-Asia Database (Current Eng Version)"
'    strLevel2layout="Z-Topic Test(IT-use only)"
''    strLevel3layout="Poo Benchmark"
'    strLevel3layout="Automation"
'    intSeriesID=0

    strDesc1=aqDateTime.Now
    strDesc2=aqDateTime.Now
    DescText=Replace(strDesc1,"/","-")
    DescText=Replace(DescText,":","_")
    DescLocalText=DescText
    strWrkSpaceName="S4"
     
    if intSeriesID=0 then
      Call sLayoutseries
      intSeriesID=strLayoutFileText
    End if 

    Delay 3000,"Please Wait..."

    ''Setting grid Objects

    strTemp="WPFObject(""LayoutTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""LayoutTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    
    Delay 2000,"Please Wait..."
    ''Selecting Level1 layout
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strLevel1layout) then
          GridControl.Nodes_2.Item(intI).Expand(True)
          log.Message "Level 1 Layout - " & GridControl.Nodes_2.Item(intI).Content.Description       
          blnFlag=False  
          Exit For
        End If
    Next
'    Delay 3000,"Please Wait..."
    If blnFlag = True then
      strTCRemarks="Level 1 Layout not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
  
    Delay 5000,"Please Wait..."
    blnFlag = True 
    ''Selecting Level2 Layout
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
    For intJ=0 to intTotNodeCnt-1
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strLevel2layout) then
        GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
        log.Message "Level2 layout Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
        blnFlag = False 
        Exit For
      End If
    Next
    If blnFlag = True then
      strTCRemarks="Level2 Source Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If

    Delay 5000,"Please Wait..."
    blnFlag = True    
    ''Selecting Level3 Layout
      intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count
      For intK=0 to intTotNodeCnt-1
        If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description)=Ucase(strLevel3layout) then
          GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Expand(True)
          intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).get_RowHandle
            Call GridControl.ClearSelectionCore
            Call GridControl.FocusViewAndRow(GridControl,intRow)
            GridControl.SetFocusOnCurrentItem
            Call GridControl.SelectRowCore(intRow)
          log.Message "Level3 layout Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description
          blnFlag = False
          Exit For   
        End If 
      Next
      If blnFlag = True then
        strTCRemarks="Level3 Source Name not found"
        strTestCaseResult="FAIL"
        Exit Sub
      End If
      Call sCheckLayoutModule(strParameters)
      ''Clicking on "New Workspace" Button and selecting "Open for Edit(Souce)" option   
      strTemp="WPFObject(""ArrowControl"", """", 1)"
      Set objNewWorkspace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarSubItemLinkControl", "", 1).FindChild("Name",strTemp,2,True)
      If objNewWorkspace.Exists = True then
          objNewWorkspace.Click
          strTemp="WPFObject(""BarPopupBorderControl"", """", 1)"
          Set objWrkspace_popup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").FindChild("Name",strTemp,5,True)
          If objWrkspace_popup.Exists = True then
            strTemp="WPFObject(""ContentControlEx"", ""Open For Edit"", 2)"
            Set objopenforEdit=objWrkspace_popup.FindChild("Name",strTemp,8,True)
            If objopenforEdit.Exists then
              objopenforEdit.Click    
              'Delay 30000,"Please Wait..."
            End If
          End If
      
          strTemp1="WPFObject(""HwndSource: WorkspaceNamePrompt"", ""Please provide a new Workspace Name"")"
          Set objNewWrkSpaceName=Sys.Process("EdgeClient").WaitChild(strTemp1,80000)
          If objNewWrkSpaceName.Exists = True then
            ''Waiting for Workspace Name prompt
            strTemp="WPFObject(""FloatingContainerBorder"")"
            Set objNewWrkSpace_Name=Sys.Process("EdgeClient").WPFObject("HwndSource: WorkspaceNamePrompt", "Please provide a new Workspace Name").WPFObject("WorkspaceNamePrompt", "Please provide a new Workspace Name", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,1500000)
            If objNewWrkSpace_Name.Exists = True then
              strTemp="WPFObject(""ChangeNameTextEdit"")"
              ''Entering Workspace Name
              Set objNewWrkSpace_Txtbox=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
                'Delay 30000,"Please Wait..."
                If objNewWrkSpace_Txtbox.Exists = True then
                  objNewWrkSpace_Txtbox.Click
                  objNewWrkSpace_Txtbox.Text=strWrkSpaceName
                  ''Clicking on Ok Button 
                  strTemp="WPFObject(""OkButton"")"
                  Set objNewWrkSpace_okbtn=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
                  If objNewWrkSpace_okbtn.Exists = True then
                    objNewWrkSpace_okbtn.Click
                    Call sEdgeProcessor
                  End If
                 End If
            End If
          End if 
    End If

    Call sCloseLayout
    Call sCloseLayout
End Sub


Sub sCheckLayoutWorkspaceVwrSaveLayout(strParameters)

On Error Resume Next 
    Dim strLevel1layout,strLevel2layout,strLevel3layout,strWrkSpaceName
    Dim objNewWrkSpace_okbtn,objNewWrkSpace_Name
    Dim objNewWrkSpace_Txtbox,objopenforEdit,objWrkspace_popup
    Dim strTemp,objTemp,intRow,barManager,intTotNodeCnt,Text,objCellText,intl,intK,strDesc1,strDesc2
    Dim objWrkSpace,objwrkspacepop,objwrkspcUpload,objConfirm,objGridCell,DescLocalText,intSeriesID

    strLevel1layout=getSplitValue(strParameters,"LEVEL1LAYOUT")
    strLevel2layout=getSplitValue(strParameters,"LEVEL2LAYOUT")
    strLevel3layout=getSplitValue(strParameters,"LEVEL3LAYOUT")


'    strLevel1layout="dX Non-Asia Database (Current Eng Version)"
'    strLevel2layout="Z-Testing Topic(IT-use only)"
'    strLevel3layout="Poo Benchmark"
'    'strLevel3layout="Automation"
'    intSeriesID=0

    strDesc1=aqDateTime.Now
    strDesc2=aqDateTime.Now
    DescText=Replace(strDesc1,"/","-")
    DescText=Replace(DescText,":","_")
    DescLocalText=DescText
    strWrkSpaceName=DescText
     
    Delay 3000,"Please Wait..."

    ''Setting grid Objects

    strTemp="WPFObject(""LayoutTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""LayoutTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    
    Delay 10000,"Please Wait..."
    ''Selecting Level1 layout
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strLevel1layout) then
          GridControl.Nodes_2.Item(intI).Expand(True)
          log.Message "Level 1 Layout - " & GridControl.Nodes_2.Item(intI).Content.Description       
          blnFlag=False  
          Exit For
        End If
    Next
'    Delay 3000,"Please Wait..."
    If blnFlag = True then
      strTCRemarks="Level 1 Layout not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
  
    Delay 10000,"Please Wait..."
    blnFlag = True 
    ''Selecting Level2 Layout
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
    For intJ=0 to intTotNodeCnt-1
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strLevel2layout) then
        GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
        log.Message "Level2 layout Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
        blnFlag = False 
        Exit For
      End If
    Next
    If blnFlag = True then
      strTCRemarks="Level2 Source Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If

    Delay 10000,"Please Wait..."
    blnFlag = True    
    ''Selecting Level3 Layout
      intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count
      For intK=0 to intTotNodeCnt-1
        If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description)=Ucase(strLevel3layout) then
          GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Expand(True)
          intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).get_RowHandle
            Call GridControl.ClearSelectionCore
            Call GridControl.FocusViewAndRow(GridControl,intRow)
            GridControl.SetFocusOnCurrentItem
            Call GridControl.SelectRowCore(intRow)
          log.Message "Level3 layout Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description
          blnFlag = False
          Exit For   
        End If 
      Next
      If blnFlag = True then
        strTCRemarks="Level3 Source Name not found"
        strTestCaseResult="FAIL"
        Exit Sub
      End If
      Call sCheckLayoutModule(strParameters)
      ''Clicking on "New Workspace" Button and selecting "Open for Edit(Souce)" option   
      strTemp="WPFObject(""ArrowControl"", """", 1)"
      Set objNewWorkspace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarSubItemLinkControl", "", 1).FindChild("Name",strTemp,2,True)
      If objNewWorkspace.Exists = True then
          objNewWorkspace.Click
          strTemp="WPFObject(""BarPopupBorderControl"", """", 1)"
          Set objWrkspace_popup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").FindChild("Name",strTemp,5,True)
          If objWrkspace_popup.Exists = True then
            strTemp="WPFObject(""ContentControlEx"", ""Open For Edit"", 2)"
            Set objopenforEdit=objWrkspace_popup.FindChild("Name",strTemp,8,True)
            If objopenforEdit.Exists then
              objopenforEdit.Click    
              'Delay 30000,"Please Wait..."
            End If
          End If
      
          strTemp1="WPFObject(""HwndSource: WorkspaceNamePrompt"", ""Please provide a new Workspace Name"")"
          Set objNewWrkSpaceName=Sys.Process("EdgeClient").WaitChild(strTemp1,80000)
          If objNewWrkSpaceName.Exists = True then
            ''Waiting for Workspace Name prompt
            strTemp="WPFObject(""FloatingContainerBorder"")"
            Set objNewWrkSpace_Name=Sys.Process("EdgeClient").WPFObject("HwndSource: WorkspaceNamePrompt", "Please provide a new Workspace Name").WPFObject("WorkspaceNamePrompt", "Please provide a new Workspace Name", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,1500000)
            If objNewWrkSpace_Name.Exists = True then
              strTemp="WPFObject(""ChangeNameTextEdit"")"
              ''Entering Workspace Name
              Set objNewWrkSpace_Txtbox=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
                'Delay 30000,"Please Wait..."
                If objNewWrkSpace_Txtbox.Exists = True then
                  objNewWrkSpace_Txtbox.Click
                  objNewWrkSpace_Txtbox.Text=strWrkSpaceName
                  ''Clicking on Ok Button 
                  strTemp="WPFObject(""OkButton"")"
                  Set objNewWrkSpace_okbtn=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
                  If objNewWrkSpace_okbtn.Exists = True then
                    objNewWrkSpace_okbtn.Click
                    'Delay 10000,"Please wait..."
                  End If
                 End If
            End If
          End if 
    End If

    ''Handling Validation for Layout
    strTemp="WPFObject(""HwndSource: WindowContentHolder"", """")"
    Set objTemp=Sys.Process("EdgeClient").WaitChild(strTemp,20000)
    If objTemp.Exists = True then
      objTemp.Keys "[Enter]"
      strTestCaseResult = "FAIL"
      Exit Sub
    End If

    ''WorkSpace Edit Window
    strTemp="WPFObject(""LayoutPanel"", """", 2)"
    Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,13,True)
    If objTemp.Exists then
        Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("LayoutTreeListControl").WPFObject("LayoutTreeListView")
        Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("LayoutTreeListControl")

        ''Selecting Level1 layout
        intTotNodeCnt=GridControl.Nodes_2.Count
        For intI=0 to intTotNodeCnt-1         
            If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strLevel1layout) then
              GridControl.Nodes_2.Item(intI).Expand(True)
              log.Message "Level 1 Layout - " & GridControl.Nodes_2.Item(intI).Content.Description       
              blnFlag=False  
              Exit For
            End If
        Next
  
        blnFlag = True 
        ''Selecting Level2 Layout
        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
        For intJ=0 to intTotNodeCnt-1
          If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strLevel2layout) then
            GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
            log.Message "Level2 layout Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
            blnFlag = False 
            Exit For
          End If
        Next
   
        ''Selecting Level3 Layout
          intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count
          For intK=0 to intTotNodeCnt-1
            If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description)=Ucase(strLevel3layout) then
              GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Expand(True)
              intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).get_RowHandle
              GridControl.Keys "^[Home]"
              intRow=intRow+1
             Set objGridCell=GridControl.WPFObject("HierarchyPanel", "", 1).WPFObject("RowControl", "", 3).WPFObject("CellsControl", "", 1).WPFObject("LightweightCellEditor", "", 2).WPFObject("InplaceBaseEdit", "", 1)
              If objGridCell.Exists = True then
                objGridCell.Click
              End If
              log.Message "Level3 layout Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description
              blnFlag = False
              Exit For   
            End If 
          Next
         
    
        ''Clicking on New Folder
        Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 4).WPFObject("BarButtonItemLinkControl", "", 1)
        If objTemp.Exists = True then  
          objTemp.Click  
          Call sEdgeProcessor
          Delay 1000,"New Folder..."
        End If
        
        Dim intRowCount
      
        ''Getting no. of Rows under level 3
        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(0).Nodes.Count
        intl=intTotNodeCnt-1
        intRowCount=intTotNodeCnt
       
        
        Set objCellText=Aliases.EdgeClient.HwndSource_RibbonWindow.RibbonWindow.ContentControl.Grid.Grid.ContentControl.Grid.ContentControl.PART_ContainerContent.BarManager.DockPanel.DockLayoutManager.LayoutGroup.LayoutPanel2.Root.BarManager.AdornerDecorator.AdornedControl.Grid.DockPanel.WPFObject("LayoutTreeListControl").WPFObject("LayoutTreeListView").Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Nodes.Item(intL)
          Call objCellText.Content.set_Description(DescText)    
          Call objCellText.Content.set_DescriptionLocal(DescLocalText)
          Call objCellText.Content.set_DisabledFlag(True)
          

         
        ''Attach Series
        strTemp="WPFObject(""ContentControlEx"", ""Attach Series"", 2)"
        Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").FindChild("Name",strTemp,15,True)
        If objTemp.Exists = True then
          objTemp.DblClick
          ''Entering Series      
          Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: LayoutSeriesPrompt", "Attach Layout Series").WPFObject("LayoutSeriesPrompt", "Attach Layout Series", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("SeriesIdTextEdit")
          If objTemp.Exists = True then 
              objTemp.Text=intSeriesID
            Delay(10000)
             ''Clicking on OK Button
             Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: LayoutSeriesPrompt", "Attach Layout Series").WPFObject("LayoutSeriesPrompt", "Attach Layout Series", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 1).WPFObject("OkButton")
             If objTemp.Exists = True then
                objTemp.Click
             End If
          End If            
        End If
      
      Delay 180000,"Pls Wait... Form is loading..."
      
      Call sCloseLayout
  
      Dim objSaveWrk,objWait 
       set objSaveWrk=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 11).WPFObject("BarSubItemLinkControl", "", 1)
      strTemp="WPFObject(""ContentControlEx"", ""Workspace"", 2)"
      Set objTemp=objSaveWrk.FindChild("Name",strTemp,50)
      objWait=1
    Do until objTemp.Enabled = true 
        If objWait < 20 Then
          Delay 1000,"Pls Wait... Form is loading..."
          objWait=objWait+1
        else
          Call SClosesource()
          Call SourceWorkSpacevwr()
          Exit Sub
        end if 
    Loop  
      
   
      
      ''Disable Flag
      Dim objAttGrid,objAttGridTree,intRowcnt,intAttRow,objAttCell,intR
      Set objAttGrid=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("LayoutSeriesViewControl").WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("LayoutSeriesGridControl")
      Delay 1000,"Pls Wait.."
      
''      intR=0
''      For intR=0 to 999
''        Delay(1000)
''        Call objAttGrid.ClickCell(intR, "Disabled Flag")
''    Next 
      GridControl.Keys "^[END]"
      GridControl.Click
      GridControl.Keys("[PageDown]")
  
      Delay (8000)
      strTemp="WPFObject(""PART_Editor"")"
      Delay (8000)
      
      
      Dim objEdge,objCaption,i,objText,j

      Set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1)
      objText = objEdge.FindAllChildren("ClrClassName","CheckBox", 50,True)
        For i=0 to ubound(objText)
          log.Message objText(i).FullName
          log.Message objText(i).Name
        Next          
      log.Message i
''      ''Set objCellText= Aliases.EdgeClient.HwndSource_RibbonWindow.RibbonWindow.ContentControl.Grid.Grid.ContentControl.Grid.ContentControl.PART_ContainerContent.BarManager.DockPanel.DockLayoutManager.LayoutGroup.LayoutPanel.Root.BarManager.AdornerDecorator.AdornedControl.Grid.DockPanel2.LayoutTreeListControl.LayoutTreeListView.FindChild("Name",strTemp,150,True)
''      Set objCellText= Aliases.EdgeClient.HwndSource_RibbonWindow.RibbonWindow.ContentControl.Grid.Grid.ContentControl.Grid.ContentControl.PART_ContainerContent.BarManager.DockPanel.DockLayoutManager.LayoutGroup.LayoutPanel.Root.BarManager.AdornerDecorator.AdornedControl.Grid.FindChild("Name",strTemp,150,True)
''      If objCellText.Exists = True then
''        Delay (10000)
''       '' Call Aliases.EdgeClient.HwndSource_RibbonWindow.RibbonWindow.ContentControl.Grid.Grid.ContentControl.Grid.ContentControl.PART_ContainerContent.BarManager.DockPanel.DockLayoutManager.LayoutGroup.LayoutPanel.Root.BarManager.AdornerDecorator.AdornedControl.Grid.DockPanel2.LayoutTreeListControl.LayoutTreeListView.HierarchyPanel.RowControl2.CellsControl.LightweightCellEditor2.PART_Editor.ClickButton(cbUnChecked)
        objText(i-1).Click
        'objText(1).ClickButton(cbUnChecked)
        Delay (10000)

    
      'Set objCellText= Aliases.EdgeClient.HwndSource_RibbonWindow.RibbonWindow.ContentControl.Grid.Grid.ContentControl.Grid.ContentControl.PART_ContainerContent.BarManager.DockPanel.DockLayoutManager.LayoutGroup.LayoutPanel.Root.BarManager.AdornerDecorator.AdornedControl.Grid.DockPanel2.LayoutTreeListControl.LayoutTreeListView.FindChild("Name",strTemp,150,True)
    '  If objCellText.Exists = True then
'        Call Aliases.EdgeClient.HwndSource_RibbonWindow.RibbonWindow.ContentControl.Grid.Grid.ContentControl.Grid.ContentControl.PART_ContainerContent.BarManager.DockPanel.DockLayoutManager.LayoutGroup.LayoutPanel.Root.BarManager.AdornerDecorator.AdornedControl.Grid.DockPanel2.LayoutTreeListControl.LayoutTreeListView.HierarchyPanel.RowControl2.CellsControl.LightweightCellEditor2.PART_Editor.Click
'        Delay (10000)
'        Call Aliases.EdgeClient.HwndSource_RibbonWindow.RibbonWindow.ContentControl.Grid.Grid.ContentControl.Grid.ContentControl.PART_ContainerContent.BarManager.DockPanel.DockLayoutManager.LayoutGroup.LayoutPanel.Root.BarManager.AdornerDecorator.AdornedControl.Grid.DockPanel2.LayoutTreeListControl.LayoutTreeListView.HierarchyPanel.RowControl2.CellsControl.LightweightCellEditor2.PART_Editor.ClickButton(cbChecked)
'        Delay (10000)
        objText(i-1).Click
        'objText(1).ClickButton(cbChecked)
        Delay (10000)
       
    '  End If 
      
'      Call objCellText.Content.set_DisabledFlag(False)
'      Delay 1000
'      Call objCellText.Content.set_DisabledFlag(True)
      'Aliases.EdgeClient.HwndSource_RibbonWindow.RibbonWindow.ContentControl.Grid.Grid.ContentControl.Grid.ContentControl.PART_ContainerContent.BarManager.DockPanel.DockLayoutManager.LayoutGroup.LayoutPanel.Root.BarManager.AdornerDecorator.AdornedControl.Grid.DockPanel2.LayoutTreeListControl.LayoutTreeListView.HierarchyPanel.RowControl3.CellsControl.LightweightCellEditor.RowData.Row.DisabledFlag=True
      'GridControl.Keys "^[End]"
     ' GridControl.Click
      ''Call sEdgeProcessor  
     ' SYS.Keys("[Up]")
      Call sEdgeProcessor  
    ''Uploading WorkSpace
    strTemp="WPFObject(""BarSubItemLinkControl"", """", 1)"
    Set objWrkSpace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 11).WaitChild(strTemp,10000)
    If objWrkSpace.Exists = True then
      objWrkSpace.Click
      strTemp="WPFObject(""BarPopupBorderControl"", """", 1)" 
      Set objwrkspacepop=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1)
      If objwrkspacepop.Exists = True then
        strTemp="WPFObject(""ContentControlEx"", ""Save Workspace"", 2)"
        set objwrkspcUpload=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarButtonItemLinkControl", "", 1).FindChild("Name",strTemp,5,True)
        If objwrkspcUpload.Exists = True then
          objwrkspcUpload.Click
          'Delay 5000,"Pls Wait.."
         strTemp="WPFObject(""PART_ContainerContent"")"
        Set objConfirm=Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "Confirm save.").FindChild("Name",strTemp,50,True)

          If objConfirm.Exists = True then
            'objConfirm.Keys "[Enter]"
            sys.Keys("Y")
            'Delay 8000,"Saving..."
            
           Set objConfirm = Sys.Process("EdgeClient")._
            Waitchild("WPFObject(""HwndSource: CustomMessageBoxWindow"", """")",600000)._
            Waitchild("WPFObject(""CustomMessageBoxWindow"", """", 1)",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""FloatingContainerBorder"")",60000)._
            Waitchild("WPFObject(""FloatingContainerBackground"")",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""FloatingContainerBody"")",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""PART_ContainerContent"")",60000)
            
            If objConfirm.Exists = True Then
                objConfirm.Click
                SYS.Keys "[Enter]"
            End If
            
            End If                            
          End If
        End If
      End If
    End If
 'End if
    Call sCloseLayout
End Sub

Sub sCheckLayoutWorkspaceVwrChangeOwner()
On Error Resume Next

  Dim strObject,objEdgeMDI,strTemp,objTemp,GridControl,intRowcnt,intI,intRow
    strObject = "WPFObject(""HwndSource: RibbonWindow"")"
    Set objEdgeMDI = Sys.Process("EdgeClient").WaitChild(strObject, 600000)
    If objEdgeMDI.Exists then
      strTemp="WPFObject(""TextBlock"", ""Layout"", 1)"
      Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,14,True)
      If objTemp.Exists = False then
        strTemp="WPFObject(""ContentControl"", ""Layout Workspace"", 1)"
        Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).FindChild("Name",strTemp,16,True)
        If objTemp.Exists = True then
          objTemp.Click
        End If
        Call sEdgeProcessor
        log.Message "Opening Layout Workspace.."
      Else
        log.Message "Layout Workspace is opened"
      End If

      strTemp="WPFObject(""PendingChangeGridControl"")"
      Set GridControl=Sys.Process("EdgeClient").FindChild("Name",strTemp,60,True)
      
      intRowcnt=GridControl.wRowCount
      For intI=0 to intRowcnt-1
        intRow=GridControl.FindRow(1,"Workspace Name")
'        GridControl.ClickRowIndicator(intI)
        Call GridControl.ClickCell(intI,1)
        Call GridControl.ClickCell(0, "Owner")
        Call  Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("PopupBorderControl", "", 1).WPFObject("PopupContentContainer", "", 1).WPFObject("NonLogicalDecorator", "", 1).WPFObject("PopupContentControl", "", 1).Drag(171, 188, -10, 13)
        Call  Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("PopupBorderControl", "", 1).WPFObject("PopupContentContainer", "", 1).WPFObject("NonLogicalDecorator", "", 1).WPFObject("PopupContentControl", "", 1).Drag(168, 185, -8, 27)
       ' SYS.Keys ("[Down]")
        Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("PopupBorderControl", "", 1).WPFObject("PopupContentContainer", "", 1).WPFObject("NonLogicalDecorator", "", 1).WPFObject("PopupContentControl", "", 1).WPFObject("ComboBoxEditItem", "", 9).WPFObject("TextBlock", "CDM test account", 1).Click
        strTemp="WPFObject(""PART_ContainerContent"")"
        Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: WindowContentHolder", "Change Ownership").WPFObject("WindowContentHolder", "Change Ownership", 1).FindChild("Name",strTemp,50,True)
        strTemp="WPFObject(""DXMessageBox"", """", 1)"
        Set objTemp=objTemp.WaitChild(strTemp,50000)
        If objTemp.Exists = True then
          objTemp.Keys "N"
          Call sEdgeProcessor
          Call sCloseLayout
        End If  
      Next
    Else
      log.Message "RibbonWindow not found"
    End If

  End Sub  
  
  
  Sub sCheckLayoutWorkspaceVwrChangeOtherOwner()
On Error Resume Next

  Dim strObject,objEdgeMDI,strTemp,objTemp,GridControl,intRowcnt,intI,intRow
    strObject = "WPFObject(""HwndSource: RibbonWindow"")"
    Set objEdgeMDI = Sys.Process("EdgeClient").WaitChild(strObject, 600000)
    If objEdgeMDI.Exists then
      strTemp="WPFObject(""TextBlock"", ""Layout"", 1)"
      Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,14,True)
      If objTemp.Exists = False then
        strTemp="WPFObject(""ContentControl"", ""Layout Workspace"", 1)"
        Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).FindChild("Name",strTemp,16,True)
        If objTemp.Exists = True then
          objTemp.Click
        End If
        Call sEdgeProcessor
        log.Message "Opening Layout Workspace.."
      Else
        log.Message "Layout Workspace is opened"
      End If

      strTemp="WPFObject(""PendingChangeGridControl"")"
      Set GridControl=Sys.Process("EdgeClient").FindChild("Name",strTemp,60,True)
      
      intRowcnt=GridControl.wRowCount
      For intI=0 to intRowcnt-1
        intRow=GridControl.FindRow(1,"Workspace Name")
'        GridControl.ClickRowIndicator(intI)
        Call GridControl.ClickCell(intI,1)
        Call GridControl.ClickCell(0, "Owner")
        Call  Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("PopupBorderControl", "", 1).WPFObject("PopupContentContainer", "", 1).WPFObject("NonLogicalDecorator", "", 1).WPFObject("PopupContentControl", "", 1).Drag(171, 188, -10, 13)
        Call  Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("PopupBorderControl", "", 1).WPFObject("PopupContentContainer", "", 1).WPFObject("NonLogicalDecorator", "", 1).WPFObject("PopupContentControl", "", 1).Drag(168, 185, -8, 27)
       ' Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("PopupBorderControl", "", 1).WPFObject("PopupContentContainer", "", 1).WPFObject("NonLogicalDecorator", "", 1).WPFObject("PopupContentControl", "", 1).WPFObject("ComboBoxEditItem", "", 24).WPFObject("TextBlock", "Poonguzhali Shanthamurthy", 1).Click
      
        Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("PopupBorderControl", "", 1).WPFObject("PopupContentContainer", "", 1).WPFObject("NonLogicalDecorator", "", 1).WPFObject("PopupContentControl", "", 1).WPFObject("ComboBoxEditItem", "", 9).WPFObject("TextBlock", "CDM test account", 1).Click
        strTemp="WPFObject(""PART_ContainerContent"")"
        Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: WindowContentHolder", "Change Ownership").WPFObject("WindowContentHolder", "Change Ownership", 1).FindChild("Name",strTemp,50,True)
        strTemp="WPFObject(""DXMessageBox"", """", 1)"
        Set objTemp=objTemp.WaitChild(strTemp,50000)
        If objTemp.Exists = True then
          objTemp.Keys "N"
          Call sEdgeProcessor
          
          strTemp="WPFObject(""PART_ContainerContent"")"
          Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: WindowContentHolder", "Change Ownership").WPFObject("WindowContentHolder", "Change Ownership", 1).FindChild("Name",strTemp,50,True)
          strTemp="WPFObject(""DXMessageBox"", """", 1)"
          Set objTemp=objTemp.WaitChild(strTemp,50000)
          If objTemp.Exists = True then
            SYS.Keys "[Enter]"
            Call sEdgeProcessor
          End if 
        End If  
      Next
    Else
      log.Message "RibbonWindow not found"
    End If

  End Sub  
  
  
  Sub sCheckLayoutWorkspaceVwrRefreshWorkspace()
On Error Resume Next

  Dim strObject,objEdgeMDI,strTemp,objTemp,GridControl,intRowcnt,intI,intRow
    strObject = "WPFObject(""HwndSource: RibbonWindow"")"
    Set objEdgeMDI = Sys.Process("EdgeClient").WaitChild(strObject, 600000)
    If objEdgeMDI.Exists then
      strTemp="WPFObject(""TextBlock"", ""Layout"", 1)"
      Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,14,True)
      If objTemp.Exists = False then
        strTemp="WPFObject(""ContentControl"", ""Layout Workspace"", 1)"
        Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).FindChild("Name",strTemp,16,True)
        If objTemp.Exists = True then
          objTemp.Click
        End If
        Call sEdgeProcessor
        log.Message "Opening Layout Workspace.."
      Else
        log.Message "Layout Workspace is opened"
      End If
    set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1)            
        strTemp="WPFObject(""LayoutPanel"", """", 1)"
        Set objTemp=objEdge.FindChild("Name",strTemp,50)
        If objTemp.Exists=True then
          strTCRemarks = "Layout workspace view found Grid found in Layout"
          log.Message "Layout grid found in Layout"
   
          strTemp="WPFObject(""ContentControlEx"", ""Refresh"", 2)"
          Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,20,True)
          If objTemp.Exists = True then
            if objTemp.Enabled=True then
              log.Message "Refresh button Enabled in Layout"
             ' objTemp.Click
             Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 5).WPFObject("BarButtonItemLinkControl", "", 1).WPFObject("ContentControlEx", "Refresh", 2).Click
               log.Message  "Refresh button is clicked in Layout"
               strTCRemarks = strTCRemarks & "<br />" &  "Refresh button is clicked in Layout"
               
            Else
              strTCRemarks = "Refresh button Disabled in Layout"
              log.Message "Refresh button Disabled in Layout"
            End if 
          End If  
        End if 
        
      Call sCloseLayout
    Else
      log.Message "RibbonWindow not found"
    End If

  End Sub  
  
  
  Sub sCheckOpenLayoutWorkSpacevwr()
On Error Resume Next

    Dim strObject,objEdgeMDI,strTemp,objTemp,GridControl,intRowcnt,intI,intRow

    strObject = "WPFObject(""HwndSource: RibbonWindow"")"
    Set objEdgeMDI = Sys.Process("EdgeClient").WaitChild(strObject, 600000)
    If objEdgeMDI.Exists then
      strTemp="WPFObject(""TextBlock"", ""Layout"", 1)"
      Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,14,True)
      If objTemp.Exists = False then
        strTemp="WPFObject(""ContentControl"", ""Layout Workspace"", 1)"
        Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).FindChild("Name",strTemp,16,True)
        If objTemp.Exists = True then
          objTemp.Click
        End If
        'Delay 8000,"Opening Layout Workspace.."
        Call sEdgeProcessor
        log.Message "Opening Layout Workspace.."
'        strTCRemarks="Opening Layout Workspace.."
      Else
        log.Message "Layout Workspace is opened"
    '    strTCRemarks="Layout Workspace is opened"
        'Exit Sub 
      End If
  
      ''Selecting Records
      'Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 1).WPFObject("PendingChangeGridControl")
      strTemp="WPFObject(""PendingChangeGridControl"")"
      Set GridControl=Sys.Process("EdgeClient").FindChild("Name",strTemp,60,True)
      
      intRowcnt=GridControl.wRowCount
      For intI=0 to intRowcnt-1
        intRow=GridControl.FindRow(1,"Workspace Name")
'        GridControl.ClickRowIndicator(intI)
        Call GridControl.ClickCell(intI,1)
        strTemp="WPFObject(""ContentControlEx"", ""Drop"", 2)"
        Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,20,True)
        If objTemp.Exists = True then
          objTemp.Click
        End If
       strTemp="WPFObject(""PART_ContainerContent"")"
              Set strOk=Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "Attention").WPFObject("CustomMessageBoxWindow", "Attention", 1).WaitChild(strTemp,850000)
        If objTemp.Exists = True then
          Sys.Keys "Y"
          'Delay 15000,"Pls Wait..."
          Call sEdgeProcessor
          'Call Aliases.EdgeClient.HwndSource_RibbonWindow.RibbonWindow.ContentControl.Grid.Grid.ContentControl.Grid.ContentControl.PART_ContainerContent.BarManager.DockPanel.DockLayoutManager.LayoutGroup.LayoutPanel.Click(1296, 11)
        End If
        Call sCloseLayout
        'Delay 10000,"Pls Wait.."
      Next
    Else
      log.Message "RibbonWindow not found"
    End If

End Sub


Sub sCheckLayoutSecondLExpand(strParameters)
  On Error Resume Next
    Dim objEdge,objEdgeFilter
    Dim strLevel1layout,strLevel2layout,strLevel3layout,strWrkSpaceName
    Dim objNewWrkSpace_okbtn,objNewWrkSpace_Name
    Dim objNewWrkSpace_Txtbox,objopenforEdit,objWrkspace_popup
    Dim strTemp,objTemp,intRow,barManager,intTotNodeCnt,Text,objCellText,intl,intK,strDesc1,strDesc2,intJ
    Dim objWrkSpace,objwrkspacepop,objwrkspcUpload,objConfirm,objGridCell,DescLocalText,intSeriesID

    call sLoadlayout
    strLevel1layout=getSplitValue(strParameters,"LEVEL1LAYOUT")    
    strLevel2layout=getSplitValue(strParameters,"LEVEL2LAYOUT")
    
'     strLevel1layout="dX Non-Asia Database (Current Eng Version)"
''    strLevel2layout="Z-Testing Topic(IT-use only)"
'    strLevel2layout="Z-Topic Test(IT-use only)"
        
    Delay 3000,"Please Wait..."
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("LayoutTreeControl").WPFObject("LayoutTreeListView")
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("LayoutTreeControl")
    
    Delay 1000,"Please Wait..."
        ''Selecting Level1 layout
        intTotNodeCnt=GridControl.Nodes_2.Count
        For intI=0 to intTotNodeCnt-1         
            If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strLevel1layout) then
              GridControl.Nodes_2.Item(intI).Expand(True)
              log.Message "Level 1 Layout - " & GridControl.Nodes_2.Item(intI).Content.Description       
              blnFlag=False  
              Exit For
            End If
        Next
        Delay 3000,"Please Wait..."
        If blnFlag = True then
          strTCRemarks="Level 1 Layout not found"
          strTestCaseResult="FAIL"
          Exit Sub
        End If 
        

   Delay 8000,"Please Wait..."
    blnFlag = True 
    ''Selecting Level2 Layout
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
    For intJ=0 to intTotNodeCnt-1
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strLevel2layout) then
          intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
          GridControl.set_FocusedRowHandle(intRow)
          GridControl.set_FocusedRowData(intRow)
          delay(1000)
          GridControl.Keys("[Down]")
          GridControl.Keys("[Up]")
'         
        log.Message "Level2 layout Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
        blnFlag = False 
        Exit For
      End If
    Next
    Delay 3000,"Please Wait..."
    If blnFlag = True then
      strTCRemarks="Level2 Source Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
    GridControl.Keys "^[Enter]" 
    Delay 3000,"Please Wait..."
    strTCRemarks = strTCRemarks & "<br />" &  "Expanded Second Level Folders in Layout"     
     Call sCloseLayout  
End Sub

Sub sCheckLayoutThirdLExpand(strParameters)
  On Error Resume Next
    Dim objEdge,objEdgeFilter
    Dim strLevel1layout,strLevel2layout,strLevel3layout,strWrkSpaceName
    Dim objNewWrkSpace_okbtn,objNewWrkSpace_Name
    Dim objNewWrkSpace_Txtbox,objopenforEdit,objWrkspace_popup
    Dim strTemp,objTemp,intRow,barManager,intTotNodeCnt,Text,objCellText,intl,intK,strDesc1,strDesc2,intJ
    Dim objWrkSpace,objwrkspacepop,objwrkspcUpload,objConfirm,objGridCell,DescLocalText,intSeriesID

    call sLoadlayout
    strLevel1layout=getSplitValue(strParameters,"LEVEL1LAYOUT")    
    strLevel2layout=getSplitValue(strParameters,"LEVEL2LAYOUT")
    strLevel3layout=getSplitValue(strParameters,"LEVEL3LAYOUT")
    
'     strLevel1layout="dX Non-Asia Database (Current Eng Version)"
''    strLevel2layout="Z-Testing Topic(IT-use only)"
'    strLevel2layout="Z-Topic Test(IT-use only)"
'    strLevel3layout="Automation"   
    
    Delay 3000,"Please Wait..."
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("LayoutTreeControl").WPFObject("LayoutTreeListView")
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("LayoutTreeControl")
    
    Delay 1000,"Please Wait..."
        ''Selecting Level1 layout
        intTotNodeCnt=GridControl.Nodes_2.Count
        For intI=0 to intTotNodeCnt-1         
            If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strLevel1layout) then
              GridControl.Nodes_2.Item(intI).Expand(True)
              log.Message "Level 1 Layout - " & GridControl.Nodes_2.Item(intI).Content.Description       
              blnFlag=False  
              Exit For
            End If
        Next
        Delay 3000,"Please Wait..."
        If blnFlag = True then
          strTCRemarks="Level 1 Layout not found"
          strTestCaseResult="FAIL"
          Exit Sub
        End If 
        

   Delay 8000,"Please Wait..."
    blnFlag = True 
    ''Selecting Level2 Layout
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
    For intJ=0 to intTotNodeCnt-1
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strLevel2layout) then
         GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
          intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
        log.Message "Level2 layout Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
        blnFlag = False 
        Exit For
      End If
    Next
    Delay 3000,"Please Wait..."
    If blnFlag = True then
      strTCRemarks="Level2 Source Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
    
     blnFlag = True    
    ''Selecting Level3 Layout
      intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count
      For intK=0 to intTotNodeCnt-1
        If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description)=Ucase(strLevel3layout) then
          intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).get_RowHandle
          GridControl.set_FocusedRowHandle(intRow)
          GridControl.set_FocusedRowData(intRow)
          delay(1000)
          GridControl.Keys("[Down]")
          GridControl.Keys("[Up]")
          log.Message "Level3 layout Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description
          blnFlag = False
          Exit For   
        End If 
      Next
      Delay 3000,"Please Wait..."
      If blnFlag = True then
        strTCRemarks="Level3 Source Name not found"
        strTestCaseResult="FAIL"
        Exit Sub
      End If
    GridControl.Keys "^[Enter]" 
    Delay 3000,"Please Wait..."
    strTCRemarks = strTCRemarks & "<br />" &  "Expanded Third Level Folders in Layout" 
     Call sCloseLayout               
End Sub


Sub sCheckLayoutModuleWorkspaceLocked(strParameters)

On Error Resume Next 
    Dim strLevel1layout,strLevel2layout,strLevel3layout,strWrkSpaceName
    Dim objNewWrkSpace_okbtn,objNewWrkSpace_Name
    Dim objNewWrkSpace_Txtbox,objopenforEdit,objWrkspace_popup,strWrkSpaceName1
    Dim strTemp,objTemp,intRow,barManager,intTotNodeCnt,Text,objCellText,intI,intK,strDesc1,strDesc2,intJ
    Dim objWrkSpace,objwrkspacepop,objwrkspcUpload,objConfirm,objGridCell,DescLocalText,intSeriesID
    
    Call sloadlayout 
    Call sCheckLayoutExpandTree(strParameters)
    
    strLevel1layout=getSplitValue(strParameters,"LEVEL1LAYOUT")
    strLevel2layout=getSplitValue(strParameters,"LEVEL2LAYOUT")
    strLevel3layout=getSplitValue(strParameters,"LEVEL3LAYOUT")
    
'    strLevel1layout="dX Non-Asia Database (Current Eng Version)"
'    strLevel2layout="Z-Topic Test(IT-use only)"
'    strLevel3layout="Sandbox (Benny)"
'    intSeriesID="369145097"

    strDesc1=aqDateTime.Now
    strDesc2=aqDateTime.Now
    DescText=Replace(strDesc1,"/","-")
    DescText=Replace(DescText,":","_")
    DescLocalText=DescText
    strWrkSpaceName1=DescText
    strWrkSpaceName="Workspace1"
    intSeriesID=getSplitValue(strParameters,"SERIESID")
    if intSeriesID=0 then
      intSeriesID=strSeriesID
    End if 

    Delay 3000,"Please Wait..."

    ''Setting grid Objects

    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("LayoutTreeControl").WPFObject("LayoutTreeListView")
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("LayoutTreeControl")

    Delay 2000,"Please Wait..."
    ''Selecting Level1 layout
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strLevel1layout) then
          GridControl.Nodes_2.Item(intI).Expand(True)
          log.Message "Level 1 Layout - " & GridControl.Nodes_2.Item(intI).Content.Description       
          blnFlag=False  
          Exit For
        End If
    Next
'    Delay 3000,"Please Wait..."
    If blnFlag = True then
      strTCRemarks="Level 1 Layout not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
  
    Delay 5000,"Please Wait..."
    blnFlag = True 
    ''Selecting Level2 Layout
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
    For intJ=0 to intTotNodeCnt-1
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strLevel2layout) then
        GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
        intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
        Call GridControl.ClearSelectionCore
        Call GridControl.FocusViewAndRow(GridControl,intRow)
        GridControl.SetFocusOnCurrentItem
        Call GridControl.SelectRowCore(intRow)
        log.Message "Level2 layout Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
        blnFlag = False 
        Exit For
      End If
    Next
    If blnFlag = True then
      strTCRemarks="Level2 Source Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If

    Delay 5000,"Please Wait..."
    blnFlag = True    
    ''Selecting Level3 Layout
      intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count
      For intK=0 to intTotNodeCnt-1
        If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description)=Ucase(strLevel3layout) then
          GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Expand(True)
          intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).get_RowHandle
          Call GridControl.ClearSelectionCore
          Call GridControl.FocusViewAndRow(GridControl,intRow)
          GridControl.SetFocusOnCurrentItem
          Call GridControl.SelectRowCore(intRow)
          log.Message "Level3 layout Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description
          blnFlag = False
          Exit For   
        End If 
      Next
      If blnFlag = True then
        strTCRemarks="Level3 Source Name not found"
        strTestCaseResult="FAIL"
        Exit Sub
      End If
      Call sCheckLayoutModule(strParameters)
      ''Clicking on "New Workspace" Button and selecting "Open for Edit(Souce)" option   
      strTemp="WPFObject(""ArrowControl"", """", 1)"
      Set objNewWorkspace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarSubItemLinkControl", "", 1).FindChild("Name",strTemp,2,True)
      If objNewWorkspace.Exists = True then
      objNewWorkspace.Click
      strTemp="WPFObject(""BarPopupBorderControl"", """", 1)"
      Set objWrkspace_popup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").FindChild("Name",strTemp,5,True)
      If objWrkspace_popup.Exists = True then
        strTemp="WPFObject(""ContentControlEx"", ""Open For Edit"", 2)"
        Set objopenforEdit=objWrkspace_popup.FindChild("Name",strTemp,8,True)
        If objopenforEdit.Exists then
          objopenforEdit.Click    
          'Delay 30000,"Please Wait..."
        End If
      End If
      
      strTemp1="WPFObject(""HwndSource: WorkspaceNamePrompt"", ""Please provide a new Workspace Name"")"
      Set objNewWrkSpaceName=Sys.Process("EdgeClient").WaitChild(strTemp1,80000)
      If objNewWrkSpaceName.Exists = True then

          ''Waiting for Workspace Name prompt
          strTemp="WPFObject(""FloatingContainerBorder"")"
          Set objNewWrkSpace_Name=Sys.Process("EdgeClient").WPFObject("HwndSource: WorkspaceNamePrompt", "Please provide a new Workspace Name").WPFObject("WorkspaceNamePrompt", "Please provide a new Workspace Name", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,1500000)
          If objNewWrkSpace_Name.Exists = True then
            strTemp="WPFObject(""ChangeNameTextEdit"")"
            ''Entering Workspace Name
            Set objNewWrkSpace_Txtbox=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
              'Delay 30000,"Please Wait..."
              If objNewWrkSpace_Txtbox.Exists = True then
                objNewWrkSpace_Txtbox.Click
                objNewWrkSpace_Txtbox.Text=strWrkSpaceName1
                ''Clicking on Ok Button 
                strTemp="WPFObject(""OkButton"")"
                Set objNewWrkSpace_okbtn=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
                If objNewWrkSpace_okbtn.Exists = True then
                  objNewWrkSpace_okbtn.Click
                  'Delay 10000,"Please wait..."
                End if
                
              strTemp="WPFObject(""PART_ContainerContent"")"
              Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "Warning").WPFObject("CustomMessageBoxWindow", "Warning", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,50000)
              If objNewWrkSpace_okbtn.Exists = True then
                SYS.Keys "N"
                Call sCloseLayout
                Exit Sub
              End If
              End if 
            End if 
          End if 
      End if
                
                 

    Call sCloseLayout
    Delay 10000,"Closing Layout..." 
    Call sCloseLayout
    Delay 10000,"Closing Layout..." 
        
     Call sloadlayout 
    Call sCheckLayoutExpandTree(strParameters)
    
      Delay 3000,"Please Wait..."

    ''Setting grid Objects

    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("LayoutTreeControl").WPFObject("LayoutTreeListView")
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("LayoutTreeControl")

    Delay 2000,"Please Wait..."
    ''Selecting Level1 layout
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strLevel1layout) then
          GridControl.Nodes_2.Item(intI).Expand(True)
          log.Message "Level 1 Layout - " & GridControl.Nodes_2.Item(intI).Content.Description       
          blnFlag=False  
          Exit For
        End If
    Next
'    Delay 3000,"Please Wait..."
    If blnFlag = True then
      strTCRemarks="Level 1 Layout not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
  
    Delay 5000,"Please Wait..."
    blnFlag = True 
    ''Selecting Level2 Layout
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
    For intJ=0 to intTotNodeCnt-1
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strLevel2layout) then
        GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
        intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
        Call GridControl.ClearSelectionCore
        Call GridControl.FocusViewAndRow(GridControl,intRow)
        GridControl.SetFocusOnCurrentItem
        Call GridControl.SelectRowCore(intRow)
        log.Message "Level2 layout Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
        blnFlag = False 
        Exit For
      End If
    Next
    If blnFlag = True then
      strTCRemarks="Level2 Source Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If


      Call sCheckLayoutModule(strParameters)
      ''Clicking on "New Workspace" Button and selecting "Open for Edit(Souce)" option   
      strTemp="WPFObject(""ArrowControl"", """", 1)"
      Set objNewWorkspace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarSubItemLinkControl", "", 1).FindChild("Name",strTemp,2,True)
      If objNewWorkspace.Exists = True then
      objNewWorkspace.Click
      strTemp="WPFObject(""BarPopupBorderControl"", """", 1)"
      Set objWrkspace_popup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").FindChild("Name",strTemp,5,True)
      If objWrkspace_popup.Exists = True then
        strTemp="WPFObject(""ContentControlEx"", ""Open For Edit"", 2)"
        Set objopenforEdit=objWrkspace_popup.FindChild("Name",strTemp,8,True)
        If objopenforEdit.Exists then
          objopenforEdit.Click    
          'Delay 30000,"Please Wait..."
        End If
      End If
      
      strTemp1="WPFObject(""HwndSource: WorkspaceNamePrompt"", ""Please provide a new Workspace Name"")"
      Set objNewWrkSpaceName=Sys.Process("EdgeClient").WaitChild(strTemp1,80000)
      If objNewWrkSpaceName.Exists = True then

          ''Waiting for Workspace Name prompt
          strTemp="WPFObject(""FloatingContainerBorder"")"
          Set objNewWrkSpace_Name=Sys.Process("EdgeClient").WPFObject("HwndSource: WorkspaceNamePrompt", "Please provide a new Workspace Name").WPFObject("WorkspaceNamePrompt", "Please provide a new Workspace Name", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,1500000)
          If objNewWrkSpace_Name.Exists = True then
            strTemp="WPFObject(""ChangeNameTextEdit"")"
            ''Entering Workspace Name
            Set objNewWrkSpace_Txtbox=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
              'Delay 30000,"Please Wait..."
              If objNewWrkSpace_Txtbox.Exists = True then
                objNewWrkSpace_Txtbox.Click
                objNewWrkSpace_Txtbox.Text=strWrkSpaceName
                ''Clicking on Ok Button 
                strTemp="WPFObject(""OkButton"")"
                Set objNewWrkSpace_okbtn=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
                If objNewWrkSpace_okbtn.Exists = True then
                  objNewWrkSpace_okbtn.Click
                   Dim strOk
                    strTemp="WPFObject(""PART_ContainerContent"")"
                    Set strOk=Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "Warning").WPFObject("CustomMessageBoxWindow", "Warning", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,50000)
                    If strOk.Exists = True then
                    SYS.Keys "N"
                       strTCRemarks = strTCRemarks & "<br />" &  "System should display the warning message saying layout  is locked " 
                    End If
                End If
               End If
          End If
      End if 
    End If
        Call sCloseLayout
        Delay 10000,"Closing Layout..." 
        Call sCloseLayout
        Delay 10000,"Closing Layout..." 
        Call LayoutWorkSpacevwr
 End Sub
 
 
 Sub sCheckLayoutModuleMultipleWorkspace()

On Error Resume Next 
    Dim strLevel1layout,strLevel2layout,strLevel3layout,strWrkSpaceName
    Dim objNewWrkSpace_okbtn,objNewWrkSpace_Name
    Dim objNewWrkSpace_Txtbox,objopenforEdit,objWrkspace_popup
    Dim strTemp,objTemp,intRow,barManager,intTotNodeCnt,Text,objCellText,intl,intK,strDesc1,strDesc2
    Dim objWrkSpace,objwrkspacepop,objwrkspcUpload,objConfirm,objGridCell,DescLocalText,intSeriesID
    
    Call sloadlayout 
'    Call sCheckLayoutExpandTree(strParameters)
'    
'    strLevel1layout=getSplitValue(strParameters,"LEVEL1LAYOUT")
'    strLevel2layout=getSplitValue(strParameters,"LEVEL2LAYOUT")
    'strLevel3layout=getSplitValue(strParameters,"LEVEL3LAYOUT")
    
    strLevel1layout="dX Non-Asia Database (Current Eng Version)"
    strLevel2layout="Z-Topic Test(IT-use only)"
    strLevel2Mlayout="test"
'    strLevel3layout="Sandbox (Benny)"
'    intSeriesID="369145097"

    strDesc1=aqDateTime.Now
    strDesc2=aqDateTime.Now
    DescText=Replace(strDesc1,"/","-")
    DescText=Replace(DescText,":","_")
    DescLocalText=DescText
    strWrkSpaceName="Workspace1"
    intSeriesID=getSplitValue(strParameters,"SERIESID")
    if intSeriesID=0 then
      intSeriesID=strSeriesID
    End if 

    Delay 3000,"Please Wait..."

    ''Setting grid Objects

    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("LayoutTreeControl").WPFObject("LayoutTreeListView")
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("LayoutTreeControl")

    Delay 2000,"Please Wait..."
    ''Selecting Level1 layout
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strLevel1layout) then
          GridControl.Nodes_2.Item(intI).Expand(True)
          log.Message "Level 1 Layout - " & GridControl.Nodes_2.Item(intI).Content.Description       
          blnFlag=False  
          Exit For
        End If
    Next
'    Delay 3000,"Please Wait..."
    If blnFlag = True then
      strTCRemarks="Level 1 Layout not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
  
    Delay 5000,"Please Wait..."
    blnFlag = True 
    ''Selecting Level2 Layout
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
    For intJ=0 to intTotNodeCnt-1
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strLevel2layout) then
       ' GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
        intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
        Call GridControl.ClearSelectionCore
        Call GridControl.FocusViewAndRow(GridControl,intRow)
        GridControl.SetFocusOnCurrentItem
        Call GridControl.SelectRowCore(intRow)
        log.Message "Level2 layout Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
        blnFlag = False 
        Exit For
      End If
    Next
    If blnFlag = True then
      strTCRemarks="Level2 Source Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
    
    
    Delay 5000,"Please Wait..."
    blnFlag = True 
    ''Selecting Level2 Layout
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
    For intJ=0 to intTotNodeCnt-1
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strLevel2Mlayout) then
'          intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
'          GridControl.set_FocusedRowHandle(intRow)
'          GridControl.set_FocusedRowData(intRow)
          delay(1000)
           Call GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Click(30, 6, skCtrl)
'            GridControl.Keys("[Down]")
'            GridControl.Keys("[Up]")
'         Call GridControl.Click(30, 6, skCtrl)
        log.Message "Level2 layout Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
        blnFlag = False 
        Exit For
      End If
    Next
    If blnFlag = True then
      strTCRemarks="Level2 Source Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
   
'    Delay 5000,"Please Wait..."
'    blnFlag = True    
'    ''Selecting Level3 Layout
'      intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count
'      For intK=0 to intTotNodeCnt-1
'        If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description)=Ucase(strLevel3layout) then
'          GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Expand(True)
'          intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).get_RowHandle
'          Call GridControl.ClearSelectionCore
'          Call GridControl.FocusViewAndRow(GridControl,intRow)
'          GridControl.SetFocusOnCurrentItem
'          Call GridControl.SelectRowCore(intRow)
'          log.Message "Level3 layout Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description
'          blnFlag = False
'          Exit For   
'        End If 
'      Next
'      If blnFlag = True then
'        strTCRemarks="Level3 Source Name not found"
'        strTestCaseResult="FAIL"
'        Exit Sub
'      End If
      Call sCheckLayoutModule(strParameters)
      ''Clicking on "New Workspace" Button and selecting "Open for Edit(Souce)" option   
      strTemp="WPFObject(""ArrowControl"", """", 1)"
      Set objNewWorkspace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarSubItemLinkControl", "", 1).FindChild("Name",strTemp,2,True)
      If objNewWorkspace.Exists = True then
      objNewWorkspace.Click
      strTemp="WPFObject(""BarPopupBorderControl"", """", 1)"
      Set objWrkspace_popup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").FindChild("Name",strTemp,5,True)
      If objWrkspace_popup.Exists = True then
        strTemp="WPFObject(""ContentControlEx"", ""Open For Edit"", 2)"
        Set objopenforEdit=objWrkspace_popup.FindChild("Name",strTemp,8,True)
        If objopenforEdit.Exists then
          objopenforEdit.Click    
          'Delay 30000,"Please Wait..."
        End If
      End If
      
      strTemp1="WPFObject(""HwndSource: WorkspaceNamePrompt"", ""Please provide a new Workspace Name"")"
      Set objNewWrkSpaceName=Sys.Process("EdgeClient").WaitChild(strTemp1,80000)
      If objNewWrkSpaceName.Exists = True then

          ''Waiting for Workspace Name prompt
          strTemp="WPFObject(""FloatingContainerBorder"")"
          Set objNewWrkSpace_Name=Sys.Process("EdgeClient").WPFObject("HwndSource: WorkspaceNamePrompt", "Please provide a new Workspace Name").WPFObject("WorkspaceNamePrompt", "Please provide a new Workspace Name", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,1500000)
          If objNewWrkSpace_Name.Exists = True then
            strTemp="WPFObject(""ChangeNameTextEdit"")"
            ''Entering Workspace Name
            Set objNewWrkSpace_Txtbox=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
              'Delay 30000,"Please Wait..."
              If objNewWrkSpace_Txtbox.Exists = True then
                objNewWrkSpace_Txtbox.Click
                objNewWrkSpace_Txtbox.Text=strWrkSpaceName
                ''Clicking on Ok Button 
                strTemp="WPFObject(""OkButton"")"
                Set objNewWrkSpace_okbtn=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
                If objNewWrkSpace_okbtn.Exists = True then
                  objNewWrkSpace_okbtn.Click
                  'Delay 10000,"Please wait..."
                  
                  Dim strOk
                    strTemp="WPFObject(""DXMessageBox"", """", 1)"
                    Set strOk=Sys.Process("EdgeClient").WPFObject("HwndSource: WindowContentHolder", "New Workspace").WPFObject("WindowContentHolder", "New Workspace", 1).WPFObject("NonLogicalDecorator", "", 1).WPFObject("ThemedManagedContentPresenter", "", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WaitChild(strTemp,500000)
                    If strOk.Exists Then
                      SYS.Keys "[Enter]"
                    End If
                End If
               End If
          End If
      End if 
    End If

        Call sCloseLayout
        Delay 10000,"Closing Layout..." 
'        Call sCloseLayout
'        Delay 10000,"Closing Layout..." 
        ' Call LayoutWorkSpacevwr
 End Sub
 
 
 Sub sCheckLayoutSelectWorkspaceLocked()

On Error Resume Next 
    Dim strLevel1layout,strLevel2layout,strLevel3layout,strWrkSpaceName
    Dim objNewWrkSpace_okbtn,objNewWrkSpace_Name
    Dim objNewWrkSpace_Txtbox,objopenforEdit,objWrkspace_popup
    Dim strTemp,objTemp,intRow,barManager,intTotNodeCnt,Text,objCellText,intl,intK,strDesc1,strDesc2,intJ
    Dim objWrkSpace,objwrkspacepop,objwrkspcUpload,objConfirm,objGridCell,DescLocalText,intSeriesID
    
    Call sloadlayout 
   ' Call sCheckLayoutExpandTree(strParameters)
    
'    strLevel1layout=getSplitValue(strParameters,"LEVEL1LAYOUT")
    
    strLevel1layout="dX Asia Database (Current Eng Version)"

    Delay 3000,"Please Wait..."

    ''Setting grid Objects
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("LayoutTreeControl").WPFObject("LayoutTreeListView")
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("LayoutTreeControl")

    Delay 2000,"Please Wait..."
    ''Selecting Level1 layout
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strLevel1layout) then
          GridControl.Nodes_2.Item(intI).Expand(True)
          intRow=GridControl.Nodes_2.Item(intI).get_RowHandle
          Call GridControl.ClearSelectionCore
          Call GridControl.FocusViewAndRow(GridControl,intRow)
          GridControl.SetFocusOnCurrentItem
          Call GridControl.SelectRowCore(intRow)
          log.Message "Level 1 Layout - " & GridControl.Nodes_2.Item(intI).Content.Description       
          Delay 5000,"Please Wait..."
          blnFlag = True 
        ''Selecting Level2 Layout
          intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
          For intJ=0 to intTotNodeCnt-1 
            Dim strOk 
            strTemp="WPFObject(""LampRedStatePresentationControl"", """", 1)"
            Set strOk=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("LayoutTreeControl").WPFObject("LayoutTreeListView").WPFObject("HierarchyPanel", "", 1).FindChild("Name",strTemp,50)
            If strOk.Exists Then
              log.Message "Layout Folder Locked - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description 
            End If
          Next
          Exit For
        End If
    Next
'    Delay 3000,"Please Wait..."
    If blnFlag = True then
      strTCRemarks="Level 1 Layout not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
  

 End Sub
 
 Sub sCheckSource(strParameters)
    Dim strTestcase
    strTestcase=getSplitValue(strParameters,"TESTCASE") 
    If strTestcase=1 then
      Call sHome_Source
    Elseif strTestcase=2 then
      Call sHome_Source
      Call sCheckSourceFields
    Elseif strTestcase=3 then
     
    Elseif strTestcase=4 then
     Call sHome_Source
     Call sCheckSourceButton
    Elseif strTestcase=5 then
     Call sCheckSourceFindButton
    Elseif strTestcase=6 then
     Call sCheckSourceEditCheck(strParameters)
    Elseif strTestcase=7 then
      Call sCheckSourceNewSourceButton(strParameters)
    Elseif strTestcase=8 then
      Call sCheckSourceNewSourceButton(strParameters)
    Elseif strTestcase=9 then
      Call sCheckSourceNewWorkspaceButton(strParameters)
    Elseif strTestcase=10 then
      Call sCheckSourceNewWorkspaceButton(strParameters)
    Elseif strTestcase=11 then
      Call sCheckSourceNewWorkspaceButton(strParameters)
    Elseif strTestcase=12 then
      Call sCheckSourceSecondLevelWorkshop(strParameters)
    Elseif strTestcase=13 then
      Call sCheckSourceRefresh
    Elseif strTestcase=14 then
      
    Elseif strTestcase=15 then
      Call sCheckSourceButton()
    Elseif strTestcase=16 then
      Call sCheckSourceExpandAll(strParameters)
    Elseif strTestcase=17 then
      Call sCheckSourceExpandandCollapse(strParameters)
    Elseif strTestcase=18 then
      Call sCheckSourceExpandCollapse(strParameters)
    Elseif strTestcase=19 then
      Call sCheckSourceNewSourceOrganization(strParameters)
    Elseif strTestcase=20 then
      Call sCheckSourceNewSourceOrganization(strParameters)
    Elseif strTestcase=21 then
     Call sCheckSourceNewSourceOrganizationFields(strParameters)
    Elseif strTestcase=22 then
      Call sCheckSourceNewSourceOrganizationFields(strParameters)
    Elseif strTestcase=23 then
      Call sCheckSourceNewSourceOrganizationButton(strParameters)
    Elseif strTestcase=24 then
      Call sCheckSourceSCExpand(strParameters)
    Elseif strTestcase=25 then
      Call sCheckSourceSCCollapse(strParameters)
    Elseif strTestcase=26 then
      Call sCheckSourceGlobalSTP(strParameters)
    Elseif strTestcase=27 then
      Call sCheckSourceGlobalSTPRightClick(strParameters)
    Elseif strTestcase=28 then
      Call sCheckSourceCNSTP(strParameters)
    Elseif strTestcase=29 then
      Call sCheckSourceCNSTPRightClick(strParameters)
    Elseif strTestcase=30 then
     Call sCheckSourceRightClick(strParameters)
    Elseif strTestcase=31 then
      Call sCheckSourceNewSourceOrganizationValidation(strParameters)
    Elseif strTestcase=32 then
      Call sCheckSourceSaveNewSourceOrganization(strParameters)
    Elseif strTestcase=33 then
      Call sCheckSourceDuplicateNewSourceOrganization(strParameters)
    Elseif strTestcase=34 then
      Call  sCheckSourceSaveNewSourceOrganizationLevel2(strParameters)
    Elseif strTestcase=35 then
      Call sCheckSourceOpenView(strParameters)
    Elseif strTestcase=36 then
     Call sCheckSourceOpenViewSourceRightClick(strParameters)
    Elseif strTestcase=37 then
      Call  sCheckSourceValidationOpenView(strParameters)
    Elseif strTestcase=38 then
     Call  sCheckSourceValidationOpenViewRightClick(strParameters)
    Elseif strTestcase=39 then
      Call sCheckSourceCancelOpenEdit(strParameters)
    Elseif strTestcase=40 then
      Call sCheckSourceOpenEditRightClick(strParameters)
    Elseif strTestcase=41 then
      sCheckSourceOpenEdit(strParameters)
    Elseif strTestcase=42 then
     Call sCheckSourceCancelOpenEdit(strParameters)
    Elseif strTestcase=43 then
      Call sCheckSourceValidatingWorkspace(strParameters)
      Call sCheckSourceValidatesameWorkspace(strParameters)
    Elseif strTestcase=44 then
      Call sCheckSourceViewSourceSchedule(strParameters)
    Elseif strTestcase=45 then
      Call sCheckSourceSchedule_Checklist(strParameters)
      Call sCheckSourceScheduleWorkSpacevwr()
    Elseif strTestcase=46 then
      Call sCheckSourceSchedule_Checklist(strParameters)
      Call sCheckSourceSchedule_ChecklistValidation(strParameters)
      Call sCheckSourceScheduleWorkSpacevwr()
    Elseif strTestcase=47 then
    
    Elseif strTestcase=48 then
      Call sCheckSourceOpenEditRightClick(strParameters)
    Elseif strTestcase=49 then
      Call sCheckSourceOpenViewSourceRightClick(strParameters)
    Elseif strTestcase=50 then
      Call sCheckSourceOpenEditSourcescheduleRightClick(strParameters)
    Elseif strTestcase=51 then
      Call sCheckSourceOpenViewSourcescheduleRightClick(strParameters)
    Elseif strTestcase=52 then
      Call sCheckSourceSCOpenSTP(strParameters)
    Elseif strTestcase=53 then
      Call sCheckSourceMultipleSource(strParameters)
    Elseif strTestcase=54 then
      Call sCheckSourceMultipleSourceView(strParameters)
    Elseif strTestcase=55 then
      Call sCheckSourceMultipleEditSourceSchedule(strParameters)
    Elseif strTestcase=56 then
      Call sCheckSourceMultipleSourcechecklistView(strParameters)
    Elseif strTestcase=57 then
      Call sCheckSourceMultipleSource(strParameters)
    Elseif strTestcase=58 then
      Call sCheckSourceMultipleEditSourceSchedule(strParameters)      
    Elseif strTestcase=59 then
      Call sCheckSourceEditCheck(strParameters)
    Elseif strTestcase=60 then
      Call sCheckSourceExpand(strParameters)
    Elseif strTestcase=61 then
      Call sCheckSourceCollapse(strParameters)
    Elseif strTestcase=62 then
      Call sCheckSourceSTPButtons(strParameters)
    Elseif strTestcase=63 then
    Elseif strTestcase=64 then
      Call sCheckSourceOpenEditLock(strParameters)
    Elseif strTestcase=65 then
      Call sCheckSourceLevel3EditSource(strParameters)
      Call sCheckSourceValidateLevel3EditSource(strParameters)
      Call SourceWorkSpacevwr()
    Elseif strTestcase=66 then
     Call sCheckSourceValidateLevel3EditSourceSchedule(strParameters)
     Call sCheckSourceValidateValidateLevel3EditSourceSchedule(strParameters)
     Call sCheckSourceScheduleWorkSpacevwr()
    Elseif strTestcase=67 then
     Call sCheckSourceEditCheck(strParameters)
    Elseif strTestcase=68 then
      Call sCheckSourceLevel2NewSourceButton(strParameters)
    Elseif strTestcase=69 then
      Call sCheckSourceEditCheck(strParameters)
    Elseif strTestcase=70 then
      Call sCheckSourceNewSourceButton(strParameters)
    Elseif strTestcase=71 then
      Call sCheckSourceEditCheck(strParameters)
    Elseif strTestcase=72 then
      Call sCheckSourceEditCheck(strParameters)
    Elseif strTestcase=73 then
      Call sCheckSourceLevel2NewSourceButton(strParameters)
    Elseif strTestcase=74 then
      Call sCheckSourceEditCheck(strParameters)
    Elseif strTestcase=75 then
      Call sCheckSourceRightClickHeader()
    Elseif strTestcase=76 then
      Call sCheckSourceFloat()
    Elseif strTestcase=77 then
      Call sCheckSourceAutoHide()
    Elseif strTestcase=78 then
      Call sCheckSourceClose()
    Elseif strTestcase=79 then
      Call sCheckSourceLevel1MultipleSource(strParameters)
    Elseif strTestcase=80 then
    
    Elseif strTestcase=81 then
      
    End if
End sub

Sub sCheckSourceFields()
On Error Resume Next

  Dim objEdge,strTemp,objTemp,objEdgeTree,strLayoutHeader,GridControl,GridSourceTree,intTotNodeCnt,intI
              
  set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1)
  strTemp="WPFObject(""SourceTreeListView"")"
  Set objTemp=objEdge.FindChild("Name",strTemp,50)
  If objTemp.Exists=True then
    strTCRemarks = "Source Grid found in Source"
    log.Message "Source grid found in Source"
    set objEdgeTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("SourceTreeControl").WPFObject("SourceTreeListView")
    
    strTemp="WPFObject(""GridColumnHeader"", """", 1)"
    Set objTemp=objEdgeTree.FindChild("Name",strTemp,50)
    if objTemp.Exists=True then
      if UCASE(objTemp.DataContext.Header)="DESCRIPTION" then
        strTCRemarks = strTCRemarks & "<br />" & "Description is found in Source"
        log.Message "Description is found in Source"
      Else
        strTCRemarks = strTCRemarks & "<br />" & "Description is not found in Source"
        log.Message "Description is not found in Source"
      End if
    Else 
      strTCRemarks = strTCRemarks & "<br />" & "Fields is not found in Source"
    End if
       
    strTemp="WPFObject(""GridColumnHeader"", """", 2)"
    Set objTemp=objEdgeTree.FindChild("Name",strTemp,50)
    if objTemp.Exists=True then
      if UCASE(objTemp.DataContext.Header)="DESCRIPTION LOCAL" then
        strTCRemarks = strTCRemarks & "<br />" & "Description Local is found in Source"
        log.Message "Description Local is found in Source"
      Else
        strTCRemarks = strTCRemarks & "<br />" & "Description is not found in Source"
        log.Message "Description Local is not found in Source"
      End if 
    else
      strTCRemarks = strTCRemarks & "<br />" & "Fields is not found in Source"
    End if
    
    strTemp="WPFObject(""GridColumnHeader"", """", 3)"
    Set objTemp=objEdgeTree.FindChild("Name",strTemp,50)
    if objTemp.Exists=True then
      if UCASE(objTemp.DataContext.Header)="SOURCE ABBR." then
        strTCRemarks = strTCRemarks & "<br />" & "Source Abbr. is found in Source"
        log.Message "Source Abbr. is found in Source"
      Else
        strTCRemarks = strTCRemarks & "<br />" & "Source Abbr. is not found in Source"
        log.Message "Source Abbr. is not found in Source"
      End if 
    else
      strTCRemarks = strTCRemarks & "<br />" & "Fields is not found in Source"
    End if
    
    strTemp="WPFObject(""GridColumnHeader"", """", 4)"
    Set objTemp=objEdgeTree.FindChild("Name",strTemp,50)
    if objTemp.Exists=True then
      if UCASE(objTemp.DataContext.Header)="EDIT" then
        strTCRemarks = strTCRemarks & "<br />" & "Edit is found in Source"
        log.Message "Edit is found in Source"
      Else
        strTCRemarks = strTCRemarks & "<br />" & "Edit is not found in Source"
        log.Message "Edit is not found in Source"
      End if 
    else
      strTCRemarks = strTCRemarks & "<br />" & "Fields is not found in Source"
    End if
    
    strTemp="WPFObject(""GridColumnHeader"", """", 5)"
    Set objTemp=objEdgeTree.FindChild("Name",strTemp,50)
    if objTemp.Exists=True then
      if UCASE(objTemp.DataContext.Header)="SCHEDULE EDIT" then
        strTCRemarks = strTCRemarks & "<br />" & "Schedule Edit is found in Source"
        log.Message "Schedule Edit is found in Source"
      Else
        strTCRemarks = strTCRemarks & "<br />" & "Schedule Edit is not found in Source"
        log.Message "Schedule Edit is not found in Source"
      End if 
    else
      strTCRemarks = strTCRemarks & "<br />" & "Fields is not found in Source"
    End if
        
    strTemp="WPFObject(""GridColumnHeader"", """", 6)"
    Set objTemp=objEdgeTree.FindChild("Name",strTemp,50)
    if objTemp.Exists=True then
      if UCASE(objTemp.DataContext.Header)="TREE LEVEL" then
        strTCRemarks = strTCRemarks & "<br />" & "Tree Level is found in Source"
        log.Message "Tree Level is found in Source"
      Else
        strTCRemarks = strTCRemarks & "<br />" & "Tree Level is not found in Source"
        log.Message "EDIT is not found in Source"
      End if 
    else
      strTCRemarks = strTCRemarks & "<br />" & "Fields is not found in Source"
    End if
    
    strTemp="WPFObject(""GridColumnHeader"", """", 7)"
    Set objTemp=objEdgeTree.FindChild("Name",strTemp,50)
    if objTemp.Exists=True then
      if UCASE(objTemp.DataContext.Header)="SOURCE TYPE" then
        strTCRemarks = strTCRemarks & "<br />" & "Source Type is found in Source"
        log.Message "Source Type found in Source"
      Else
        strTCRemarks = strTCRemarks & "<br />" & "Source Type is not found in Source"
        log.Message "Source Type is not found in Source"
      End if 
    else
      strTCRemarks = strTCRemarks & "<br />" & "Fields is not found in Source"
    End if
    
    strTemp="WPFObject(""GridColumnHeader"", """", 8)"
    Set objTemp=objEdgeTree.FindChild("Name",strTemp,50)
    if objTemp.Exists=True then
      if UCASE(objTemp.DataContext.Header)="SOURCE NATURE" then
        strTCRemarks = strTCRemarks & "<br />" & "Source Nature is found in Source"
        log.Message "Source Nature is found in Source"
      Else
        strTCRemarks = strTCRemarks & "<br />" & "Source Nature is not found in Source"
        log.Message "Source Nature is not found in Source"
      End if 
    else
      strTCRemarks = strTCRemarks & "<br />" & "Fields is not found in Source"
    End if
    
    strTemp="WPFObject(""GridColumnHeader"", """", 9)"
    Set objTemp=objEdgeTree.FindChild("Name",strTemp,50)
    if objTemp.Exists=True then
      if UCASE(objTemp.DataContext.Header)="IS OFFICIAL" then
        strTCRemarks = strTCRemarks & "<br />" & "Is Official is found in Source"
        log.Message "Is Official is found in Source"
      Else
        strTCRemarks = strTCRemarks & "<br />" & "Is Official is not found in Source"
        log.Message "Is Official is  not found in Source"
      End if 
    else
      strTCRemarks = strTCRemarks & "<br />" & "Fields is not found in Source"
    End if
    
    strTemp="WPFObject(""GridColumnHeader"", """", 10)"
    Set objTemp=objEdgeTree.FindChild("Name",strTemp,50)
    if objTemp.Exists=True then
      if UCASE(objTemp.DataContext.Header)="URL" then
        strTCRemarks = strTCRemarks & "<br />" & "URL is found in Source"
        log.Message "URL is found in Layout"
      Else
        strTCRemarks = strTCRemarks & "<br />" & "URL is not found in Source"
        log.Message "URL is not found in Source"
      End if 
    else
      strTCRemarks = strTCRemarks & "<br />" & "Fields is not found in Source"
    End if
   
     strTemp="WPFObject(""GridColumnHeader"", """", 11)"
    Set objTemp=objEdgeTree.FindChild("Name",strTemp,50)
    if objTemp.Exists=True then
      if UCASE(objTemp.DataContext.Header)="MACRO CAP FLAG" then
        strTCRemarks = strTCRemarks & "<br />" & "Macro Cap Flag is found in Source"
        log.Message "Macro Cap Flag is found in Source"
      Else
        strTCRemarks = strTCRemarks & "<br />" & "Macro Cap Flag is not found in Source"
        log.Message "Macro Cap Flag is not found in Source"
      End if 
    else
      strTCRemarks = strTCRemarks & "<br />" & "Fields is not found in Source"
    End if
    
     strTemp="WPFObject(""GridColumnHeader"", """", 12)"
    Set objTemp=objEdgeTree.FindChild("Name",strTemp,50)
    if objTemp.Exists=True then
      if UCASE(objTemp.DataContext.Header)="MACRO PATH" then
        strTCRemarks = strTCRemarks & "<br />" & "Macro Path is found in Source"
        log.Message "Macro Path is found in Source"
      Else
        strTCRemarks = strTCRemarks & "<br />" & "Macro Path is not found in Source"
        log.Message "Macro Path is not found in Source"
      End if 
    else
      strTCRemarks = strTCRemarks & "<br />" & "Fields is not found in Source"
    End if    
    
    strTemp="WPFObject(""GridColumnHeader"","""", 1)"
    Set objTemp=objEdgeTree.FindChild("Name",strTemp,50)
    if objTemp.Exists=True then
      if UCASE(objTemp.DataContext.Header)="REMARKS" then
        strTCRemarks = strTCRemarks & "<br />" & "Remarks is found in Source"
        log.Message "Remarks is found in Source"
      Else
        strTCRemarks = strTCRemarks & "<br />" & "Remarks is not found in Source"
        log.Message "Remarks is not found in Source"
      End if 
    else
      strTCRemarks = strTCRemarks & "<br />" & "Fields is not found in Source"
    End if
    
     strTemp="WPFObject(""GridColumnHeader"", """", 2)"
    Set objTemp=objEdgeTree.FindChild("Name",strTemp,50)
    if objTemp.Exists=True then
      if UCASE(objTemp.DataContext.Header)="VERSION" then
        strTCRemarks = strTCRemarks & "<br />" & "Version is found in Source"
        log.Message "Version is found in Source"
      Else
        strTCRemarks = strTCRemarks & "<br />" & "Version is not found in Source"
        log.Message "Version is not found in Source"
      End if 
    else
      strTCRemarks = strTCRemarks & "<br />" & "Fields is not found in Source"
    End if
    
    strTemp="WPFObject(""GridColumnHeader"", """", 3)"
    Set objTemp=objEdgeTree.FindChild("Name",strTemp,50)
    if objTemp.Exists=True then
      if UCASE(objTemp.DataContext.Header)="LAST UPDATED TIME" then
        strTCRemarks = strTCRemarks & "<br />" & "Last Updated Time is found in Source"
        log.Message "Last Updated Time is found in Source"
      Else
        strTCRemarks = strTCRemarks & "<br />" & "Last Updated Time is not found in Source"
        log.Message "Last Updated Time is not found in Source"
      End if 
    else
      strTCRemarks = strTCRemarks & "<br />" & "Fields is not found in Source"
    End if
    
     strTemp="WPFObject(""GridColumnHeader"", """", 13)"
    Set objTemp=objEdgeTree.FindChild("Name",strTemp,50)
    if objTemp.Exists=True then
      if UCASE(objTemp.DataContext.Header)="LAST UPDATED USER ID" then
        strTCRemarks = strTCRemarks & "<br />" & "Last Updated User ID is found in Source"
        log.Message "Last Updated User ID is found in Source"
      Else
        strTCRemarks = strTCRemarks & "<br />" & "Remarks is not found in Source"
        log.Message "Remarks is not found in Source"
      End if 
    else
      strTCRemarks = strTCRemarks & "<br />" & "Fields is not found in Source"
    End if
    
    
     strTemp="WPFObject(""GridColumnHeader"", """", 14)"
    Set objTemp=objEdgeTree.FindChild("Name",strTemp,50)
    if objTemp.Exists=True then
      if UCASE(objTemp.DataContext.Header)="DISPLAY ORDER" then
        strTCRemarks = strTCRemarks & "<br />" & "Display Order is found in Source"
        log.Message "Display Order is found in Source"
      Else
        strTCRemarks = strTCRemarks & "<br />" & "Display Order is not found in Source"
        log.Message "Display Order is not found in Source"
      End if 
    else
      strTCRemarks = strTCRemarks & "<br />" & "Fields is not found in Source"
    End if
    
    strTemp="WPFObject(""GridColumnHeader"", """", 6)"
    Set objTemp=objEdgeTree.FindChild("Name",strTemp,50)
    if objTemp.Exists=True then
      if UCASE(objTemp.DataContext.Header)="SYSTEM ID" then
        strTCRemarks = strTCRemarks & "<br />" & "System ID is found in Source"
        log.Message "System ID is found in Source"
      Else
        strTCRemarks = strTCRemarks & "<br />" & "System ID is not found in Source"
        log.Message "System ID is not found in Source"
      End if 
    else
      strTCRemarks = strTCRemarks & "<br />" & "Fields is not found in Source"
    End if
    
  else
    strTCRemarks =  "Layout Grid Not found in Layout"
  End if 

End sub


Sub sCheckSourceButton()
On Error Resume Next

  Dim objEdge,strTemp,objTemp,objEdgeTree,strLayoutHeader,GridControl,GridSourceTree,intTotNodeCnt,intI

    set objEdgeTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarSubItemLinkControl", "", 1)
    
    strTemp="WPFObject(""ContentControlEx"", ""New Workspace"", 2)"
    Set objTemp=objEdgeTree.FindChild("Name",strTemp,50)
    if objTemp.Exists=True then
        strTCRemarks = strTCRemarks & "<br />" & "New Workspace Button is found in Source"
        log.Message "New Workspace Button is found in Source"
    Else
      strTCRemarks = strTCRemarks & "<br />" & "New Workspace is not found in Source"
      log.Message "New Workspace Button is not found in Source"
    End if 
    
    set objEdgeTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 2).WPFObject("BarButtonItemLinkControl", "", 1)
    strTemp="WPFObject(""ContentControlEx"", ""Refresh"", 2)"
    Set objTemp=objEdgeTree.FindChild("Name",strTemp,50)
    if objTemp.Exists=True then
        strTCRemarks = strTCRemarks & "<br />" & "Refresh Button is found in Source"
        log.Message "Refresh Button is found in Source"
    Else
      strTCRemarks = strTCRemarks & "<br />" & "Refresh Button is not found in Source"
      log.Message "Refresh Button is not found in Source"
    End if 
    
    set objEdgeTree= Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 3).WPFObject("BarButtonItemLinkControl", "", 1)
    strTemp="WPFObject(""ContentControlEx"", ""New Source Organization"", 2)"
    Set objTemp=objEdgeTree.FindChild("Name",strTemp,50)
    if objTemp.Exists=True then
        strTCRemarks = strTCRemarks & "<br />" & "New Source Organization Button is found in Source"
        log.Message "New Source Organization Button is found in Source"
    Else
      strTCRemarks = strTCRemarks & "<br />" & "New Source Organization Button is not found in Source"
      log.Message "New Source Organization Button is not found in Source"
    End if 
    
    set objEdgeTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 4).WPFObject("BarButtonItemLinkControl", "", 1)
    strTemp="WPFObject(""ContentControlEx"", ""Expand All"", 2)"
    Set objTemp=objEdgeTree.FindChild("Name",strTemp,50)
    if objTemp.Exists=True then
        strTCRemarks = strTCRemarks & "<br />" & "Expand All Button is found in Source"
        log.Message "Expand All Button is found in Source"
    Else
      strTCRemarks = strTCRemarks & "<br />" & "Expand All Button is not found in Source"
      log.Message "Expand All Button is not found in Source"
    End if 
    
    set objEdgeTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 5).WPFObject("BarButtonItemLinkControl", "", 1)
    strTemp="WPFObject(""ContentControlEx"", ""Collapse All"", 2)"
    Set objTemp=objEdgeTree.FindChild("Name",strTemp,50)
    if objTemp.Exists=True then
        strTCRemarks = strTCRemarks & "<br />" & "Collapse All Button is found in Source"
        log.Message "Collapse All Button is found in Source"
    Else
      strTCRemarks = strTCRemarks & "<br />" & "Collapse All Button is not found in Source"
      log.Message "Collapse All Button is not found in Source"
    End if 
    
    set objEdgeTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 6).WPFObject("BarButtonItemLinkControl", "", 1)
    strTemp="WPFObject(""ContentControlEx"", ""Open Global STP"", 2)"
    Set objTemp=objEdgeTree.FindChild("Name",strTemp,50)
    if objTemp.Exists=True then
        strTCRemarks = strTCRemarks & "<br />" & "Open Global STP is found in Source"
        log.Message "Open Global STP Button is found in Source"
    Else
      strTCRemarks = strTCRemarks & "<br />" & "Open Global STP Button is not found in Source"
      log.Message "Open Global STP Button is not found in Source"
    End if 
  
    set objEdgeTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 7).WPFObject("BarButtonItemLinkControl", "", 1)
    strTemp="WPFObject(""ContentControlEx"", ""Open CN STP"", 2)"
    Set objTemp=objEdgeTree.FindChild("Name",strTemp,50)
    if objTemp.Exists=True then
        strTCRemarks = strTCRemarks & "<br />" & "Open CN STP Button is found in Source"
        log.Message "Open CN STP Button is found in Source"
    Else
      strTCRemarks = strTCRemarks & "<br />" & "Open CN STP Button is not found in Source"
      log.Message "Open CN STP Button is not found in Source"
    End if 
End sub

Sub sCheckSourceFindButton()
Dim objEdge
  set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("SourceTreeControl").WPFObject("SourceTreeListView") 
    If objEdge.Exists=True then
      IF objEdge.ShowSearchPanelFindButton=True then
        strTCRemarks = "Find button with text box is found in Source"
        log.Message "Find button with text box is found in Source"
      End if 
    End if
End sub

Sub sCheckSourceNewSourceButton(strParameters)
On Error Resume Next

    Dim strSource_Name,strLevel2src_Name,objNewWrkSpace_okbtn,objNewWrkSpace_Name,strWrkSpaceName
    Dim objNewWrkSpace_Txtbox,objopenforEdit,objWrkspace_popup
    Dim strTemp,objTemp,intRow,barManager,intTotNodeCnt,Text,strDesc1,strDesc2,intI
    Dim objWrkSpace,objwrkspacepop,objwrkspcUpload,objConfirm,objGridCell,DescLocalText,intSeriesID
    Dim layoutGroup
    Dim strTemp1,objNewWrkSpaceName,objEdgeTree
'
    strSource_Name=getSplitValue(strParameters,"SOURCE")
'    strLevel2src_Name=getSplitValue(strParameters,"LEVEL2SOURCE")
    
'    strSource_Name="Test"
    
    Call sHome_Source
    
    strTemp="WPFObject(""SourceTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""SourceTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    Delay 10000,"Pls Wait.."
    ''Selecting Country Name
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource_Name) then
          GridControl.Nodes_2.Item(intI).Expand(True)
          intRow=GridControl.Nodes_2.Item(intI).get_RowHandle
          Call GridControl.ClearSelectionCore
          Call GridControl.FocusViewAndRow(GridControl,intRow)
          GridControl.SetFocusOnCurrentItem
          Call GridControl.SelectRowCore(intRow)  
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description       
          blnFlag=False  
          Exit For
        End If
    Next
    If blnFlag = True then
      strTCRemarks="Country Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
     Delay 10000,"Pls Wait.."
    set objEdgeTree= Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 3).WPFObject("BarButtonItemLinkControl", "", 1)
    strTemp="WPFObject(""ContentControlEx"", ""New Source Organization"", 2)"
    Set objTemp=objEdgeTree.FindChild("Name",strTemp,50)
    if objTemp.Exists=True then
      if objTemp.Enabled=True then
        strTCRemarks = strTCRemarks & "<br />" & "New Source Organization Button is Enabled in Source"
        log.Message "New Source Organization Button is Enabled in Source"
      Else
        strTCRemarks = strTCRemarks & "<br />" & "New Source Organization Button is Disabled in Source"
        log.Message "New Source Organization Button is Disabled in Source"
      End if 
    Else
      strTCRemarks = strTCRemarks & "<br />" & "New Source Organization Button is not found in Source"
      log.Message "New Source Organization Button is not found in Source"
    End if 
    

   Call SClosesource()

End Sub

Sub sCheckSourceNewWorkspaceButton(strParameters)
On Error Resume Next

    Dim strSource_Name,strLevel2src_Name,objNewWrkSpace_okbtn,objNewWrkSpace_Name,strWrkSpaceName
    Dim objNewWrkSpace_Txtbox,objopenforEdit,objWrkspace_popup
    Dim strTemp,objTemp,intRow,barManager,intTotNodeCnt,Text,strDesc1,strDesc2,intI
    Dim objWrkSpace,objwrkspacepop,objwrkspcUpload,objConfirm,objGridCell,DescLocalText,intSeriesID
    Dim layoutGroup
    Dim strTemp1,objNewWrkSpaceName,objEdgeTree
    Dim objEdgeFilter

    strSource_Name=getSplitValue(strParameters,"SOURCE")
'    strLevel2src_Name=getSplitValue(strParameters,"LEVEL2SOURCE")
    
'    strSource_Name="Test"
    
    Call sHome_Source
    
    strTemp="WPFObject(""SourceTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""SourceTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    Delay 10000,"Pls Wait.."
    ''Selecting Country Name
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource_Name) then
          GridControl.Nodes_2.Item(intI).Expand(True)
          intRow=GridControl.Nodes_2.Item(intI).get_RowHandle
          Call GridControl.ClearSelectionCore
          Call GridControl.FocusViewAndRow(GridControl,intRow)
          GridControl.SetFocusOnCurrentItem
          Call GridControl.SelectRowCore(intRow)  
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description       
          blnFlag=False  
          Exit For
        End If
    Next
    If blnFlag = True then
      strTCRemarks="Country Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
     Delay 10000,"Pls Wait.."
    
    strTemp="WPFObject(""ContentControlEx"", ""New Workspace"", 2)"
    Set objTemp=objEdgeTree.FindChild("Name",strTemp,50)
    if objTemp.Exists=True then
        strTCRemarks = strTCRemarks & "<br />" & "New Workspace Button is found in Source"
        log.Message "New Workspace Button is found in Source"
       if objTemp.Enabled=True then
        strTCRemarks = strTCRemarks & "<br />" & "New Workspace Button is Enabled in Source"
        log.Message "New Workspace Button is Enabled in Source"
        Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarSubItemLinkControl", "", 1).Click
        strTemp="WPFObject(""BarPopupBorderControl"", """", 1)"
        Set objWrkspace_popup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).FindChild("Name",strTemp,5,True)
        strTemp="WPFObject(""ContentControlEx"", ""Open For View (Source)"", 2)"
        Set objTemp=objWrkspace_popup.FindChild("Name",strTemp,50)
        If objTemp.Exists = TRUE then
         strTCRemarks = strTCRemarks & "<br />" & "Open For View (Source) is found in Source"
         log.Message "Open For View (Source) is found in Source"
        Else
          strTCRemarks = strTCRemarks & "<br />" & "Open For View (Source) is found in Source"
         log.Message "Open For View (Source) is found in Source" 
        End If
  
        strTemp="WPFObject(""BarPopupBorderControl"", """", 1)"
        Set objWrkspace_popup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).FindChild("Name",strTemp,5,True)
        strTemp="WPFObject(""ContentControlEx"", ""Open For Edit (Source)"", 2)"
        Set objTemp=objWrkspace_popup.FindChild("Name",strTemp,50)
        If objTemp.Exists = TRUE then
           strTCRemarks = strTCRemarks & "<br />" & "Open For Edit (Source) is found in Source"
           log.Message "Open For Edit (Source) is found in Source"
        Else
          strTCRemarks = strTCRemarks & "<br />" & "Open For Edit (Source) is not found in Source"
          log.Message "Open For Edit (Source) is not found in Source"  
        End If
  
        strTemp="WPFObject(""BarPopupBorderControl"", """", 1)"
        Set objWrkspace_popup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).FindChild("Name",strTemp,5,True)
        strTemp="WPFObject(""ContentControlEx"", ""Open For View (Source Schedule)"", 2)"
        Set objTemp=objWrkspace_popup.FindChild("Name",strTemp,50)
        If objTemp.Exists = TRUE then
          strTCRemarks = strTCRemarks & "<br />" & "Open For View (Source Schedule) is found in Source"
          log.Message "Open For View (Source Schedule) is found in Source"
        Else
          strTCRemarks = strTCRemarks & "<br />" & "Open For View (Source Schedule) is not found in Source"
          log.Message "Open For View (Source Schedule) is not found in Source"
        End If
  
        strTemp="WPFObject(""BarPopupBorderControl"", """", 1)"
        Set objWrkspace_popup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).FindChild("Name",strTemp,5,True)
        strTemp="WPFObject(""ContentControlEx"", ""Open For Edit (Source Schedule)"", 2)"
        Set objTemp=objWrkspace_popup.FindChild("Name",strTemp,50)
        If objTemp.Exists = TRUE then
          strTCRemarks = strTCRemarks & "<br />" & "Open For Edit (Source Schedule) is found in Source"
          log.Message "Open For Edit (Source Schedule) is found in Source"
        Else
          strTCRemarks = strTCRemarks & "<br />" & "Open For Edit (Source Schedule) is not found in Source"
          log.Message "Open For Edit (Source Schedule) is not found in Source" 
        End If
      else
        strTCRemarks = strTCRemarks & "<br />" & "New Workspace Button is Disabled in Source"
        log.Message "New Workspace Button is Disabled in Source"
      End if 
    Else
      strTCRemarks = strTCRemarks & "<br />" & "New Workspace is not found in Source"
      log.Message "New Workspace Button is not found in Source"
    End if 
  Call SClosesource()
End Sub



Sub sCheckSourceSecondLevelWorkshop(strParameters)
On Error Resume Next

    Dim strSource_Name,strLevel2src_Name,objNewWrkSpace_okbtn,objNewWrkSpace_Name,strWrkSpaceName
    Dim objNewWrkSpace_Txtbox,objopenforEdit,objWrkspace_popup
    Dim strTemp,objTemp,intRow,barManager,intTotNodeCnt,Text,strDesc1,strDesc2,intI,intJ
    Dim objWrkSpace,objwrkspacepop,objwrkspcUpload,objConfirm,objGridCell,DescLocalText,intSeriesID
    Dim layoutGroup
    Dim strTemp1,objNewWrkSpaceName,objEdgeTree

    strSource_Name=getSplitValue(strParameters,"SOURCE")
    strLevel2src_Name=getSplitValue(strParameters,"LEVEL2SOURCE")
'    
'    strSource_Name="Test"
'    strLevel2src_Name="Automation"
    
    Call sHome_Source
    
    strTemp="WPFObject(""SourceTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""SourceTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    Delay 10000,"Pls Wait.."
    ''Selecting Country Name
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource_Name) then
          GridControl.Nodes_2.Item(intI).Expand(True)
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description       
          blnFlag=False  
          Exit For
        End If
    Next
    If blnFlag = True then
      strTCRemarks="Country Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
     Delay 10000,"Pls Wait.."
        blnFlag = True 
    ''Selecting Level2Source_Name
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
  For intJ=0 to intTotNodeCnt-1
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strLevel2src_Name) then
        GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
        intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
        Call GridControl.ClearSelectionCore
        Call GridControl.FocusViewAndRow(GridControl,intRow)
        GridControl.SetFocusOnCurrentItem
        Call GridControl.SelectRowCore(intRow)
        log.Message "Level2 Source Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
        blnFlag = False 
        Exit For
      End If
    Next
    If blnFlag = True then
      log.Message "Level2 Source Name not found"
      strTCRemarks="Level2 Source Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
    Delay 2000,"Pls Wait.."
    strTemp="WPFObject(""ContentControlEx"", ""New Workspace"", 2)"
    Set objTemp=objEdgeTree.FindChild("Name",strTemp,50)
    if objTemp.Exists=True then
        strTCRemarks = strTCRemarks & "<br />" & "New Workspace Button is found in Source"
        log.Message "New Workspace Button is found in Source"
       if objTemp.Enabled=True then
        strTCRemarks = strTCRemarks & "<br />" & "New Workspace Button is Enabled in Source"
        log.Message "New Workspace Button is Enabled in Source"
        'Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarSubItemLinkControl", "", 1).Click
      else
        strTCRemarks = strTCRemarks & "<br />" & "New Workspace Button is Disabled in Source"
        log.Message "New Workspace Button is Disabled in Source"
      End if 
    Else
      strTCRemarks = strTCRemarks & "<br />" & "New Workspace is not found in Source"
      log.Message "New Workspace Button is not found in Source"
    End if 
 
  Call SClosesource()

End Sub
Sub sCheckSourceRefresh()
On Error Resume Next
    Dim objTemp,strTemp 
    Call sHome_Source
    strTemp="WPFObject(""ContentControlEx"", ""Refresh"", 2)"
    Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 2).WPFObject("BarButtonItemLinkControl", "", 1).FindChild("Name",strTemp,21,True)
    If objTemp.Exists = True then
      objTemp.Click
      Call sEdgeProcessor      
     End If    
End Sub

Sub  sCheckSourceExpandAll(strParameters)
On Error Resume Next 
     Dim strSource_Name,strLevel2src_Name,objNewWrkSpace_okbtn,objNewWrkSpace_Name,strWrkSpaceName
    Dim objNewWrkSpace_Txtbox,objopenforEdit,objWrkspace_popup
    Dim strTemp,objTemp,intRow,barManager,intTotNodeCnt,Text,strDesc1,strDesc2,intI
    Dim objWrkSpace,objwrkspacepop,objwrkspcUpload,objConfirm,objGridCell,DescLocalText,intSeriesID
    Dim layoutGroup
    Dim strTemp1,objNewWrkSpaceName,objEdgeTree
    Dim objEdgeFilter

    strSource_Name=getSplitValue(strParameters,"SOURCE")
'    strLevel2src_Name=getSplitValue(strParameters,"LEVEL2SOURCE")
    
'    strSource_Name="Test"
    
    Call sHome_Source
    
    strTemp="WPFObject(""SourceTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""SourceTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    Delay 10000,"Pls Wait.."
    ''Selecting Country Name
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource_Name) then
          GridControl.Nodes_2.Item(intI).Expand(True)
          intRow=GridControl.Nodes_2.Item(intI).get_RowHandle
          Call GridControl.ClearSelectionCore
          Call GridControl.FocusViewAndRow(GridControl,intRow)
          GridControl.SetFocusOnCurrentItem
          Call GridControl.SelectRowCore(intRow)  
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description       
          blnFlag=False  
          Exit For
        End If
    Next
    If blnFlag = True then
      strTCRemarks="Country Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
     Delay 10000,"Pls Wait.."
  set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1)
  strTemp="WPFObject(""ContentControlEx"", ""Expand All"", 2)"
  Set objTemp=objEdge.FindChild("Name",strTemp,50)
  If objTemp.Exists=True then
    strTCRemarks = "Expand All Button is found in Layout"
    log.Message "Expand All Button is found in Layout"
    objTemp.Click
    strTCRemarks = strTCRemarks & "<br />" &  "Expanded All the tree in Source"
  else
    strTCRemarks =  "Expand All is Not found in Source"
  End if 
  Call SClosesource()
End Sub

Sub  sCheckSourceCollapseAll(strParameters)
On Error Resume Next 
  Dim strSource_Name,strLevel2src_Name,objNewWrkSpace_okbtn,objNewWrkSpace_Name,strWrkSpaceName
    Dim objNewWrkSpace_Txtbox,objopenforEdit,objWrkspace_popup
    Dim strTemp,objTemp,intRow,barManager,intTotNodeCnt,Text,strDesc1,strDesc2,intI
    Dim objWrkSpace,objwrkspacepop,objwrkspcUpload,objConfirm,objGridCell,DescLocalText,intSeriesID
    Dim layoutGroup
    Dim strTemp1,objNewWrkSpaceName,objEdgeTree
    Dim objEdgeFilter

    strSource_Name=getSplitValue(strParameters,"SOURCE")
'    strLevel2src_Name=getSplitValue(strParameters,"LEVEL2SOURCE")
    
'    strSource_Name="Test"
    
    Call sHome_Source
    
    strTemp="WPFObject(""SourceTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""SourceTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    Delay 10000,"Pls Wait.."
    ''Selecting Country Name
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource_Name) then
          GridControl.Nodes_2.Item(intI).Expand(True)
          intRow=GridControl.Nodes_2.Item(intI).get_RowHandle
          Call GridControl.ClearSelectionCore
          Call GridControl.FocusViewAndRow(GridControl,intRow)
          GridControl.SetFocusOnCurrentItem
          Call GridControl.SelectRowCore(intRow)  
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description       
          blnFlag=False  
          Exit For
        End If
    Next
    If blnFlag = True then
      strTCRemarks="Country Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
     Delay 10000,"Pls Wait.."

  set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1)
  strTemp="WPFObject(""ContentControlEx"", ""Collapse All"", 2)"
  Set objTemp=objEdge.FindChild("Name",strTemp,50)
  If objTemp.Exists=True then
    strTCRemarks = "Collapse All Button is found in Source"
    log.Message "Collapse All Button is found in Source"
    objTemp.Click
    strTCRemarks = strTCRemarks & "<br />" &  "Collapse All the tree in Source"
  else
    strTCRemarks =  "Collapse All is Not found in Source"
  End if 
  Call SClosesource()
End Sub

Sub  sCheckSourceExpandandCollapse(strParameters)
On Error Resume Next 
  Dim strSource_Name,strLevel2src_Name,objNewWrkSpace_okbtn,objNewWrkSpace_Name,strWrkSpaceName
    Dim objNewWrkSpace_Txtbox,objopenforEdit,objWrkspace_popup
    Dim strTemp,objTemp,intRow,barManager,intTotNodeCnt,Text,strDesc1,strDesc2,intI
    Dim objWrkSpace,objwrkspacepop,objwrkspcUpload,objConfirm,objGridCell,DescLocalText,intSeriesID
    Dim layoutGroup
    Dim strTemp1,objNewWrkSpaceName,objEdgeTree
    Dim objEdgeFilter

    strSource_Name=getSplitValue(strParameters,"SOURCE")
'    strSource_Name="Test"
    
    Call sHome_Source
    
    strTemp="WPFObject(""SourceTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""SourceTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    Delay 10000,"Pls Wait.."
    ''Selecting Country Name
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource_Name) then
          intRow=GridControl.Nodes_2.Item(intI).get_RowHandle
          Call GridControl.ClearSelectionCore
          Call GridControl.FocusViewAndRow(GridControl,intRow)
          GridControl.SetFocusOnCurrentItem
          Call GridControl.SelectRowCore(intRow)  
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description       
          blnFlag=False  
          Exit For
        End If
    Next
    If blnFlag = True then
      strTCRemarks="Country Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
     Delay 10000,"Pls Wait.."

  set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("SourceTreeControl").WPFObject("SourceTreeListView").WPFObject("HierarchyPanel", "", 1).WPFObject("RowControl", "", 21)
  strTemp="WPFObject(""RowMarginControl"", """", 1)"
  Set objTemp=objEdge.FindChild("Name",strTemp,50)
  If objTemp.Exists=True then
    objTemp.Click
    log.Message "Expanded All in Source"
    strTCRemarks = strTCRemarks & "<br />" &  "Expanded All the tree in Source"
  else
    strTCRemarks =  "Expand is Not found in Source"
  End if 
  
   set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("SourceTreeControl").WPFObject("SourceTreeListView").WPFObject("HierarchyPanel", "", 1).WPFObject("RowControl", "", 21)
  strTemp="WPFObject(""RowMarginControl"", """", 1)"
  Set objTemp=objEdge.FindChild("Name",strTemp,50)
  If objTemp.Exists=True then
    objTemp.Click
    log.Message "Collapse All in Source"
    strTCRemarks = strTCRemarks & "<br />" &  "Collapsed All the tree in Source"
  else
    strTCRemarks =  "Collapse is Not found in Source"
  End if 
  Call SClosesource()
End Sub

Sub  sCheckSourceNewSourceOrganizationFields(strParameters)
On Error Resume Next 
  Dim strSource_Name,strLevel2src_Name,objNewWrkSpace_okbtn,objNewWrkSpace_Name,strWrkSpaceName
    Dim objNewWrkSpace_Txtbox,objopenforEdit,objWrkspace_popup
    Dim strTemp,objTemp,intRow,barManager,intTotNodeCnt,Text,strDesc1,strDesc2,intI
    Dim objWrkSpace,objwrkspacepop,objwrkspcUpload,objConfirm,objGridCell,DescLocalText,intSeriesID
    Dim layoutGroup
    Dim strTemp1,objNewWrkSpaceName,objEdgeTree
    Dim objEdgeFilter

   strSource_Name=getSplitValue(strParameters,"SOURCE")
'   strSource_Name="Test"
    
    Call sHome_Source
    
    strTemp="WPFObject(""SourceTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""SourceTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    Delay 10000,"Pls Wait.."
    ''Selecting Country Name
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource_Name) then
          intRow=GridControl.Nodes_2.Item(intI).get_RowHandle
          Call GridControl.ClearSelectionCore
          Call GridControl.FocusViewAndRow(GridControl,intRow)
          GridControl.SetFocusOnCurrentItem
          Call GridControl.SelectRowCore(intRow)  
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description       
          blnFlag=False  
          Exit For
        End If
    Next
    If blnFlag = True then
      strTCRemarks="Country Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
     Delay 10000,"Pls Wait.."

  set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 3).WPFObject("BarButtonItemLinkControl", "", 1)
  strTemp="WPFObject(""ContentControlEx"", ""New Source Organization"", 2)"
  Set objTemp=objEdge.FindChild("Name",strTemp,50)
  If objTemp.Exists=True then
    If objTemp.Enabled=True then
      strTCRemarks = strTCRemarks & "<br />" & "New Source Organization button found in Source"
      log.Message "New Source Organization button found in Source"
      objTemp.Click
      Delay 5000,"Pls Wait.."
      log.Message "New Source Organization Window opened in Source"
      strTCRemarks = strTCRemarks & "<br />" &  "New Source Organization Window is opened in Source"
     
      set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: Root").WPFObject("Root").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 6)
      strTemp="WPFObject(""IsOfficialCheckEdit"")"
      Set objTemp=objEdge.FindChild("Name",strTemp,50)
      If objTemp.Exists=True then
          strTCRemarks = strTCRemarks & "<br />" & "Is Official Field have Check box option in New Source Organization"
          log.Message "Is Official Field have check box option in New Source Organization"
      else
        strTCRemarks =  "Is Official Field have check box option is Not found in New Source Organization"
      End if
      
      set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: Root").WPFObject("Root").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 10)
      strTemp="WPFObject(""InsertSourceAfterCheckEdit"")"
      Set objTemp=objEdge.FindChild("Name",strTemp,50)
      If objTemp.Exists=True then
          strTCRemarks = strTCRemarks & "<br />" & "Top Field have check box option in New Source Organization"
          log.Message "Top Field have Check box option in New Source Organization"
      else
        strTCRemarks =  "Top Field have Check box option is Not found in New Source Organization"
      End if
      
      
      set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: Root").WPFObject("Root").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 5)
      strTemp="WPFObject(""SourceNatureComboEdit"")"
      Set objTemp=objEdge.FindChild("Name",strTemp,50)
      If objTemp.Exists=True then
          strTCRemarks = strTCRemarks & "<br />" & "Source Nature have dropdown option in New Source Organization"
          log.Message "Source Nature have dropdown option in New Source Organization"
      else
        strTCRemarks =  "Source Nature have dropdown option is Not found in New Source Organization"
      End if
      
      set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: Root").WPFObject("Root").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 10)
      strTemp="WPFObject(""InsertSourceAfterComboEdit"")"
      Set objTemp=objEdge.FindChild("Name",strTemp,50)
      If objTemp.Exists=True then
          strTCRemarks = strTCRemarks & "<br />" & "Insert Source After field have dropdown option in New Source Organization"
          log.Message "Insert Source After field have dropdown option in New Source Organization"
      else
        strTCRemarks =  "Insert Source After field have dropdown option is Not found in New Source Organization"
      End if
      
      set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: Root").WPFObject("Root").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1)
      strTemp="WPFObject(""CancelButton"")"
      Set objTemp=objEdge.FindChild("Name",strTemp,50)
      If objTemp.Exists=True then
          objTemp.Click
          log.Message "Clicked the Cancel Button in New Source Organization"
      else
        strTCRemarks =  "Cancel Button is Not found in New Source Organization"
      End if
      
    End if 
  else
    strTCRemarks =  "New Source Organization button is Not found in Source"
  End if 
  Call SClosesource()
End Sub

Sub  sCheckSourceNewSourceOrganizationButton(strParameters)
On Error Resume Next 
  Dim strSource_Name,strLevel2src_Name,objNewWrkSpace_okbtn,objNewWrkSpace_Name,strWrkSpaceName
    Dim objNewWrkSpace_Txtbox,objopenforEdit,objWrkspace_popup
    Dim strTemp,objTemp,intRow,barManager,intTotNodeCnt,Text,strDesc1,strDesc2,intI
    Dim objWrkSpace,objwrkspacepop,objwrkspcUpload,objConfirm,objGridCell,DescLocalText,intSeriesID
    Dim layoutGroup
    Dim strTemp1,objNewWrkSpaceName,objEdgeTree
    Dim objEdgeFilter

   strSource_Name=getSplitValue(strParameters,"SOURCE")
'   strSource_Name="Test"
    
    Call sHome_Source
    
    strTemp="WPFObject(""SourceTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""SourceTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    Delay 10000,"Pls Wait.."
    ''Selecting Country Name
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource_Name) then
          intRow=GridControl.Nodes_2.Item(intI).get_RowHandle
          Call GridControl.ClearSelectionCore
          Call GridControl.FocusViewAndRow(GridControl,intRow)
          GridControl.SetFocusOnCurrentItem
          Call GridControl.SelectRowCore(intRow)  
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description       
          blnFlag=False  
          Exit For
        End If
    Next
    If blnFlag = True then
      strTCRemarks="Country Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
     Delay 10000,"Pls Wait.."

  set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 3).WPFObject("BarButtonItemLinkControl", "", 1)
  strTemp="WPFObject(""ContentControlEx"", ""New Source Organization"", 2)"
  Set objTemp=objEdge.FindChild("Name",strTemp,50)
  If objTemp.Exists=True then
    If objTemp.Enabled=True then
      strTCRemarks = strTCRemarks & "<br />" & "New Source Organization button found in Source"
      log.Message "New Source Organization button found in Source"
      objTemp.Click
      Delay 5000,"Pls Wait.."
      log.Message "New Source Organization Window opened in Source"
      strTCRemarks = strTCRemarks & "<br />" &  "New Source Organization Window is opened in Source"
     
      set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: Root").WPFObject("Root").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1)
      strTemp="WPFObject(""OkButton"")"
      Set objTemp=objEdge.FindChild("Name",strTemp,50)
      If objTemp.Exists=True then
          strTCRemarks = strTCRemarks & "<br />" & "OK button is found in New Source Organization"
          log.Message "OK button is found  in New Source Organization"
      else
        strTCRemarks =  "OK button is Not found in New Source Organization"
      End if
  
      
      set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: Root").WPFObject("Root").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1)
      strTemp="WPFObject(""CancelButton"")"
      Set objTemp=objEdge.FindChild("Name",strTemp,50)
      If objTemp.Exists=True then
         strTCRemarks = strTCRemarks & "<br />" & "Cancel button is found in New Source Organization"
          log.Message "Cancel button is found  in New Source Organization"
          objTemp.Click
      else
        strTCRemarks =  "Cancel Button is Not found in New Source Organization"
      End if
      
    End if 
  else
    strTCRemarks =  "New Source Organization button is Not found in Source"
  End if 
  Call SClosesource()
End Sub


Sub  sCheckSourceSCExpand(strParameters)
On Error Resume Next 
  Dim strSource_Name,strLevel2src_Name,objNewWrkSpace_okbtn,objNewWrkSpace_Name,strWrkSpaceName
    Dim objNewWrkSpace_Txtbox,objopenforEdit,objWrkspace_popup
    Dim strTemp,objTemp,intRow,barManager,intTotNodeCnt,Text,strDesc1,strDesc2,intI
    Dim objWrkSpace,objwrkspacepop,objwrkspcUpload,objConfirm,objGridCell,DescLocalText,intSeriesID
    Dim layoutGroup
    Dim strTemp1,objNewWrkSpaceName,objEdgeTree
    Dim objEdgeFilter

   strSource_Name=getSplitValue(strParameters,"SOURCE")
'  strSource_Name="Test"
    
    Call sHome_Source
    
    strTemp="WPFObject(""SourceTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""SourceTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    Delay 10000,"Pls Wait.."
    ''Selecting Country Name
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource_Name) then
          intRow=GridControl.Nodes_2.Item(intI).get_RowHandle
          Call GridControl.ClearSelectionCore
          Call GridControl.FocusViewAndRow(GridControl,intRow)
          GridControl.SetFocusOnCurrentItem
          Call GridControl.SelectRowCore(intRow)  
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description       
          blnFlag=False  
          Exit For
        End If
    Next
    If blnFlag = True then
      strTCRemarks="Country Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
     Delay 10000,"Pls Wait.."
     GridControl.Keys "^[Enter]" 
    Call SClosesource()
End Sub

Sub  sCheckSourceSCCollapse(strParameters)
On Error Resume Next 
  Dim strSource_Name,strLevel2src_Name,objNewWrkSpace_okbtn,objNewWrkSpace_Name,strWrkSpaceName
    Dim objNewWrkSpace_Txtbox,objopenforEdit,objWrkspace_popup
    Dim strTemp,objTemp,intRow,barManager,intTotNodeCnt,Text,strDesc1,strDesc2,intI
    Dim objWrkSpace,objwrkspacepop,objwrkspcUpload,objConfirm,objGridCell,DescLocalText,intSeriesID
    Dim layoutGroup
    Dim strTemp1,objNewWrkSpaceName,objEdgeTree
    Dim objEdgeFilter

   strSource_Name=getSplitValue(strParameters,"SOURCE")
'     strSource_Name="Test"
    
    Call sHome_Source
    
    strTemp="WPFObject(""SourceTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""SourceTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    Delay 10000,"Pls Wait.."
    ''Selecting Country Name
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource_Name) then
          intRow=GridControl.Nodes_2.Item(intI).get_RowHandle
          Call GridControl.ClearSelectionCore
          Call GridControl.FocusViewAndRow(GridControl,intRow)
          GridControl.SetFocusOnCurrentItem
          Call GridControl.SelectRowCore(intRow)  
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description       
          blnFlag=False  
          Exit For
        End If
    Next
    If blnFlag = True then
      strTCRemarks="Country Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
     Delay 10000,"Pls Wait.."
     GridControl.Keys "^[Enter]" 
     strTCRemarks = strTCRemarks & "<br />" & "Expanded all childs for selected Source "
     log.Message "Expanded all childs for selected Source"
     
     Delay 10000,"Pls Wait.."
     GridControl.Keys "[Enter]" 
     strTCRemarks = strTCRemarks & "<br />" & "Collapse all childs for selected Source "
     log.Message "Collapse all childs for selected Source"
    Call SClosesource()
End Sub

Sub sCheckSourceGlobalSTP(strParameters)
On Error Resume Next

   Dim strSource1,StrSource2,strSource3,strTemp,GridControl,GridSourceTree,intTotNodeCnt,intI,intJ,intRow,intK,objEdge
   Dim objArray,i,oSTP_ExcelObj
   
   
    strSource1=getSplitValue(strParameters,"SOURCE")
    StrSource2=getSplitValue(strParameters,"LEVEL2SOURCE")
    StrSource3=getSplitValue(strParameters,"LEVEL3SOURCE")

'    strSource1="Test"
'    StrSource2="Automation"
'    StrSource3="Test Source 1"
'    
    
     Call sHome_Source
    strTemp="WPFObject(""SourceTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""SourceTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    Delay 10000,"Pls Wait.."
    ''Selecting Country Name
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
          GridControl.Nodes_2.Item(intI).Expand(True)
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description       
          blnFlag=False  
          Exit For
        End If
    Next
    If blnFlag = True then
      strTCRemarks="Country Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
  
    Delay 10000,"Pls Wait.."
        blnFlag = True 
    ''Selecting Level2Source_Name
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
  For intJ=0 to intTotNodeCnt-1
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(StrSource2) then
        GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
        intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
'        Call GridSourceTree.ClickCell(intRow, "Edit")
        Call GridControl.ClearSelectionCore
        Call GridControl.FocusViewAndRow(GridControl,intRow)
        GridControl.SetFocusOnCurrentItem
        Call GridControl.SelectRowCore(intRow)
        log.Message "Level2 Source Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
        blnFlag = False 
        Exit For
      End If
    Next
    If blnFlag = True then
      log.Message "Level2 Source Name not found"
      strTCRemarks="Level2 Source Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
    Delay 2000,"Pls Wait.."
    
    ''Selecting Level3 Layout
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count
    For intK=0 to intTotNodeCnt-1
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description)=Ucase(StrSource3) then
        GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Expand(True)
        intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).get_RowHandle
        Call GridControl.ClearSelectionCore
        Call GridControl.FocusViewAndRow(GridControl,intRow)
        GridControl.SetFocusOnCurrentItem
        Call GridControl.SelectRowCore(intRow)
        log.Message "Level3 Source Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description
        blnFlag = False
        Exit For   
      End If 
    Next
    
    
    set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 6).WPFObject("BarButtonItemLinkControl", "", 1)
      strTemp="WPFObject(""ContentControlEx"", ""Open Global STP"", 2)"
      Set objTemp=objEdge.FindChild("Name",strTemp,50)
      If objTemp.Exists=True then
        If objTemp.Enabled=True then
         strTCRemarks = strTCRemarks & "<br />" & "Open Global STP is found in Source"
          log.Message "Open Global STP is found  in Source"
          objTemp.Click
           Delay 6000,"Opening STP.. Pls wait.."
           ''Selecting Full History in STP
           Call sExcelFullHistory
         Else
          strTCRemarks = strTCRemarks & "<br />" & "Open Global STP is Disabled in Source"
        end if
      else
        strTCRemarks =  "Open Global STP is Not found in Source"
      End if  
  
      objArray = Sys.FindAllChildren("ProcessName","EXCEL", 5,True)
      For i=0 to ubound(objArray)
        log.Message objArray(i).FullName
        set oSTP_ExcelObj = objArray(i).FindChild("WndCaption", "*RUN*",1,True)
        If oSTP_ExcelObj.Exists = True Then
        Else
          objArray(i).Close
        End If
      Next    
End Sub


Sub sCheckSourceCNSTP(strParameters)
On Error Resume Next

   Dim strSource1,StrSource2,strSource3,strTemp,GridControl,GridSourceTree,intTotNodeCnt,intI,intJ,intRow,intK,objEdge
   Dim objArray,i,oSTP_ExcelObj
   
   
    strSource1=getSplitValue(strParameters,"SOURCE")
    StrSource2=getSplitValue(strParameters,"LEVEL2SOURCE")
    StrSource3=getSplitValue(strParameters,"LEVEL3SOURCE")

'    strSource1="Test"
'    StrSource2="Automation"
'    StrSource3="Test Source 1"
'    
    
     Call sHome_Source
    strTemp="WPFObject(""SourceTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""SourceTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    Delay 10000,"Pls Wait.."
    ''Selecting Country Name
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
          GridControl.Nodes_2.Item(intI).Expand(True)
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description       
          blnFlag=False  
          Exit For
        End If
    Next
    If blnFlag = True then
      strTCRemarks="Country Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
  
    Delay 10000,"Pls Wait.."
        blnFlag = True 
    ''Selecting Level2Source_Name
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
  For intJ=0 to intTotNodeCnt-1
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(StrSource2) then
        GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
        intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
'        Call GridSourceTree.ClickCell(intRow, "Edit")
        Call GridControl.ClearSelectionCore
        Call GridControl.FocusViewAndRow(GridControl,intRow)
        GridControl.SetFocusOnCurrentItem
        Call GridControl.SelectRowCore(intRow)
        log.Message "Level2 Source Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
        blnFlag = False 
        Exit For
      End If
    Next
    If blnFlag = True then
      log.Message "Level2 Source Name not found"
      strTCRemarks="Level2 Source Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
    Delay 2000,"Pls Wait.."
    
    ''Selecting Level3 Layout
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count
    For intK=0 to intTotNodeCnt-1
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description)=Ucase(StrSource3) then
        GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Expand(True)
        intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).get_RowHandle
        Call GridControl.ClearSelectionCore
        Call GridControl.FocusViewAndRow(GridControl,intRow)
        GridControl.SetFocusOnCurrentItem
        Call GridControl.SelectRowCore(intRow)
        log.Message "Level3 Source Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description
        blnFlag = False
        Exit For   
      End If 
    Next
    
    
      set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 7).WPFObject("BarButtonItemLinkControl", "", 1)
      strTemp="WPFObject(""ContentControlEx"", ""Open CN STP"", 2)"
      Set objTemp=objEdge.FindChild("Name",strTemp,50)
      If objTemp.Exists=True then
        If objTemp.Enabled=True then
         strTCRemarks = strTCRemarks & "<br />" & "Open CN STP is found in Source"
          log.Message "Open CN STP is found  in Source"
          objTemp.Click
           Delay 6000,"Opening STP.. Pls wait.."
           ''Selecting Full History in STP
           Call sExcelFullHistory
         Else
          strTCRemarks = strTCRemarks & "<br />" & "Open CN STP is Disabled in Source"
        end if
      else
        strTCRemarks =  "Open Global STP is Not found in Source"
      End if  
  
      objArray = Sys.FindAllChildren("ProcessName","EXCEL", 5,True)
      For i=0 to ubound(objArray)
        log.Message objArray(i).FullName
        set oSTP_ExcelObj = objArray(i).FindChild("WndCaption", "*RUN*",1,True)
        If oSTP_ExcelObj.Exists = True Then
        Else
          objArray(i).Close
        End If
      Next    
End Sub
Sub  sCheckSourceNewSourceOrganization(strParameters)
On Error Resume Next 
  Dim strSource_Name,strLevel2src_Name,objNewWrkSpace_okbtn,objNewWrkSpace_Name,strWrkSpaceName
    Dim objNewWrkSpace_Txtbox,objopenforEdit,objWrkspace_popup
    Dim strTemp,objTemp,intRow,barManager,intTotNodeCnt,Text,strDesc1,strDesc2,intI
    Dim objWrkSpace,objwrkspacepop,objwrkspcUpload,objConfirm,objGridCell,DescLocalText,intSeriesID
    Dim layoutGroup
    Dim strTemp1,objNewWrkSpaceName,objEdgeTree
    Dim objEdgeFilter

   strSource_Name=getSplitValue(strParameters,"SOURCE")
'   strSource_Name="Test"
    
    Call sHome_Source
    
    strTemp="WPFObject(""SourceTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""SourceTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    Delay 10000,"Pls Wait.."
    ''Selecting Country Name
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource_Name) then
          intRow=GridControl.Nodes_2.Item(intI).get_RowHandle
          Call GridControl.ClearSelectionCore
          Call GridControl.FocusViewAndRow(GridControl,intRow)
          GridControl.SetFocusOnCurrentItem
          Call GridControl.SelectRowCore(intRow)  
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description       
          blnFlag=False  
          Exit For
        End If
    Next
    If blnFlag = True then
      strTCRemarks="Country Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
     Delay 10000,"Pls Wait.."

  set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 3).WPFObject("BarButtonItemLinkControl", "", 1)
  strTemp="WPFObject(""ContentControlEx"", ""New Source Organization"", 2)"
  Set objTemp=objEdge.FindChild("Name",strTemp,50)
  If objTemp.Exists=True then
    If objTemp.Enabled=True then
      strTCRemarks = strTCRemarks & "<br />" & "New Source Organization button found in Source"
      log.Message "New Source Organization button found in Source"
      objTemp.Click
      Delay 5000,"Pls Wait.."
      log.Message "New Source Organization Window opened in Source"
      strTCRemarks = strTCRemarks & "<br />" &  "New Source Organization Window is opened in Source"
     
      set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: Root").WPFObject("Root").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 1)
      strTemp="WPFObject(""Label"", ""Country:"", 1)"
      Set objTemp=objEdge.FindChild("Name",strTemp,50)
      If objTemp.Exists=True then
          strTCRemarks = strTCRemarks & "<br />" & "Country Field found in New Source Organization"
          log.Message "Country Field found in New Source Organization"
      else
        strTCRemarks = "Country Field found in New Source Organization"
      End if
      
      set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: Root").WPFObject("Root").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 2)
      strTemp="WPFObject(""Label"", ""Source Abbreviation:"", 1)"
      Set objTemp=objEdge.FindChild("Name",strTemp,50)
      If objTemp.Exists=True then
          strTCRemarks = strTCRemarks & "<br />" & "Source Abbreviation Field found in New Source Organization"
          log.Message "Source Abbreviation Field found in New Source Organization"
      else
        strTCRemarks = "Source Abbreviation Field found in New Source Organization"
      End if
      
      set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: Root").WPFObject("Root").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 3)
      strTemp="WPFObject(""Label"", ""Source Description:"", 1)"
      Set objTemp=objEdge.FindChild("Name",strTemp,50)
      If objTemp.Exists=True then
          strTCRemarks = strTCRemarks & "<br />" & "Source Description Field found in New Source Organization"
          log.Message "Source Description Field found in New Source Organization"
      else
        strTCRemarks = "Source Description Field found in New Source Organization"
      End if
      
      set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: Root").WPFObject("Root").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 4)
      strTemp="WPFObject(""Label"", ""Source Description Local:"", 1)"
      Set objTemp=objEdge.FindChild("Name",strTemp,50)
      If objTemp.Exists=True then
          strTCRemarks = strTCRemarks & "<br />" & "Source Description Local Field found in New Source Organization"
          log.Message "Source Description Local Field found in New Source Organization"
      else
        strTCRemarks = "Source Description Local Field found in New Source Organization"
      End if
     
      set objEdge= Sys.Process("EdgeClient").WPFObject("HwndSource: Root").WPFObject("Root").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 5)
      strTemp="WPFObject(""Label"", ""Source Nature:"", 1)"
      Set objTemp=objEdge.FindChild("Name",strTemp,50)
      If objTemp.Exists=True then
          strTCRemarks = strTCRemarks & "<br />" & "Source Nature Field found in New Source Organization"
          log.Message "Source Nature Field found in New Source Organization"
      else
        strTCRemarks = "Source Nature Field found in New Source Organization"
      End if
      
      set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: Root").WPFObject("Root").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 6)
      strTemp="WPFObject(""Label"", ""Is Official:"", 1)"
      Set objTemp=objEdge.FindChild("Name",strTemp,50)
      If objTemp.Exists=True then
          strTCRemarks = strTCRemarks & "<br />" & "Is Official Field found in New Source Organization"
          log.Message "Is Official Field found in New Source Organization"
      else
        strTCRemarks = "Is Official Field found in New Source Organization"
      End if
      
      set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: Root").WPFObject("Root").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 7)
      strTemp="WPFObject(""Label"", ""URL:"", 1)"
      Set objTemp=objEdge.FindChild("Name",strTemp,50)
      If objTemp.Exists=True then
          strTCRemarks = strTCRemarks & "<br />" & "URL Field found in New Source Organization"
          log.Message "URL Field found in New Source Organization"
      else
        strTCRemarks = "URL Field found in New Source Organization"
      End if
      
      set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: Root").WPFObject("Root").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 8)
      strTemp="WPFObject(""Label"", ""Macro Cap Flag:"", 1)"
      Set objTemp=objEdge.FindChild("Name",strTemp,50)
      If objTemp.Exists=True then
          strTCRemarks = strTCRemarks & "<br />" & "Macro Cap Flag Field found in New Source Organization"
          log.Message "Macro Cap Flag Field found in New Source Organization"
      else
        strTCRemarks = "Macro Cap Flag Field found in New Source Organization"
      End if
      
      set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: Root").WPFObject("Root").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 9)
      strTemp="WPFObject(""Label"", ""Macro Path:"", 1)"
      Set objTemp=objEdge.FindChild("Name",strTemp,50)
      If objTemp.Exists=True then
          strTCRemarks = strTCRemarks & "<br />" & "Macro Path Field found in New Source Organization"
          log.Message "Macro Path Field found in New Source Organization"
      else
        strTCRemarks = "Macro Path Field found in New Source Organization"
      End if
      
      set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: Root").WPFObject("Root").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 10)
      strTemp="WPFObject(""Label"", ""Insert Source After:"", 1)"
      Set objTemp=objEdge.FindChild("Name",strTemp,50)
      If objTemp.Exists=True then
          strTCRemarks = strTCRemarks & "<br />" & "Insert Source After Field found in New Source Organization"
          log.Message "Insert Source After Field found in New Source Organization"
      else
        strTCRemarks = "Insert Source After Field found in New Source Organization"
      End if
 
      set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: Root").WPFObject("Root").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 2)
      strTemp="WPFObject(""SourceCodeTextEdit"")"
      Set objTemp=objEdge.FindChild("Name",strTemp,50)
      If objTemp.Exists=True then
          strTCRemarks = strTCRemarks & "<br />" & "Source Abbreviation have Edit option in New Source Organization"
          log.Message "Source Abbreviation have Edit option in New Source Organization"
      else
        strTCRemarks =  "Source Abbreviation have Edit option in New Source Organization"
      End if
      
      set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: Root").WPFObject("Root").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 3)
      strTemp="WPFObject(""SourceDescTextEdit"")"
      Set objTemp=objEdge.FindChild("Name",strTemp,50)
      If objTemp.Exists=True then
          strTCRemarks = strTCRemarks & "<br />" & "Source Description have Edit option in New Source Organization"
          log.Message "Source Description have Edit option in New Source Organization"
      else
        strTCRemarks =  "Source Description have Edit option in New Source Organization"
      End if
      
      set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: Root").WPFObject("Root").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 4)
      strTemp="WPFObject(""SourceDescLocTextEdit"")"
      Set objTemp=objEdge.FindChild("Name",strTemp,50)
      If objTemp.Exists=True then
          strTCRemarks = strTCRemarks & "<br />" & "Source Description Local have Edit option in New Source Organization"
          log.Message "Source Description Local have Edit option in New Source Organization"
      else
        strTCRemarks =  "Source Description Local have Edit option in New Source Organization"
      End if
      
      set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: Root").WPFObject("Root").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 7)
      strTemp="WPFObject(""UrlTextEdit"")"
      Set objTemp=objEdge.FindChild("Name",strTemp,50)
      If objTemp.Exists=True then
          strTCRemarks = strTCRemarks & "<br />" & "URL have Edit option in New Source Organization"
          log.Message "URL have Edit option in New Source Organization"
      else
        strTCRemarks =  "URL have Edit option in New Source Organization"
      End if
      
      set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: Root").WPFObject("Root").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 8)
      strTemp="WPFObject(""MacroCapFlagTextEdit"")"
      Set objTemp=objEdge.FindChild("Name",strTemp,50)
      If objTemp.Exists=True then
          strTCRemarks = strTCRemarks & "<br />" & "Macro Cap Flag have Edit option in New Source Organization"
          log.Message "Macro Cap Flag have Edit option in New Source Organization"
      else
        strTCRemarks =  "Macro Cap Flag have Edit option in New Source Organization"
      End if
      
      set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: Root").WPFObject("Root").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 9)
      strTemp="WPFObject(""MacroPathTextEdit"")"
      Set objTemp=objEdge.FindChild("Name",strTemp,50)
      If objTemp.Exists=True then
          strTCRemarks = strTCRemarks & "<br />" & "Macro Path have Edit option in New Source Organization"
          log.Message "Macro Path have Edit option in New Source Organization"
      else
        strTCRemarks =  "Macro Path have Edit option in New Source Organization"
      End if
      
      set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: Root").WPFObject("Root").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1)
      strTemp="WPFObject(""CancelButton"")"
      Set objTemp=objEdge.FindChild("Name",strTemp,50)
      If objTemp.Exists=True then
          objTemp.Click
          log.Message "Clicked the Cancel Button in New Source Organization"
      else
        strTCRemarks =  "Cancel Button is Not found in New Source Organization"
      End if
      
    End if 
  else
    strTCRemarks =  "New Source Organization button is Not found in Source"
  End if 
  Call SClosesource()
End Sub
Sub  sCheckSourceNewSourceOrganizationValidation(strParameters)
On Error Resume Next 
  Dim strSource_Name,strLevel2src_Name,objNewWrkSpace_okbtn,objNewWrkSpace_Name,strWrkSpaceName
    Dim objNewWrkSpace_Txtbox,objopenforEdit,objWrkspace_popup
    Dim strTemp,objTemp,intRow,barManager,intTotNodeCnt,Text,strDesc1,strDesc2,intI
    Dim objWrkSpace,objwrkspacepop,objwrkspcUpload,objConfirm,objGridCell,DescLocalText,intSeriesID
    Dim layoutGroup
    Dim strTemp1,objNewWrkSpaceName,objEdgeTree
    Dim objEdgeFilter

   strSource_Name=getSplitValue(strParameters,"SOURCE")
'   strSource_Name="Test"
    
    Call sHome_Source
    
    strTemp="WPFObject(""SourceTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""SourceTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    Delay 10000,"Pls Wait.."
    ''Selecting Country Name
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource_Name) then
          intRow=GridControl.Nodes_2.Item(intI).get_RowHandle
          Call GridControl.ClearSelectionCore
          Call GridControl.FocusViewAndRow(GridControl,intRow)
          GridControl.SetFocusOnCurrentItem
          Call GridControl.SelectRowCore(intRow)  
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description       
          blnFlag=False  
          Exit For
        End If
    Next
    If blnFlag = True then
      strTCRemarks="Country Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
     Delay 10000,"Pls Wait.."

  set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 3).WPFObject("BarButtonItemLinkControl", "", 1)
  strTemp="WPFObject(""ContentControlEx"", ""New Source Organization"", 2)"
  Set objTemp=objEdge.FindChild("Name",strTemp,50)
  If objTemp.Exists=True then
    If objTemp.Enabled=True then
      strTCRemarks = strTCRemarks & "<br />" & "New Source Organization button found in Source"
      log.Message "New Source Organization button found in Source"
      objTemp.Click
      Delay 5000,"Pls Wait.."
      log.Message "New Source Organization Window opened in Source"
      strTCRemarks = strTCRemarks & "<br />" &  "New Source Organization Window is opened in Source"
     
      set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: Root").WPFObject("Root").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 2)
      strTemp="WPFObject(""SourceCodeTextEdit"")"
      Set objTemp=objEdge.FindChild("Name",strTemp,50)
      If objTemp.Exists=True then
          Sys.Process("EdgeClient").WPFObject("HwndSource: Root").WPFObject("Root").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 2).WPFObject("SourceCodeTextEdit").Text="t1"
            set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: Root").WPFObject("Root").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1)
            strTemp="WPFObject(""OkButton"")"
            Set objTemp=objEdge.FindChild("Name",strTemp,50)
            If objTemp.Exists=True then
                objTemp.Click
                log.Message "Clicked the OK Button in New Source Organization"
            else
              strTCRemarks =  "Ok Button is Not found in New Source Organization"
            End if
              set objEdge= Sys.Process("EdgeClient").WPFObject("HwndSource: Root").WPFObject("Root").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1)
              strTemp="WPFObject(""ErrorMsg"")"
              Set objTemp=objEdge.FindChild("Name",strTemp,50)
              If objTemp.Exists=True then
                  strTCRemarks = strTCRemarks & "<br />" & "Enter Source Description in New Source Organization"
                  log.Message "Enter Source Description in New Source Organization"
              End if
      else
        strTCRemarks =  "Source Abbreviation have Edit option in New Source Organization"
      End if
      
      set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: Root").WPFObject("Root").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 3)
      strTemp="WPFObject(""SourceDescTextEdit"")"
      Set objTemp=objEdge.FindChild("Name",strTemp,50)
      If objTemp.Exists=True then
          Sys.Process("EdgeClient").WPFObject("HwndSource: Root").WPFObject("Root").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 3).WPFObject("SourceDescTextEdit").Text="t2"
           set objEdge= Sys.Process("EdgeClient").WPFObject("HwndSource: Root").WPFObject("Root").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1)
            strTemp="WPFObject(""ErrorMsg"")"
            Set objTemp=objEdge.FindChild("Name",strTemp,50)
            If objTemp.Exists=True then
                strTCRemarks = strTCRemarks & "<br />" & "Enter Source Description Local in New Source Organization"
                log.Message "Enter Source Description Local have Edit option in New Source Organization"
            End if
            
            set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: Root").WPFObject("Root").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1)
            strTemp="WPFObject(""OkButton"")"
            Set objTemp=objEdge.FindChild("Name",strTemp,50)
            If objTemp.Exists=True then
                objTemp.Click
                log.Message "Clicked the OK Button in New Source Organization"
            else
                strTCRemarks =  "Ok Button is Not found in New Source Organization"
            End if
      else
        strTCRemarks =  "Source Description have Edit option in New Source Organization"
      End if
      
      set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: Root").WPFObject("Root").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 4)
      strTemp="WPFObject(""SourceDescLocTextEdit"")"
      Set objTemp=objEdge.FindChild("Name",strTemp,50)
      If objTemp.Exists=True then
          Sys.Process("EdgeClient").WPFObject("HwndSource: Root").WPFObject("Root").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 4).WPFObject("SourceDescLocTextEdit").Text="t3"
      End if
         
     set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: Root").WPFObject("Root").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1)
      strTemp="WPFObject(""OkButton"")"
      Set objTemp=objEdge.FindChild("Name",strTemp,50)
      If objTemp.Exists=True then
          objTemp.Click
          log.Message "Clicked the OK Button in New Source Organization"
      else
        strTCRemarks =  "Ok Button is Not found in New Source Organization"
      End if
'      
    End if 
  else
    strTCRemarks =  "New Source Organization button is Not found in Source"
  End if 
  set objEdge= Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "Attention").WPFObject("CustomMessageBoxWindow", "Attention", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1)
  strTemp="WPFObject(""PART_ContainerContent"")"
  Set objTemp=objEdge.FindChild("Name",strTemp,50)
  If objTemp.Exists=True then
      objTemp.Click
      SYS.Keys "[Enter]"
  End if
  Call SClosesource()
End Sub


Sub  sCheckSourceSaveNewSourceOrganization(strParameters)
On Error Resume Next 
  Dim strSource_Name,strLevel2src_Name,objNewWrkSpace_okbtn,objNewWrkSpace_Name,strWrkSpaceName
    Dim objNewWrkSpace_Txtbox,objopenforEdit,objWrkspace_popup
    Dim strTemp,objTemp,intRow,barManager,intTotNodeCnt,Text,strDesc1,strDesc2,intI
    Dim objWrkSpace,objwrkspacepop,objwrkspcUpload,objConfirm,objGridCell,DescLocalText,intSeriesID
    Dim layoutGroup
    Dim strTemp1,objNewWrkSpaceName,objEdgeTree
    Dim objEdgeFilter

   strSource_Name=getSplitValue(strParameters,"SOURCE")
'   strSource_Name="Test"
    
   
   strDesc1=aqDateTime.Now
    strDesc2=aqDateTime.Now
    DescText=Replace(strDesc1,"/","-")
    DescText=Replace(DescText,":","_")
    DescLocalText=DescText
    strWrkSpaceName=DescText
    Call sHome_Source
    
    strTemp="WPFObject(""SourceTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""SourceTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    Delay 10000,"Pls Wait.."
    ''Selecting Country Name
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource_Name) then
          intRow=GridControl.Nodes_2.Item(intI).get_RowHandle
          Call GridControl.ClearSelectionCore
          Call GridControl.FocusViewAndRow(GridControl,intRow)
          GridControl.SetFocusOnCurrentItem
          Call GridControl.SelectRowCore(intRow)  
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description       
          blnFlag=False  
          Exit For
        End If
    Next
    If blnFlag = True then
      strTCRemarks="Country Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
     Delay 10000,"Pls Wait.."

  set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 3).WPFObject("BarButtonItemLinkControl", "", 1)
  strTemp="WPFObject(""ContentControlEx"", ""New Source Organization"", 2)"
  Set objTemp=objEdge.FindChild("Name",strTemp,50)
  If objTemp.Exists=True then
    If objTemp.Enabled=True then
      strTCRemarks = strTCRemarks & "<br />" & "New Source Organization button found in Source"
      log.Message "New Source Organization button found in Source"
      objTemp.Click
      Delay 5000,"Pls Wait.."
      log.Message "New Source Organization Window opened in Source"
      strTCRemarks = strTCRemarks & "<br />" &  "New Source Organization Window is opened in Source"
     
     
      set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: Root").WPFObject("Root").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 2)
      strTemp="WPFObject(""SourceCodeTextEdit"")"
      Set objTemp=objEdge.FindChild("Name",strTemp,50)
      If objTemp.Exists=True then
          Sys.Process("EdgeClient").WPFObject("HwndSource: Root").WPFObject("Root").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 2).WPFObject("SourceCodeTextEdit").Text=strWrkSpaceName 
      else
        strTCRemarks =  "Source Abbreviation is not having Edit option in New Source Organization"
      End if
      
      set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: Root").WPFObject("Root").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 3)
      strTemp="WPFObject(""SourceDescTextEdit"")"
      Set objTemp=objEdge.FindChild("Name",strTemp,50)
      If objTemp.Exists=True then
          Sys.Process("EdgeClient").WPFObject("HwndSource: Root").WPFObject("Root").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 3).WPFObject("SourceDescTextEdit").Text=strWrkSpaceName
      else
        strTCRemarks =  "Source Description have Edit option in New Source Organization"
      End if
      
      set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: Root").WPFObject("Root").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 4)
      strTemp="WPFObject(""SourceDescLocTextEdit"")"
      Set objTemp=objEdge.FindChild("Name",strTemp,50)
      If objTemp.Exists=True then
          Sys.Process("EdgeClient").WPFObject("HwndSource: Root").WPFObject("Root").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 4).WPFObject("SourceDescLocTextEdit").Text=strWrkSpaceName
      else
        strTCRemarks =  "Source Description Local have Edit option in New Source Organization"
      End if
    
      set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: Root").WPFObject("Root").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 8)
      strTemp="WPFObject(""MacroCapFlagTextEdit"")"
      Set objTemp=objEdge.FindChild("Name",strTemp,50)
      If objTemp.Exists=True then
          Sys.Process("EdgeClient").WPFObject("HwndSource: Root").WPFObject("Root").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 8).WPFObject("MacroCapFlagTextEdit").Text="t4"
      else
        strTCRemarks =  "Macro Cap Flag have Edit option in New Source Organization"
      End if
      
      set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: Root").WPFObject("Root").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 9)
      strTemp="WPFObject(""MacroPathTextEdit"")"
      Set objTemp=objEdge.FindChild("Name",strTemp,50)
      If objTemp.Exists=True then
          Sys.Process("EdgeClient").WPFObject("HwndSource: Root").WPFObject("Root").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 9).WPFObject("MacroPathTextEdit").Text="t5"
      else
        strTCRemarks =  "Macro Path have Edit option in New Source Organization"
      End if
      
      Sys.Process("EdgeClient").WPFObject("HwndSource: Root").WPFObject("Root").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 6).WPFObject("IsOfficialCheckEdit").IsChecked=True
      Sys.Process("EdgeClient").WPFObject("HwndSource: Root").WPFObject("Root").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 5).WPFObject("SourceNatureComboEdit").Selectedindex = 1
      set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: Root").WPFObject("Root").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1)
      strTemp="WPFObject(""OkButton"")"
      Set objTemp=objEdge.FindChild("Name",strTemp,50)
      If objTemp.Exists=True then
          objTemp.Click
          log.Message "Clicked the OK Button in New Source Organization"
      else
        strTCRemarks =  "Ok Button is Not found in New Source Organization"
      End if
     Call sEdgeProcessor
     Delay 15000,"Pls Wait.."
'    Dim strOk
'    strTemp="WPFObject(""DXMessageBox"", """", 1)"
'    Set strOk=Sys.Process("EdgeClient").WPFObject("HwndSource: WindowContentHolder", "Attention").WPFObject("WindowContentHolder", "Attention", 1).WPFObject("NonLogicalDecorator", "", 1).WPFObject("ThemedManagedContentPresenter", "", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WaitChild(strTemp,500000)
'    If strOk.Exists Then
'      SYS.Keys "[Enter]"
'    End If

    End if 
  else
    strTCRemarks =  "New Source Organization button is Not found in Source"
  End if 
  Call SClosesource()
End Sub

Sub  sCheckSourceDuplicateNewSourceOrganization(strParameters)
On Error Resume Next 
  Dim strSource_Name,strLevel2src_Name,objNewWrkSpace_okbtn,objNewWrkSpace_Name,strWrkSpaceName
    Dim objNewWrkSpace_Txtbox,objopenforEdit,objWrkspace_popup
    Dim strTemp,objTemp,intRow,barManager,intTotNodeCnt,Text,strDesc1,strDesc2,intI
    Dim objWrkSpace,objwrkspacepop,objwrkspcUpload,objConfirm,objGridCell,DescLocalText,intSeriesID
    Dim layoutGroup
    Dim strTemp1,objNewWrkSpaceName,objEdgeTree
    Dim objEdgeFilter

   strSource_Name=getSplitValue(strParameters,"SOURCE")
'   strSource_Name="Test"
    
    Call sHome_Source
    
    strTemp="WPFObject(""SourceTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""SourceTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    Delay 10000,"Pls Wait.."
    ''Selecting Country Name
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource_Name) then
          intRow=GridControl.Nodes_2.Item(intI).get_RowHandle
          Call GridControl.ClearSelectionCore
          Call GridControl.FocusViewAndRow(GridControl,intRow)
          GridControl.SetFocusOnCurrentItem
          Call GridControl.SelectRowCore(intRow)  
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description       
          blnFlag=False  
          Exit For
        End If
    Next
    If blnFlag = True then
      strTCRemarks="Country Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
     Delay 10000,"Pls Wait.."

  set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 3).WPFObject("BarButtonItemLinkControl", "", 1)
  strTemp="WPFObject(""ContentControlEx"", ""New Source Organization"", 2)"
  Set objTemp=objEdge.FindChild("Name",strTemp,50)
  If objTemp.Exists=True then
    If objTemp.Enabled=True then
      strTCRemarks = strTCRemarks & "<br />" & "New Source Organization button found in Source"
      log.Message "New Source Organization button found in Source"
      objTemp.Click
      Delay 5000,"Pls Wait.."
      log.Message "New Source Organization Window opened in Source"
      strTCRemarks = strTCRemarks & "<br />" &  "New Source Organization Window is opened in Source"
     
     
      set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: Root").WPFObject("Root").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 2)
      strTemp="WPFObject(""SourceCodeTextEdit"")"
      Set objTemp=objEdge.FindChild("Name",strTemp,50)
      If objTemp.Exists=True then
          Sys.Process("EdgeClient").WPFObject("HwndSource: Root").WPFObject("Root").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 2).WPFObject("SourceCodeTextEdit").Text="t1" 
      else
        strTCRemarks =  "Source Abbreviation have Edit option in New Source Organization"
      End if
      
      set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: Root").WPFObject("Root").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 3)
      strTemp="WPFObject(""SourceDescTextEdit"")"
      Set objTemp=objEdge.FindChild("Name",strTemp,50)
      If objTemp.Exists=True then
          Sys.Process("EdgeClient").WPFObject("HwndSource: Root").WPFObject("Root").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 3).WPFObject("SourceDescTextEdit").Text="t2"
      else
        strTCRemarks =  "Source Description have Edit option in New Source Organization"
      End if
      
      set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: Root").WPFObject("Root").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 4)
      strTemp="WPFObject(""SourceDescLocTextEdit"")"
      Set objTemp=objEdge.FindChild("Name",strTemp,50)
      If objTemp.Exists=True then
          Sys.Process("EdgeClient").WPFObject("HwndSource: Root").WPFObject("Root").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 4).WPFObject("SourceDescLocTextEdit").Text="t3"
      else
        strTCRemarks =  "Source Description Local have Edit option in New Source Organization"
      End if
    
      set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: Root").WPFObject("Root").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 8)
      strTemp="WPFObject(""MacroCapFlagTextEdit"")"
      Set objTemp=objEdge.FindChild("Name",strTemp,50)
      If objTemp.Exists=True then
          Sys.Process("EdgeClient").WPFObject("HwndSource: Root").WPFObject("Root").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 8).WPFObject("MacroCapFlagTextEdit").Text="t4"
      else
        strTCRemarks =  "Macro Cap Flag have Edit option in New Source Organization"
      End if
      
      set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: Root").WPFObject("Root").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 9)
      strTemp="WPFObject(""MacroPathTextEdit"")"
      Set objTemp=objEdge.FindChild("Name",strTemp,50)
      If objTemp.Exists=True then
          Sys.Process("EdgeClient").WPFObject("HwndSource: Root").WPFObject("Root").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 9).WPFObject("MacroPathTextEdit").Text="t5"
      else
        strTCRemarks =  "Macro Path have Edit option in New Source Organization"
      End if
      
      Sys.Process("EdgeClient").WPFObject("HwndSource: Root").WPFObject("Root").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 6).WPFObject("IsOfficialCheckEdit").IsChecked=True
      Sys.Process("EdgeClient").WPFObject("HwndSource: Root").WPFObject("Root").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 5).WPFObject("SourceNatureComboEdit").Selectedindex = 1
     set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: Root").WPFObject("Root").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1)
    strTemp="WPFObject(""OkButton"")"
    Set objTemp=objEdge.FindChild("Name",strTemp,50)
    If objTemp.Exists=True then
        objTemp.Click
        log.Message "Clicked the OK Button in New Source Organization"
    else
      strTCRemarks =  "Ok Button is Not found in New Source Organization"
    End if
    
    
    Dim strOk
    set objEdge= Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "Attention").WPFObject("CustomMessageBoxWindow", "Attention", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1)
  strTemp="WPFObject(""PART_ContainerContent"")"
  Set objTemp=objEdge.FindChild("Name",strTemp,50)
  If objTemp.Exists=True then
      SYS.Keys "[Enter]"
  End if

    End if 
  else
    strTCRemarks =  "New Source Organization button is Not found in Source"
  End if 
  Call SClosesource()
End Sub
Sub  sCheckSourceSaveNewSourceOrganizationLevel2(strParameters)
On Error Resume Next 
  Dim strSource_Name,strLevel2src_Name,objNewWrkSpace_okbtn,objNewWrkSpace_Name,strWrkSpaceName
    Dim objNewWrkSpace_Txtbox,objopenforEdit,objWrkspace_popup
    Dim strTemp,objTemp,intRow,barManager,intTotNodeCnt,Text,strDesc1,strDesc2,intI
    Dim objWrkSpace,objwrkspacepop,objwrkspcUpload,objConfirm,objGridCell,DescLocalText,intSeriesID
    Dim layoutGroup
    Dim strTemp1,objNewWrkSpaceName,objEdgeTree
    Dim objEdgeFilter

   strSource_Name=getSplitValue(strParameters,"SOURCE")
'   strSource_Name="Test"
    
   
   strDesc1=aqDateTime.Now
    strDesc2=aqDateTime.Now
    DescText=Replace(strDesc1,"/","-")
    DescText=Replace(DescText,":","_")
    DescLocalText=DescText
    strWrkSpaceName=DescText
    Call sHome_Source
    
    strTemp="WPFObject(""SourceTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""SourceTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    Delay 10000,"Pls Wait.."
    ''Selecting Country Name
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource_Name) then
          intRow=GridControl.Nodes_2.Item(intI).get_RowHandle
          Call GridControl.ClearSelectionCore
          Call GridControl.FocusViewAndRow(GridControl,intRow)
          GridControl.SetFocusOnCurrentItem
          Call GridControl.SelectRowCore(intRow)  
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description       
          blnFlag=False  
          Exit For
        End If
    Next
    If blnFlag = True then
      strTCRemarks="Country Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
     Delay 10000,"Pls Wait.."

  set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 3).WPFObject("BarButtonItemLinkControl", "", 1)
  strTemp="WPFObject(""ContentControlEx"", ""New Source Organization"", 2)"
  Set objTemp=objEdge.FindChild("Name",strTemp,50)
  If objTemp.Exists=True then
    If objTemp.Enabled=True then
      strTCRemarks = strTCRemarks & "<br />" & "New Source Organization button found in Source"
      log.Message "New Source Organization button found in Source"
      objTemp.Click
      Delay 5000,"Pls Wait.."
      log.Message "New Source Organization Window opened in Source"
      strTCRemarks = strTCRemarks & "<br />" &  "New Source Organization Window is opened in Source"
     
     
      set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: Root").WPFObject("Root").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 2)
      strTemp="WPFObject(""SourceCodeTextEdit"")"
      Set objTemp=objEdge.FindChild("Name",strTemp,50)
      If objTemp.Exists=True then
          Sys.Process("EdgeClient").WPFObject("HwndSource: Root").WPFObject("Root").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 2).WPFObject("SourceCodeTextEdit").Text=strWrkSpaceName 
      else
        strTCRemarks =  "Source Abbreviation is not having Edit option in New Source Organization"
      End if
      
      set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: Root").WPFObject("Root").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 3)
      strTemp="WPFObject(""SourceDescTextEdit"")"
      Set objTemp=objEdge.FindChild("Name",strTemp,50)
      If objTemp.Exists=True then
          Sys.Process("EdgeClient").WPFObject("HwndSource: Root").WPFObject("Root").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 3).WPFObject("SourceDescTextEdit").Text=strWrkSpaceName
      else
        strTCRemarks =  "Source Description have Edit option in New Source Organization"
      End if
      
      set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: Root").WPFObject("Root").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 4)
      strTemp="WPFObject(""SourceDescLocTextEdit"")"
      Set objTemp=objEdge.FindChild("Name",strTemp,50)
      If objTemp.Exists=True then
          Sys.Process("EdgeClient").WPFObject("HwndSource: Root").WPFObject("Root").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 4).WPFObject("SourceDescLocTextEdit").Text=strWrkSpaceName
      else
        strTCRemarks =  "Source Description Local have Edit option in New Source Organization"
      End if
    
      set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: Root").WPFObject("Root").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 8)
      strTemp="WPFObject(""MacroCapFlagTextEdit"")"
      Set objTemp=objEdge.FindChild("Name",strTemp,50)
      If objTemp.Exists=True then
          Sys.Process("EdgeClient").WPFObject("HwndSource: Root").WPFObject("Root").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 8).WPFObject("MacroCapFlagTextEdit").Text="t4"
      else
        strTCRemarks =  "Macro Cap Flag have Edit option in New Source Organization"
      End if
      
      set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: Root").WPFObject("Root").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 9)
      strTemp="WPFObject(""MacroPathTextEdit"")"
      Set objTemp=objEdge.FindChild("Name",strTemp,50)
      If objTemp.Exists=True then
          Sys.Process("EdgeClient").WPFObject("HwndSource: Root").WPFObject("Root").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 9).WPFObject("MacroPathTextEdit").Text="t5"
      else
        strTCRemarks =  "Macro Path have Edit option in New Source Organization"
      End if
      
      Sys.Process("EdgeClient").WPFObject("HwndSource: Root").WPFObject("Root").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 6).WPFObject("IsOfficialCheckEdit").IsChecked=True
      Sys.Process("EdgeClient").WPFObject("HwndSource: Root").WPFObject("Root").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 5).WPFObject("SourceNatureComboEdit").Selectedindex = 1
      Sys.Process("EdgeClient").WPFObject("HwndSource: Root").WPFObject("Root").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 10).WPFObject("InsertSourceAfterComboEdit").Selectedindex = 2
      set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: Root").WPFObject("Root").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1)
      strTemp="WPFObject(""OkButton"")"
      Set objTemp=objEdge.FindChild("Name",strTemp,50)
      If objTemp.Exists=True then
          objTemp.Click
          log.Message "Clicked the OK Button in New Source Organization"
      else
        strTCRemarks =  "Ok Button is Not found in New Source Organization"
      End if
      Call sEdgeProcessor
     Delay 15000,"Pls Wait.."
'    Dim strOk
'    strTemp="WPFObject(""DXMessageBox"", """", 1)"
'    Set strOk=Sys.Process("EdgeClient").WPFObject("HwndSource: WindowContentHolder", "Attention").WPFObject("WindowContentHolder", "Attention", 1).WPFObject("NonLogicalDecorator", "", 1).WPFObject("ThemedManagedContentPresenter", "", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WaitChild(strTemp,500000)
'    If strOk.Exists Then
'      SYS.Keys "[Enter]"
'    End If

    End if 
  else
    strTCRemarks =  "New Source Organization button is Not found in Source"
  End if 
  Call SClosesource()
End Sub

Sub  sCheckSourceOpenView(strParameters)
On Error Resume Next 
   Dim strSource1,StrSource2,strSource3,strTemp,GridControl,GridSourceTree,intTotNodeCnt,intI,intJ,intRow,intK,objEdge
   Dim objNewWorkspace,objWrkspace_popup,objOpenView
   
    strSource1=getSplitValue(strParameters,"SOURCE")
    StrSource2=getSplitValue(strParameters,"LEVEL2SOURCE")

'    strSource1="Test"
'    StrSource2="Automation"

    Call sHome_Source
    strTemp="WPFObject(""SourceTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""SourceTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    Delay 10000,"Pls Wait.."
    ''Selecting Country Name
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
          GridControl.Nodes_2.Item(intI).Expand(True)
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description       
          blnFlag=False  
          Exit For
        End If
    Next
    If blnFlag = True then
      strTCRemarks="Country Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
  
    Delay 10000,"Pls Wait.."
        blnFlag = True 
    ''Selecting Level2Source_Name
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
  For intJ=0 to intTotNodeCnt-1
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(StrSource2) then
        GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
        intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
'        Call GridSourceTree.ClickCell(intRow, "Edit")
        Call GridControl.ClearSelectionCore
        Call GridControl.FocusViewAndRow(GridControl,intRow)
        GridControl.SetFocusOnCurrentItem
        Call GridControl.SelectRowCore(intRow)
        log.Message "Level2 Source Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
        blnFlag = False 
        Exit For
      End If
    Next
    If blnFlag = True then
      log.Message "Level2 Source Name not found"
      strTCRemarks="Level2 Source Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
    Delay 2000,"Pls Wait.."

    strTemp="WPFObject(""ArrowControl"", """", 1)"
    Set objNewWorkspace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,20,True)
    If objNewWorkspace.Exists = True then
      objNewWorkspace.Click
      strTemp="WPFObject(""BarPopupBorderControl"", """", 1)"
     ' Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarButtonItemLinkControl", "", 1).WPFObject("ContentControlEx", "Open For View (Source)", 2)
      Set objWrkspace_popup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).FindChild("Name",strTemp,5,True)
      If objWrkspace_popup.Exists = True then
        strTemp="WPFObject(""ContentControlEx"", ""Open For View (Source)"", 2)"
        Set objOpenView=objWrkspace_popup.FindChild("Name",strTemp,8,True)
        If objOpenView.Exists then
          objOpenView.Click  
          strTCRemarks = strTCRemarks & "<br />" & "Open for view in Source"  
        End If
      End If
     End if 
       Delay 15000,"Pls Wait.."
  Call SClosesource()
  Delay 5000,"Pls Wait.."
  Call SClosesource()
End Sub


Sub  sCheckSourceValidationOpenView(strParameters)
On Error Resume Next 
   Dim strSource1,StrSource2,strSource3,strTemp,GridControl,GridSourceTree,intTotNodeCnt,intI,intJ,intRow,intK,objEdge
   Dim objNewWorkspace,objWrkspace_popup,objOpenView
   
    strSource1=getSplitValue(strParameters,"SOURCE")
    StrSource2=getSplitValue(strParameters,"LEVEL2SOURCE")

'    strSource1="Test"
'    StrSource2="Automation"

    Call sHome_Source
    strTemp="WPFObject(""SourceTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""SourceTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    Delay 10000,"Pls Wait.."
    ''Selecting Country Name
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
          GridControl.Nodes_2.Item(intI).Expand(True)
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description       
          blnFlag=False  
          Exit For
        End If
    Next
    If blnFlag = True then
      strTCRemarks="Country Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
  
    Delay 10000,"Pls Wait.."
        blnFlag = True 
    ''Selecting Level2Source_Name
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
  For intJ=0 to intTotNodeCnt-1
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(StrSource2) then
        GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
        intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
'        Call GridSourceTree.ClickCell(intRow, "Edit")
        Call GridControl.ClearSelectionCore
        Call GridControl.FocusViewAndRow(GridControl,intRow)
        GridControl.SetFocusOnCurrentItem
        Call GridControl.SelectRowCore(intRow)
        log.Message "Level2 Source Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
        blnFlag = False 
        Exit For
      End If
    Next
    If blnFlag = True then
      log.Message "Level2 Source Name not found"
      strTCRemarks="Level2 Source Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
    Delay 2000,"Pls Wait.."

    strTemp="WPFObject(""ArrowControl"", """", 1)"
    Set objNewWorkspace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,20,True)
    If objNewWorkspace.Exists = True then
      objNewWorkspace.Click
      strTemp="WPFObject(""BarPopupBorderControl"", """", 1)"
     ' Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarButtonItemLinkControl", "", 1).WPFObject("ContentControlEx", "Open For View (Source)", 2)
      Set objWrkspace_popup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).FindChild("Name",strTemp,5,True)
      If objWrkspace_popup.Exists = True then
        strTemp="WPFObject(""ContentControlEx"", ""Open For View (Source)"", 2)"
        Set objOpenView=objWrkspace_popup.FindChild("Name",strTemp,8,True)
        If objOpenView.Exists then
          objOpenView.Click  
          strTCRemarks = strTCRemarks & "<br />" & "Open for view in Source"  
        End If
      End If
     End if 
    Delay 15000,"Pls Wait.."
     ''Handling Validation for Source
    strTemp="WPFObject(""HwndSource: WindowContentHolder"", """")"
    Set objTemp=Sys.Process("EdgeClient").WaitChild(strTemp,10000)
    If objTemp.Exists = True then
      objTemp.Keys "[Enter]"
      strTestCaseResult = "FAIL"
      Exit Sub
    End If

    ''WorkSpace Edit Window
    strTemp="WPFObject(""LayoutPanel"", """", 2)"
    Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,13,True)
    If objTemp.Exists then
        Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WPFObject("SourceTreeListView")
        Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl")

        ''Expanding First Node in Tree      
       intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
          GridControl.Nodes_2.Item(intI).Expand(True)
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description       
          blnFlag=False  
          Exit For
        End If
    Next
    If blnFlag = True then
      strTCRemarks="Country Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
      Delay 10000,"Pls Wait.."
        blnFlag = True 
    ''Selecting Level2Source_Name
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
    For intJ=0 to intTotNodeCnt-1
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(StrSource2) then
        GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
        intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
'       Call GridSourceTree.ClickCell(intRow, "Edit")
        Call GridControl.ClearSelectionCore
        Call GridControl.FocusViewAndRow(GridControl,intRow)
        GridControl.SetFocusOnCurrentItem
        Call GridControl.SelectRowCore(intRow)
        log.Message "Level2 Source Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
        blnFlag = False 
        Exit For
      End If
    Next
    If blnFlag = True then
      log.Message "Level2 Source Name not found"
      strTCRemarks="Level2 Source Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
    Delay 2000,"Pls Wait.."
        ''Clicking on New Folder
    '   strTemp="WPFObject(""BarButtonItemLinkControl"", """", 1)"
        Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 4).WPFObject("BarButtonItemLinkControl", "", 1)
        If objTemp.Exists = True then
          Delay 3000,"New Folder..."
          objTemp.Click
          Delay 8000,"New Folder..."
          strTCRemarks = strTCRemarks & "<br />" & "Clicked Add Folder Button in Source" 
        End If
    Dim strOk
   strTemp="WPFObject(""PART_ContainerContent"")"
      'Set strOk=Sys.Process("EdgeClient").WPFObject("HwndSource: WindowContentHolder", "Workspace").WPFObject("WindowContentHolder", "Workspace", 1).WPFObject("NonLogicalDecorator", "", 1).WPFObject("ThemedManagedContentPresenter", "", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WaitChild(strTemp,550000)
      Set strOk=Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "Workspace").WPFObject("CustomMessageBoxWindow", "Workspace", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,550000)
    If strOk.Exists Then
      SYS.Keys "[Enter]"
      strTCRemarks = strTCRemarks & "<br />" & "You are not allowed to Edit Open for View only workspace" 
    End If
    
    strTemp="WPFObject(""EdittingInViewOnlyErrorMessageLabel"")"
    Set strOk=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 2).WaitChild(strTemp,500000)
    If strOk.Exists Then
      SYS.Keys "[Enter]"
      strTCRemarks = strTCRemarks & "<br />" & "Changed the Label 'You are not allowed to edit an Open For View workspace.'" 
      log.Message "Changed the Label 'You are not allowed to edit an Open For View workspace.'" 
    End If
  End if
  Call SClosesource()
  Call SClosesource()
  
End Sub

Sub  sCheckSourceCancelOpenEdit(strParameters)
On Error Resume Next 
   Dim strSource1,StrSource2,strSource3,strTemp,GridControl,GridSourceTree,intTotNodeCnt,intI,intJ,intRow,intK,objEdge
   Dim objNewWorkspace,objWrkspace_popup,objOpenView,strTemp1,objNewWrkSpaceName,objNewWrkSpace_Txtbox,objNewWrkSpace_okbtn,objNewWrkSpace_Name
   
    strSource1=getSplitValue(strParameters,"SOURCE")
    StrSource2=getSplitValue(strParameters,"LEVEL2SOURCE")

'    strSource1="Test"
'    StrSource2="Automation"

    Call sHome_Source
    strTemp="WPFObject(""SourceTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""SourceTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    Delay 10000,"Pls Wait.."
    ''Selecting Country Name
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
          GridControl.Nodes_2.Item(intI).Expand(True)
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description       
          blnFlag=False  
          Exit For
        End If
    Next
    If blnFlag = True then
      strTCRemarks="Country Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
  
    Delay 10000,"Pls Wait.."
        blnFlag = True 
    ''Selecting Level2Source_Name
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
  For intJ=0 to intTotNodeCnt-1
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(StrSource2) then
        GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
        intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
'        Call GridSourceTree.ClickCell(intRow, "Edit")
        Call GridControl.ClearSelectionCore
        Call GridControl.FocusViewAndRow(GridControl,intRow)
        GridControl.SetFocusOnCurrentItem
        Call GridControl.SelectRowCore(intRow)
        log.Message "Level2 Source Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
        blnFlag = False 
        Exit For
      End If
    Next
    If blnFlag = True then
      log.Message "Level2 Source Name not found"
      strTCRemarks="Level2 Source Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
    Delay 2000,"Pls Wait.."

    strTemp="WPFObject(""ArrowControl"", """", 1)"
    Set objNewWorkspace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,20,True)
    If objNewWorkspace.Exists = True then
      objNewWorkspace.Click
       strTemp="WPFObject(""BarPopupBorderControl"", """", 1)"
      Set objWrkspace_popup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").FindChild("Name",strTemp,5,True)
      If objWrkspace_popup.Exists = True then
        strTemp="WPFObject(""ContentControlEx"", ""Open For Edit (Source)"", 2)"
        Set objopenforEdit=objWrkspace_popup.FindChild("Name",strTemp,8,True)
        If objopenforEdit.Exists then
          objopenforEdit.Click    
          'Delay 20000,"Please Wait..."
        End If
      End if
      
      strTemp1="WPFObject(""HwndSource: WorkspaceNamePrompt"", ""Please provide a new Workspace Name"")"
      Set objNewWrkSpaceName=Sys.Process("EdgeClient").WaitChild(strTemp1,50000)
      If objNewWrkSpaceName.Exists = True then
     
      ''Waiting for Workspace Name prompt
      strTemp="WPFObject(""FloatingContainerBorder"")"
      Set objNewWrkSpace_Name=Sys.Process("EdgeClient").WPFObject("HwndSource: WorkspaceNamePrompt", "Please provide a new Workspace Name").WPFObject("WorkspaceNamePrompt", "Please provide a new Workspace Name", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,15000000)
     ' Set objNewWrkSpace_Name=Sys.Process("EdgeClient").WaitChild(strTemp,15000000)
        If objNewWrkSpace_Name.Exists = True then
          strTemp="WPFObject(""ChangeNameTextEdit"")"
          ''Entering Workspace Name
          Set objNewWrkSpace_Txtbox=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
            If objNewWrkSpace_Txtbox.Exists = True then
              objNewWrkSpace_Txtbox.Click
              
              strTemp="WPFObject(""CancelButton"")"
              Set objNewWrkSpace_okbtn=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
              If objNewWrkSpace_okbtn.Exists = True then
                objNewWrkSpace_okbtn.Click
                'Delay 5000,"Please wait..."
              End If
            End If
        End If
      End if 
     End if 
       Delay 15000,"Pls Wait.."
  Call SClosesource()
  Delay 5000,"Pls Wait.."
  Call SClosesource()
End Sub

Sub  sCheckSourceOpenEdit(strParameters)
On Error Resume Next 
   Dim strSource1,StrSource2,strSource3,strTemp,GridControl,GridSourceTree,intTotNodeCnt,intI,intJ,intRow,intK,objEdge
   Dim objNewWorkspace,objWrkspace_popup,objOpenView,strTemp1,objNewWrkSpaceName,objNewWrkSpace_Txtbox,objNewWrkSpace_okbtn,objNewWrkSpace_Name
   Dim strDesc1,strDesc2,DescText,DescLocalText
   
    strSource1=getSplitValue(strParameters,"SOURCE")
    StrSource2=getSplitValue(strParameters,"LEVEL2SOURCE")
'
'    strSource1="Test"
'    StrSource2="Automation"

    Call sHome_Source
    
    strDesc1=aqDateTime.Now
    strDesc2=aqDateTime.Now
    DescText=Replace(strDesc1,"/","-")
    DescText=Replace(DescText,":","_")
    DescLocalText=DescText
    strWrkSpaceName=DescText
    intSeriesID=getSplitValue(strParameters,"SERIESID")
    if intSeriesID=0 then
      Call sSourceseries
      intSeriesID=strSourceFileText
    End if 
    
    strTemp="WPFObject(""SourceTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""SourceTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    Delay 10000,"Pls Wait.."
    ''Selecting Country Name
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
          GridControl.Nodes_2.Item(intI).Expand(True)
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description       
          blnFlag=False  
          Exit For
        End If
    Next
    If blnFlag = True then
      strTCRemarks="Country Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
  
    Delay 10000,"Pls Wait.."
        blnFlag = True 
    ''Selecting Level2Source_Name
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
  For intJ=0 to intTotNodeCnt-1
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(StrSource2) then
        GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
        intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
'        Call GridSourceTree.ClickCell(intRow, "Edit")
        Call GridControl.ClearSelectionCore
        Call GridControl.FocusViewAndRow(GridControl,intRow)
        GridControl.SetFocusOnCurrentItem
        Call GridControl.SelectRowCore(intRow)
        log.Message "Level2 Source Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
        blnFlag = False 
        Exit For
      End If
    Next
    If blnFlag = True then
      log.Message "Level2 Source Name not found"
      strTCRemarks="Level2 Source Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
    Delay 2000,"Pls Wait.."

    strTemp="WPFObject(""ArrowControl"", """", 1)"
    Set objNewWorkspace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,20,True)
    If objNewWorkspace.Exists = True then
      objNewWorkspace.Click
       strTemp="WPFObject(""BarPopupBorderControl"", """", 1)"
      Set objWrkspace_popup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").FindChild("Name",strTemp,5,True)
      If objWrkspace_popup.Exists = True then
        strTemp="WPFObject(""ContentControlEx"", ""Open For Edit (Source)"", 2)"
        Set objopenforEdit=objWrkspace_popup.FindChild("Name",strTemp,8,True)
        If objopenforEdit.Exists then
          objopenforEdit.Click    
          'Delay 20000,"Please Wait..."
        End If
      End if
      
      strTemp1="WPFObject(""HwndSource: WorkspaceNamePrompt"", ""Please provide a new Workspace Name"")"
      Set objNewWrkSpaceName=Sys.Process("EdgeClient").WaitChild(strTemp1,50000)
      If objNewWrkSpaceName.Exists = True then
     
      ''Waiting for Workspace Name prompt
      strTemp="WPFObject(""FloatingContainerBorder"")"
      Set objNewWrkSpace_Name=Sys.Process("EdgeClient").WPFObject("HwndSource: WorkspaceNamePrompt", "Please provide a new Workspace Name").WPFObject("WorkspaceNamePrompt", "Please provide a new Workspace Name", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,15000000)
      If objNewWrkSpace_Name.Exists = True then
          strTemp="WPFObject(""ChangeNameTextEdit"")"
          ''Entering Workspace Name
          Set objNewWrkSpace_Txtbox=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
            If objNewWrkSpace_Txtbox.Exists = True then
              objNewWrkSpace_Txtbox.Click
              objNewWrkSpace_Txtbox.Text=strWrkSpaceName
      '        strTCRemarks=strTCRemarks & Chr(10) & "Entered Workspace Name - " & strWrkSpaceName
              ''Clicking on Ok Button 
              strTemp="WPFObject(""OkButton"")"
              Set objNewWrkSpace_okbtn=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
              If objNewWrkSpace_okbtn.Exists = True then
                objNewWrkSpace_okbtn.Click
                'Delay 5000,"Please wait..."
              End If
            End If
        End If
      End if 
     End if 
       Delay 15000,"Pls Wait.."
  Call SClosesource()
  Delay 5000,"Pls Wait.."
  Call SClosesource()
  Call SourceWorkSpacevwr()
End Sub


Sub  sCheckSourceValidatingWorkspace(strParameters)
On Error Resume Next 
   Dim strSource1,StrSource2,strSource3,strTemp,GridControl,GridSourceTree,intTotNodeCnt,intI,intJ,intRow,intK,objEdge
   Dim objNewWorkspace,objWrkspace_popup,objOpenView,strTemp1,objNewWrkSpaceName,objNewWrkSpace_Txtbox,objNewWrkSpace_okbtn,objNewWrkSpace_Name
   Dim strDesc1,strDesc2,DescText,DescLocalText
   
    strSource1=getSplitValue(strParameters,"SOURCE")
    StrSource2=getSplitValue(strParameters,"LEVEL2SOURCE")

'    strSource1="Test"
'    StrSource2="Automation"

    Call sHome_Source
    

    strWrkSpaceName="Workspace1"
    
    strTemp="WPFObject(""SourceTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""SourceTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    Delay 10000,"Pls Wait.."
    ''Selecting Country Name
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
          GridControl.Nodes_2.Item(intI).Expand(True)
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description       
          blnFlag=False  
          Exit For
        End If
    Next
    If blnFlag = True then
      strTCRemarks="Country Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
  
    Delay 10000,"Pls Wait.."
        blnFlag = True 
    ''Selecting Level2Source_Name
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
  For intJ=0 to intTotNodeCnt-1
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(StrSource2) then
        GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
        intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
'        Call GridSourceTree.ClickCell(intRow, "Edit")
        Call GridControl.ClearSelectionCore
        Call GridControl.FocusViewAndRow(GridControl,intRow)
        GridControl.SetFocusOnCurrentItem
        Call GridControl.SelectRowCore(intRow)
        log.Message "Level2 Source Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
        blnFlag = False 
        Exit For
      End If
    Next
    If blnFlag = True then
      log.Message "Level2 Source Name not found"
      strTCRemarks="Level2 Source Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
    Delay 2000,"Pls Wait.."

    strTemp="WPFObject(""ArrowControl"", """", 1)"
    Set objNewWorkspace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,20,True)
    If objNewWorkspace.Exists = True then
      objNewWorkspace.Click
       strTemp="WPFObject(""BarPopupBorderControl"", """", 1)"
      Set objWrkspace_popup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").FindChild("Name",strTemp,5,True)
      If objWrkspace_popup.Exists = True then
        strTemp="WPFObject(""ContentControlEx"", ""Open For Edit (Source)"", 2)"
        Set objopenforEdit=objWrkspace_popup.FindChild("Name",strTemp,8,True)
        If objopenforEdit.Exists then
          objopenforEdit.Click    
          'Delay 20000,"Please Wait..."
        End If
      End if
      
      strTemp1="WPFObject(""HwndSource: WorkspaceNamePrompt"", ""Please provide a new Workspace Name"")"
      Set objNewWrkSpaceName=Sys.Process("EdgeClient").WaitChild(strTemp1,50000)
      If objNewWrkSpaceName.Exists = True then
     
      ''Waiting for Workspace Name prompt
      strTemp="WPFObject(""FloatingContainerBorder"")"
      Set objNewWrkSpace_Name=Sys.Process("EdgeClient").WPFObject("HwndSource: WorkspaceNamePrompt", "Please provide a new Workspace Name").WPFObject("WorkspaceNamePrompt", "Please provide a new Workspace Name", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,15000000)
      If objNewWrkSpace_Name.Exists = True then
          strTemp="WPFObject(""ChangeNameTextEdit"")"
          ''Entering Workspace Name
          Set objNewWrkSpace_Txtbox=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
            If objNewWrkSpace_Txtbox.Exists = True then
              objNewWrkSpace_Txtbox.Click
              objNewWrkSpace_Txtbox.Text=strWrkSpaceName
      '        strTCRemarks=strTCRemarks & Chr(10) & "Entered Workspace Name - " & strWrkSpaceName
              ''Clicking on Ok Button 
              strTemp="WPFObject(""OkButton"")"
              Set objNewWrkSpace_okbtn=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
              If objNewWrkSpace_okbtn.Exists = True then
                objNewWrkSpace_okbtn.Click
                'Delay 5000,"Please wait..."
              End If
            End If
        End If
      End if 
     End if 
       Delay 15000,"Pls Wait.."
  Call SClosesource()
  Delay 5000,"Pls Wait.."
  Call SClosesource()
End Sub

Sub  sCheckSourceValidatesameWorkspace(strParameters)
On Error Resume Next 
   Dim strSource1,StrSource2,strSource3,strTemp,GridControl,GridSourceTree,intTotNodeCnt,intI,intJ,intRow,intK,objEdge
   Dim objNewWorkspace,objWrkspace_popup,objOpenView,strTemp1,objNewWrkSpaceName,objNewWrkSpace_Txtbox,objNewWrkSpace_okbtn,objNewWrkSpace_Name
   Dim strDesc1,strDesc2,DescText,DescLocalText
   
    strSource1=getSplitValue(strParameters,"SOURCE")
    StrSource2=getSplitValue(strParameters,"LEVEL2SOURCE")

'    strSource1="Test"
'    StrSource2="Automation"

    Call sHome_Source
    

    strWrkSpaceName="Workspace1"
    
    strTemp="WPFObject(""SourceTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""SourceTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    Delay 10000,"Pls Wait.."
    ''Selecting Country Name
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
          GridControl.Nodes_2.Item(intI).Expand(True)
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description       
          blnFlag=False  
          Exit For
        End If
    Next
    If blnFlag = True then
      strTCRemarks="Country Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
  
    Delay 10000,"Pls Wait.."
        blnFlag = True 
    ''Selecting Level2Source_Name
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
  For intJ=0 to intTotNodeCnt-1
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(StrSource2) then
        GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
        intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
'        Call GridSourceTree.ClickCell(intRow, "Edit")
        Call GridControl.ClearSelectionCore
        Call GridControl.FocusViewAndRow(GridControl,intRow)
        GridControl.SetFocusOnCurrentItem
        Call GridControl.SelectRowCore(intRow)
        log.Message "Level2 Source Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
        blnFlag = False 
        Exit For
      End If
    Next
    If blnFlag = True then
      log.Message "Level2 Source Name not found"
      strTCRemarks="Level2 Source Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
    Delay 2000,"Pls Wait.."

    strTemp="WPFObject(""ArrowControl"", """", 1)"
    Set objNewWorkspace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,20,True)
    If objNewWorkspace.Exists = True then
      objNewWorkspace.Click
       strTemp="WPFObject(""BarPopupBorderControl"", """", 1)"
      Set objWrkspace_popup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").FindChild("Name",strTemp,5,True)
      If objWrkspace_popup.Exists = True then
        strTemp="WPFObject(""ContentControlEx"", ""Open For Edit (Source)"", 2)"
        Set objopenforEdit=objWrkspace_popup.FindChild("Name",strTemp,8,True)
        If objopenforEdit.Exists then
          objopenforEdit.Click    
          'Delay 20000,"Please Wait..."
        End If
      End if
      
      strTemp1="WPFObject(""HwndSource: WorkspaceNamePrompt"", ""Please provide a new Workspace Name"")"
      Set objNewWrkSpaceName=Sys.Process("EdgeClient").WaitChild(strTemp1,50000)
      If objNewWrkSpaceName.Exists = True then
     
      ''Waiting for Workspace Name prompt
      strTemp="WPFObject(""FloatingContainerBorder"")"
      Set objNewWrkSpace_Name=Sys.Process("EdgeClient").WPFObject("HwndSource: WorkspaceNamePrompt", "Please provide a new Workspace Name").WPFObject("WorkspaceNamePrompt", "Please provide a new Workspace Name", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,15000000)
      If objNewWrkSpace_Name.Exists = True then
          strTemp="WPFObject(""ChangeNameTextEdit"")"
          ''Entering Workspace Name
          Set objNewWrkSpace_Txtbox=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
            If objNewWrkSpace_Txtbox.Exists = True then
              objNewWrkSpace_Txtbox.Click
              objNewWrkSpace_Txtbox.Text=strWrkSpaceName
      '        strTCRemarks=strTCRemarks & Chr(10) & "Entered Workspace Name - " & strWrkSpaceName
              ''Clicking on Ok Button 
              strTemp="WPFObject(""OkButton"")"
              Set objNewWrkSpace_okbtn=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
              If objNewWrkSpace_okbtn.Exists = True then
                objNewWrkSpace_okbtn.Click
                'Delay 5000,"Please wait..."
              End If
              
              set objNewWrkSpace_Name= Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "New Workspace").WPFObject("CustomMessageBoxWindow", "New Workspace", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1)
              strTemp="WPFObject(""PART_ContainerContent"")"
              Set objNewWrkSpace_okbtn=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
              If objNewWrkSpace_okbtn.Exists = True then
                  SYS.Keys "[Enter]"
                  strTCRemarks = strTCRemarks & "<br />" & "Workspace name already exists" 
              End If
              
              set objNewWrkSpace_Name= Sys.Process("EdgeClient").WPFObject("HwndSource: WorkspaceNamePrompt", "Please provide a new Workspace Name").WPFObject("WorkspaceNamePrompt", "Please provide a new Workspace Name", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 1)
              strTemp="WPFObject(""CancelButton"")"
              Set objNewWrkSpace_okbtn=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
              If objNewWrkSpace_okbtn.Exists = True then
                objNewWrkSpace_okbtn.Click
              End If
            End If
        End If
      End if 
     End if 
       Delay 15000,"Pls Wait.."
  Call SClosesource()
  Delay 5000,"Pls Wait.."
  Call SClosesource()
  Call SourceWorkSpacevwr()
End Sub

Sub  sCheckSourceViewSourceSchedule(strParameters)
On Error Resume Next 
   Dim strSource1,StrSource2,strSource3,strTemp,GridControl,GridSourceTree,intTotNodeCnt,intI,intJ,intRow,intK,objEdge
   Dim objNewWorkspace,objWrkspace_popup,objOpenView,strTemp1,objNewWrkSpaceName,objNewWrkSpace_Txtbox,objNewWrkSpace_okbtn,objNewWrkSpace_Name
   Dim strDesc1,strDesc2,DescText,DescLocalText
  
      strSource1=getSplitValue(strParameters,"SOURCE")
      StrSource2=getSplitValue(strParameters,"LEVEL2SOURCE")

'    strSource1="Test"
'    StrSource2="Automation"

    Call sHome_Source
    
    strTemp="WPFObject(""SourceTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""SourceTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    Delay 10000,"Pls Wait.."
    ''Selecting Country Name
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
          GridControl.Nodes_2.Item(intI).Expand(True)
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description       
          blnFlag=False  
          Exit For
        End If
    Next
    If blnFlag = True then
      strTCRemarks="Country Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
  
    Delay 10000,"Pls Wait.."
        blnFlag = True 
    ''Selecting Level2Source_Name
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
  For intJ=0 to intTotNodeCnt-1
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(StrSource2) then
        GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
        intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
'        Call GridSourceTree.ClickCell(intRow, "Edit")
        Call GridControl.ClearSelectionCore
        Call GridControl.FocusViewAndRow(GridControl,intRow)
        GridControl.SetFocusOnCurrentItem
        Call GridControl.SelectRowCore(intRow)
        log.Message "Level2 Source Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
        blnFlag = False 
        Exit For
      End If
    Next
    If blnFlag = True then
      log.Message "Level2 Source Name not found"
      strTCRemarks="Level2 Source Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
    Delay 2000,"Pls Wait.."

    strTemp="WPFObject(""ArrowControl"", """", 1)"
    Set objNewWorkspace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,20,True)
    If objNewWorkspace.Exists = True then
      objNewWorkspace.Click
      strTemp="WPFObject(""BarPopupBorderControl"", """", 1)"
      Set objWrkspace_popup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).FindChild("Name",strTemp,5,True)
      If objWrkspace_popup.Exists = True then
        strTemp="WPFObject(""ContentControlEx"", ""Open For View (Source Schedule)"", 2)"
        Set objopenforEdit=objWrkspace_popup.FindChild("Name",strTemp,8,True)
        If objopenforEdit.Exists then
          objopenforEdit.Click    
         strTCRemarks = strTCRemarks & "<br />" & "Opened for Viewed Source Schedule" 
        End If
      End if
     End if 
       Delay 15000,"Pls Wait.."
  Call SClosesource()
  Delay 5000,"Pls Wait.."
  Call SClosesource()
End Sub

Sub  sCheckSourceEditSourceSchedule(strParameters)
On Error Resume Next 
   Dim strSource1,StrSource2,strSource3,strTemp,GridControl,GridSourceTree,intTotNodeCnt,intI,intJ,intRow,intK,objEdge
   Dim objNewWorkspace,objWrkspace_popup,objOpenView,strTemp1,objNewWrkSpaceName,objNewWrkSpace_Txtbox,objNewWrkSpace_okbtn,objNewWrkSpace_Name
   Dim strDesc1,strDesc2,DescText,DescLocalText
   
    strSource1=getSplitValue(strParameters,"SOURCE")
    StrSource2=getSplitValue(strParameters,"LEVEL2SOURCE")

'    strSource1="Test"
'    StrSource2="Automation"

    Call sHome_Source
    

    strWrkSpaceName="Workspace1"
    
    strTemp="WPFObject(""SourceTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""SourceTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    Delay 10000,"Pls Wait.."
    ''Selecting Country Name
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
          GridControl.Nodes_2.Item(intI).Expand(True)
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description       
          blnFlag=False  
          Exit For
        End If
    Next
    If blnFlag = True then
      strTCRemarks="Country Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
  
    Delay 10000,"Pls Wait.."
        blnFlag = True 
    ''Selecting Level2Source_Name
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
  For intJ=0 to intTotNodeCnt-1
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(StrSource2) then
        GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
        intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
'        Call GridSourceTree.ClickCell(intRow, "Edit")
        Call GridControl.ClearSelectionCore
        Call GridControl.FocusViewAndRow(GridControl,intRow)
        GridControl.SetFocusOnCurrentItem
        Call GridControl.SelectRowCore(intRow)
        log.Message "Level2 Source Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
        blnFlag = False 
        Exit For
      End If
    Next
    If blnFlag = True then
      log.Message "Level2 Source Name not found"
      strTCRemarks="Level2 Source Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
    Delay 2000,"Pls Wait.."

    strTemp="WPFObject(""ArrowControl"", """", 1)"
    Set objNewWorkspace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,20,True)
    If objNewWorkspace.Exists = True then
      objNewWorkspace.Click
      strTemp="WPFObject(""BarPopupBorderControl"", """", 1)"
      Set objWrkspace_popup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).FindChild("Name",strTemp,5,True)
      If objWrkspace_popup.Exists = True then
        strTemp="WPFObject(""ContentControlEx"", ""Open For Edit (Source Schedule)"", 2)"
        Set objopenforEdit=objWrkspace_popup.FindChild("Name",strTemp,8,True)
        If objopenforEdit.Exists then
          objopenforEdit.Click    
          'Delay 20000,"Please Wait..."
        End If
      End if
      
      strTemp1="WPFObject(""HwndSource: WorkspaceNamePrompt"", ""Please provide a new Workspace Name"")"
      Set objNewWrkSpaceName=Sys.Process("EdgeClient").WaitChild(strTemp1,50000)
      If objNewWrkSpaceName.Exists = True then
     
      ''Waiting for Workspace Name prompt
      strTemp="WPFObject(""FloatingContainerBorder"")"
      Set objNewWrkSpace_Name=Sys.Process("EdgeClient").WPFObject("HwndSource: WorkspaceNamePrompt", "Please provide a new Workspace Name").WPFObject("WorkspaceNamePrompt", "Please provide a new Workspace Name", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,15000000)
      If objNewWrkSpace_Name.Exists = True then
          strTemp="WPFObject(""ChangeNameTextEdit"")"
          ''Entering Workspace Name
          Set objNewWrkSpace_Txtbox=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
            If objNewWrkSpace_Txtbox.Exists = True then
              objNewWrkSpace_Txtbox.Click
              objNewWrkSpace_Txtbox.Text=strWrkSpaceName
      '        strTCRemarks=strTCRemarks & Chr(10) & "Entered Workspace Name - " & strWrkSpaceName
              ''Clicking on Ok Button 
              strTemp="WPFObject(""OkButton"")"
              Set objNewWrkSpace_okbtn=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
              If objNewWrkSpace_okbtn.Exists = True then
                objNewWrkSpace_okbtn.Click
                'Delay 5000,"Please wait..."
              End If
            End If
        End If
      End if 
     End if 
       Delay 15000,"Pls Wait.."
  Call SClosesource()
  Delay 5000,"Pls Wait.."
  Call SClosesource()
End Sub


Sub sCheckSourceSchedule_Checklist(strParameters)

On Error Resume Next

    Dim intRow,strTemp,objTemp,Grid,intI
    Dim objEdge,objCaption,i,objText,j,strWrkSpaceName,strDesc1,strDesc2

    strSource_Name=getSplitValue(strParameters,"SOURCE")
    strLevel2src_Name=getSplitValue(strParameters,"LEVEL2SOURCE")
    strLevel3src_Name=getSplitValue(strParameters,"LEVEL3SOURCE")
    
'    strSource_Name="Test"
'    strLevel2src_Name="Automation"
'    strLevel3src_Name="Test Source 1"

    strDesc1=aqDateTime.Now
    strDesc2=aqDateTime.Now
    strWrkSpaceName=Replace(strDesc1,"/","-")
    strWrkSpaceName=Replace(strWrkSpaceName,":","_")
    
    Call sHome_Source
    ''Setting grid Objects
    strTemp="WPFObject(""SourceTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""SourceTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    
    Delay 10000,"Pls Wait.."
    ''Selecting Country Name
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource_Name) then
          GridControl.Nodes_2.Item(intI).Expand(True)
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description       
    '      strTCRemarks=strTCRemarks & Chr(10) & "Selected Node - " & GridControl.Nodes_2.Item(intI).Content.Description  
          blnFlag=False  
          Exit For
        End If
    Next
    If blnFlag = True then
      strTCRemarks="Country Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
  
    Delay 10000,"Pls Wait.."
    blnFlag = True 
    ''Selecting Level2Source_Name
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
    For intJ=0 to intTotNodeCnt-1
      strTemp=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strLevel2src_Name) then
        GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
        intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
        Call GridControl.ClearSelectionCore
        Call GridControl.FocusViewAndRow(GridControl,intRow)
        GridControl.SetFocusOnCurrentItem
        Call GridControl.SelectRowCore(intRow)
        log.Message "Level2 Source Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
        blnFlag = False 
        Exit For
      End If
    Next
    If blnFlag = True then
      log.Message "Level2 Source Name not found"
      strTCRemarks="Level2 Source Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
    Delay 10000,"Pls Wait.."
    strTemp="WPFObject(""ArrowControl"", """", 1)"
    Set objNewWorkspace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,20,True)
    If objNewWorkspace.Exists = True then
      objNewWorkspace.Click
'      Delay 5000,"Please Wait..."
      strTemp="WPFObject(""BarPopupBorderControl"", """", 1)"
      Set objWrkspace_popup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").FindChild("Name",strTemp,5,True)
      If objWrkspace_popup.Exists = True then
        strTemp="WPFObject(""ContentControlEx"", ""Open For Edit (Source Schedule)"", 2)"
        Set objopenforEdit=objWrkspace_popup.FindChild("Name",strTemp,8,True)
        If objopenforEdit.Exists then
          objopenforEdit.Click    
'          Delay 50000,"Please Wait..."
           strTemp="WPFObject(""FloatingContainerBorder"")"          
           Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: WaitProgressWindow", "Please Wait...").WPFObject("WaitProgressWindow", "Please Wait...", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,50000)
            Do until objTemp.Exists = False 
              If objTemp.Focusable=False then
                Delay 5000,"Pls Wait.."
              End if 
            Loop   
        End If
    End If
    End If
    

    ''Waiting for FloatingContainerBorder
     strTemp="WPFObject(""HwndSource: WorkspaceNamePrompt"", ""Please provide a new Workspace Name"")"
      Set objNewWrkSpace_Name=Sys.Process("EdgeClient").WaitChild(strTemp,5000000)
      If objNewWrkSpace_Name.Exists = True then
        strTemp="WPFObject(""ChangeNameTextEdit"")"
        ''Entering Workspace Name
        Set objNewWrkSpace_Txtbox=objNewWrkSpace_Name.FindChild("Name",strTemp,50,True)
          If objNewWrkSpace_Txtbox.Exists = True then
            objNewWrkSpace_Txtbox.Click
            objNewWrkSpace_Txtbox.Text=strWrkSpaceName
    '        strTCRemarks=strTCRemarks & Chr(10) & "Entered Workspace Name - " & strWrkSpaceName
            ''Clicking on Ok Button 
            strTemp="WPFObject(""OkButton"")"
            Set objNewWrkSpace_okbtn=objNewWrkSpace_Name.FindChild("Name",strTemp,50,True)
            If objNewWrkSpace_okbtn.Exists = True then
              objNewWrkSpace_okbtn.Click
              Delay 5000,"Please wait..."
            End If
          End If
      End If

    
    ''Source Series Schedule (For Edit)
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("SourceTreeListView").WPFObject("SourceTreeView")
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("SourceTreeListView").WPFObject("SourceTreeView")

    ''Expand All
'    Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarButtonItemLinkControl", "", 1).Click

    strTemp="WPFObject(""ContentControlEx"", ""Expand All"", 2)"
    Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).FindChild("Name",strTemp,50,True)
    If objTemp.Exists = True then
      objTemp.Click
    End If
    Call sEdgeProcessor
    strTemp="WPFObject(""SourceTreeView"")"
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    ''Selecting Country Name
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource_Name) then
          GridControl.Nodes_2.Item(intI).Expand(True)
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description       
    '      strTCRemarks=strTCRemarks & Chr(10) & "Selected Node - " & GridControl.Nodes_2.Item(intI).Content.Description  
          blnFlag=False  
          Exit For
        End If
    Next
    If blnFlag = True then
      strTCRemarks="Country Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
  
    blnFlag = True 
    ''Selecting Level2Source_Name
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
    For intJ=0 to intTotNodeCnt-1
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strLevel2src_Name) then
        GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
        log.Message "Level2 Source Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
        blnFlag = False 
        Exit For
      End If
    Next
    
    ''Selecting Level3Source_Name
      intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count
      For intK=0 to intTotNodeCnt-1
        If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description)=Ucase(strLevel3src_Name) then
          GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Expand(True)
          intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).get_RowHandle
          Call GridControl.ClearSelectionCore
          Call GridControl.FocusViewAndRow(GridControl,intRow)
          GridControl.SetFocusOnCurrentItem
          Call GridControl.SelectRowCore(intRow)
          Call sEdgeProcessor
          log.Message "Third Level- " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description
          blnFlag = False
          Exit For   
        End If 
      Next
      
      ''Minimize Window
      Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("GridSplitter", "", 1)
      Call objTemp.Drag(4, 19, -167, 14)
    
    
    ''Selecting Final option from combo
    Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 2).WPFObject("Grid", "", 1).WPFObject("SourceSeriesGridControl").WPFObject("TableView", "", 1).WPFObject("HierarchyPanel", "", 1).WPFObject("RowControl", "", 1).WPFObject("CellsControl", "", 1).WPFObject("LightweightCellEditor", "", 2).WPFObject("InplaceBaseEdit", "", 1).Click
    Call sEdgeProcessor
    strTemp="WPFObject(""ComboBoxEdit"", """", 1)"
    Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 2).WPFObject("Grid", "", 2).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 7).WPFObject("BarEditItemLinkControl", "", 1).WPFObject("ContentControlEx", "", 1).FindChild("Name",strTemp,50,True)
    If objTemp.Exists = True then
      Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 2).WPFObject("Grid", "", 2).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 7).WPFObject("BarEditItemLinkControl", "", 1).WPFObject("ContentControlEx", "", 1).WPFObject("ComboBoxEdit", "", 1).Click
      strTemp="WPFObject(""PopupContentControl"", """", 1)"
      Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").FindChild("Name",strTemp,50,True)
      If objTemp.Exists = True then
        strTemp="WPFObject(""TextBlock"", ""Final"", 1)"
        Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).FindChild("Name",strTemp,50,True)
        If objTemp.Exists = True then
          objTemp.Click
        End If  
      End If
    End If

    ''Clicking on Add Button
    strTemp="WPFObject(""ContentControlEx"", ""Add"", 2)"
    Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,50,True)
    If objTemp.Exists = True then
      If objTemp.Enabled = True then
       log.Message "ADD Button is enabled"
       End if 
    End If
    Call sCloseSource()
    Call sCloseSource() 
    
End Sub

Sub sCheckSourceScheduleWorkSpacevwr()
On Error Resume Next

    Dim strObject,objEdgeMDI,strTemp,objTemp,GridControl,intRowcnt,intI,intRow

    strObject = "WPFObject(""HwndSource: RibbonWindow"")"
    Set objEdgeMDI = Sys.Process("EdgeClient").WaitChild(strObject, 600000)
    If objEdgeMDI.Exists then
      strTemp="WPFObject(""TextBlock"", ""Layout"", 1)"
      Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,14,True)
      If objTemp.Exists = False then
        strTemp="WPFObject(""ContentControl"", ""Source Workspace"", 1)"
        Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).FindChild("Name",strTemp,16,True)
        If objTemp.Exists = True then
          objTemp.Click
        End If
        'Delay 8000,"Opening Source Workspace.."
        Call sEdgeProcessor
        log.Message "Opening Source Workspace.."
'        strTCRemarks="Opening Source Workspace.."
      Else
        log.Message "Source Workspace is opened"
'        strTCRemarks="Source Workspace is opened"
        'Exit Sub 
      End If
    
      strTemp="WPFObject(""ContentControlEx"", ""Source Schedules"", 2)"
        Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 2).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 3).WPFObject("BarCheckItemLinkControl", "", 1).FindChild("Name",strTemp,20,True)
        If objTemp.Exists = True then
          objTemp.Click
        End If
      
      ''Selecting Records
      strTemp="WPFObject(""PendingChangeGridControl"")"
      Set GridControl=Sys.Process("EdgeClient").FindChild("Name",strTemp,60,True)
      intRowcnt=GridControl.wRowCount
      For intI=0 to intRowcnt-1
        'intRow=GridControl.FindRow(1,"Workspace Name")
        Call GridControl.ClickCell(intI,1)
        strTemp="WPFObject(""ContentControlEx"", ""Drop"", 2)"
        Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,20,True)
        If objTemp.Exists = True then
          objTemp.Click
        End If
        strTemp="WPFObject(""PART_ContainerContent"")"
        Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "Please Confirm.").FindChild("Name",strTemp,50,True)
'        strTemp="WPFObject(""DXMessageBox"", """", 1)"
'        Set objTemp=objTemp.WaitChild(strTemp,50000)
        If objTemp.Exists = True then
          Sys.Keys "Y"
          Call sEdgeProcessor
          Call sCloseSource()
        End If
      Next
    Else
      log.Message "RibbonWindow not found"
    End If

End Sub

Sub sCheckSourceSCOpenSTP(strParameters)

On Error Resume Next

    Dim intRow,strTemp,objTemp,Grid,intI,intJ,intK,strSource_Name,strLevel2src_Name,strLevel3src_Name
    Dim objEdge,objCaption,i,objText,j,strWrkSpaceName,strDesc1,strDesc2,GridControl,GridSourceTree

    strSource_Name=getSplitValue(strParameters,"SOURCE")
    strLevel2src_Name=getSplitValue(strParameters,"LEVEL2SOURCE")
    strLevel3src_Name=getSplitValue(strParameters,"LEVEL3SOURCE")
    
'    strSource_Name="Test"
'    strLevel2src_Name="Automation"
'    strLevel3layout="Test Source 1"

'    strDesc1=aqDateTime.Now
'    strDesc2=aqDateTime.Now
'    strWrkSpaceName=Replace(strDesc1,"/","-")
'    strWrkSpaceName=Replace(strWrkSpaceName,":","_")
    
    Call sHome_Source
    ''Setting grid Objects
    strTemp="WPFObject(""SourceTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""SourceTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    
    Delay 10000,"Pls Wait.."
    ''Selecting Country Name
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource_Name) then
          GridControl.Nodes_2.Item(intI).Expand(True)
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description       
    '      strTCRemarks=strTCRemarks & Chr(10) & "Selected Node - " & GridControl.Nodes_2.Item(intI).Content.Description  
          blnFlag=False  
          Exit For
        End If
    Next
    If blnFlag = True then
      strTCRemarks="Country Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
  
    Delay 10000,"Pls Wait.."
    blnFlag = True 
    ''Selecting Level2Source_Name
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
    For intJ=0 to intTotNodeCnt-1
      strTemp=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strLevel2src_Name) then
        GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
        intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
        Call GridControl.ClearSelectionCore
        Call GridControl.FocusViewAndRow(GridControl,intRow)
        GridControl.SetFocusOnCurrentItem
        Call GridControl.SelectRowCore(intRow)
        log.Message "Level2 Source Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
        blnFlag = False 
        Exit For
      End If
    Next
    If blnFlag = True then
      log.Message "Level2 Source Name not found"
      strTCRemarks="Level2 Source Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
    
     Delay 10000,"Please Wait..."
    blnFlag = True    
    ''Selecting Level3 Layout
      intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count
      For intK=0 to intTotNodeCnt-1
        If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description)=Ucase(strLevel3src_Name) then
          GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Expand(True)
          intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).get_RowHandle
'          Call GridControl.ClearSelectionCore
'          Call GridControl.FocusViewAndRow(GridControl,intRow)
'          GridControl.SetFocusOnCurrentItem
'          Call GridControl.SelectRowCore(intRow)
'          sys.Keys "[Down]"
'          sys.Keys "[Up]" 
          GridControl.set_FocusedRowHandle(intRow)
          GridControl.set_FocusedRowData(intRow)
          delay(1000)
          GridControl.Keys("[Down]")
          GridControl.Keys("[Up]")
          log.Message "Level3 layout Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description
          blnFlag = False
          Exit For   
        End If 
      Next
      If blnFlag = True then
        strTCRemarks="Level3 Source Name not found"
        strTestCaseResult="FAIL"
        Exit Sub
      End If
      
      SYS.Keys("^o")
      DElay (35000)
      Delay 6000,"Opening STP.. Pls wait.."
       ''Selecting Full History in STP
       Call sExcelFullHistory
       
       strTCRemarks = strTCRemarks & "<br />" & "Opened STP Successfully"
       
      objArray = Sys.FindAllChildren("ProcessName","EXCEL", 5,True)
      For i=0 to ubound(objArray)
        log.Message objArray(i).FullName
        set oSTP_ExcelObj = objArray(i).FindChild("WndCaption", "*RUN*",1,True)
        If oSTP_ExcelObj.Exists = True Then
        Else
          objArray(i).Close
        End If
      Next
      
End Sub 

Sub sCheckSourceMultipleSource(strParameters)

On Error Resume Next

    Dim intRow,strTemp,objTemp,Grid,intI
    Dim objEdge,objCaption,i,objText,j,strWrkSpaceName,strDesc1,strDesc2

    strSource_Name=getSplitValue(strParameters,"SOURCE")
    strLevel2src_Name=getSplitValue(strParameters,"LEVEL2SOURCE")

    
'    strSource_Name="Test"
'    strLevel2src_Name="Automation"

    
    strDesc1=aqDateTime.Now
    strDesc2=aqDateTime.Now
    DescText=Replace(strDesc1,"/","-")
    DescText=Replace(DescText,":","_")
    DescLocalText=DescText
    strWrkSpaceName=DescText
    intSeriesID=getSplitValue(strParameters,"SERIESID")
    if intSeriesID=0 then
      Call sSourceseries
      intSeriesID=strSourceFileText
    End if 
    Call sHome_Source
    ''Setting grid Objects
    strTemp="WPFObject(""SourceTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""SourceTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    
    Delay 10000,"Pls Wait.."
    ''Selecting Country Name
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource_Name) then
          GridControl.Nodes_2.Item(intI).Expand(True)
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description       
    '      strTCRemarks=strTCRemarks & Chr(10) & "Selected Node - " & GridControl.Nodes_2.Item(intI).Content.Description  
          blnFlag=False  
          Exit For
        End If
    Next
    If blnFlag = True then
      strTCRemarks="Country Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
  
    Delay 10000,"Pls Wait.."
    blnFlag = True 
    ''Selecting Level2Source_Name
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
    For intJ=0 to intTotNodeCnt-1
      strTemp=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strLevel2src_Name) then
       ' GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
        intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
        Call GridControl.ClearSelectionCore
        Call GridControl.FocusViewAndRow(GridControl,intRow)
        GridControl.SetFocusOnCurrentItem
        Call GridControl.SelectRowCore(intRow)
        delay(1000)
        GridControl.Keys("[Down]")
        GridControl.Keys("[Up]")
        log.Message "Level2 Source Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
        blnFlag = False 
        Exit For
      End If
    Next
    If blnFlag = True then
      log.Message "Level2 Source Name not found"
      strTCRemarks="Level2 Source Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
      
      SYS.Keys("![Down]")
      Delay 2000,"Pls Wait.."

    strTemp="WPFObject(""ArrowControl"", """", 1)"
    Set objNewWorkspace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,20,True)
    If objNewWorkspace.Exists = True then
      objNewWorkspace.Click
       strTemp="WPFObject(""BarPopupBorderControl"", """", 1)"
      Set objWrkspace_popup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").FindChild("Name",strTemp,5,True)
      If objWrkspace_popup.Exists = True then
        strTemp="WPFObject(""ContentControlEx"", ""Open For Edit (Source)"", 2)"
        Set objopenforEdit=objWrkspace_popup.FindChild("Name",strTemp,8,True)
        If objopenforEdit.Exists then
          objopenforEdit.Click    
          'Delay 20000,"Please Wait..."
        End If
      End if
      
       strTemp="WPFObject(""ArrowControl"", """", 1)"
        Set objNewWorkspace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,20,True)
        If objNewWorkspace.Exists = True then
          objNewWorkspace.Click
          strTemp="WPFObject(""BarPopupBorderControl"", """", 1)"
          Set objWrkspace_popup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").FindChild("Name",strTemp,5,True)
          If objWrkspace_popup.Exists = True then
            strTemp="WPFObject(""ContentControlEx"", ""Open For Edit (Source)"", 2)"
            Set objopenforEdit=objWrkspace_popup.FindChild("Name",strTemp,8,True)
            If objopenforEdit.Exists then
              objopenforEdit.Click    
             ' Delay 12000,"Please Wait..."
            End If
          End If
                
          strTemp1="WPFObject(""HwndSource: WorkspaceNamePrompt"", ""Please provide a new Workspace Name"")"
          Set objNewWrkSpaceName=Sys.Process("EdgeClient").WaitChild(strTemp1,50000)
          If objNewWrkSpaceName.Exists = True then
   
            ''Waiting for Workspace Name prompt
            strTemp="WPFObject(""FloatingContainerBorder"")"
            Set objNewWrkSpace_Name=Sys.Process("EdgeClient").WPFObject("HwndSource: WorkspaceNamePrompt", "Please provide a new Workspace Name").WPFObject("WorkspaceNamePrompt", "Please provide a new Workspace Name", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,900000)
            If objNewWrkSpace_Name.Exists = True then
              strTemp="WPFObject(""ChangeNameTextEdit"")"
              ''Entering Workspace Name
              Set objNewWrkSpace_Txtbox=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
                If objNewWrkSpace_Txtbox.Exists = True then
                  objNewWrkSpace_Txtbox.Click
                  objNewWrkSpace_Txtbox.Text=strWrkSpaceName
                  ''Clicking on Ok Button 
                  strTemp="WPFObject(""OkButton"")"
                  Set objNewWrkSpace_okbtn=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
                  If objNewWrkSpace_okbtn.Exists = True then
                    objNewWrkSpace_okbtn.Click
                     Call sEdgeProcessor
                   ' Delay 5000,"Please wait..."
                  End If
                End If
            End If
          End if
      End If
  End if
   ''Handling Validation for Source
    strTemp="WPFObject(""HwndSource: WindowContentHolder"", """")"
    Set objTemp=Sys.Process("EdgeClient").WaitChild(strTemp,10000)
    If objTemp.Exists = True then
      objTemp.Keys "[Enter]"
      strTestCaseResult = "FAIL"
      Exit Sub
    End If

    ''WorkSpace Edit Window
    strTemp="WPFObject(""LayoutPanel"", """", 2)"
    Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,13,True)
    If objTemp.Exists then
        Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WPFObject("SourceTreeListView")
        Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl")

        ''Expanding First Node in Tree      
        intTotNodeCnt=GridControl.Nodes_2.Count  
        For intI=0 to intTotNodeCnt-1         
          If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource_Name) then
            GridControl.Nodes_2.Item(intI).Expand(True)
            blnFlag=False  
            Exit For
          End If
        Next
    End if     
    Call sCloseSource()
    Call sCloseSource()
    Call SourceWorkSpacevwr() 
End Sub 
Sub sCheckSourceMultipleSourceView(strParameters)

On Error Resume Next

    Dim intRow,strTemp,objTemp,Grid,intI
    Dim objEdge,objCaption,i,objText,j,strWrkSpaceName,strDesc1,strDesc2

    strSource_Name=getSplitValue(strParameters,"SOURCE")
    strLevel2src_Name=getSplitValue(strParameters,"LEVEL2SOURCE")

'      strSource_Name="Test"
'      strLevel2src_Name="Automation"

    strDesc1=aqDateTime.Now
    strDesc2=aqDateTime.Now
    DescText=Replace(strDesc1,"/","-")
    DescText=Replace(DescText,":","_")
    DescLocalText=DescText
    strWrkSpaceName=DescText
    intSeriesID=getSplitValue(strParameters,"SERIESID")
    if intSeriesID=0 then
      Call sSourceseries
      intSeriesID=strSourceFileText
    End if 
    Call sHome_Source
    ''Setting grid Objects
    strTemp="WPFObject(""SourceTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""SourceTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    
    Delay 10000,"Pls Wait.."
    ''Selecting Country Name
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource_Name) then
          GridControl.Nodes_2.Item(intI).Expand(True)
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description       
    '      strTCRemarks=strTCRemarks & Chr(10) & "Selected Node - " & GridControl.Nodes_2.Item(intI).Content.Description  
          blnFlag=False  
          Exit For
        End If
    Next
    If blnFlag = True then
      strTCRemarks="Country Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
  
    Delay 10000,"Pls Wait.."
    blnFlag = True 
    ''Selecting Level2Source_Name
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
    For intJ=0 to intTotNodeCnt-1
      strTemp=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strLevel2src_Name) then
       ' GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
        intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
        Call GridControl.ClearSelectionCore
        Call GridControl.FocusViewAndRow(GridControl,intRow)
        GridControl.SetFocusOnCurrentItem
        Call GridControl.SelectRowCore(intRow)
        delay(1000)
        GridControl.Keys("[Down]")
        GridControl.Keys("[Up]")
        log.Message "Level2 Source Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
        blnFlag = False 
        Exit For
      End If
    Next
    If blnFlag = True then
      log.Message "Level2 Source Name not found"
      strTCRemarks="Level2 Source Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If

      SYS.Keys("![Down]")
      Delay 2000,"Pls Wait.."
      
      strTemp="WPFObject(""ArrowControl"", """", 1)"
    Set objNewWorkspace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,20,True)
    If objNewWorkspace.Exists = True then
      objNewWorkspace.Click
      strTemp="WPFObject(""BarPopupBorderControl"", """", 1)"
     ' Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarButtonItemLinkControl", "", 1).WPFObject("ContentControlEx", "Open For View (Source)", 2)
      Set objWrkspace_popup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).FindChild("Name",strTemp,5,True)
      If objWrkspace_popup.Exists = True then
        strTemp="WPFObject(""ContentControlEx"", ""Open For View (Source)"", 2)"
        Set objOpenView=objWrkspace_popup.FindChild("Name",strTemp,8,True)
        If objOpenView.Exists then
          objOpenView.Click  
          strTCRemarks = strTCRemarks & "<br />" & "Open for view in Source"  
        End If
      End If
     End if 
    Delay 15000,"Pls Wait.."
     ''Handling Validation for Source
    strTemp="WPFObject(""HwndSource: WindowContentHolder"", """")"
    Set objTemp=Sys.Process("EdgeClient").WaitChild(strTemp,10000)
    If objTemp.Exists = True then
      objTemp.Keys "[Enter]"
      strTestCaseResult = "FAIL"
      Exit Sub
    End If

    ''WorkSpace Edit Window
    strTemp="WPFObject(""LayoutPanel"", """", 2)"
    Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,13,True)
      If objTemp.Exists then
          Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WPFObject("SourceTreeListView")
          Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl")

          ''Expanding First Node in Tree      
          intTotNodeCnt=GridControl.Nodes_2.Count
          For intI=0 to intTotNodeCnt-1         
              If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
                GridControl.Nodes_2.Item(intI).Expand(True)
                log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description       
                blnFlag=False  
                Exit For
              End If
          Next
          If blnFlag = True then
            strTCRemarks="Country Name not found"
            strTestCaseResult="FAIL"
            Exit Sub
          End If
     End if
   
    Call sCloseSource()
    Call sCloseSource()
End Sub

Sub sCheckSourceMultipleSourcechecklistView(strParameters)

On Error Resume Next

    Dim intRow,strTemp,objTemp,Grid,intI
    Dim objEdge,objCaption,i,objText,j,strWrkSpaceName,strDesc1,strDesc2
'
    strSource_Name=getSplitValue(strParameters,"SOURCE")
    strLevel2src_Name=getSplitValue(strParameters,"LEVEL2SOURCE")

    
'      strSource_Name="Test"
'      strLevel2src_Name="Automation"

    
    strDesc1=aqDateTime.Now
    strDesc2=aqDateTime.Now
    DescText=Replace(strDesc1,"/","-")
    DescText=Replace(DescText,":","_")
    DescLocalText=DescText
    strWrkSpaceName=DescText
'    intSeriesID=getSplitValue(strParameters,"SERIESID")
'    if intSeriesID=0 then
'      Call sSourceseries
'      intSeriesID=strSourceFileText
'    End if 
    Call sHome_Source
    ''Setting grid Objects
    strTemp="WPFObject(""SourceTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""SourceTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    
    Delay 10000,"Pls Wait.."
    ''Selecting Country Name
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource_Name) then
          GridControl.Nodes_2.Item(intI).Expand(True)
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description       
    '      strTCRemarks=strTCRemarks & Chr(10) & "Selected Node - " & GridControl.Nodes_2.Item(intI).Content.Description  
          blnFlag=False  
          Exit For
        End If
    Next
    If blnFlag = True then
      strTCRemarks="Country Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
  
    Delay 10000,"Pls Wait.."
    blnFlag = True 
    ''Selecting Level2Source_Name
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
    For intJ=0 to intTotNodeCnt-1
      strTemp=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strLevel2src_Name) then
       ' GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
        intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
        Call GridControl.ClearSelectionCore
        Call GridControl.FocusViewAndRow(GridControl,intRow)
        GridControl.SetFocusOnCurrentItem
        Call GridControl.SelectRowCore(intRow)
        delay(1000)
        GridControl.Keys("[Down]")
        GridControl.Keys("[Up]")
        log.Message "Level2 Source Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
        blnFlag = False 
        Exit For
      End If
    Next
    If blnFlag = True then
      log.Message "Level2 Source Name not found"
      strTCRemarks="Level2 Source Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If

      SYS.Keys("![Down]")
      Delay 2000,"Pls Wait.."
      
      strTemp="WPFObject(""ArrowControl"", """", 1)"
    Set objNewWorkspace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,20,True)
    If objNewWorkspace.Exists = True then
      objNewWorkspace.Click
      strTemp="WPFObject(""BarPopupBorderControl"", """", 1)"
     ' Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarButtonItemLinkControl", "", 1).WPFObject("ContentControlEx", "Open For View (Source)", 2)
      Set objWrkspace_popup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).FindChild("Name",strTemp,5,True)
      If objWrkspace_popup.Exists = True then
        strTemp="WPFObject(""ContentControlEx"", ""Open For View (Source)"", 2)"
        Set objOpenView=objWrkspace_popup.FindChild("Name",strTemp,8,True)
        If objOpenView.Exists then
          objOpenView.Click  
          strTCRemarks = strTCRemarks & "<br />" & "Open for view in Source"  
        End If
      End If
     End if 
    Delay 15000,"Pls Wait.."
     ''Handling Validation for Source
    strTemp="WPFObject(""HwndSource: WindowContentHolder"", """")"
    Set objTemp=Sys.Process("EdgeClient").WaitChild(strTemp,10000)
    If objTemp.Exists = True then
      objTemp.Keys "[Enter]"
      strTestCaseResult = "FAIL"
      Exit Sub
    End If

    ''WorkSpace Edit Window
    strTemp="WPFObject(""LayoutPanel"", """", 2)"
    Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,13,True)
      If objTemp.Exists then
          Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WPFObject("SourceTreeListView")
          Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl")

          ''Expanding First Node in Tree      
          intTotNodeCnt=GridControl.Nodes_2.Count
          For intI=0 to intTotNodeCnt-1         
              If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
                GridControl.Nodes_2.Item(intI).Expand(True)
                log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description       
                blnFlag=False  
                Exit For
              End If
          Next
          If blnFlag = True then
            strTCRemarks="Country Name not found"
            strTestCaseResult="FAIL"
            Exit Sub
          End If
     End if
   
    Call sCloseSource()
    Call sCloseSource()
End Sub
Sub  sCheckSourceExpand(strParameters)
On Error Resume Next 
   Dim strSource1,StrSource2,strSource3,strTemp,GridControl,GridSourceTree,intTotNodeCnt,intI,intJ,intRow,intK,objEdge
   Dim objNewWorkspace,objWrkspace_popup,objOpenView,strTemp1,objNewWrkSpaceName,objNewWrkSpace_Txtbox,objNewWrkSpace_okbtn,objNewWrkSpace_Name
   Dim strDesc1,strDesc2,DescText,DescLocalText
   
    strSource1=getSplitValue(strParameters,"SOURCE")
    StrSource2=getSplitValue(strParameters,"LEVEL2SOURCE")

'    strSource1="Test"
'    StrSource2="Automation"

    Call sHome_Source
    

    strWrkSpaceName="Workspace1"
    
    strTemp="WPFObject(""SourceTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""SourceTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    Delay 10000,"Pls Wait.."
    ''Selecting Country Name
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
          GridControl.Nodes_2.Item(intI).Expand(True)
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description       
          blnFlag=False  
          Exit For
        End If
    Next
    If blnFlag = True then
      strTCRemarks="Country Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
  
    Delay 10000,"Pls Wait.."
        blnFlag = True 
    ''Selecting Level2Source_Name
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
  For intJ=0 to intTotNodeCnt-1
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(StrSource2) then
        intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
'        Call GridSourceTree.ClickCell(intRow, "Edit")
        Call GridControl.ClearSelectionCore
        Call GridControl.FocusViewAndRow(GridControl,intRow)
        GridControl.SetFocusOnCurrentItem
        Call GridControl.SelectRowCore(intRow)
        log.Message "Level2 Source Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
        blnFlag = False 
        Exit For
      End If
    Next
    If blnFlag = True then
      log.Message "Level2 Source Name not found"
      strTCRemarks="Level2 Source Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
    Delay 2000,"Pls Wait.."
      GridControl.Keys "^[Enter]" 
     strTCRemarks = strTCRemarks & "<br />" & "Expanded all childs for selected Source "
     log.Message "Expanded all childs for selected Source"
    Call sCloseSource()
End Sub

Sub  sCheckSourceCollapse(strParameters)
On Error Resume Next 
   Dim strSource1,StrSource2,strSource3,strTemp,GridControl,GridSourceTree,intTotNodeCnt,intI,intJ,intRow,intK,objEdge
   Dim objNewWorkspace,objWrkspace_popup,objOpenView,strTemp1,objNewWrkSpaceName,objNewWrkSpace_Txtbox,objNewWrkSpace_okbtn,objNewWrkSpace_Name
   Dim strDesc1,strDesc2,DescText,DescLocalText
   
    strSource1=getSplitValue(strParameters,"SOURCE")
    StrSource2=getSplitValue(strParameters,"LEVEL2SOURCE")

'    strSource1="Test"
'    StrSource2="Automation"

    Call sHome_Source
    

    strWrkSpaceName="Workspace1"
    
    strTemp="WPFObject(""SourceTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""SourceTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    Delay 10000,"Pls Wait.."
    ''Selecting Country Name
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
          GridControl.Nodes_2.Item(intI).Expand(True)
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description       
          blnFlag=False  
          Exit For
        End If
    Next
    If blnFlag = True then
      strTCRemarks="Country Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
  
    Delay 10000,"Pls Wait.."
        blnFlag = True 
    ''Selecting Level2Source_Name
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
  For intJ=0 to intTotNodeCnt-1
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(StrSource2) then
        intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
'        Call GridSourceTree.ClickCell(intRow, "Edit")
        Call GridControl.ClearSelectionCore
        Call GridControl.FocusViewAndRow(GridControl,intRow)
        GridControl.SetFocusOnCurrentItem
        Call GridControl.SelectRowCore(intRow)
        log.Message "Level2 Source Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
        blnFlag = False 
        Exit For
      End If
    Next
    If blnFlag = True then
      log.Message "Level2 Source Name not found"
      strTCRemarks="Level2 Source Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
      Delay 10000,"Pls Wait.."
    
     GridControl.Keys "^[Enter]" 
     strTCRemarks = strTCRemarks & "<br />" & "Expanded all childs for selected Source "
     log.Message "Expanded all childs for selected Source"
     
     Delay 10000,"Pls Wait.."
     GridControl.Keys "[Enter]" 
     strTCRemarks = strTCRemarks & "<br />" & "Collapse all childs for selected Source "
     log.Message "Collapse all childs for selected Source"
    Call sCloseSource()
End Sub

Sub  sCheckSourceSTPButtons(strParameters)
On Error Resume Next 
   Dim strSource1,StrSource2,strSource3,strTemp,GridControl,GridSourceTree,intTotNodeCnt,intI,intJ,intRow,intK,objEdge
   Dim objNewWorkspace,objWrkspace_popup,objOpenView,strTemp1,objNewWrkSpaceName,objNewWrkSpace_Txtbox,objNewWrkSpace_okbtn,objNewWrkSpace_Name
   Dim strDesc1,strDesc2,DescText,DescLocalText
   
    strSource1=getSplitValue(strParameters,"SOURCE")
    
'    strSource1="Test"

    Call sHome_Source
    

    strWrkSpaceName="Workspace1"
    
    strTemp="WPFObject(""SourceTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""SourceTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    Delay 10000,"Pls Wait.."
    ''Selecting Country Name
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
          GridControl.Nodes_2.Item(intI).Expand(True)
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description       
          blnFlag=False  
          Exit For
        End If
    Next
    If blnFlag = True then
      strTCRemarks="Country Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
  
    Delay 1000,"Pls Wait.."
     set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 6).WPFObject("BarButtonItemLinkControl", "", 1)
      strTemp="WPFObject(""ContentControlEx"", ""Open Global STP"", 2)"
      Set objTemp=objEdge.FindChild("Name",strTemp,50)
      If objTemp.Exists=True then
        If objTemp.Enabled=True then
          strTCRemarks = strTCRemarks & "<br />" & "Open Global STP is Enabled in Source"
          log.Message "Open Global STP is Enabled  in Source"
        Else
          strTCRemarks = strTCRemarks & "<br />" & "Open Global STP is Disabled in Source"
          log.Message "Open Global STP is Disabled  in Source"
        End if
      End if 
      
      set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 7).WPFObject("BarButtonItemLinkControl", "", 1)
      strTemp="WPFObject(""ContentControlEx"", ""Open CN STP"", 2)"
      Set objTemp=objEdge.FindChild("Name",strTemp,50)
      If objTemp.Exists=True then
        If objTemp.Enabled=True then
          strTCRemarks = strTCRemarks & "<br />" & "Open CN STP is Enabled in Source"
          log.Message "Open CN STP is Enabled  in Source"
         Else
          strTCRemarks = strTCRemarks & "<br />" & "Open CN STP is Disabled in Source"
          log.Message "Open CN STP is Disabled  in Source"
        end if
      else
        strTCRemarks =  "Open CN STP is Not found in Source"
      End if 
    Call sCloseSource()
End Sub

Sub sCheckSourceGlobalSTPRightClick(strParameters)
On Error Resume Next

   Dim strSource1,StrSource2,strSource3,strTemp,GridControl,GridSourceTree,intTotNodeCnt,intI,intJ,intRow,intK,objEdge
   Dim objArray,i,oSTP_ExcelObj
   
   
    strSource1=getSplitValue(strParameters,"SOURCE")
    StrSource2=getSplitValue(strParameters,"LEVEL2SOURCE")
    StrSource3=getSplitValue(strParameters,"LEVEL3SOURCE")

'    strSource1="Test"
'    StrSource2="Automation"
'    StrSource3="Test Source 1"
    
     Call sHome_Source
    strTemp="WPFObject(""SourceTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""SourceTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    Delay 10000,"Pls Wait.."
    ''Selecting Country Name
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
          GridControl.Nodes_2.Item(intI).Expand(True)
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description       
          blnFlag=False  
          Exit For
        End If
    Next
    If blnFlag = True then
      strTCRemarks="Country Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
  
    Delay 10000,"Pls Wait.."
        blnFlag = True 
    ''Selecting Level2Source_Name
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
  For intJ=0 to intTotNodeCnt-1
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(StrSource2) then
        GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
        intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
'        Call GridSourceTree.ClickCell(intRow, "Edit")
        Call GridControl.ClearSelectionCore
        Call GridControl.FocusViewAndRow(GridControl,intRow)
        GridControl.SetFocusOnCurrentItem
        Call GridControl.SelectRowCore(intRow)
        log.Message "Level2 Source Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
        blnFlag = False 
        Exit For
      End If
    Next
    If blnFlag = True then
      log.Message "Level2 Source Name not found"
      strTCRemarks="Level2 Source Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
    Delay 2000,"Pls Wait.."
    
    ''Selecting Level3 Layout
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count
    For intK=0 to intTotNodeCnt-1
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description)=Ucase(StrSource3) then
        GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Expand(True)
        intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).get_RowHandle
        Call GridControl.ClearSelectionCore
        Call GridControl.FocusViewAndRow(GridControl,intRow)
        GridControl.SetFocusOnCurrentItem
        Call GridControl.SelectRowCore(intRow)
        
        Dim PropArray,ValueArray, objTemp, left, Top     
        PropArray = Array("ClrClassName", "DisplayText")
        ValuesArray = Array("EditorControlStub",StrSource3)
        Set objTemp = GridControl.FindChild(PropArray, ValuesArray, 8)
  
        If objTemp.Exists = True Then
          left =  objTemp.ActualWidth/2
          Top =  objTemp.ActualHeight/2    
          Call objTemp.ClickR(left, Top, 0)
        Else
          log.Message "Cannot find the Cell"
        End If
        log.Message "Level3 Source Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description
        blnFlag = False
        Exit For   
      End If 
    Next
    
 
    set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 2).WPFObject("BarButtonItemLinkControl", "", 1)
      strTemp="WPFObject(""ContentControlEx"", ""Open Global STP"", 2)"
      Set objTemp=objEdge.FindChild("Name",strTemp,50)
      If objTemp.Exists=True then
        If objTemp.Enabled=True then
         strTCRemarks = strTCRemarks & "<br />" & "Open Global STP is found in Source"
          log.Message "Open Global STP is found  in Source"
          objTemp.Click
           Delay 6000,"Opening STP.. Pls wait.."
           ''Selecting Full History in STP
           Call sExcelFullHistory
         Else
          strTCRemarks = strTCRemarks & "<br />" & "Open Global STP is Disabled in Source"
        end if
      else
        strTCRemarks =  "Open Global STP is Not found in Source"
      End if  
  
      objArray = Sys.FindAllChildren("ProcessName","EXCEL", 5,True)
      For i=0 to ubound(objArray)
        log.Message objArray(i).FullName
        set oSTP_ExcelObj = objArray(i).FindChild("WndCaption", "*RUN*",1,True)
        If oSTP_ExcelObj.Exists = True Then
        Else
          objArray(i).Close
        End If
      Next    
End Sub
Sub sCheckSourceCNSTPRightClick(strParameters)
On Error Resume Next

   Dim strSource1,StrSource2,strSource3,strTemp,GridControl,GridSourceTree,intTotNodeCnt,intI,intJ,intRow,intK,objEdge
   Dim objArray,i,oSTP_ExcelObj
   
   
    strSource1=getSplitValue(strParameters,"SOURCE")
    StrSource2=getSplitValue(strParameters,"LEVEL2SOURCE")
    StrSource3=getSplitValue(strParameters,"LEVEL3SOURCE")

'    strSource1="Test"
'    StrSource2="Automation"
'    StrSource3="Test Source 1"
    
     Call sHome_Source
    strTemp="WPFObject(""SourceTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""SourceTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    Delay 10000,"Pls Wait.."
    ''Selecting Country Name
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
          GridControl.Nodes_2.Item(intI).Expand(True)
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description       
          blnFlag=False  
          Exit For
        End If
    Next
    If blnFlag = True then
      strTCRemarks="Country Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
  
    Delay 10000,"Pls Wait.."
        blnFlag = True 
    ''Selecting Level2Source_Name
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
  For intJ=0 to intTotNodeCnt-1
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(StrSource2) then
        GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
        intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
'        Call GridSourceTree.ClickCell(intRow, "Edit")
        Call GridControl.ClearSelectionCore
        Call GridControl.FocusViewAndRow(GridControl,intRow)
        GridControl.SetFocusOnCurrentItem
        Call GridControl.SelectRowCore(intRow)
        log.Message "Level2 Source Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
        blnFlag = False 
        Exit For
      End If
    Next
    If blnFlag = True then
      log.Message "Level2 Source Name not found"
      strTCRemarks="Level2 Source Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
    Delay 2000,"Pls Wait.."
    
    ''Selecting Level3 Layout
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count
    For intK=0 to intTotNodeCnt-1
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description)=Ucase(StrSource3) then
        GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Expand(True)
        intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).get_RowHandle
        Call GridControl.ClearSelectionCore
        Call GridControl.FocusViewAndRow(GridControl,intRow)
        GridControl.SetFocusOnCurrentItem
        Call GridControl.SelectRowCore(intRow)
        
        Dim PropArray,ValueArray, objTemp, left, Top     
        PropArray = Array("ClrClassName", "DisplayText")
        ValuesArray = Array("EditorControlStub",StrSource3)
        Set objTemp = GridControl.FindChild(PropArray, ValuesArray, 8)
  
        If objTemp.Exists = True Then
          left =  objTemp.ActualWidth/2
          Top =  objTemp.ActualHeight/2    
          Call objTemp.ClickR(left, Top, 0)
        Else
          log.Message "Cannot find the Cell"
        End If
        log.Message "Level3 Source Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description
        blnFlag = False
        Exit For   
      End If 
    Next
    
 
    set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 3).WPFObject("BarButtonItemLinkControl", "", 1)
      strTemp="WPFObject(""ContentControlEx"", ""Open CN STP"", 2)"
      Set objTemp=objEdge.FindChild("Name",strTemp,50)
      If objTemp.Exists=True then
        If objTemp.Enabled=True then
         strTCRemarks = strTCRemarks & "<br />" & "Open CN STP is found in Source"
          log.Message "Open CN STP is found  in Source"
          objTemp.Click
           Delay 6000,"Opening STP.. Pls wait.."
           ''Selecting Full History in STP
           Call sExcelFullHistory
         Else
          strTCRemarks = strTCRemarks & "<br />" & "Open CN STP is Disabled in Source"
        end if
      else
        strTCRemarks =  "Open CN STP is Not found in Source"
      End if  
  
      objArray = Sys.FindAllChildren("ProcessName","EXCEL", 5,True)
      For i=0 to ubound(objArray)
        log.Message objArray(i).FullName
        set oSTP_ExcelObj = objArray(i).FindChild("WndCaption", "*RUN*",1,True)
        If oSTP_ExcelObj.Exists = True Then
        Else
          objArray(i).Close
          strTemp="Window(""Button"", ""&Yes"", 1)"
          Set objTemp=Sys.Process("EXCEL", 2).Window("#32770", "Warning", 1).WaitChild(strTemp,120000)
          If objTemp.Exists Then
            Sys.Process("EXCEL", 2).Window("#32770", "Warning", 1).Window("Button", "&Yes", 1).Click
          End if
         Delay 6000,"Closing CN STP.. Pls wait.."
        End If
      Next    
End Sub
Sub sCheckSourceRightClick(strParameters)
On Error Resume Next

   Dim strSource1,StrSource2,strSource3,strTemp,GridControl,GridSourceTree,intTotNodeCnt,intI,intJ,intRow,intK,objEdge
   Dim objArray,i,oSTP_ExcelObj
   
   
    strSource1=getSplitValue(strParameters,"SOURCE")
    StrSource2=getSplitValue(strParameters,"LEVEL2SOURCE")


'    strSource1="Test"
'    StrSource2="Automation"
   
    
     Call sHome_Source
    strTemp="WPFObject(""SourceTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""SourceTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    Delay 10000,"Pls Wait.."
    ''Selecting Country Name
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
          GridControl.Nodes_2.Item(intI).Expand(True)
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description       
          blnFlag=False  
          Exit For
        End If
    Next
    If blnFlag = True then
      strTCRemarks="Country Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
  
    Delay 10000,"Pls Wait.."
        blnFlag = True 
    ''Selecting Level2Source_Name
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
  For intJ=0 to intTotNodeCnt-1
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(StrSource2) then
        'GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
        intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
'        Call GridSourceTree.ClickCell(intRow, "Edit")
        Call GridControl.ClearSelectionCore
        Call GridControl.FocusViewAndRow(GridControl,intRow)
        GridControl.SetFocusOnCurrentItem
        Call GridControl.SelectRowCore(intRow)
        
        Dim PropArray,ValueArray, objTemp, left, Top     
        PropArray = Array("ClrClassName", "DisplayText")
        ValuesArray = Array("EditorControlStub",StrSource2)
        Set objTemp = GridControl.FindChild(PropArray, ValuesArray,18)
  
        If objTemp.Exists = True Then
          left =  objTemp.ActualWidth/2
          Top =  objTemp.ActualHeight/2    
          Call objTemp.ClickR(left, Top, 0)
          Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").Keys("[Down][Right]")
          
        Else
          log.Message "Cannot find the Cell"
        End If
  
        log.Message "Level2 Source Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
        blnFlag = False 
        Exit For
         
      End If
    Next
    If blnFlag = True then
      log.Message "Level2 Source Name not found"
      strTCRemarks="Level2 Source Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
    Delay 5000,"Pls Wait.."
    
      set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 2).WPFObject("BarButtonItemLinkControl", "", 1)
      strTemp="WPFObject(""ContentControlEx"", ""Open Global STP"", 2)"
      Set objTemp=objEdge.FindChild("Name",strTemp,50)
      If objTemp.Exists=True then
        If objTemp.Enabled=True then
          strTCRemarks = strTCRemarks & "<br />" & "Open Global STP is found in Source"
          log.Message "Open Global STP is found  in Source"
        Else
          strTCRemarks = strTCRemarks & "<br />" & "Open Global STP is Disabled in Source"
        end if
      else
        strTCRemarks =  "Open Global STP is Not found in Source"
      End if  
    
      set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 3).WPFObject("BarButtonItemLinkControl", "", 1)
      strTemp="WPFObject(""ContentControlEx"", ""Open CN STP"", 2)"
      Set objTemp=objEdge.FindChild("Name",strTemp,50)
      If objTemp.Exists=True then
        If objTemp.Enabled=True then
          strTCRemarks = strTCRemarks & "<br />" & "Open CN STP is found in Source"
          log.Message "Open CN STP is found  in Source"
         Else
          strTCRemarks = strTCRemarks & "<br />" & "Open CN STP is Disabled in Source"
        end if
      else
        strTCRemarks =  "Open CN STP is Not found in Source"
      End if  
  
       'Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "", 2).WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).click  
      set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "", 2).WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarSubItemLinkControl", "", 1)
      strTemp="WPFObject(""ContentControlEx"", ""New Workspace"", 2)"
      Set objTemp=objEdge.FindChild("Name",strTemp,50)
      If objTemp.Exists=True then
        If objTemp.Enabled=True then
          strTCRemarks = strTCRemarks & "<br />" & "New Workspace is found in Source"
          log.Message "New Workspace is found  in Source"
          objTemp.Click
          set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "", 1).WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarButtonItemLinkControl", "", 1)
          strTemp="WPFObject(""ContentControlEx"", ""Open For View (Source)"", 2)"
          Set objTemp=objEdge.FindChild("Name",strTemp,50)
          If objTemp.Exists=True then
            If objTemp.Enabled=True then
              strTCRemarks = strTCRemarks & "<br />" & "Open For View (Source) is found in Source"
              log.Message "Open For View (Source) is found  in Source"
             Else
              strTCRemarks = strTCRemarks & "<br />" & "Open For View (Source) is Disabled in Source"
              log.Message "Open For View (Source) is Disabled  in Source"
            end if
          else
            strTCRemarks =  "Open For View (Source) is Not found in Source"
          End if
          
          set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "", 1).WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 2).WPFObject("BarButtonItemLinkControl", "", 1)
          strTemp="WPFObject(""ContentControlEx"", ""Open For Edit (Source)"", 2)"
          Set objTemp=objEdge.FindChild("Name",strTemp,50)
          If objTemp.Exists=True then
            If objTemp.Enabled=True then
              strTCRemarks = strTCRemarks & "<br />" & "Open For Edit (Source) is found in Source"
              log.Message "Open For Edit (Source) is found  in Source"
             Else
              strTCRemarks = strTCRemarks & "<br />" & "Open For Edit (Source) is Disabled in Source"
              log.Message "Open For Edit (Source) is Disabled  in Source"
            end if
          else
            strTCRemarks =  "Open For Edit (Source) is Not found in Source"
          End if
          
          set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "", 1).WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 3).WPFObject("BarButtonItemLinkControl", "", 1)
          strTemp="WPFObject(""ContentControlEx"", ""Open For View (Source Schedule)"", 2)"
          Set objTemp=objEdge.FindChild("Name",strTemp,50)
          If objTemp.Exists=True then
            If objTemp.Enabled=True then
              strTCRemarks = strTCRemarks & "<br />" & "Open For View (Source Schedule) is found in Source"
              log.Message "Open For View (Source Schedule) is found  in Source"
             Else
              strTCRemarks = strTCRemarks & "<br />" & "Open For View (Source Schedule) is Disabled in Source"
              log.Message "Open For View (Source Schedule) is Disabled  in Source"
            end if
          else
            strTCRemarks =  "Open For View (Source Schedule) is Not found in Source"
          End if

          set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "", 1).WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 4).WPFObject("BarButtonItemLinkControl", "", 1)
          strTemp="WPFObject(""ContentControlEx"", ""Open For Edit (Source Schedule)"", 2)"
          Set objTemp=objEdge.FindChild("Name",strTemp,50)
          If objTemp.Exists=True then
            If objTemp.Enabled=True then
              strTCRemarks = strTCRemarks & "<br />" & "Open For Edit (Source Schedule) is found in Source"
              log.Message "Open For Edit (Source Schedule) is found  in Source"
             Else
              strTCRemarks = strTCRemarks & "<br />" & "Open For Edit (Source Schedule) is Disabled in Source"
              log.Message "Open For Edit (Source Schedule) is Disabled  in Source"
            end if
          else
            strTCRemarks =  "Open For Edit (Source Schedule) is Not found in Source"
          End if
        Else
          strTCRemarks = strTCRemarks & "<br />" & "New Workspace is Disabled in Source"
        end if
      else
        strTCRemarks =  "New Workspace is Not found in Source"
      End if 
      Call SClosesource()        
End Sub
Sub  sCheckSourceOpenViewSourcescheduleRightClick(strParameters)
On Error Resume Next 
   Dim strSource1,StrSource2,strSource3,strTemp,GridControl,GridSourceTree,intTotNodeCnt,intI,intJ,intRow,intK,objEdge
   Dim objNewWorkspace,objWrkspace_popup,objOpenView
   
    strSource1=getSplitValue(strParameters,"SOURCE")
    StrSource2=getSplitValue(strParameters,"LEVEL2SOURCE")
'
'    strSource1="Test"
'    StrSource2="Automation"

    Call sHome_Source
    strTemp="WPFObject(""SourceTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""SourceTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    Delay 10000,"Pls Wait.."
    ''Selecting Country Name
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
          GridControl.Nodes_2.Item(intI).Expand(True)
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description       
          blnFlag=False  
          Exit For
        End If
    Next
    If blnFlag = True then
      strTCRemarks="Country Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
  
    Delay 10000,"Pls Wait.."
        blnFlag = True 
    ''Selecting Level2Source_Name
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
  For intJ=0 to intTotNodeCnt-1
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(StrSource2) then
        'GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
        intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
'        Call GridSourceTree.ClickCell(intRow, "Edit")
        Call GridControl.ClearSelectionCore
        Call GridControl.FocusViewAndRow(GridControl,intRow)
        GridControl.SetFocusOnCurrentItem
        Call GridControl.SelectRowCore(intRow)
        
        Dim PropArray,ValueArray, objTemp, left, Top     
        PropArray = Array("ClrClassName", "DisplayText")
        ValuesArray = Array("EditorControlStub",StrSource2)
        Set objTemp = GridControl.FindChild(PropArray, ValuesArray,18)
  
        If objTemp.Exists = True Then
          left =  objTemp.ActualWidth/2
          Top =  objTemp.ActualHeight/2    
          Call objTemp.ClickR(left, Top, 0)
          Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").Keys("[Down][Right]")
          
        Else
          log.Message "Cannot find the Cell"
        End If
  
        log.Message "Level2 Source Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
        blnFlag = False 
        Exit For
         
      End If
    Next
     If blnFlag = True then
      log.Message "Level2 Source Name not found"
      strTCRemarks="Level2 Source Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
    Delay 2000,"Pls Wait.."
    
    set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "", 1).WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 3).WPFObject("BarButtonItemLinkControl", "", 1)
    strTemp="WPFObject(""ContentControlEx"", ""Open For View (Source Schedule)"", 2)"
    Set objTemp=objEdge.FindChild("Name",strTemp,50)
    If objTemp.Exists=True then
      If objTemp.Enabled=True then
        strTCRemarks = strTCRemarks & "<br />" & "Open For View (Source Schedule) is found in Source"
        log.Message "Open For View (Source Schedule) is found  in Source"
        objTemp.Click  
        strTCRemarks = strTCRemarks & "<br />" & "Opened for view in Source(schedule)" 
       Else
        strTCRemarks = strTCRemarks & "<br />" & "Open For View (Source Schedule) is Disabled in Source"
        log.Message "Open For View (Source Schedule) is Disabled  in Source"
      end if
    else
      strTCRemarks =  "Open For View (Source Schedule) is Not found in Source"
    End if
  
  Call sEdgeProcessor
  Delay 15000,"Pls Wait.."
  Call SClosesource()
  Delay 5000,"Pls Wait.."
  Call SClosesource()
End Sub
Sub  sCheckSourceOpenViewSourceRightClick(strParameters)
On Error Resume Next 
   Dim strSource1,StrSource2,strSource3,strTemp,GridControl,GridSourceTree,intTotNodeCnt,intI,intJ,intRow,intK,objEdge
   Dim objNewWorkspace,objWrkspace_popup,objOpenView
   
    strSource1=getSplitValue(strParameters,"SOURCE")
    StrSource2=getSplitValue(strParameters,"LEVEL2SOURCE")

'    strSource1="Test"
'    StrSource2="Automation"

    Call sHome_Source
    strTemp="WPFObject(""SourceTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""SourceTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    Delay 10000,"Pls Wait.."
    ''Selecting Country Name
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
          GridControl.Nodes_2.Item(intI).Expand(True)
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description       
          blnFlag=False  
          Exit For
        End If
    Next
    If blnFlag = True then
      strTCRemarks="Country Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
  
    Delay 10000,"Pls Wait.."
        blnFlag = True 
    ''Selecting Level2Source_Name
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
  For intJ=0 to intTotNodeCnt-1
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(StrSource2) then
        'GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
        intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
'        Call GridSourceTree.ClickCell(intRow, "Edit")
        Call GridControl.ClearSelectionCore
        Call GridControl.FocusViewAndRow(GridControl,intRow)
        GridControl.SetFocusOnCurrentItem
        Call GridControl.SelectRowCore(intRow)
        
        Dim PropArray,ValueArray, objTemp, left, Top     
        PropArray = Array("ClrClassName", "DisplayText")
        ValuesArray = Array("EditorControlStub",StrSource2)
        Set objTemp = GridControl.FindChild(PropArray, ValuesArray,18)
  
        If objTemp.Exists = True Then
          left =  objTemp.ActualWidth/2
          Top =  objTemp.ActualHeight/2    
          Call objTemp.ClickR(left, Top, 0)
          Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").Keys("[Down][Right]")
          
        Else
          log.Message "Cannot find the Cell"
        End If
  
        log.Message "Level2 Source Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
        blnFlag = False 
        Exit For
         
      End If
    Next
     If blnFlag = True then
      log.Message "Level2 Source Name not found"
      strTCRemarks="Level2 Source Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
    Delay 2000,"Pls Wait.."
    
   'Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "", 2).WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).click  
      set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "", 2).WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarSubItemLinkControl", "", 1)
      strTemp="WPFObject(""ContentControlEx"", ""New Workspace"", 2)"
      Set objTemp=objEdge.FindChild("Name",strTemp,50)
      If objTemp.Exists=True then
        If objTemp.Enabled=True then
          strTCRemarks = strTCRemarks & "<br />" & "New Workspace is found in Source"
          log.Message "New Workspace is found  in Source"
          objTemp.Click
          set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "", 1).WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarButtonItemLinkControl", "", 1)
          strTemp="WPFObject(""ContentControlEx"", ""Open For View (Source)"", 2)"
          Set objTemp=objEdge.FindChild("Name",strTemp,50)
          If objTemp.Exists=True then
            If objTemp.Enabled=True then
              strTCRemarks = strTCRemarks & "<br />" & "Open For View (Source) is found in Source"
              log.Message "Open For View (Source) is found  in Source"
              objTemp.Click
             Else
              strTCRemarks = strTCRemarks & "<br />" & "Open For View (Source) is Disabled in Source"
              log.Message "Open For View (Source) is Disabled  in Source"
            end if
          else
            strTCRemarks =  "Open For View (Source) is Not found in Source"
          End if
        Else
          strTCRemarks = strTCRemarks & "<br />" & "New workspace is Disabled in Source"
          log.Message "New Workspace is Disabled  in Source"
        End if
      else
        strTCRemarks = strTCRemarks & "<br />" & "New Workspace is not found in Source"
        log.Message "New Workspace is not found in Source"
      End if
       
  Call sEdgeProcessor
  'Delay 15000,"Pls Wait.."
  Call SClosesource()
  Delay 5000,"Pls Wait.."
  Call SClosesource()
End Sub

Sub  sCheckSourceValidationOpenViewRightClick(strParameters)
On Error Resume Next 
   Dim strSource1,StrSource2,strSource3,strTemp,GridControl,GridSourceTree,intTotNodeCnt,intI,intJ,intRow,intK,objEdge
   Dim objNewWorkspace,objWrkspace_popup,objOpenView
   
    strSource1=getSplitValue(strParameters,"SOURCE")
    StrSource2=getSplitValue(strParameters,"LEVEL2SOURCE")

'    strSource1="Test"
'    StrSource2="Automation"

    Call sHome_Source
    strTemp="WPFObject(""SourceTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""SourceTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    Delay 10000,"Pls Wait.."
    ''Selecting Country Name
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
          GridControl.Nodes_2.Item(intI).Expand(True)
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description       
          blnFlag=False  
          Exit For
        End If
    Next
    If blnFlag = True then
      strTCRemarks="Country Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
  
    Delay 10000,"Pls Wait.."
        blnFlag = True 
    ''Selecting Level2Source_Name
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
   For intJ=0 to intTotNodeCnt-1
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(StrSource2) then
        'GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
        intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
'        Call GridSourceTree.ClickCell(intRow, "Edit")
        Call GridControl.ClearSelectionCore
        Call GridControl.FocusViewAndRow(GridControl,intRow)
        GridControl.SetFocusOnCurrentItem
        Call GridControl.SelectRowCore(intRow)
        
        Dim PropArray,ValueArray, objTemp, left, Top     
        PropArray = Array("ClrClassName", "DisplayText")
        ValuesArray = Array("EditorControlStub",StrSource2)
        Set objTemp = GridControl.FindChild(PropArray, ValuesArray,18)
  
        If objTemp.Exists = True Then
          left =  objTemp.ActualWidth/2
          Top =  objTemp.ActualHeight/2    
          Call objTemp.ClickR(left, Top, 0)
          Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").Keys("[Down][Right]")
          
        Else
          log.Message "Cannot find the Cell"
        End If
  
        log.Message "Level2 Source Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
        blnFlag = False 
        Exit For
         
      End If
    Next
     If blnFlag = True then
      log.Message "Level2 Source Name not found"
      strTCRemarks="Level2 Source Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
    Delay 2000,"Pls Wait.."
    
   'Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "", 2).WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).click  
      set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "", 2).WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarSubItemLinkControl", "", 1)
      strTemp="WPFObject(""ContentControlEx"", ""New Workspace"", 2)"
      Set objTemp=objEdge.FindChild("Name",strTemp,50)
      If objTemp.Exists=True then
        If objTemp.Enabled=True then
          strTCRemarks = strTCRemarks & "<br />" & "New Workspace is found in Source"
          log.Message "New Workspace is found  in Source"
          objTemp.Click
          set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "", 1).WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarButtonItemLinkControl", "", 1)
          strTemp="WPFObject(""ContentControlEx"", ""Open For View (Source)"", 2)"
          Set objTemp=objEdge.FindChild("Name",strTemp,50)
          If objTemp.Exists=True then
            If objTemp.Enabled=True then
              strTCRemarks = strTCRemarks & "<br />" & "Open For View (Source) is found in Source"
              log.Message "Open For View (Source) is found  in Source"
              objTemp.Click
             Else
              strTCRemarks = strTCRemarks & "<br />" & "Open For View (Source) is Disabled in Source"
              log.Message "Open For View (Source) is Disabled  in Source"
            end if
          else
            strTCRemarks =  "Open For View (Source) is Not found in Source"
          End if
        Else
          strTCRemarks = strTCRemarks & "<br />" & "New workspace is Disabled in Source"
          log.Message "New Workspace is Disabled  in Source"
        End if
      else
        strTCRemarks = strTCRemarks & "<br />" & "New Workspace is not found in Source"
        log.Message "New Workspace is not found in Source"
      End if
       
      Call sEdgeProcessor
      ''Handling Validation for Source
    strTemp="WPFObject(""HwndSource: WindowContentHolder"", """")"
    Set objTemp=Sys.Process("EdgeClient").WaitChild(strTemp,10000)
    If objTemp.Exists = True then
      objTemp.Keys "[Enter]"
      strTestCaseResult = "FAIL"
      Exit Sub
    End If

    ''WorkSpace Edit Window
    strTemp="WPFObject(""LayoutPanel"", """", 2)"
    Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,13,True)
    If objTemp.Exists then
        Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WPFObject("SourceTreeListView")
        Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl")

        ''Expanding First Node in Tree      
       intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
          GridControl.Nodes_2.Item(intI).Expand(True)
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description       
          blnFlag=False  
          Exit For
        End If
    Next
    If blnFlag = True then
      strTCRemarks="Country Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
      Delay 10000,"Pls Wait.."
        blnFlag = True 
    ''Selecting Level2Source_Name
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
    For intJ=0 to intTotNodeCnt-1
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(StrSource2) then
        GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
        intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
'       Call GridSourceTree.ClickCell(intRow, "Edit")
        Call GridControl.ClearSelectionCore
        Call GridControl.FocusViewAndRow(GridControl,intRow)
        GridControl.SetFocusOnCurrentItem
        Call GridControl.SelectRowCore(intRow)
        log.Message "Level2 Source Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
        blnFlag = False 
        Exit For
      End If
    Next
    If blnFlag = True then
      log.Message "Level2 Source Name not found"
      strTCRemarks="Level2 Source Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
    Delay 2000,"Pls Wait.."
        ''Clicking on New Folder
    '   strTemp="WPFObject(""BarButtonItemLinkControl"", """", 1)"
        Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 4).WPFObject("BarButtonItemLinkControl", "", 1)
        If objTemp.Exists = True then
          Delay 3000,"New Folder..."
          objTemp.Click
          Delay 8000,"New Folder..."
          strTCRemarks = strTCRemarks & "<br />" & "Clicked Add Folder Button in Source" 
        End If
    Dim strOk
    strTemp="WPFObject(""PART_ContainerContent"")"
      'Set strOk=Sys.Process("EdgeClient").WPFObject("HwndSource: WindowContentHolder", "Workspace").WPFObject("WindowContentHolder", "Workspace", 1).WPFObject("NonLogicalDecorator", "", 1).WPFObject("ThemedManagedContentPresenter", "", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WaitChild(strTemp,550000)
      Set strOk=Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "Workspace").WPFObject("CustomMessageBoxWindow", "Workspace", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,550000)
    If strOk.Exists Then
      SYS.Keys "[Enter]"
      strTCRemarks = strTCRemarks & "<br />" & "You are not allowed to Edit Open for View only workspace" 
    End If
    
    strTemp="WPFObject(""EdittingInViewOnlyErrorMessageLabel"")"
    Set strOk=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 2).WaitChild(strTemp,500000)
    If strOk.Exists Then
      SYS.Keys "[Enter]"
      strTCRemarks = strTCRemarks & "<br />" & "Changed the Label 'You are not allowed to edit an Open For View workspace.'" 
      log.Message "Changed the Label 'You are not allowed to edit an Open For View workspace.'" 
    End If
  End if
  Call SClosesource()
  Call SClosesource()
  
End Sub
Sub  sCheckSourceOpenEditRightClick(strParameters)
On Error Resume Next 
   Dim strSource1,StrSource2,strSource3,strTemp,GridControl,GridSourceTree,intTotNodeCnt,intI,intJ,intRow,intK,objEdge
   Dim objNewWorkspace,objWrkspace_popup,objOpenView,strTemp1,objNewWrkSpaceName,objNewWrkSpace_Txtbox,objNewWrkSpace_okbtn,objNewWrkSpace_Name
   Dim strDesc1,strDesc2,DescText,DescLocalText
   
    strSource1=getSplitValue(strParameters,"SOURCE")
    StrSource2=getSplitValue(strParameters,"LEVEL2SOURCE")
'
'    strSource1="Test"
'    StrSource2="Automation"

    Call sHome_Source
    
    strDesc1=aqDateTime.Now
    strDesc2=aqDateTime.Now
    DescText=Replace(strDesc1,"/","-")
    DescText=Replace(DescText,":","_")
    DescLocalText=DescText
    strWrkSpaceName=DescText
    intSeriesID=getSplitValue(strParameters,"SERIESID")
    if intSeriesID=0 then
      Call sSourceseries
      intSeriesID=strSourceFileText
    End if 
    
    strTemp="WPFObject(""SourceTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""SourceTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    Delay 10000,"Pls Wait.."
    ''Selecting Country Name
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
          GridControl.Nodes_2.Item(intI).Expand(True)
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description       
          blnFlag=False  
          Exit For
        End If
    Next
    If blnFlag = True then
      strTCRemarks="Country Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
  
    Delay 10000,"Pls Wait.."
        blnFlag = True 
    ''Selecting Level2Source_Name
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
 ''Selecting Level2Source_Name
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
   For intJ=0 to intTotNodeCnt-1
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(StrSource2) then
        'GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
        intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
'        Call GridSourceTree.ClickCell(intRow, "Edit")
        Call GridControl.ClearSelectionCore
        Call GridControl.FocusViewAndRow(GridControl,intRow)
        GridControl.SetFocusOnCurrentItem
        Call GridControl.SelectRowCore(intRow)
        
        Dim PropArray,ValueArray, objTemp, left, Top     
        PropArray = Array("ClrClassName", "DisplayText")
        ValuesArray = Array("EditorControlStub",StrSource2)
        Set objTemp = GridControl.FindChild(PropArray, ValuesArray,18)
  
        If objTemp.Exists = True Then
          left =  objTemp.ActualWidth/2
          Top =  objTemp.ActualHeight/2    
          Call objTemp.ClickR(left, Top, 0)
          Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").Keys("[Down][Right]")
          
        Else
          log.Message "Cannot find the Cell"
        End If
  
        log.Message "Level2 Source Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
        blnFlag = False 
        Exit For
         
      End If
    Next
  
    If blnFlag = True then
      log.Message "Level2 Source Name not found"
      strTCRemarks="Level2 Source Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
    Delay 2000,"Pls Wait.."

     set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "", 2).WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarSubItemLinkControl", "", 1)
      strTemp="WPFObject(""ContentControlEx"", ""New Workspace"", 2)"
      Set objTemp=objEdge.FindChild("Name",strTemp,50)
      If objTemp.Exists=True then
        If objTemp.Enabled=True then
          strTCRemarks = strTCRemarks & "<br />" & "New Workspace is found in Source"
          log.Message "New Workspace is found  in Source"
          objTemp.Click
          set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "", 1).WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 2).WPFObject("BarButtonItemLinkControl", "", 1)
          strTemp="WPFObject(""ContentControlEx"", ""Open For Edit (Source)"", 2)"
          Set objTemp=objEdge.FindChild("Name",strTemp,50)
          If objTemp.Exists=True then
            If objTemp.Enabled=True then
              strTCRemarks = strTCRemarks & "<br />" & "Open For Edit (Source) is found in Source"
              log.Message "Open For Edit (Source) is found  in Source"
              objTemp.Click
              strTemp1="WPFObject(""HwndSource: WorkspaceNamePrompt"", ""Please provide a new Workspace Name"")"
              Set objNewWrkSpaceName=Sys.Process("EdgeClient").WaitChild(strTemp1,50000)
              If objNewWrkSpaceName.Exists = True then
     
              ''Waiting for Workspace Name prompt
              strTemp="WPFObject(""FloatingContainerBorder"")"
              Set objNewWrkSpace_Name=Sys.Process("EdgeClient").WPFObject("HwndSource: WorkspaceNamePrompt", "Please provide a new Workspace Name").WPFObject("WorkspaceNamePrompt", "Please provide a new Workspace Name", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,15000000)
              If objNewWrkSpace_Name.Exists = True then
                  strTemp="WPFObject(""ChangeNameTextEdit"")"
                  ''Entering Workspace Name
                  Set objNewWrkSpace_Txtbox=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
                    If objNewWrkSpace_Txtbox.Exists = True then
                      objNewWrkSpace_Txtbox.Click
                      objNewWrkSpace_Txtbox.Text=strWrkSpaceName
              '        strTCRemarks=strTCRemarks & Chr(10) & "Entered Workspace Name - " & strWrkSpaceName
                      ''Clicking on Ok Button 
                      strTemp="WPFObject(""OkButton"")"
                      Set objNewWrkSpace_okbtn=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
                      If objNewWrkSpace_okbtn.Exists = True then
                        objNewWrkSpace_okbtn.Click
                        'Delay 5000,"Please wait..."
                      End If
                    End If
                End If
              End if 
    
             Else
              strTCRemarks = strTCRemarks & "<br />" & "Open For Edit (Source) is Disabled in Source"
              log.Message "Open For Edit (Source) is Disabled  in Source"
            end if
          else
            strTCRemarks =  "Open For Edit (Source) is Not found in Source"
          End if
       End if
       Else
        strTCRemarks = strTCRemarks & "<br />" & "New Workspace is not found in Source"
        log.Message "New Workspace is not found  in Source"
      End if 
      
       Delay 15000,"Pls Wait.."
  Call SClosesource()
  Delay 5000,"Pls Wait.."
  Call SClosesource()
  Call SourceWorkSpacevwr()
End Sub
Sub sCheckSourceSchedule_ChecklistValidation(strParameters)

On Error Resume Next

    Dim intRow,strTemp,objTemp,Grid,intI
    Dim objEdge,objCaption,i,objText,j,strWrkSpaceName,strDesc1,strDesc2

    strSource_Name=getSplitValue(strParameters,"SOURCE")
    strLevel2src_Name=getSplitValue(strParameters,"LEVEL2SOURCE")
    strLevel3src_Name=getSplitValue(strParameters,"LEVEL3SOURCE")
    
'    strSource_Name="Test"
'    strLevel2src_Name="Automation"
'    strLevel3src_Name="Test Source 1"

    strDesc1=aqDateTime.Now
    strDesc2=aqDateTime.Now
    strWrkSpaceName=Replace(strDesc1,"/","-")
    strWrkSpaceName=Replace(strWrkSpaceName,":","_")
    
    Call sHome_Source
    ''Setting grid Objects
    strTemp="WPFObject(""SourceTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""SourceTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    
    Delay 10000,"Pls Wait.."
    ''Selecting Country Name
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource_Name) then
          GridControl.Nodes_2.Item(intI).Expand(True)
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description       
    '      strTCRemarks=strTCRemarks & Chr(10) & "Selected Node - " & GridControl.Nodes_2.Item(intI).Content.Description  
          blnFlag=False  
          Exit For
        End If
    Next
    If blnFlag = True then
      strTCRemarks="Country Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
  
    Delay 10000,"Pls Wait.."
    blnFlag = True 
    ''Selecting Level2Source_Name
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
    For intJ=0 to intTotNodeCnt-1
      strTemp=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strLevel2src_Name) then
        GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
        intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
        Call GridControl.ClearSelectionCore
        Call GridControl.FocusViewAndRow(GridControl,intRow)
        GridControl.SetFocusOnCurrentItem
        Call GridControl.SelectRowCore(intRow)
        log.Message "Level2 Source Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
        blnFlag = False 
        Exit For
      End If
    Next
    If blnFlag = True then
      log.Message "Level2 Source Name not found"
      strTCRemarks="Level2 Source Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
    Delay 10000,"Pls Wait.."
    strTemp="WPFObject(""ArrowControl"", """", 1)"
    Set objNewWorkspace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,20,True)
    If objNewWorkspace.Exists = True then
      objNewWorkspace.Click
'      Delay 5000,"Please Wait..."
      strTemp="WPFObject(""BarPopupBorderControl"", """", 1)"
      Set objWrkspace_popup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").FindChild("Name",strTemp,5,True)
      If objWrkspace_popup.Exists = True then
        strTemp="WPFObject(""ContentControlEx"", ""Open For Edit (Source Schedule)"", 2)"
        Set objopenforEdit=objWrkspace_popup.FindChild("Name",strTemp,8,True)
        If objopenforEdit.Exists then
          objopenforEdit.Click    
'          Delay 50000,"Please Wait..."
           strTemp="WPFObject(""FloatingContainerBorder"")"          
           Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: WaitProgressWindow", "Please Wait...").WPFObject("WaitProgressWindow", "Please Wait...", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,50000)
            Do until objTemp.Exists = False 
              If objTemp.Focusable=False then
                Delay 5000,"Pls Wait.."
              End if 
            Loop   
        End If
    End If
    End If
    

    ''Waiting for FloatingContainerBorder
     strTemp="WPFObject(""HwndSource: WorkspaceNamePrompt"", ""Please provide a new Workspace Name"")"
      Set objNewWrkSpace_Name=Sys.Process("EdgeClient").WaitChild(strTemp,5000000)
      If objNewWrkSpace_Name.Exists = True then
        strTemp="WPFObject(""ChangeNameTextEdit"")"
        ''Entering Workspace Name
        Set objNewWrkSpace_Txtbox=objNewWrkSpace_Name.FindChild("Name",strTemp,50,True)
          If objNewWrkSpace_Txtbox.Exists = True then
            objNewWrkSpace_Txtbox.Click
            objNewWrkSpace_Txtbox.Text=strWrkSpaceName
    '        strTCRemarks=strTCRemarks & Chr(10) & "Entered Workspace Name - " & strWrkSpaceName
            ''Clicking on Ok Button 
            strTemp="WPFObject(""OkButton"")"
            Set objNewWrkSpace_okbtn=objNewWrkSpace_Name.FindChild("Name",strTemp,50,True)
            If objNewWrkSpace_okbtn.Exists = True then
              objNewWrkSpace_okbtn.Click
              Delay 5000,"Please wait..."
              strTemp="WPFObject(""PART_ContainerContent"")"
              Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "Warning").WPFObject("CustomMessageBoxWindow", "Warning", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,5000000)
              If objNewWrkSpace_okbtn.Exists = True then
                sys.keys "N"  
                strTCRemarks = strTCRemarks & "<br />" & "Workspace Locked already"                     
              End if
           End If
          End If
      End If
    Call scloselayout()
End Sub


Sub  sCheckSourceOpenEditSourcescheduleRightClick(strParameters)
On Error Resume Next 
   Dim strSource1,StrSource2,strSource3,strTemp,GridControl,GridSourceTree,intTotNodeCnt,intI,intJ,intRow,intK,objEdge
   Dim objNewWorkspace,objWrkspace_popup,objOpenView,strTemp1,objNewWrkSpaceName,objNewWrkSpace_Txtbox,objNewWrkSpace_okbtn,objNewWrkSpace_Name
   Dim strDesc1,strDesc2,DescText,DescLocalText,strWrkSpaceName,intSeriesID
   
    strSource1=getSplitValue(strParameters,"SOURCE")
    StrSource2=getSplitValue(strParameters,"LEVEL2SOURCE")
'
'    strSource1="Test"
'    StrSource2="Automation"

    Call sHome_Source
    
    strDesc1=aqDateTime.Now
    strDesc2=aqDateTime.Now
    DescText=Replace(strDesc1,"/","-")
    DescText=Replace(DescText,":","_")
    DescLocalText=DescText
    strWrkSpaceName=DescText
    intSeriesID=getSplitValue(strParameters,"SERIESID")
    if intSeriesID=0 then
      Call sSourceseries
      intSeriesID=strSourceFileText
    End if 
    
    strTemp="WPFObject(""SourceTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""SourceTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    Delay 10000,"Pls Wait.."
    ''Selecting Country Name
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
          GridControl.Nodes_2.Item(intI).Expand(True)
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description       
          blnFlag=False  
          Exit For
        End If
    Next
    If blnFlag = True then
      strTCRemarks="Country Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
  
    Delay 10000,"Pls Wait.."
        blnFlag = True 
    ''Selecting Level2Source_Name
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
 ''Selecting Level2Source_Name
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
   For intJ=0 to intTotNodeCnt-1
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(StrSource2) then
        'GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
        intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
'        Call GridSourceTree.ClickCell(intRow, "Edit")
        Call GridControl.ClearSelectionCore
        Call GridControl.FocusViewAndRow(GridControl,intRow)
        GridControl.SetFocusOnCurrentItem
        Call GridControl.SelectRowCore(intRow)
        
        Dim PropArray,ValueArray, objTemp, left, Top     
        PropArray = Array("ClrClassName", "DisplayText")
        ValuesArray = Array("EditorControlStub",StrSource2)
        Set objTemp = GridControl.FindChild(PropArray, ValuesArray,18)
  
        If objTemp.Exists = True Then
          left =  objTemp.ActualWidth/2
          Top =  objTemp.ActualHeight/2    
          Call objTemp.ClickR(left, Top, 0)
          Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").Keys("[Down][Right]")
          
        Else
          log.Message "Cannot find the Cell"
        End If
  
        log.Message "Level2 Source Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
        blnFlag = False 
        Exit For
         
      End If
    Next
  
    If blnFlag = True then
      log.Message "Level2 Source Name not found"
      strTCRemarks="Level2 Source Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
    Delay 2000,"Pls Wait.."

     set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "", 2).WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarSubItemLinkControl", "", 1)
      strTemp="WPFObject(""ContentControlEx"", ""New Workspace"", 2)"
      Set objTemp=objEdge.FindChild("Name",strTemp,50)
      If objTemp.Exists=True then
        If objTemp.Enabled=True then
          strTCRemarks = strTCRemarks & "<br />" & "New Workspace is found in Source"
          log.Message "New Workspace is found  in Source"
          objTemp.Click
          set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "", 1).WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 4).WPFObject("BarButtonItemLinkControl", "", 1)
          strTemp="WPFObject(""ContentControlEx"", ""Open For Edit (Source Schedule)"", 2)"
          Set objTemp=objEdge.FindChild("Name",strTemp,50)
          If objTemp.Exists=True then
            If objTemp.Enabled=True then
              strTCRemarks = strTCRemarks & "<br />" & "Open For Edit (Source Schedule) is found in Source"
              log.Message "Open For Edit (Source Schedule) is found  in Source"
              objTemp.Click
              strTemp1="WPFObject(""HwndSource: WorkspaceNamePrompt"", ""Please provide a new Workspace Name"")"
              Set objNewWrkSpaceName=Sys.Process("EdgeClient").WaitChild(strTemp1,50000)
              If objNewWrkSpaceName.Exists = True then
     
              ''Waiting for Workspace Name prompt
              strTemp="WPFObject(""FloatingContainerBorder"")"
              Set objNewWrkSpace_Name=Sys.Process("EdgeClient").WPFObject("HwndSource: WorkspaceNamePrompt", "Please provide a new Workspace Name").WPFObject("WorkspaceNamePrompt", "Please provide a new Workspace Name", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,15000000)
              If objNewWrkSpace_Name.Exists = True then
                  strTemp="WPFObject(""ChangeNameTextEdit"")"
                  ''Entering Workspace Name
                  Set objNewWrkSpace_Txtbox=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
                    If objNewWrkSpace_Txtbox.Exists = True then
                      objNewWrkSpace_Txtbox.Click
                      objNewWrkSpace_Txtbox.Text=strWrkSpaceName
              '        strTCRemarks=strTCRemarks & Chr(10) & "Entered Workspace Name - " & strWrkSpaceName
                      ''Clicking on Ok Button 
                      strTemp="WPFObject(""OkButton"")"
                      Set objNewWrkSpace_okbtn=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
                      If objNewWrkSpace_okbtn.Exists = True then
                        objNewWrkSpace_okbtn.Click
                        'Delay 5000,"Please wait..."
                      End If
                    End If
                End If
              End if 
    
             Else
              strTCRemarks = strTCRemarks & "<br />" & "Open For Edit (Source Schedule) is Disabled in Source"
              log.Message "Open For Edit (Source Schedule) is Disabled  in Source"
            end if
          else
            strTCRemarks =  "Open For Edit (Source Schedule) is Not found in Source"
          End if
       End if
       Else
        strTCRemarks = strTCRemarks & "<br />" & "New Workspace is not found in Source"
        log.Message "New Workspace is not found  in Source"
      End if 
      
      Delay 15000,"Pls Wait.."
      Call SClosesource()
      Delay 5000,"Pls Wait.."
      Call SClosesource()
      Call sCheckSourceScheduleWorkSpacevwr()
End Sub

Sub  sCheckSourceMultipleEditSourceSchedule(strParameters)
On Error Resume Next 
   Dim strSource1,StrSource2,strSource3,strTemp,GridControl,GridSourceTree,intTotNodeCnt,intI,intJ,intRow,intK,objEdge
   Dim objNewWorkspace,objWrkspace_popup,objOpenView,strTemp1,objNewWrkSpaceName,objNewWrkSpace_Txtbox,objNewWrkSpace_okbtn,objNewWrkSpace_Name
   Dim strDesc1,strDesc2,DescText,DescLocalText
   
    strSource1=getSplitValue(strParameters,"SOURCE")
    StrSource2=getSplitValue(strParameters,"LEVEL2SOURCE")

''    strSource1="Test"
''    StrSource2="Automation"

    Call sHome_Source
    

    'strWrkSpaceName="Workspace1"
    strDesc1=aqDateTime.Now
    strDesc2=aqDateTime.Now
    DescText=Replace(strDesc1,"/","-")
    DescText=Replace(DescText,":","_")
    DescLocalText=DescText
    strWrkSpaceName=DescText
    
    
    strTemp="WPFObject(""SourceTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""SourceTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    Delay 10000,"Pls Wait.."
    ''Selecting Country Name
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
          GridControl.Nodes_2.Item(intI).Expand(True)
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description       
          blnFlag=False  
          Exit For
        End If
    Next
    If blnFlag = True then
      strTCRemarks="Country Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
  
     Delay 10000,"Pls Wait.."
      blnFlag = True 
      ''Selecting Level2Source_Name
      intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
      For intJ=0 to intTotNodeCnt-1
        strTemp=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description
        If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strSource2) then
         ' GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
          intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
          Call GridControl.ClearSelectionCore
          Call GridControl.FocusViewAndRow(GridControl,intRow)
          GridControl.SetFocusOnCurrentItem
          Call GridControl.SelectRowCore(intRow)
          delay(1000)
'          GridControl.Keys("[Down]")
'          GridControl.Keys("[Up]")
          log.Message "Level2 Source Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
          blnFlag = False 
          Exit For
        End If
      Next
     If blnFlag = True then
      log.Message "Level2 Source Name not found"
      strTCRemarks="Level2 Source Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
    Delay 2000,"Pls Wait.."
    
    SYS.Keys("![Down]")
    
    Delay 2000,"Pls Wait.."
    strTCRemarks = strTCRemarks & "<br />" & "Selected Two different Countries from Level 1 in Source"
    log.Message "Selected Two different Countries from Level 1 in Source"
    
    strTemp="WPFObject(""ArrowControl"", """", 1)"
    Set objNewWorkspace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,20,True)
    If objNewWorkspace.Exists = True then
      objNewWorkspace.Click
      strTemp="WPFObject(""BarPopupBorderControl"", """", 1)"
      Set objWrkspace_popup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).FindChild("Name",strTemp,5,True)
      If objWrkspace_popup.Exists = True then
        strTemp="WPFObject(""ContentControlEx"", ""Open For Edit (Source Schedule)"", 2)"
        Set objopenforEdit=objWrkspace_popup.FindChild("Name",strTemp,8,True)
        If objopenforEdit.Exists then
          objopenforEdit.Click    
          'Delay 20000,"Please Wait..."
        End If
      End if
      
      strTemp1="WPFObject(""HwndSource: WorkspaceNamePrompt"", ""Please provide a new Workspace Name"")"
      Set objNewWrkSpaceName=Sys.Process("EdgeClient").WaitChild(strTemp1,50000)
      If objNewWrkSpaceName.Exists = True then
     
      ''Waiting for Workspace Name prompt
      strTemp="WPFObject(""FloatingContainerBorder"")"
      Set objNewWrkSpace_Name=Sys.Process("EdgeClient").WPFObject("HwndSource: WorkspaceNamePrompt", "Please provide a new Workspace Name").WPFObject("WorkspaceNamePrompt", "Please provide a new Workspace Name", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,15000000)
      If objNewWrkSpace_Name.Exists = True then
          strTemp="WPFObject(""ChangeNameTextEdit"")"
          ''Entering Workspace Name
            Set objNewWrkSpace_Txtbox=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
            If objNewWrkSpace_Txtbox.Exists = True then
              objNewWrkSpace_Txtbox.Click
              objNewWrkSpace_Txtbox.Text=strWrkSpaceName
      '        strTCRemarks=strTCRemarks & Chr(10) & "Entered Workspace Name - " & strWrkSpaceName
              ''Clicking on Ok Button 
              strTemp="WPFObject(""OkButton"")"
              Set objNewWrkSpace_okbtn=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
              If objNewWrkSpace_okbtn.Exists = True then
                objNewWrkSpace_okbtn.Click
                'Delay 5000,"Please wait..."
              End If
            End If
        End If
      End if 
     End if 
  Delay 15000,"Pls Wait.."
  Call SClosesource()
  Delay 5000,"Pls Wait.."
  Call SClosesource()
  Call sCheckSourceScheduleWorkSpacevwr()
End Sub
Sub  sCheckSourceEditCheck(strParameters)
On Error Resume Next 
   Dim strSource1,StrSource2,strSource3,strTemp,GridControl,GridSourceTree,intTotNodeCnt,intI,intJ,intRow,intK,objEdge
   Dim objNewWorkspace,objWrkspace_popup,objOpenView,strTemp1,objNewWrkSpaceName,objNewWrkSpace_Txtbox,objNewWrkSpace_okbtn,objNewWrkSpace_Name
   Dim strDesc1,strDesc2,DescText,DescLocalText
   
    strSource1=getSplitValue(strParameters,"SOURCE")
    
   ' strSource1="AUSTRALIA"
    
   ' strSource1="Test"

    Call sHome_Source
    

    strWrkSpaceName="Workspace1"
    
    strTemp="WPFObject(""SourceTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""SourceTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    Delay 10000,"Pls Wait.."
    ''Selecting Country Name
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
          intRow=GridControl.Nodes_2.Item(intI).get_RowHandle
          Call GridControl.ClearSelectionCore
          Call GridControl.FocusViewAndRow(GridControl,intRow)
          GridControl.SetFocusOnCurrentItem
          Call GridControl.SelectRowCore(intRow)  
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description     
          blnFlag=False  
          Exit For
        End If
    Next
    If blnFlag = True then
      strTCRemarks="Country Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
     Delay 10000,"Pls Wait.."

   strTemp="WPFObject(""ContentControlEx"", ""New Workspace"", 2)"
    Set objTemp=objEdgeTree.FindChild("Name",strTemp,50)
    if objTemp.Exists=True then
        strTCRemarks = strTCRemarks & "<br />" & "New Workspace Button is found in Source"
        log.Message "New Workspace Button is found in Source"
       if objTemp.Enabled=True then
        strTCRemarks = strTCRemarks & "<br />" & "New Workspace Button is Enabled in Source"
        log.Message "New Workspace Button is Enabled in Source"
        Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarSubItemLinkControl", "", 1).Click
        strTemp="WPFObject(""BarPopupBorderControl"", """", 1)"
        Set objWrkspace_popup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).FindChild("Name",strTemp,5,True)
        strTemp="WPFObject(""ContentControlEx"", ""Open For View (Source)"", 2)"
        Set objTemp=objWrkspace_popup.FindChild("Name",strTemp,50)
        If objTemp.Exists = TRUE then
          if objTemp.Enabled=True then
             strTCRemarks = strTCRemarks & "<br />" & "Open For View (Source) is found in Source"
             log.Message "Open For View (Source) is found in Source"
          else
              strTCRemarks = strTCRemarks & "<br />" & "Open For View (Source) is Disabled in Source"
             log.Message "Open For View (Source) is Disabled in Source"
          end if
        Else
          strTCRemarks = strTCRemarks & "<br />" & "Open For View (Source) is  not found in Source"
         log.Message "Open For View (Source) is not found in Source" 
        End If
  
        strTemp="WPFObject(""BarPopupBorderControl"", """", 1)"
        Set objWrkspace_popup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).FindChild("Name",strTemp,5,True)
        strTemp="WPFObject(""ContentControlEx"", ""Open For Edit (Source)"", 2)"
        Set objTemp=objWrkspace_popup.FindChild("Name",strTemp,50)
        If objTemp.Exists = TRUE then
          if objTemp.Enabled=True then
             strTCRemarks = strTCRemarks & "<br />" & "Open For Edit (Source) is found in Source"
             log.Message "Open For Edit (Source) is found in Source"
          Else
            strTCRemarks = strTCRemarks & "<br />" & "Open For Edit (Source) is Disabled in Source"
            log.Message "Open For Edit (Source) is Disabled in Source"
          End if
        Else
          strTCRemarks = strTCRemarks & "<br />" & "Open For Edit (Source) is not found in Source"
          log.Message "Open For Edit (Source) is not found in Source"  
        End If
  
        strTemp="WPFObject(""BarPopupBorderControl"", """", 1)"
        Set objWrkspace_popup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).FindChild("Name",strTemp,5,True)
        strTemp="WPFObject(""ContentControlEx"", ""Open For View (Source Schedule)"", 2)"
        Set objTemp=objWrkspace_popup.FindChild("Name",strTemp,50)
        If objTemp.Exists = TRUE then
           if objTemp.Enabled=True then
              strTCRemarks = strTCRemarks & "<br />" & "Open For View (Source Schedule) is found in Source"
              log.Message "Open For View (Source Schedule) is found in Source"
           Else
              strTCRemarks = strTCRemarks & "<br />" & "Open For View (Source Schedule) is Disabled in Source"
              log.Message "Open For View (Source Schedule) is Disabled in Source"
           End if
        Else
          strTCRemarks = strTCRemarks & "<br />" & "Open For View (Source Schedule) is not found in Source"
          log.Message "Open For View (Source Schedule) is not found in Source"
        End If
  
        strTemp="WPFObject(""BarPopupBorderControl"", """", 1)"
        Set objWrkspace_popup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).FindChild("Name",strTemp,5,True)
        strTemp="WPFObject(""ContentControlEx"", ""Open For Edit (Source Schedule)"", 2)"
        Set objTemp=objWrkspace_popup.FindChild("Name",strTemp,50)
        If objTemp.Exists = TRUE then
          if objTemp.Enabled=True then
            strTCRemarks = strTCRemarks & "<br />" & "Open For Edit (Source Schedule) is found in Source"
            log.Message "Open For Edit (Source Schedule) is found in Source"
          Else
            strTCRemarks = strTCRemarks & "<br />" & "Open For Edit (Source Schedule) is Disabled in Source"
            log.Message "Open For Edit (Source Schedule) is Disabled in Source"
          End if
        Else
          strTCRemarks = strTCRemarks & "<br />" & "Open For Edit (Source Schedule) is not found in Source"
          log.Message "Open For Edit (Source Schedule) is not found in Source" 
        End If
      else
        strTCRemarks = strTCRemarks & "<br />" & "New Workspace Button is Disabled in Source"
        log.Message "New Workspace Button is Disabled in Source"
      End if 
    Else
      strTCRemarks = strTCRemarks & "<br />" & "New Workspace is not found in Source"
      log.Message "New Workspace Button is not found in Source"
    End if 
End Sub

Sub  sCheckSourceCheckLockedFolders(strParameters)
On Error Resume Next 
   Dim strSource1,StrSource2,strSource3,strTemp,GridControl,GridSourceTree,intTotNodeCnt,intI,intJ,intRow,intK,objEdge
   Dim objNewWorkspace,objWrkspace_popup,objOpenView,strTemp1,objNewWrkSpaceName,objNewWrkSpace_Txtbox,objNewWrkSpace_okbtn,objNewWrkSpace_Name
   Dim strDesc1,strDesc2,DescText,DescLocalText
   
    strSource1=getSplitValue(strParameters,"SOURCE")
    
   ' strSource1="AUSTRALIA"
    
'    strSource1="Test"

    Call sHome_Source
    

    strWrkSpaceName="Workspace1"
    
    strTemp="WPFObject(""SourceTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""SourceTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    Delay 10000,"Pls Wait.."
    ''Selecting Country Name
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
          intRow=GridControl.Nodes_2.Item(intI).get_RowHandle
          Call GridControl.ClearSelectionCore
          Call GridControl.FocusViewAndRow(GridControl,intRow)
          GridControl.SetFocusOnCurrentItem
          Call GridControl.SelectRowCore(intRow)  
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description 
           Dim PropArray,ValueArray, objTemp, left, Top     
        PropArray = Array("ClrClassName")
        ValuesArray = Array("StateIndicatorControl")
        Set objTemp = GridControl.FindChild(PropArray, ValuesArray,98)
        if objTemp.Exists then
          left =Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("SourceTreeControl").WPFObject("SourceTreeListView").WPFObject("HierarchyPanel", "", 1).WPFObject("RowControl", "", 22).WPFObject("CellsControl", "", 1).WPFObject("LightweightCellEditor", "", 1).WPFObject("InplaceBaseEdit", "", 1).WPFObject("EditorControlStub", "", 1).WPFObject("StateIndicatorControl", "", 1).ToolTip.ToString
     
           log.Message "tooltip " & left
               left=objTemp.ToolTip
          log.Message "tooltip " & left.ToString
        End if 
'          Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("SourceTreeControl").WPFObject("SourceTreeListView").WPFObject("HierarchyPanel", "", 1).WPFObject("RowControl", "", 10).WPFObject("CellsControl", "", 1).WPFObject("LightweightCellEditor", "", 1).WPFObject("InplaceBaseEdit", "", 1).WPFObject("EditorControlStub", "", 1).WPFObject("StateIndicatorControl", "", 1)
'          Set objWrkspace_popup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).FindChild("Name",strTemp,5,True)
'          strTemp="WPFObject(""LampRedStatePresentationControl"", """", 1)"
'          Set objTemp=objWrkspace_popup.FindChild("Name",strTemp,50)
'          If objTemp.Exists = TRUE then
'            if objTemp.Enabled=True then
'              strTCRemarks = strTCRemarks & "<br />" & "Open For Edit (Source Schedule) is found in Source"
'              log.Message "Open For Edit (Source Schedule) is found in Source"
'            Else
'              strTCRemarks = strTCRemarks & "<br />" & "Open For Edit (Source Schedule) is Disabled in Source"
'              log.Message "Open For Edit (Source Schedule) is Disabled in Source"
'            End if
'          Else
'            strTCRemarks = strTCRemarks & "<br />" & "Open For Edit (Source Schedule) is not found in Source"
'            log.Message "Open For Edit (Source Schedule) is not found in Source" 
'          End If    
          blnFlag=False  
          Exit For
        End If
    Next
    If blnFlag = True then
      strTCRemarks="Country Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
     Delay 10000,"Pls Wait.."

'   strTemp="WPFObject(""ContentControlEx"", ""New Workspace"", 2)"
'    Set objTemp=objEdgeTree.FindChild("Name",strTemp,50)
'    if objTemp.Exists=True then
'        strTCRemarks = strTCRemarks & "<br />" & "New Workspace Button is found in Source"
'        log.Message "New Workspace Button is found in Source"
'       if objTemp.Enabled=True then
'        strTCRemarks = strTCRemarks & "<br />" & "New Workspace Button is Enabled in Source"
'        log.Message "New Workspace Button is Enabled in Source"
'        Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarSubItemLinkControl", "", 1).Click
'        strTemp="WPFObject(""BarPopupBorderControl"", """", 1)"
'        Set objWrkspace_popup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).FindChild("Name",strTemp,5,True)
'        strTemp="WPFObject(""ContentControlEx"", ""Open For View (Source)"", 2)"
'        Set objTemp=objWrkspace_popup.FindChild("Name",strTemp,50)
'        If objTemp.Exists = TRUE then
'          if objTemp.Enabled=True then
'             strTCRemarks = strTCRemarks & "<br />" & "Open For View (Source) is found in Source"
'             log.Message "Open For View (Source) is found in Source"
'          else
'              strTCRemarks = strTCRemarks & "<br />" & "Open For View (Source) is Disabled in Source"
'             log.Message "Open For View (Source) is Disabled in Source"
'          end if
'        Else
'          strTCRemarks = strTCRemarks & "<br />" & "Open For View (Source) is  not found in Source"
'         log.Message "Open For View (Source) is not found in Source" 
'        End If
'  
'        strTemp="WPFObject(""BarPopupBorderControl"", """", 1)"
'        Set objWrkspace_popup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).FindChild("Name",strTemp,5,True)
'        strTemp="WPFObject(""ContentControlEx"", ""Open For Edit (Source)"", 2)"
'        Set objTemp=objWrkspace_popup.FindChild("Name",strTemp,50)
'        If objTemp.Exists = TRUE then
'          if objTemp.Enabled=True then
'             strTCRemarks = strTCRemarks & "<br />" & "Open For Edit (Source) is found in Source"
'             log.Message "Open For Edit (Source) is found in Source"
'          Else
'            strTCRemarks = strTCRemarks & "<br />" & "Open For Edit (Source) is Disabled in Source"
'            log.Message "Open For Edit (Source) is Disabled in Source"
'          End if
'        Else
'          strTCRemarks = strTCRemarks & "<br />" & "Open For Edit (Source) is not found in Source"
'          log.Message "Open For Edit (Source) is not found in Source"  
'        End If
'  
'        strTemp="WPFObject(""BarPopupBorderControl"", """", 1)"
'        Set objWrkspace_popup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).FindChild("Name",strTemp,5,True)
'        strTemp="WPFObject(""ContentControlEx"", ""Open For View (Source Schedule)"", 2)"
'        Set objTemp=objWrkspace_popup.FindChild("Name",strTemp,50)
'        If objTemp.Exists = TRUE then
'           if objTemp.Enabled=True then
'              strTCRemarks = strTCRemarks & "<br />" & "Open For View (Source Schedule) is found in Source"
'              log.Message "Open For View (Source Schedule) is found in Source"
'           Else
'              strTCRemarks = strTCRemarks & "<br />" & "Open For View (Source Schedule) is Disabled in Source"
'              log.Message "Open For View (Source Schedule) is Disabled in Source"
'           End if
'        Else
'          strTCRemarks = strTCRemarks & "<br />" & "Open For View (Source Schedule) is not found in Source"
'          log.Message "Open For View (Source Schedule) is not found in Source"
'        End If
'  
'        strTemp="WPFObject(""BarPopupBorderControl"", """", 1)"
'        Set objWrkspace_popup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).FindChild("Name",strTemp,5,True)
'        strTemp="WPFObject(""ContentControlEx"", ""Open For Edit (Source Schedule)"", 2)"
'        Set objTemp=objWrkspace_popup.FindChild("Name",strTemp,50)
'        If objTemp.Exists = TRUE then
'          if objTemp.Enabled=True then
'            strTCRemarks = strTCRemarks & "<br />" & "Open For Edit (Source Schedule) is found in Source"
'            log.Message "Open For Edit (Source Schedule) is found in Source"
'          Else
'            strTCRemarks = strTCRemarks & "<br />" & "Open For Edit (Source Schedule) is Disabled in Source"
'            log.Message "Open For Edit (Source Schedule) is Disabled in Source"
'          End if
'        Else
'          strTCRemarks = strTCRemarks & "<br />" & "Open For Edit (Source Schedule) is not found in Source"
'          log.Message "Open For Edit (Source Schedule) is not found in Source" 
'        End If
'      else
'        strTCRemarks = strTCRemarks & "<br />" & "New Workspace Button is Disabled in Source"
'        log.Message "New Workspace Button is Disabled in Source"
'      End if 
'    Else
'      strTCRemarks = strTCRemarks & "<br />" & "New Workspace is not found in Source"
'      log.Message "New Workspace Button is not found in Source"
'    End if 
End Sub

Sub  sCheckSourceOpenEditLock(strParameters)
On Error Resume Next 
   Dim strSource1,StrSource2,strSource3,strTemp,GridControl,GridSourceTree,intTotNodeCnt,intI,intJ,intRow,intK,objEdge
   Dim objNewWorkspace,objWrkspace_popup,objOpenView,strTemp1,objNewWrkSpaceName,objNewWrkSpace_Txtbox,objNewWrkSpace_okbtn,objNewWrkSpace_Name
   Dim strDesc1,strDesc2,DescText,DescLocalText
   
    strSource1=getSplitValue(strParameters,"SOURCE")

'    strSource1="Test"

    Call sHome_Source
    
    strDesc1=aqDateTime.Now
    strDesc2=aqDateTime.Now
    DescText=Replace(strDesc1,"/","-")
    DescText=Replace(DescText,":","_")
    DescLocalText=DescText
    strWrkSpaceName=DescText
    intSeriesID=getSplitValue(strParameters,"SERIESID")
    if intSeriesID=0 then
      Call sSourceseries
      intSeriesID=strSourceFileText
    End if 
    
    strTemp="WPFObject(""SourceTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""SourceTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    Delay 10000,"Pls Wait.."
    ''Selecting Country Name
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
          GridControl.Nodes_2.Item(intI).Expand(True)
          intRow=GridControl.Nodes_2.Item(intI).get_RowHandle
          Call GridControl.ClearSelectionCore
          Call GridControl.FocusViewAndRow(GridControl,intRow)
          Delay 12000,"Pls Wait.."
          GridControl.SetFocusOnCurrentItem
          Call GridControl.SelectRowCore(intRow)
          

          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description       
          blnFlag=False  
          Exit For
        End If
    Next
    If blnFlag = True then
      strTCRemarks="Country Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
  
'    Delay 10000,"Pls Wait.."
'        blnFlag = True 
'    ''Selecting Level2Source_Name
'    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
'  For intJ=0 to intTotNodeCnt-1
'      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(StrSource2) then
'        GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
'        intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
''        Call GridSourceTree.ClickCell(intRow, "Edit")
'        Call GridControl.ClearSelectionCore
'        Call GridControl.FocusViewAndRow(GridControl,intRow)
'        GridControl.SetFocusOnCurrentItem
'        Call GridControl.SelectRowCore(intRow)
'        log.Message "Level2 Source Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
'        blnFlag = False 
'        Exit For
'      End If
'    Next
'    If blnFlag = True then
'      log.Message "Level2 Source Name not found"
'      strTCRemarks="Level2 Source Name not found"
'      strTestCaseResult="FAIL"
'      Exit Sub
'    End If  
Delay 2000,"Pls Wait.."

    strTemp="WPFObject(""ArrowControl"", """", 1)"
    Set objNewWorkspace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,20,True)
    If objNewWorkspace.Exists = True then
      objNewWorkspace.Click
       strTemp="WPFObject(""BarPopupBorderControl"", """", 1)"
      Set objWrkspace_popup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").FindChild("Name",strTemp,5,True)
      If objWrkspace_popup.Exists = True then
        strTemp="WPFObject(""ContentControlEx"", ""Open For Edit (Source)"", 2)"
        Set objopenforEdit=objWrkspace_popup.FindChild("Name",strTemp,8,True)
        If objopenforEdit.Exists then
          objopenforEdit.Click    
          'Delay 20000,"Please Wait..."
        End If
      End if
      
      strTemp1="WPFObject(""HwndSource: WorkspaceNamePrompt"", ""Please provide a new Workspace Name"")"
      Set objNewWrkSpaceName=Sys.Process("EdgeClient").WaitChild(strTemp1,50000)
      If objNewWrkSpaceName.Exists = True then
     
      ''Waiting for Workspace Name prompt
      strTemp="WPFObject(""FloatingContainerBorder"")"
      Set objNewWrkSpace_Name=Sys.Process("EdgeClient").WPFObject("HwndSource: WorkspaceNamePrompt", "Please provide a new Workspace Name").WPFObject("WorkspaceNamePrompt", "Please provide a new Workspace Name", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,15000000)
      If objNewWrkSpace_Name.Exists = True then
          strTemp="WPFObject(""ChangeNameTextEdit"")"
          ''Entering Workspace Name
          Set objNewWrkSpace_Txtbox=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
            If objNewWrkSpace_Txtbox.Exists = True then
              objNewWrkSpace_Txtbox.Click
              objNewWrkSpace_Txtbox.Text=strWrkSpaceName
      '        strTCRemarks=strTCRemarks & Chr(10) & "Entered Workspace Name - " & strWrkSpaceName
              ''Clicking on Ok Button 
              strTemp="WPFObject(""OkButton"")"
              Set objNewWrkSpace_okbtn=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
              If objNewWrkSpace_okbtn.Exists = True then
                objNewWrkSpace_okbtn.Click
                'Delay 5000,"Please wait..."
              End If
              strTemp="WPFObject(""PART_ContainerContent"")"
              Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "Warning").WPFObject("CustomMessageBoxWindow", "Warning", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,50000)
              If objNewWrkSpace_okbtn.Exists = True then
                SYS.Keys "N"
              End If
            End If
        End If
      End if 
     End if 
       Delay 15000,"Pls Wait.."
  Call SClosesource()
  Delay 5000,"Pls Wait.."
  Call SClosesource()
 
End Sub

Sub sCheckSourceLevel3EditSource(strParameters)

On Error Resume Next

    Dim intRow,strTemp,objTemp,Grid,intI,GridControl,GridSourceTree,intTotNodeCnt,intJ,intK
    Dim objEdge,objCaption,i,objText,j,strWrkSpaceName,strDesc1,strDesc2,strSource_Name,strLevel2src_Name,strLevel3src_Name
    dim objNewWorkspace,objWrkspace_popup,objopenforEdit,strTemp1,objNewWrkSpaceName,objNewWrkSpace_Txtbox,objNewWrkSpace_okbtn

    strSource_Name=getSplitValue(strParameters,"SOURCE")
    strLevel2src_Name=getSplitValue(strParameters,"LEVEL2SOURCE")
    strLevel3src_Name=getSplitValue(strParameters,"LEVEL3SOURCE")
    
'    strSource_Name="Test"
'    strLevel2src_Name="Automation"
'    strLevel3layout="Test Source 1"

    strDesc1=aqDateTime.Now
    strDesc2=aqDateTime.Now
    strWrkSpaceName=Replace(strDesc1,"/","-")
    strWrkSpaceName=Replace(strWrkSpaceName,":","_")
    
    Call sHome_Source
    ''Setting grid Objects
    strTemp="WPFObject(""SourceTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""SourceTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    
    Delay 10000,"Pls Wait.."
    ''Selecting Country Name
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource_Name) then
          GridControl.Nodes_2.Item(intI).Expand(True)
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description       
    '      strTCRemarks=strTCRemarks & Chr(10) & "Selected Node - " & GridControl.Nodes_2.Item(intI).Content.Description  
          blnFlag=False  
          Exit For
        End If
    Next
    If blnFlag = True then
      strTCRemarks="Country Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
  
    Delay 10000,"Pls Wait.."
    blnFlag = True 
    ''Selecting Level2Source_Name
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
    For intJ=0 to intTotNodeCnt-1
      strTemp=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strLevel2src_Name) then
        GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
        intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
        Call GridControl.ClearSelectionCore
        Call GridControl.FocusViewAndRow(GridControl,intRow)
        GridControl.SetFocusOnCurrentItem
        Call GridControl.SelectRowCore(intRow)
        log.Message "Level2 Source Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
        blnFlag = False 
        Exit For
      End If
    Next
    If blnFlag = True then
      log.Message "Level2 Source Name not found"
      strTCRemarks="Level2 Source Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
    
     Delay 5000,"Please Wait..."
    blnFlag = True    
    ''Selecting Level3 Layout
      intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count
      For intK=0 to intTotNodeCnt-1
        If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description)=Ucase(strLevel3src_Name) then
          GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Expand(True)
          intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).get_RowHandle
          GridControl.set_FocusedRowHandle(intRow)
          GridControl.set_FocusedRowData(intRow)
          delay(1000)
          GridControl.Keys("[Down]")
          GridControl.Keys("[Up]")
          log.Message "Level3 layout Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description
          blnFlag = False
          Exit For   
        End If 
      Next
      If blnFlag = True then
        strTCRemarks="Level3 Source Name not found"
        strTestCaseResult="FAIL"
        Exit Sub
      End If
      
     Delay 2000,"Pls Wait.."

    strTemp="WPFObject(""ArrowControl"", """", 1)"
    Set objNewWorkspace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,20,True)
    If objNewWorkspace.Exists = True then
      objNewWorkspace.Click
       strTemp="WPFObject(""BarPopupBorderControl"", """", 1)"
      Set objWrkspace_popup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").FindChild("Name",strTemp,5,True)
      If objWrkspace_popup.Exists = True then
        strTemp="WPFObject(""ContentControlEx"", ""Open For Edit (Source)"", 2)"
        Set objopenforEdit=objWrkspace_popup.FindChild("Name",strTemp,8,True)
        If objopenforEdit.Exists then
          objopenforEdit.Click    
          'Delay 20000,"Please Wait..."
        End If
      End if
      
      strTemp1="WPFObject(""HwndSource: WorkspaceNamePrompt"", ""Please provide a new Workspace Name"")"
      Set objNewWrkSpaceName=Sys.Process("EdgeClient").WaitChild(strTemp1,50000)
      If objNewWrkSpaceName.Exists = True then
     
      ''Waiting for Workspace Name prompt
      strTemp="WPFObject(""FloatingContainerBorder"")"
      Set objNewWrkSpace_Name=Sys.Process("EdgeClient").WPFObject("HwndSource: WorkspaceNamePrompt", "Please provide a new Workspace Name").WPFObject("WorkspaceNamePrompt", "Please provide a new Workspace Name", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,15000000)
      If objNewWrkSpace_Name.Exists = True then
          strTemp="WPFObject(""ChangeNameTextEdit"")"
          ''Entering Workspace Name
          Set objNewWrkSpace_Txtbox=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
            If objNewWrkSpace_Txtbox.Exists = True then
              objNewWrkSpace_Txtbox.Click
              objNewWrkSpace_Txtbox.Text=strWrkSpaceName
      '        strTCRemarks=strTCRemarks & Chr(10) & "Entered Workspace Name - " & strWrkSpaceName
              ''Clicking on Ok Button 
              strTemp="WPFObject(""OkButton"")"
              Set objNewWrkSpace_okbtn=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
              If objNewWrkSpace_okbtn.Exists = True then
                objNewWrkSpace_okbtn.Click
                'Delay 5000,"Please wait..."
              End If
'              strTemp="WPFObject(""DXMessageBox"", """", 1)"
'              Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: WindowContentHolder", "New Workspace").WPFObject("WindowContentHolder", "New Workspace", 1).WPFObject("NonLogicalDecorator", "", 1).WPFObject("ThemedManagedContentPresenter", "", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WaitChild(strTemp,50000)
'              If objNewWrkSpace_okbtn.Exists = True then
'                SYS.Keys "[Enter]"
'              End If
            End If
        End If
      End if 
     End if 
       Delay 15000,"Pls Wait.."
  Call SClosesource()
  Delay 5000,"Pls Wait.."
  Call SClosesource()
      
End Sub 
Sub sCheckSourceValidateLevel3EditSource(strParameters)

On Error Resume Next

    Dim intRow,strTemp,objTemp,Grid,intI,GridControl,GridSourceTree,intTotNodeCnt,intJ,intk
    Dim objEdge,objCaption,i,objText,j,strWrkSpaceName,strDesc1,strDesc2,strSource_Name,strLevel2src_Name,strLevel3src_Name
    dim objNewWorkspace,objWrkspace_popup,objopenforEdit,strTemp1,objNewWrkSpaceName,objNewWrkSpace_Txtbox,objNewWrkSpace_okbtn

    strSource_Name=getSplitValue(strParameters,"SOURCE")
    strLevel2src_Name=getSplitValue(strParameters,"LEVEL2SOURCE")
    strLevel3src_Name=getSplitValue(strParameters,"LEVEL3SOURCE")
    
'    strSource_Name="Test"
'    strLevel2src_Name="Automation"
'    strLevel3layout="Test Source 1"

    strDesc1=aqDateTime.Now
    strDesc2=aqDateTime.Now
    strWrkSpaceName=Replace(strDesc1,"/","-")
    strWrkSpaceName=Replace(strWrkSpaceName,":","_")
    
    Call sHome_Source
    ''Setting grid Objects
    strTemp="WPFObject(""SourceTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""SourceTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    
    Delay 10000,"Pls Wait.."
    ''Selecting Country Name
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource_Name) then
          GridControl.Nodes_2.Item(intI).Expand(True)
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description       
    '      strTCRemarks=strTCRemarks & Chr(10) & "Selected Node - " & GridControl.Nodes_2.Item(intI).Content.Description  
          blnFlag=False  
          Exit For
        End If
    Next
    If blnFlag = True then
      strTCRemarks="Country Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
  
    Delay 10000,"Pls Wait.."
    blnFlag = True 
    ''Selecting Level2Source_Name
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
    For intJ=0 to intTotNodeCnt-1
      strTemp=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strLevel2src_Name) then
        GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
        intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
        Call GridControl.ClearSelectionCore
        Call GridControl.FocusViewAndRow(GridControl,intRow)
        GridControl.SetFocusOnCurrentItem
        Call GridControl.SelectRowCore(intRow)
        log.Message "Level2 Source Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
        blnFlag = False 
        Exit For
      End If
    Next
    If blnFlag = True then
      log.Message "Level2 Source Name not found"
      strTCRemarks="Level2 Source Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
    
     Delay 5000,"Please Wait..."
    blnFlag = True    
    ''Selecting Level3 Layout
      intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count
      For intK=0 to intTotNodeCnt-1
        If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description)=Ucase(strLevel3src_Name) then
          GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Expand(True)
          intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).get_RowHandle
          GridControl.set_FocusedRowHandle(intRow)
          GridControl.set_FocusedRowData(intRow)
          delay(1000)
          GridControl.Keys("[Down]")
          GridControl.Keys("[Up]")
          log.Message "Level3 layout Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description
          blnFlag = False
          Exit For   
        End If 
      Next
      If blnFlag = True then
        strTCRemarks="Level3 Source Name not found"
        strTestCaseResult="FAIL"
        Exit Sub
      End If
      
     Delay 2000,"Pls Wait.."

    strTemp="WPFObject(""ArrowControl"", """", 1)"
    Set objNewWorkspace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,20,True)
    If objNewWorkspace.Exists = True then
      objNewWorkspace.Click
       strTemp="WPFObject(""BarPopupBorderControl"", """", 1)"
      Set objWrkspace_popup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").FindChild("Name",strTemp,5,True)
      If objWrkspace_popup.Exists = True then
        strTemp="WPFObject(""ContentControlEx"", ""Open For Edit (Source)"", 2)"
        Set objopenforEdit=objWrkspace_popup.FindChild("Name",strTemp,8,True)
        If objopenforEdit.Exists then
          objopenforEdit.Click    
          'Delay 20000,"Please Wait..."
        End If
      End if
      
      strTemp1="WPFObject(""HwndSource: WorkspaceNamePrompt"", ""Please provide a new Workspace Name"")"
      Set objNewWrkSpaceName=Sys.Process("EdgeClient").WaitChild(strTemp1,50000)
      If objNewWrkSpaceName.Exists = True then
     
      ''Waiting for Workspace Name prompt
      strTemp="WPFObject(""FloatingContainerBorder"")"
      Set objNewWrkSpace_Name=Sys.Process("EdgeClient").WPFObject("HwndSource: WorkspaceNamePrompt", "Please provide a new Workspace Name").WPFObject("WorkspaceNamePrompt", "Please provide a new Workspace Name", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,15000000)
      If objNewWrkSpace_Name.Exists = True then
          strTemp="WPFObject(""ChangeNameTextEdit"")"
          ''Entering Workspace Name
          Set objNewWrkSpace_Txtbox=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
            If objNewWrkSpace_Txtbox.Exists = True then
              objNewWrkSpace_Txtbox.Click
              objNewWrkSpace_Txtbox.Text=strWrkSpaceName
      '        strTCRemarks=strTCRemarks & Chr(10) & "Entered Workspace Name - " & strWrkSpaceName
              ''Clicking on Ok Button 
              strTemp="WPFObject(""OkButton"")"
              Set objNewWrkSpace_okbtn=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
              If objNewWrkSpace_okbtn.Exists = True then
                objNewWrkSpace_okbtn.Click
                'Delay 5000,"Please wait..."
              End If
              strTemp="WPFObject(""PART_ContainerContent"")"
              Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "Warning").WPFObject("CustomMessageBoxWindow", "Warning", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,50000)
              If objNewWrkSpace_okbtn.Exists = True then
                SYS.Keys "N"
              End If
            End If
        End If
      End if 
     End if 
       Delay 15000,"Pls Wait.."
  Call SClosesource()
  Delay 5000,"Pls Wait.."
  Call SClosesource()
      
End Sub 
Sub sCheckSourceLevel2NewSourceButton(strParameters)
On Error Resume Next

    Dim strSource_Name,strLevel2src_Name,objNewWrkSpace_okbtn,objNewWrkSpace_Name,strWrkSpaceName
    Dim objNewWrkSpace_Txtbox,objopenforEdit,objWrkspace_popup
    Dim strTemp,objTemp,intRow,barManager,intTotNodeCnt,Text,strDesc1,strDesc2,intI
    Dim objWrkSpace,objwrkspacepop,objwrkspcUpload,objConfirm,objGridCell,DescLocalText,intSeriesID
    Dim layoutGroup
    Dim strTemp1,objNewWrkSpaceName,objEdgeTree

    strSource_Name=getSplitValue(strParameters,"SOURCE")
    strLevel2src_Name=getSplitValue(strParameters,"LEVEL2SOURCE")
    
'    strSource_Name="Test"
'    strLevel2src_Name="Automation"
    
    Call sHome_Source
    
    strTemp="WPFObject(""SourceTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""SourceTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    Delay 10000,"Pls Wait.."
    ''Selecting Country Name
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource_Name) then
          GridControl.Nodes_2.Item(intI).Expand(True)
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description       
    '      strTCRemarks=strTCRemarks & Chr(10) & "Selected Node - " & GridControl.Nodes_2.Item(intI).Content.Description  
          blnFlag=False  
          Exit For
        End If
    Next
    If blnFlag = True then
      strTCRemarks="Country Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
  
    Delay 10000,"Pls Wait.."
    blnFlag = True 
    ''Selecting Level2Source_Name
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
    For intJ=0 to intTotNodeCnt-1
      strTemp=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strLevel2src_Name) then
       ' GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
        intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
        Call GridControl.ClearSelectionCore
        Call GridControl.FocusViewAndRow(GridControl,intRow)
        GridControl.SetFocusOnCurrentItem
        Call GridControl.SelectRowCore(intRow)
        delay(1000)
        GridControl.Keys("[Down]")
        GridControl.Keys("[Up]")
        log.Message "Level2 Source Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
        blnFlag = False 
        Exit For
      End If
    Next
    If blnFlag = True then
      log.Message "Level2 Source Name not found"
      strTCRemarks="Level2 Source Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
    
     Delay 10000,"Pls Wait.."
    set objEdgeTree= Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 3).WPFObject("BarButtonItemLinkControl", "", 1)
    strTemp="WPFObject(""ContentControlEx"", ""New Source Organization"", 2)"
    Set objTemp=objEdgeTree.FindChild("Name",strTemp,50)
    if objTemp.Exists=True then
      if objTemp.Enabled=True then
        strTCRemarks = strTCRemarks & "<br />" & "New Source Organization Button is Enabled in Source"
        log.Message "New Source Organization Button is Enabled in Source"
      Else
        strTCRemarks = strTCRemarks & "<br />" & "New Source Organization Button is Disabled in Source"
        log.Message "New Source Organization Button is Disabled in Source"
      End if 
    Else
      strTCRemarks = strTCRemarks & "<br />" & "New Source Organization Button is not found in Source"
      log.Message "New Source Organization Button is not found in Source"
    End if 
    

   Call SClosesource()

End Sub
Sub sCheckSourceValidateLevel3EditSourceSchedule(strParameters)

On Error Resume Next

    Dim intRow,strTemp,objTemp,Grid,intI,intJ,intK
    Dim objEdge,objCaption,i,objText,j,strWrkSpaceName,strDesc1,strDesc2,strSource_Name,strLevel2src_Name,strLevel3src_Name

    strSource_Name=getSplitValue(strParameters,"SOURCE")
    strLevel2src_Name=getSplitValue(strParameters,"LEVEL2SOURCE")
    strLevel3src_Name=getSplitValue(strParameters,"LEVEL3SOURCE")
    
'    strSource_Name="Test"
'    strLevel2src_Name="Automation"
'    strLevel3layout="Test Source 1"

    strDesc1=aqDateTime.Now
    strDesc2=aqDateTime.Now
    strWrkSpaceName=Replace(strDesc1,"/","-")
    strWrkSpaceName=Replace(strWrkSpaceName,":","_")
    
    Call sHome_Source
    ''Setting grid Objects
    strTemp="WPFObject(""SourceTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""SourceTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    
    Delay 10000,"Pls Wait.."
    ''Selecting Country Name
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource_Name) then
          GridControl.Nodes_2.Item(intI).Expand(True)
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description       
    '      strTCRemarks=strTCRemarks & Chr(10) & "Selected Node - " & GridControl.Nodes_2.Item(intI).Content.Description  
          blnFlag=False  
          Exit For
        End If
    Next
    If blnFlag = True then
      strTCRemarks="Country Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
  
    Delay 10000,"Pls Wait.."
    blnFlag = True 
    ''Selecting Level2Source_Name
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
    For intJ=0 to intTotNodeCnt-1
      strTemp=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strLevel2src_Name) then
        GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
        intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
        Call GridControl.ClearSelectionCore
        Call GridControl.FocusViewAndRow(GridControl,intRow)
        GridControl.SetFocusOnCurrentItem
        Call GridControl.SelectRowCore(intRow)
        log.Message "Level2 Source Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
        blnFlag = False 
        Exit For
      End If
    Next
    If blnFlag = True then
      log.Message "Level2 Source Name not found"
      strTCRemarks="Level2 Source Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
    
     Delay 10000,"Please Wait..."
    blnFlag = True    
    ''Selecting Level3 Layout
      intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count
      For intK=0 to intTotNodeCnt-1
        If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description)=Ucase(strLevel3src_Name) then
          GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Expand(True)
          intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).get_RowHandle
          GridControl.set_FocusedRowHandle(intRow)
          GridControl.set_FocusedRowData(intRow)
          delay(1000)
          GridControl.Keys("[Down]")
          GridControl.Keys("[Up]")
          log.Message "Level3 layout Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description
          blnFlag = False
          Exit For   
        End If 
      Next
      If blnFlag = True then
        strTCRemarks="Level3 Source Name not found"
        strTestCaseResult="FAIL"
        Exit Sub
      End If
      
     Delay 2000,"Pls Wait.."
    strTemp="WPFObject(""ArrowControl"", """", 1)"
    Set objNewWorkspace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,20,True)
    If objNewWorkspace.Exists = True then
      objNewWorkspace.Click
'      Delay 5000,"Please Wait..."
      strTemp="WPFObject(""BarPopupBorderControl"", """", 1)"
      Set objWrkspace_popup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").FindChild("Name",strTemp,5,True)
      If objWrkspace_popup.Exists = True then
        strTemp="WPFObject(""ContentControlEx"", ""Open For Edit (Source Schedule)"", 2)"
        Set objopenforEdit=objWrkspace_popup.FindChild("Name",strTemp,8,True)
        If objopenforEdit.Exists then
          objopenforEdit.Click    
'          Delay 50000,"Please Wait..."
           strTemp="WPFObject(""FloatingContainerBorder"")"          
           Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: WaitProgressWindow", "Please Wait...").WPFObject("WaitProgressWindow", "Please Wait...", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,50000)
            Do until objTemp.Exists = False 
              If objTemp.Focusable=False then
                Delay 5000,"Pls Wait.."
              End if 
            Loop   
        End If
    End If
    End If
    

    ''Waiting for FloatingContainerBorder
     strTemp="WPFObject(""HwndSource: WorkspaceNamePrompt"", ""Please provide a new Workspace Name"")"
      Set objNewWrkSpace_Name=Sys.Process("EdgeClient").WaitChild(strTemp,5000000)
      If objNewWrkSpace_Name.Exists = True then
        strTemp="WPFObject(""ChangeNameTextEdit"")"
        ''Entering Workspace Name
        Set objNewWrkSpace_Txtbox=objNewWrkSpace_Name.FindChild("Name",strTemp,50,True)
          If objNewWrkSpace_Txtbox.Exists = True then
            objNewWrkSpace_Txtbox.Click
            objNewWrkSpace_Txtbox.Text=strWrkSpaceName
    '        strTCRemarks=strTCRemarks & Chr(10) & "Entered Workspace Name - " & strWrkSpaceName
            ''Clicking on Ok Button 
            strTemp="WPFObject(""OkButton"")"
            Set objNewWrkSpace_okbtn=objNewWrkSpace_Name.FindChild("Name",strTemp,50,True)
            If objNewWrkSpace_okbtn.Exists = True then
              objNewWrkSpace_okbtn.Click
              Delay 5000,"Please wait..."
            End If
          End If
      End If

    Call sCloseSource()
    Call sCloseSource() 
End Sub 
Sub sCheckSourceValidateValidateLevel3EditSourceSchedule(strParameters)

On Error Resume Next

    Dim intRow,strTemp,objTemp,Grid,intI,intJ,intK,GridControl,GridSourceTree
    Dim objEdge,objCaption,i,objText,j,strWrkSpaceName,strDesc1,strDesc2,strSource_Name,strLevel2src_Name,strLevel3src_Name

    strSource_Name=getSplitValue(strParameters,"SOURCE")
    strLevel2src_Name=getSplitValue(strParameters,"LEVEL2SOURCE")
    strLevel3src_Name=getSplitValue(strParameters,"LEVEL3SOURCE")
    
'    strSource_Name="Test"
'    strLevel2src_Name="Automation"
'    strLevel3layout="Test Source 1"

    strDesc1=aqDateTime.Now
    strDesc2=aqDateTime.Now
    strWrkSpaceName=Replace(strDesc1,"/","-")
    strWrkSpaceName=Replace(strWrkSpaceName,":","_")
    
    Call sHome_Source
    ''Setting grid Objects
    strTemp="WPFObject(""SourceTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""SourceTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    
    Delay 10000,"Pls Wait.."
    ''Selecting Country Name
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource_Name) then
          GridControl.Nodes_2.Item(intI).Expand(True)
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description       
    '      strTCRemarks=strTCRemarks & Chr(10) & "Selected Node - " & GridControl.Nodes_2.Item(intI).Content.Description  
          blnFlag=False  
          Exit For
        End If
    Next
    If blnFlag = True then
      strTCRemarks="Country Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
  
    Delay 10000,"Pls Wait.."
    blnFlag = True 
    ''Selecting Level2Source_Name
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
    For intJ=0 to intTotNodeCnt-1
      strTemp=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strLevel2src_Name) then
        GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
        intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
        Call GridControl.ClearSelectionCore
        Call GridControl.FocusViewAndRow(GridControl,intRow)
        GridControl.SetFocusOnCurrentItem
        Call GridControl.SelectRowCore(intRow)
        log.Message "Level2 Source Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
        blnFlag = False 
        Exit For
      End If
    Next
    If blnFlag = True then
      log.Message "Level2 Source Name not found"
      strTCRemarks="Level2 Source Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
    
     Delay 10000,"Please Wait..."
    blnFlag = True    
    ''Selecting Level3 Layout
      intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count
      For intK=0 to intTotNodeCnt-1
        If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description)=Ucase(strLevel3src_Name) then
          GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Expand(True)
          intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).get_RowHandle
          GridControl.set_FocusedRowHandle(intRow)
          GridControl.set_FocusedRowData(intRow)
          delay(1000)
          GridControl.Keys("[Down]")
          GridControl.Keys("[Up]")
          log.Message "Level3 layout Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description
          blnFlag = False
          Exit For   
        End If 
      Next
      If blnFlag = True then
        strTCRemarks="Level3 Source Name not found"
        strTestCaseResult="FAIL"
        Exit Sub
      End If
      
     Delay 2000,"Pls Wait.."
    strTemp="WPFObject(""ArrowControl"", """", 1)"
    Set objNewWorkspace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,20,True)
    If objNewWorkspace.Exists = True then
      objNewWorkspace.Click
'      Delay 5000,"Please Wait..."
      strTemp="WPFObject(""BarPopupBorderControl"", """", 1)"
      Set objWrkspace_popup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").FindChild("Name",strTemp,5,True)
      If objWrkspace_popup.Exists = True then
        strTemp="WPFObject(""ContentControlEx"", ""Open For Edit (Source Schedule)"", 2)"
        Set objopenforEdit=objWrkspace_popup.FindChild("Name",strTemp,8,True)
        If objopenforEdit.Exists then
          objopenforEdit.Click    
'          Delay 50000,"Please Wait..."
           strTemp="WPFObject(""FloatingContainerBorder"")"          
           Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: WaitProgressWindow", "Please Wait...").WPFObject("WaitProgressWindow", "Please Wait...", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,50000)
            Do until objTemp.Exists = False 
              If objTemp.Focusable=False then
                Delay 5000,"Pls Wait.."
              End if 
            Loop   
        End If
    End If
    End If
    

    ''Waiting for FloatingContainerBorder
     strTemp="WPFObject(""HwndSource: WorkspaceNamePrompt"", ""Please provide a new Workspace Name"")"
      Set objNewWrkSpace_Name=Sys.Process("EdgeClient").WaitChild(strTemp,5000000)
      If objNewWrkSpace_Name.Exists = True then
        strTemp="WPFObject(""ChangeNameTextEdit"")"
        ''Entering Workspace Name
        Set objNewWrkSpace_Txtbox=objNewWrkSpace_Name.FindChild("Name",strTemp,50,True)
          If objNewWrkSpace_Txtbox.Exists = True then
            objNewWrkSpace_Txtbox.Click
            objNewWrkSpace_Txtbox.Text=strWrkSpaceName
    '        strTCRemarks=strTCRemarks & Chr(10) & "Entered Workspace Name - " & strWrkSpaceName
            ''Clicking on Ok Button 
            strTemp="WPFObject(""OkButton"")"
            Set objNewWrkSpace_okbtn=objNewWrkSpace_Name.FindChild("Name",strTemp,50,True)
            If objNewWrkSpace_okbtn.Exists = True then
              objNewWrkSpace_okbtn.Click
              Delay 5000,"Please wait..."
              strTemp="WPFObject(""PART_ContainerContent"")"
              Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "Warning").WPFObject("CustomMessageBoxWindow", "Warning", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,50000)
              If objNewWrkSpace_okbtn.Exists = True then
                SYS.Keys "N"
              End If
            End If
          End If
      End If

    Call sCloseSource()
    Call sCloseSource() 
End Sub 

Sub  sCheckSourceRightClickHeader()
On Error Resume Next 
   Dim strSource1,StrSource2,strSource3,strTemp,GridControl,GridSourceTree,intTotNodeCnt,intI,intJ,intRow,intK,objEdge
   Dim objNewWorkspace,objWrkspace_popup,objOpenView,strTemp1,objNewWrkSpaceName,objNewWrkSpace_Txtbox,objNewWrkSpace_okbtn,objNewWrkSpace_Name
   Dim strDesc1,strDesc2,DescText,DescLocalText
      
    Call sHome_Source

    strTemp="WPFObject(""LayoutPanel"", """", 1)"
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
   
    Delay 10000,"Pls Wait.."
''    Call GridControl.ClickR(674, 13)
      Call Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).ClickR(674,13)
      set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1)
      strTemp="WPFObject(""ContentControlEx"", ""Dock"", 2)"
      Set objTemp=objEdge.FindChild("Name",strTemp,50)
      If objTemp.Exists=True then
        If objTemp.Enabled=True then
          strTCRemarks = strTCRemarks & "<br />" & "Dock option is Enabled in Source"
          log.Message "Dock option is Enabled in Source"
         Else
          strTCRemarks = strTCRemarks & "<br />" & "Dock option is Disabled in Source"
          log.Message "Dock option is Disabled in Source"
        end if
      else
        strTCRemarks =  "Dock option is Not found in Source"
      End if   
      
      set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1)
      strTemp="WPFObject(""ContentControlEx"", ""Float"", 2)"
      Set objTemp=objEdge.FindChild("Name",strTemp,50)
      If objTemp.Exists=True then
        If objTemp.Enabled=True then
          strTCRemarks = strTCRemarks & "<br />" & "Float option is Enabled in Source"
          log.Message "Float option is Enabled in Source"
         Else
          strTCRemarks = strTCRemarks & "<br />" & "Float option is Disabled in Source"
          log.Message "Float option is Disabled in Source"
        end if
      else
        strTCRemarks =  "Float option is Not found in Source"
      End if
      
      set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1)
      strTemp="WPFObject(""ContentControlEx"", ""Auto Hide"", 2)"
      Set objTemp=objEdge.FindChild("Name",strTemp,50)
      If objTemp.Exists=True then
        If objTemp.Enabled=True then
          strTCRemarks = strTCRemarks & "<br />" & "Auto Hide option is Enabled in Source"
          log.Message "Auto Hide option is Enabled in Source"
         Else
          strTCRemarks = strTCRemarks & "<br />" & "Auto Hide option is Disabled in Source"
          log.Message "Auto Hide option is Disabled in Source"
        end if
      else
        strTCRemarks =  "Auto Hide option is Not found in Source"
      End if
      
      set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1)
      strTemp="WPFObject(""ContentControlEx"", ""Close"", 2)"
      Set objTemp=objEdge.FindChild("Name",strTemp,50)
      If objTemp.Exists=True then
        If objTemp.Enabled=True then
          strTCRemarks = strTCRemarks & "<br />" & "Close option is Enabled in Source"
          log.Message "Close option is Enabled in Source"
         Else
          strTCRemarks = strTCRemarks & "<br />" & "Close option is Disabled in Source"
          log.Message "Close option is Disabled in Source"
        end if
      else
        strTCRemarks =  "Close option is Not found in Source"
      End if
End Sub

Sub sCheckSourceFloat()
Dim objEdge,strTemp,objText,i,objCaption,j
   Call sHome_Source
  set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1)
  strTemp="WPFObject(""LayoutPanel"", """", 1)"
  Set objTemp=objEdge.FindChild("Name",strTemp,5)
  Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1)
  IF objTemp.Exists = True then 
    IF objTemp.Caption="Source" then
      objTemp.Click
      Call objTemp.ClickR(674,13)
      Delay 2000,"Pls Wait.."
      sys.Keys "[Down][Enter]"
      Delay 5000,"Pls Wait.."
      strTCRemarks="Source window is able to Float" 
      log.Message "Source window is able to Float" 
      Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: FloatingPaneWindow", "").WPFObject("FloatingPaneWindow", "", 1).WPFObject("NonLogicalDecorator", "", 1).WPFObject("FloatingContentPresenter", "", 1).WPFObject("PART_FormBorderControl").WPFObject("LayoutPanel", "", 1)
      Call objTemp.ClickR(99, 18)
      Delay 2000,"Pls Wait.."
      sys.Keys "[Down][Down][Enter]"
      strTCRemarks=strTCRemarks & "<br />" & "Source window is able to Auto Hide" 
      log.Message "Source window is able to Auto Hide" 
      Delay 5000,"Pls Wait.."
      
       Call sAutoHideGroupName("Source")
       Set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager")       
        objText = objEdge.FindAllChildren("ClrClassName","AutoHideGroup", 10,True)
        For i=0 to ubound(objText)
          log.Message objText(i).FullName
          log.Message objText(i).Name
          objCaption = objText(i).FindAllChildren("ClrClassName", "AutoHidePaneHeaderItem",10,True)
          For j=0 to ubound(objCaption)
            log.Message objCaption(j).FullName
            log.Message objCaption(j).Name
            if objCaption(j).Content.Caption = "Source" then 
                  log.Message objCaption(j).FullName
                  objCaption(j).ClickR
                  Delay 2000,"Pls Wait.."
                  sys.Keys "[Down][Down][Down][Enter]"
                  Delay 5000,"Pls Wait.."
                  Exit For 
              End if 
          Next
        Next    
      strTCRemarks = strTCRemarks & "<br />" & "Closed the Window Successfully"
      log.Message "Source window is Closed successfully" 
    End IF 
  End If   

End Sub

Sub sCheckSourceAutoHide()
Dim objEdge,strTemp,objText,i,objCaption,j
   Call sHome_Source
  set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1)
  strTemp="WPFObject(""LayoutPanel"", """", 1)"
  Set objTemp=objEdge.FindChild("Name",strTemp,5)
  Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1)
  IF objTemp.Exists = True then 
    IF objTemp.Caption="Source" then
      objTemp.Click
      Call objTemp.ClickR(674,13)
      Delay 2000,"Pls Wait.."
      sys.Keys "[Down][Down][Enter]"
      strTCRemarks=strTCRemarks & "<br />" & "Source window is able to Auto Hide" 
      log.Message "Source window is able to Auto Hide" 
      Delay 5000,"Pls Wait.."
      
       Call sAutoHideGroupName("Source")
       Set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager")       
        objText = objEdge.FindAllChildren("ClrClassName","AutoHideGroup", 10,True)
        For i=0 to ubound(objText)
          log.Message objText(i).FullName
          log.Message objText(i).Name
          objCaption = objText(i).FindAllChildren("ClrClassName", "AutoHidePaneHeaderItem",10,True)
          For j=0 to ubound(objCaption)
            log.Message objCaption(j).FullName
            log.Message objCaption(j).Name
            if objCaption(j).Content.Caption = "Source" then 
                  log.Message objCaption(j).FullName
                  objCaption(j).ClickR
                  Delay 2000,"Pls Wait.."
                  sys.Keys "[Down][Down][Down][Enter]"
                  Delay 5000,"Pls Wait.."
                  Exit For 
              End if 
          Next
        Next    
      strTCRemarks = strTCRemarks & "<br />" & "Closed the Window Successfully"
      log.Message "Source window is Closed successfully" 
    End IF 
  End If   

End Sub

Sub sCheckSourceClose()
Dim objEdge,strTemp,objText,i,objCaption,j
   Call sHome_Source
  set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1)
  strTemp="WPFObject(""LayoutPanel"", """", 1)"
  Set objTemp=objEdge.FindChild("Name",strTemp,5)
  Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1)
  IF objTemp.Exists = True then 
    IF objTemp.Caption="Source" then
      objTemp.Click
      Call objTemp.ClickR(674,13)
      Delay 2000,"Pls Wait.."
      sys.Keys "[Down][Down][Down][Enter]"
      Delay 5000,"Pls Wait.."
      strTCRemarks = strTCRemarks & "<br />" & "Closed the Window Successfully"
      log.Message "Source window is Closed successfully" 
    End IF 
  End If   

End Sub

Sub sCheckSourceLevel1MultipleSource(strParameters)

On Error Resume Next

    Dim intRow,strTemp,objTemp,Grid,intI,GridControl,GridSourceTree,intTotNodeCnt,objNewWorkspace,objWrkspace_popup,objopenforEdit
    Dim objEdge,objCaption,i,objText,j,strWrkSpaceName,strDesc1,strDesc2,DescText,strSource_Name
    Dim objNewWrkSpaceName,strTemp1,objNewWrkSpace_Name,objNewWrkSpace_Txtbox,objNewWrkSpace_okbtn

    strSource_Name=getSplitValue(strParameters,"SOURCE")
    
'    strSource_Name="China"

    strDesc1=aqDateTime.Now
    strDesc2=aqDateTime.Now
    DescText=Replace(strDesc1,"/","-")
    DescText=Replace(DescText,":","_")
    DescLocalText=DescText
    strWrkSpaceName=DescText
  
    Call sHome_Source
    ''Setting grid Objects
    strTemp="WPFObject(""SourceTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""SourceTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    
    Delay 10000,"Pls Wait.."
    ''Selecting Country Name
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource_Name) then
          'GridControl.Nodes_2.Item(intI).Expand(True)
          intRow=GridControl.Nodes_2.Item(intI).get_RowHandle
          Call GridControl.ClearSelectionCore
          Call GridControl.FocusViewAndRow(GridControl,intRow)
          GridControl.SetFocusOnCurrentItem
          Call GridControl.SelectRowCore(intRow)
          delay(1000)
          GridControl.Keys("[Down]")
          GridControl.Keys("[Up]")
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description         
          blnFlag=False  
          Exit For
        End If
    Next
    If blnFlag = True then
      strTCRemarks="Country Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
  
    
      SYS.Keys("![Down]")
      Delay 2000,"Pls Wait.."

    strTemp="WPFObject(""ArrowControl"", """", 1)"
    Set objNewWorkspace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,20,True)
    If objNewWorkspace.Exists = True then
      objNewWorkspace.Click
       strTemp="WPFObject(""BarPopupBorderControl"", """", 1)"
      Set objWrkspace_popup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").FindChild("Name",strTemp,5,True)
      If objWrkspace_popup.Exists = True then
        strTemp="WPFObject(""ContentControlEx"", ""Open For Edit (Source)"", 2)"
        Set objopenforEdit=objWrkspace_popup.FindChild("Name",strTemp,8,True)
        If objopenforEdit.Exists then
          objopenforEdit.Click    
          'Delay 20000,"Please Wait..."
        End If
      End if
      
       strTemp="WPFObject(""ArrowControl"", """", 1)"
        Set objNewWorkspace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,20,True)
        If objNewWorkspace.Exists = True then
          objNewWorkspace.Click
          strTemp="WPFObject(""BarPopupBorderControl"", """", 1)"
          Set objWrkspace_popup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").FindChild("Name",strTemp,5,True)
          If objWrkspace_popup.Exists = True then
            strTemp="WPFObject(""ContentControlEx"", ""Open For Edit (Source)"", 2)"
            Set objopenforEdit=objWrkspace_popup.FindChild("Name",strTemp,8,True)
            If objopenforEdit.Exists then
              objopenforEdit.Click    
             ' Delay 12000,"Please Wait..."
            End If
          End If
             
          strTemp1="WPFObject(""HwndSource: WorkspaceNamePrompt"", ""Please provide a new Workspace Name"")"
          Set objNewWrkSpaceName=Sys.Process("EdgeClient").WaitChild(strTemp1,50000)
          If objNewWrkSpaceName.Exists = True then
   
            ''Waiting for Workspace Name prompt
            strTemp="WPFObject(""FloatingContainerBorder"")"
            Set objNewWrkSpace_Name=Sys.Process("EdgeClient").WPFObject("HwndSource: WorkspaceNamePrompt", "Please provide a new Workspace Name").WPFObject("WorkspaceNamePrompt", "Please provide a new Workspace Name", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,900000)
            If objNewWrkSpace_Name.Exists = True then
              strTemp="WPFObject(""ChangeNameTextEdit"")"
              ''Entering Workspace Name
              Set objNewWrkSpace_Txtbox=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
                If objNewWrkSpace_Txtbox.Exists = True then
                  objNewWrkSpace_Txtbox.Click
                  objNewWrkSpace_Txtbox.Text=strWrkSpaceName
                  ''Clicking on Ok Button 
                  strTemp="WPFObject(""OkButton"")"
                  Set objNewWrkSpace_okbtn=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
                  If objNewWrkSpace_okbtn.Exists = True then
                    objNewWrkSpace_okbtn.Click
                     Call sEdgeProcessor
                   ' Delay 5000,"Please wait..."
                  End If
                End If
            End If
          End if
      End If
  End if
   ''Handling Validation for Source
    strTemp="WPFObject(""HwndSource: WindowContentHolder"", """")"
    Set objTemp=Sys.Process("EdgeClient").WaitChild(strTemp,10000)
    If objTemp.Exists = True then
      objTemp.Keys "[Enter]"
      strTestCaseResult = "FAIL"
      Exit Sub
    End If

    ''WorkSpace Edit Window
    strTemp="WPFObject(""LayoutPanel"", """", 2)"
    Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,13,True)
    If objTemp.Exists then
        Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WPFObject("SourceTreeListView")
        Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl")

        ''Expanding First Node in Tree      
        intTotNodeCnt=GridControl.Nodes_2.Count  
        For intI=0 to intTotNodeCnt-1         
          If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource_Name) then
            GridControl.Nodes_2.Item(intI).Expand(True)
            blnFlag=False  
            Exit For
          End If
        Next
    End if     
    Call sCloseSource()
    Call sCloseSource()
    Call SourceWorkSpacevwr() 
End Sub 

Sub sOpenExcel
  Dim Excel, RowCount, ColumnCount, i, j, s,strTest

  strTest=aqEnvironment.GetEnvironmentVariable("USERPROFILE") & "\Documents\EDGE Automation\EDGE\Source.xlsx"
  Set Excel = Sys.OleObject("Excel.Application")
  Excel.Workbooks.Open(strTest)
      
End Sub

Sub sCheckSourceLevel1FieldsExcel()

On Error Resume Next

    Dim intRow,strTemp,objTemp,Grid,intI,intJ,GridControl,GridSourceTree,intTotNodeCnt,objNewWorkspace,objWrkspace_popup,objopenforEdit
    Dim objEdge,objCaption,i,objText,j,strWrkSpaceName,strDesc1,strDesc2,DescText,strSource_Name
    Dim objNewWrkSpaceName,strTemp1,objNewWrkSpace_Name,objNewWrkSpace_Txtbox,objNewWrkSpace_okbtn
    Dim Excel, RowCount, ColumnCount,s,strTest
'    strSource_Name=getSplitValue(strParameters,"SOURCE")
    
    strSource_Name="Test"

    strDesc1=aqDateTime.Now
    strDesc2=aqDateTime.Now
    DescText=Replace(strDesc1,"/","-")
    DescText=Replace(DescText,":","_")
    DescLocalText=DescText
    strWrkSpaceName=DescText
  
    Call sHome_Source
    ''Setting grid Objects
    strTemp="WPFObject(""SourceTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""SourceTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    
    Delay 10000,"Pls Wait.."
    ''Selecting Country Name
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource_Name) then
          GridControl.Nodes_2.Item(intI).Expand(True)
          intRow=GridControl.Nodes_2.Item(intI).get_RowHandle
          Call GridControl.ClearSelectionCore
          Call GridControl.FocusViewAndRow(GridControl,intRow)
          GridControl.SetFocusOnCurrentItem
          Call GridControl.SelectRowCore(intRow)
          delay(1000)
          GridControl.Keys("[Down]")
          GridControl.Keys("[Up]")
          'log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description         
          blnFlag=False  
          Exit For
        End If
    Next
    If blnFlag = True then
      strTCRemarks="Country Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
    
    Delay 10000,"Pls Wait.."
    blnFlag = True 
    ''Selecting Level2Source_Name
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
    For intJ=0 to intTotNodeCnt-1
      strTemp=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.URL
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.URL)<>"" then
        GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
        intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
        Call GridControl.ClearSelectionCore
        Call GridControl.FocusViewAndRow(GridControl,intRow)
        GridControl.SetFocusOnCurrentItem
        Call GridControl.SelectRowCore(intRow)
        Dim strDesc,strDescLocal,strSourceAbb,strEdit,strScheduleEdit,strSourceTreeLevel,strSourceType,strSourceNature,strSourceIsOfficial
        Dim strSourceURL,strSourceMacroCapFlag,strSourceVersion,strSourceRemarks,strSourceLastUpdatedTime,strSourceLastUpdatedUserID,strSourceDisplayOrder,strSourceSystemID
        strDesc=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
        strDescLocal=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.DescriptionLocal
        strSourceAbb=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.SourceAbbr
        strEdit=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Edit
        strScheduleEdit=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.ScheduleEdit
        strSourceTreeLevel=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.TreeLevel 
        strSourceType=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.SourceType 
        strSourceNature=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.SourceNature
        strSourceIsOfficial=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.IsOfficial
        strSourceURL=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.URL
        strSourceMacroCapFlag=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.MacroCapFlag
        strSourceMacroPath=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.MacroPath
        strSourceVersion=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Version
        strSourceRemarks=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Remarks
        strSourceLastUpdatedTime=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.LastUpdatedTime
        strSourceLastUpdatedUserID=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.LastUpdatedUserID
        strSourceDisplayOrder=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.DisplayOrder
        strSourceSystemID=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.SystemID
        
        
        log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
        log.Message "edit - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Edit
        log.Message "DescriptionLocal - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.DescriptionLocal
        log.Message "SourceAbbr - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.SourceAbbr
        log.Message "Source Nature - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.SourceNature
        log.Message "Tree Level - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.TreeLevel  
        log.Message "Schedule Edit - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.ScheduleEdit
        log.Message "Level2 URL - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.URL 
        log.Message "Level2 MacroCapFlag - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.MacroCapFlag 
        log.Message "Level2 Macro path - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.MacroPath 
        log.Message "Level2 Version - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Version 
        log.Message "Level2 Remarks - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Remarks
        log.Message "Level2 Last Update Time - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.LastUpdatedTime
        log.Message "Level2 Last Update UserID - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.LastUpdatedUserID
        log.Message "Level2 Display Order - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.DisplayOrder
        log.Message "Level2 System ID - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.SystemID
        Sys.Keys("^c") 
        
        

        strTest=aqEnvironment.GetEnvironmentVariable("USERPROFILE") & "\Documents\EDGE Automation\EDGE\Source.xlsx"
        Set Excel = Sys.OleObject("Excel.Application")
        Excel.Workbooks.Open(strTest)
        Delay(10000)
        'Excel.Worksheets(1).Select 
'        Excel.Worksheets("Sheet1").Activate
'        Worksheets("Sheet1").Cells.Select
'        Worksheets("Sheet1").Paste

'      Excel.Worksheets(1).Cells.Select
        Excel.Worksheets(1).Range("A1").Activate
        Excel.ActiveSheet.Paste
   
'        strTemp="Window(""#32770"", ""Microsoft Excel"", 1)"
'        Set File=Sys.Process("EXCEL",2).WaitChild(strTemp,40000)
'        If File.Exists Then
'          File.Window("Button", "OK", 1).Click
'        End If
        blnFlag = False 
        Exit For
      End If
    Next
    If blnFlag = True then
      log.Message "Level2 Source Name not found"
      strTCRemarks="Level2 Source Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
  End Sub
  
  Sub sCheckSourceLevel1EditCheckbox()

On Error Resume Next

    Dim intRow,strTemp,objTemp,Grid,intI,intJ,GridControl,GridSourceTree,intTotNodeCnt,objNewWorkspace,objWrkspace_popup,objopenforEdit
    Dim objEdge,objCaption,i,objText,j,strWrkSpaceName,strDesc1,strDesc2,DescText,strSource_Name
    Dim objNewWrkSpaceName,strTemp1,objNewWrkSpace_Name,objNewWrkSpace_Txtbox,objNewWrkSpace_okbtn
    Dim Excel, RowCount, ColumnCount,s,strTest
'    strSource_Name=getSplitValue(strParameters,"SOURCE")
    
    strSource_Name="Australia"

    strDesc1=aqDateTime.Now
    strDesc2=aqDateTime.Now
    DescText=Replace(strDesc1,"/","-")
    DescText=Replace(DescText,":","_")
    DescLocalText=DescText
    strWrkSpaceName=DescText
  
    Call sHome_Source
    ''Setting grid Objects
    strTemp="WPFObject(""SourceTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""SourceTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    
    Delay 10000,"Pls Wait.."
    ''Selecting Country Name
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource_Name) then
          GridControl.Nodes_2.Item(intI).Expand(True)
          intRow=GridControl.Nodes_2.Item(intI).get_RowHandle
          Call GridControl.ClearSelectionCore
          Call GridControl.FocusViewAndRow(GridControl,intRow)
          GridControl.SetFocusOnCurrentItem
          Call GridControl.SelectRowCore(intRow)
          delay(1000)
      '          GridControl.Keys("[Down]")
'          GridControl.Keys("[Up]")
'          If Ucase(GridControl.Nodes_2.Item(intI).Content.Edit)="Checked"
'          End if 
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description  
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Edit 
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.DescriptionLocal
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.SourceAbbr
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.SourceNature
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.TreeLevel  
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.ScheduleEdit      
          blnFlag=False  
          Exit For
        End If
    Next
    If blnFlag = True then
      strTCRemarks="Country Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
    
    
  End Sub
  
  
Sub sSourceMacroCapFlag(strParameters)
On Error Resume Next 
   Dim strSource1,StrSource2,strSource3,strTemp,GridControl,GridSourceTree,intTotNodeCnt,intI,intJ,intRow,intK,objEdge
   Dim objNewWorkspace,objWrkspace_popup,objOpenView,strTemp1,objNewWrkSpaceName,objNewWrkSpace_Txtbox,objNewWrkSpace_okbtn,objNewWrkSpace_Name
   Dim strDesc1,strDesc2,DescText,DescLocalText,strMacroName,strDT
   
    strSource1=getSplitValue(strParameters,"SOURCE")
    StrSource2=getSplitValue(strParameters,"LEVEL2SOURCE")
    StrSource3=getSplitValue(strParameters,"LEVEL3SOURCE")

'    strSource1="Test"
'    StrSource2="Automation_UIT4"
'    StrSource3="Test 1"
    
    Call sHome_Source
    
    strDesc1=aqDateTime.Now
    strDesc2=aqDateTime.Now
    DescText=Replace(strDesc1,"/","-")
    DescText=Replace(DescText,":","_")
    DescLocalText=DescText
    strWrkSpaceName=DescText
    strDT=DescText
    strDT=Replace(strDT,"_","")
    strDT=Replace(strDT,"-","")
    strDT=Replace(strDT," ","")
    strMacroName=strDT
'      intSeriesID=getSplitValue(strParameters,"SERIESID")
'      if intSeriesID=0 then
'        Call sSourceseries
'        intSeriesID=strSourceFileText
'      End if 
'    
    strTemp="WPFObject(""SourceTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""SourceTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    Delay 10000,"Pls Wait.."
    ''Selecting Country Name
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
          GridControl.Nodes_2.Item(intI).Expand(True)
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description       
          blnFlag=False  
          Exit For
        End If
    Next
    If blnFlag = True then
      strTCRemarks="Country Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
  
    Delay 10000,"Pls Wait.."
        blnFlag = True 
    ''Selecting Level2Source_Name
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
  For intJ=0 to intTotNodeCnt-1
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(StrSource2) then
        GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
        intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
'        Call GridSourceTree.ClickCell(intRow, "Edit")
        Call GridControl.ClearSelectionCore
        Call GridControl.FocusViewAndRow(GridControl,intRow)
        GridControl.SetFocusOnCurrentItem
        Call GridControl.SelectRowCore(intRow)
        log.Message "Level2 Source Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
        blnFlag = False 
        Exit For
      End If
    Next
    If blnFlag = True then
      log.Message "Level2 Source Name not found"
      strTCRemarks="Level2 Source Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
    Delay 2000,"Pls Wait.."

    strTemp="WPFObject(""ArrowControl"", """", 1)"
    Set objNewWorkspace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,20,True)
    If objNewWorkspace.Exists = True then
      objNewWorkspace.Click
       strTemp="WPFObject(""BarPopupBorderControl"", """", 1)"
      Set objWrkspace_popup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").FindChild("Name",strTemp,5,True)
      If objWrkspace_popup.Exists = True then
        strTemp="WPFObject(""ContentControlEx"", ""Open For Edit (Source)"", 2)"
        Set objopenforEdit=objWrkspace_popup.FindChild("Name",strTemp,8,True)
        If objopenforEdit.Exists then
          objopenforEdit.Click    
          'Delay 20000,"Please Wait..."
        End If
      End if
      
      strTemp1="WPFObject(""HwndSource: WorkspaceNamePrompt"", ""Please provide a new Workspace Name"")"
      Set objNewWrkSpaceName=Sys.Process("EdgeClient").WaitChild(strTemp1,50000)
      If objNewWrkSpaceName.Exists = True then
     
      ''Waiting for Workspace Name prompt
      strTemp="WPFObject(""FloatingContainerBorder"")"
      Set objNewWrkSpace_Name=Sys.Process("EdgeClient").WPFObject("HwndSource: WorkspaceNamePrompt", "Please provide a new Workspace Name").WPFObject("WorkspaceNamePrompt", "Please provide a new Workspace Name", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,15000000)
      If objNewWrkSpace_Name.Exists = True then
          strTemp="WPFObject(""ChangeNameTextEdit"")"
          ''Entering Workspace Name
          Set objNewWrkSpace_Txtbox=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
            If objNewWrkSpace_Txtbox.Exists = True then
              objNewWrkSpace_Txtbox.Click
              objNewWrkSpace_Txtbox.Text=strWrkSpaceName
      '        strTCRemarks=strTCRemarks & Chr(10) & "Entered Workspace Name - " & strWrkSpaceName
              ''Clicking on Ok Button 
              strTemp="WPFObject(""OkButton"")"
              Set objNewWrkSpace_okbtn=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
              If objNewWrkSpace_okbtn.Exists = True then
                objNewWrkSpace_okbtn.Click
                'Delay 5000,"Please wait..."
              End If
            End If
        End If
      End if 
     End if 
     
       ''Handling Validation for Source
    strTemp="WPFObject(""HwndSource: WindowContentHolder"", """")"
    Set objTemp=Sys.Process("EdgeClient").WaitChild(strTemp,10000)
    If objTemp.Exists = True then
      objTemp.Keys "[Enter]"
      strTestCaseResult = "FAIL"
      Exit Sub
    End If

    ''WorkSpace Edit Window
    strTemp="WPFObject(""LayoutPanel"", """", 2)"
    Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,13,True)
    If objTemp.Exists then
        Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WPFObject("SourceTreeListView")
        Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl")
     Delay 10000,"Pls Wait.."
        ''Expanding First Node in Tree      
        intTotNodeCnt=GridControl.Nodes_2.Count  
        For intI=0 to intTotNodeCnt-1         
          If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
            GridControl.Nodes_2.Item(intI).Expand(True)
            blnFlag=False  
            Exit For
          End If
        Next
     Delay 10000,"Pls Wait.."
        ''Expanding Second Node in Tree
        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
        For intJ=0 to intTotNodeCnt-1
          If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(StrSource2) then
            GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
            intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(0).get_RowHandle
            GridControl.Keys "^[Home]"
'            Set objGridCell=GridControl.WPFObject("HierarchyPanel", "", 1).WPFObject("GridRow", "", intRow).WPFObject("ScrollablePart").WPFObject("CellItemsControl", "", 1).WPFObject("GridCellContentPresenter", "", 1).WPFObject("TextEdit", "", 1)
            Call GridControl.ClearSelectionCore
            Call GridControl.FocusViewAndRow(GridControl,intRow-1)
            GridControl.SetFocusOnCurrentItem
            Call GridControl.SelectRowCore(intRow-1)
        
            If objGridCell.Exists = True then
              objGridCell.Click
    '          strTCRemarks=strTCRemarks & Chr(10) & "Selected - " & strLevel2src_Name
            End If
            blnFlag = False 
            Exit For
          End If
        Next
         Delay 10000,"Pls Wait.."
        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count
        For intk=0 to intTotNodeCnt-1
          If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description)=Ucase(StrSource3) then
            GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intk).Content.MacroCapFlag=strMacroName
            GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intk).Content.MacroCapFlag
            log.Message "Level3 layout Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description

            intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intk).get_RowHandle
            Call GridControl.ClearSelectionCore
            Call GridControl.FocusViewAndRow(GridControl,intRow)
            GridControl.SetFocusOnCurrentItem
            Call GridControl.SelectRowCore(intRow)
            SYS.Keys("[Right][Right][Right][Right][Right][Right][Right][Right][Enter]")
            SYS.Keys("^[End]23")
            Delay 10000,"Pls Wait.."
            Sys.Keys("[Down]")
             Delay 10000,"Pls Wait.."
            strTemp="WPFObject(""PART_ContainerContent"")"
            Set objConfirm= Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "Confirm").WPFObject("CustomMessageBoxWindow", "Confirm", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).FindChild("Name",strTemp,9,True)
            If objConfirm.Exists = True Then
                objConfirm.Click
                SYS.Keys "[Enter]"
            End If
            Call sEdgeProcessor
            strTemp="WPFObject(""PART_ContainerContent"")"
            Set objConfirm=Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "Confirm").WPFObject("CustomMessageBoxWindow", "Confirm", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).FindChild("Name",strTemp,9,True)
            If objConfirm.Exists = True Then
                objConfirm.Click
                SYS.Keys "[Enter]"
            End If
            Call sEdgeProcessor
            GridControl.Keys "^[Home]"
'            Set objGridCell=GridControl.WPFObject("HierarchyPanel", "", 1).WPFObject("GridRow", "", intRow).WPFObject("ScrollablePart").WPFObject("CellItemsControl", "", 1).WPFObject("GridCellContentPresenter", "", 1).WPFObject("TextEdit", "", 1)
            Call GridControl.ClearSelectionCore
            Call GridControl.FocusViewAndRow(GridControl,intRow-1)
            GridControl.SetFocusOnCurrentItem
            Call GridControl.SelectRowCore(intRow-1)
            blnFlag = False 
            Exit For
          End If
        Next
    End if 
    
  Delay 15000,"Pls Wait.."
  Call SClosesource()
  
   strTemp="WPFObject(""ContentControlEx"" ""Workspace"", 2)"
    'Set objWrkSpace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 11).WPFObject("BarSubItemLinkControl", "", 1).WPFObject("ContentControlEx", "Workspace", 2)
    Set objWrkSpace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,50,True)
    
    If objWrkSpace.Exists = True then
      objWrkSpace.Click
      Dim objEdgeFilter
      set objEdgeFilter= Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 2).WPFObject("BarButtonItemLinkControl", "", 1)
      strTemp="WPFObject(""ContentControlEx"", ""Upload Workspace"", 2)"
      Set objTemp=objEdgeFilter.FindChild("Name",strTemp,50)
      If objTemp.Exists = TRUE then
        
        Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 2).WPFObject("BarButtonItemLinkControl", "", 1).WPFObject("ContentControlEx", "Upload Workspace", 2).Click
        strTemp="WPFObject(""PART_ContainerContent"")"
        Set objConfirm=Sys.Process("EdgeClient").WPFObject("HwndSource: WindowContentHolder", "Confirm").WPFObject("WindowContentHolder", "Confirm", 1).FindChild("Name",strTemp,50,True)
          If objConfirm.Exists = True then
'            sys.Keys("^Y")
            Sys.Keys "[Enter]"
            Set objConfirm = Sys.Process("EdgeClient")._
            Waitchild("WPFObject(""HwndSource: CustomMessageBoxWindow"", ""Upload Workspace"")",600000)._
            Waitchild("WPFObject(""CustomMessageBoxWindow"", ""Upload Workspace"", 1)",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""FloatingContainerBorder"")",60000)._
            Waitchild("WPFObject(""FloatingContainerBackground"")",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""FloatingContainerBody"")",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""PART_ContainerContent"")",60000)
            

              'Delay 30000,"Pls Wait.."
              'Call sEdgeProcessor
              
'              Sys.Process("EdgeClient").WPFObject("HwndSource: WindowContentHolder", "Upload Workspace").WPFObject("WindowContentHolder", "Upload Workspace", 1).WPFObject("NonLogicalDecorator", "", 1).WPFObject("ThemedManagedContentPresenter", "", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("DXMessageBox", "", 1)
            If objConfirm.Exists = True Then
                objConfirm.Click
                SYS.Keys "[Enter]"
                Call sEdgeProcessor               
            End If
          End if 
        End if
      Else
        strTestCaseResult = "ABORT"
        Exit Sub  
      End If
       Call sHome_Source
        strTemp="WPFObject(""SourceTreeListView"")"
        Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
        strTemp="WPFObject(""SourceTreeControl"")"
        Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
        Delay 10000,"Pls Wait.."
        ''Selecting Country Name
        intTotNodeCnt=GridControl.Nodes_2.Count
        For intI=0 to intTotNodeCnt-1         
            If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
              GridControl.Nodes_2.Item(intI).Expand(True)
              log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description       
              blnFlag=False  
              Exit For
            End If
        Next
        If blnFlag = True then
          strTCRemarks="Country Name not found"
          strTestCaseResult="FAIL"
          Exit Sub
        End If
  
        Delay 10000,"Pls Wait.."
        blnFlag = True 
      ''Selecting Level2Source_Name
      intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
      For intJ=0 to intTotNodeCnt-1
          If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(StrSource2) then
            GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
            intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
    '        Call GridSourceTree.ClickCell(intRow, "Edit")
            Call GridControl.ClearSelectionCore
            Call GridControl.FocusViewAndRow(GridControl,intRow)
            GridControl.SetFocusOnCurrentItem
            Call GridControl.SelectRowCore(intRow)
            log.Message "Level2 Source Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
            blnFlag = False 
            Exit For
          End If
        Next
      If blnFlag = True then
        log.Message "Level2 Source Name not found"
        strTCRemarks="Level2 Source Name not found"
        strTestCaseResult="FAIL"
        Exit Sub
      End If
      Delay 2000,"Pls Wait.."
      intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count
          For intk=0 to intTotNodeCnt-1
            If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description)=Ucase(StrSource3) then
              if GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intk).Content.MacroCapFlag=strMacroName then
                log.Message "Level3 Macro Flag Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.MacroCapFlag
              end if 
              log.Message "Level3 Source Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description

              blnFlag = False 
              Exit For
            End If
          Next

  Delay 15000,"Pls Wait.."
  Call SClosesource()

End Sub


Sub sSourceATP(strParameters)
On Error Resume Next 
   Dim strSource1,StrSource2,strSource3,strTemp,GridControl,GridSourceTree,intTotNodeCnt,intI,intJ,intRow,intK,objEdge
   Dim objNewWorkspace,objWrkspace_popup,objOpenView,strTemp1,objNewWrkSpaceName,objNewWrkSpace_Txtbox,objNewWrkSpace_okbtn,objNewWrkSpace_Name
   Dim strDesc1,strDesc2,DescText,DescLocalText,strMacroName,strDT
   
    strSource1=getSplitValue(strParameters,"SOURCE")
    StrSource2=getSplitValue(strParameters,"LEVEL2SOURCE")


'    strSource1="Test"
'    StrSource2="Automation_UIT4"
   
    
    Call sHome_Source
    
    strDesc1=aqDateTime.Now
    strDesc2=aqDateTime.Now
    DescText=Replace(strDesc1,"/","-")
    DescText=Replace(DescText,":","_")
    DescLocalText=DescText
    strWrkSpaceName=DescText
    strDT=DescText
    strDT=Replace(strDT,"_","")
    strDT=Replace(strDT,"-","")
    strDT=Replace(strDT," ","")
    strMacroName=strDT
'      intSeriesID=getSplitValue(strParameters,"SERIESID")
'      if intSeriesID=0 then
'        Call sSourceseries
'        intSeriesID=strSourceFileText
'      End if 
'    
    strTemp="WPFObject(""SourceTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""SourceTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    Delay 10000,"Pls Wait.."
    ''Selecting Country Name
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
          GridControl.Nodes_2.Item(intI).Expand(True)
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description       
          blnFlag=False  
          Exit For
        End If
    Next
    If blnFlag = True then
      strTCRemarks="Country Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
  
    Delay 10000,"Pls Wait.."
        blnFlag = True 
    ''Selecting Level2Source_Name
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
  For intJ=0 to intTotNodeCnt-1
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(StrSource2) then
        'GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
        intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
'        Call GridSourceTree.ClickCell(intRow, "Edit")
        Call GridControl.ClearSelectionCore
        Call GridControl.FocusViewAndRow(GridControl,intRow)
        GridControl.SetFocusOnCurrentItem
        Call GridControl.SelectRowCore(intRow)
        
        Dim PropArray,ValueArray, objTemp, left, Top     
        PropArray = Array("ClrClassName", "DisplayText")
        ValuesArray = Array("EditorControlStub",StrSource2)
        Set objTemp = GridControl.FindChild(PropArray, ValuesArray,18)
  
        If objTemp.Exists = True Then
          left =  objTemp.ActualWidth/2
          Top =  objTemp.ActualHeight/2    
          Call objTemp.ClickR(left, Top, 0)
          Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").Keys("[Down][Down][Down][Down][Right][Right]")
          
        Else
          log.Message "Cannot find the Cell"
        End If
        log.Message "Level2 Source Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
        blnFlag = False 
        Exit For
      End If
    Next
    If blnFlag = True then
      log.Message "Level2 Source Name not found"
      strTCRemarks="Level2 Source Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
    Delay 10000,"Pls Wait.."
    set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "", 3).WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 4).WPFObject("BarSubItemLinkControl", "", 1)
    strTemp="WPFObject(""ContentControlEx"", ""ATP"", 2)"
      Set objTemp=objEdge.FindChild("Name",strTemp,50)
      If objTemp.Exists=True then
        If objTemp.Enabled=True then
          strTCRemarks = strTCRemarks & "<br />" & "ATP is found in Source"
          log.Message "ATP is found  in Source"
          objTemp.Click
          set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "", 1).WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 3).WPFObject("BarButtonItemLinkControl", "", 1)
          strTemp="WPFObject(""ContentControlEx"", ""Open"", 2)"
          Set objTemp=objEdge.FindChild("Name",strTemp,50)
          If objTemp.Exists=True then
            If objTemp.Enabled=True then
              strTCRemarks = strTCRemarks & "<br />" & "Open ATP is found in Source"
              log.Message "Open ATP is found  in Source"
             Else
              strTCRemarks = strTCRemarks & "<br />" & "Open ATP is Disabled in Source"
              log.Message "Open ATP is Disabled  in Source"
            end if
          else
            strTCRemarks =  "open Not found in Source"
          End if
        Else
          strTCRemarks = strTCRemarks & "<br />" & "Open ATP is Disabled in Source"
          log.Message "Open ATP is Disabled  in Source"
        End if
      else
        strTCRemarks = strTCRemarks & "<br />" & "ATP is not found in Source"
        log.Message "ATP is not found in Source"
      End if
       
  Call sEdgeProcessor
  'Delay 15000,"Pls Wait.."
  Call SClosesource()
  Delay 5000,"Pls Wait.."
  Call SClosesource()
End sub

Sub sSourceOpenATP(strParameters)
On Error Resume Next 
   Dim strSource1,StrSource2,strSource3,strTemp,GridControl,GridSourceTree,intTotNodeCnt,intI,intJ,intRow,intK,objEdge
   Dim objNewWorkspace,objWrkspace_popup,objOpenView,strTemp1,objNewWrkSpaceName,objNewWrkSpace_Txtbox,objNewWrkSpace_okbtn,objNewWrkSpace_Name
   Dim strDesc1,strDesc2,DescText,DescLocalText,strMacroName,strDT,objArray,oSTP_ExcelObj,i,ReplaceFile
   
    strSource1=getSplitValue(strParameters,"SOURCE")
    StrSource2=getSplitValue(strParameters,"LEVEL2SOURCE")


'    strSource1="Test"
'    StrSource2="Automation_UIT4"
 
    Call sHome_Source
    
    strDesc1=aqDateTime.Now
    strDesc2=aqDateTime.Now
    DescText=Replace(strDesc1,"/","-")
    DescText=Replace(DescText,":","_")
    DescLocalText=DescText
    strWrkSpaceName=DescText
    strDT=DescText
    strDT=Replace(strDT,"_","")
    strDT=Replace(strDT,"-","")
    strDT=Replace(strDT," ","")
    strMacroName=strDT
'      intSeriesID=getSplitValue(strParameters,"SERIESID")
'      if intSeriesID=0 then
'        Call sSourceseries
'        intSeriesID=strSourceFileText
'      End if 
'    
    strTemp="WPFObject(""SourceTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""SourceTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    Delay 10000,"Pls Wait.."
    ''Selecting Country Name
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
          GridControl.Nodes_2.Item(intI).Expand(True)
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description       
          blnFlag=False  
          Exit For
        End If
    Next
    If blnFlag = True then
      strTCRemarks="Country Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
  
    Delay 10000,"Pls Wait.."
        blnFlag = True 
    ''Selecting Level2Source_Name
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
  For intJ=0 to intTotNodeCnt-1
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(StrSource2) then
        'GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
        intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
'        Call GridSourceTree.ClickCell(intRow, "Edit")
        Call GridControl.ClearSelectionCore
        Call GridControl.FocusViewAndRow(GridControl,intRow)
        GridControl.SetFocusOnCurrentItem
        Call GridControl.SelectRowCore(intRow)
        
        Dim PropArray,ValueArray, objTemp, left, Top     
        PropArray = Array("ClrClassName", "DisplayText")
        ValuesArray = Array("EditorControlStub",StrSource2)
        Set objTemp = GridControl.FindChild(PropArray, ValuesArray,18)
  
        If objTemp.Exists = True Then
          left =  objTemp.ActualWidth/2
          Top =  objTemp.ActualHeight/2    
          Call objTemp.ClickR(left, Top, 0)
          Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").Keys("[Down][Down][Down][Down][Right][Right]")
          
        Else
          log.Message "Cannot find the Cell"
        End If
        log.Message "Level2 Source Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
        blnFlag = False 
        Exit For
      End If
    Next
    If blnFlag = True then
      log.Message "Level2 Source Name not found"
      strTCRemarks="Level2 Source Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
    Delay 2000,"Pls Wait.."
    
     set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "", 3).WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 4).WPFObject("BarSubItemLinkControl", "", 1)
    strTemp="WPFObject(""ContentControlEx"", ""ATP"", 2)"
      Set objTemp=objEdge.FindChild("Name",strTemp,50)
      If objTemp.Exists=True then
        If objTemp.Enabled=True then
          strTCRemarks = strTCRemarks & "<br />" & "ATP is found in Source"
          log.Message "ATP is found  in Source"
          objTemp.Click
          set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "", 1).WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 3).WPFObject("BarButtonItemLinkControl", "", 1)
          strTemp="WPFObject(""ContentControlEx"", ""Open"", 2)"
          Set objTemp=objEdge.FindChild("Name",strTemp,50)
          If objTemp.Exists=True then
            If objTemp.Enabled=True then
              strTCRemarks = strTCRemarks & "<br />" & "Open ATP is found in Source"
              log.Message "Open ATP is found  in Source"
              objTemp.Click
              Delay(20000)
              strTemp="WPFObject(""PART_ContainerContent"")"
              Set ReplaceFile=Sys.Process("EXCEL",2).WaitChild(strTemp,120000)
              If ReplaceFile.Exists Then
                Sys.Keys "Y"
              End If
              strTCRemarks = "ATP file opened Successfully"
    
               objArray = Sys.FindAllChildren("ProcessName","EXCEL", 5,True)
              For i=0 to ubound(objArray)
                log.Message objArray(i).FullName
                set oSTP_ExcelObj = objArray(i).FindChild("WndCaption", "*RUN*",1,True)
                If oSTP_ExcelObj.Exists = True Then
                Else
                  objArray(i).Close
                End If
              Next

             Else
              strTCRemarks = strTCRemarks & "<br />" & "Open ATP is Disabled in Source"
              log.Message "Open ATP is Disabled  in Source"
            end if
          else
            strTCRemarks =  "open Not found in Source"
          End if
        Else
          strTCRemarks = strTCRemarks & "<br />" & "Open ATP is Disabled in Source"
          log.Message "Open ATP is Disabled  in Source"
        End if
      else
        strTCRemarks = strTCRemarks & "<br />" & "ATP is not found in Source"
        log.Message "ATP is not found in Source"
      End if
       
  Call sEdgeProcessor
  'Delay 15000,"Pls Wait.."
  Call SClosesource()
  Delay 5000,"Pls Wait.."
  Call SClosesource()
  
  End sub


Sub sReleaseScheduleModulePending()

On Error Resume Next

    Dim strTemp,objTemp,strCountry,GridControl,GridTreeView,strIndicator,intSeriesId,Grid,intI,strFromDate,objRow

   ' strCountry=getSplitValue(strParameters,"COUNTRY")
'    strCategory=Replace(Now,"/","-")
'    strIndicator=Replace(Now,"/","-")
   ' intSeriesId=getSplitValue(strParameters,"SERIESID")
   
    strCategory="Balance of Payments"
    strIndicator="Balance of Payments"

    strCountry="Test"
    intSeriesId="255460701"
      
    Call sHome_ReleaseSchedule
    
    ''Selecting Country
    Delay 2000,"Country"
    Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("GroupBox", "", 1).WPFObject("WrapPanel", "", 1).WPFObject("StackPanel", "", 1).WPFObject("ComboBox", "", 1)
    If objTemp.Exists = True then
      objTemp.Set_Text(strCountry)
'      Delay 20000,"Pls Wait..."
      Call sEdgeProcessor
    End If
dim edgeClient,hwndSource
     Set edgeClient = Aliases.EdgeClient
  Set hwndSource = Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow")
    ''Creating Category
    Delay 2000,"Category"
    Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("GroupBox", "", 1).WPFObject("WrapPanel", "", 1).WPFObject("StackPanel", "", 2).WPFObject("ComboBox", "", 1)
    If objTemp.Exists = True then
      objTemp.Click
     ' objTemp.Set_Text(strCategory)
     DElay(10000)
     Call hwndSource.Keys("b[Enter]")
     Delay(7000)
      Call sEdgeProcessor
    End If
    
    ''Creating Indicator
    Delay 2000,"Indicator"
    Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("GroupBox", "", 1).WPFObject("WrapPanel", "", 1).WPFObject("StackPanel", "", 3).WPFObject("ComboBox", "", 1)
    If objTemp.Exists = True then
      objTemp.Click
      Delay 10000,"Pls Wait..."
      Call hwndSource.Keys("b[Enter]")
      'objTemp.Set_Text(strIndicator)
      Call sEdgeProcessor
    End If
    
    Delay 10000,"Pls Wait..."
    Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("GroupBox", "", 1).WPFObject("WrapPanel", "", 1).WPFObject("StackPanel", "", 4).WPFObject("ComboBox", "", 1)
    If objTemp.Exists = True then
      objTemp.Click
      Delay 10000,"Pls Wait..."
      Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("ComboBoxItem", "", 3).WPFObject("TextBlock", "(A1) - Annual, ending ""Dec"" of each year", 1).Click
      'Call sEdgeProcessor
    End If
    
      ''Schedule Type
      Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("GroupBox", "", 3).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 7).WPFObject("BarEditItemLinkControl", "", 1).WPFObject("ContentControlEx", "", 1).WPFObject("ComboBoxEdit", "", 1)
      If objTemp.Exists = True then
          objTemp.set_Text("Final")
          Call sEdgeProcessor
      End If
  
      ''Adding New Schedule
      Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("GroupBox", "", 3).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarButtonItemLinkControl", "", 1).WPFObject("ContentControlEx", "Add", 2)
      If objTemp.Exists = True then
        Delay 8000,"Pls Wait.."
        objTemp.Click
        Delay 8000,"Pls Wait.."
        Call sEdgeProcessor
      End If
    Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("GroupBox", "", 3).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 1).WPFObject("ReleaseScheduleGridControl").WPFObject("ReleaseScheduleTableView").WPFObject("GridColumnHeader", "", 2).WPFObject("PART_Content").Click
      On Error Resume Next
    	
       Set Grid=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("GroupBox", "", 3).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 1).WPFObject("ReleaseScheduleGridControl")
       Set objTemp=Aliases.EdgeClient.HwndSource_RibbonWindow.RibbonWindow.ContentControl.Grid.Grid.ContentControl.Grid.ContentControl.PART_ContainerContent.BarManager.DockPanel.DockLayoutManager.LayoutGroup.LayoutPanel.Root.AdornerDecorator.AdornedControl.Grid.WPFObject("GroupBox", "", 3).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 1).WPFObject("ReleaseScheduleGridControl").WPFObject("ReleaseScheduleTableView").WPFObject("HierarchyPanel", "", 1).WPFObject("RowControl", "", 1).WPFObject("CellsControl", "", 1).WPFObject("LightweightCellEditor", "", 2).WPFObject("InplaceBaseEdit", "", 1)
       Delay 10000,"Pls Wait..."
       objTemp.Click
       strTemp=DatePart("m",aqDateTime.Now)
       Delay 10000,"Pls Wait..."
       sys.Keys strTemp
       Delay 8000,"Pls Wait..."
       Set objTemp=Aliases.EdgeClient.HwndSource_RibbonWindow.RibbonWindow.ContentControl.Grid.Grid.ContentControl.Grid.ContentControl.PART_ContainerContent.BarManager.DockPanel.DockLayoutManager.LayoutGroup.LayoutPanel.Root.AdornerDecorator.AdornedControl.Grid.WPFObject("GroupBox", "", 3).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 1).WPFObject("ReleaseScheduleGridControl").WPFObject("ReleaseScheduleTableView").WPFObject("HierarchyPanel", "", 1).WPFObject("RowControl", "", 1).WPFObject("CellsControl", "", 1).WPFObject("LightweightCellEditor", "", 3).WPFObject("InplaceBaseEdit", "", 1)
       objTemp.Click
       Delay 5000,"Pls Wait..."

    ''Upload
    Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarButtonItemLinkControl", "", 1).WPFObject("ContentControlEx", "Upload", 2).Click
    strTemp="WPFObject(""PART_ContainerContent"")"
    Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: WindowContentHolder", "Please Confirm").FindChild("Name",strTemp,50,True)
'    strTemp="WPFObject(""DXMessageBox"", """", 1)"
'    Set objTemp=objTemp.WaitChild(strTemp,600000)
'    Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: WindowContentHolder", "").WPFObject("WindowContentHolder", "", 1).WPFObject("NonLogicalDecorator", "", 1).WPFObject("ThemedManagedContentPresenter", "", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WaitChild(strTemp,80000)
    If objTemp.Exists = True then
      Sys.Keys "Y"
      Delay 5000,"Uploading.."
'      Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: WindowContentHolder", "").WPFObject("WindowContentHolder", "", 1).WPFObject("NonLogicalDecorator", "", 1).WPFObject("ThemedManagedContentPresenter", "", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WaitChild(strTemp,80000)
        strTemp="WPFObject(""PART_ContainerContent"")"
        Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: WindowContentHolder", "Release Schedule Success").FindChild("Name",strTemp,50,True)
        strTemp="WPFObject(""DXMessageBox"", """", 1)"
        Set objTemp=objTemp.WaitChild(strTemp,360000)
      If objTemp.Exists = True then
        objTemp.Keys "[Enter]"
'        Delay 25000,"Uploading.."
        Call sEdgeProcessor
      End If
    End If

'    strTPDate=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("GroupBox", "", 3).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 1).WPFObject("ReleaseScheduleGridControl").WPFObject("ReleaseScheduleTableView").WPFObject("HierarchyPanel", "", 1).WPFObject("GridRow", "", 1).WPFObject("ScrollablePart").WPFObject("CellItemsControl", "", 1).WPFObject("GridCellContentPresenter", "", 1).WPFObject("DateEdit", "", 1).Text
    strTPDate=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("GroupBox", "", 3).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 1).WPFObject("ReleaseScheduleGridControl").WPFObject("ReleaseScheduleTableView").WPFObject("HierarchyPanel", "", 1).WPFObject("RowControl", "", 1).WPFObject("CellsControl", "", 1).WPFObject("LightweightCellEditor", "", 1).WPFObject("InplaceBaseEdit", "", 1).DisplayText.OleValue
    strTCRemarks="Release Schedule Uploaded" & "<br />" & "Timepoint Date - " & strTPDate
    
    Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("GroupBox", "", 3).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 1).WPFObject("ReleaseScheduleGridControl").WPFObject("ReleaseScheduleTableView").WPFObject("GridColumnHeader", "", 2).WPFObject("PART_Content").Click
    
    
End Sub


Sub sUpdateSeriesOpenSTP()

On Error Resume Next

    Dim strTemp,objTemp,objArray,strFileName,oSTP_ExcelObj,FilePath,objSTPXls,STPSheetName,netUIHWND,STP,strSTPCellValue
    Dim strStatus,strActualDate,intTP,intI,intRowcnt,strSrcId,strId,intRow,intJ

'    strSearch1=getSplitValue(strParameters,"SEARCH1")
'    STPSheetName=getSplitValue(strParameters,"STPSheetName")
'    STP=getSplitValue(strParameters,"STP")
'    intTP=getSplitValue(strParameters,"TP")

    
    strTPDate="12/1/2016"
    strSearch1="255460701"
    STPSheetName="A1_1"
    STP="YYY-YYY-TABLE NAME TEST SOURCE"
    intTP="55"

   Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("Grid", "", 1).WPFObject("GridControl").WPFObject("GridView").WPFObject("ContentPresenter", "", 1).WPFObject("FilterCellContentPresenter", "", 1).WPFObject("TextEdit", "", 1)
    If objTemp.Exists = True then
      objTemp.Click
      objTemp.Keys strSearch1
      strTemp="WPFObject(""GridControl"")"
      Set objTemp=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,True)
      If objTemp.Exists = True then
        strTemp=objTemp.FilterString.OleValue
        while aqstring.Find(ucase(strTemp),strSearch1)=-1
          Delay 100,"Pls Wait.."
        Wend
      End If
      Delay 3000,"Pls Wait.."
'      Call sEdgeProcessor
    End If

'    Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("Grid", "", 1).WPFObject("GridControl").WPFObject("GridView").WPFObject("HierarchyPanel", "", 1).WPFObject("GridRow", "", 1).WPFObject("ScrollablePart").WPFObject("CellItemsControl", "", 1).WPFObject("GridCellContentPresenter", "", 1).WPFObject("TextEdit", "", 1)
                  
    strTemp="WPFObject(""GridControl"")"
    Set objTemp=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""GridView"")"
    Set GridControl=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,True)
    If objTemp.Exists = True then
      intRowcnt=objTemp.wRowCount
      For intI=0 to intRowcnt-1
          strTemp="WPFObject(""HierarchyPanel"", """", 1)"
          Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("Grid", "", 1).WPFObject("GridControl").WPFObject("GridView").WPFObject("HierarchyPanel", "", 1)
          strId=objTemp.Children.Item(intI).DataContext.Row.get_SeriesId
          If strSearch1=strId then
            strSrcId=objTemp.Children.Item(intI).DataContext.Row.get_SourceSeriesTypeId
            If strSrcId=1 then 
              strTemp="WPFObject(""GridControl"")"
              Set objTemp=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,True)
                If objTemp.Exists = True then
'                  objTemp.ClickRowIndicator(intI)
                  Call GridControl.ClearSelectionCore
                  Call GridControl.FocusViewAndRow(GridControl,intI)
                  GridControl.SetFocusOnCurrentItem
                  Call GridControl.SelectRowCore(intI)                  
                  Exit For
                End If
            End If
          End If
      Next
    End If

    
    
    If objTemp.Exists = True then
'      objTemp.Click
      ''Open STP
     ' Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 2).WPFObject("BarButtonItemLinkControl", "", 1).WPFObject("ContentControlEx", "Open STP", 2).Click
      Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 2).WPFObject("BarButtonItemLinkControl", "", 1).WPFObject("ContentControlEx", "Open Global STP", 2).Click
      Delay 10000,"Opening STP.."
      Call sExcelFullHistory1
      Delay 10000,"Opening STP.."
      ''Getting STP Object
      objArray = Sys.FindAllChildren("ProcessName","EXCEL", 1,True)
      For i=0 to ubound(objArray)
        log.Message objArray(i).FullName
        set oSTP_ExcelObj = objArray(i).FindChild("WndCaption", "*" & STP & "*",1,True)
        If oSTP_ExcelObj.Exists = True Then
          strFileName=oSTP_ExcelObj.WndCaption
          If instr(strFileName,"Microsoft Excel")>0 then
            strFileName=GetFileName(strFileName,"Microsoft Excel")
          Else
            strFileName=GetFileNameExcel13(strFileName," - Excel")
          End If
      '    strFileName=iif(instr(strFileName,"Microsoft Excel")>0,GetFileName(strFileName,"Microsoft Excel"),GetFileNameExcel13(strFileName,"- Excel.xlsx"))
          FilePath = aqEnvironment.GetEnvironmentVariable("USERPROFILE") & "\Documents\Edge\EdgeAddinStorage\" & aqConvert.DateTimeToFormatStr(aqDateTime.Today,"%Y-%m-%d")
          FilePath=FilePath & "\" & iif(instr(strFileName,"xlsx") > 0,strFileName,strFileName & ".xlsx")  
          log.Message FilePath
          Exit For
        Else
          log.Message "STP file not found in " & objArray(i).FullName
        End If
      Next

    On Error Resume Next
    Set objSTPXls=GetObject(FilePath)
    With objSTPXls
      With .Sheets(STPSheetName).Select
      End With
    End With 
      With objSTPXls
        With .WorkSheets(STPSheetName)    
        Delay 10000,"Pls Wait.."
            For intI=1 to 500
              strSTPCellValue=iif(.Cells(intI,1)="" or isNull(.Cells(intI,1)),"N/A",.Cells(intI,1))
              If VarType(strSTPCellValue) <>8 then
                 If strSTPCellValue <> "N/A" then
                    If cStr(strSTPCellValue)=(strSearch1) then
                       intRow=intI
                       Exit For
                    End If
                 End If 
              End If
            Next
            For intI= 25 to 500
              strSTPCellValue=.Cells(2,intI)
              strTPDate=FormatDateTime(strTPDate,2)
              strSTPCellValue=FormatDateTime(strSTPCellValue,2)
              If strSTPCellValue=strTPDate then
                If .Cells(intRow,intI)=" " then
                  .Cells(intRow,intI)=intTP
                  .Cells(intRow,intI).select
                Else
                  intTp=.Cells(intRow,intI)
                  .Cells(intRow,intI)=intTP+1
                  .Cells(intRow,intI).select
                End If
                Exit For
              End If
            Next         
        End With
      End With
'      dim tableLayoutPanel,tableLayoutPanel2,dropDownPopupForm,radGridView,radButton
'       Set tableLayoutPanel = excel.TPDetailsForm.mainPanel
'       call tableLayoutPanel.Click
'        Set tableLayoutPanel2 = tableLayoutPanel.buttonPanel
'   
'       Call Aliases.EXCEL.wndXLMAIN.EXCEL2.toolbarRibbon.Ribbon.NUIPane.NetUIHWND.Click(654, 65)
'      Delay 5000,"Pls Wait.."
'  
'      Set radGridView = tableLayoutPanel.gridView
'        Call dropDownPopupForm.Click(63, 49)
'        Call radGridView.Click(314, 58)
'        Call dropDownPopupForm.Click(66, 10)
'        Set radButton = tableLayoutPanel.buttonPanel.saveButton
'        radButton.ClickButton
'        Call radGridView.Click(281, 84)
'        radButton.ClickButton
'        excel2.dlgWarning.btnYes.ClickButton
'         Delay 10000,"Pls Wait.."
  
    ''Mark Good
    Set netUIHWND=Sys.Process("EXCEL", 2).Window("XLMAIN", strSTPWndCaption , 1).Window("EXCEL2", "", 2).FindChild("Name","Window(""NetUIHWND"", """", 1)",5,True)
    Delay 1000,"Mark Good..."
    With objSTPXls
      With .WorkSheets(STPSheetName)
           .Cells.Select
      End With
    End With
    Call netUIHWND.Click(32, 92)
  
    ''Upload Series
    Call netUIHWND.Click(131, 71)
    Delay 15000 , "Uploading.."
    ''Waiting for Msgbox
    strTemp="WPFObject(""PART_ContainerContent"")"
    Set File=Sys.Process("EXCEL", 2).WaitChild(strTemp,210000)
    If File.Exists Then
      File.Window("Button", "OK", 1).Click
    End If
    ''Question Msgbox
    strTemp="WPFObject(""PART_ContainerContent"")"
    Set File=Sys.Process("EXCEL", 2).WaitChild(strTemp,210000)
    If File.Exists Then
      File.Keys "N"
    End If
    objSTPXls.Close
    Call CloseSearch
    
    ''Refreshing RS
    Delay 5000,"Refresh.."
    Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 1).WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarButtonItemLinkControl", "", 1).WPFObject("ContentControlEx", "Refresh", 2).Click
    Delay 2000,"Released.."
    Call sEdgeProcessor
    
     
    End If

    ''Closing Series search
     Dim objEdge,i,j,objCaption,objText,strOk
   Set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager")     
   If objEdge.Exists = True then  
    objText = objEdge.FindAllChildren("ClrClassName","LayoutGroup", 10,True)
        For i=0 to ubound(objText)
          log.Message objText(i).FullName
          log.Message objText(i).Name
          objCaption = objText(i).FindAllChildren("ClrClassName", "LayoutPanel",10,True)
          For j=0 to ubound(objCaption)
           log.Message objCaption(j).FullName
            log.Message objCaption(j).Name
            if objCaption(j).Content.Caption = "Source Series" then 
                  log.Message objCaption(j).FullName
                  'Call objCaption(j).ClickR(objCaption(j).top/2,objCaption(j).left/30,0)
                    Call objCaption(j).ClickR(275, 8)
                    Delay 5000,"Pls Wait.."
                    sys.Keys "[Down][Down][Down][Enter]"
                    Delay 5000,"Pls Wait.."
                    Set strOk=Sys.Process("EdgeClient").WPFObject("HwndSource: WindowContentHolder", "", 1).WPFObject("WindowContentHolder", "", 1).WPFObject("NonLogicalDecorator", "", 1).WPFObject("ThemedManagedContentPresenter", "", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("DXMessageBox", "", 1)
                    Delay 5000, "Closing Form..Pls wait.."
                    If strOk.Exists Then
                      SYS.Keys "[Enter]"
                    End If
                  Exit For 
              End If 
          Next
        Next   
  End If
  
'  Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("GroupBox", "", 3).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 1).WPFObject("ReleaseScheduleGridControl")
'  log.Message "Country Name - " & GridControl.Nodes_2.Item(1).Content.ReleaseStatus  

  Call CloseWindow
End Sub

Sub  sCheckLayoutRCViewWorkspace(strParameters)
On Error Resume Next 

    Dim objEdge,objEdgeFilter
    Dim strLevel1layout,strLevel2layout,strLevel3layout,strWrkSpaceName
    Dim objNewWrkSpace_okbtn,objNewWrkSpace_Name
    Dim objNewWrkSpace_Txtbox,objopenforEdit,objWrkspace_popup
    Dim strTemp,objTemp,intRow,barManager,intTotNodeCnt,Text,objCellText,intI,intK,strDesc1,strDesc2,intJ
    Dim objWrkSpace,objwrkspacepop,objwrkspcUpload,objConfirm,objGridCell,DescLocalText,intSeriesID,GridControl,GridSourceTree
    Dim PropArray,ValueArray,left, Top   
     
    Call sloadlayout 

    strLevel1layout=getSplitValue(strParameters,"LEVEL1LAYOUT")
    strLevel2layout=getSplitValue(strParameters,"LEVEL2LAYOUT")  
   

'    strLevel1layout="dX Non-Asia Database (Current Eng Version)"
'    strLevel2layout="Z-Testing Topic(IT-use only)"

     Delay 10000,"Please Wait..."
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("LayoutTreeControl").WPFObject("LayoutTreeListView")
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("LayoutTreeControl")
   
    
       Delay 1000,"Please Wait..."
        ''Selecting Level1 layout
        intTotNodeCnt=GridControl.Nodes_2.Count
        For intI=0 to intTotNodeCnt-1         
            If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strLevel1layout) then
              GridControl.Nodes_2.Item(intI).Expand(True)
              log.Message "Level 1 Layout - " & GridControl.Nodes_2.Item(intI).Content.Description       
              blnFlag=False  
              Exit For
            End If
        Next
        Delay 10000,"Please Wait..."
        If blnFlag = True then
          strTCRemarks="Level 1 Layout not found"
          strTestCaseResult="FAIL"
          Exit Sub
        End If
  
        blnFlag = True 
        ''Selecting Level2 Layout
        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
        For intJ=0 to intTotNodeCnt-1
          If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strLevel2layout) then
            GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
            intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
            GridControl.set_FocusedRowHandle(intRow)
            GridControl.Keys("[Down]")
            GridControl.Keys("[Up]")
              
            PropArray = Array("ClrClassName", "DisplayText")
            ValuesArray = Array("EditorControlStub",strLevel2layout)
            Set objTemp = GridControl.FindChild(PropArray, ValuesArray,18)
  
            If objTemp.Exists = True Then
              left =  objTemp.ActualWidth/2
              Top =  objTemp.ActualHeight/2    
              Call objTemp.ClickR(left, Top, 0)
              Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").Keys("[Down][Right]")
          
            Else
              log.Message "Cannot find the Cell"
            End If
  
            log.Message "Level2 layout Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
            blnFlag = False 
            Exit For
          End If
        Next
        If blnFlag = True then
          strTCRemarks="Level2 Source Name not found"
          strTestCaseResult="FAIL"
          Exit Sub
        End If 
 
      set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "", 2).WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarSubItemLinkControl", "", 1)
      strTemp="WPFObject(""ContentControlEx"", ""New Workspace"", 2)"
      Set objTemp=objEdge.FindChild("Name",strTemp,50)
      If objTemp.Exists=True then
        If objTemp.Enabled=True then
          strTCRemarks = strTCRemarks & "<br />" & "New Workspace is found in Source"
          log.Message "New Workspace is found  in Source"
          objTemp.Click
          set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "", 1).WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarButtonItemLinkControl", "", 1)
          strTemp="WPFObject(""ContentControlEx"", ""Open For View"", 2)"
          Set objTemp=objEdge.FindChild("Name",strTemp,50)
          If objTemp.Exists=True then
            If objTemp.Enabled=True then
              strTCRemarks = strTCRemarks & "<br />" & "Open For View is found in Layout"
              log.Message "Open For View is found in Layout"
              objTemp.Click
              Call sEdgeProcessor
              log.Message "Workspace created for view only"
            strTCRemarks=strTCRemarks & "<br />" & "Workspace created for view only"
             Else
              strTCRemarks = strTCRemarks & "<br />" & "Open For View is Disabled in Layout"
              log.Message "Open For View is Disabled in Layout"
            end if
          else
            strTCRemarks =  "Open For View is not found in Layout"
          End if
       End if
       Else
        strTCRemarks = strTCRemarks & "<br />" & "New Workspace is not found in Source"
        log.Message "New Workspace is not found  in Source"
      End if 
      Call sCloseLayout
      Call sCloseLayout

End sub
Sub  sCheckLayoutAddfolderRCViewWorkspace(strParameters)
On Error Resume Next 

    Dim objNewWorkspace,strTemp1,objNewWrkSpaceName
    Dim objEdge,objEdgeFilter
    Dim strLevel1layout,strLevel2layout,strLevel3layout,strWrkSpaceName
    Dim objNewWrkSpace_okbtn,objNewWrkSpace_Name
    Dim objNewWrkSpace_Txtbox,objopenforEdit,objWrkspace_popup,strOk
    Dim strTemp,objTemp,intRow,barManager,intTotNodeCnt,Text,objCellText,intI,intK,strDesc1,strDesc2,intJ
    Dim objWrkSpace,objwrkspacepop,objwrkspcUpload,objConfirm,objGridCell,DescLocalText,intSeriesID,GridControl,GridSourceTree
    Dim PropArray,ValueArray,left, Top
     
    Call sloadlayout 

    strLevel1layout=getSplitValue(strParameters,"LEVEL1LAYOUT")
    strLevel2layout=getSplitValue(strParameters,"LEVEL2LAYOUT")  
   

'    strLevel1layout="dX Non-Asia Database (Current Eng Version)"
'    strLevel2layout="Z-Testing Topic(IT-use only)"

     Delay 10000,"Please Wait..."
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("LayoutTreeControl").WPFObject("LayoutTreeListView")
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("LayoutTreeControl")
   
    
       Delay 1000,"Please Wait..."
        ''Selecting Level1 layout
        intTotNodeCnt=GridControl.Nodes_2.Count
        For intI=0 to intTotNodeCnt-1         
            If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strLevel1layout) then
              GridControl.Nodes_2.Item(intI).Expand(True)
              log.Message "Level 1 Layout - " & GridControl.Nodes_2.Item(intI).Content.Description       
              blnFlag=False  
              Exit For
            End If
        Next
        Delay 10000,"Please Wait..."
        If blnFlag = True then
          strTCRemarks="Level 1 Layout not found"
          strTestCaseResult="FAIL"
          Exit Sub
        End If
  
        blnFlag = True 
        ''Selecting Level2 Layout
        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
        For intJ=0 to intTotNodeCnt-1
          If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strLevel2layout) then
            GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
            intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
            GridControl.set_FocusedRowHandle(intRow)
            GridControl.Keys("[Down]")
            GridControl.Keys("[Up]")
              
            PropArray = Array("ClrClassName", "DisplayText")
            ValuesArray = Array("EditorControlStub",strLevel2layout)
            Set objTemp = GridControl.FindChild(PropArray, ValuesArray,18)
  
            If objTemp.Exists = True Then
              left =  objTemp.ActualWidth/2
              Top =  objTemp.ActualHeight/2    
              Call objTemp.ClickR(left, Top, 0)
              Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").Keys("[Down][Right]")
          
            Else
              log.Message "Cannot find the Cell"
            End If
  
            log.Message "Level2 layout Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
            blnFlag = False 
            Exit For
          End If
        Next
        If blnFlag = True then
          strTCRemarks="Level2 Source Name not found"
          strTestCaseResult="FAIL"
          Exit Sub
        End If 

    
      set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "", 2).WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarSubItemLinkControl", "", 1)
      strTemp="WPFObject(""ContentControlEx"", ""New Workspace"", 2)"
      Set objTemp=objEdge.FindChild("Name",strTemp,50)
      If objTemp.Exists=True then
        If objTemp.Enabled=True then
          strTCRemarks = strTCRemarks & "<br />" & "New Workspace is found in Source"
          log.Message "New Workspace is found  in Source"
          objTemp.Click
          set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "", 1).WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarButtonItemLinkControl", "", 1)
          strTemp="WPFObject(""ContentControlEx"", ""Open For View"", 2)"
          Set objTemp=objEdge.FindChild("Name",strTemp,50)
          If objTemp.Exists=True then
            If objTemp.Enabled=True then
              strTCRemarks = strTCRemarks & "<br />" & "Open For View is found in Layout"
              log.Message "Open For View is found in Layout"
              objTemp.Click
              Call sEdgeProcessor
              log.Message "Workspace created for view only"
            strTCRemarks=strTCRemarks & "<br />" & "Workspace created for view only"
             Else
              strTCRemarks = strTCRemarks & "<br />" & "Open For View is Disabled in Layout"
              log.Message "Open For View is Disabled in Layout"
            end if
          else
            strTCRemarks =  "Open For View is not found in Layout"
          End if
       End if
       Else
        strTCRemarks = strTCRemarks & "<br />" & "New Workspace is not found in Source"
        log.Message "New Workspace is not found  in Source"
      End if 
      
       ''Handling Validation for Layout
    strTemp="WPFObject(""HwndSource: WindowContentHolder"", """")"
    Set objTemp=Sys.Process("EdgeClient").WaitChild(strTemp,20000)
    If objTemp.Exists = True then
      objTemp.Keys "[Enter]"
      strTestCaseResult = "FAIL"
      Exit Sub
    End If

    ''WorkSpace Edit Window
    strTemp="WPFObject(""LayoutPanel"", """", 2)"
    Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,13,True)
    If objTemp.Exists then
        Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("LayoutTreeListControl").WPFObject("LayoutTreeListView")
        Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("LayoutTreeListControl")

        ''Selecting Level1 layout
        intTotNodeCnt=GridControl.Nodes_2.Count
        For intI=0 to intTotNodeCnt-1         
            If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strLevel1layout) then
              GridControl.Nodes_2.Item(intI).Expand(True)
              log.Message "Level 1 Layout - " & GridControl.Nodes_2.Item(intI).Content.Description       
              blnFlag=False  
              Exit For
            End If
        Next
  
        blnFlag = True 
        ''Selecting Level2 Layout
        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
        For intJ=0 to intTotNodeCnt-1
          If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strLevel2layout) then
            GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
            log.Message "Level2 layout Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
            GridControl.Keys "^[Home]"
            GridControl.Keys "[Down]"
            blnFlag = False 
            Exit For
          End If
        Next
   

    
        ''Clicking on New Folder
    '   strTemp="WPFObject(""BarButtonItemLinkControl"", """", 1)"
        Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 4).WPFObject("BarButtonItemLinkControl", "", 1)
        If objTemp.Exists = True then 
          objTemp.Click  
          'Call sEdgeProcessor
          Delay 1000,"New Folder..."
          
       strTemp="WPFObject(""PART_ContainerContent"")"
      'Set strOk=Sys.Process("EdgeClient").WPFObject("HwndSource: WindowContentHolder", "Workspace").WPFObject("WindowContentHolder", "Workspace", 1).WPFObject("NonLogicalDecorator", "", 1).WPFObject("ThemedManagedContentPresenter", "", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WaitChild(strTemp,550000)
      Set strOk=Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "Workspace").WPFObject("CustomMessageBoxWindow", "Workspace", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,550000)
        If objConfirm.Exists = True then
          sys.Keys "[Enter]"
        End if   
        End If
     End if 
      Call sCloseLayout
      Call sCloseLayout
End sub


Sub sCheckLayoutModuleRCOpenEdit(strParameters)

On Error Resume Next 
    Dim strLevel1layout,strLevel2layout,strLevel3layout,strWrkSpaceName
    Dim objNewWrkSpace_okbtn,objNewWrkSpace_Name
    Dim objNewWrkSpace_Txtbox,objopenforEdit,objWrkspace_popup
    Dim strTemp,objTemp,intRow,barManager,intTotNodeCnt,Text,objCellText,intI,intK,strDesc1,strDesc2
    Dim objWrkSpace,objwrkspacepop,objwrkspcUpload,objConfirm,objGridCell,DescLocalText,intSeriesID
    Dim PropArray,ValueArray,left, Top
    
    Call sloadlayout 

    
    strLevel1layout=getSplitValue(strParameters,"LEVEL1LAYOUT")
    strLevel2layout=getSplitValue(strParameters,"LEVEL2LAYOUT")

    
'    strLevel1layout="dX Non-Asia Database (Current Eng Version)"
'    strLevel2layout="Z-Testing Topic(IT-use only)"


    strDesc1=aqDateTime.Now
    strDesc2=aqDateTime.Now
    DescText=Replace(strDesc1,"/","-")
    DescText=Replace(DescText,":","_")
    DescLocalText=DescText
    strWrkSpaceName=DescText
 

     Delay 10000,"Please Wait..."
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("LayoutTreeControl").WPFObject("LayoutTreeListView")
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("LayoutTreeControl")
   
    
       Delay 1000,"Please Wait..."
        ''Selecting Level1 layout
        intTotNodeCnt=GridControl.Nodes_2.Count
        For intI=0 to intTotNodeCnt-1         
            If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strLevel1layout) then
              GridControl.Nodes_2.Item(intI).Expand(True)
              log.Message "Level 1 Layout - " & GridControl.Nodes_2.Item(intI).Content.Description       
              blnFlag=False  
              Exit For
            End If
        Next
        Delay 10000,"Please Wait..."
        If blnFlag = True then
          strTCRemarks="Level 1 Layout not found"
          strTestCaseResult="FAIL"
          Exit Sub
        End If
  
        blnFlag = True 
        ''Selecting Level2 Layout
        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
        For intJ=0 to intTotNodeCnt-1
          If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strLevel2layout) then
            GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
            intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
            GridControl.set_FocusedRowHandle(intRow)
            GridControl.Keys("[Down]")
            Delay 10000,"Please Wait..."
            GridControl.Keys("[Up]")
             Delay 10000,"Please Wait..." 
            PropArray = Array("ClrClassName", "DisplayText")
            ValuesArray = Array("EditorControlStub",strLevel2layout)
            Set objTemp = GridControl.FindChild(PropArray, ValuesArray,18)
  
            If objTemp.Exists = True Then
              left =  objTemp.ActualWidth/2
              Top =  objTemp.ActualHeight/2    
              Call objTemp.ClickR(left, Top, 0)
              Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").Keys("[Down][Right]")
          
            Else
              log.Message "Cannot find the Cell"
            End If
  
            log.Message "Level2 layout Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
            blnFlag = False 
            Exit For
          End If
        Next
        If blnFlag = True then
          strTCRemarks="Level2 Source Name not found"
          strTestCaseResult="FAIL"
          Exit Sub
        End If 

    
      set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "", 2).WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarSubItemLinkControl", "", 1)
      strTemp="WPFObject(""ContentControlEx"", ""New Workspace"", 2)"
      Set objTemp=objEdge.FindChild("Name",strTemp,50)
      If objTemp.Exists=True then
        If objTemp.Enabled=True then
          strTCRemarks = strTCRemarks & "<br />" & "New Workspace is found in Source"
          log.Message "New Workspace is found  in Source"
          objTemp.Click
          set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "", 1).WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 2).WPFObject("BarButtonItemLinkControl", "", 1)
          strTemp="WPFObject(""ContentControlEx"", ""Open For Edit"", 2)"
          Set objTemp=objEdge.FindChild("Name",strTemp,50)
          If objTemp.Exists=True then
            If objTemp.Enabled=True then
              strTCRemarks = strTCRemarks & "<br />" & "Open For Edit is found in Layout"
              log.Message "Open For Edit is found in Layout"
              objTemp.Click
 
             Else
              strTCRemarks = strTCRemarks & "<br />" & "Open For Edit is Disabled in Layout"
              log.Message "Open For Edit is Disabled in Layout"
            end if
          else
            strTCRemarks =  "Open For Edit is not found in Layout"
          End if
       End if
       Else
        strTCRemarks = strTCRemarks & "<br />" & "New Workspace is not found in Source"
        log.Message "New Workspace is not found  in Source"
      End if 
 
      strTemp1="WPFObject(""HwndSource: WorkspaceNamePrompt"", ""Please provide a new Workspace Name"")"
      Set objNewWrkSpaceName=Sys.Process("EdgeClient").WaitChild(strTemp1,80000)
      If objNewWrkSpaceName.Exists = True then

          ''Waiting for Workspace Name prompt
          strTemp="WPFObject(""FloatingContainerBorder"")"
          Set objNewWrkSpace_Name=Sys.Process("EdgeClient").WPFObject("HwndSource: WorkspaceNamePrompt", "Please provide a new Workspace Name").WPFObject("WorkspaceNamePrompt", "Please provide a new Workspace Name", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,1500000)
          If objNewWrkSpace_Name.Exists = True then
            strTemp="WPFObject(""ChangeNameTextEdit"")"
            ''Entering Workspace Name
            Set objNewWrkSpace_Txtbox=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
              'Delay 30000,"Please Wait..."
              If objNewWrkSpace_Txtbox.Exists = True then
                objNewWrkSpace_Txtbox.Click
                objNewWrkSpace_Txtbox.Text=strWrkSpaceName
                ''Clicking on Ok Button 
                strTemp="WPFObject(""OkButton"")"
                Set objNewWrkSpace_okbtn=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
                If objNewWrkSpace_okbtn.Exists = True then
                  objNewWrkSpace_okbtn.Click
                  'Delay 10000,"Please wait..."
'                   strTemp="WPFObject(""DXMessageBox"", """", 1)"
'                  Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: WindowContentHolder", "New Workspace").WPFObject("WindowContentHolder", "New Workspace", 1).WPFObject("NonLogicalDecorator", "", 1).WPFObject("ThemedManagedContentPresenter", "", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").FindChild("Name",strTemp,9,True)
'                   If objNewWrkSpace_okbtn.Exists = True then
'                    objNewWrkSpace_okbtn.Click
'                      SYS.Keys "[Enter]"
'                    Call sCloseLayout
'                    Exit Sub
'                  End if
                  
              strTemp="WPFObject(""PART_ContainerContent"")"
              Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "Warning").WPFObject("CustomMessageBoxWindow", "Warning", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,50000)
              If objNewWrkSpace_okbtn.Exists = True then
                SYS.Keys "N"
                Call sCloseLayout
                Exit Sub
              End If
                End If
               End If
          End If
      End if 


    ''Handling Validation for Layout
    strTemp="WPFObject(""HwndSource: WindowContentHolder"", """")"
    Set objTemp=Sys.Process("EdgeClient").WaitChild(strTemp,20000)
    If objTemp.Exists = True then
      objTemp.Keys "[Enter]"
      strTestCaseResult = "FAIL"
      Exit Sub
    End If

    ''WorkSpace Edit Window
    strTemp="WPFObject(""LayoutPanel"", """", 2)"
    Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,13,True)
    If objTemp.Exists then
        Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("LayoutTreeListControl").WPFObject("LayoutTreeListView")
        Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("LayoutTreeListControl")

        ''Selecting Level1 layout
        intTotNodeCnt=GridControl.Nodes_2.Count
        For intI=0 to intTotNodeCnt-1         
            If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strLevel1layout) then
              GridControl.Nodes_2.Item(intI).Expand(True)
              log.Message "Level 1 Layout - " & GridControl.Nodes_2.Item(intI).Content.Description       
              blnFlag=False  
              Exit For
            End If
        Next
  
        blnFlag = True 
        ''Selecting Level2 Layout
        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
        For intJ=0 to intTotNodeCnt-1
          If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strLevel2layout) then
            GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
            log.Message "Level2 layout Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
            blnFlag = False 
            Exit For
          End If
        Next
    End if  
        Call sCloseLayout
        Call sCloseLayout

        Call LayoutWorkSpacevwr
  
End Sub

Sub  sCheckSourceSaveNewSourceOrganizationLevel2RightClick()
On Error Resume Next 
  Dim strSource_Name,strLevel2src_Name,objNewWrkSpace_okbtn,objNewWrkSpace_Name,strWrkSpaceName
    Dim objNewWrkSpace_Txtbox,objopenforEdit,objWrkspace_popup
    Dim strTemp,objTemp,intRow,barManager,intTotNodeCnt,Text,strDesc1,strDesc2,intI
    Dim objWrkSpace,objwrkspacepop,objwrkspcUpload,objConfirm,objGridCell,DescLocalText,intSeriesID
    Dim layoutGroup
    Dim strTemp1,objNewWrkSpaceName,objEdgeTree
    Dim objEdgeFilter
    Dim PropArray,ValueArray, left, Top     
'   strSource_Name=getSplitValue(strParameters,"SOURCE")
    strSource_Name="Test"
    
   
    strDesc1=aqDateTime.Now
    strDesc2=aqDateTime.Now
    DescText=Replace(strDesc1,"/","-")
    DescText=Replace(DescText,":","_")
    DescLocalText=DescText
    strWrkSpaceName=DescText
    Call sHome_Source
    
    strTemp="WPFObject(""SourceTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""SourceTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    Delay 10000,"Pls Wait.."
    ''Selecting Country Name
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource_Name) then
          intRow=GridControl.Nodes_2.Item(intI).get_RowHandle
          Call GridControl.ClearSelectionCore
          Call GridControl.FocusViewAndRow(GridControl,intRow)
          GridControl.SetFocusOnCurrentItem
          Call GridControl.SelectRowCore(intRow)  
          
         
          PropArray = Array("ClrClassName", "DisplayText")
          ValuesArray = Array("EditorControlStub",strSource_Name)
          Set objTemp = GridControl.FindChild(PropArray, ValuesArray,18)
  
          If objTemp.Exists = True Then
            left =  objTemp.ActualWidth/2
            Top =  objTemp.ActualHeight/2    
            Call objTemp.ClickR(left, Top, 0)
            Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").Keys("[Down][Right]")
          
          Else
            log.Message "Cannot find the Cell"
          End If
          
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description       
          blnFlag=False  
          Exit For
        End If
    Next
    If blnFlag = True then
      strTCRemarks="Country Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
     Delay 10000,"Pls Wait.."

  set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 3).WPFObject("BarButtonItemLinkControl", "", 1)
  strTemp="WPFObject(""ContentControlEx"", ""New Source Organization"", 2)"
  Set objTemp=objEdge.FindChild("Name",strTemp,50)
  If objTemp.Exists=True then
    If objTemp.Enabled=True then
      strTCRemarks = strTCRemarks & "<br />" & "New Source Organization button found in Source"
      log.Message "New Source Organization button found in Source"
      objTemp.Click
      Delay 5000,"Pls Wait.."
      log.Message "New Source Organization Window opened in Source"
      strTCRemarks = strTCRemarks & "<br />" &  "New Source Organization Window is opened in Source"
     
     
      set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: Root").WPFObject("Root").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 2)
      strTemp="WPFObject(""SourceCodeTextEdit"")"
      Set objTemp=objEdge.FindChild("Name",strTemp,50)
      If objTemp.Exists=True then
          Sys.Process("EdgeClient").WPFObject("HwndSource: Root").WPFObject("Root").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 2).WPFObject("SourceCodeTextEdit").Text=strWrkSpaceName 
      else
        strTCRemarks =  "Source Abbreviation is not having Edit option in New Source Organization"
      End if
      
      set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: Root").WPFObject("Root").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 3)
      strTemp="WPFObject(""SourceDescTextEdit"")"
      Set objTemp=objEdge.FindChild("Name",strTemp,50)
      If objTemp.Exists=True then
          Sys.Process("EdgeClient").WPFObject("HwndSource: Root").WPFObject("Root").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 3).WPFObject("SourceDescTextEdit").Text=strWrkSpaceName
      else
        strTCRemarks =  "Source Description have Edit option in New Source Organization"
      End if
      
      set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: Root").WPFObject("Root").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 4)
      strTemp="WPFObject(""SourceDescLocTextEdit"")"
      Set objTemp=objEdge.FindChild("Name",strTemp,50)
      If objTemp.Exists=True then
          Sys.Process("EdgeClient").WPFObject("HwndSource: Root").WPFObject("Root").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 4).WPFObject("SourceDescLocTextEdit").Text=strWrkSpaceName
      else
        strTCRemarks =  "Source Description Local have Edit option in New Source Organization"
      End if
    
      set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: Root").WPFObject("Root").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 8)
      strTemp="WPFObject(""MacroCapFlagTextEdit"")"
      Set objTemp=objEdge.FindChild("Name",strTemp,50)
      If objTemp.Exists=True then
          Sys.Process("EdgeClient").WPFObject("HwndSource: Root").WPFObject("Root").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 8).WPFObject("MacroCapFlagTextEdit").Text="t4"
      else
        strTCRemarks =  "Macro Cap Flag have Edit option in New Source Organization"
      End if
      
      set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: Root").WPFObject("Root").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 9)
      strTemp="WPFObject(""MacroPathTextEdit"")"
      Set objTemp=objEdge.FindChild("Name",strTemp,50)
      If objTemp.Exists=True then
          Sys.Process("EdgeClient").WPFObject("HwndSource: Root").WPFObject("Root").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 9).WPFObject("MacroPathTextEdit").Text="t5"
      else
        strTCRemarks =  "Macro Path have Edit option in New Source Organization"
      End if
      
      Sys.Process("EdgeClient").WPFObject("HwndSource: Root").WPFObject("Root").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 6).WPFObject("IsOfficialCheckEdit").IsChecked=True
      Sys.Process("EdgeClient").WPFObject("HwndSource: Root").WPFObject("Root").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 5).WPFObject("SourceNatureComboEdit").Selectedindex = 1
      Sys.Process("EdgeClient").WPFObject("HwndSource: Root").WPFObject("Root").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 10).WPFObject("InsertSourceAfterComboEdit").Selectedindex = 2
      set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: Root").WPFObject("Root").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1)
      strTemp="WPFObject(""OkButton"")"
      Set objTemp=objEdge.FindChild("Name",strTemp,50)
      If objTemp.Exists=True then
          objTemp.Click
          log.Message "Clicked the OK Button in New Source Organization"
      else
        strTCRemarks =  "Ok Button is Not found in New Source Organization"
      End if
      Call sEdgeProcessor
     Delay 15000,"Pls Wait.."

    End if 
  else
    strTCRemarks =  "New Source Organization button is Not found in Source"
  End if 
  Call SClosesource()
End Sub

Sub  sCheckSourceExpandCollapse(strParameters)
On Error Resume Next 
  Dim strSource_Name,strLevel2src_Name,objNewWrkSpace_okbtn,objNewWrkSpace_Name,strWrkSpaceName
    Dim objNewWrkSpace_Txtbox,objopenforEdit,objWrkspace_popup
    Dim strTemp,objTemp,intRow,barManager,intTotNodeCnt,Text,strDesc1,strDesc2,intI
    Dim objWrkSpace,objwrkspacepop,objwrkspcUpload,objConfirm,objGridCell,DescLocalText,intSeriesID
    Dim layoutGroup
    Dim strTemp1,objNewWrkSpaceName,objEdgeTree
    Dim objEdgeFilter,objRow
 
   strSource_Name=getSplitValue(strParameters,"SOURCE")
'    strSource_Name="Test"
    
   
    strDesc1=aqDateTime.Now
    strDesc2=aqDateTime.Now
    DescText=Replace(strDesc1,"/","-")
    DescText=Replace(DescText,":","_")
    DescLocalText=DescText
    strWrkSpaceName=DescText
    Call sHome_Source
    
    strTemp="WPFObject(""SourceTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""SourceTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    Delay 10000,"Pls Wait.."
    ''Selecting Country Name
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource_Name) then
          intRow=GridControl.Nodes_2.Item(intI).get_RowHandle
          Call GridControl.ClearSelectionCore
          Call GridControl.FocusViewAndRow(GridControl,intRow)
          GridControl.SetFocusOnCurrentItem
          Call GridControl.SelectRowCore(intRow)  
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description  
'          strTemp="WPFObject(""RowMarginControl"")"
          Set objRow=GridControl.FindChild("ClrClassName","RowMarginControl",150,True)
          if objRow.Exists=True then  
            Call objRow.Click
            strTCRemarks="Expanded all Child in Source"
             delay(5000)
            Call objRow.Click
            strTCRemarks = strTCRemarks & "<br />" &  "Collapsed all Child in Source"
          End if   
          blnFlag=False  
          Exit For
        End If
    Next
    If blnFlag = True then
      strTCRemarks="Country Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
     Delay 10000,"Pls Wait.."
End Sub

Sub  sCheckSrcOpenEditLabels(strParameters)
On Error Resume Next 
   Dim strSource1,StrSource2,strSource3,strTemp,GridControl,GridSourceTree,intTotNodeCnt,intI,intJ,intRow,intK,objEdge
   Dim objNewWorkspace,objWrkspace_popup,objOpenView,strTemp1,objNewWrkSpaceName,objNewWrkSpace_Txtbox,objNewWrkSpace_okbtn,objNewWrkSpace_Name
   Dim strDesc1,strDesc2,DescText,DescLocalText
   Dim objEditSource
   
    strSource1=getSplitValue(strParameters,"SOURCE")
    StrSource2=getSplitValue(strParameters,"LEVEL2SOURCE")

'    strSource1="Test"
'    StrSource2="Automation"

    Call sHome_Source
    
    strDesc1=aqDateTime.Now
    strDesc2=aqDateTime.Now
    DescText=Replace(strDesc1,"/","-")
    DescText=Replace(DescText,":","_")
    DescLocalText=DescText
    strWrkSpaceName=DescText
'    intSeriesID=getSplitValue(strParameters,"SERIESID")
'    if intSeriesID=0 then
'      Call sSourceseries
'      intSeriesID=strSourceFileText
'    End if 
    
    strTemp="WPFObject(""SourceTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""SourceTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    Delay 10000,"Pls Wait.."
    ''Selecting Country Name
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
          GridControl.Nodes_2.Item(intI).Expand(True)
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description       
          blnFlag=False  
          Exit For
        End If
    Next
    If blnFlag = True then
      strTCRemarks="Country Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
  
    Delay 10000,"Pls Wait.."
        blnFlag = True 
    ''Selecting Level2Source_Name
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
  For intJ=0 to intTotNodeCnt-1
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(StrSource2) then
        GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
        intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
'        Call GridSourceTree.ClickCell(intRow, "Edit")
        Call GridControl.ClearSelectionCore
        Call GridControl.FocusViewAndRow(GridControl,intRow)
        GridControl.SetFocusOnCurrentItem
        Call GridControl.SelectRowCore(intRow)
        log.Message "Level2 Source Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
        blnFlag = False 
        Exit For
      End If
    Next
    If blnFlag = True then
      log.Message "Level2 Source Name not found"
      strTCRemarks="Level2 Source Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
    Delay 2000,"Pls Wait.."

    strTemp="WPFObject(""ArrowControl"", """", 1)"
    Set objNewWorkspace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,20,True)
    If objNewWorkspace.Exists = True then
      objNewWorkspace.Click
       strTemp="WPFObject(""BarPopupBorderControl"", """", 1)"
      Set objWrkspace_popup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").FindChild("Name",strTemp,5,True)
      If objWrkspace_popup.Exists = True then
        strTemp="WPFObject(""ContentControlEx"", ""Open For Edit (Source)"", 2)"
        Set objopenforEdit=objWrkspace_popup.FindChild("Name",strTemp,8,True)
        If objopenforEdit.Exists then
          objopenforEdit.Click    
          'Delay 20000,"Please Wait..."
        End If
      End if
      
      strTemp1="WPFObject(""HwndSource: WorkspaceNamePrompt"", ""Please provide a new Workspace Name"")"
      Set objNewWrkSpaceName=Sys.Process("EdgeClient").WaitChild(strTemp1,50000)
      If objNewWrkSpaceName.Exists = True then
     
      ''Waiting for Workspace Name prompt
      strTemp="WPFObject(""FloatingContainerBorder"")"
      Set objNewWrkSpace_Name=Sys.Process("EdgeClient").WPFObject("HwndSource: WorkspaceNamePrompt", "Please provide a new Workspace Name").WPFObject("WorkspaceNamePrompt", "Please provide a new Workspace Name", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,15000000)
      If objNewWrkSpace_Name.Exists = True then
          strTemp="WPFObject(""ChangeNameTextEdit"")"
          ''Entering Workspace Name
          Set objNewWrkSpace_Txtbox=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
            If objNewWrkSpace_Txtbox.Exists = True then
              objNewWrkSpace_Txtbox.Click
              objNewWrkSpace_Txtbox.Text=strWrkSpaceName
      '        strTCRemarks=strTCRemarks & Chr(10) & "Entered Workspace Name - " & strWrkSpaceName
              ''Clicking on Ok Button 
              strTemp="WPFObject(""OkButton"")"
              Set objNewWrkSpace_okbtn=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
              If objNewWrkSpace_okbtn.Exists = True then
                objNewWrkSpace_okbtn.Click
                'Delay 5000,"Please wait..."
              End If
            End If
        End If
      End if 
     End if 
       Delay 15000,"Pls Wait.."
      Call SClosesource()
      Delay 5000,"Pls Wait.."
  
    strTemp="WPFObject(""SourceTreeListView"")"
    objEditSource=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WaitChild(strTemp,15000000)
    if objEditSource.Exists = True then
       strTemp="WPFObject(""ContentControlEx"", ""Size of changes:"", 1)"
          Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarStaticItemLinkControl", "", 1).FindChild("Name",strTemp,9,True)
          If objNewWrkSpace_okbtn.Exists = True then
            If objNewWrkSpace_okbtn.Enabled = True then
              strTCRemarks = strTCRemarks & "<br />" & "Size of change is found in Source"
              log.Message "Size of Change is found in Source"
            Else
              strTCRemarks = strTCRemarks & "<br />" & "Size of change is Disabled in Source"
              log.Message "Size of Change is Disabled in Source"
            End if 
          Else
            strTCRemarks = strTCRemarks & "<br />" & "Size of change is  not found in Source"
            log.Message "Size of Change is not found in Source"
          End If
          
          strTemp="WPFObject(""ContentControlEx"", ""Add Folder"", 2)"
          Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 4).WPFObject("BarButtonItemLinkControl", "", 1).FindChild("Name",strTemp,50,True)
          If objNewWrkSpace_okbtn.Exists = True then
             If objNewWrkSpace_okbtn.Enabled = True then
              strTCRemarks = strTCRemarks & "<br />" & "Add Folder is found in Source"
              log.Message "Add Folder is found in Source"
             Else
              strTCRemarks = strTCRemarks & "<br />" & "Add Folder is Disabled in Source"
              log.Message "Add Folder is Disabled in Source"
             End if
          Else
            strTCRemarks = strTCRemarks & "<br />" & "Add Folder is  not found in Source"
            log.Message "Add Folder is not found in Source"
          End If
          
          strTemp="WPFObject(""ContentControlEx"", ""Delete Folder"", 2)"
          Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 7).WPFObject("BarButtonItemLinkControl", "", 1).FindChild("Name",strTemp,50,True)
          If objNewWrkSpace_okbtn.Exists = True then
             If objNewWrkSpace_okbtn.Enabled = True then
              strTCRemarks = strTCRemarks & "<br />" & "Delete Folder is found in Source"
              log.Message "Delete Folder is found in Source"
             Else
              strTCRemarks = strTCRemarks & "<br />" & "Delete Folder is Disabled in Source"
              log.Message "Delete Folder is Disabled in Source"
             End if
          Else
            strTCRemarks = strTCRemarks & "<br />" & "Delete Folder is  not found in Source"
            log.Message "Delete Folder is not found in Source"
          End If
          
          strTemp="WPFObject(""ContentControlEx"", ""Copy Folder"", 2)"
           Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 8).WPFObject("BarSubItemLinkControl", "", 1).FindChild("Name",strTemp,50,True)
          If objNewWrkSpace_okbtn.Exists = True then
             If objNewWrkSpace_okbtn.Enabled = True then
              strTCRemarks = strTCRemarks & "<br />" & "Copy Folder is found in Source"
              log.Message "Copy Folder is found in Source"
             Else
              strTCRemarks = strTCRemarks & "<br />" & "Copy Folder is Disabled in Source"
              log.Message "Copy Folder is Disabled in Source"
             End if
          Else
            strTCRemarks = strTCRemarks & "<br />" & "Copy Folder is  not found in Source"
            log.Message "Copy Folder is not found in Source"
          End If

          strTemp="WPFObject(""ContentControlEx"", ""Cut Folder"", 2)"
          Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 9).WPFObject("BarButtonItemLinkControl", "", 1).FindChild("Name",strTemp,50,True)
          If objNewWrkSpace_okbtn.Exists = True then
             If objNewWrkSpace_okbtn.Enabled = True then
              strTCRemarks = strTCRemarks & "<br />" & "Cut Folder is found in Source"
              log.Message "Cut Folder is found in Source"
             Else
              strTCRemarks = strTCRemarks & "<br />" & "Cut Folder is Disabled in Source"
              log.Message "Cut Folder is Disabled in Source"
             End if 
          Else
            strTCRemarks = strTCRemarks & "<br />" & "Cut Folder is  not found in Source"
            log.Message "Cut Folder is not found in Source"
          End If

          strTemp="WPFObject(""ContentControlEx"", ""Paste Folder"", 2)"
          Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 10).WPFObject("BarSubItemLinkControl", "", 1).FindChild("Name",strTemp,50,True)
          If objNewWrkSpace_okbtn.Exists = True then
             If objNewWrkSpace_okbtn.Enabled = True then
              strTCRemarks = strTCRemarks & "<br />" & "Paste button is found in Source"
              log.Message "Paste button is found in Source"
             Else
              strTCRemarks = strTCRemarks & "<br />" & "Paste button is Disabled in Source"
              log.Message "Paste button is Disabled in Source"
             End if 
          Else
            strTCRemarks = strTCRemarks & "<br />" & "Paste button is  not found in Source"
            log.Message "Paste button is not found in Source"
          End If
          
          strTemp="WPFObject(""ContentControlEx"", ""Workspace"", 2)"
          Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 11).WPFObject("BarSubItemLinkControl", "", 1).FindChild("Name",strTemp,50,True)
          If objNewWrkSpace_okbtn.Exists = True then
             If objNewWrkSpace_okbtn.Enabled = True then
              strTCRemarks = strTCRemarks & "<br />" & "Workspace button is found in Source"
              log.Message "Workspace button is found in Source"
             Else
               strTCRemarks = strTCRemarks & "<br />" & "Workspace button is Disabled in Source"
              log.Message "Workspace button is Disabled in Source"
             End if
          Else
            strTCRemarks = strTCRemarks & "<br />" & "Workspace button is  not found in Source"
            log.Message "Workspace button is not found in Source"
          End If
          
          strTemp="WPFObject(""ContentControlEx"", ""Find & Replace"", 2)"
          Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 12).WPFObject("BarButtonItemLinkControl", "", 1).FindChild("Name",strTemp,50,True)
          If objNewWrkSpace_okbtn.Exists = True then
             If objNewWrkSpace_okbtn.Enabled = True then
              strTCRemarks = strTCRemarks & "<br />" & "Find & Replace  is found in Source"
              log.Message "Find & Replace is found in Source"
             Else
              strTCRemarks = strTCRemarks & "<br />" & "Find & Replace  is Disabled in Source"
              log.Message "Find & Replace is Disabled in Source"
             End if
          Else
            strTCRemarks = strTCRemarks & "<br />" & "Find & Replace is  not found in Source"
            log.Message "Find & Replace is not found in Source"
          End If
          
          strTemp="WPFObject(""ContentControlEx"", ""Expand All"", 2)"
          Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 13).WPFObject("BarButtonItemLinkControl", "", 1).FindChild("Name",strTemp,50,True)
          If objNewWrkSpace_okbtn.Exists = True then
             If objNewWrkSpace_okbtn.Enabled = True then
              strTCRemarks = strTCRemarks & "<br />" & "Expand All is found in Source"
              log.Message "Expand All is found in Source"
             Else
               strTCRemarks = strTCRemarks & "<br />" & "Expand All is Disabled in Source"
              log.Message "Expand All is Disabled in Source"
             End if 
          Else
            strTCRemarks = strTCRemarks & "<br />" & "Expand All is  not found in Layout"
            log.Message "Expand All is not found in Layout"
          End If
          
          strTemp="WPFObject(""ContentControlEx"", ""Collapse All"", 2)"
          Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 14).WPFObject("BarButtonItemLinkControl", "", 1).FindChild("Name",strTemp,50,True)
          If objNewWrkSpace_okbtn.Exists = True then
             If objNewWrkSpace_okbtn.Enabled = True then
              strTCRemarks = strTCRemarks & "<br />" & "Collapse All is found in Source"
              log.Message "Collapse All is found in Source"
             Else
              strTCRemarks = strTCRemarks & "<br />" & "Collapse All is Disabled in Source"
              log.Message "Collapse All is Disabled in Source"
             End if 
          Else
            strTCRemarks = strTCRemarks & "<br />" & "Collapse All is  not found in Source"
            log.Message "Collapse All is not found in Source"
          End If
          
          
           strTemp="WPFObject(""SpinEdit"", """", 1)"
          Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 5).WPFObject("BarEditItemLinkControl", "", 1).WPFObject("ContentControlEx", "", 1).FindChild("Name",strTemp,50,True)
          If objNewWrkSpace_okbtn.Exists = True then
             If objNewWrkSpace_okbtn.Enabled = True then
              strTCRemarks = strTCRemarks & "<br />" & "Add folder is combo box in Source"
              log.Message "Add folder is combo box in Source"
             Else
               strTCRemarks = strTCRemarks & "<br />" & "Add folder is not a combo box in Source"
              log.Message "Expand All is Disabled in Source"
             End if 
          Else
            strTCRemarks = strTCRemarks & "<br />" & "Expand All is  not found in Layout"
            log.Message "Expand All is not found in Layout"
          End If
          
    End if
 
  Call SClosesource()
  Call SourceWorkSpacevwr()
End Sub

Sub  sCheckSrcOpenEdit(strParameters)
On Error Resume Next 
   Dim strSource1,StrSource2,strSource3,strTemp,GridControl,GridSourceTree,intTotNodeCnt,intI,intJ,intRow,intK,objEdge
   Dim objNewWorkspace,objWrkspace_popup,objOpenView,strTemp1,objNewWrkSpaceName,objNewWrkSpace_Txtbox,objNewWrkSpace_okbtn,objNewWrkSpace_Name
   Dim strDesc1,strDesc2,DescText,DescLocalText
   Dim objEditSource
   
    strSource1=getSplitValue(strParameters,"SOURCE")
    StrSource2=getSplitValue(strParameters,"LEVEL2SOURCE")

'    strSource1="Test"
'    StrSource2="Automation"

    Call sHome_Source
    
    strDesc1=aqDateTime.Now
    strDesc2=aqDateTime.Now
    DescText=Replace(strDesc1,"/","-")
    DescText=Replace(DescText,":","_")
    DescLocalText=DescText
    strWrkSpaceName=DescText
'    intSeriesID=getSplitValue(strParameters,"SERIESID")
'    if intSeriesID=0 then
'      Call sSourceseries
'      intSeriesID=strSourceFileText
'    End if 
    
    strTemp="WPFObject(""SourceTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""SourceTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    Delay 10000,"Pls Wait.."
    ''Selecting Country Name
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
          GridControl.Nodes_2.Item(intI).Expand(True)
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description       
          blnFlag=False  
          Exit For
        End If
    Next
    If blnFlag = True then
      strTCRemarks="Country Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
  
    Delay 10000,"Pls Wait.."
        blnFlag = True 
    ''Selecting Level2Source_Name
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
  For intJ=0 to intTotNodeCnt-1
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(StrSource2) then
        GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
        intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
'        Call GridSourceTree.ClickCell(intRow, "Edit")
        Call GridControl.ClearSelectionCore
        Call GridControl.FocusViewAndRow(GridControl,intRow)
        GridControl.SetFocusOnCurrentItem
        Call GridControl.SelectRowCore(intRow)
        log.Message "Level2 Source Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
        blnFlag = False 
        Exit For
      End If
    Next
    If blnFlag = True then
      log.Message "Level2 Source Name not found"
      strTCRemarks="Level2 Source Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
    Delay 2000,"Pls Wait.."

    strTemp="WPFObject(""ArrowControl"", """", 1)"
    Set objNewWorkspace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,20,True)
    If objNewWorkspace.Exists = True then
      objNewWorkspace.Click
       strTemp="WPFObject(""BarPopupBorderControl"", """", 1)"
      Set objWrkspace_popup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").FindChild("Name",strTemp,5,True)
      If objWrkspace_popup.Exists = True then
        strTemp="WPFObject(""ContentControlEx"", ""Open For Edit (Source)"", 2)"
        Set objopenforEdit=objWrkspace_popup.FindChild("Name",strTemp,8,True)
        If objopenforEdit.Exists then
          objopenforEdit.Click    
          'Delay 20000,"Please Wait..."
        End If
      End if
      
      strTemp1="WPFObject(""HwndSource: WorkspaceNamePrompt"", ""Please provide a new Workspace Name"")"
      Set objNewWrkSpaceName=Sys.Process("EdgeClient").WaitChild(strTemp1,50000)
      If objNewWrkSpaceName.Exists = True then
     
      ''Waiting for Workspace Name prompt
      strTemp="WPFObject(""FloatingContainerBorder"")"
      Set objNewWrkSpace_Name=Sys.Process("EdgeClient").WPFObject("HwndSource: WorkspaceNamePrompt", "Please provide a new Workspace Name").WPFObject("WorkspaceNamePrompt", "Please provide a new Workspace Name", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,15000000)
      If objNewWrkSpace_Name.Exists = True then
          strTemp="WPFObject(""ChangeNameTextEdit"")"
          ''Entering Workspace Name
          Set objNewWrkSpace_Txtbox=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
            If objNewWrkSpace_Txtbox.Exists = True then
              objNewWrkSpace_Txtbox.Click
              objNewWrkSpace_Txtbox.Text=strWrkSpaceName
      '        strTCRemarks=strTCRemarks & Chr(10) & "Entered Workspace Name - " & strWrkSpaceName
              ''Clicking on Ok Button 
              strTemp="WPFObject(""OkButton"")"
              Set objNewWrkSpace_okbtn=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
              If objNewWrkSpace_okbtn.Exists = True then
                objNewWrkSpace_okbtn.Click
                'Delay 5000,"Please wait..."
              End If
            End If
        End If
      End if 
     End if 
       Delay 15000,"Pls Wait.."
  Call SClosesource()
  Delay 5000,"Pls Wait.."
  
    strTemp="WPFObject(""SourceTreeListView"")"
    objEditSource=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WaitChild(strTemp,15000000)
    if objEditSource.Exists = True then
      if Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WPFObject("SourceTreeListView").WPFObject("GridColumnHeader", "", 1).WPFObject("PART_Content").Text="Description *" then
        strTCRemarks = strTCRemarks & "<br />" &  "Description Found in Source"
        log.Message "Description Found in Source" 
      End if 

    if Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WPFObject("SourceTreeListView").WPFObject("GridColumnHeader", "", 2).WPFObject("PART_Content").Text="Description Local *" then
       strTCRemarks = strTCRemarks & "<br />" &  "Description Local Found in Source"
      log.Message "Description Local Found in Source" 
    End if 
    if Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WPFObject("SourceTreeListView").WPFObject("GridColumnHeader", "", 3).WPFObject("PART_Content").Text="Source Abbr." then
       strTCRemarks = strTCRemarks & "<br />" &  "Source Abbr Found in Source"
      log.Message "Source Abbr Found in Source" 
    End if
    if Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WPFObject("SourceTreeListView").WPFObject("GridColumnHeader", "", 4).WPFObject("PART_Content").Text="Tree Level" then
       strTCRemarks = strTCRemarks & "<br />" &  "Tree Level Found in Source"
      log.Message "Tree Level Found in Source" 
    End if
    if Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WPFObject("SourceTreeListView").WPFObject("GridColumnHeader", "", 5).WPFObject("PART_Content").Text="Source Type" then 
       strTCRemarks = strTCRemarks & "<br />" &  "Source Type Found in Source"
      log.Message "Source Type Found in Source" 
    End if
    if Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WPFObject("SourceTreeListView").WPFObject("GridColumnHeader", "", 6).WPFObject("PART_Content").Text="Source Nature" then
       strTCRemarks = strTCRemarks & "<br />" &  "Source Nature Found in Source"
      log.Message "Source Nature Found in Source" 
    end if 
    if Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WPFObject("SourceTreeListView").WPFObject("GridColumnHeader", "", 7).WPFObject("PART_Content").Text="Is Official" then
       strTCRemarks = strTCRemarks & "<br />" &  "Is Official Found in Source"
      log.Message "Is Official Found in Source" 
    End if
    If Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WPFObject("SourceTreeListView").WPFObject("GridColumnHeader", "", 8).WPFObject("PART_Content").Text="URL" then
       strTCRemarks = strTCRemarks & "<br />" &  "URL Found in Source"
      log.Message "URL Found in Source" 
    End if
    IF Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WPFObject("SourceTreeListView").WPFObject("GridColumnHeader", "", 9).WPFObject("PART_Content").Text="Macro Cap Flag" then
       strTCRemarks = strTCRemarks & "<br />" &  "Macro Cap Flag Found in Source"
      log.Message "Macro Cap Flag  Found in Source" 
    End if
    If Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WPFObject("SourceTreeListView").WPFObject("GridColumnHeader", "", 10).WPFObject("PART_Content").Text="Macro Path" then
       strTCRemarks = strTCRemarks & "<br />" &  "Macro Path Found in Source"
      log.Message "Macro Path Found in Source"
    End if
    IF Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WPFObject("SourceTreeListView").WPFObject("GridColumnHeader", "", 11).WPFObject("PART_Content").Text="Remarks" then
      strTCRemarks = strTCRemarks & "<br />" &  "Remarks Found in Source"
      log.Message "Remarks Found in Source" 
    End if
End if
  '  Call objEditSource.ClickCell(0, "Version")
  set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1)
  strTemp="WPFObject(""LayoutPanel"", """", 1)"
  Set objTemp=objEdge.FindChild("Name",strTemp,5)
  Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1)
  IF objTemp.Exists = True then 
    
      objTemp.Click
       Delay(10000)
' Call Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).Click
'    Call objEditSource.Click(7, 2)
  SYS.Keys("![End]")
  End if
    Delay(10000)
        
strTemp="WPFObject(""SourceTreeListView"")"
    objEditSource=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WaitChild(strTemp,15000000)
    if objEditSource.Exists = True then
    IF Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WPFObject("SourceTreeListView").WPFObject("GridColumnHeader", "", 1).WPFObject("PART_Content").Text="Version" then 
      strTCRemarks = strTCRemarks & "<br />" &  "Version Found in Source"
      log.Message "Version Found in Source" 
    End if
    IF Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WPFObject("SourceTreeListView").WPFObject("GridColumnHeader", "", 2).WPFObject("PART_Content").Text="Last Updated Time" then
      strTCRemarks = strTCRemarks & "<br />" &  "Last Updated Time Found in Source"
      log.Message "Last Updated Time Found in Source" 
    End if
    IF Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WPFObject("SourceTreeListView").WPFObject("GridColumnHeader", "", 3).WPFObject("PART_Content").Text="Last Updated User ID" then
       strTCRemarks = strTCRemarks & "<br />" &  "Last Updated User ID Found in Source"
      log.Message "Last Updated User ID Found in Source" 
    End if 
    IF Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WPFObject("SourceTreeListView").WPFObject("GridColumnHeader", "", 4).WPFObject("PART_Content").Text="Display Order" then
      strTCRemarks = strTCRemarks & "<br />" &  "Display Order Found in Source"
      log.Message "Display Order Found in Source" 
    End if
    IF Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WPFObject("SourceTreeListView").WPFObject("GridColumnHeader", "", 12).WPFObject("PART_Content").Text="System ID" then
      strTCRemarks = strTCRemarks & "<br />" &  "System ID Found in Source"
      log.Message "System ID Found in Source"
    End if
  End if 
''End if 
  Call SClosesource()
  Call SourceWorkSpacevwr()
End Sub

Sub  sCheckLayoutEditWrk(strParameters)
On Error Resume Next

    Dim objNewWorkspace,strTemp1,objNewWrkSpaceName
    Dim strLevel1layout,strLevel2layout,strLevel3layout,strWrkSpaceName
    Dim objNewWrkSpace_okbtn,objNewWrkSpace_Name
    Dim objNewWrkSpace_Txtbox,objopenforEdit,objWrkspace_popup
    Dim strTemp,objTemp,intRow,barManager,intTotNodeCnt,Text,objCellText,intI,intJ,intK,strDesc1,strDesc2
    Dim objWrkSpace,objwrkspacepop,objwrkspcUpload,objConfirm,objGridCell,DescLocalText,intSeriesID
    
    Call sLoadLayout
    Call sCheckLayoutExpandTree(strParameters)
    
    strLevel1layout=getSplitValue(strParameters,"LEVEL1LAYOUT")
    strLevel2layout=getSplitValue(strParameters,"LEVEL2LAYOUT")
    strLevel3layout=getSplitValue(strParameters,"LEVEL3LAYOUT")
    
'    strLevel1layout="dX Non-Asia Database (Current Eng Version)"
'    strLevel2layout="Z-Testing Topic(IT-use only)"
'    strLevel3layout="Sandbox (Benny)"
    
'    strLevel1layout="dX Non-Asia Database (Current Eng Version)"
'    strLevel2layout="Z-Topic Test(IT-use only)"
'    strLevel3layout="Automation"

    strDesc1=aqDateTime.Now
    strDesc2=aqDateTime.Now
    DescText=Replace(strDesc1,"/","-")
    DescText=Replace(DescText,":","_")
    DescLocalText=DescText
    strWrkSpaceName=DescText
'    intSeriesID=getSplitValue(strParameters,"SERIESID")
'    if intSeriesID=0 then
'      intSeriesID=strSeriesID
'    End if 
    strTemp="WPFObject(""ArrowControl"", """", 1)"
    Set objNewWorkspace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarSubItemLinkControl", "", 1).FindChild("Name",strTemp,2,True)
    If objNewWorkspace.Exists = True then
      objNewWorkspace.Click
      strTemp="WPFObject(""BarPopupBorderControl"", """", 1)"
      Set objWrkspace_popup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").FindChild("Name",strTemp,5,True)
      If objWrkspace_popup.Exists = True then
        strTemp="WPFObject(""ContentControlEx"", ""Open For Edit"", 2)"
        Set objopenforEdit=objWrkspace_popup.FindChild("Name",strTemp,8,True)
        If objopenforEdit.Exists then
          objopenforEdit.Click    
        End If
      End If
      strTemp1="WPFObject(""HwndSource: WorkspaceNamePrompt"", ""Please provide a new Workspace Name"")"
      Set objNewWrkSpaceName=Sys.Process("EdgeClient").WaitChild(strTemp1,80000)
      If objNewWrkSpaceName.Exists = True then
          ''Waiting for Workspace Name prompt
          strTemp="WPFObject(""FloatingContainerBorder"")"
          Set objNewWrkSpace_Name=Sys.Process("EdgeClient").WPFObject("HwndSource: WorkspaceNamePrompt", "Please provide a new Workspace Name").WPFObject("WorkspaceNamePrompt", "Please provide a new Workspace Name", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,1500000)
          If objNewWrkSpace_Name.Exists = True then
            strTemp="WPFObject(""ChangeNameTextEdit"")"
            ''Entering Workspace Name
            Set objNewWrkSpace_Txtbox=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
            If objNewWrkSpace_Txtbox.Exists = True then
                objNewWrkSpace_Txtbox.Click
                objNewWrkSpace_Txtbox.Text=strWrkSpaceName
                ''Clicking on Ok Button 
                strTemp="WPFObject(""OkButton"")"
                Set objNewWrkSpace_okbtn=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
                If objNewWrkSpace_okbtn.Exists = True then
                  objNewWrkSpace_okbtn.Click
                  Call sEdgeProcessor
                End If
            End If
          End If
          
          
          strTemp="WPFObject(""ContentControlEx"", ""Size of changes:"", 1)"
          Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarStaticItemLinkControl", "", 1).FindChild("Name",strTemp,9,True)
          If objNewWrkSpace_okbtn.Exists = True then
            strTCRemarks = strTCRemarks & "<br />" & "Size of change is found in Layout"
            log.Message "Size of Change is found in Layout"
          Else
            strTCRemarks = strTCRemarks & "<br />" & "Size of change is  not found in Layout"
            log.Message "Size of Change is not found in Layout"
          End If
          
          strTemp="WPFObject(""ContentControlEx"", ""Add Folder"", 2)"
          Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 4).WPFObject("BarButtonItemLinkControl", "", 1).FindChild("Name",strTemp,50,True)
          If objNewWrkSpace_okbtn.Exists = True then
            strTCRemarks = strTCRemarks & "<br />" & "Add Folder is found in Layout"
            log.Message "Add Folder is found in Layout"
          Else
            strTCRemarks = strTCRemarks & "<br />" & "Add Folder is  not found in Layout"
            log.Message "Add Folder is not found in Layout"
          End If
          
          strTemp="WPFObject(""ContentControlEx"", ""Delete Folder"", 2)"
          Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).FindChild("Name",strTemp,50,True)
          If objNewWrkSpace_okbtn.Exists = True then
            strTCRemarks = strTCRemarks & "<br />" & "Delete Folder is found in Layout"
            log.Message "Delete Folder is found in Layout"
          Else
            strTCRemarks = strTCRemarks & "<br />" & "Delete Folder is  not found in Layout"
            log.Message "Delete Folder is not found in Layout"
          End If
          
          strTemp="WPFObject(""ContentControlEx"", ""Copy Folder"", 2)"
           Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).FindChild("Name",strTemp,50,True)
          If objNewWrkSpace_okbtn.Exists = True then
            strTCRemarks = strTCRemarks & "<br />" & "Copy Folder is found in Layout"
            log.Message "Copy Folder is found in Layout"
          Else
            strTCRemarks = strTCRemarks & "<br />" & "Copy Folder is  not found in Layout"
            log.Message "Copy Folder is not found in Layout"
          End If

          strTemp="WPFObject(""ContentControlEx"", ""Cut Folder"", 2)"
          Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).FindChild("Name",strTemp,50,True)
          If objNewWrkSpace_okbtn.Exists = True then
            strTCRemarks = strTCRemarks & "<br />" & "Cut Folder is found in Layout"
            log.Message "Cut Folder is found in Layout"
          Else
            strTCRemarks = strTCRemarks & "<br />" & "Cut Folder is  not found in Layout"
            log.Message "Cut Folder is not found in Layout"
          End If
          call scloselayout
          strTemp="WPFObject(""ContentControlEx"", ""Paste Folder"", 2)"
          Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).FindChild("Name",strTemp,50,True)
          If objNewWrkSpace_okbtn.Exists = True then
            strTCRemarks = strTCRemarks & "<br />" & "Paste button is found in Layout"
            log.Message "Paste button is found in Layout"
          Else
            strTCRemarks = strTCRemarks & "<br />" & "Paste button is  not found in Layout"
            log.Message "Paste button is not found in Layout"
          End If
          
          strTemp="WPFObject(""ContentControlEx"", ""Workspace"", 2)"
          Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).FindChild("Name",strTemp,50,True)
          If objNewWrkSpace_okbtn.Exists = True then
            strTCRemarks = strTCRemarks & "<br />" & "Workspace button is found in Layout"
            log.Message "Workspace button is found in Layout"
          Else
            strTCRemarks = strTCRemarks & "<br />" & "Workspace button is  not found in Layout"
            log.Message "Workspace button is not found in Layout"
          End If
          
          strTemp="WPFObject(""ContentControlEx"", ""Find & Replace"", 2)"
          Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).FindChild("Name",strTemp,50,True)
          If objNewWrkSpace_okbtn.Exists = True then
            strTCRemarks = strTCRemarks & "<br />" & "Find & Replace  is found in Layout"
            log.Message "Find & Replace is found in Layout"
          Else
            strTCRemarks = strTCRemarks & "<br />" & "Find & Replace is  not found in Layout"
            log.Message "Find & Replace is not found in Layout"
          End If
          
          strTemp="WPFObject(""ContentControlEx"", ""Expand All"", 2)"
          Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).FindChild("Name",strTemp,50,True)
          If objNewWrkSpace_okbtn.Exists = True then
            strTCRemarks = strTCRemarks & "<br />" & "Expand All is found in Layout"
            log.Message "Expand All is found in Layout"
          Else
            strTCRemarks = strTCRemarks & "<br />" & "Expand All is  not found in Layout"
            log.Message "Expand All is not found in Layout"
          End If
          
          strTemp="WPFObject(""ContentControlEx"", ""Collapse All"", 2)"
          Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).FindChild("Name",strTemp,50,True)
          If objNewWrkSpace_okbtn.Exists = True then
            strTCRemarks = strTCRemarks & "<br />" & "Collapse All is found in Layout"
            log.Message "Collapse All is found in Layout"
          Else
            strTCRemarks = strTCRemarks & "<br />" & "Collapse All is  not found in Layout"
            log.Message "Collapse All is not found in Layout"
          End If
          
          strTemp="WPFObject(""ContentControlEx"", ""Number Table"", 2)"
          Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).FindChild("Name",strTemp,50,True)
          If objNewWrkSpace_okbtn.Exists = True then
            strTCRemarks = strTCRemarks & "<br />" & "Number Table is found in Layout"
            log.Message "Number Table is found in Layout"
          Else
            strTCRemarks = strTCRemarks & "<br />" & "Number Table is  not found in Layout"
            log.Message "Number Table is not found in Layout"
          End If
           
          Call scloseLayout
          Call scloseLayout
      End if 
  End If

End sub 
 Sub sCheckSrc(strParameters)
    Dim strTestcase
    strTestcase=getSplitValue(strParameters,"TESTCASE") 
    If strTestcase=1 then
      Call sCheckSrcOpenEdit(strParameters)
    Elseif strTestcase=2 then
      Call sCheckSrcOpenEditLabels(strParameters)
    Elseif strTestcase=3 then
      Call sCheckSrcOpenEditSearch(strParameters)
    Elseif strTestcase=4 then
      Call sCheckSrcOpenEditLabels(strParameters)
    Elseif strTestcase=5 then
      Call sCheckSrcOpenEditLabels(strParameters)
    Elseif strTestcase=6 then
     Call  sCheckSrcOpenEditExpandCollapse(strParameters)
    Elseif strTestcase=7 then
      Call sCheckSrcOpenEditExpandCollapse(strParameters)
    Elseif strTestcase=8 then
      Call sCheckSrcOpenEditSCExpandCollapse(strParameters)
    Elseif strTestcase=9 then
      Call sCheckSrcOpenEditFindReplace(strParameters)
    Elseif strTestcase=10 then
      Call sCheckSrcOpenEditFindReplace(strParameters)
    Elseif strTestcase=11 then
      Call sCheckSrcOpenEditFindReplaceText(strParameters)
    Elseif strTestcase=12 then
      Call sCheckSrcOpenEditFindReplaceNOText(strParameters)
    Elseif strTestcase=13 then
      Call sCheckSrcOpenEditFindReplaceNOText(strParameters)
    Elseif strTestcase=14 then
      Call sCheckSrcOpenEditFindReplaceNText(strParameters)
    Elseif strTestcase=15 then
      Call sCheckSrcOpenEditFindReplaceNText(strParameters)
    Elseif strTestcase=16 then 
      Call sCheckSrcOpenEditFindReplaceNText(strParameters)
    Elseif strTestcase=17 then
      Call sCheckSrcOpenEditFindReplaceNText(strParameters)  
    Elseif strTestcase=18 then
      Call sCheckSrcOpenEdit3LReplace(strParameters)
    Elseif strTestcase=19 then 
      Call sCheckSrcOpenEdit3LReplaceSelected(strParameters) 
    Elseif strTestcase=20 then
      Call sCheckSrcOpenEdit3LReplaceAll(strParameters)
    Elseif strTestcase=21 then
      Call sCheckSrcOpenEditFindReplaceNOText(strParameters)
    Elseif strTestcase=22 then
      Call sCheckSrcOpenEdit3LAddFolder(strParameters)
    Elseif strTestcase=23 then
      Call  sCheckSrcOpenEditAddFolder(strParameters)
    Elseif strTestcase=24 then
      Call sCheckSrcOpenEdit3LAddFolder(strParameters)
    Elseif strTestcase=25 then
      Call sCheckSrcOpenEdit3LAddFolder(strParameters)
    Elseif strTestcase=26 then
      Call sCheckSrcOpenEdit3LCopyFolder(strParameters)
    Elseif strTestcase=27 then
      Call sCheckSrcOpenEdit3LAddFolder(strParameters)
    Elseif strTestcase=28 then
      Call sCheckSrcOpenEdit3LAddFolder(strParameters)
    Elseif strTestcase=29 then
      Call sCheckSrcOpenEdit3LAdd(strParameters)
    Elseif strTestcase=30 then
      call sCheckSrcOpenEdit3LSCAdd(strParameters)
    Elseif strTestcase=31 then
      Call sCheckSrcOpenEdit2SourceType(strParameters)
    Elseif strTestcase=32 then
      Call sCheckSrcOpenEdit3SourceType(strParameters)
    Elseif strTestcase=33 then
      Call sCheckSrcOpenEdit2SourceType(strParameters)
    Elseif strTestcase=34 then
      Call  sCheckSrcOpenEdit3SourceTypeField(strParameters)
    Elseif strTestcase=35 then
      Call sCheckSrcOpenEdit2SourceType(strParameters)
    Elseif strTestcase=36 then
      Call sCheckSrcOpenEdit2SourceType(strParameters)
    Elseif strTestcase=37 then
      Call sCheckSrcOpenEdit2SourceType(strParameters)
    Elseif strTestcase=38 then
      Call sCheckSrcOpenEdit3SourceType(strParameters)
    Elseif strTestcase=39 then
      Call sCheckSrcOpenEdit3LAddZero(strParameters)
    Elseif strTestcase=40 then
      Call sCheckSrcOpenEdit3LAddZero(strParameters)
    Elseif strTestcase=41 then
      Call sCheckSrcOpenEdit3LInc(strParameters)
    Elseif strTestcase=42 then
      Call sCheckSrcOpenEdit3LSCAdd(strParameters)
    Elseif strTestcase=43 then
      Call sCheckSrcOpenEdit3LSCAdd(strParameters)
    Elseif strTestcase=44 then
       sCheckSrcOpenEdit3AddUpdate(strParameters)
    Elseif strTestcase=45 then
      Call sCheckSrcOpenEdit3LSCAdd(strParameters) 
    Elseif strTestcase=46 then
      Call sCheckSrcOpenEdit3LSCAdd(strParameters) 
    Elseif strTestcase=47 then
      Call sCheckSrcOpenEdit3LSCAddSave(strParameters)
    Elseif strTestcase=48 then
     Call  sCheckSrcOpenEdit3AddUpdate(strParameters)
    Elseif strTestcase=49 then
     Call  sCheckSrcOpenEdit3AddUpdate(strParameters)
    Elseif strTestcase=50 then
     Call sCheckSrcOpenEditMultiLLAddFolder(strParameters)
    Elseif strTestcase=51 then
      Call sCheckSrcOpenEdit3AddAllUpdate(strParameters)
    Elseif strTestcase=52 then
      Call sCheckSrcOpenEdit3Update(strParameters)
    Elseif strTestcase=53 then
      
    Elseif strTestcase=54 then
     
    Elseif strTestcase=55 then
     
    Elseif strTestcase=56 then
      
    Elseif strTestcase=57 then
      Call sHome_Source
      Call sCheckSrcSave(strParameters)
    Elseif strTestcase=58 then
      Call sHome_Source
      Call sCheckSrcSave(strParameters)
    Elseif strTestcase=59 then
     Call sCheckSrcOpenEdit3MacroFlag(strParameters)
    Elseif strTestcase=60 then
     Call sCheckSrcOpenEdit3MacroFlag(strParameters)
    Elseif strTestcase=61 then
     Call sChkSrcCopyPaste(strParameters)
    Elseif strTestcase=62 then
     Call sChkSrcCopyPasteSeries(strParameters)
    Elseif strTestcase=63 then
      Call sChkSrcCopyPasteAbove(strParameters)
    Elseif strTestcase=64 then
      Call sChkSrcCopyPasteAboveWithSeries(strParameters)
    Elseif strTestcase=65 then 
      Call sChkSrcCopyPasteBelow(strParameters)
    Elseif strTestcase=66 then
      Call sChkSrcCopyPasteBelowWithSeries(strParameters)
    Elseif strTestcase=67 then
      Call sChkSrcCutPasteAbove(strParameters)
    Elseif strTestcase=68 then
      Call sChkSrcCutPasteBelow(strParameters)
    Elseif strTestcase=69 then
      Call sChkSrcCutPasteInside(strParameters)
    Elseif strTestcase=70 then
      Call sChkSrcCopyPasteSH(strParameters)
    Elseif strTestcase=71 then
      Call sChkSrcCopyPasteAboveSH(strParameters)
    Elseif strTestcase=72 then
      Call sChkSrcCopyPasteBelowSH(strParameters)
    Elseif strTestcase=73 then
      Call sChkSrcCopyPasteAboveWithSeriesSH(strParameters)
    Elseif strTestcase=74 then
      Call sChkSrcCopyPasteBelowSH(strParameters)
    Elseif strTestcase=75 then
      Call sChkSrcCopyPasteInsideWithSeriesSH(strParameters)
    Elseif strTestcase=76 then
      Call sChkSrcCutPasteInsideSH(strParameters)
    Elseif strTestcase=77 then
      Call sChkSrcCutPasteAboveSH(strParameters)
    Elseif strTestcase=78 then
      Call sChkSrcCutPasteBelowSH(strParameters)
    Elseif strTestcase=79 then
      Call sCheckSrcOpenEdit3Delete(strParameters)
    Elseif strTestcase=80 then
      call sCheckSrcOpenEdit3DeleteSH(strParameters)
    Elseif strTestcase=81 then
      Call sCheckSrcOpenEditSeries(strParameters)
    Elseif strTestcase=82 then
      Call sHome_Source
      Call sSourceModule(strParameters)
    Elseif strTestcase=83 then
    Elseif strTestcase=84 then
    Elseif strTestcase=85 then
    Elseif strTestcase=86 then
    Elseif strTestcase=87 then
    Elseif strTestcase=88 then
    Elseif strTestcase=89 then
    Elseif strTestcase=90 then
    Elseif strTestcase=91 then
    Elseif strTestcase=92 then
    Elseif strTestcase=93 then
    Elseif strTestcase=94 then
    Elseif strTestcase=95 then
    Elseif strTestcase=96 then
    Elseif strTestcase=97 then
    Elseif strTestcase=98 then
    Elseif strTestcase=99 then
    Elseif strTestcase=100 then
    Elseif strTestcase=101 then
    Elseif strTestcase=102 then
    Elseif strTestcase=103 then
    Elseif strTestcase=104 then
    Elseif strTestcase=105 then
    Elseif strTestcase=106 then
    Elseif strTestcase=107 then
    Elseif strTestcase=108 then
    Elseif strTestcase=109 then
    End if
End sub


Sub  sCheckSrcOpenEditExpandCollapse(strParameters)
On Error Resume Next 
   Dim strSource1,StrSource2,strSource3,strTemp,GridControl,GridSourceTree,intTotNodeCnt,intI,intJ,intRow,intK,objEdge
   Dim objNewWorkspace,objWrkspace_popup,objOpenView,strTemp1,objNewWrkSpaceName,objNewWrkSpace_Txtbox,objNewWrkSpace_okbtn,objNewWrkSpace_Name
   Dim strDesc1,strDesc2,DescText,DescLocalText
   Dim objEditSource
   
    strSource1=getSplitValue(strParameters,"SOURCE")
    StrSource2=getSplitValue(strParameters,"LEVEL2SOURCE")

'    strSource1="Test"
'    StrSource2="Automation_UIT3"

    Call sHome_Source
    
    strDesc1=aqDateTime.Now
    strDesc2=aqDateTime.Now
    DescText=Replace(strDesc1,"/","-")
    DescText=Replace(DescText,":","_")
    DescLocalText=DescText
    strWrkSpaceName=DescText
'    intSeriesID=getSplitValue(strParameters,"SERIESID")
'    if intSeriesID=0 then
'      Call sSourceseries
'      intSeriesID=strSourceFileText
'    End if 
    
    strTemp="WPFObject(""SourceTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""SourceTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    Delay 10000,"Pls Wait.."
    ''Selecting Country Name
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
          GridControl.Nodes_2.Item(intI).Expand(True)
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description       
          blnFlag=False  
          Exit For
        End If
    Next
    If blnFlag = True then
      strTCRemarks="Country Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
  
    Delay 10000,"Pls Wait.."
        blnFlag = True 
    ''Selecting Level2Source_Name
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
  For intJ=0 to intTotNodeCnt-1
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(StrSource2) then
        GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
        intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
'        Call GridSourceTree.ClickCell(intRow, "Edit")
        Call GridControl.ClearSelectionCore
        Call GridControl.FocusViewAndRow(GridControl,intRow)
        GridControl.SetFocusOnCurrentItem
        Call GridControl.SelectRowCore(intRow)
        log.Message "Level2 Source Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
        blnFlag = False 
        Exit For
      End If
    Next
    If blnFlag = True then
      log.Message "Level2 Source Name not found"
      strTCRemarks="Level2 Source Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
    Delay 2000,"Pls Wait.."

    strTemp="WPFObject(""ArrowControl"", """", 1)"
    Set objNewWorkspace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,20,True)
    If objNewWorkspace.Exists = True then
      objNewWorkspace.Click
       strTemp="WPFObject(""BarPopupBorderControl"", """", 1)"
      Set objWrkspace_popup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").FindChild("Name",strTemp,5,True)
      If objWrkspace_popup.Exists = True then
        strTemp="WPFObject(""ContentControlEx"", ""Open For Edit (Source)"", 2)"
        Set objopenforEdit=objWrkspace_popup.FindChild("Name",strTemp,8,True)
        If objopenforEdit.Exists then
          objopenforEdit.Click    
          'Delay 20000,"Please Wait..."
        End If
      End if
      
      strTemp1="WPFObject(""HwndSource: WorkspaceNamePrompt"", ""Please provide a new Workspace Name"")"
      Set objNewWrkSpaceName=Sys.Process("EdgeClient").WaitChild(strTemp1,50000)
      If objNewWrkSpaceName.Exists = True then
     
      ''Waiting for Workspace Name prompt
      strTemp="WPFObject(""FloatingContainerBorder"")"
      Set objNewWrkSpace_Name=Sys.Process("EdgeClient").WPFObject("HwndSource: WorkspaceNamePrompt", "Please provide a new Workspace Name").WPFObject("WorkspaceNamePrompt", "Please provide a new Workspace Name", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,15000000)
      If objNewWrkSpace_Name.Exists = True then
          strTemp="WPFObject(""ChangeNameTextEdit"")"
          ''Entering Workspace Name
          Set objNewWrkSpace_Txtbox=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
            If objNewWrkSpace_Txtbox.Exists = True then
              objNewWrkSpace_Txtbox.Click
              objNewWrkSpace_Txtbox.Text=strWrkSpaceName
      '        strTCRemarks=strTCRemarks & Chr(10) & "Entered Workspace Name - " & strWrkSpaceName
              ''Clicking on Ok Button 
              strTemp="WPFObject(""OkButton"")"
              Set objNewWrkSpace_okbtn=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
              If objNewWrkSpace_okbtn.Exists = True then
                objNewWrkSpace_okbtn.Click
                'Delay 5000,"Please wait..."
              End If
            End If
        End If
      End if 
     End if 
       Delay 15000,"Pls Wait.."
      Call SClosesource()
      Delay 5000,"Pls Wait.."
  
    strTemp="WPFObject(""SourceTreeListView"")"
    objEditSource=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WaitChild(strTemp,15000000)
    if objEditSource.Exists = True then
                 
          strTemp="WPFObject(""ContentControlEx"", ""Expand All"", 2)"
          Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 13).WPFObject("BarButtonItemLinkControl", "", 1).FindChild("Name",strTemp,50,True)
          If objNewWrkSpace_okbtn.Exists = True then
             If objNewWrkSpace_okbtn.Enabled = True then
              strTCRemarks = strTCRemarks & "<br />" & "Expand All is found in Source"
              log.Message "Expand All is found in Source"
              objNewWrkSpace_okbtn.Click
              strTCRemarks = strTCRemarks & "<br />" & "Expand All nodes in Source"
             Else
               strTCRemarks = strTCRemarks & "<br />" & "Expand All is Disabled in Source"
              log.Message "Expand All is Disabled in Source"
             End if 
          Else
            strTCRemarks = strTCRemarks & "<br />" & "Expand All is  not found in Layout"
            log.Message "Expand All is not found in Layout"
          End If
          
          strTemp="WPFObject(""ContentControlEx"", ""Collapse All"", 2)"
          Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 14).WPFObject("BarButtonItemLinkControl", "", 1).FindChild("Name",strTemp,50,True)
          If objNewWrkSpace_okbtn.Exists = True then
             If objNewWrkSpace_okbtn.Enabled = True then
              strTCRemarks = strTCRemarks & "<br />" & "Collapse All is found in Source"
              log.Message "Collapse All is found in Source"
              objNewWrkSpace_okbtn.Click
              strTCRemarks = strTCRemarks & "<br />" & "Expand All nodes in Source"
             Else
              strTCRemarks = strTCRemarks & "<br />" & "Collapse All is Disabled in Source"
              log.Message "Collapse All is Disabled in Source"
             End if 
          Else
            strTCRemarks = strTCRemarks & "<br />" & "Collapse All is  not found in Source"
            log.Message "Collapse All is not found in Source"
          End If
          
    End if
 
  Call SClosesource()
  Call SourceWorkSpacevwr()
End Sub
Sub  sCheckSrcOpenEditSCExpandCollapse(strParameters)
On Error Resume Next 
   Dim strSource1,StrSource2,strSource3,strTemp,GridControl,GridSourceTree,intTotNodeCnt,intI,intJ,intRow,intK,objEdge
   Dim objNewWorkspace,objWrkspace_popup,objOpenView,strTemp1,objNewWrkSpaceName,objNewWrkSpace_Txtbox,objNewWrkSpace_okbtn,objNewWrkSpace_Name
   Dim strDesc1,strDesc2,DescText,DescLocalText
   Dim objEditSource
   
    strSource1=getSplitValue(strParameters,"SOURCE")
    StrSource2=getSplitValue(strParameters,"LEVEL2SOURCE")

'    strSource1="Test"
'    StrSource2="Automation_UIT3"

    Call sHome_Source
    
    strDesc1=aqDateTime.Now
    strDesc2=aqDateTime.Now
    DescText=Replace(strDesc1,"/","-")
    DescText=Replace(DescText,":","_")
    DescLocalText=DescText
    strWrkSpaceName=DescText
'    intSeriesID=getSplitValue(strParameters,"SERIESID")
'    if intSeriesID=0 then
'      Call sSourceseries
'      intSeriesID=strSourceFileText
'    End if 
    
    strTemp="WPFObject(""SourceTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""SourceTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    Delay 10000,"Pls Wait.."
    ''Selecting Country Name
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
          GridControl.Nodes_2.Item(intI).Expand(True)
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description       
          blnFlag=False  
          Exit For
        End If
    Next
    If blnFlag = True then
      strTCRemarks="Country Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
  
    Delay 10000,"Pls Wait.."
        blnFlag = True 
    ''Selecting Level2Source_Name
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
  For intJ=0 to intTotNodeCnt-1
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(StrSource2) then
        GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
        intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
'        Call GridSourceTree.ClickCell(intRow, "Edit")
        Call GridControl.ClearSelectionCore
        Call GridControl.FocusViewAndRow(GridControl,intRow)
        GridControl.SetFocusOnCurrentItem
        Call GridControl.SelectRowCore(intRow)
        log.Message "Level2 Source Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
        blnFlag = False 
        Exit For
      End If
    Next
    If blnFlag = True then
      log.Message "Level2 Source Name not found"
      strTCRemarks="Level2 Source Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
    Delay 2000,"Pls Wait.."

    strTemp="WPFObject(""ArrowControl"", """", 1)"
    Set objNewWorkspace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,20,True)
    If objNewWorkspace.Exists = True then
      objNewWorkspace.Click
       strTemp="WPFObject(""BarPopupBorderControl"", """", 1)"
      Set objWrkspace_popup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").FindChild("Name",strTemp,5,True)
      If objWrkspace_popup.Exists = True then
        strTemp="WPFObject(""ContentControlEx"", ""Open For Edit (Source)"", 2)"
        Set objopenforEdit=objWrkspace_popup.FindChild("Name",strTemp,8,True)
        If objopenforEdit.Exists then
          objopenforEdit.Click    
          'Delay 20000,"Please Wait..."
        End If
      End if
      
      strTemp1="WPFObject(""HwndSource: WorkspaceNamePrompt"", ""Please provide a new Workspace Name"")"
      Set objNewWrkSpaceName=Sys.Process("EdgeClient").WaitChild(strTemp1,50000)
      If objNewWrkSpaceName.Exists = True then
     
      ''Waiting for Workspace Name prompt
      strTemp="WPFObject(""FloatingContainerBorder"")"
      Set objNewWrkSpace_Name=Sys.Process("EdgeClient").WPFObject("HwndSource: WorkspaceNamePrompt", "Please provide a new Workspace Name").WPFObject("WorkspaceNamePrompt", "Please provide a new Workspace Name", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,15000000)
      If objNewWrkSpace_Name.Exists = True then
          strTemp="WPFObject(""ChangeNameTextEdit"")"
          ''Entering Workspace Name
          Set objNewWrkSpace_Txtbox=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
            If objNewWrkSpace_Txtbox.Exists = True then
              objNewWrkSpace_Txtbox.Click
              objNewWrkSpace_Txtbox.Text=strWrkSpaceName
      '        strTCRemarks=strTCRemarks & Chr(10) & "Entered Workspace Name - " & strWrkSpaceName
              ''Clicking on Ok Button 
              strTemp="WPFObject(""OkButton"")"
              Set objNewWrkSpace_okbtn=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
              If objNewWrkSpace_okbtn.Exists = True then
                objNewWrkSpace_okbtn.Click
                'Delay 5000,"Please wait..."
              End If
            End If
        End If
      End if 
     End if 
       
  
       ''Handling Validation for Source
    strTemp="WPFObject(""HwndSource: WindowContentHolder"", """")"
    Set objTemp=Sys.Process("EdgeClient").WaitChild(strTemp,10000)
    If objTemp.Exists = True then
      objTemp.Keys "[Enter]"
      strTestCaseResult = "FAIL"
      Exit Sub
    End If

    ''WorkSpace Edit Window
    strTemp="WPFObject(""LayoutPanel"", """", 2)"
    Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,13,True)
    If objTemp.Exists then
        Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WPFObject("SourceTreeListView")
        Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl")

        ''Expanding First Node in Tree      
        intTotNodeCnt=GridControl.Nodes_2.Count  
        For intI=0 to intTotNodeCnt-1         
          If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
           ' GridControl.Nodes_2.Item(intI).Expand(True)
           GridControl.Keys "^[Home]"
            blnFlag=False  
            Exit For
          End If
        Next
        
        End if
        
        Delay 15000,"Pls Wait.."
      Call SClosesource()
      Delay 5000,"Pls Wait.."
    
    strTemp="WPFObject(""SourceTreeListView"")"
    objEditSource=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WaitChild(strTemp,15000000)
    if objEditSource.Exists = True then
                 
          strTemp="WPFObject(""ContentControlEx"", ""Expand All"", 2)"
          Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 13).WPFObject("BarButtonItemLinkControl", "", 1).FindChild("Name",strTemp,50,True)
          If objNewWrkSpace_okbtn.Exists = True then
             If objNewWrkSpace_okbtn.Enabled = True then
              strTCRemarks = strTCRemarks & "<br />" & "Expand All is found in Source"
              log.Message "Expand All is found in Source"
              SYS.Keys("^e")
              Delay(10000)
             ' objNewWrkSpace_okbtn.Click
              strTCRemarks = strTCRemarks & "<br />" & "Expand All nodes in Source"
             Else
               strTCRemarks = strTCRemarks & "<br />" & "Expand All is Disabled in Source"
              log.Message "Expand All is Disabled in Source"
             End if 
          Else
            strTCRemarks = strTCRemarks & "<br />" & "Expand All is  not found in Layout"
            log.Message "Expand All is not found in Layout"
          End If
          
          strTemp="WPFObject(""ContentControlEx"", ""Collapse All"", 2)"
          Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 14).WPFObject("BarButtonItemLinkControl", "", 1).FindChild("Name",strTemp,50,True)
          If objNewWrkSpace_okbtn.Exists = True then
             If objNewWrkSpace_okbtn.Enabled = True then
              strTCRemarks = strTCRemarks & "<br />" & "Collapse All is found in Source"
              log.Message "Collapse All is found in Source"
              'objNewWrkSpace_okbtn.Click
               SYS.Keys("^e")
              Delay(10000)
              strTCRemarks = strTCRemarks & "<br />" & "Expand All nodes in Source"
             Else
              strTCRemarks = strTCRemarks & "<br />" & "Collapse All is Disabled in Source"
              log.Message "Collapse All is Disabled in Source"
             End if 
          Else
            strTCRemarks = strTCRemarks & "<br />" & "Collapse All is  not found in Source"
            log.Message "Collapse All is not found in Source"
          End If
          
    End if
 
  Call SClosesource()
  Call SourceWorkSpacevwr()
End Sub

Sub  sCheckSrcOpenEditFindReplace(strParameters)
On Error Resume Next 
   Dim strSource1,StrSource2,strSource3,strTemp,GridControl,GridSourceTree,intTotNodeCnt,intI,intJ,intRow,intK,objEdge
   Dim objNewWorkspace,objWrkspace_popup,objOpenView,strTemp1,objNewWrkSpaceName,objNewWrkSpace_Txtbox,objNewWrkSpace_okbtn,objNewWrkSpace_Name
   Dim strDesc1,strDesc2,DescText,DescLocalText
   Dim objEditSource
   
    strSource1=getSplitValue(strParameters,"SOURCE")
    StrSource2=getSplitValue(strParameters,"LEVEL2SOURCE")

'    strSource1="Test"
'    StrSource2="Automation_UIT3"

    Call sHome_Source
    
    strDesc1=aqDateTime.Now
    strDesc2=aqDateTime.Now
    DescText=Replace(strDesc1,"/","-")
    DescText=Replace(DescText,":","_")
    DescLocalText=DescText
    strWrkSpaceName=DescText
'    intSeriesID=getSplitValue(strParameters,"SERIESID")
'    if intSeriesID=0 then
'      Call sSourceseries
'      intSeriesID=strSourceFileText
'    End if 
'    
    strTemp="WPFObject(""SourceTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""SourceTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    Delay 10000,"Pls Wait.."
    ''Selecting Country Name
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
          GridControl.Nodes_2.Item(intI).Expand(True)
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description       
          blnFlag=False  
          Exit For
        End If
    Next
    If blnFlag = True then
      strTCRemarks="Country Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
  
    Delay 10000,"Pls Wait.."
        blnFlag = True 
    ''Selecting Level2Source_Name
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
  For intJ=0 to intTotNodeCnt-1
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(StrSource2) then
        GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
        intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
'        Call GridSourceTree.ClickCell(intRow, "Edit")
        Call GridControl.ClearSelectionCore
        Call GridControl.FocusViewAndRow(GridControl,intRow)
        GridControl.SetFocusOnCurrentItem
        Call GridControl.SelectRowCore(intRow)
        log.Message "Level2 Source Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
        blnFlag = False 
        Exit For
      End If
    Next
    If blnFlag = True then
      log.Message "Level2 Source Name not found"
      strTCRemarks="Level2 Source Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
    Delay 2000,"Pls Wait.."

    strTemp="WPFObject(""ArrowControl"", """", 1)"
    Set objNewWorkspace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,20,True)
    If objNewWorkspace.Exists = True then
      objNewWorkspace.Click
       strTemp="WPFObject(""BarPopupBorderControl"", """", 1)"
      Set objWrkspace_popup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").FindChild("Name",strTemp,5,True)
      If objWrkspace_popup.Exists = True then
        strTemp="WPFObject(""ContentControlEx"", ""Open For Edit (Source)"", 2)"
        Set objopenforEdit=objWrkspace_popup.FindChild("Name",strTemp,8,True)
        If objopenforEdit.Exists then
          objopenforEdit.Click    
          'Delay 20000,"Please Wait..."
        End If
      End if
      
      strTemp1="WPFObject(""HwndSource: WorkspaceNamePrompt"", ""Please provide a new Workspace Name"")"
      Set objNewWrkSpaceName=Sys.Process("EdgeClient").WaitChild(strTemp1,50000)
      If objNewWrkSpaceName.Exists = True then
     
      ''Waiting for Workspace Name prompt
      strTemp="WPFObject(""FloatingContainerBorder"")"
      Set objNewWrkSpace_Name=Sys.Process("EdgeClient").WPFObject("HwndSource: WorkspaceNamePrompt", "Please provide a new Workspace Name").WPFObject("WorkspaceNamePrompt", "Please provide a new Workspace Name", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,15000000)
      If objNewWrkSpace_Name.Exists = True then
          strTemp="WPFObject(""ChangeNameTextEdit"")"
          ''Entering Workspace Name
          Set objNewWrkSpace_Txtbox=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
            If objNewWrkSpace_Txtbox.Exists = True then
              objNewWrkSpace_Txtbox.Click
              objNewWrkSpace_Txtbox.Text=strWrkSpaceName
      '        strTCRemarks=strTCRemarks & Chr(10) & "Entered Workspace Name - " & strWrkSpaceName
              ''Clicking on Ok Button 
              strTemp="WPFObject(""OkButton"")"
              Set objNewWrkSpace_okbtn=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
              If objNewWrkSpace_okbtn.Exists = True then
                objNewWrkSpace_okbtn.Click
                'Delay 5000,"Please wait..."
              End If
            End If
        End If
      End if 
     End if 
       
  
       ''Handling Validation for Source
    strTemp="WPFObject(""HwndSource: WindowContentHolder"", """")"
    Set objTemp=Sys.Process("EdgeClient").WaitChild(strTemp,10000)
    If objTemp.Exists = True then
      objTemp.Keys "[Enter]"
      strTestCaseResult = "FAIL"
      Exit Sub
    End If

    ''WorkSpace Edit Window
    strTemp="WPFObject(""LayoutPanel"", """", 2)"
    Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,13,True)
    If objTemp.Exists then
        Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WPFObject("SourceTreeListView")
        Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl")

        ''Expanding First Node in Tree      
        intTotNodeCnt=GridControl.Nodes_2.Count  
        For intI=0 to intTotNodeCnt-1         
          If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
           ' GridControl.Nodes_2.Item(intI).Expand(True)
           GridControl.Keys "^[Home]"
            blnFlag=False  
            Exit For
          End If
        Next
        
        End if
        
        Delay 15000,"Pls Wait.."
      Call SClosesource()
      Delay 5000,"Pls Wait.."
    
    strTemp="WPFObject(""SourceTreeListView"")"
    objEditSource=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WaitChild(strTemp,15000000)
    if objEditSource.Exists = True then
                 
          strTemp="WPFObject(""ContentControlEx"", ""Find & Replace"", 2)"
          Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 12).WPFObject("BarButtonItemLinkControl", "", 1).FindChild("Name",strTemp,50,True)
          If objNewWrkSpace_okbtn.Exists = True then
             If objNewWrkSpace_okbtn.Enabled = True then
              strTCRemarks = strTCRemarks & "<br />" & "Find & Replace  is found in Source"
              log.Message "Find & Replace is found in Source"
              objNewWrkSpace_okbtn.Click
               strTCRemarks = strTCRemarks & "<br />" & "Find & Replace  form opened in Source"
              log.Message "Find & Replace form opened in Source"
              strTemp="WPFObject(""PART_ContainerContent"")"
              Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: SearchWindow", "Find").WPFObject("SearchWindow", "Find", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").FindChild("Name",strTemp,50,True)
               If objNewWrkSpace_okbtn.Exists = True then
               
                  strTemp="WPFObject(""Label"", ""Find What:"", 1)"
                  Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: SearchWindow", "Find").WPFObject("SearchWindow", "Find", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).FindChild("Name",strTemp,50,True)
                  If objNewWrkSpace_okbtn.Exists = True then
                     If objNewWrkSpace_okbtn.Enabled = True then
                      strTCRemarks = strTCRemarks & "<br />" & "Find What  is found in Find"
                      log.Message "Find What is found in Find"
                      End if
                  End if
                  
                  strTemp="WPFObject(""Label"", ""Replace with:"", 2)"
                  Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: SearchWindow", "Find").WPFObject("SearchWindow", "Find", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).FindChild("Name",strTemp,50,True)
                  If objNewWrkSpace_okbtn.Exists = True then
                     If objNewWrkSpace_okbtn.Enabled = True then
                      strTCRemarks = strTCRemarks & "<br />" & "Replace with is found in Find"
                      log.Message "Replace with is found in Find"
                      End if
                  End if
                  
                  strTemp="WPFObject(""Button"", ""Find Next"", 1)"
                  Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: SearchWindow", "Find").WPFObject("SearchWindow", "Find", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).FindChild("Name",strTemp,50,True)
                  If objNewWrkSpace_okbtn.Exists = True then
                     If objNewWrkSpace_okbtn.Enabled = True then
                      strTCRemarks = strTCRemarks & "<br />" & "Find Next  is found in Find"
                      log.Message "Find Next is found in Find"
                      End if
                  End if
                  
                  strTemp="WPFObject(""Button"", ""Replace"", 2)"
                  Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: SearchWindow", "Find").WPFObject("SearchWindow", "Find", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).FindChild("Name",strTemp,50,True)
                  If objNewWrkSpace_okbtn.Exists = True then
                     If objNewWrkSpace_okbtn.Enabled = True then
                      strTCRemarks = strTCRemarks & "<br />" & "Replace is found in Find"
                      log.Message "Replace is found in Find"
                      End if
                  End if
                  
                  strTemp="WPFObject(""Button"", ""Replace Selected"", 3)"
                  Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: SearchWindow", "Find").WPFObject("SearchWindow", "Find", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).FindChild("Name",strTemp,50,True)
                  If objNewWrkSpace_okbtn.Exists = True then
                     If objNewWrkSpace_okbtn.Enabled = True then
                      strTCRemarks = strTCRemarks & "<br />" & "Replace Selected  is found in Find"
                      log.Message "Replace Selected is found in Find"
                      End if
                  End if
                  
                   strTemp="WPFObject(""Button"", ""Replace All"", 4)"
                  Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: SearchWindow", "Find").WPFObject("SearchWindow", "Find", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).FindChild("Name",strTemp,50,True)
                  If objNewWrkSpace_okbtn.Exists = True then
                     If objNewWrkSpace_okbtn.Enabled = True then
                      strTCRemarks = strTCRemarks & "<br />" & "Replace All  is found in Find"
                      log.Message "Replace All is found in Find"
                      End if
                  End if
                  
                  
                  strTemp="WPFObject(""PART_CloseButton"")"
                  Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: SearchWindow", "Find").WPFObject("SearchWindow", "Find", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("PART_Header").WPFObject("Grid", "", 1).WPFObject("stackPanel").FindChild("Name",strTemp,50,True)
                  If objNewWrkSpace_okbtn.Exists = True then
                     If objNewWrkSpace_okbtn.Enabled = True then
                      strTCRemarks = strTCRemarks & "<br />" & "Close button  is found in Find"
                      log.Message "Close button is found in Find"
                      objNewWrkSpace_okbtn.Click
                      End if
                  End if
              End if  
              
             Else
              strTCRemarks = strTCRemarks & "<br />" & "Find & Replace  is Disabled in Source"
              log.Message "Find & Replace is Disabled in Source"
             End if
          Else
            strTCRemarks = strTCRemarks & "<br />" & "Find & Replace is  not found in Source"
            log.Message "Find & Replace is not found in Source"
          End If
          
          
         ' Sys.Process("EdgeClient").WPFObject("HwndSource: SearchWindow", "Find").WPFObject("SearchWindow", "Find", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("PART_Header").WPFObject("Grid", "", 1).WPFObject("stackPanel").WPFObject("PART_CloseButton")
                  
    End if
 
  Call SClosesource()
  Call SourceWorkSpacevwr()
End Sub
Sub  sCheckSrcOpenEditFindReplaceText(strParameters)
On Error Resume Next 
   Dim strSource1,StrSource2,strSource3,strTemp,GridControl,GridSourceTree,intTotNodeCnt,intI,intJ,intRow,intK,objEdge
   Dim objNewWorkspace,objWrkspace_popup,objOpenView,strTemp1,objNewWrkSpaceName,objNewWrkSpace_Txtbox,objNewWrkSpace_okbtn,objNewWrkSpace_Name
   Dim strDesc1,strDesc2,DescText,DescLocalText
   Dim objEditSource
   
    strSource1=getSplitValue(strParameters,"SOURCE")
    StrSource2=getSplitValue(strParameters,"LEVEL2SOURCE")

'    strSource1="Test"
'    StrSource2="Automation_UIT3"

    Call sHome_Source
    
    strDesc1=aqDateTime.Now
    strDesc2=aqDateTime.Now
    DescText=Replace(strDesc1,"/","-")
    DescText=Replace(DescText,":","_")
    DescLocalText=DescText
    strWrkSpaceName=DescText
'    intSeriesID=getSplitValue(strParameters,"SERIESID")
'    if intSeriesID=0 then
'      Call sSourceseries
'      intSeriesID=strSourceFileText
'    End if 
    
    strTemp="WPFObject(""SourceTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""SourceTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    Delay 10000,"Pls Wait.."
    ''Selecting Country Name
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
          GridControl.Nodes_2.Item(intI).Expand(True)
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description       
          blnFlag=False  
          Exit For
        End If
    Next
    If blnFlag = True then
      strTCRemarks="Country Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
  
    Delay 10000,"Pls Wait.."
        blnFlag = True 
    ''Selecting Level2Source_Name
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
  For intJ=0 to intTotNodeCnt-1
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(StrSource2) then
        GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
        intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
'        Call GridSourceTree.ClickCell(intRow, "Edit")
        Call GridControl.ClearSelectionCore
        Call GridControl.FocusViewAndRow(GridControl,intRow)
        GridControl.SetFocusOnCurrentItem
        Call GridControl.SelectRowCore(intRow)
        log.Message "Level2 Source Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
        blnFlag = False 
        Exit For
      End If
    Next
    If blnFlag = True then
      log.Message "Level2 Source Name not found"
      strTCRemarks="Level2 Source Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
    Delay 2000,"Pls Wait.."

    strTemp="WPFObject(""ArrowControl"", """", 1)"
    Set objNewWorkspace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,20,True)
    If objNewWorkspace.Exists = True then
      objNewWorkspace.Click
       strTemp="WPFObject(""BarPopupBorderControl"", """", 1)"
      Set objWrkspace_popup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").FindChild("Name",strTemp,5,True)
      If objWrkspace_popup.Exists = True then
        strTemp="WPFObject(""ContentControlEx"", ""Open For Edit (Source)"", 2)"
        Set objopenforEdit=objWrkspace_popup.FindChild("Name",strTemp,8,True)
        If objopenforEdit.Exists then
          objopenforEdit.Click    
          'Delay 20000,"Please Wait..."
        End If
      End if
      
      strTemp1="WPFObject(""HwndSource: WorkspaceNamePrompt"", ""Please provide a new Workspace Name"")"
      Set objNewWrkSpaceName=Sys.Process("EdgeClient").WaitChild(strTemp1,50000)
      If objNewWrkSpaceName.Exists = True then
     
      ''Waiting for Workspace Name prompt
      strTemp="WPFObject(""FloatingContainerBorder"")"
      Set objNewWrkSpace_Name=Sys.Process("EdgeClient").WPFObject("HwndSource: WorkspaceNamePrompt", "Please provide a new Workspace Name").WPFObject("WorkspaceNamePrompt", "Please provide a new Workspace Name", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,15000000)
      If objNewWrkSpace_Name.Exists = True then
          strTemp="WPFObject(""ChangeNameTextEdit"")"
          ''Entering Workspace Name
          Set objNewWrkSpace_Txtbox=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
            If objNewWrkSpace_Txtbox.Exists = True then
              objNewWrkSpace_Txtbox.Click
              objNewWrkSpace_Txtbox.Text=strWrkSpaceName
      '        strTCRemarks=strTCRemarks & Chr(10) & "Entered Workspace Name - " & strWrkSpaceName
              ''Clicking on Ok Button 
              strTemp="WPFObject(""OkButton"")"
              Set objNewWrkSpace_okbtn=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
              If objNewWrkSpace_okbtn.Exists = True then
                objNewWrkSpace_okbtn.Click
                'Delay 5000,"Please wait..."
              End If
            End If
        End If
      End if 
     End if 
       
  
       ''Handling Validation for Source
    strTemp="WPFObject(""HwndSource: WindowContentHolder"", """")"
    Set objTemp=Sys.Process("EdgeClient").WaitChild(strTemp,10000)
    If objTemp.Exists = True then
      objTemp.Keys "[Enter]"
      strTestCaseResult = "FAIL"
      Exit Sub
    End If

    ''WorkSpace Edit Window
    strTemp="WPFObject(""LayoutPanel"", """", 2)"
    Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,13,True)
    If objTemp.Exists then
        Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WPFObject("SourceTreeListView")
        Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl")

        ''Expanding First Node in Tree      
        intTotNodeCnt=GridControl.Nodes_2.Count  
        For intI=0 to intTotNodeCnt-1         
          If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
           ' GridControl.Nodes_2.Item(intI).Expand(True)
           GridControl.Keys "^[Home]"
            blnFlag=False  
            Exit For
          End If
        Next
        
        End if
        
        Delay 15000,"Pls Wait.."
      Call SClosesource()
      Delay 5000,"Pls Wait.."
    
    strTemp="WPFObject(""SourceTreeListView"")"
    objEditSource=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WaitChild(strTemp,15000000)
    if objEditSource.Exists = True then
                 
          strTemp="WPFObject(""ContentControlEx"", ""Find & Replace"", 2)"
          Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 12).WPFObject("BarButtonItemLinkControl", "", 1).FindChild("Name",strTemp,50,True)
          If objNewWrkSpace_okbtn.Exists = True then
             If objNewWrkSpace_okbtn.Enabled = True then
              strTCRemarks = strTCRemarks & "<br />" & "Find & Replace  is found in Source"
              log.Message "Find & Replace is found in Source"
              objNewWrkSpace_okbtn.Click
               strTCRemarks = strTCRemarks & "<br />" & "Find & Replace  form opened in Source"
              log.Message "Find & Replace form opened in Source"
              strTemp="WPFObject(""PART_ContainerContent"")"
              Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: SearchWindow", "Find").WPFObject("SearchWindow", "Find", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").FindChild("Name",strTemp,50,True)
               If objNewWrkSpace_okbtn.Exists = True then
               
                  strTemp="WPFObject(""Label"", ""Find What:"", 1)"
                  Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: SearchWindow", "Find").WPFObject("SearchWindow", "Find", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).FindChild("Name",strTemp,50,True)
                  If objNewWrkSpace_okbtn.Exists = True then
                     If objNewWrkSpace_okbtn.Enabled = True then
                      strTCRemarks = strTCRemarks & "<br />" & "Find What  is found in Find"
                      log.Message "Find What is found in Find"
                      End if
                  End if
                  
                  strTemp="WPFObject(""Label"", ""Replace with:"", 2)"
                  Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: SearchWindow", "Find").WPFObject("SearchWindow", "Find", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).FindChild("Name",strTemp,50,True)
                  If objNewWrkSpace_okbtn.Exists = True then
                     If objNewWrkSpace_okbtn.Enabled = True then
                      strTCRemarks = strTCRemarks & "<br />" & "Replace with is found in Find"
                      log.Message "Replace with is found in Find"
                      End if
                  End if
                  
                  strTemp="WPFObject(""Button"", ""Find Next"", 1)"
                  Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: SearchWindow", "Find").WPFObject("SearchWindow", "Find", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).FindChild("Name",strTemp,50,True)
                  If objNewWrkSpace_okbtn.Exists = True then
                     If objNewWrkSpace_okbtn.Enabled = True then
                      strTCRemarks = strTCRemarks & "<br />" & "Find Next  is found in Find"
                      log.Message "Find Next is found in Find"
                      End if
                  End if
                  
                  strTemp="WPFObject(""Button"", ""Replace"", 2)"
                  Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: SearchWindow", "Find").WPFObject("SearchWindow", "Find", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).FindChild("Name",strTemp,50,True)
                  If objNewWrkSpace_okbtn.Exists = True then
                     If objNewWrkSpace_okbtn.Enabled = True then
                      strTCRemarks = strTCRemarks & "<br />" & "Replace is found in Find"
                      log.Message "Replace is found in Find"
                      End if
                  End if
                  
                  strTemp="WPFObject(""Button"", ""Replace Selected"", 3)"
                  Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: SearchWindow", "Find").WPFObject("SearchWindow", "Find", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).FindChild("Name",strTemp,50,True)
                  If objNewWrkSpace_okbtn.Exists = True then
                     If objNewWrkSpace_okbtn.Enabled = True then
                      strTCRemarks = strTCRemarks & "<br />" & "Replace Selected  is found in Find"
                      log.Message "Replace Selected is found in Find"
                      End if
                  End if
                  
                   strTemp="WPFObject(""Button"", ""Replace All"", 4)"
                  Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: SearchWindow", "Find").WPFObject("SearchWindow", "Find", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).FindChild("Name",strTemp,50,True)
                  If objNewWrkSpace_okbtn.Exists = True then
                     If objNewWrkSpace_okbtn.Enabled = True then
                      strTCRemarks = strTCRemarks & "<br />" & "Replace All  is found in Find"
                      log.Message "Replace All is found in Find"
                      End if
                  End if
                  
                  
                  strTemp="WPFObject(""FindText"")"
                  Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: SearchWindow", "Find").WPFObject("SearchWindow", "Find", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).FindChild("Name",strTemp,50,True)
                  If objNewWrkSpace_okbtn.Exists = True then
                    Sys.Process("EdgeClient").WPFObject("HwndSource: SearchWindow", "Find").WPFObject("SearchWindow", "Find", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("FindText").Text=strSource1
                     strTemp="WPFObject(""Button"", ""Find Next"", 1)"
                      Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: SearchWindow", "Find").WPFObject("SearchWindow", "Find", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).FindChild("Name",strTemp,50,True)
                      If objNewWrkSpace_okbtn.Exists = True then
                         If objNewWrkSpace_okbtn.Enabled = True then
                          objNewWrkSpace_okbtn.Click
                          strTCRemarks = strTCRemarks & "<br />" & "Find Next is Clicked in Find"
                          log.Message "Find Next text is highlighted in Form"
                          strTCRemarks = strTCRemarks & "<br />" & "Find Next text highlighted in Form"
                          log.Message "Find Next is found in Find"
                          End if
                      End if
                  end if 
                  strTemp="WPFObject(""PART_CloseButton"")"
                  Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: SearchWindow", "Find").WPFObject("SearchWindow", "Find", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("PART_Header").WPFObject("Grid", "", 1).WPFObject("stackPanel").FindChild("Name",strTemp,50,True)
                  If objNewWrkSpace_okbtn.Exists = True then
                     If objNewWrkSpace_okbtn.Enabled = True then
                      strTCRemarks = strTCRemarks & "<br />" & "Close button  is found in Find"
                      log.Message "Close button is found in Find"
                      objNewWrkSpace_okbtn.Click
                      End if
                  End if
              End if  
              
             Else
              strTCRemarks = strTCRemarks & "<br />" & "Find & Replace  is Disabled in Source"
              log.Message "Find & Replace is Disabled in Source"
             End if
          Else
            strTCRemarks = strTCRemarks & "<br />" & "Find & Replace is  not found in Source"
            log.Message "Find & Replace is not found in Source"
          End If
                  
    End if
 
  Call SClosesource()
  Call SourceWorkSpacevwr()
End Sub
Sub  sCheckSrcOpenEditFindReplaceNText(strParameters)
On Error Resume Next 
   Dim strSource1,StrSource2,strSource3,strTemp,GridControl,GridSourceTree,intTotNodeCnt,intI,intJ,intRow,intK,objEdge
   Dim objNewWorkspace,objWrkspace_popup,objOpenView,strTemp1,objNewWrkSpaceName,objNewWrkSpace_Txtbox,objNewWrkSpace_okbtn,objNewWrkSpace_Name
   Dim strDesc1,strDesc2,DescText,DescLocalText
   Dim objEditSource
   
    strSource1=getSplitValue(strParameters,"SOURCE")
    StrSource2=getSplitValue(strParameters,"LEVEL2SOURCE")

'    strSource1="Test"
'    StrSource2="Automation_UIT3"

    Call sHome_Source
    
    strDesc1=aqDateTime.Now
    strDesc2=aqDateTime.Now
    DescText=Replace(strDesc1,"/","-")
    DescText=Replace(DescText,":","_")
    DescLocalText=DescText
    strWrkSpaceName=DescText
'    intSeriesID=getSplitValue(strParameters,"SERIESID")
'    if intSeriesID=0 then
'      Call sSourceseries
'      intSeriesID=strSourceFileText
'    End if 
    
    strTemp="WPFObject(""SourceTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""SourceTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    Delay 10000,"Pls Wait.."
    ''Selecting Country Name
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
          GridControl.Nodes_2.Item(intI).Expand(True)
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description       
          blnFlag=False  
          Exit For
        End If
    Next
    If blnFlag = True then
      strTCRemarks="Country Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
  
    Delay 10000,"Pls Wait.."
        blnFlag = True 
    ''Selecting Level2Source_Name
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
  For intJ=0 to intTotNodeCnt-1
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(StrSource2) then
        GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
        intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
'        Call GridSourceTree.ClickCell(intRow, "Edit")
        Call GridControl.ClearSelectionCore
        Call GridControl.FocusViewAndRow(GridControl,intRow)
        GridControl.SetFocusOnCurrentItem
        Call GridControl.SelectRowCore(intRow)
        log.Message "Level2 Source Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
        blnFlag = False 
        Exit For
      End If
    Next
    If blnFlag = True then
      log.Message "Level2 Source Name not found"
      strTCRemarks="Level2 Source Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
    Delay 2000,"Pls Wait.."

    strTemp="WPFObject(""ArrowControl"", """", 1)"
    Set objNewWorkspace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,20,True)
    If objNewWorkspace.Exists = True then
      objNewWorkspace.Click
       strTemp="WPFObject(""BarPopupBorderControl"", """", 1)"
      Set objWrkspace_popup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").FindChild("Name",strTemp,5,True)
      If objWrkspace_popup.Exists = True then
        strTemp="WPFObject(""ContentControlEx"", ""Open For Edit (Source)"", 2)"
        Set objopenforEdit=objWrkspace_popup.FindChild("Name",strTemp,8,True)
        If objopenforEdit.Exists then
          objopenforEdit.Click    
          'Delay 20000,"Please Wait..."
        End If
      End if
      
      strTemp1="WPFObject(""HwndSource: WorkspaceNamePrompt"", ""Please provide a new Workspace Name"")"
      Set objNewWrkSpaceName=Sys.Process("EdgeClient").WaitChild(strTemp1,50000)
      If objNewWrkSpaceName.Exists = True then
     
      ''Waiting for Workspace Name prompt
      strTemp="WPFObject(""FloatingContainerBorder"")"
      Set objNewWrkSpace_Name=Sys.Process("EdgeClient").WPFObject("HwndSource: WorkspaceNamePrompt", "Please provide a new Workspace Name").WPFObject("WorkspaceNamePrompt", "Please provide a new Workspace Name", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,15000000)
      If objNewWrkSpace_Name.Exists = True then
          strTemp="WPFObject(""ChangeNameTextEdit"")"
          ''Entering Workspace Name
          Set objNewWrkSpace_Txtbox=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
            If objNewWrkSpace_Txtbox.Exists = True then
              objNewWrkSpace_Txtbox.Click
              objNewWrkSpace_Txtbox.Text=strWrkSpaceName
      '        strTCRemarks=strTCRemarks & Chr(10) & "Entered Workspace Name - " & strWrkSpaceName
              ''Clicking on Ok Button 
              strTemp="WPFObject(""OkButton"")"
              Set objNewWrkSpace_okbtn=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
              If objNewWrkSpace_okbtn.Exists = True then
                objNewWrkSpace_okbtn.Click
                'Delay 5000,"Please wait..."
              End If
            End If
        End If
      End if 
     End if 
       
  
       ''Handling Validation for Source
    strTemp="WPFObject(""HwndSource: WindowContentHolder"", """")"
    Set objTemp=Sys.Process("EdgeClient").WaitChild(strTemp,10000)
    If objTemp.Exists = True then
      objTemp.Keys "[Enter]"
      strTestCaseResult = "FAIL"
      Exit Sub
    End If

    ''WorkSpace Edit Window
    strTemp="WPFObject(""LayoutPanel"", """", 2)"
    Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,13,True)
    If objTemp.Exists then
        Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WPFObject("SourceTreeListView")
        Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl")

        ''Expanding First Node in Tree      
        intTotNodeCnt=GridControl.Nodes_2.Count  
        For intI=0 to intTotNodeCnt-1         
          If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
           ' GridControl.Nodes_2.Item(intI).Expand(True)
           GridControl.Keys "^[Home]"
            blnFlag=False  
            Exit For
          End If
        Next
        
        End if
        
        Delay 15000,"Pls Wait.."
      Call SClosesource()
      Delay 5000,"Pls Wait.."
    
    strTemp="WPFObject(""SourceTreeListView"")"
    objEditSource=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WaitChild(strTemp,15000000)
    if objEditSource.Exists = True then
                 
          strTemp="WPFObject(""ContentControlEx"", ""Find & Replace"", 2)"
          Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 12).WPFObject("BarButtonItemLinkControl", "", 1).FindChild("Name",strTemp,50,True)
          If objNewWrkSpace_okbtn.Exists = True then
             If objNewWrkSpace_okbtn.Enabled = True then
              strTCRemarks = strTCRemarks & "<br />" & "Find & Replace  is found in Source"
              log.Message "Find & Replace is found in Source"
              objNewWrkSpace_okbtn.Click
               strTCRemarks = strTCRemarks & "<br />" & "Find & Replace  form opened in Source"
              log.Message "Find & Replace form opened in Source"
              strTemp="WPFObject(""PART_ContainerContent"")"
              Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: SearchWindow", "Find").WPFObject("SearchWindow", "Find", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").FindChild("Name",strTemp,50,True)
               If objNewWrkSpace_okbtn.Exists = True then
               
                  strTemp="WPFObject(""Label"", ""Find What:"", 1)"
                  Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: SearchWindow", "Find").WPFObject("SearchWindow", "Find", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).FindChild("Name",strTemp,50,True)
                  If objNewWrkSpace_okbtn.Exists = True then
                     If objNewWrkSpace_okbtn.Enabled = True then
                      strTCRemarks = strTCRemarks & "<br />" & "Find What  is found in Find"
                      log.Message "Find What is found in Find"
                      End if
                  End if
                  
                  strTemp="WPFObject(""Label"", ""Replace with:"", 2)"
                  Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: SearchWindow", "Find").WPFObject("SearchWindow", "Find", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).FindChild("Name",strTemp,50,True)
                  If objNewWrkSpace_okbtn.Exists = True then
                     If objNewWrkSpace_okbtn.Enabled = True then
                      strTCRemarks = strTCRemarks & "<br />" & "Replace with is found in Find"
                      log.Message "Replace with is found in Find"
                      End if
                  End if
                  
                  strTemp="WPFObject(""Button"", ""Find Next"", 1)"
                  Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: SearchWindow", "Find").WPFObject("SearchWindow", "Find", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).FindChild("Name",strTemp,50,True)
                  If objNewWrkSpace_okbtn.Exists = True then
                     If objNewWrkSpace_okbtn.Enabled = True then
                      strTCRemarks = strTCRemarks & "<br />" & "Find Next  is found in Find"
                      log.Message "Find Next is found in Find"
                      End if
                  End if
                  
                  strTemp="WPFObject(""Button"", ""Replace"", 2)"
                  Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: SearchWindow", "Find").WPFObject("SearchWindow", "Find", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).FindChild("Name",strTemp,50,True)
                  If objNewWrkSpace_okbtn.Exists = True then
                     If objNewWrkSpace_okbtn.Enabled = True then
                      strTCRemarks = strTCRemarks & "<br />" & "Replace is found in Find"
                      log.Message "Replace is found in Find"
                      End if
                  End if
                  
                  strTemp="WPFObject(""Button"", ""Replace Selected"", 3)"
                  Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: SearchWindow", "Find").WPFObject("SearchWindow", "Find", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).FindChild("Name",strTemp,50,True)
                  If objNewWrkSpace_okbtn.Exists = True then
                     If objNewWrkSpace_okbtn.Enabled = True then
                      strTCRemarks = strTCRemarks & "<br />" & "Replace Selected  is found in Find"
                      log.Message "Replace Selected is found in Find"
                      End if
                  End if
                  
                   strTemp="WPFObject(""Button"", ""Replace All"", 4)"
                  Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: SearchWindow", "Find").WPFObject("SearchWindow", "Find", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).FindChild("Name",strTemp,50,True)
                  If objNewWrkSpace_okbtn.Exists = True then
                     If objNewWrkSpace_okbtn.Enabled = True then
                      strTCRemarks = strTCRemarks & "<br />" & "Replace All  is found in Find"
                      log.Message "Replace All is found in Find"
                      End if
                  End if
                  
                  
                  strTemp="WPFObject(""FindText"")"
                  Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: SearchWindow", "Find").WPFObject("SearchWindow", "Find", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).FindChild("Name",strTemp,50,True)
                  If objNewWrkSpace_okbtn.Exists = True then
                    Sys.Process("EdgeClient").WPFObject("HwndSource: SearchWindow", "Find").WPFObject("SearchWindow", "Find", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("FindText").Text=""
                     strTemp="WPFObject(""Button"", ""Find Next"", 1)"
                      Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: SearchWindow", "Find").WPFObject("SearchWindow", "Find", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).FindChild("Name",strTemp,50,True)
                      If objNewWrkSpace_okbtn.Exists = True then
                         If objNewWrkSpace_okbtn.Enabled = True then
                            objNewWrkSpace_okbtn.Click
                            strTCRemarks = strTCRemarks & "<br />" & "Find Next is Clicked in Find"
                            log.Message "Find Next button is clicked in Form"
                           
                          
                            strTemp="WPFObject(""DXMessageBox"", """", 1)"
                            Set objNewWrkSpace_okbtn=.WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").FindChild("Name",strTemp,50,True)
                            If objNewWrkSpace_okbtn.Exists = True then
                               strTCRemarks = strTCRemarks & "<br />" & "Search parameter cannot be empty"
                               log.Message "Search parameter cannot be empty"
                              SYS.Keys "[Enter]"
                            End if 
                          
                          End if
                      End if
                  end if 
                  
                  
                  strTemp="WPFObject(""FindText"")"
                  Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: SearchWindow", "Find").WPFObject("SearchWindow", "Find", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).FindChild("Name",strTemp,50,True)
                  If objNewWrkSpace_okbtn.Exists = True then
                    Sys.Process("EdgeClient").WPFObject("HwndSource: SearchWindow", "Find").WPFObject("SearchWindow", "Find", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("FindText").Text=""
                     strTemp="WPFObject(""Button"", ""Replace"", 2)"
                  Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: SearchWindow", "Find").WPFObject("SearchWindow", "Find", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).FindChild("Name",strTemp,50,True)
                      If objNewWrkSpace_okbtn.Exists = True then
                         If objNewWrkSpace_okbtn.Enabled = True then
                            objNewWrkSpace_okbtn.Click
                            strTCRemarks = strTCRemarks & "<br />" & "Find Next is Clicked in Find"
                            log.Message "Find Next text is Clicked in Form"
                           
                            strTemp="WPFObject(""DXMessageBox"", """", 1)"
                            Set objNewWrkSpace_okbtn=.WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").FindChild("Name",strTemp,50,True)
                            If objNewWrkSpace_okbtn.Exists = True then
                              strTCRemarks = strTCRemarks & "<br />" & "Search parameter cannot be empty"
                              log.Message "Search parameter cannot be empty"
                              SYS.Keys "[Enter]"
                            End if 
                          
                          End if
                      End if
                  end if 
                  
                  
                  strTemp="WPFObject(""FindText"")"
                  Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: SearchWindow", "Find").WPFObject("SearchWindow", "Find", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).FindChild("Name",strTemp,50,True)
                  If objNewWrkSpace_okbtn.Exists = True then
                    Sys.Process("EdgeClient").WPFObject("HwndSource: SearchWindow", "Find").WPFObject("SearchWindow", "Find", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("FindText").Text=""
                     strTemp="WPFObject(""Button"", ""Replace Selected"", 3)"
                  Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: SearchWindow", "Find").WPFObject("SearchWindow", "Find", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).FindChild("Name",strTemp,50,True)
                      If objNewWrkSpace_okbtn.Exists = True then
                         If objNewWrkSpace_okbtn.Enabled = True then
                            objNewWrkSpace_okbtn.Click
                            strTCRemarks = strTCRemarks & "<br />" & "Replace Selected button is Clicked in Find"
                            log.Message "Replace Selected button is Clicked in Form"
                           
                            strTemp="WPFObject(""DXMessageBox"", """", 1)"
                            Set objNewWrkSpace_okbtn=.WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").FindChild("Name",strTemp,50,True)
                            If objNewWrkSpace_okbtn.Exists = True then
                              strTCRemarks = strTCRemarks & "<br />" & "Search parameter cannot be empty"
                              log.Message "Search parameter cannot be empty"
                              SYS.Keys "[Enter]"
                            End if 
                          
                          End if
                      End if
                  end if 
                  
                  
                  strTemp="WPFObject(""FindText"")"
                  Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: SearchWindow", "Find").WPFObject("SearchWindow", "Find", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).FindChild("Name",strTemp,50,True)
                  If objNewWrkSpace_okbtn.Exists = True then
                    Sys.Process("EdgeClient").WPFObject("HwndSource: SearchWindow", "Find").WPFObject("SearchWindow", "Find", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("FindText").Text=""
                      strTemp="WPFObject(""Button"", ""Replace All"", 4)"
                  Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: SearchWindow", "Find").WPFObject("SearchWindow", "Find", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).FindChild("Name",strTemp,50,True)
                      If objNewWrkSpace_okbtn.Exists = True then
                         If objNewWrkSpace_okbtn.Enabled = True then
                            objNewWrkSpace_okbtn.Click
                            strTCRemarks = strTCRemarks & "<br />" & "Replace All is Clicked in Find"
                            log.Message "Replace All is Clicked in Form"
                           
                            strTemp="WPFObject(""DXMessageBox"", """", 1)"
                            Set objNewWrkSpace_okbtn=.WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").FindChild("Name",strTemp,50,True)
                            If objNewWrkSpace_okbtn.Exists = True then
                              strTCRemarks = strTCRemarks & "<br />" & "Search parameter cannot be empty"
                              log.Message "Search parameter cannot be empty"
                              SYS.Keys "[Enter]"
                            End if 
                          
                          End if
                      End if
                  end if 
                  
                  strTemp="WPFObject(""PART_CloseButton"")"
                  Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: SearchWindow", "Find").WPFObject("SearchWindow", "Find", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("PART_Header").WPFObject("Grid", "", 1).WPFObject("stackPanel").FindChild("Name",strTemp,50,True)
                  If objNewWrkSpace_okbtn.Exists = True then
                     If objNewWrkSpace_okbtn.Enabled = True then
                      strTCRemarks = strTCRemarks & "<br />" & "Close button  is found in Find"
                      log.Message "Close button is found in Find"
                      objNewWrkSpace_okbtn.Click
                      End if
                  End if
              End if  
              
             Else
              strTCRemarks = strTCRemarks & "<br />" & "Find & Replace  is Disabled in Source"
              log.Message "Find & Replace is Disabled in Source"
             End if
          Else
            strTCRemarks = strTCRemarks & "<br />" & "Find & Replace is  not found in Source"
            log.Message "Find & Replace is not found in Source"
          End If
                  
    End if
 
  Call SClosesource()
  Call SourceWorkSpacevwr()
End Sub
Sub  sCheckSrcOpenEditFindReplaceNOText(strParameters)
On Error Resume Next 
   Dim strSource1,StrSource2,strSource3,strTemp,GridControl,GridSourceTree,intTotNodeCnt,intI,intJ,intRow,intK,objEdge
   Dim objNewWorkspace,objWrkspace_popup,objOpenView,strTemp1,objNewWrkSpaceName,objNewWrkSpace_Txtbox,objNewWrkSpace_okbtn,objNewWrkSpace_Name
   Dim strDesc1,strDesc2,DescText,DescLocalText
   Dim objEditSource
   
    strSource1=getSplitValue(strParameters,"SOURCE")
    StrSource2=getSplitValue(strParameters,"LEVEL2SOURCE")

'    strSource1="Test"
'    StrSource2="Automation_UIT3"

    Call sHome_Source
    
    strDesc1=aqDateTime.Now
    strDesc2=aqDateTime.Now
    DescText=Replace(strDesc1,"/","-")
    DescText=Replace(DescText,":","_")
    DescLocalText=DescText
    strWrkSpaceName=DescText
'    intSeriesID=getSplitValue(strParameters,"SERIESID")
'    if intSeriesID=0 then
'      Call sSourceseries
'      intSeriesID=strSourceFileText
'    End if 
    
    strTemp="WPFObject(""SourceTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""SourceTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    Delay 10000,"Pls Wait.."
    ''Selecting Country Name
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
          GridControl.Nodes_2.Item(intI).Expand(True)
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description       
          blnFlag=False  
          Exit For
        End If
    Next
    If blnFlag = True then
      strTCRemarks="Country Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
  
    Delay 10000,"Pls Wait.."
        blnFlag = True 
    ''Selecting Level2Source_Name
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
  For intJ=0 to intTotNodeCnt-1
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(StrSource2) then
        GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
        intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
'        Call GridSourceTree.ClickCell(intRow, "Edit")
        Call GridControl.ClearSelectionCore
        Call GridControl.FocusViewAndRow(GridControl,intRow)
        GridControl.SetFocusOnCurrentItem
        Call GridControl.SelectRowCore(intRow)
        log.Message "Level2 Source Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
        blnFlag = False 
        Exit For
      End If
    Next
    If blnFlag = True then
      log.Message "Level2 Source Name not found"
      strTCRemarks="Level2 Source Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
    Delay 2000,"Pls Wait.."

    strTemp="WPFObject(""ArrowControl"", """", 1)"
    Set objNewWorkspace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,20,True)
    If objNewWorkspace.Exists = True then
      objNewWorkspace.Click
       strTemp="WPFObject(""BarPopupBorderControl"", """", 1)"
      Set objWrkspace_popup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").FindChild("Name",strTemp,5,True)
      If objWrkspace_popup.Exists = True then
        strTemp="WPFObject(""ContentControlEx"", ""Open For Edit (Source)"", 2)"
        Set objopenforEdit=objWrkspace_popup.FindChild("Name",strTemp,8,True)
        If objopenforEdit.Exists then
          objopenforEdit.Click    
          'Delay 20000,"Please Wait..."
        End If
      End if
      
      strTemp1="WPFObject(""HwndSource: WorkspaceNamePrompt"", ""Please provide a new Workspace Name"")"
      Set objNewWrkSpaceName=Sys.Process("EdgeClient").WaitChild(strTemp1,50000)
      If objNewWrkSpaceName.Exists = True then
     
      ''Waiting for Workspace Name prompt
      strTemp="WPFObject(""FloatingContainerBorder"")"
      Set objNewWrkSpace_Name=Sys.Process("EdgeClient").WPFObject("HwndSource: WorkspaceNamePrompt", "Please provide a new Workspace Name").WPFObject("WorkspaceNamePrompt", "Please provide a new Workspace Name", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,15000000)
      If objNewWrkSpace_Name.Exists = True then
          strTemp="WPFObject(""ChangeNameTextEdit"")"
          ''Entering Workspace Name
          Set objNewWrkSpace_Txtbox=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
            If objNewWrkSpace_Txtbox.Exists = True then
              objNewWrkSpace_Txtbox.Click
              objNewWrkSpace_Txtbox.Text=strWrkSpaceName
      '        strTCRemarks=strTCRemarks & Chr(10) & "Entered Workspace Name - " & strWrkSpaceName
              ''Clicking on Ok Button 
              strTemp="WPFObject(""OkButton"")"
              Set objNewWrkSpace_okbtn=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
              If objNewWrkSpace_okbtn.Exists = True then
                objNewWrkSpace_okbtn.Click
                'Delay 5000,"Please wait..."
              End If
            End If
        End If
      End if 
     End if 
       
  
       ''Handling Validation for Source
    strTemp="WPFObject(""HwndSource: WindowContentHolder"", """")"
    Set objTemp=Sys.Process("EdgeClient").WaitChild(strTemp,10000)
    If objTemp.Exists = True then
      objTemp.Keys "[Enter]"
      strTestCaseResult = "FAIL"
      Exit Sub
    End If

    ''WorkSpace Edit Window
    strTemp="WPFObject(""LayoutPanel"", """", 2)"
    Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,13,True)
    If objTemp.Exists then
        Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WPFObject("SourceTreeListView")
        Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl")

        ''Expanding First Node in Tree      
        intTotNodeCnt=GridControl.Nodes_2.Count  
        For intI=0 to intTotNodeCnt-1         
          If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
           ' GridControl.Nodes_2.Item(intI).Expand(True)
           GridControl.Keys "^[Home]"
            blnFlag=False  
            Exit For
          End If
        Next
        
        End if
        
        Delay 15000,"Pls Wait.."
      Call SClosesource()
      Delay 5000,"Pls Wait.."
    
    strTemp="WPFObject(""SourceTreeListView"")"
    objEditSource=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WaitChild(strTemp,15000000)
    if objEditSource.Exists = True then
                 
          strTemp="WPFObject(""ContentControlEx"", ""Find & Replace"", 2)"
          Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 12).WPFObject("BarButtonItemLinkControl", "", 1).FindChild("Name",strTemp,50,True)
          If objNewWrkSpace_okbtn.Exists = True then
             If objNewWrkSpace_okbtn.Enabled = True then
              strTCRemarks = strTCRemarks & "<br />" & "Find & Replace  is found in Source"
              log.Message "Find & Replace is found in Source"
              objNewWrkSpace_okbtn.Click
               strTCRemarks = strTCRemarks & "<br />" & "Find & Replace  form opened in Source"
              log.Message "Find & Replace form opened in Source"
              strTemp="WPFObject(""PART_ContainerContent"")"
              Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: SearchWindow", "Find").WPFObject("SearchWindow", "Find", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").FindChild("Name",strTemp,50,True)
               If objNewWrkSpace_okbtn.Exists = True then
               
                  strTemp="WPFObject(""Label"", ""Find What:"", 1)"
                  Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: SearchWindow", "Find").WPFObject("SearchWindow", "Find", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).FindChild("Name",strTemp,50,True)
                  If objNewWrkSpace_okbtn.Exists = True then
                     If objNewWrkSpace_okbtn.Enabled = True then
                      strTCRemarks = strTCRemarks & "<br />" & "Find What  is found in Find"
                      log.Message "Find What is found in Find"
                      End if
                  End if
                  
                  strTemp="WPFObject(""Label"", ""Replace with:"", 2)"
                  Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: SearchWindow", "Find").WPFObject("SearchWindow", "Find", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).FindChild("Name",strTemp,50,True)
                  If objNewWrkSpace_okbtn.Exists = True then
                     If objNewWrkSpace_okbtn.Enabled = True then
                      strTCRemarks = strTCRemarks & "<br />" & "Replace with is found in Find"
                      log.Message "Replace with is found in Find"
                      End if
                  End if
                  
                  strTemp="WPFObject(""Button"", ""Find Next"", 1)"
                  Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: SearchWindow", "Find").WPFObject("SearchWindow", "Find", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).FindChild("Name",strTemp,50,True)
                  If objNewWrkSpace_okbtn.Exists = True then
                     If objNewWrkSpace_okbtn.Enabled = True then
                      strTCRemarks = strTCRemarks & "<br />" & "Find Next  is found in Find"
                      log.Message "Find Next is found in Find"
                      End if
                  End if
                  
                  strTemp="WPFObject(""Button"", ""Replace"", 2)"
                  Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: SearchWindow", "Find").WPFObject("SearchWindow", "Find", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).FindChild("Name",strTemp,50,True)
                  If objNewWrkSpace_okbtn.Exists = True then
                     If objNewWrkSpace_okbtn.Enabled = True then
                      strTCRemarks = strTCRemarks & "<br />" & "Replace is found in Find"
                      log.Message "Replace is found in Find"
                      End if
                  End if
                  
                  strTemp="WPFObject(""Button"", ""Replace Selected"", 3)"
                  Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: SearchWindow", "Find").WPFObject("SearchWindow", "Find", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).FindChild("Name",strTemp,50,True)
                  If objNewWrkSpace_okbtn.Exists = True then
                     If objNewWrkSpace_okbtn.Enabled = True then
                      strTCRemarks = strTCRemarks & "<br />" & "Replace Selected  is found in Find"
                      log.Message "Replace Selected is found in Find"
                      End if
                  End if
                  
                   strTemp="WPFObject(""Button"", ""Replace All"", 4)"
                  Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: SearchWindow", "Find").WPFObject("SearchWindow", "Find", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).FindChild("Name",strTemp,50,True)
                  If objNewWrkSpace_okbtn.Exists = True then
                     If objNewWrkSpace_okbtn.Enabled = True then
                      strTCRemarks = strTCRemarks & "<br />" & "Replace All  is found in Find"
                      log.Message "Replace All is found in Find"
                      End if
                  End if
                  
                  
                  strTemp="WPFObject(""FindText"")"
                  Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: SearchWindow", "Find").WPFObject("SearchWindow", "Find", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).FindChild("Name",strTemp,50,True)
                  If objNewWrkSpace_okbtn.Exists = True then
                    Sys.Process("EdgeClient").WPFObject("HwndSource: SearchWindow", "Find").WPFObject("SearchWindow", "Find", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("FindText").Text="XYZ"
                     strTemp="WPFObject(""Button"", ""Find Next"", 1)"
                      Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: SearchWindow", "Find").WPFObject("SearchWindow", "Find", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).FindChild("Name",strTemp,50,True)
                      If objNewWrkSpace_okbtn.Exists = True then
                         If objNewWrkSpace_okbtn.Enabled = True then
                            objNewWrkSpace_okbtn.Click
                            strTCRemarks = strTCRemarks & "<br />" & "Find Next is Clicked in Find"
                            log.Message "Find Next text is highlighted in Form"
                            strTCRemarks = strTCRemarks & "<br />" & "Find Next text highlighted in Form"
                            log.Message "Find Next is found in Form"
                          
                            strTemp="WPFObject(""PART_ContainerContent"")"
                            Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "Please Confirm.").WPFObject("CustomMessageBoxWindow", "Please Confirm.", 1).FindChild("Name",strTemp,50,True)
                            If objNewWrkSpace_okbtn.Exists = True then
                               strTCRemarks = strTCRemarks & "<br />" & "Shown the confirmation message in Form"
                              log.Message "shown the confirmation message in Form"
                              SYS.Keys "[Enter]"
                            End if 
                          
                          End if
                      End if
                  end if 
                  strTemp="WPFObject(""PART_CloseButton"")"
                  Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: SearchWindow", "Find").WPFObject("SearchWindow", "Find", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("PART_Header").WPFObject("Grid", "", 1).WPFObject("stackPanel").FindChild("Name",strTemp,50,True)
                  If objNewWrkSpace_okbtn.Exists = True then
                     If objNewWrkSpace_okbtn.Enabled = True then
                      strTCRemarks = strTCRemarks & "<br />" & "Close button  is found in Find"
                      log.Message "Close button is found in Find"
                      objNewWrkSpace_okbtn.Click
                      strTCRemarks = strTCRemarks & "<br />" & "Find Button is Closed"
                      log.Message "Find button is Closed"
                      End if
                  End if
              End if  
              
             Else
              strTCRemarks = strTCRemarks & "<br />" & "Find & Replace  is Disabled in Source"
              log.Message "Find & Replace is Disabled in Source"
             End if
          Else
            strTCRemarks = strTCRemarks & "<br />" & "Find & Replace is  not found in Source"
            log.Message "Find & Replace is not found in Source"
          End If
                  
    End if
 
  Call SClosesource()
  Call SourceWorkSpacevwr()
End Sub
Sub  sCheckSrcOpenEditSearch(strParameters)
On Error Resume Next 
   Dim strSource1,StrSource2,strSource3,strTemp,GridControl,GridSourceTree,intTotNodeCnt,intI,intJ,intRow,intK,objEdge
   Dim objNewWorkspace,objWrkspace_popup,objOpenView,strTemp1,objNewWrkSpaceName,objNewWrkSpace_Txtbox,objNewWrkSpace_okbtn,objNewWrkSpace_Name
   Dim strDesc1,strDesc2,DescText,DescLocalText
   Dim objEditSource
   
    strSource1=getSplitValue(strParameters,"SOURCE")
    StrSource2=getSplitValue(strParameters,"LEVEL2SOURCE")

'    strSource1="Test"
'    StrSource2="Automation"

    Call sHome_Source
    
    strDesc1=aqDateTime.Now
    strDesc2=aqDateTime.Now
    DescText=Replace(strDesc1,"/","-")
    DescText=Replace(DescText,":","_")
    DescLocalText=DescText
    strWrkSpaceName=DescText
'    intSeriesID=getSplitValue(strParameters,"SERIESID")
'    if intSeriesID=0 then
'      Call sSourceseries
'      intSeriesID=strSourceFileText
'    End if 
'    
    strTemp="WPFObject(""SourceTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""SourceTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    Delay 10000,"Pls Wait.."
    ''Selecting Country Name
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
          GridControl.Nodes_2.Item(intI).Expand(True)
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description       
          blnFlag=False  
          Exit For
        End If
    Next
    If blnFlag = True then
      strTCRemarks="Country Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
  
    Delay 10000,"Pls Wait.."
        blnFlag = True 
    ''Selecting Level2Source_Name
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
  For intJ=0 to intTotNodeCnt-1
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(StrSource2) then
        GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
        intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
'        Call GridSourceTree.ClickCell(intRow, "Edit")
        Call GridControl.ClearSelectionCore
        Call GridControl.FocusViewAndRow(GridControl,intRow)
        GridControl.SetFocusOnCurrentItem
        Call GridControl.SelectRowCore(intRow)
        log.Message "Level2 Source Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
        blnFlag = False 
        Exit For
      End If
    Next
    If blnFlag = True then
      log.Message "Level2 Source Name not found"
      strTCRemarks="Level2 Source Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
    Delay 2000,"Pls Wait.."

    strTemp="WPFObject(""ArrowControl"", """", 1)"
    Set objNewWorkspace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,20,True)
    If objNewWorkspace.Exists = True then
      objNewWorkspace.Click
       strTemp="WPFObject(""BarPopupBorderControl"", """", 1)"
      Set objWrkspace_popup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").FindChild("Name",strTemp,5,True)
      If objWrkspace_popup.Exists = True then
        strTemp="WPFObject(""ContentControlEx"", ""Open For Edit (Source)"", 2)"
        Set objopenforEdit=objWrkspace_popup.FindChild("Name",strTemp,8,True)
        If objopenforEdit.Exists then
          objopenforEdit.Click    
          'Delay 20000,"Please Wait..."
        End If
      End if
      
      strTemp1="WPFObject(""HwndSource: WorkspaceNamePrompt"", ""Please provide a new Workspace Name"")"
      Set objNewWrkSpaceName=Sys.Process("EdgeClient").WaitChild(strTemp1,50000)
      If objNewWrkSpaceName.Exists = True then
     
      ''Waiting for Workspace Name prompt
      strTemp="WPFObject(""FloatingContainerBorder"")"
      Set objNewWrkSpace_Name=Sys.Process("EdgeClient").WPFObject("HwndSource: WorkspaceNamePrompt", "Please provide a new Workspace Name").WPFObject("WorkspaceNamePrompt", "Please provide a new Workspace Name", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,15000000)
      If objNewWrkSpace_Name.Exists = True then
          strTemp="WPFObject(""ChangeNameTextEdit"")"
          ''Entering Workspace Name
          Set objNewWrkSpace_Txtbox=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
            If objNewWrkSpace_Txtbox.Exists = True then
              objNewWrkSpace_Txtbox.Click
              objNewWrkSpace_Txtbox.Text=strWrkSpaceName
      '        strTCRemarks=strTCRemarks & Chr(10) & "Entered Workspace Name - " & strWrkSpaceName
              ''Clicking on Ok Button 
              strTemp="WPFObject(""OkButton"")"
              Set objNewWrkSpace_okbtn=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
              If objNewWrkSpace_okbtn.Exists = True then
                objNewWrkSpace_okbtn.Click
                'Delay 5000,"Please wait..."
              End If
            End If
        End If
      End if 
     End if 
       Delay 15000,"Pls Wait.."
  Call SClosesource()
  Delay 5000,"Pls Wait.."
  
    strTemp="WPFObject(""SourceTreeListView"")"
    objEditSource=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WaitChild(strTemp,15000000)
    if objEditSource.Exists = True then
      if Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WPFObject("SourceTreeListView").ShowSearchPanelCloseButton=True then
        strTCRemarks = strTCRemarks & "<br />" &  "Search Box is Found in Source"
        log.Message "Search box is Found in Source" 
      Else
        strTCRemarks = strTCRemarks & "<br />" &  "Search box is not Found in Source"
        log.Message "Search box is not Found in Source" 
      End if  
End if
  
        
  Call SClosesource()
  Call SourceWorkSpacevwr()
End Sub
Sub  sCheckSrcOpenEditAddFolder(strParameters)
On Error Resume Next 
   Dim strSource1,StrSource2,strSource3,strTemp,GridControl,GridSourceTree,intTotNodeCnt,intI,intJ,intRow,intK,objEdge
   Dim objNewWorkspace,objWrkspace_popup,objOpenView,strTemp1,objNewWrkSpaceName,objNewWrkSpace_Txtbox,objNewWrkSpace_okbtn,objNewWrkSpace_Name
   Dim strDesc1,strDesc2,DescText,DescLocalText
   Dim objEditSource
   
    strSource1=getSplitValue(strParameters,"SOURCE")
    StrSource2=getSplitValue(strParameters,"LEVEL2SOURCE")

'    strSource1="Test"
'    StrSource2="Automation_UIT3"

    Call sHome_Source
    
    strDesc1=aqDateTime.Now
    strDesc2=aqDateTime.Now
    DescText=Replace(strDesc1,"/","-")
    DescText=Replace(DescText,":","_")
    DescLocalText=DescText
    strWrkSpaceName=DescText
'    intSeriesID=getSplitValue(strParameters,"SERIESID")
'    if intSeriesID=0 then
'      Call sSourceseries
'      intSeriesID=strSourceFileText
'    End if 
    
    strTemp="WPFObject(""SourceTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""SourceTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    Delay 10000,"Pls Wait.."
    ''Selecting Country Name
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
          GridControl.Nodes_2.Item(intI).Expand(True)
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description       
          blnFlag=False  
          Exit For
        End If
    Next
    If blnFlag = True then
      strTCRemarks="Country Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
  
    Delay 10000,"Pls Wait.."
        blnFlag = True 
    ''Selecting Level2Source_Name
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
  For intJ=0 to intTotNodeCnt-1
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(StrSource2) then
        GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
        intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
'        Call GridSourceTree.ClickCell(intRow, "Edit")
        Call GridControl.ClearSelectionCore
        Call GridControl.FocusViewAndRow(GridControl,intRow)
        GridControl.SetFocusOnCurrentItem
        Call GridControl.SelectRowCore(intRow)
        log.Message "Level2 Source Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
        blnFlag = False 
        Exit For
      End If
    Next
    If blnFlag = True then
      log.Message "Level2 Source Name not found"
      strTCRemarks="Level2 Source Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
    Delay 2000,"Pls Wait.."

    strTemp="WPFObject(""ArrowControl"", """", 1)"
    Set objNewWorkspace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,20,True)
    If objNewWorkspace.Exists = True then
      objNewWorkspace.Click
       strTemp="WPFObject(""BarPopupBorderControl"", """", 1)"
      Set objWrkspace_popup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").FindChild("Name",strTemp,5,True)
      If objWrkspace_popup.Exists = True then
        strTemp="WPFObject(""ContentControlEx"", ""Open For Edit (Source)"", 2)"
        Set objopenforEdit=objWrkspace_popup.FindChild("Name",strTemp,8,True)
        If objopenforEdit.Exists then
          objopenforEdit.Click    
          'Delay 20000,"Please Wait..."
        End If
      End if
      
      strTemp1="WPFObject(""HwndSource: WorkspaceNamePrompt"", ""Please provide a new Workspace Name"")"
      Set objNewWrkSpaceName=Sys.Process("EdgeClient").WaitChild(strTemp1,50000)
      If objNewWrkSpaceName.Exists = True then
     
      ''Waiting for Workspace Name prompt
      strTemp="WPFObject(""FloatingContainerBorder"")"
      Set objNewWrkSpace_Name=Sys.Process("EdgeClient").WPFObject("HwndSource: WorkspaceNamePrompt", "Please provide a new Workspace Name").WPFObject("WorkspaceNamePrompt", "Please provide a new Workspace Name", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,15000000)
      If objNewWrkSpace_Name.Exists = True then
          strTemp="WPFObject(""ChangeNameTextEdit"")"
          ''Entering Workspace Name
          Set objNewWrkSpace_Txtbox=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
            If objNewWrkSpace_Txtbox.Exists = True then
              objNewWrkSpace_Txtbox.Click
              objNewWrkSpace_Txtbox.Text=strWrkSpaceName
      '        strTCRemarks=strTCRemarks & Chr(10) & "Entered Workspace Name - " & strWrkSpaceName
              ''Clicking on Ok Button 
              strTemp="WPFObject(""OkButton"")"
              Set objNewWrkSpace_okbtn=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
              If objNewWrkSpace_okbtn.Exists = True then
                objNewWrkSpace_okbtn.Click
                'Delay 5000,"Please wait..."
              End If
            End If
        End If
      End if 
     End if 
       
  
       ''Handling Validation for Source
    strTemp="WPFObject(""HwndSource: WindowContentHolder"", """")"
    Set objTemp=Sys.Process("EdgeClient").WaitChild(strTemp,10000)
    If objTemp.Exists = True then
      objTemp.Keys "[Enter]"
      strTestCaseResult = "FAIL"
      Exit Sub
    End If

    ''WorkSpace Edit Window
    strTemp="WPFObject(""LayoutPanel"", """", 2)"
    Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,13,True)
    If objTemp.Exists then
        Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WPFObject("SourceTreeListView")
        Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl")
       Delay 10000,"Pls Wait.."
        ''Expanding First Node in Tree      
        intTotNodeCnt=GridControl.Nodes_2.Count  
        For intI=0 to intTotNodeCnt-1         
          If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
           GridControl.Nodes_2.Item(intI).Expand(True)
           'GridControl.Keys "^[Home]"
            blnFlag=False  
            Exit For
          End If
        Next
         Delay 10000,"Pls Wait.."
        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
          For intJ=0 to intTotNodeCnt-1
            If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strSource2) then
              intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(0).get_RowHandle
              GridControl.Keys "^[Home]"
'             Set objGridCell=GridControl.WPFObject("HierarchyPanel", "", 1).WPFObject("GridRow", "", intRow).WPFObject("ScrollablePart").WPFObject("CellItemsControl", "", 1).WPFObject("GridCellContentPresenter", "", 1).WPFObject("TextEdit", "", 1)
              Call GridControl.ClearSelectionCore
              Call GridControl.FocusViewAndRow(GridControl,intRow-1)
              GridControl.SetFocusOnCurrentItem
              Call GridControl.SelectRowCore(intRow-1)
        
              If objGridCell.Exists = True then
                objGridCell.Click
              End If
              blnFlag = False 
              Exit For
            End If
          Next
          
'              intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count
'               For intK=0 to intTotNodeCnt-1
'                  If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description)=Ucase( DescText) then
'                      intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).get_RowHandle
'                      GridControl.set_FocusedRowHandle(intRow)
'                      log.Message "New Source Created"
'                      strTCRemarks="Upload successful" & "<br />" & "Level3 Source Created - " & DescText & "<br />" & "Attach Series - " & intSeriesID
'                      Exit For   
'                  End If 
'               Next
    End if
        
        Delay 15000,"Pls Wait.."
      Call SClosesource()
      Delay 5000,"Pls Wait.."
    
    strTemp="WPFObject(""SourceTreeListView"")"
    objEditSource=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WaitChild(strTemp,15000000)
    if objEditSource.Exists = True then
                 
          strTemp="WPFObject(""ContentControlEx"", ""Add Folder"", 2)"
          Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 4).WPFObject("BarButtonItemLinkControl", "", 1).FindChild("Name",strTemp,50,True)
          If objNewWrkSpace_okbtn.Exists = True then
             If objNewWrkSpace_okbtn.Enabled = True then
              strTCRemarks = strTCRemarks & "<br />" & "Add Folder is found in Source"
              log.Message "Add Folder is found in Source"
             Else
              strTCRemarks = strTCRemarks & "<br />" & "Add Folder is Disabled in Source"
              log.Message "Add Folder is Disabled in Source"
             End if
          Else
            strTCRemarks = strTCRemarks & "<br />" & "Add Folder is  not found in Source"
            log.Message "Add Folder is not found in Source"
          End If
                          
    End if
 
  Call SClosesource()
  Call SourceWorkSpacevwr()
End Sub
Sub  sCheckSrcOpenEdit3LAddFolder(strParameters)
On Error Resume Next 
   Dim strSource1,StrSource2,strSource3,strTemp,GridControl,GridSourceTree,intTotNodeCnt,intI,intJ,intRow,intK,objEdge
   Dim objNewWorkspace,objWrkspace_popup,objOpenView,strTemp1,objNewWrkSpaceName,objNewWrkSpace_Txtbox,objNewWrkSpace_okbtn,objNewWrkSpace_Name
   Dim strDesc1,strDesc2,DescText,DescLocalText
   Dim objEditSource
   
    strSource1=getSplitValue(strParameters,"SOURCE")
    StrSource2=getSplitValue(strParameters,"LEVEL2SOURCE")
    StrSource3=getSplitValue(strParameters,"LEVEL3SOURCE")
    
'    strSource1="Test"
'    StrSource2="Automation_UIT3"
'    StrSource3="Test"

    Call sHome_Source
    
    strDesc1=aqDateTime.Now
    strDesc2=aqDateTime.Now
    DescText=Replace(strDesc1,"/","-")
    DescText=Replace(DescText,":","_")
    DescLocalText=DescText
    strWrkSpaceName=DescText
'    intSeriesID=getSplitValue(strParameters,"SERIESID")
'    if intSeriesID=0 then
'      Call sSourceseries
'      intSeriesID=strSourceFileText
'    End if 
    
    strTemp="WPFObject(""SourceTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""SourceTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    Delay 10000,"Pls Wait.."
    ''Selecting Country Name
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
          GridControl.Nodes_2.Item(intI).Expand(True)
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description       
          blnFlag=False  
          Exit For
        End If
    Next
    If blnFlag = True then
      strTCRemarks="Country Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
  
    Delay 10000,"Pls Wait.."
        blnFlag = True 
    ''Selecting Level2Source_Name
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
  For intJ=0 to intTotNodeCnt-1
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(StrSource2) then
        GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
        intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
'        Call GridSourceTree.ClickCell(intRow, "Edit")
        Call GridControl.ClearSelectionCore
        Call GridControl.FocusViewAndRow(GridControl,intRow)
        GridControl.SetFocusOnCurrentItem
        Call GridControl.SelectRowCore(intRow)
        log.Message "Level2 Source Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
        blnFlag = False 
        Exit For
      End If
    Next
    If blnFlag = True then
      log.Message "Level2 Source Name not found"
      strTCRemarks="Level2 Source Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If

    Delay 2000,"Pls Wait.."

    strTemp="WPFObject(""ArrowControl"", """", 1)"
    Set objNewWorkspace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,20,True)
    If objNewWorkspace.Exists = True then
      objNewWorkspace.Click
       strTemp="WPFObject(""BarPopupBorderControl"", """", 1)"
      Set objWrkspace_popup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").FindChild("Name",strTemp,5,True)
      If objWrkspace_popup.Exists = True then
        strTemp="WPFObject(""ContentControlEx"", ""Open For Edit (Source)"", 2)"
        Set objopenforEdit=objWrkspace_popup.FindChild("Name",strTemp,8,True)
        If objopenforEdit.Exists then
          objopenforEdit.Click    
          'Delay 20000,"Please Wait..."
        End If
      End if
      
      strTemp1="WPFObject(""HwndSource: WorkspaceNamePrompt"", ""Please provide a new Workspace Name"")"
      Set objNewWrkSpaceName=Sys.Process("EdgeClient").WaitChild(strTemp1,50000)
      If objNewWrkSpaceName.Exists = True then
     
      ''Waiting for Workspace Name prompt
      strTemp="WPFObject(""FloatingContainerBorder"")"
      Set objNewWrkSpace_Name=Sys.Process("EdgeClient").WPFObject("HwndSource: WorkspaceNamePrompt", "Please provide a new Workspace Name").WPFObject("WorkspaceNamePrompt", "Please provide a new Workspace Name", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,15000000)
      If objNewWrkSpace_Name.Exists = True then
          strTemp="WPFObject(""ChangeNameTextEdit"")"
          ''Entering Workspace Name
          Set objNewWrkSpace_Txtbox=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
            If objNewWrkSpace_Txtbox.Exists = True then
              objNewWrkSpace_Txtbox.Click
              objNewWrkSpace_Txtbox.Text=strWrkSpaceName
      '        strTCRemarks=strTCRemarks & Chr(10) & "Entered Workspace Name - " & strWrkSpaceName
              ''Clicking on Ok Button 
              strTemp="WPFObject(""OkButton"")"
              Set objNewWrkSpace_okbtn=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
              If objNewWrkSpace_okbtn.Exists = True then
                objNewWrkSpace_okbtn.Click
                'Delay 5000,"Please wait..."
              End If
            End If
        End If
      End if 
     End if 
       
  
       ''Handling Validation for Source
    strTemp="WPFObject(""HwndSource: WindowContentHolder"", """")"
    Set objTemp=Sys.Process("EdgeClient").WaitChild(strTemp,10000)
    If objTemp.Exists = True then
      objTemp.Keys "[Enter]"
      strTestCaseResult = "FAIL"
      Exit Sub
    End If

    ''WorkSpace Edit Window
    strTemp="WPFObject(""LayoutPanel"", """", 2)"
    Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,13,True)
    If objTemp.Exists then
        Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WPFObject("SourceTreeListView")
        Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl")
       Delay 10000,"Pls Wait.."
        ''Expanding First Node in Tree      
        intTotNodeCnt=GridControl.Nodes_2.Count  
        For intI=0 to intTotNodeCnt-1         
          If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
           GridControl.Nodes_2.Item(intI).Expand(True)
           'GridControl.Keys "^[Home]"
            blnFlag=False  
            Exit For
          End If
        Next
         Delay 10000,"Pls Wait.."
        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
          For intJ=0 to intTotNodeCnt-1
            If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strSource2) then
              GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
              intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(0).get_RowHandle
              GridControl.Keys "^[Home]"
              Call GridControl.ClearSelectionCore
              Call GridControl.FocusViewAndRow(GridControl,intRow-1)
              GridControl.SetFocusOnCurrentItem
              Call GridControl.SelectRowCore(intRow-1)
        
              If objGridCell.Exists = True then
                objGridCell.Click
              End If
              blnFlag = False 
              Exit For
            End If
          Next
           Delay 10000,"Pls Wait.."
              intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count
               For intK=0 to intTotNodeCnt-1
                  If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description)=Ucase(strSource3) then
                      intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).get_RowHandle
                      Call GridControl.ClearSelectionCore
                      GridControl.set_FocusedRowHandle(intRow)
                      Call GridControl.FocusViewAndRow(GridControl,intRow)
                      GridControl.SetFocusOnCurrentItem
                      Call GridControl.SelectRowCore(intRow)
'                      log.Message "New Source Created"
'                      strTCRemarks="Upload successful" & "<br />" & "Level3 Source Created - " & DescText & "<br />" & "Attach Series - " & intSeriesID
                      Exit For   
                  End If 
               Next
    End if
        
        Delay 15000,"Pls Wait.."
      Call SClosesource()
      Delay 5000,"Pls Wait.."
    
    strTemp="WPFObject(""SourceTreeListView"")"
    objEditSource=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WaitChild(strTemp,15000000)
    if objEditSource.Exists = True then
                 
          strTemp="WPFObject(""ContentControlEx"", ""Add Folder"", 2)"
          Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 4).WPFObject("BarButtonItemLinkControl", "", 1).FindChild("Name",strTemp,50,True)
          If objNewWrkSpace_okbtn.Exists = True then
             If objNewWrkSpace_okbtn.Enabled = True then
              strTCRemarks = strTCRemarks & "<br />" & "Add Folder is found in Source"
              log.Message "Add Folder is found in Source"
             Else
              strTCRemarks = strTCRemarks & "<br />" & "Add Folder is Disabled in Source"
              log.Message "Add Folder is Disabled in Source"
             End if
          Else
            strTCRemarks = strTCRemarks & "<br />" & "Add Folder is  not found in Source"
            log.Message "Add Folder is not found in Source"
          End If
          
          strTemp="WPFObject(""ContentControlEx"", ""Delete Folder"", 2)"
          Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 7).WPFObject("BarButtonItemLinkControl", "", 1).FindChild("Name",strTemp,50,True)
          If objNewWrkSpace_okbtn.Exists = True then
             If objNewWrkSpace_okbtn.Enabled = True then
              strTCRemarks = strTCRemarks & "<br />" & "Delete Folder is found in Source"
              log.Message "Delete Folder is found in Source"
             Else
              strTCRemarks = strTCRemarks & "<br />" & "Delete Folder is Disabled in Source"
              log.Message "Delete Folder is Disabled in Source"
             End if
          Else
            strTCRemarks = strTCRemarks & "<br />" & "Delete Folder is  not found in Source"
            log.Message "Delete Folder is not found in Source"
          End If
          
          strTemp="WPFObject(""ContentControlEx"", ""Copy Folder"", 2)"
           Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 8).WPFObject("BarSubItemLinkControl", "", 1).FindChild("Name",strTemp,50,True)
          If objNewWrkSpace_okbtn.Exists = True then
             If objNewWrkSpace_okbtn.Enabled = True then
              strTCRemarks = strTCRemarks & "<br />" & "Copy Folder is found in Source"
              log.Message "Copy Folder is found in Source"
              objNewWrkSpace_okbtn.Click
             Else
              strTCRemarks = strTCRemarks & "<br />" & "Copy Folder is Disabled in Source"
              log.Message "Copy Folder is Disabled in Source"
             End if
          Else
            strTCRemarks = strTCRemarks & "<br />" & "Copy Folder is  not found in Source"
            log.Message "Copy Folder is not found in Source"
          End If

          strTemp="WPFObject(""ContentControlEx"", ""Cut Folder"", 2)"
          Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 9).WPFObject("BarButtonItemLinkControl", "", 1).FindChild("Name",strTemp,50,True)
          If objNewWrkSpace_okbtn.Exists = True then
             If objNewWrkSpace_okbtn.Enabled = True then
              strTCRemarks = strTCRemarks & "<br />" & "Cut Folder is found in Source"
              log.Message "Cut Folder is found in Source"
             Else
              strTCRemarks = strTCRemarks & "<br />" & "Cut Folder is Disabled in Source"
              log.Message "Cut Folder is Disabled in Source"
             End if 
          Else
            strTCRemarks = strTCRemarks & "<br />" & "Cut Folder is  not found in Source"
            log.Message "Cut Folder is not found in Source"
          End If

          
           strTemp="WPFObject(""ContentControlEx"", ""Workspace"", 2)"
          Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 11).WPFObject("BarSubItemLinkControl", "", 1).FindChild("Name",strTemp,50,True)
          If objNewWrkSpace_okbtn.Exists = True then
             If objNewWrkSpace_okbtn.Enabled = True then
              strTCRemarks = strTCRemarks & "<br />" & "Workspace Folder is found in Source"
              log.Message "Workspace Folder is found in Source"
             Else
              strTCRemarks = strTCRemarks & "<br />" & "Workspace Folder is Disabled in Source"
              log.Message "Workspace Folder is Disabled in Source"
             End if
          Else
            strTCRemarks = strTCRemarks & "<br />" & "Workpace Folder is  not found in Source"
            log.Message "Workspace Folder is not found in Source"
          End If
         
                          
    End if
 
  Call SClosesource()
  Call SourceWorkSpacevwr()
End Sub
Sub  sCheckSrcOpenEdit3LCopyFolder(strParameters)
On Error Resume Next 
   Dim strSource1,StrSource2,strSource3,strTemp,GridControl,GridSourceTree,intTotNodeCnt,intI,intJ,intRow,intK,objEdge
   Dim objNewWorkspace,objWrkspace_popup,objOpenView,strTemp1,objNewWrkSpaceName,objNewWrkSpace_Txtbox,objNewWrkSpace_okbtn,objNewWrkSpace_Name
   Dim strDesc1,strDesc2,DescText,DescLocalText
   Dim objEditSource
   
    strSource1=getSplitValue(strParameters,"SOURCE")
    StrSource2=getSplitValue(strParameters,"LEVEL2SOURCE")
    StrSource3=getSplitValue(strParameters,"LEVEL3SOURCE")
    
'    strSource1="Test"
'    StrSource2="Automation_UIT3"
'    StrSource3="Test"

    Call sHome_Source
    
    strDesc1=aqDateTime.Now
    strDesc2=aqDateTime.Now
    DescText=Replace(strDesc1,"/","-")
    DescText=Replace(DescText,":","_")
    DescLocalText=DescText
    strWrkSpaceName=DescText
'    intSeriesID=getSplitValue(strParameters,"SERIESID")
'    if intSeriesID=0 then
'      Call sSourceseries
'      intSeriesID=strSourceFileText
'    End if 
    
    strTemp="WPFObject(""SourceTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""SourceTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    Delay 10000,"Pls Wait.."
    ''Selecting Country Name
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
          GridControl.Nodes_2.Item(intI).Expand(True)
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description       
          blnFlag=False  
          Exit For
        End If
    Next
    If blnFlag = True then
      strTCRemarks="Country Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
  
    Delay 10000,"Pls Wait.."
        blnFlag = True 
    ''Selecting Level2Source_Name
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
  For intJ=0 to intTotNodeCnt-1
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(StrSource2) then
        GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
        intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
'        Call GridSourceTree.ClickCell(intRow, "Edit")
        Call GridControl.ClearSelectionCore
        Call GridControl.FocusViewAndRow(GridControl,intRow)
        GridControl.SetFocusOnCurrentItem
        Call GridControl.SelectRowCore(intRow)
        log.Message "Level2 Source Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
        blnFlag = False 
        Exit For
      End If
    Next
    If blnFlag = True then
      log.Message "Level2 Source Name not found"
      strTCRemarks="Level2 Source Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
    
     Delay 10000,"Pls Wait.."
    blnFlag = True 
   
    Delay 2000,"Pls Wait.."

    strTemp="WPFObject(""ArrowControl"", """", 1)"
    Set objNewWorkspace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,20,True)
    If objNewWorkspace.Exists = True then
      objNewWorkspace.Click
       strTemp="WPFObject(""BarPopupBorderControl"", """", 1)"
      Set objWrkspace_popup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").FindChild("Name",strTemp,5,True)
      If objWrkspace_popup.Exists = True then
        strTemp="WPFObject(""ContentControlEx"", ""Open For Edit (Source)"", 2)"
        Set objopenforEdit=objWrkspace_popup.FindChild("Name",strTemp,8,True)
        If objopenforEdit.Exists then
          objopenforEdit.Click    
          'Delay 20000,"Please Wait..."
        End If
      End if
      
      strTemp1="WPFObject(""HwndSource: WorkspaceNamePrompt"", ""Please provide a new Workspace Name"")"
      Set objNewWrkSpaceName=Sys.Process("EdgeClient").WaitChild(strTemp1,50000)
      If objNewWrkSpaceName.Exists = True then
     
      ''Waiting for Workspace Name prompt
      strTemp="WPFObject(""FloatingContainerBorder"")"
      Set objNewWrkSpace_Name=Sys.Process("EdgeClient").WPFObject("HwndSource: WorkspaceNamePrompt", "Please provide a new Workspace Name").WPFObject("WorkspaceNamePrompt", "Please provide a new Workspace Name", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,15000000)
      If objNewWrkSpace_Name.Exists = True then
          strTemp="WPFObject(""ChangeNameTextEdit"")"
          ''Entering Workspace Name
          Set objNewWrkSpace_Txtbox=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
            If objNewWrkSpace_Txtbox.Exists = True then
              objNewWrkSpace_Txtbox.Click
              objNewWrkSpace_Txtbox.Text=strWrkSpaceName
      '        strTCRemarks=strTCRemarks & Chr(10) & "Entered Workspace Name - " & strWrkSpaceName
              ''Clicking on Ok Button 
              strTemp="WPFObject(""OkButton"")"
              Set objNewWrkSpace_okbtn=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
              If objNewWrkSpace_okbtn.Exists = True then
                objNewWrkSpace_okbtn.Click
                'Delay 5000,"Please wait..."
              End If
            End If
        End If
      End if 
     End if 
       
  
       ''Handling Validation for Source
    strTemp="WPFObject(""HwndSource: WindowContentHolder"", """")"
    Set objTemp=Sys.Process("EdgeClient").WaitChild(strTemp,10000)
    If objTemp.Exists = True then
      objTemp.Keys "[Enter]"
      strTestCaseResult = "FAIL"
      Exit Sub
    End If

    ''WorkSpace Edit Window
    strTemp="WPFObject(""LayoutPanel"", """", 2)"
    Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,13,True)
    If objTemp.Exists then
        Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WPFObject("SourceTreeListView")
        Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl")
       Delay 10000,"Pls Wait.."
        ''Expanding First Node in Tree      
        intTotNodeCnt=GridControl.Nodes_2.Count  
        For intI=0 to intTotNodeCnt-1         
          If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
           GridControl.Nodes_2.Item(intI).Expand(True)
           'GridControl.Keys "^[Home]"
            blnFlag=False  
            Exit For
          End If
        Next
         Delay 10000,"Pls Wait.."
        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
          For intJ=0 to intTotNodeCnt-1
            If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strSource2) then
              GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
              intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(0).get_RowHandle
              GridControl.Keys "^[Home]"
              Call GridControl.ClearSelectionCore
              Call GridControl.FocusViewAndRow(GridControl,intRow-1)
              GridControl.SetFocusOnCurrentItem
              Call GridControl.SelectRowCore(intRow-1)
        
              If objGridCell.Exists = True then
                objGridCell.Click
              End If
              blnFlag = False 
              Exit For
            End If
          Next
           Delay 10000,"Pls Wait.."
              intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count
               For intK=0 to intTotNodeCnt-1
                  If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description)=Ucase(strSource3) then
                      intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).get_RowHandle
                      Call GridControl.ClearSelectionCore
                      GridControl.set_FocusedRowHandle(intRow)
                      Call GridControl.FocusViewAndRow(GridControl,intRow)
                      GridControl.SetFocusOnCurrentItem
                      Call GridControl.SelectRowCore(intRow)
'                     
                      Exit For   
                  End If 
               Next
    End if
        
        Delay 15000,"Pls Wait.."
      Call SClosesource()
      Delay 5000,"Pls Wait.."
    
    strTemp="WPFObject(""SourceTreeListView"")"
    objEditSource=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WaitChild(strTemp,15000000)
    if objEditSource.Exists = True then
                 
                   
          strTemp="WPFObject(""ContentControlEx"", ""Copy Folder"", 2)"
           Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 8).WPFObject("BarSubItemLinkControl", "", 1).FindChild("Name",strTemp,50,True)
          If objNewWrkSpace_okbtn.Exists = True then
             If objNewWrkSpace_okbtn.Enabled = True then
              strTCRemarks = strTCRemarks & "<br />" & "Copy Folder is found in Source"
              log.Message "Copy Folder is found in Source"
              objNewWrkSpace_okbtn.Click
'              Delay(5000)
              Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").Keys("[Down]")

              delay(10000)
              strTemp="WPFObject(""ContentControlEx"", ""Copy Folder Only"", 2)"
              Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarButtonItemLinkControl", "", 1).FindChild("Name",strTemp,50,True)
              If objNewWrkSpace_okbtn.Exists = True then
                 If objNewWrkSpace_okbtn.Enabled = True then
                  strTCRemarks = strTCRemarks & "<br />" & "Copy Folder only is found in Source"
                  log.Message "Copy Folder only is found in Source"
                  End if 
             End if
             
             strTemp="WPFObject(""ContentControlEx"", ""Copy Folder with Series"", 2)"
              Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 2).WPFObject("BarButtonItemLinkControl", "", 1).FindChild("Name",strTemp,50,True)
              If objNewWrkSpace_okbtn.Exists = True then
                 If objNewWrkSpace_okbtn.Enabled = True then
                  strTCRemarks = strTCRemarks & "<br />" & "Copy Folder with Series is found in Source"
                  log.Message "Copy Folder with series is found in Source"
                  End if 
             End if
'           End if
             Else
              strTCRemarks = strTCRemarks & "<br />" & "Copy Folder is Disabled in Source"
              log.Message "Copy Folder is Disabled in Source"
             End if
          Else
            strTCRemarks = strTCRemarks & "<br />" & "Copy Folder is  not found in Source"
            log.Message "Copy Folder is not found in Source"
          End If

         
    End if
 
  Call SClosesource()
  Call SourceWorkSpacevwr()
End Sub
Sub  sCheckSrcOpenEdit3LReplace(strParameters)
On Error Resume Next 
   Dim strSource1,StrSource2,strSource3,strTemp,GridControl,GridSourceTree,intTotNodeCnt,intI,intJ,intRow,intK,objEdge
   Dim objNewWorkspace,objWrkspace_popup,objOpenView,strTemp1,objNewWrkSpaceName,objNewWrkSpace_Txtbox,objNewWrkSpace_okbtn,objNewWrkSpace_Name
   Dim strDesc1,strDesc2,DescText,DescLocalText
   Dim objEditSource
   Dim objTemp, objStrClose
   
    strSource1=getSplitValue(strParameters,"SOURCE")
    StrSource2=getSplitValue(strParameters,"LEVEL2SOURCE")
    StrSource3=getSplitValue(strParameters,"LEVEL3SOURCE")
    
'    strSource1="Test"
'    StrSource2="Automation_UIT3"
'    StrSource3="Test"

    Call sHome_Source
    
    strDesc1=aqDateTime.Now
    strDesc2=aqDateTime.Now
    DescText=Replace(strDesc1,"/","-")
    DescText=Replace(DescText,":","_")
    DescLocalText=DescText
    strWrkSpaceName=DescText
'    intSeriesID=getSplitValue(strParameters,"SERIESID")
'    if intSeriesID=0 then
'      Call sSourceseries
'      intSeriesID=strSourceFileText
'    End if 
    
    strTemp="WPFObject(""SourceTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""SourceTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    Delay 10000,"Pls Wait.."
    ''Selecting Country Name
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
          GridControl.Nodes_2.Item(intI).Expand(True)
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description       
          blnFlag=False  
          Exit For
        End If
    Next
    If blnFlag = True then
      strTCRemarks="Country Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
  
    Delay 10000,"Pls Wait.."
        blnFlag = True 
    ''Selecting Level2Source_Name
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
  For intJ=0 to intTotNodeCnt-1
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(StrSource2) then
        GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
        intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
'        Call GridSourceTree.ClickCell(intRow, "Edit")
        Call GridControl.ClearSelectionCore
        Call GridControl.FocusViewAndRow(GridControl,intRow)
        GridControl.SetFocusOnCurrentItem
        Call GridControl.SelectRowCore(intRow)
        log.Message "Level2 Source Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
        blnFlag = False 
        Exit For
      End If
    Next
    If blnFlag = True then
      log.Message "Level2 Source Name not found"
      strTCRemarks="Level2 Source Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
    
     Delay 10000,"Pls Wait.."
    blnFlag = True 
   
    Delay 2000,"Pls Wait.."

    strTemp="WPFObject(""ArrowControl"", """", 1)"
    Set objNewWorkspace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,20,True)
    If objNewWorkspace.Exists = True then
      objNewWorkspace.Click
       strTemp="WPFObject(""BarPopupBorderControl"", """", 1)"
      Set objWrkspace_popup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").FindChild("Name",strTemp,5,True)
      If objWrkspace_popup.Exists = True then
        strTemp="WPFObject(""ContentControlEx"", ""Open For Edit (Source)"", 2)"
        Set objopenforEdit=objWrkspace_popup.FindChild("Name",strTemp,8,True)
        If objopenforEdit.Exists then
          objopenforEdit.Click    
          'Delay 20000,"Please Wait..."
        End If
      End if
      
      strTemp1="WPFObject(""HwndSource: WorkspaceNamePrompt"", ""Please provide a new Workspace Name"")"
      Set objNewWrkSpaceName=Sys.Process("EdgeClient").WaitChild(strTemp1,50000)
      If objNewWrkSpaceName.Exists = True then
     
      ''Waiting for Workspace Name prompt
      strTemp="WPFObject(""FloatingContainerBorder"")"
      Set objNewWrkSpace_Name=Sys.Process("EdgeClient").WPFObject("HwndSource: WorkspaceNamePrompt", "Please provide a new Workspace Name").WPFObject("WorkspaceNamePrompt", "Please provide a new Workspace Name", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,15000000)
      If objNewWrkSpace_Name.Exists = True then
          strTemp="WPFObject(""ChangeNameTextEdit"")"
          ''Entering Workspace Name
          Set objNewWrkSpace_Txtbox=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
            If objNewWrkSpace_Txtbox.Exists = True then
              objNewWrkSpace_Txtbox.Click
              objNewWrkSpace_Txtbox.Text=strWrkSpaceName
      '        strTCRemarks=strTCRemarks & Chr(10) & "Entered Workspace Name - " & strWrkSpaceName
              ''Clicking on Ok Button 
              strTemp="WPFObject(""OkButton"")"
              Set objNewWrkSpace_okbtn=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
              If objNewWrkSpace_okbtn.Exists = True then
                objNewWrkSpace_okbtn.Click
                'Delay 5000,"Please wait..."
              End If
            End If
        End If
      End if 
     End if 
       
  
       ''Handling Validation for Source
    strTemp="WPFObject(""HwndSource: WindowContentHolder"", """")"
    Set objTemp=Sys.Process("EdgeClient").WaitChild(strTemp,10000)
    If objTemp.Exists = True then
      objTemp.Keys "[Enter]"
      strTestCaseResult = "FAIL"
      Exit Sub
    End If

    ''WorkSpace Edit Window
    strTemp="WPFObject(""LayoutPanel"", """", 2)"
    Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,13,True)
    If objTemp.Exists then
        Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WPFObject("SourceTreeListView")
        Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl")
       Delay 10000,"Pls Wait.."
        ''Expanding First Node in Tree      
        intTotNodeCnt=GridControl.Nodes_2.Count  
        For intI=0 to intTotNodeCnt-1         
          If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
           GridControl.Nodes_2.Item(intI).Expand(True)
           'GridControl.Keys "^[Home]"
            blnFlag=False  
            Exit For
          End If
        Next
         Delay 10000,"Pls Wait.."
        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
          For intJ=0 to intTotNodeCnt-1
            If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strSource2) then
              GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
              intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(0).get_RowHandle
              GridControl.Keys "^[Home]"
              Call GridControl.ClearSelectionCore
              Call GridControl.FocusViewAndRow(GridControl,intRow-1)
              GridControl.SetFocusOnCurrentItem
              Call GridControl.SelectRowCore(intRow-1)
        
              If objGridCell.Exists = True then
                objGridCell.Click
              End If
              blnFlag = False 
              Exit For
            End If
          Next
           Delay 10000,"Pls Wait.."
              intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count
               For intK=0 to intTotNodeCnt-1
                  If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description)=Ucase(strSource3) then
                      intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).get_RowHandle
                      Call GridControl.ClearSelectionCore
                      GridControl.set_FocusedRowHandle(intRow)
                      Call GridControl.FocusViewAndRow(GridControl,intRow)
                      GridControl.SetFocusOnCurrentItem
                      Call GridControl.SelectRowCore(intRow)
'                     
                      Exit For   
                  End If 
               Next
    End if
        
        Delay 15000,"Pls Wait.."
      Call SClosesource()
      Delay 5000,"Pls Wait.."
    
    strTemp="WPFObject(""SourceTreeListView"")"
    objEditSource=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WaitChild(strTemp,15000000)
    if objEditSource.Exists = True then
       strTemp="WPFObject(""ContentControlEx"", ""Find & Replace"", 2)"
          Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 12).WPFObject("BarButtonItemLinkControl", "", 1).FindChild("Name",strTemp,50,True)
          If objNewWrkSpace_okbtn.Exists = True then
             If objNewWrkSpace_okbtn.Enabled = True then
              strTCRemarks = strTCRemarks & "<br />" & "Find & Replace  is found in Source"
              log.Message "Find & Replace is found in Source"
              objNewWrkSpace_okbtn.Click
               strTCRemarks = strTCRemarks & "<br />" & "Find & Replace  form opened in Source"
              log.Message "Find & Replace form opened in Source"
              strTemp="WPFObject(""FloatingContainerBackground"")"
              Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: SearchWindow", "Find").WPFObject("SearchWindow", "Find", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").FindChild("Name",strTemp,50,True)
               If objNewWrkSpace_okbtn.Exists = True then
               
                  strTemp="WPFObject(""Label"", ""Find What:"", 1)"
                  Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: SearchWindow", "Find").WPFObject("SearchWindow", "Find", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).FindChild("Name",strTemp,50,True)
                  If objNewWrkSpace_okbtn.Exists = True then
                     If objNewWrkSpace_okbtn.Enabled = True then
                      strTCRemarks = strTCRemarks & "<br />" & "Find What  is found in Find"
                      log.Message "Find What is found in Find"
                      Sys.Process("EdgeClient").WPFObject("HwndSource: SearchWindow", "Find").WPFObject("SearchWindow", "Find", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("FindText").Text="T"
                      End if
                  End if
                  
                  strTemp="WPFObject(""Label"", ""Replace with:"", 2)"
                  Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: SearchWindow", "Find").WPFObject("SearchWindow", "Find", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).FindChild("Name",strTemp,50,True)
                  If objNewWrkSpace_okbtn.Exists = True then
                     If objNewWrkSpace_okbtn.Enabled = True then
                      strTCRemarks = strTCRemarks & "<br />" & "Replace with is found in Find"
                      log.Message "Replace with is found in Find"
                      Sys.Process("EdgeClient").WPFObject("HwndSource: SearchWindow", "Find").WPFObject("SearchWindow", "Find", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("ReplaceText").Text="u"
                      Sys.Process("EdgeClient").WPFObject("HwndSource: SearchWindow", "Find").WPFObject("SearchWindow", "Find", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("ReplaceText").Click
                      End if
                  End if
                  
                 
                  
                  strTemp="WPFObject(""Button"", ""Replace"", 2)"
                  Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: SearchWindow", "Find").WPFObject("SearchWindow", "Find", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).FindChild("Name",strTemp,50,True)
                  If objNewWrkSpace_okbtn.Exists = True then
                     If objNewWrkSpace_okbtn.Enabled = True then
                      strTCRemarks = strTCRemarks & "<br />" & "Replace is found in Find"
                      log.Message "Replace is found in Find"
                      objNewWrkSpace_okbtn.Click
                      End if
                  End if
                  strTemp="WPFObject(""PART_CloseButton"")"
                  Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: SearchWindow", "Find").WPFObject("SearchWindow", "Find", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("PART_Header").WPFObject("Grid", "", 1).WPFObject("stackPanel").FindChild("Name",strTemp,50,True)
                  If objNewWrkSpace_okbtn.Exists = True then
                     If objNewWrkSpace_okbtn.Enabled = True then
                      strTCRemarks = strTCRemarks & "<br />" & "Close button  is found in Find"
                      log.Message "Close button is found in Find"
                      objNewWrkSpace_okbtn.Click
                      End if
                  End if
              End if  
              
             Else
              strTCRemarks = strTCRemarks & "<br />" & "Find & Replace  is Disabled in Source"
              log.Message "Find & Replace is Disabled in Source"
             End if
          Else
            strTCRemarks = strTCRemarks & "<br />" & "Find & Replace is  not found in Source"
            log.Message "Find & Replace is not found in Source"
          End If
         
    End if
 Dim strInform
   strInform= Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(0).Content.Description)
   strTCRemarks = strTCRemarks & "<br />" & strInform
              log.Message strInform
    Dim objSaveWrk,objWait  
     set objSaveWrk=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 12).WPFObject("BarSubItemLinkControl", "", 1)
    strTemp="WPFObject(""ContentControlEx"", ""Workspace"", 2)"
    Set objTemp=objSaveWrk.FindChild("Name",strTemp,50)
   objWait=1
    Do until objTemp.Enabled = true 
        If objWait < 20 Then
          Delay 1000,"Pls Wait... Form is loading..."
          objWait=objWait+1
        else
          Call SClosesource()
          Call SourceWorkSpacevwr()
          Exit Sub
        end if 
    Loop
    
    ''Save WorkSpace
    strTemp="WPFObject(""ContentControlEx"", ""Workspace"", 2)"
    Set objWrkSpace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,50,True)
    If objWrkSpace.Exists = True then
      objWrkSpace.Click
      Dim objEdgeFilter
      set objEdgeFilter= Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarButtonItemLinkControl", "", 1)
      strTemp="WPFObject(""ContentControlEx"", ""Save Workspace"", 2)"
      Set objTemp=objEdgeFilter.FindChild("Name",strTemp,50)
      If objTemp.Exists = TRUE then
        Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarButtonItemLinkControl", "", 1).WPFObject("ContentControlEx", "Save Workspace", 2).Click
        strTemp="WPFObject(""PART_ContainerContent"")"
        Set objConfirm=Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "Confirm save.").FindChild("Name",strTemp,50,True)
        If objConfirm.Exists = True then
            sys.Keys("Y")
            Set objConfirm = Sys.Process("EdgeClient")._
            Waitchild("WPFObject(""HwndSource: CustomMessageBoxWindow"", """")",600000)._
            Waitchild("WPFObject(""CustomMessageBoxWindow"", """", 1)",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""FloatingContainerBorder"")",60000)._
            Waitchild("WPFObject(""FloatingContainerBackground"")",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""FloatingContainerBody"")",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""PART_ContainerContent"")",60000)            
            If objConfirm.Exists = True Then
                objConfirm.Click
                SYS.Keys "[Enter]"
            End If
          End if 
        End if 
    End if 

  Call SClosesource()
  
  Call SourceWorkSpacevwr()
End Sub
Sub  sCheckSrcOpenEdit3LReplaceSelected(strParameters)
On Error Resume Next 
   Dim strSource1,StrSource2,strSource3,strTemp,GridControl,GridSourceTree,intTotNodeCnt,intI,intJ,intRow,intK,objEdge
   Dim objNewWorkspace,objWrkspace_popup,objOpenView,strTemp1,objNewWrkSpaceName,objNewWrkSpace_Txtbox,objNewWrkSpace_okbtn,objNewWrkSpace_Name
   Dim strDesc1,strDesc2,DescText,DescLocalText
   Dim objEditSource
   Dim objTemp, objStrClose
   
    strSource1=getSplitValue(strParameters,"SOURCE")
    StrSource2=getSplitValue(strParameters,"LEVEL2SOURCE")
    StrSource3=getSplitValue(strParameters,"LEVEL3SOURCE")
    
'    strSource1="Test"
'    StrSource2="Automation_UIT3"
'    StrSource3="Test"

    Call sHome_Source
    
    strDesc1=aqDateTime.Now
    strDesc2=aqDateTime.Now
    DescText=Replace(strDesc1,"/","-")
    DescText=Replace(DescText,":","_")
    DescLocalText=DescText
    strWrkSpaceName=DescText
'    intSeriesID=getSplitValue(strParameters,"SERIESID")
'    if intSeriesID=0 then
'      Call sSourceseries
'      intSeriesID=strSourceFileText
'    End if 
    
    strTemp="WPFObject(""SourceTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""SourceTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    Delay 10000,"Pls Wait.."
    ''Selecting Country Name
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
          GridControl.Nodes_2.Item(intI).Expand(True)
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description       
          blnFlag=False  
          Exit For
        End If
    Next
    If blnFlag = True then
      strTCRemarks="Country Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
  
    Delay 10000,"Pls Wait.."
        blnFlag = True 
    ''Selecting Level2Source_Name
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
  For intJ=0 to intTotNodeCnt-1
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(StrSource2) then
        GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
        intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
'        Call GridSourceTree.ClickCell(intRow, "Edit")
        Call GridControl.ClearSelectionCore
        Call GridControl.FocusViewAndRow(GridControl,intRow)
        GridControl.SetFocusOnCurrentItem
        Call GridControl.SelectRowCore(intRow)
        log.Message "Level2 Source Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
        blnFlag = False 
        Exit For
      End If
    Next
    If blnFlag = True then
      log.Message "Level2 Source Name not found"
      strTCRemarks="Level2 Source Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
    
     Delay 10000,"Pls Wait.."
    blnFlag = True 
   
    Delay 2000,"Pls Wait.."

    strTemp="WPFObject(""ArrowControl"", """", 1)"
    Set objNewWorkspace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,20,True)
    If objNewWorkspace.Exists = True then
      objNewWorkspace.Click
       strTemp="WPFObject(""BarPopupBorderControl"", """", 1)"
      Set objWrkspace_popup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").FindChild("Name",strTemp,5,True)
      If objWrkspace_popup.Exists = True then
        strTemp="WPFObject(""ContentControlEx"", ""Open For Edit (Source)"", 2)"
        Set objopenforEdit=objWrkspace_popup.FindChild("Name",strTemp,8,True)
        If objopenforEdit.Exists then
          objopenforEdit.Click    
        End If
      End if
      
      strTemp1="WPFObject(""HwndSource: WorkspaceNamePrompt"", ""Please provide a new Workspace Name"")"
      Set objNewWrkSpaceName=Sys.Process("EdgeClient").WaitChild(strTemp1,50000)
      If objNewWrkSpaceName.Exists = True then
     
      ''Waiting for Workspace Name prompt
      strTemp="WPFObject(""FloatingContainerBorder"")"
      Set objNewWrkSpace_Name=Sys.Process("EdgeClient").WPFObject("HwndSource: WorkspaceNamePrompt", "Please provide a new Workspace Name").WPFObject("WorkspaceNamePrompt", "Please provide a new Workspace Name", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,15000000)
      If objNewWrkSpace_Name.Exists = True then
          strTemp="WPFObject(""ChangeNameTextEdit"")"
          ''Entering Workspace Name
          Set objNewWrkSpace_Txtbox=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
            If objNewWrkSpace_Txtbox.Exists = True then
              objNewWrkSpace_Txtbox.Click
              objNewWrkSpace_Txtbox.Text=strWrkSpaceName
      '        strTCRemarks=strTCRemarks & Chr(10) & "Entered Workspace Name - " & strWrkSpaceName
              ''Clicking on Ok Button 
              strTemp="WPFObject(""OkButton"")"
              Set objNewWrkSpace_okbtn=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
              If objNewWrkSpace_okbtn.Exists = True then
                objNewWrkSpace_okbtn.Click
                'Delay 5000,"Please wait..."
              End If
            End If
        End If
      End if 
     End if 
       
  
       ''Handling Validation for Source
    strTemp="WPFObject(""HwndSource: WindowContentHolder"", """")"
    Set objTemp=Sys.Process("EdgeClient").WaitChild(strTemp,10000)
    If objTemp.Exists = True then
      objTemp.Keys "[Enter]"
      strTestCaseResult = "FAIL"
      Exit Sub
    End If

    ''WorkSpace Edit Window
    strTemp="WPFObject(""LayoutPanel"", """", 2)"
    Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,13,True)
    If objTemp.Exists then
        Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WPFObject("SourceTreeListView")
        Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl")
       Delay 10000,"Pls Wait.."
        ''Expanding First Node in Tree      
        intTotNodeCnt=GridControl.Nodes_2.Count  
        For intI=0 to intTotNodeCnt-1         
          If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
           GridControl.Nodes_2.Item(intI).Expand(True)
           blnFlag=False  
           Exit For
          End If
        Next
         Delay 10000,"Pls Wait.."
        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
          For intJ=0 to intTotNodeCnt-1
            If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strSource2) then
              GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
              intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(0).get_RowHandle
              GridControl.Keys "^[Home]"
              Call GridControl.ClearSelectionCore
              Call GridControl.FocusViewAndRow(GridControl,intRow-1)
              GridControl.SetFocusOnCurrentItem
              Call GridControl.SelectRowCore(intRow-1)
        
              If objGridCell.Exists = True then
                objGridCell.Click
              End If
              blnFlag = False 
              Exit For
            End If
          Next
           Delay 10000,"Pls Wait.."
              intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count
               For intK=0 to intTotNodeCnt-1
                  If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description)=Ucase(strSource3) then
                      intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).get_RowHandle
                      Call GridControl.ClearSelectionCore
                      GridControl.set_FocusedRowHandle(intRow)
                      Call GridControl.FocusViewAndRow(GridControl,intRow)
                      GridControl.SetFocusOnCurrentItem
                      Call GridControl.SelectRowCore(intRow)
                      Exit For   
                  End If 
               Next
    End if
        
        Delay 15000,"Pls Wait.."
      Call SClosesource()
      Delay 5000,"Pls Wait.."
    
    strTemp="WPFObject(""SourceTreeListView"")"
    objEditSource=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WaitChild(strTemp,15000000)
    if objEditSource.Exists = True then
       strTemp="WPFObject(""ContentControlEx"", ""Find & Replace"", 2)"
          Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 12).WPFObject("BarButtonItemLinkControl", "", 1).FindChild("Name",strTemp,50,True)
          If objNewWrkSpace_okbtn.Exists = True then
             If objNewWrkSpace_okbtn.Enabled = True then
              strTCRemarks = strTCRemarks & "<br />" & "Find & Replace  is found in Source"
              log.Message "Find & Replace is found in Source"
              objNewWrkSpace_okbtn.Click
               strTCRemarks = strTCRemarks & "<br />" & "Find & Replace  form opened in Source"
              log.Message "Find & Replace form opened in Source"
              strTemp="WPFObject(""FloatingContainerBackground"")"
              Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: SearchWindow", "Find").WPFObject("SearchWindow", "Find", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").FindChild("Name",strTemp,50,True)
               If objNewWrkSpace_okbtn.Exists = True then
               
                  strTemp="WPFObject(""Label"", ""Find What:"", 1)"
                  Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: SearchWindow", "Find").WPFObject("SearchWindow", "Find", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).FindChild("Name",strTemp,50,True)
                  If objNewWrkSpace_okbtn.Exists = True then
                     If objNewWrkSpace_okbtn.Enabled = True then
                      strTCRemarks = strTCRemarks & "<br />" & "Find What  is found in Find"
                      log.Message "Find What is found in Find"
                      Sys.Process("EdgeClient").WPFObject("HwndSource: SearchWindow", "Find").WPFObject("SearchWindow", "Find", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("FindText").Text="T"
                      End if
                  End if
                  
                  strTemp="WPFObject(""Label"", ""Replace with:"", 2)"
                  Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: SearchWindow", "Find").WPFObject("SearchWindow", "Find", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).FindChild("Name",strTemp,50,True)
                  If objNewWrkSpace_okbtn.Exists = True then
                     If objNewWrkSpace_okbtn.Enabled = True then
                      strTCRemarks = strTCRemarks & "<br />" & "Replace with is found in Find"
                      log.Message "Replace with is found in Find"
                      Sys.Process("EdgeClient").WPFObject("HwndSource: SearchWindow", "Find").WPFObject("SearchWindow", "Find", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("ReplaceText").Text="u"
                      Sys.Process("EdgeClient").WPFObject("HwndSource: SearchWindow", "Find").WPFObject("SearchWindow", "Find", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("ReplaceText").Click
                      End if
                  End if
                                   
                  strTemp="WPFObject(""Button"", ""Replace Selected"", 3)"
                  Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: SearchWindow", "Find").WPFObject("SearchWindow", "Find", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).FindChild("Name",strTemp,50,True)
                  If objNewWrkSpace_okbtn.Exists = True then
                     If objNewWrkSpace_okbtn.Enabled = True then
                      objNewWrkSpace_okbtn.Click
                      strTCRemarks = strTCRemarks & "<br />" & "Replace Selected  is found in Find"
                      log.Message "Replace Selected is found in Find"
                      End if
                  End if
                  Dim strInform
                  strTemp="WPFObject(""DXMessageBox"", """", 1)"
                  Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: WindowContentHolder", "Information").WPFObject("WindowContentHolder", "Information", 1).WPFObject("NonLogicalDecorator", "", 1).WPFObject("ThemedManagedContentPresenter", "", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").FindChild("Name",strTemp,50,True)
                  If objNewWrkSpace_okbtn.Exists = True then
                      strInform=Sys.Process("EdgeClient").WPFObject("HwndSource: WindowContentHolder", "Information").WPFObject("WindowContentHolder", "Information", 1).WPFObject("NonLogicalDecorator", "", 1).WPFObject("ThemedManagedContentPresenter", "", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("DXMessageBox", "", 1).Text
                      strTCRemarks = strTCRemarks & "<br />" & strInform
                      log.Message  strInform
                      SYS.Keys "[Enter]"
                  End if
                  
'                   strTemp="WPFObject(""Button"", ""Replace All"", 4)"
'                  Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: SearchWindow", "Find").WPFObject("SearchWindow", "Find", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).FindChild("Name",strTemp,50,True)
'                  If objNewWrkSpace_okbtn.Exists = True then
'                     If objNewWrkSpace_okbtn.Enabled = True then
'                      strTCRemarks = strTCRemarks & "<br />" & "Replace All  is found in Find"
'                      log.Message "Replace All is found in Find"
'                      End if
'                  End if
'                  
'                  
'                  strTemp="WPFObject(""FindText"")"
'                  Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: SearchWindow", "Find").WPFObject("SearchWindow", "Find", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).FindChild("Name",strTemp,50,True)
'                  If objNewWrkSpace_okbtn.Exists = True then
'                    Sys.Process("EdgeClient").WPFObject("HwndSource: SearchWindow", "Find").WPFObject("SearchWindow", "Find", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("FindText").Text=strSource1
'                     strTemp="WPFObject(""Button"", ""Find Next"", 1)"
'                      Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: SearchWindow", "Find").WPFObject("SearchWindow", "Find", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).FindChild("Name",strTemp,50,True)
'                      If objNewWrkSpace_okbtn.Exists = True then
'                         If objNewWrkSpace_okbtn.Enabled = True then
'                          objNewWrkSpace_okbtn.Click
'                          strTCRemarks = strTCRemarks & "<br />" & "Find Next is Clicked in Find"
'                          log.Message "Find Next text is highlighted in Form"
'                          strTCRemarks = strTCRemarks & "<br />" & "Find Next text highlighted in Form"
'                          log.Message "Find Next is found in Find"
'                          End if
'                      End if
'                  end if 
                  strTemp="WPFObject(""PART_CloseButton"")"
                  Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: SearchWindow", "Find").WPFObject("SearchWindow", "Find", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("PART_Header").WPFObject("Grid", "", 1).WPFObject("stackPanel").FindChild("Name",strTemp,50,True)
                  If objNewWrkSpace_okbtn.Exists = True then
                     If objNewWrkSpace_okbtn.Enabled = True then
                      strTCRemarks = strTCRemarks & "<br />" & "Close button  is found in Find"
                      log.Message "Close button is found in Find"
                      objNewWrkSpace_okbtn.Click
                      End if
                  End if
              End if  
              
             Else
              strTCRemarks = strTCRemarks & "<br />" & "Find & Replace  is Disabled in Source"
              log.Message "Find & Replace is Disabled in Source"
             End if
          Else
            strTCRemarks = strTCRemarks & "<br />" & "Find & Replace is  not found in Source"
            log.Message "Find & Replace is not found in Source"
          End If
         
    End if
 
    Dim objSaveWrk,objWait 
     set objSaveWrk=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 12).WPFObject("BarSubItemLinkControl", "", 1)
    strTemp="WPFObject(""ContentControlEx"", ""Workspace"", 2)"
    Set objTemp=objSaveWrk.FindChild("Name",strTemp,50)
   objWait=1
    Do until objTemp.Enabled = true 
        If objWait < 20 Then
          Delay 1000,"Pls Wait... Form is loading..."
          objWait=objWait+1
        else
          Call SClosesource()
          Call SourceWorkSpacevwr()
          Exit Sub
        end if 
    Loop 
    
    ''Save WorkSpace
    strTemp="WPFObject(""ContentControlEx"", ""Workspace"", 2)"
    Set objWrkSpace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,50,True)
    If objWrkSpace.Exists = True then
      objWrkSpace.Click
      Dim objEdgeFilter
      set objEdgeFilter= Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarButtonItemLinkControl", "", 1)
      strTemp="WPFObject(""ContentControlEx"", ""Save Workspace"", 2)"
      Set objTemp=objEdgeFilter.FindChild("Name",strTemp,50)
      If objTemp.Exists = TRUE then
        Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarButtonItemLinkControl", "", 1).WPFObject("ContentControlEx", "Save Workspace", 2).Click
        strTemp="WPFObject(""PART_ContainerContent"")"
        Set objConfirm=Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "Confirm save.").FindChild("Name",strTemp,50,True)
        If objConfirm.Exists = True then
            sys.Keys("Y")
            Set objConfirm = Sys.Process("EdgeClient")._
            Waitchild("WPFObject(""HwndSource: CustomMessageBoxWindow"", """")",600000)._
            Waitchild("WPFObject(""CustomMessageBoxWindow"", """", 1)",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""FloatingContainerBorder"")",60000)._
            Waitchild("WPFObject(""FloatingContainerBackground"")",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""FloatingContainerBody"")",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""PART_ContainerContent"")",60000)
                        
            If objConfirm.Exists = True Then
                objConfirm.Click
                SYS.Keys "[Enter]"
            End If
          End if 
        End if 
    End if 

  Call SClosesource()
  
  Call SourceWorkSpacevwr()
End Sub
Sub  sCheckSrcOpenEdit3LReplaceAll(strParameters)
On Error Resume Next 
   Dim strSource1,StrSource2,strSource3,strTemp,GridControl,GridSourceTree,intTotNodeCnt,intI,intJ,intRow,intK,objEdge
   Dim objNewWorkspace,objWrkspace_popup,objOpenView,strTemp1,objNewWrkSpaceName,objNewWrkSpace_Txtbox,objNewWrkSpace_okbtn,objNewWrkSpace_Name
   Dim strDesc1,strDesc2,DescText,DescLocalText
   Dim objEditSource
   Dim objTemp, objStrClose
   
    strSource1=getSplitValue(strParameters,"SOURCE")
    StrSource2=getSplitValue(strParameters,"LEVEL2SOURCE")
    StrSource3=getSplitValue(strParameters,"LEVEL3SOURCE")
    
'    strSource1="Test"
'    StrSource2="Automation_UIT3"
'    StrSource3="Test"

    Call sHome_Source
    
    strDesc1=aqDateTime.Now
    strDesc2=aqDateTime.Now
    DescText=Replace(strDesc1,"/","-")
    DescText=Replace(DescText,":","_")
    DescLocalText=DescText
    strWrkSpaceName=DescText
'    intSeriesID=getSplitValue(strParameters,"SERIESID")
'    if intSeriesID=0 then
'      Call sSourceseries
'      intSeriesID=strSourceFileText
'    End if 
    
    strTemp="WPFObject(""SourceTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""SourceTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    Delay 10000,"Pls Wait.."
    ''Selecting Country Name
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
          GridControl.Nodes_2.Item(intI).Expand(True)
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description       
          blnFlag=False  
          Exit For
        End If
    Next
    If blnFlag = True then
      strTCRemarks="Country Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
  
    Delay 10000,"Pls Wait.."
        blnFlag = True 
    ''Selecting Level2Source_Name
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
  For intJ=0 to intTotNodeCnt-1
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(StrSource2) then
        GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
        intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
'        Call GridSourceTree.ClickCell(intRow, "Edit")
        Call GridControl.ClearSelectionCore
        Call GridControl.FocusViewAndRow(GridControl,intRow)
        GridControl.SetFocusOnCurrentItem
        Call GridControl.SelectRowCore(intRow)
        log.Message "Level2 Source Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
        blnFlag = False 
        Exit For
      End If
    Next
    If blnFlag = True then
      log.Message "Level2 Source Name not found"
      strTCRemarks="Level2 Source Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
    
     Delay 10000,"Pls Wait.."
    blnFlag = True 
   
    Delay 2000,"Pls Wait.."

    strTemp="WPFObject(""ArrowControl"", """", 1)"
    Set objNewWorkspace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,20,True)
    If objNewWorkspace.Exists = True then
      objNewWorkspace.Click
       strTemp="WPFObject(""BarPopupBorderControl"", """", 1)"
      Set objWrkspace_popup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").FindChild("Name",strTemp,5,True)
      If objWrkspace_popup.Exists = True then
        strTemp="WPFObject(""ContentControlEx"", ""Open For Edit (Source)"", 2)"
        Set objopenforEdit=objWrkspace_popup.FindChild("Name",strTemp,8,True)
        If objopenforEdit.Exists then
          objopenforEdit.Click    
        End If
      End if
      
      strTemp1="WPFObject(""HwndSource: WorkspaceNamePrompt"", ""Please provide a new Workspace Name"")"
      Set objNewWrkSpaceName=Sys.Process("EdgeClient").WaitChild(strTemp1,50000)
      If objNewWrkSpaceName.Exists = True then
     
      ''Waiting for Workspace Name prompt
      strTemp="WPFObject(""FloatingContainerBorder"")"
      Set objNewWrkSpace_Name=Sys.Process("EdgeClient").WPFObject("HwndSource: WorkspaceNamePrompt", "Please provide a new Workspace Name").WPFObject("WorkspaceNamePrompt", "Please provide a new Workspace Name", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,15000000)
      If objNewWrkSpace_Name.Exists = True then
          strTemp="WPFObject(""ChangeNameTextEdit"")"
          ''Entering Workspace Name
          Set objNewWrkSpace_Txtbox=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
            If objNewWrkSpace_Txtbox.Exists = True then
              objNewWrkSpace_Txtbox.Click
              objNewWrkSpace_Txtbox.Text=strWrkSpaceName
      '        strTCRemarks=strTCRemarks & Chr(10) & "Entered Workspace Name - " & strWrkSpaceName
              ''Clicking on Ok Button 
              strTemp="WPFObject(""OkButton"")"
              Set objNewWrkSpace_okbtn=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
              If objNewWrkSpace_okbtn.Exists = True then
                objNewWrkSpace_okbtn.Click
                'Delay 5000,"Please wait..."
              End If
            End If
        End If
      End if 
     End if 
       
  
       ''Handling Validation for Source
    strTemp="WPFObject(""HwndSource: WindowContentHolder"", """")"
    Set objTemp=Sys.Process("EdgeClient").WaitChild(strTemp,10000)
    If objTemp.Exists = True then
      objTemp.Keys "[Enter]"
      strTestCaseResult = "FAIL"
      Exit Sub
    End If

    ''WorkSpace Edit Window
    strTemp="WPFObject(""LayoutPanel"", """", 2)"
    Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,13,True)
    If objTemp.Exists then
        Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WPFObject("SourceTreeListView")
        Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl")
       Delay 10000,"Pls Wait.."
        ''Expanding First Node in Tree      
        intTotNodeCnt=GridControl.Nodes_2.Count  
        For intI=0 to intTotNodeCnt-1         
          If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
           GridControl.Nodes_2.Item(intI).Expand(True)
           blnFlag=False  
           Exit For
          End If
        Next
         Delay 10000,"Pls Wait.."
        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
          For intJ=0 to intTotNodeCnt-1
            If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strSource2) then
              GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
              intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(0).get_RowHandle
              GridControl.Keys "^[Home]"
              Call GridControl.ClearSelectionCore
              Call GridControl.FocusViewAndRow(GridControl,intRow-1)
              GridControl.SetFocusOnCurrentItem
              Call GridControl.SelectRowCore(intRow-1)
        
              If objGridCell.Exists = True then
                objGridCell.Click
              End If
              blnFlag = False 
              Exit For
            End If
          Next
           Delay 10000,"Pls Wait.."
              intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count
               For intK=0 to intTotNodeCnt-1
                  If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description)=Ucase(strSource3) then
                      intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).get_RowHandle
                      Call GridControl.ClearSelectionCore
                      GridControl.set_FocusedRowHandle(intRow)
                      Call GridControl.FocusViewAndRow(GridControl,intRow)
                      GridControl.SetFocusOnCurrentItem
                      Call GridControl.SelectRowCore(intRow)
                      Exit For   
                  End If 
               Next
    End if
        
        Delay 15000,"Pls Wait.."
      Call SClosesource()
      Delay 5000,"Pls Wait.."
    
    strTemp="WPFObject(""SourceTreeListView"")"
    objEditSource=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WaitChild(strTemp,15000000)
    if objEditSource.Exists = True then
       strTemp="WPFObject(""ContentControlEx"", ""Find & Replace"", 2)"
          Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 12).WPFObject("BarButtonItemLinkControl", "", 1).FindChild("Name",strTemp,50,True)
          If objNewWrkSpace_okbtn.Exists = True then
             If objNewWrkSpace_okbtn.Enabled = True then
              strTCRemarks = strTCRemarks & "<br />" & "Find & Replace  is found in Source"
              log.Message "Find & Replace is found in Source"
              objNewWrkSpace_okbtn.Click
               strTCRemarks = strTCRemarks & "<br />" & "Find & Replace  form opened in Source"
              log.Message "Find & Replace form opened in Source"
              strTemp="WPFObject(""FloatingContainerBackground"")"
              Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: SearchWindow", "Find").WPFObject("SearchWindow", "Find", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").FindChild("Name",strTemp,50,True)
               If objNewWrkSpace_okbtn.Exists = True then
               
                  strTemp="WPFObject(""Label"", ""Find What:"", 1)"
                  Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: SearchWindow", "Find").WPFObject("SearchWindow", "Find", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).FindChild("Name",strTemp,50,True)
                  If objNewWrkSpace_okbtn.Exists = True then
                     If objNewWrkSpace_okbtn.Enabled = True then
                      strTCRemarks = strTCRemarks & "<br />" & "Find What  is found in Find"
                      log.Message "Find What is found in Find"
                      Sys.Process("EdgeClient").WPFObject("HwndSource: SearchWindow", "Find").WPFObject("SearchWindow", "Find", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("FindText").Text="T"
                      End if
                  End if
                  
                  strTemp="WPFObject(""Label"", ""Replace with:"", 2)"
                  Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: SearchWindow", "Find").WPFObject("SearchWindow", "Find", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).FindChild("Name",strTemp,50,True)
                  If objNewWrkSpace_okbtn.Exists = True then
                     If objNewWrkSpace_okbtn.Enabled = True then
                      strTCRemarks = strTCRemarks & "<br />" & "Replace with is found in Find"
                      log.Message "Replace with is found in Find"
                      Sys.Process("EdgeClient").WPFObject("HwndSource: SearchWindow", "Find").WPFObject("SearchWindow", "Find", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("ReplaceText").Text="u"
                      Sys.Process("EdgeClient").WPFObject("HwndSource: SearchWindow", "Find").WPFObject("SearchWindow", "Find", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("ReplaceText").Click
                      End if
                  End if
                   
                  strTemp="WPFObject(""Button"", ""Replace All"", 4)"
                  Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: SearchWindow", "Find").WPFObject("SearchWindow", "Find", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).FindChild("Name",strTemp,50,True)
                  If objNewWrkSpace_okbtn.Exists = True then
                     If objNewWrkSpace_okbtn.Enabled = True then
                      objNewWrkSpace_okbtn.Click
                      strTCRemarks = strTCRemarks & "<br />" & "Replace All  is found in Find"
                      log.Message "Replace All is found in Find"
                      End if
                  End if

                  Dim strInform
                  strTemp="WPFObject(""DXMessageBox"", """", 1)"
                  Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: WindowContentHolder", "Information").WPFObject("WindowContentHolder", "Information", 1).WPFObject("NonLogicalDecorator", "", 1).WPFObject("ThemedManagedContentPresenter", "", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").FindChild("Name",strTemp,50,True)
                  If objNewWrkSpace_okbtn.Exists = True then
                      strInform=Sys.Process("EdgeClient").WPFObject("HwndSource: WindowContentHolder", "Information").WPFObject("WindowContentHolder", "Information", 1).WPFObject("NonLogicalDecorator", "", 1).WPFObject("ThemedManagedContentPresenter", "", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("DXMessageBox", "", 1).Text
                      strTCRemarks = strTCRemarks & "<br />" & strInform
                      log.Message  strInform
                      SYS.Keys "[Enter]"
                  End if
'                  
'                  
'                  strTemp="WPFObject(""FindText"")"
'                  Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: SearchWindow", "Find").WPFObject("SearchWindow", "Find", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).FindChild("Name",strTemp,50,True)
'                  If objNewWrkSpace_okbtn.Exists = True then
'                    Sys.Process("EdgeClient").WPFObject("HwndSource: SearchWindow", "Find").WPFObject("SearchWindow", "Find", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("FindText").Text=strSource1
'                     strTemp="WPFObject(""Button"", ""Find Next"", 1)"
'                      Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: SearchWindow", "Find").WPFObject("SearchWindow", "Find", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).FindChild("Name",strTemp,50,True)
'                      If objNewWrkSpace_okbtn.Exists = True then
'                         If objNewWrkSpace_okbtn.Enabled = True then
'                          objNewWrkSpace_okbtn.Click
'                          strTCRemarks = strTCRemarks & "<br />" & "Find Next is Clicked in Find"
'                          log.Message "Find Next text is highlighted in Form"
'                          strTCRemarks = strTCRemarks & "<br />" & "Find Next text highlighted in Form"
'                          log.Message "Find Next is found in Find"
'                          End if
'                      End if
'                  end if 
                  strTemp="WPFObject(""PART_CloseButton"")"
                  Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: SearchWindow", "Find").WPFObject("SearchWindow", "Find", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("PART_Header").WPFObject("Grid", "", 1).WPFObject("stackPanel").FindChild("Name",strTemp,50,True)
                  If objNewWrkSpace_okbtn.Exists = True then
                     If objNewWrkSpace_okbtn.Enabled = True then
                      strTCRemarks = strTCRemarks & "<br />" & "Close button  is found in Find"
                      log.Message "Close button is found in Find"
                      objNewWrkSpace_okbtn.Click
                      End if
                  End if
              End if  
              
             Else
              strTCRemarks = strTCRemarks & "<br />" & "Find & Replace  is Disabled in Source"
              log.Message "Find & Replace is Disabled in Source"
             End if
          Else
            strTCRemarks = strTCRemarks & "<br />" & "Find & Replace is  not found in Source"
            log.Message "Find & Replace is not found in Source"
          End If
         
    End if
 

    Dim objSaveWrk,objWait  
     set objSaveWrk=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 12).WPFObject("BarSubItemLinkControl", "", 1)
    strTemp="WPFObject(""ContentControlEx"", ""Workspace"", 2)"
    Set objTemp=objSaveWrk.FindChild("Name",strTemp,50)
   objWait=1
    Do until objTemp.Enabled = true 
        If objWait < 20 Then
          Delay 1000,"Pls Wait... Form is loading..."
          objWait=objWait+1
        else
          Call SClosesource()
          Call SourceWorkSpacevwr()
          Exit Sub
        end if 
    Loop 
    
    ''Save WorkSpace
    strTemp="WPFObject(""ContentControlEx"", ""Workspace"", 2)"
    Set objWrkSpace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,50,True)
    If objWrkSpace.Exists = True then
      objWrkSpace.Click
      Dim objEdgeFilter
      set objEdgeFilter= Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarButtonItemLinkControl", "", 1)
      strTemp="WPFObject(""ContentControlEx"", ""Save Workspace"", 2)"
      Set objTemp=objEdgeFilter.FindChild("Name",strTemp,50)
      If objTemp.Exists = TRUE then
        Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarButtonItemLinkControl", "", 1).WPFObject("ContentControlEx", "Save Workspace", 2).Click
       strTemp="WPFObject(""PART_ContainerContent"")"
        Set objConfirm=Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "Confirm save.").FindChild("Name",strTemp,50,True)

          If objConfirm.Exists = True then
            sys.Keys("Y")
           Set objConfirm = Sys.Process("EdgeClient")._
            Waitchild("WPFObject(""HwndSource: CustomMessageBoxWindow"", """")",600000)._
            Waitchild("WPFObject(""CustomMessageBoxWindow"", """", 1)",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""FloatingContainerBorder"")",60000)._
            Waitchild("WPFObject(""FloatingContainerBackground"")",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""FloatingContainerBody"")",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""PART_ContainerContent"")",60000)
                        
            If objConfirm.Exists = True Then
                objConfirm.Click
                SYS.Keys "[Enter]"
            End If
          End if 
        End if 
    End if 

  Call SClosesource()
  
  Call SourceWorkSpacevwr()
End Sub
Sub  sCheckSrcOpenEdit3LAdd(strParameters)
On Error Resume Next 
   Dim strSource1,StrSource2,strSource3,strTemp,GridControl,GridSourceTree,intTotNodeCnt,intI,intJ,intRow,intK,objEdge
   Dim objNewWorkspace,objWrkspace_popup,objOpenView,strTemp1,objNewWrkSpaceName,objNewWrkSpace_Txtbox,objNewWrkSpace_okbtn,objNewWrkSpace_Name
   Dim strDesc1,strDesc2,DescText,DescLocalText
   Dim objEditSource
   Dim objTemp, objStrClose
   
    strSource1=getSplitValue(strParameters,"SOURCE")
    StrSource2=getSplitValue(strParameters,"LEVEL2SOURCE")
    StrSource3=getSplitValue(strParameters,"LEVEL3SOURCE")
    
'    strSource1="Test"
'    StrSource2="Automation_UIT2"
'    StrSource3="Test"

    Call sHome_Source
    
    strDesc1=aqDateTime.Now
    strDesc2=aqDateTime.Now
    DescText=Replace(strDesc1,"/","-")
    DescText=Replace(DescText,":","_")
    DescLocalText=DescText
    strWrkSpaceName=DescText
'    intSeriesID=getSplitValue(strParameters,"SERIESID")
'    if intSeriesID=0 then
'      Call sSourceseries
'      intSeriesID=strSourceFileText
'    End if 
    
    strTemp="WPFObject(""SourceTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""SourceTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    Delay 10000,"Pls Wait.."
    ''Selecting Country Name
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
          GridControl.Nodes_2.Item(intI).Expand(True)
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description       
          blnFlag=False  
          Exit For
        End If
    Next
    If blnFlag = True then
      strTCRemarks="Country Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
  
    Delay 10000,"Pls Wait.."
        blnFlag = True 
    ''Selecting Level2Source_Name
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
  For intJ=0 to intTotNodeCnt-1
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(StrSource2) then
        GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
        intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
'        Call GridSourceTree.ClickCell(intRow, "Edit")
        Call GridControl.ClearSelectionCore
        Call GridControl.FocusViewAndRow(GridControl,intRow)
        GridControl.SetFocusOnCurrentItem
        Call GridControl.SelectRowCore(intRow)
        log.Message "Level2 Source Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
        blnFlag = False 
        Exit For
      End If
    Next
    If blnFlag = True then
      log.Message "Level2 Source Name not found"
      strTCRemarks="Level2 Source Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
    
     Delay 10000,"Pls Wait.."
    blnFlag = True 
   
    Delay 2000,"Pls Wait.."

    strTemp="WPFObject(""ArrowControl"", """", 1)"
    Set objNewWorkspace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,20,True)
    If objNewWorkspace.Exists = True then
      objNewWorkspace.Click
       strTemp="WPFObject(""BarPopupBorderControl"", """", 1)"
      Set objWrkspace_popup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").FindChild("Name",strTemp,5,True)
      If objWrkspace_popup.Exists = True then
        strTemp="WPFObject(""ContentControlEx"", ""Open For Edit (Source)"", 2)"
        Set objopenforEdit=objWrkspace_popup.FindChild("Name",strTemp,8,True)
        If objopenforEdit.Exists then
          objopenforEdit.Click    
        End If
      End if
      
      strTemp1="WPFObject(""HwndSource: WorkspaceNamePrompt"", ""Please provide a new Workspace Name"")"
      Set objNewWrkSpaceName=Sys.Process("EdgeClient").WaitChild(strTemp1,50000)
      If objNewWrkSpaceName.Exists = True then
     
      ''Waiting for Workspace Name prompt
      strTemp="WPFObject(""FloatingContainerBorder"")"
      Set objNewWrkSpace_Name=Sys.Process("EdgeClient").WPFObject("HwndSource: WorkspaceNamePrompt", "Please provide a new Workspace Name").WPFObject("WorkspaceNamePrompt", "Please provide a new Workspace Name", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,15000000)
      If objNewWrkSpace_Name.Exists = True then
          strTemp="WPFObject(""ChangeNameTextEdit"")"
          ''Entering Workspace Name
          Set objNewWrkSpace_Txtbox=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
            If objNewWrkSpace_Txtbox.Exists = True then
              objNewWrkSpace_Txtbox.Click
              objNewWrkSpace_Txtbox.Text=strWrkSpaceName
      '        strTCRemarks=strTCRemarks & Chr(10) & "Entered Workspace Name - " & strWrkSpaceName
              ''Clicking on Ok Button 
              strTemp="WPFObject(""OkButton"")"
              Set objNewWrkSpace_okbtn=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
              If objNewWrkSpace_okbtn.Exists = True then
                objNewWrkSpace_okbtn.Click
                'Delay 5000,"Please wait..."
              End If
            End If
        End If
      End if 
     End if 
       
  
       ''Handling Validation for Source
    strTemp="WPFObject(""HwndSource: WindowContentHolder"", """")"
    Set objTemp=Sys.Process("EdgeClient").WaitChild(strTemp,10000)
    If objTemp.Exists = True then
      objTemp.Keys "[Enter]"
      strTestCaseResult = "FAIL"
      Exit Sub
    End If

    ''WorkSpace Edit Window
    strTemp="WPFObject(""LayoutPanel"", """", 2)"
    Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,13,True)
    If objTemp.Exists then
        Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WPFObject("SourceTreeListView")
        Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl")
       Delay 10000,"Pls Wait.."
        ''Expanding First Node in Tree      
        intTotNodeCnt=GridControl.Nodes_2.Count  
        For intI=0 to intTotNodeCnt-1         
          If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
           GridControl.Nodes_2.Item(intI).Expand(True)
           blnFlag=False  
           Exit For
          End If
        Next
         Delay 10000,"Pls Wait.."
        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
          For intJ=0 to intTotNodeCnt-1
            If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strSource2) then
             ' GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
              intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(0).get_RowHandle
              GridControl.Keys "^[Home]"
              Call GridControl.ClearSelectionCore
              Call GridControl.FocusViewAndRow(GridControl,intRow-1)
              GridControl.SetFocusOnCurrentItem
              Call GridControl.SelectRowCore(intRow-1)
        
              If objGridCell.Exists = True then
                objGridCell.Click
              End If
              blnFlag = False 
              Exit For
            End If
          Next
'           Delay 10000,"Pls Wait.."
'              intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count
'               For intK=0 to intTotNodeCnt-1
'                  If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description)=Ucase(strSource3) then
'                      intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).get_RowHandle
'                      Call GridControl.ClearSelectionCore
'                      GridControl.set_FocusedRowHandle(intRow)
'                      Call GridControl.FocusViewAndRow(GridControl,intRow)
'                      GridControl.SetFocusOnCurrentItem
'                      Call GridControl.SelectRowCore(intRow)
'                      Exit For   
'                  End If 
'               Next
    End if
        
'        Delay 15000,"Pls Wait.."
'      Call SClosesource()
'      Delay 5000,"Pls Wait.."
    
    strTemp="WPFObject(""SourceTreeListView"")"
    'objEditSource=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WaitChild(strTemp,15000000)
    objEditSource=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WaitChild(strTemp,15000000)
    if objEditSource.Exists = True then
       strTemp="WPFObject(""ContentControlEx"", ""Add Folder"", 2)"
          Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 4).WPFObject("BarButtonItemLinkControl", "", 1).FindChild("Name",strTemp,50,True)
          If objNewWrkSpace_okbtn.Exists = True then
             If objNewWrkSpace_okbtn.Enabled = True then
              strTCRemarks = strTCRemarks & "<br />" & "Add Folder is found in Source"
              log.Message "Add Folder is found in Source"
              objNewWrkSpace_okbtn.Click
              strTCRemarks = strTCRemarks & "<br />" & "New Folder Added "
              log.Message "New Folder Added"
             Else
              strTCRemarks = strTCRemarks & "<br />" & "Add Folder is Disabled in Source"
              log.Message "Add Folder is Disabled in Source"
             End if
          Else
            strTCRemarks = strTCRemarks & "<br />" & "Add Folder is  not found in Source"
            log.Message "Add Folder is not found in Source"
          End If
          
           Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 4).WPFObject("BarButtonItemLinkControl", "", 1)      
         Delay 8000,"New Folder..."

        ''Getting no. of Rows under level 2
        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count
        intK=intTotNodeCnt-1
    
        Set objDescCell=Aliases.EdgeClient.HwndSource_RibbonWindow.RibbonWindow.ContentControl.Grid.Grid.ContentControl.Grid.ContentControl.PART_ContainerContent.BarManager.DockPanel.DockLayoutManager.LayoutGroup.LayoutPanel2.Root.BarManager.AdornerDecorator.AdornedControl.Grid.DockPanel.SourceTreeListControl.SourceTreeListView.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK)
        Call objDescCell.Content.set_Description(DescText)
        Call objDescCell.Content.set_DescriptionLocal(DescLocalText)
          
         Delay 15000,"Pls Wait.."
      Call SClosesource()
      Delay 5000,"Pls Wait.."
                   
    End if
 

    Dim objSaveWrk,objWait  
     set objSaveWrk=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 12).WPFObject("BarSubItemLinkControl", "", 1)
   ' set objSaveWrk=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 12).WPFObject("BarSubItemLinkControl", "", 1)
    strTemp="WPFObject(""ContentControlEx"", ""Workspace"", 2)"
    Set objTemp=objSaveWrk.FindChild("Name",strTemp,50)
    objWait=1
    Do until objTemp.Enabled = true 
        If objWait < 20 Then
          Delay 1000,"Pls Wait... Form is loading..."
          objWait=objWait+1
        else
          Call SClosesource()
          Call SourceWorkSpacevwr()
          Exit Sub
        end if 
    Loop
    
    ''Save WorkSpace
    strTemp="WPFObject(""ContentControlEx"", ""Workspace"", 2)"
    Set objWrkSpace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,50,True)
    If objWrkSpace.Exists = True then
      objWrkSpace.Click
      Dim objEdgeFilter
      set objEdgeFilter= Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarButtonItemLinkControl", "", 1)
      strTemp="WPFObject(""ContentControlEx"", ""Save Workspace"", 2)"
      Set objTemp=objEdgeFilter.FindChild("Name",strTemp,50)
      If objTemp.Exists = TRUE then
        Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarButtonItemLinkControl", "", 1).WPFObject("ContentControlEx", "Save Workspace", 2).Click
        strTemp="WPFObject(""PART_ContainerContent"")"
        'Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "Confirm save.").WPFObject("CustomMessageBoxWindow", "Confirm save.", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent")
        Set objConfirm=Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "Confirm save.").FindChild("Name",strTemp,50,True)
'          strTemp="WPFObject(""DXMessageBox"", """", 1)"
'          Set objConfirm=objConfirm.WaitChild(strTemp,900000)
          If objConfirm.Exists = True then
            sys.Keys("Y")
           
            Set objConfirm = Sys.Process("EdgeClient")._
            Waitchild("WPFObject(""HwndSource: CustomMessageBoxWindow"", """")",600000)._
            Waitchild("WPFObject(""CustomMessageBoxWindow"", """", 1)",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""FloatingContainerBorder"")",60000)._
            Waitchild("WPFObject(""FloatingContainerBackground"")",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""FloatingContainerBody"")",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""PART_ContainerContent"")",60000)
                        
            If objConfirm.Exists = True Then
                objConfirm.Click
                SYS.Keys "[Enter]"
            End If
          End if 
        End if 
    End if 

  Call SClosesource()
  Call SourceWorkSpacevwr()
End Sub

Sub  sCheckSrcOpenEdit3LSCAdd(strParameters)
On Error Resume Next 
   Dim strSource1,StrSource2,strSource3,strTemp,GridControl,GridSourceTree,intTotNodeCnt,intI,intJ,intRow,intK,objEdge
   Dim objNewWorkspace,objWrkspace_popup,objOpenView,strTemp1,objNewWrkSpaceName,objNewWrkSpace_Txtbox,objNewWrkSpace_okbtn,objNewWrkSpace_Name
   Dim strDesc1,strDesc2,DescText,DescLocalText
   Dim objEditSource
   Dim objTemp, objStrClose
   
    strSource1=getSplitValue(strParameters,"SOURCE")
    StrSource2=getSplitValue(strParameters,"LEVEL2SOURCE")
    StrSource3=getSplitValue(strParameters,"LEVEL3SOURCE")
    
'    strSource1="Test"
'    StrSource2="Automation_UIT2"
'    StrSource3="Test"

    Call sHome_Source
    
    strDesc1=aqDateTime.Now
    strDesc2=aqDateTime.Now
    DescText=Replace(strDesc1,"/","-")
    DescText=Replace(DescText,":","_")
    DescLocalText=DescText
    strWrkSpaceName=DescText
'    intSeriesID=getSplitValue(strParameters,"SERIESID")
'    if intSeriesID=0 then
'      Call sSourceseries
'      intSeriesID=strSourceFileText
'    End if 
    
    strTemp="WPFObject(""SourceTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""SourceTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    Delay 10000,"Pls Wait.."
    ''Selecting Country Name
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
          GridControl.Nodes_2.Item(intI).Expand(True)
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description       
          blnFlag=False  
          Exit For
        End If
    Next
    If blnFlag = True then
      strTCRemarks="Country Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
  
    Delay 10000,"Pls Wait.."
        blnFlag = True 
    ''Selecting Level2Source_Name
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
  For intJ=0 to intTotNodeCnt-1
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(StrSource2) then
        GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
        intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
'        Call GridSourceTree.ClickCell(intRow, "Edit")
        Call GridControl.ClearSelectionCore
        Call GridControl.FocusViewAndRow(GridControl,intRow)
        GridControl.SetFocusOnCurrentItem
        Call GridControl.SelectRowCore(intRow)
        log.Message "Level2 Source Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
        blnFlag = False 
        Exit For
      End If
    Next
    If blnFlag = True then
      log.Message "Level2 Source Name not found"
      strTCRemarks="Level2 Source Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
    
     Delay 10000,"Pls Wait.."
    blnFlag = True 
   
    Delay 2000,"Pls Wait.."

    strTemp="WPFObject(""ArrowControl"", """", 1)"
    Set objNewWorkspace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,20,True)
    If objNewWorkspace.Exists = True then
      objNewWorkspace.Click
       strTemp="WPFObject(""BarPopupBorderControl"", """", 1)"
      Set objWrkspace_popup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").FindChild("Name",strTemp,5,True)
      If objWrkspace_popup.Exists = True then
        strTemp="WPFObject(""ContentControlEx"", ""Open For Edit (Source)"", 2)"
        Set objopenforEdit=objWrkspace_popup.FindChild("Name",strTemp,8,True)
        If objopenforEdit.Exists then
          objopenforEdit.Click    
        End If
      End if
      
      strTemp1="WPFObject(""HwndSource: WorkspaceNamePrompt"", ""Please provide a new Workspace Name"")"
      Set objNewWrkSpaceName=Sys.Process("EdgeClient").WaitChild(strTemp1,50000)
      If objNewWrkSpaceName.Exists = True then
     
      ''Waiting for Workspace Name prompt
      strTemp="WPFObject(""FloatingContainerBorder"")"
      Set objNewWrkSpace_Name=Sys.Process("EdgeClient").WPFObject("HwndSource: WorkspaceNamePrompt", "Please provide a new Workspace Name").WPFObject("WorkspaceNamePrompt", "Please provide a new Workspace Name", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,15000000)
      If objNewWrkSpace_Name.Exists = True then
          strTemp="WPFObject(""ChangeNameTextEdit"")"
          ''Entering Workspace Name
          Set objNewWrkSpace_Txtbox=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
            If objNewWrkSpace_Txtbox.Exists = True then
              objNewWrkSpace_Txtbox.Click
              objNewWrkSpace_Txtbox.Text=strWrkSpaceName
      '        strTCRemarks=strTCRemarks & Chr(10) & "Entered Workspace Name - " & strWrkSpaceName
              ''Clicking on Ok Button 
              strTemp="WPFObject(""OkButton"")"
              Set objNewWrkSpace_okbtn=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
              If objNewWrkSpace_okbtn.Exists = True then
                objNewWrkSpace_okbtn.Click
                'Delay 5000,"Please wait..."
              End If
            End If
        End If
      End if 
     End if 
       
  
       ''Handling Validation for Source
    strTemp="WPFObject(""HwndSource: WindowContentHolder"", """")"
    Set objTemp=Sys.Process("EdgeClient").WaitChild(strTemp,10000)
    If objTemp.Exists = True then
      objTemp.Keys "[Enter]"
      strTestCaseResult = "FAIL"
      Exit Sub
    End If

    ''WorkSpace Edit Window
    strTemp="WPFObject(""LayoutPanel"", """", 2)"
    Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,13,True)
    If objTemp.Exists then
        Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WPFObject("SourceTreeListView")
        Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl")
       Delay 10000,"Pls Wait.."
        ''Expanding First Node in Tree      
        intTotNodeCnt=GridControl.Nodes_2.Count  
        For intI=0 to intTotNodeCnt-1         
          If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
           GridControl.Nodes_2.Item(intI).Expand(True)
           blnFlag=False  
           Exit For
          End If
        Next
         Delay 10000,"Pls Wait.."
        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
          For intJ=0 to intTotNodeCnt-1
            If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strSource2) then
              GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
              intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(0).get_RowHandle
              GridControl.Keys "^[Home]"
              Call GridControl.ClearSelectionCore
              Call GridControl.FocusViewAndRow(GridControl,intRow-1)
              GridControl.SetFocusOnCurrentItem
              Call GridControl.SelectRowCore(intRow-1)
        
              If objGridCell.Exists = True then
                objGridCell.Click
              End If
              blnFlag = False 
              Exit For
            End If
          Next
'           Delay 10000,"Pls Wait.."
'              intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count
'               For intK=0 to intTotNodeCnt-1
'                  If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description)=Ucase(strSource3) then
'                      intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).get_RowHandle
'                      Call GridControl.ClearSelectionCore
'                      GridControl.set_FocusedRowHandle(intRow)
'                      Call GridControl.FocusViewAndRow(GridControl,intRow)
'                      GridControl.SetFocusOnCurrentItem
'                      Call GridControl.SelectRowCore(intRow)
'                      Exit For   
'                  End If 
'               Next
    End if
        
'        Delay 15000,"Pls Wait.."
'      Call SClosesource()
'      Delay 5000,"Pls Wait.."
    
    strTemp="WPFObject(""SourceTreeListView"")"
    'objEditSource=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WaitChild(strTemp,15000000)
    objEditSource=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WaitChild(strTemp,15000000)
    if objEditSource.Exists = True then
       strTemp="WPFObject(""ContentControlEx"", ""Add Folder"", 2)"
          Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 4).WPFObject("BarButtonItemLinkControl", "", 1).FindChild("Name",strTemp,50,True)
          If objNewWrkSpace_okbtn.Exists = True then
             If objNewWrkSpace_okbtn.Enabled = True then
              strTCRemarks = strTCRemarks & "<br />" & "Add Folder is found in Source"
              log.Message "Add Folder is found in Source"
              ''objNewWrkSpace_okbtn.Click
              SYS.Keys("^N")
              strTCRemarks = strTCRemarks & "<br />" & "New Folder Added "
              log.Message "New Folder Added"
             Else
              strTCRemarks = strTCRemarks & "<br />" & "Add Folder is Disabled in Source"
              log.Message "Add Folder is Disabled in Source"
             End if
          Else
            strTCRemarks = strTCRemarks & "<br />" & "Add Folder is  not found in Source"
            log.Message "Add Folder is not found in Source"
          End If
          
           Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 4).WPFObject("BarButtonItemLinkControl", "", 1)      
         Delay 8000,"New Folder..."

        ''Getting no. of Rows under level 2
        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count
        intK=intTotNodeCnt-1
    
        Set objDescCell=Aliases.EdgeClient.HwndSource_RibbonWindow.RibbonWindow.ContentControl.Grid.Grid.ContentControl.Grid.ContentControl.PART_ContainerContent.BarManager.DockPanel.DockLayoutManager.LayoutGroup.LayoutPanel2.Root.BarManager.AdornerDecorator.AdornedControl.Grid.DockPanel.SourceTreeListControl.SourceTreeListView.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK)
        Call objDescCell.Content.set_Description(DescText)
        strTCRemarks = strTCRemarks & "<br />" & "Description is added in new folder"
        log.Message "Description is added in new folder"
        
        Call objDescCell.Content.set_DescriptionLocal(DescLocalText)
        strTCRemarks = strTCRemarks & "<br />" & "Description local is added in new folder"
        log.Message "Description local is added in new folder"
            
          
         Delay 15000,"Pls Wait.."
      Call SClosesource()
      Delay 5000,"Pls Wait.."
                   
    End if
 

    Dim objSaveWrk,objWait
     set objSaveWrk=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 12).WPFObject("BarSubItemLinkControl", "", 1)
    strTemp="WPFObject(""ContentControlEx"", ""Workspace"", 2)"
    Set objTemp=objSaveWrk.FindChild("Name",strTemp,50)
    objWait=1
    Do until objTemp.Enabled = true 
        If objWait < 20 Then
          Delay 1000,"Pls Wait... Form is loading..."
          objWait=objWait+1
        else
          Call SClosesource()
          Call SourceWorkSpacevwr()
          Exit Sub
        end if 
    Loop 
    
    
    ''Save WorkSpace
    strTemp="WPFObject(""ContentControlEx"", ""Workspace"", 2)"
    Set objWrkSpace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,50,True)
    If objWrkSpace.Exists = True then
      objWrkSpace.Click
      Dim objEdgeFilter
      set objEdgeFilter= Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarButtonItemLinkControl", "", 1)
      strTemp="WPFObject(""ContentControlEx"", ""Save Workspace"", 2)"
      Set objTemp=objEdgeFilter.FindChild("Name",strTemp,50)
      If objTemp.Exists = TRUE then
        Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarButtonItemLinkControl", "", 1).WPFObject("ContentControlEx", "Save Workspace", 2).Click
        strTemp="WPFObject(""PART_ContainerContent"")"
        Set objConfirm=Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "Confirm save.").FindChild("Name",strTemp,50,True)

          If objConfirm.Exists = True then
            sys.Keys("Y")
            Set objConfirm = Sys.Process("EdgeClient")._
            Waitchild("WPFObject(""HwndSource: CustomMessageBoxWindow"", """")",600000)._
            Waitchild("WPFObject(""CustomMessageBoxWindow"", """", 1)",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""FloatingContainerBorder"")",60000)._
            Waitchild("WPFObject(""FloatingContainerBackground"")",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""FloatingContainerBody"")",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""PART_ContainerContent"")",60000)
                        
            If objConfirm.Exists = True Then
                objConfirm.Click
                SYS.Keys "[Enter]"
            End If
          End if 
        End if 
    End if 

  Call SClosesource()
  Call SourceWorkSpacevwr()
End Sub

Sub  sCheckSrcOpenEdit3LSType()
On Error Resume Next 
   Dim strSource1,StrSource2,strSource3,strTemp,GridControl,GridSourceTree,intTotNodeCnt,intI,intJ,intRow,intK,objEdge
   Dim objNewWorkspace,objWrkspace_popup,objOpenView,strTemp1,objNewWrkSpaceName,objNewWrkSpace_Txtbox,objNewWrkSpace_okbtn,objNewWrkSpace_Name
   Dim strDesc1,strDesc2,DescText,DescLocalText
   Dim objEditSource
   Dim objTemp, objStrClose
   
'    strSource1=getSplitValue(strParameters,"SOURCE")
'    StrSource2=getSplitValue(strParameters,"LEVEL2SOURCE")
'    StrSource3=getSplitValue(strParameters,"LEVEL3SOURCE")
    
    strSource1="Test"
    StrSource2="Automation_UIT2"
    StrSource3="Test"

    Call sHome_Source
    
    strDesc1=aqDateTime.Now
    strDesc2=aqDateTime.Now
    DescText=Replace(strDesc1,"/","-")
    DescText=Replace(DescText,":","_")
    DescLocalText=DescText
    strWrkSpaceName=DescText
    
    
    strTemp="WPFObject(""SourceTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""SourceTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    Delay 10000,"Pls Wait.."
    ''Selecting Country Name
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
          GridControl.Nodes_2.Item(intI).Expand(True)
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description       
          blnFlag=False  
          Exit For
        End If
    Next
    If blnFlag = True then
      strTCRemarks="Country Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
  
    Delay 10000,"Pls Wait.."
        blnFlag = True 
    ''Selecting Level2Source_Name
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
  For intJ=0 to intTotNodeCnt-1
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(StrSource2) then
        GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
        intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
'        Call GridSourceTree.ClickCell(intRow, "Edit")
        Call GridControl.ClearSelectionCore
        Call GridControl.FocusViewAndRow(GridControl,intRow)
        GridControl.SetFocusOnCurrentItem
        Call GridControl.SelectRowCore(intRow)
        log.Message "Level2 Source Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
        blnFlag = False 
        Exit For
      End If
    Next
    If blnFlag = True then
      log.Message "Level2 Source Name not found"
      strTCRemarks="Level2 Source Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
    
     Delay 10000,"Pls Wait.."
    blnFlag = True 
   
    Delay 2000,"Pls Wait.."

    strTemp="WPFObject(""ArrowControl"", """", 1)"
    Set objNewWorkspace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,20,True)
    If objNewWorkspace.Exists = True then
      objNewWorkspace.Click
       strTemp="WPFObject(""BarPopupBorderControl"", """", 1)"
      Set objWrkspace_popup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").FindChild("Name",strTemp,5,True)
      If objWrkspace_popup.Exists = True then
        strTemp="WPFObject(""ContentControlEx"", ""Open For Edit (Source)"", 2)"
        Set objopenforEdit=objWrkspace_popup.FindChild("Name",strTemp,8,True)
        If objopenforEdit.Exists then
          objopenforEdit.Click    
        End If
      End if
      
      strTemp1="WPFObject(""HwndSource: WorkspaceNamePrompt"", ""Please provide a new Workspace Name"")"
      Set objNewWrkSpaceName=Sys.Process("EdgeClient").WaitChild(strTemp1,50000)
      If objNewWrkSpaceName.Exists = True then
     
      ''Waiting for Workspace Name prompt
      strTemp="WPFObject(""FloatingContainerBorder"")"
      Set objNewWrkSpace_Name=Sys.Process("EdgeClient").WPFObject("HwndSource: WorkspaceNamePrompt", "Please provide a new Workspace Name").WPFObject("WorkspaceNamePrompt", "Please provide a new Workspace Name", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,15000000)
      If objNewWrkSpace_Name.Exists = True then
          strTemp="WPFObject(""ChangeNameTextEdit"")"
          ''Entering Workspace Name
          Set objNewWrkSpace_Txtbox=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
            If objNewWrkSpace_Txtbox.Exists = True then
              objNewWrkSpace_Txtbox.Click
              objNewWrkSpace_Txtbox.Text=strWrkSpaceName
      '        strTCRemarks=strTCRemarks & Chr(10) & "Entered Workspace Name - " & strWrkSpaceName
              ''Clicking on Ok Button 
              strTemp="WPFObject(""OkButton"")"
              Set objNewWrkSpace_okbtn=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
              If objNewWrkSpace_okbtn.Exists = True then
                objNewWrkSpace_okbtn.Click
                'Delay 5000,"Please wait..."
              End If
            End If
        End If
      End if 
     End if 
       
  
       ''Handling Validation for Source
    strTemp="WPFObject(""HwndSource: WindowContentHolder"", """")"
    Set objTemp=Sys.Process("EdgeClient").WaitChild(strTemp,10000)
    If objTemp.Exists = True then
      objTemp.Keys "[Enter]"
      strTestCaseResult = "FAIL"
      Exit Sub
    End If

    ''WorkSpace Edit Window
    strTemp="WPFObject(""LayoutPanel"", """", 2)"
    Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,13,True)
    If objTemp.Exists then
        Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WPFObject("SourceTreeListView")
        Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl")
       Delay 10000,"Pls Wait.."
        ''Expanding First Node in Tree      
        intTotNodeCnt=GridControl.Nodes_2.Count  
        For intI=0 to intTotNodeCnt-1         
          If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
           GridControl.Nodes_2.Item(intI).Expand(True)
           blnFlag=False  
           Exit For
          End If
        Next
         Delay 10000,"Pls Wait.."
        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
          For intJ=0 to intTotNodeCnt-1
            If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strSource2) then
              GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
              intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(0).get_RowHandle
              GridControl.Keys "^[Home]"
              Call GridControl.ClearSelectionCore
              Call GridControl.FocusViewAndRow(GridControl,intRow-1)
              GridControl.SetFocusOnCurrentItem
              Call GridControl.SelectRowCore(intRow-1)
        
              If objGridCell.Exists = True then
                objGridCell.Click
              End If
              blnFlag = False 
              Exit For
            End If
          Next
           Delay 10000,"Pls Wait.."
              intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count
               For intK=0 to intTotNodeCnt-1
                  If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description)=Ucase(strSource3) then
                      intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).get_RowHandle
                      Call GridControl.ClearSelectionCore
                      GridControl.set_FocusedRowHandle(intRow)
                      Call GridControl.FocusViewAndRow(GridControl,intRow)
                      GridControl.SetFocusOnCurrentItem
                   '  set GridControl= Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WPFObject("SourceTreeListView")
                      Call GridControl.SelectRowCore(intRow)
                     
                      Exit For   
                  End If 
               Next
    End if
        
'        Delay 15000,"Pls Wait.."
'      Call SClosesource()
'      Delay 5000,"Pls Wait.."
    
    
 
    Delay 15000,"Pls Wait.."
    Call SClosesource()
    Delay 5000,"Pls Wait.."
    
    strTemp="WPFObject(""SourceTreeListView"")"
    set objEditSource=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WPFObject("SourceTreeListView")
    if objEditSource.Exists = True then
      Call objEditSource.Click(intRow, "URL")
      Call objEditSource.DblClick(intRow, "Source Type")
      Call objEditSource.Click(0,"System ID")   
      Call objEditSource.Click(0,1)   
     ' Call objEditSource. 
'     objEditSource.  
    End if
      
    Dim objSaveWrk,objWait
     set objSaveWrk=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 12).WPFObject("BarSubItemLinkControl", "", 1)
    strTemp="WPFObject(""ContentControlEx"", ""Workspace"", 2)"
    Set objTemp=objSaveWrk.FindChild("Name",strTemp,50)
    objWait=1
    Do until objTemp.Enabled = true 
        If objWait < 20 Then
          Delay 1000,"Pls Wait... Form is loading..."
          objWait=objWait+1
        else
          Call SClosesource()
          Call SourceWorkSpacevwr()
          Exit Sub
        end if 
    Loop 
    
    ''Save WorkSpace
    strTemp="WPFObject(""ContentControlEx"", ""Workspace"", 2)"
    Set objWrkSpace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,50,True)
    If objWrkSpace.Exists = True then
      objWrkSpace.Click
      Dim objEdgeFilter
      set objEdgeFilter= Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarButtonItemLinkControl", "", 1)
      strTemp="WPFObject(""ContentControlEx"", ""Save Workspace"", 2)"
      Set objTemp=objEdgeFilter.FindChild("Name",strTemp,50)
      If objTemp.Exists = TRUE then
        Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarButtonItemLinkControl", "", 1).WPFObject("ContentControlEx", "Save Workspace", 2).Click
        strTemp="WPFObject(""PART_ContainerContent"")"
        Set objConfirm=Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "Confirm save.").FindChild("Name",strTemp,50,True)

          If objConfirm.Exists = True then
            sys.Keys("Y")
            Set objConfirm = Sys.Process("EdgeClient")._
            Waitchild("WPFObject(""HwndSource: CustomMessageBoxWindow"", """")",600000)._
            Waitchild("WPFObject(""CustomMessageBoxWindow"", """", 1)",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""FloatingContainerBorder"")",60000)._
            Waitchild("WPFObject(""FloatingContainerBackground"")",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""FloatingContainerBody"")",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""PART_ContainerContent"")",60000)
                        
            If objConfirm.Exists = True Then
                objConfirm.Click
                SYS.Keys "[Enter]"
            End If
          End if 
        End if 
    End if 

  Call SClosesource()
  Call SourceWorkSpacevwr()
End Sub

Sub  sCheckSrcOpenEdit3LAddZero(strParameters)
On Error Resume Next 
   Dim strSource1,StrSource2,strSource3,strTemp,GridControl,GridSourceTree,intTotNodeCnt,intI,intJ,intRow,intK,objEdge
   Dim objNewWorkspace,objWrkspace_popup,objOpenView,strTemp1,objNewWrkSpaceName,objNewWrkSpace_Txtbox,objNewWrkSpace_okbtn,objNewWrkSpace_Name
   Dim strDesc1,strDesc2,DescText,DescLocalText
   Dim objEditSource
   Dim objTemp, objStrClose
   
    strSource1=getSplitValue(strParameters,"SOURCE")
    StrSource2=getSplitValue(strParameters,"LEVEL2SOURCE")
    StrSource3=getSplitValue(strParameters,"LEVEL3SOURCE")
    
'    strSource1="Test"
'    StrSource2="Automation_UIT2"
'    StrSource3="Test"

    Call sHome_Source
    
    strDesc1=aqDateTime.Now
    strDesc2=aqDateTime.Now
    DescText=Replace(strDesc1,"/","-")
    DescText=Replace(DescText,":","_")
    DescLocalText=DescText
    strWrkSpaceName=DescText
'    intSeriesID=getSplitValue(strParameters,"SERIESID")
'    if intSeriesID=0 then
'      Call sSourceseries
'      intSeriesID=strSourceFileText
'    End if 
    
    strTemp="WPFObject(""SourceTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""SourceTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    Delay 10000,"Pls Wait.."
    ''Selecting Country Name
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
          GridControl.Nodes_2.Item(intI).Expand(True)
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description       
          blnFlag=False  
          Exit For
        End If
    Next
    If blnFlag = True then
      strTCRemarks="Country Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
  
    Delay 10000,"Pls Wait.."
        blnFlag = True 
    ''Selecting Level2Source_Name
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
  For intJ=0 to intTotNodeCnt-1
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(StrSource2) then
        GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
        intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
'        Call GridSourceTree.ClickCell(intRow, "Edit")
        Call GridControl.ClearSelectionCore
        Call GridControl.FocusViewAndRow(GridControl,intRow)
        GridControl.SetFocusOnCurrentItem
        Call GridControl.SelectRowCore(intRow)
        log.Message "Level2 Source Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
        blnFlag = False 
        Exit For
      End If
    Next
    If blnFlag = True then
      log.Message "Level2 Source Name not found"
      strTCRemarks="Level2 Source Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
    
     Delay 10000,"Pls Wait.."
    blnFlag = True 
   
    Delay 2000,"Pls Wait.."

    strTemp="WPFObject(""ArrowControl"", """", 1)"
    Set objNewWorkspace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,20,True)
    If objNewWorkspace.Exists = True then
      objNewWorkspace.Click
       strTemp="WPFObject(""BarPopupBorderControl"", """", 1)"
      Set objWrkspace_popup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").FindChild("Name",strTemp,5,True)
      If objWrkspace_popup.Exists = True then
        strTemp="WPFObject(""ContentControlEx"", ""Open For Edit (Source)"", 2)"
        Set objopenforEdit=objWrkspace_popup.FindChild("Name",strTemp,8,True)
        If objopenforEdit.Exists then
          objopenforEdit.Click    
        End If
      End if
      
      strTemp1="WPFObject(""HwndSource: WorkspaceNamePrompt"", ""Please provide a new Workspace Name"")"
      Set objNewWrkSpaceName=Sys.Process("EdgeClient").WaitChild(strTemp1,50000)
      If objNewWrkSpaceName.Exists = True then
     
      ''Waiting for Workspace Name prompt
      strTemp="WPFObject(""FloatingContainerBorder"")"
      Set objNewWrkSpace_Name=Sys.Process("EdgeClient").WPFObject("HwndSource: WorkspaceNamePrompt", "Please provide a new Workspace Name").WPFObject("WorkspaceNamePrompt", "Please provide a new Workspace Name", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,15000000)
      If objNewWrkSpace_Name.Exists = True then
          strTemp="WPFObject(""ChangeNameTextEdit"")"
          ''Entering Workspace Name
          Set objNewWrkSpace_Txtbox=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
            If objNewWrkSpace_Txtbox.Exists = True then
              objNewWrkSpace_Txtbox.Click
              objNewWrkSpace_Txtbox.Text=strWrkSpaceName
      '        strTCRemarks=strTCRemarks & Chr(10) & "Entered Workspace Name - " & strWrkSpaceName
              ''Clicking on Ok Button 
              strTemp="WPFObject(""OkButton"")"
              Set objNewWrkSpace_okbtn=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
              If objNewWrkSpace_okbtn.Exists = True then
                objNewWrkSpace_okbtn.Click
                'Delay 5000,"Please wait..."
              End If
            End If
        End If
      End if 
     End if 
       
  
       ''Handling Validation for Source
    strTemp="WPFObject(""HwndSource: WindowContentHolder"", """")"
    Set objTemp=Sys.Process("EdgeClient").WaitChild(strTemp,10000)
    If objTemp.Exists = True then
      objTemp.Keys "[Enter]"
      strTestCaseResult = "FAIL"
      Exit Sub
    End If

    ''WorkSpace Edit Window
    strTemp="WPFObject(""LayoutPanel"", """", 2)"
    Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,13,True)
    If objTemp.Exists then
        Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WPFObject("SourceTreeListView")
        Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl")
       Delay 10000,"Pls Wait.."
        ''Expanding First Node in Tree      
        intTotNodeCnt=GridControl.Nodes_2.Count  
        For intI=0 to intTotNodeCnt-1         
          If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
           GridControl.Nodes_2.Item(intI).Expand(True)
           blnFlag=False  
           Exit For
          End If
        Next
         Delay 10000,"Pls Wait.."
        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
          For intJ=0 to intTotNodeCnt-1
            If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strSource2) then
              GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
              intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(0).get_RowHandle
              GridControl.Keys "^[Home]"
              Call GridControl.ClearSelectionCore
              Call GridControl.FocusViewAndRow(GridControl,intRow-1)
              GridControl.SetFocusOnCurrentItem
              Call GridControl.SelectRowCore(intRow-1)
            
              If objGridCell.Exists = True then
                objGridCell.Click
              End If
              blnFlag = False 
              Exit For
            End If
          Next
    End if
        
'        Delay 15000,"Pls Wait.."
'      Call SClosesource()
'      Delay 5000,"Pls Wait.."
    
    strTemp="WPFObject(""SourceTreeListView"")"
    objEditSource=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WaitChild(strTemp,15000000)
    if objEditSource.Exists = True then
    
      strTemp="WPFObject(""SpinEdit"", """", 1)"
      Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 5).WPFObject("BarEditItemLinkControl", "", 1).WPFObject("ContentControlEx", "", 1).FindChild("Name",strTemp,50,True)
      If objNewWrkSpace_okbtn.Exists = True then
         If objNewWrkSpace_okbtn.Enabled = True then
            Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 5).WPFObject("BarEditItemLinkControl", "", 1).WPFObject("ContentControlEx", "", 1).WPFObject("SpinEdit", "", 1).Value=0
            strTCRemarks = strTCRemarks & "<br />" & "Value is out of Range"
            log.Message "Value is out of Range"
         End if 
      End if 
           
      Delay 15000,"Pls Wait.."
      Call SClosesource()
      Delay 5000,"Pls Wait.."
                   
    End if
 


  Call SClosesource()
  Call SourceWorkSpacevwr()
End Sub

Sub  sCheckSrcOpenEdit3LInc(strParameters)
On Error Resume Next 
   Dim strSource1,StrSource2,strSource3,strTemp,GridControl,GridSourceTree,intTotNodeCnt,intI,intJ,intRow,intK,objEdge
   Dim objNewWorkspace,objWrkspace_popup,objOpenView,strTemp1,objNewWrkSpaceName,objNewWrkSpace_Txtbox,objNewWrkSpace_okbtn,objNewWrkSpace_Name
   Dim strDesc1,strDesc2,DescText,DescLocalText
   Dim objEditSource
   Dim objTemp, objStrClose
   
    strSource1=getSplitValue(strParameters,"SOURCE")
    StrSource2=getSplitValue(strParameters,"LEVEL2SOURCE")
    StrSource3=getSplitValue(strParameters,"LEVEL3SOURCE")
    
'    strSource1="Test"
'    StrSource2="Automation_UIT2"
'    StrSource3="Test"

    Call sHome_Source
    
    strDesc1=aqDateTime.Now
    strDesc2=aqDateTime.Now
    DescText=Replace(strDesc1,"/","-")
    DescText=Replace(DescText,":","_")
    DescLocalText=DescText
    strWrkSpaceName=DescText
'    intSeriesID=getSplitValue(strParameters,"SERIESID")
'    if intSeriesID=0 then
'      Call sSourceseries
'      intSeriesID=strSourceFileText
'    End if 
    
    strTemp="WPFObject(""SourceTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""SourceTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    Delay 10000,"Pls Wait.."
    ''Selecting Country Name
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
          GridControl.Nodes_2.Item(intI).Expand(True)
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description       
          blnFlag=False  
          Exit For
        End If
    Next
    If blnFlag = True then
      strTCRemarks="Country Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
  
    Delay 10000,"Pls Wait.."
        blnFlag = True 
    ''Selecting Level2Source_Name
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
  For intJ=0 to intTotNodeCnt-1
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(StrSource2) then
        GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
        intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
'        Call GridSourceTree.ClickCell(intRow, "Edit")
        Call GridControl.ClearSelectionCore
        Call GridControl.FocusViewAndRow(GridControl,intRow)
        GridControl.SetFocusOnCurrentItem
        Call GridControl.SelectRowCore(intRow)
        log.Message "Level2 Source Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
        blnFlag = False 
        Exit For
      End If
    Next
    If blnFlag = True then
      log.Message "Level2 Source Name not found"
      strTCRemarks="Level2 Source Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
    
     Delay 10000,"Pls Wait.."
    blnFlag = True 
   
    Delay 2000,"Pls Wait.."

    strTemp="WPFObject(""ArrowControl"", """", 1)"
    Set objNewWorkspace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,20,True)
    If objNewWorkspace.Exists = True then
      objNewWorkspace.Click
       strTemp="WPFObject(""BarPopupBorderControl"", """", 1)"
      Set objWrkspace_popup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").FindChild("Name",strTemp,5,True)
      If objWrkspace_popup.Exists = True then
        strTemp="WPFObject(""ContentControlEx"", ""Open For Edit (Source)"", 2)"
        Set objopenforEdit=objWrkspace_popup.FindChild("Name",strTemp,8,True)
        If objopenforEdit.Exists then
          objopenforEdit.Click    
        End If
      End if
      
      strTemp1="WPFObject(""HwndSource: WorkspaceNamePrompt"", ""Please provide a new Workspace Name"")"
      Set objNewWrkSpaceName=Sys.Process("EdgeClient").WaitChild(strTemp1,50000)
      If objNewWrkSpaceName.Exists = True then
     
      ''Waiting for Workspace Name prompt
      strTemp="WPFObject(""FloatingContainerBorder"")"
      Set objNewWrkSpace_Name=Sys.Process("EdgeClient").WPFObject("HwndSource: WorkspaceNamePrompt", "Please provide a new Workspace Name").WPFObject("WorkspaceNamePrompt", "Please provide a new Workspace Name", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,15000000)
      If objNewWrkSpace_Name.Exists = True then
          strTemp="WPFObject(""ChangeNameTextEdit"")"
          ''Entering Workspace Name
          Set objNewWrkSpace_Txtbox=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
            If objNewWrkSpace_Txtbox.Exists = True then
              objNewWrkSpace_Txtbox.Click
              objNewWrkSpace_Txtbox.Text=strWrkSpaceName
      '        strTCRemarks=strTCRemarks & Chr(10) & "Entered Workspace Name - " & strWrkSpaceName
              ''Clicking on Ok Button 
              strTemp="WPFObject(""OkButton"")"
              Set objNewWrkSpace_okbtn=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
              If objNewWrkSpace_okbtn.Exists = True then
                objNewWrkSpace_okbtn.Click
                'Delay 5000,"Please wait..."
              End If
            End If
        End If
      End if 
     End if 
       
  
       ''Handling Validation for Source
    strTemp="WPFObject(""HwndSource: WindowContentHolder"", """")"
    Set objTemp=Sys.Process("EdgeClient").WaitChild(strTemp,10000)
    If objTemp.Exists = True then
      objTemp.Keys "[Enter]"
      strTestCaseResult = "FAIL"
      Exit Sub
    End If

    ''WorkSpace Edit Window
    strTemp="WPFObject(""LayoutPanel"", """", 2)"
    Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,13,True)
    If objTemp.Exists then
        Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WPFObject("SourceTreeListView")
        Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl")
       Delay 10000,"Pls Wait.."
        ''Expanding First Node in Tree      
        intTotNodeCnt=GridControl.Nodes_2.Count  
        For intI=0 to intTotNodeCnt-1         
          If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
           GridControl.Nodes_2.Item(intI).Expand(True)
           blnFlag=False  
           Exit For
          End If
        Next
         Delay 10000,"Pls Wait.."
        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
          For intJ=0 to intTotNodeCnt-1
            If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strSource2) then
              GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
              intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(0).get_RowHandle
              GridControl.Keys "^[Home]"
              Call GridControl.ClearSelectionCore
              Call GridControl.FocusViewAndRow(GridControl,intRow-1)
              GridControl.SetFocusOnCurrentItem
              Call GridControl.SelectRowCore(intRow-1)
            
              If objGridCell.Exists = True then
                objGridCell.Click
              End If
              blnFlag = False 
              Exit For
            End If
          Next
'           Delay 10000,"Pls Wait.."
'              intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count
'               For intK=0 to intTotNodeCnt-1
'                  If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description)=Ucase(strSource3) then
'                      intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).get_RowHandle
'                      Call GridControl.ClearSelectionCore
'                      GridControl.set_FocusedRowHandle(intRow)
'                      Call GridControl.FocusViewAndRow(GridControl,intRow)
'                      GridControl.SetFocusOnCurrentItem
'                      Call GridControl.SelectRowCore(intRow)
'                      Exit For   
'                  End If 
'               Next
    End if
        
'        Delay 15000,"Pls Wait.."
'      Call SClosesource()
'      Delay 5000,"Pls Wait.."
    Dim strIvalue,strIvalue1
    strTemp="WPFObject(""SourceTreeListView"")"
    'objEditSource=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WaitChild(strTemp,15000000)
    objEditSource=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WaitChild(strTemp,15000000)
    if objEditSource.Exists = True then
    
      strTemp="WPFObject(""SpinEdit"", """", 1)"
      Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 5).WPFObject("BarEditItemLinkControl", "", 1).WPFObject("ContentControlEx", "", 1).FindChild("Name",strTemp,50,True)
      If objNewWrkSpace_okbtn.Exists = True then
         If objNewWrkSpace_okbtn.Enabled = True then
            strIvalue=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 5).WPFObject("BarEditItemLinkControl", "", 1).WPFObject("ContentControlEx", "", 1).WPFObject("SpinEdit", "", 1).Text
            log.Message "Increament value" & strIvalue
           
            Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 5).WPFObject("BarEditItemLinkControl", "", 1).WPFObject("ContentControlEx", "", 1).WPFObject("SpinEdit", "", 1).WPFObject("ButtonContainer", "", 1).WPFObject("Border", "", 1).WPFObject("MainGrid").WPFObject("PART_SpinUpButton").Click
            Delay(5000)
            strIvalue1=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 5).WPFObject("BarEditItemLinkControl", "", 1).WPFObject("ContentControlEx", "", 1).WPFObject("SpinEdit", "", 1).Text
            strTCRemarks = strTCRemarks & "<br />" & "Increament value:" & strIvalue1
            log.Message "Increament value" & strIvalue1
            
            
            Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 5).WPFObject("BarEditItemLinkControl", "", 1).WPFObject("ContentControlEx", "", 1).WPFObject("SpinEdit", "", 1).WPFObject("ButtonContainer", "", 1).WPFObject("Border", "", 1).WPFObject("MainGrid").WPFObject("PART_SpinDownButton").Click
            Delay(5000)
            strIvalue1=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 5).WPFObject("BarEditItemLinkControl", "", 1).WPFObject("ContentControlEx", "", 1).WPFObject("SpinEdit", "", 1).Text
            strTCRemarks = strTCRemarks & "<br />" & "Decrement value:" & strIvalue1
            log.Message "Increament value" & strIvalue1
         End if 
      End if 
       
   '   "ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 5).WPFObject("BarEditItemLinkControl", "", 1).WPFObject("ContentControlEx", "", 1).WPFObject("SpinEdit", "", 1).WPFObject("ButtonContainer", "", 1).WPFObject("Border", "", 1).WPFObject("MainGrid").WPFObject("PART_SpinUpButton").WPFObject("Grid", "", 1).WPFObject("Path", "", 2)

'       strTemp="WPFObject(""ContentControlEx"", ""Add Folder"", 2)"
'          Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 4).WPFObject("BarButtonItemLinkControl", "", 1).FindChild("Name",strTemp,50,True)
'          If objNewWrkSpace_okbtn.Exists = True then
'             If objNewWrkSpace_okbtn.Enabled = True then
'              strTCRemarks = strTCRemarks & "<br />" & "Add Folder is found in Source"
'              log.Message "Add Folder is found in Source"
'              ''objNewWrkSpace_okbtn.Click
'              SYS.Keys("^N")
'              strTCRemarks = strTCRemarks & "<br />" & "New Folder Added "
'              log.Message "New Folder Added"
'             Else
'              strTCRemarks = strTCRemarks & "<br />" & "Add Folder is Disabled in Source"
'              log.Message "Add Folder is Disabled in Source"
'             End if
'          Else
'            strTCRemarks = strTCRemarks & "<br />" & "Add Folder is  not found in Source"
'            log.Message "Add Folder is not found in Source"
'          End If
'          
'           Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 4).WPFObject("BarButtonItemLinkControl", "", 1)      
'         Delay 8000,"New Folder..."
'
'        ''Getting no. of Rows under level 2
'        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count
'        intK=intTotNodeCnt-1
'    
'        Set objDescCell=Aliases.EdgeClient.HwndSource_RibbonWindow.RibbonWindow.ContentControl.Grid.Grid.ContentControl.Grid.ContentControl.PART_ContainerContent.BarManager.DockPanel.DockLayoutManager.LayoutGroup.LayoutPanel2.Root.BarManager.AdornerDecorator.AdornedControl.Grid.DockPanel.SourceTreeListControl.SourceTreeListView.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK)
'        Call objDescCell.Content.set_Description(DescText)
'        Call objDescCell.Content.set_DescriptionLocal(DescLocalText)
          
         Delay 15000,"Pls Wait.."
      Call SClosesource()
      Delay 5000,"Pls Wait.."
                   
    End if
 
  Call SClosesource()
  Call SourceWorkSpacevwr()
End Sub

Sub  sCheckSrcOpenEdit3AddUpdate(strParameters)
On Error Resume Next 
   Dim strSource1,StrSource2,strSource3,strTemp,GridControl,GridSourceTree,intTotNodeCnt,intI,intJ,intRow,intK,objEdge
   Dim objNewWorkspace,objWrkspace_popup,objOpenView,strTemp1,objNewWrkSpaceName,objNewWrkSpace_Txtbox,objNewWrkSpace_okbtn,objNewWrkSpace_Name
   Dim strDesc1,strDesc2,DescText,DescLocalText
   Dim objEditSource
   Dim objTemp, objStrClose
   
    strSource1=getSplitValue(strParameters,"SOURCE")
    StrSource2=getSplitValue(strParameters,"LEVEL2SOURCE")
    StrSource3=getSplitValue(strParameters,"LEVEL3SOURCE")
    
'    strSource1="Test"
'    StrSource2="Automation_UIT2"
'    StrSource3="Test"

    Call sHome_Source
    
    strDesc1=aqDateTime.Now
    strDesc2=aqDateTime.Now
    DescText=Replace(strDesc1,"/","-")
    DescText=Replace(DescText,":","_")
    DescLocalText=DescText
    strWrkSpaceName=DescText
'    intSeriesID=getSplitValue(strParameters,"SERIESID")
'    if intSeriesID=0 then
'      Call sSourceseries
'      intSeriesID=strSourceFileText
'    End if 
    
    strTemp="WPFObject(""SourceTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""SourceTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    Delay 10000,"Pls Wait.."
    ''Selecting Country Name
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
          GridControl.Nodes_2.Item(intI).Expand(True)
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description       
          blnFlag=False  
          Exit For
        End If
    Next
    If blnFlag = True then
      strTCRemarks="Country Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
  
    Delay 10000,"Pls Wait.."
        blnFlag = True 
    ''Selecting Level2Source_Name
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
  For intJ=0 to intTotNodeCnt-1
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(StrSource2) then
        GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
        intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
'        Call GridSourceTree.ClickCell(intRow, "Edit")
        Call GridControl.ClearSelectionCore
        Call GridControl.FocusViewAndRow(GridControl,intRow)
        GridControl.SetFocusOnCurrentItem
        Call GridControl.SelectRowCore(intRow)
        log.Message "Level2 Source Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
        blnFlag = False 
        Exit For
      End If
    Next
    If blnFlag = True then
      log.Message "Level2 Source Name not found"
      strTCRemarks="Level2 Source Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
    
     Delay 10000,"Pls Wait.."
    blnFlag = True 
   
    Delay 2000,"Pls Wait.."

    strTemp="WPFObject(""ArrowControl"", """", 1)"
    Set objNewWorkspace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,20,True)
    If objNewWorkspace.Exists = True then
      objNewWorkspace.Click
       strTemp="WPFObject(""BarPopupBorderControl"", """", 1)"
      Set objWrkspace_popup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").FindChild("Name",strTemp,5,True)
      If objWrkspace_popup.Exists = True then
        strTemp="WPFObject(""ContentControlEx"", ""Open For Edit (Source)"", 2)"
        Set objopenforEdit=objWrkspace_popup.FindChild("Name",strTemp,8,True)
        If objopenforEdit.Exists then
          objopenforEdit.Click    
        End If
      End if
      
      strTemp1="WPFObject(""HwndSource: WorkspaceNamePrompt"", ""Please provide a new Workspace Name"")"
      Set objNewWrkSpaceName=Sys.Process("EdgeClient").WaitChild(strTemp1,50000)
      If objNewWrkSpaceName.Exists = True then
     
      ''Waiting for Workspace Name prompt
      strTemp="WPFObject(""FloatingContainerBorder"")"
      Set objNewWrkSpace_Name=Sys.Process("EdgeClient").WPFObject("HwndSource: WorkspaceNamePrompt", "Please provide a new Workspace Name").WPFObject("WorkspaceNamePrompt", "Please provide a new Workspace Name", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,15000000)
      If objNewWrkSpace_Name.Exists = True then
          strTemp="WPFObject(""ChangeNameTextEdit"")"
          ''Entering Workspace Name
          Set objNewWrkSpace_Txtbox=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
            If objNewWrkSpace_Txtbox.Exists = True then
              objNewWrkSpace_Txtbox.Click
              objNewWrkSpace_Txtbox.Text=strWrkSpaceName
      '        strTCRemarks=strTCRemarks & Chr(10) & "Entered Workspace Name - " & strWrkSpaceName
              ''Clicking on Ok Button 
              strTemp="WPFObject(""OkButton"")"
              Set objNewWrkSpace_okbtn=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
              If objNewWrkSpace_okbtn.Exists = True then
                objNewWrkSpace_okbtn.Click
                'Delay 5000,"Please wait..."
              End If
            End If
        End If
      End if 
     End if 
       
  
       ''Handling Validation for Source
    strTemp="WPFObject(""HwndSource: WindowContentHolder"", """")"
    Set objTemp=Sys.Process("EdgeClient").WaitChild(strTemp,10000)
    If objTemp.Exists = True then
      objTemp.Keys "[Enter]"
      strTestCaseResult = "FAIL"
      Exit Sub
    End If

    ''WorkSpace Edit Window
    strTemp="WPFObject(""LayoutPanel"", """", 2)"
    Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,13,True)
    If objTemp.Exists then
        Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WPFObject("SourceTreeListView")
        Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl")
       Delay 10000,"Pls Wait.."
        ''Expanding First Node in Tree      
        intTotNodeCnt=GridControl.Nodes_2.Count  
        For intI=0 to intTotNodeCnt-1         
          If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
           GridControl.Nodes_2.Item(intI).Expand(True)
           blnFlag=False  
           Exit For
          End If
        Next
         Delay 10000,"Pls Wait.."
        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
          For intJ=0 to intTotNodeCnt-1
            If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strSource2) then
              GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
              intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(0).get_RowHandle
              GridControl.Keys "^[Home]"
              Call GridControl.ClearSelectionCore
              Call GridControl.FocusViewAndRow(GridControl,intRow-1)
              GridControl.SetFocusOnCurrentItem
              Call GridControl.SelectRowCore(intRow-1)
        
              If objGridCell.Exists = True then
                objGridCell.Click
              End If
              blnFlag = False 
              Exit For
            End If
          Next
'           Delay 10000,"Pls Wait.."
'              intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count
'               For intK=0 to intTotNodeCnt-1
'                  If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description)=Ucase(strSource3) then
'                      intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).get_RowHandle
'                      Call GridControl.ClearSelectionCore
'                      GridControl.set_FocusedRowHandle(intRow)
'                      Call GridControl.FocusViewAndRow(GridControl,intRow)
'                      GridControl.SetFocusOnCurrentItem
'                      Call GridControl.SelectRowCore(intRow)
'                      Exit For   
'                  End If 
'               Next
    End if
        
'        Delay 15000,"Pls Wait.."
'      Call SClosesource()
'      Delay 5000,"Pls Wait.."
    
    strTemp="WPFObject(""SourceTreeListView"")"
    'objEditSource=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WaitChild(strTemp,15000000)
    objEditSource=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WaitChild(strTemp,15000000)
    if objEditSource.Exists = True then
'       strTemp="WPFObject(""ContentControlEx"", ""Add Folder"", 2)"
'          Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 4).WPFObject("BarButtonItemLinkControl", "", 1).FindChild("Name",strTemp,50,True)
'          If objNewWrkSpace_okbtn.Exists = True then
'             If objNewWrkSpace_okbtn.Enabled = True then
'              strTCRemarks = strTCRemarks & "<br />" & "Add Folder is found in Source"
'              log.Message "Add Folder is found in Source"
'              ''objNewWrkSpace_okbtn.Click
'              SYS.Keys("^N")
'              strTCRemarks = strTCRemarks & "<br />" & "New Folder Added "
'              log.Message "New Folder Added"
'             Else
'              strTCRemarks = strTCRemarks & "<br />" & "Add Folder is Disabled in Source"
'              log.Message "Add Folder is Disabled in Source"
'             End if
'          Else
'            strTCRemarks = strTCRemarks & "<br />" & "Add Folder is  not found in Source"
'            log.Message "Add Folder is not found in Source"
'          End If

          strTemp="WPFObject(""ContentControlEx"", ""Add Folder"", 2)"
          'Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 4).WPFObject("BarButtonItemLinkControl", "", 1).FindChild("Name",strTemp,50,True)
          Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 4).WPFObject("BarButtonItemLinkControl", "", 1).FindChild("Name",strTemp,50,True)
          If objNewWrkSpace_okbtn.Exists = True then
             If objNewWrkSpace_okbtn.Enabled = True then
              objNewWrkSpace_okbtn.Click
              strTCRemarks = strTCRemarks & "<br />" & "Add Folder is found in Source"
              log.Message "Add Folder is found in Source"
             Else
              strTCRemarks = strTCRemarks & "<br />" & "Add Folder is Disabled in Source"
              log.Message "Add Folder is Disabled in Source"
             End if
          Else
            strTCRemarks = strTCRemarks & "<br />" & "Add Folder is  not found in Source"
            log.Message "Add Folder is not found in Source"
          End If   
        
          
           Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 4).WPFObject("BarButtonItemLinkControl", "", 1)      
         Delay 8000,"New Folder..."

        ''Getting no. of Rows under level 2
        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count
        intK=intTotNodeCnt-1
    
        Set objDescCell=Aliases.EdgeClient.HwndSource_RibbonWindow.RibbonWindow.ContentControl.Grid.Grid.ContentControl.Grid.ContentControl.PART_ContainerContent.BarManager.DockPanel.DockLayoutManager.LayoutGroup.LayoutPanel2.Root.BarManager.AdornerDecorator.AdornedControl.Grid.DockPanel.SourceTreeListControl.SourceTreeListView.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK)
        Call objDescCell.Content.set_Description(DescText)
        strTCRemarks = strTCRemarks & "<br />" & "Description is added in new folder"
        log.Message "Description is added in new folder"
        
        Call objDescCell.Content.set_DescriptionLocal(DescLocalText)
        strTCRemarks = strTCRemarks & "<br />" & "Description local is added in new folder"
        log.Message "Description local is added in new folder"
            
          
         Delay 15000,"Pls Wait.."
      Call SClosesource()
      Delay 5000,"Pls Wait.."
                   
    End if
 

    Dim objSaveWrk,objWait  
     set objSaveWrk=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 12).WPFObject("BarSubItemLinkControl", "", 1)
    strTemp="WPFObject(""ContentControlEx"", ""Workspace"", 2)"
    Set objTemp=objSaveWrk.FindChild("Name",strTemp,50)
    objWait=1
    Do until objTemp.Enabled = true 
        If objWait < 20 Then
          Delay 1000,"Pls Wait... Form is loading..."
          objWait=objWait+1
        else
          Call SClosesource()
          Call SourceWorkSpacevwr()
          Exit Sub
        end if 
    Loop 
    
    strTemp="WPFObject(""ContentControlEx"", ""Workspace"", 2)"
    Set objWrkSpace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,50,True)
    If objWrkSpace.Exists = True then
      Delay(1000)
      objWrkSpace.Click
      Delay(1000)
      strTemp="WPFObject(""PopupMenuBarControl"", """", 1)"
      Set objwrkspacepop=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").Findchild("Name",strTemp,50,True)
      'Set objwrkspacepop=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 2).WPFObject("BarButtonItemLinkControl", "", 1).WPFObject("ContentControlEx", "Upload Workspace", 2)
      If objwrkspacepop.Exists = True then
        strTemp="WPFObject(""ContentControlEx"", ""Upload Workspace"", 2)"
        set objwrkspcUpload=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).FindChild("Name",strTemp,50,True)
        If objwrkspcUpload.Exists = True then
          objwrkspcUpload.Click
          'Delay 1000,"Pls Wait.."
          strTemp="WPFObject(""PART_ContainerContent"")"
          Set objConfirm=Sys.Process("EdgeClient").WPFObject("HwndSource: WindowContentHolder", "Confirm").FindChild("Name",strTemp,50,True)
          strTemp="WPFObject(""DXMessageBox"", """", 1)"
          Set objConfirm=objConfirm.WaitChild(strTemp,180000)
          If objConfirm.Exists = True then
            objConfirm.Keys "[Enter]"
            'Delay 8000,"Uploading..."
           
            Set objConfirm = Sys.Process("EdgeClient")._
            Waitchild("WPFObject(""HwndSource: CustomMessageBoxWindow"", ""Upload Workspace"")",600000)._
            Waitchild("WPFObject(""CustomMessageBoxWindow"", ""Upload Workspace"", 1)",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""FloatingContainerBorder"")",60000)._
            Waitchild("WPFObject(""FloatingContainerBackground"")",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""FloatingContainerBody"")",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""PART_ContainerContent"")",60000)
            
            If objConfirm.Exists = True then
              Sys.Keys("O")
                 'Delay 30000,"Pls Wait.."
              Call sEdgeProcessor
            End if
          End if
        End if
      End if
    End if
'  Call SClosesource()
  'Call SourceWorkSpacevwr()
End Sub

Sub  sCheckSrcOpenEdit3LSCAddSave(strParameters)
On Error Resume Next 
   Dim strSource1,StrSource2,strSource3,strTemp,GridControl,GridSourceTree,intTotNodeCnt,intI,intJ,intRow,intK,objEdge
   Dim objNewWorkspace,objWrkspace_popup,objOpenView,strTemp1,objNewWrkSpaceName,objNewWrkSpace_Txtbox,objNewWrkSpace_okbtn,objNewWrkSpace_Name
   Dim strDesc1,strDesc2,DescText,DescLocalText
   Dim objEditSource
   Dim objTemp, objStrClose
   
    strSource1=getSplitValue(strParameters,"SOURCE")
    StrSource2=getSplitValue(strParameters,"LEVEL2SOURCE")
    StrSource3=getSplitValue(strParameters,"LEVEL3SOURCE")
    
'    strSource1="Test"
'    StrSource2="Automation_UIT2"
'    StrSource3="Test"

    Call sHome_Source
    
    strDesc1=aqDateTime.Now
    strDesc2=aqDateTime.Now
    DescText=Replace(strDesc1,"/","-")
    DescText=Replace(DescText,":","_")
    DescLocalText=DescText
    strWrkSpaceName=DescText
'    intSeriesID=getSplitValue(strParameters,"SERIESID")
'    if intSeriesID=0 then
'      Call sSourceseries
'      intSeriesID=strSourceFileText
'    End if 
    
    strTemp="WPFObject(""SourceTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""SourceTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    Delay 10000,"Pls Wait.."
    ''Selecting Country Name
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
          GridControl.Nodes_2.Item(intI).Expand(True)
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description       
          blnFlag=False  
          Exit For
        End If
    Next
    If blnFlag = True then
      strTCRemarks="Country Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
  
    Delay 10000,"Pls Wait.."
        blnFlag = True 
    ''Selecting Level2Source_Name
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
  For intJ=0 to intTotNodeCnt-1
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(StrSource2) then
        GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
        intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
'        Call GridSourceTree.ClickCell(intRow, "Edit")
        Call GridControl.ClearSelectionCore
        Call GridControl.FocusViewAndRow(GridControl,intRow)
        GridControl.SetFocusOnCurrentItem
        Call GridControl.SelectRowCore(intRow)
        log.Message "Level2 Source Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
        blnFlag = False 
        Exit For
      End If
    Next
    If blnFlag = True then
      log.Message "Level2 Source Name not found"
      strTCRemarks="Level2 Source Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
    
     Delay 10000,"Pls Wait.."
    blnFlag = True 
   
    Delay 2000,"Pls Wait.."

    strTemp="WPFObject(""ArrowControl"", """", 1)"
    Set objNewWorkspace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,20,True)
    If objNewWorkspace.Exists = True then
      objNewWorkspace.Click
       strTemp="WPFObject(""BarPopupBorderControl"", """", 1)"
      Set objWrkspace_popup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").FindChild("Name",strTemp,5,True)
      If objWrkspace_popup.Exists = True then
        strTemp="WPFObject(""ContentControlEx"", ""Open For Edit (Source)"", 2)"
        Set objopenforEdit=objWrkspace_popup.FindChild("Name",strTemp,8,True)
        If objopenforEdit.Exists then
          objopenforEdit.Click    
        End If
      End if
      
      strTemp1="WPFObject(""HwndSource: WorkspaceNamePrompt"", ""Please provide a new Workspace Name"")"
      Set objNewWrkSpaceName=Sys.Process("EdgeClient").WaitChild(strTemp1,50000)
      If objNewWrkSpaceName.Exists = True then
     
      ''Waiting for Workspace Name prompt
      strTemp="WPFObject(""FloatingContainerBorder"")"
      Set objNewWrkSpace_Name=Sys.Process("EdgeClient").WPFObject("HwndSource: WorkspaceNamePrompt", "Please provide a new Workspace Name").WPFObject("WorkspaceNamePrompt", "Please provide a new Workspace Name", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,15000000)
      If objNewWrkSpace_Name.Exists = True then
          strTemp="WPFObject(""ChangeNameTextEdit"")"
          ''Entering Workspace Name
          Set objNewWrkSpace_Txtbox=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
            If objNewWrkSpace_Txtbox.Exists = True then
              objNewWrkSpace_Txtbox.Click
              objNewWrkSpace_Txtbox.Text=strWrkSpaceName
      '        strTCRemarks=strTCRemarks & Chr(10) & "Entered Workspace Name - " & strWrkSpaceName
              ''Clicking on Ok Button 
              strTemp="WPFObject(""OkButton"")"
              Set objNewWrkSpace_okbtn=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
              If objNewWrkSpace_okbtn.Exists = True then
                objNewWrkSpace_okbtn.Click
                'Delay 5000,"Please wait..."
              End If
            End If
        End If
      End if 
     End if 
       
  
       ''Handling Validation for Source
    strTemp="WPFObject(""HwndSource: WindowContentHolder"", """")"
    Set objTemp=Sys.Process("EdgeClient").WaitChild(strTemp,10000)
    If objTemp.Exists = True then
      objTemp.Keys "[Enter]"
      strTestCaseResult = "FAIL"
      Exit Sub
    End If

    ''WorkSpace Edit Window
    strTemp="WPFObject(""LayoutPanel"", """", 2)"
    Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,13,True)
    If objTemp.Exists then
        Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WPFObject("SourceTreeListView")
        Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl")
       Delay 10000,"Pls Wait.."
        ''Expanding First Node in Tree      
        intTotNodeCnt=GridControl.Nodes_2.Count  
        For intI=0 to intTotNodeCnt-1         
          If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
           GridControl.Nodes_2.Item(intI).Expand(True)
           blnFlag=False  
           Exit For
          End If
        Next
         Delay 10000,"Pls Wait.."
        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
          For intJ=0 to intTotNodeCnt-1
            If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strSource2) then
              GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
              intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(0).get_RowHandle
              GridControl.Keys "^[Home]"
              Call GridControl.ClearSelectionCore
              Call GridControl.FocusViewAndRow(GridControl,intRow-1)
              GridControl.SetFocusOnCurrentItem
              Call GridControl.SelectRowCore(intRow-1)
        
              If objGridCell.Exists = True then
                objGridCell.Click
              End If
              blnFlag = False 
              Exit For
            End If
          Next
'           Delay 10000,"Pls Wait.."
'              intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count
'               For intK=0 to intTotNodeCnt-1
'                  If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description)=Ucase(strSource3) then
'                      intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).get_RowHandle
'                      Call GridControl.ClearSelectionCore
'                      GridControl.set_FocusedRowHandle(intRow)
'                      Call GridControl.FocusViewAndRow(GridControl,intRow)
'                      GridControl.SetFocusOnCurrentItem
'                      Call GridControl.SelectRowCore(intRow)
'                      Exit For   
'                  End If 
'               Next
    End if
        
'        Delay 15000,"Pls Wait.."
'      Call SClosesource()
'      Delay 5000,"Pls Wait.."
    
    strTemp="WPFObject(""SourceTreeListView"")"
    'objEditSource=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WaitChild(strTemp,15000000)
    objEditSource=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WaitChild(strTemp,15000000)
    if objEditSource.Exists = True then
       strTemp="WPFObject(""ContentControlEx"", ""Add Folder"", 2)"
          Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 4).WPFObject("BarButtonItemLinkControl", "", 1).FindChild("Name",strTemp,50,True)
          If objNewWrkSpace_okbtn.Exists = True then
             If objNewWrkSpace_okbtn.Enabled = True then
              strTCRemarks = strTCRemarks & "<br />" & "Add Folder is found in Source"
              log.Message "Add Folder is found in Source"
              ''objNewWrkSpace_okbtn.Click
              SYS.Keys("^N")
              strTCRemarks = strTCRemarks & "<br />" & "New Folder Added "
              log.Message "New Folder Added"
             Else
              strTCRemarks = strTCRemarks & "<br />" & "Add Folder is Disabled in Source"
              log.Message "Add Folder is Disabled in Source"
             End if
          Else
            strTCRemarks = strTCRemarks & "<br />" & "Add Folder is  not found in Source"
            log.Message "Add Folder is not found in Source"
          End If
          
           Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 4).WPFObject("BarButtonItemLinkControl", "", 1)      
         Delay 8000,"New Folder..."

        ''Getting no. of Rows under level 2
        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count
        intK=intTotNodeCnt-1
    
        Set objDescCell=Aliases.EdgeClient.HwndSource_RibbonWindow.RibbonWindow.ContentControl.Grid.Grid.ContentControl.Grid.ContentControl.PART_ContainerContent.BarManager.DockPanel.DockLayoutManager.LayoutGroup.LayoutPanel2.Root.BarManager.AdornerDecorator.AdornedControl.Grid.DockPanel.SourceTreeListControl.SourceTreeListView.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK)
        Call objDescCell.Content.set_Description(DescText)
        strTCRemarks = strTCRemarks & "<br />" & "Description is added in new folder"
        log.Message "Description is added in new folder"
        
        Call objDescCell.Content.set_DescriptionLocal(DescLocalText)
        strTCRemarks = strTCRemarks & "<br />" & "Description local is added in new folder"
        log.Message "Description local is added in new folder"
            
          
        Delay 15000,"Pls Wait.."
        Call SClosesource()
        Delay 5000,"Pls Wait.."             
    End if
 

    Dim objSaveWrk,objWait 
     set objSaveWrk=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 12).WPFObject("BarSubItemLinkControl", "", 1)
    strTemp="WPFObject(""ContentControlEx"", ""Workspace"", 2)"
    Set objTemp=objSaveWrk.FindChild("Name",strTemp,50)
    objWait=1
    Do until objTemp.Enabled = true 
        If objWait < 20 Then
          Delay 1000,"Pls Wait... Form is loading..."
          objWait=objWait+1
        else
          Call SClosesource()
          Call SourceWorkSpacevwr()
          Exit Sub
        end if 
    Loop 
    
    ''Save WorkSpace
    strTemp="WPFObject(""ContentControlEx"", ""Workspace"", 2)"
    Set objWrkSpace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,50,True)
    If objWrkSpace.Exists = True then
      objWrkSpace.Click
      Dim objEdgeFilter
      set objEdgeFilter= Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarButtonItemLinkControl", "", 1)
      strTemp="WPFObject(""ContentControlEx"", ""Save Workspace"", 2)"
      Set objTemp=objEdgeFilter.FindChild("Name",strTemp,50)
      If objTemp.Exists = TRUE then
        Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarButtonItemLinkControl", "", 1).WPFObject("ContentControlEx", "Save Workspace", 2).Click
        strTemp="WPFObject(""PART_ContainerContent"")"
        Set objConfirm=Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "Confirm save.").FindChild("Name",strTemp,50,True)

          If objConfirm.Exists = True then
            sys.Keys("Y")
            Set objConfirm = Sys.Process("EdgeClient")._
            Waitchild("WPFObject(""HwndSource: CustomMessageBoxWindow"", """")",600000)._
            Waitchild("WPFObject(""CustomMessageBoxWindow"", """", 1)",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""FloatingContainerBorder"")",60000)._
            Waitchild("WPFObject(""FloatingContainerBackground"")",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""FloatingContainerBody"")",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""PART_ContainerContent"")",60000)
                        
            If objConfirm.Exists = True Then
                'objConfirm.Click
                SYS.Keys "[Enter]"
            End If
          End if 
        End if 
    End if 

  Call SClosesource()
  Call SourceOpenWorkSpacevwr()
  Call SourceWorkSpacevwr()
End Sub
Sub SourceOpenWorkSpacevwr()

On Error Resume Next

    Dim strObject,objEdgeMDI,strTemp,objTemp,GridControl,intRowcnt,intI,intRow,intJ,intk
    dim GridSourceTree,intTotNodeCnt

    strObject = "WPFObject(""HwndSource: RibbonWindow"")"
    Set objEdgeMDI = Sys.Process("EdgeClient").WaitChild(strObject, 600000)
    If objEdgeMDI.Exists then
      strTemp="WPFObject(""TextBlock"", ""Layout"", 1)"
      Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,14,True)
      If objTemp.Exists = False then
        strTemp="WPFObject(""ContentControl"", ""Source Workspace"", 1)"
        Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).FindChild("Name",strTemp,16,True)
        If objTemp.Exists = True then
          objTemp.Click
        End If
        Call sEdgeProcessor
        log.Message "Opening Source Workspace.."
      Else
        log.Message "Source Workspace is opened"
      End If
  
      ''Selecting Records
      strTemp="WPFObject(""PendingChangeGridControl"")"
      Set GridControl=Sys.Process("EdgeClient").FindChild("Name",strTemp,60,True)
      intRowcnt=GridControl.wRowCount
      For intI=0 to intRowcnt-1
        Call GridControl.ClickCell(intI,1)
        strTemp="WPFObject(""ContentControlEx"", ""Open Workspace"", 2)"
        Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarButtonItemLinkControl", "", 1).FindChild("Name",strTemp,20,True)
        If objTemp.Exists = True then
          If objTemp.Enabled = True then
            objTemp.Click 
            Call sEdgeprocessor
            Exit For
          Else
            Exit Sub
          End if 
        Else
          Exit Sub
        End if
      Next 
      Delay 10000,"Pls Wait.."
           strTemp="WPFObject(""LayoutPanel"", """", 2)"
           Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,13,True)
           If objTemp.Exists then
              Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WPFObject("SourceTreeListView")
              Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl")
                                 'Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl")
               Delay 10000,"Pls Wait.."
                ''Expanding First Node in Tree      
                intTotNodeCnt=GridControl.Nodes_2.Count  
                For intI=0 to intTotNodeCnt-1         
                  If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
                   GridControl.Nodes_2.Item(intI).Expand(True)
                   blnFlag=False  
                   Exit For
                  End If
                Next
              Delay 10000,"Pls Wait.."
              intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
              For intJ=0 to intTotNodeCnt-1
              If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strSource2) then
                GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
                intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(0).get_RowHandle
                GridControl.Keys "^[Home]"
                Call GridControl.ClearSelectionCore
                Call GridControl.FocusViewAndRow(GridControl,intRow-1)
                GridControl.SetFocusOnCurrentItem
                Call GridControl.SelectRowCore(intRow-1)
                If objGridCell.Exists = True then
                  objGridCell.Click
                End If
                blnFlag = False 
                Exit For
              End If
              Next
             
          End if
 Call SClosesource()
  Call SClosesource()
    
    Else
      log.Message "RibbonWindow not found"
    End If

End Sub

Sub  sCheckSrcOpenEdit3AddAllUpdate(strParameters)
On Error Resume Next 
   Dim strSource1,StrSource2,strSource3,strTemp,GridControl,GridSourceTree,intTotNodeCnt,intI,intJ,intRow,intK,objEdge
   Dim objNewWorkspace,objWrkspace_popup,objOpenView,strTemp1,objNewWrkSpaceName,objNewWrkSpace_Txtbox,objNewWrkSpace_okbtn,objNewWrkSpace_Name
   Dim strDesc1,strDesc2,DescText,DescLocalText
   Dim objEditSource
   Dim objTemp, objStrClose
   
    strSource1=getSplitValue(strParameters,"SOURCE")
    StrSource2=getSplitValue(strParameters,"LEVEL2SOURCE")
    StrSource3=getSplitValue(strParameters,"LEVEL3SOURCE")
    
'    strSource1="Test"
'    StrSource2="Automation_UIT2"
'    StrSource3="Test"

    Call sHome_Source
    
    strDesc1=aqDateTime.Now
    strDesc2=aqDateTime.Now
    DescText=Replace(strDesc1,"/","-")
    DescText=Replace(DescText,":","_")
    DescLocalText=DescText
    strWrkSpaceName=DescText
    
    
    strTemp="WPFObject(""SourceTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""SourceTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    Delay 10000,"Pls Wait.."
    ''Selecting Country Name
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
          GridControl.Nodes_2.Item(intI).Expand(True)
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description       
          blnFlag=False  
          Exit For
        End If
    Next
    If blnFlag = True then
      strTCRemarks="Country Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
  
    Delay 10000,"Pls Wait.."
        blnFlag = True 
    ''Selecting Level2Source_Name
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
  For intJ=0 to intTotNodeCnt-1
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(StrSource2) then
        GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
        intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
'        Call GridSourceTree.ClickCell(intRow, "Edit")
        Call GridControl.ClearSelectionCore
        Call GridControl.FocusViewAndRow(GridControl,intRow)
        GridControl.SetFocusOnCurrentItem
        Call GridControl.SelectRowCore(intRow)
        log.Message "Level2 Source Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
        blnFlag = False 
        Exit For
      End If
    Next
    If blnFlag = True then
      log.Message "Level2 Source Name not found"
      strTCRemarks="Level2 Source Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
    
     Delay 10000,"Pls Wait.."
    blnFlag = True 
   
    Delay 2000,"Pls Wait.."

    strTemp="WPFObject(""ArrowControl"", """", 1)"
    Set objNewWorkspace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,20,True)
    If objNewWorkspace.Exists = True then
      objNewWorkspace.Click
       strTemp="WPFObject(""BarPopupBorderControl"", """", 1)"
      Set objWrkspace_popup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").FindChild("Name",strTemp,5,True)
      If objWrkspace_popup.Exists = True then
        strTemp="WPFObject(""ContentControlEx"", ""Open For Edit (Source)"", 2)"
        Set objopenforEdit=objWrkspace_popup.FindChild("Name",strTemp,8,True)
        If objopenforEdit.Exists then
          objopenforEdit.Click    
        End If
      End if
      
      strTemp1="WPFObject(""HwndSource: WorkspaceNamePrompt"", ""Please provide a new Workspace Name"")"
      Set objNewWrkSpaceName=Sys.Process("EdgeClient").WaitChild(strTemp1,50000)
      If objNewWrkSpaceName.Exists = True then
     
      ''Waiting for Workspace Name prompt
      strTemp="WPFObject(""FloatingContainerBorder"")"
      Set objNewWrkSpace_Name=Sys.Process("EdgeClient").WPFObject("HwndSource: WorkspaceNamePrompt", "Please provide a new Workspace Name").WPFObject("WorkspaceNamePrompt", "Please provide a new Workspace Name", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,15000000)
      If objNewWrkSpace_Name.Exists = True then
          strTemp="WPFObject(""ChangeNameTextEdit"")"
          ''Entering Workspace Name
          Set objNewWrkSpace_Txtbox=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
            If objNewWrkSpace_Txtbox.Exists = True then
              objNewWrkSpace_Txtbox.Click
              objNewWrkSpace_Txtbox.Text=strWrkSpaceName
      '        strTCRemarks=strTCRemarks & Chr(10) & "Entered Workspace Name - " & strWrkSpaceName
              ''Clicking on Ok Button 
              strTemp="WPFObject(""OkButton"")"
              Set objNewWrkSpace_okbtn=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
              If objNewWrkSpace_okbtn.Exists = True then
                objNewWrkSpace_okbtn.Click
                'Delay 5000,"Please wait..."
              End If
            End If
        End If
      End if 
     End if 
       
  
       ''Handling Validation for Source
    strTemp="WPFObject(""HwndSource: WindowContentHolder"", """")"
    Set objTemp=Sys.Process("EdgeClient").WaitChild(strTemp,10000)
    If objTemp.Exists = True then
      objTemp.Keys "[Enter]"
      strTestCaseResult = "FAIL"
      Exit Sub
    End If

    ''WorkSpace Edit Window
    strTemp="WPFObject(""LayoutPanel"", """", 2)"
    Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,13,True)
    If objTemp.Exists then
        Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WPFObject("SourceTreeListView")
        Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl")
       Delay 10000,"Pls Wait.."
        ''Expanding First Node in Tree      
        intTotNodeCnt=GridControl.Nodes_2.Count  
        For intI=0 to intTotNodeCnt-1         
          If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
           GridControl.Nodes_2.Item(intI).Expand(True)
           blnFlag=False  
           Exit For
          End If
        Next
         Delay 10000,"Pls Wait.."
        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
          For intJ=0 to intTotNodeCnt-1
            If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strSource2) then
              GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
              intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(0).get_RowHandle
              GridControl.Keys "^[Home]"
              Call GridControl.ClearSelectionCore
              Call GridControl.FocusViewAndRow(GridControl,intRow-1)
              GridControl.SetFocusOnCurrentItem
              Call GridControl.SelectRowCore(intRow-1)
        
              If objGridCell.Exists = True then
                objGridCell.Click
              End If
              blnFlag = False 
              Exit For
            End If
          Next
'           Delay 10000,"Pls Wait.."
'              intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count
'               For intK=0 to intTotNodeCnt-1
'                  If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description)=Ucase(strWrkSpaceName) then
'                      intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).get_RowHandle
'                      Call GridControl.ClearSelectionCore
'                      GridControl.set_FocusedRowHandle(intRow)
'                      Call GridControl.FocusViewAndRow(GridControl,intRow)
'                      GridControl.SetFocusOnCurrentItem
'                      Call GridControl.SelectRowCore(intRow)
'                      Exit For   
'                  End If 
'               Next
    End if
        
'        Delay 15000,"Pls Wait.."
'      Call SClosesource()
'      Delay 5000,"Pls Wait.."
    
    strTemp="WPFObject(""SourceTreeListView"")"
    'objEditSource=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WaitChild(strTemp,15000000)
    objEditSource=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WaitChild(strTemp,15000000)
    if objEditSource.Exists = True then
       strTemp="WPFObject(""ContentControlEx"", ""Add Folder"", 2)"
          Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 4).WPFObject("BarButtonItemLinkControl", "", 1).FindChild("Name",strTemp,50,True)
          If objNewWrkSpace_okbtn.Exists = True then
             If objNewWrkSpace_okbtn.Enabled = True then
              strTCRemarks = strTCRemarks & "<br />" & "Add Folder is found in Source"
              log.Message "Add Folder is found in Source"
              ''objNewWrkSpace_okbtn.Click
              SYS.Keys("^N")
              strTCRemarks = strTCRemarks & "<br />" & "New Folder Added "
              log.Message "New Folder Added"
             Else
              strTCRemarks = strTCRemarks & "<br />" & "Add Folder is Disabled in Source"
              log.Message "Add Folder is Disabled in Source"
             End if
          Else
            strTCRemarks = strTCRemarks & "<br />" & "Add Folder is  not found in Source"
            log.Message "Add Folder is not found in Source"
          End If
          
          
          
          
          Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 4).WPFObject("BarButtonItemLinkControl", "", 1)      
         Delay 8000,"New Folder..."
         
        

''        ''Getting no. of Rows under level 2
        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count
        intK=intTotNodeCnt-1
''        'intRow
        Set objDescCell=Aliases.EdgeClient.HwndSource_RibbonWindow.RibbonWindow.ContentControl.Grid.Grid.ContentControl.Grid.ContentControl.PART_ContainerContent.BarManager.DockPanel.DockLayoutManager.LayoutGroup.LayoutPanel2.Root.BarManager.AdornerDecorator.AdornedControl.Grid.DockPanel.SourceTreeListControl.SourceTreeListView.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK)
        Call objDescCell.SelectNode_2(intK)
        
        Call objDescCell.Content.set_Description(DescText)
        strTCRemarks = strTCRemarks & "<br />" & "Description is added in new folder"
        log.Message "Description is added in new folder"
        
        Call objDescCell.Content.set_DescriptionLocal(DescLocalText)
        strTCRemarks = strTCRemarks & "<br />" & "Description local is added in new folder"
        log.Message "Description local is added in new folder"
        
        
         Delay 10000,"Pls Wait.."
              intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count
               For intK=0 to intTotNodeCnt-1
                  If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description)=Ucase(DescText) then
                      intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).get_RowHandle
                      Call GridControl.ClearSelectionCore
                      GridControl.set_FocusedRowHandle(intRow)
                      Call GridControl.FocusViewAndRow(GridControl,intRow)
                      GridControl.SetFocusOnCurrentItem
                      Call GridControl.SelectRowCore(intRow)
                      Exit For   
                  End If 
               Next
               
        Call objDescCell.SelectCell_2(intK,5)
        Sys.Keys("[Tab][Tab][Tab][Tab]")
        ''Call objDescCell.Content.set_SourceType("Web")
        SYS.Keys "[Enter]"
        strTemp="WPFObject(""ComboBoxEdit"", """", 1)"
        set objConfirm=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WPFObject("SourceTreeListView").WPFObject("HierarchyPanel", "", 1).FindChild("Name",strTemp,50,True)
         If objConfirm.Exists = True then
              'objConfirm.Fullname.Click
              
'               SYS.Keys "[Enter]"
               Delay 10000,"Pls Wait.."
               strTemp="WPFObject(""PART_Item"")"
               set objConfirm=objConfirm.FindChild("Name",strTemp,50,True)
               Delay 10000,"Pls Wait.."
              objConfirm.Click
               Delay 10000,"Pls Wait.."
              SYS.Keys "[Down][Enter]"
              Delay 10000,"Pls Wait.."
              strTCRemarks = strTCRemarks & "<br />" & "Source Type is editable"
              log.Message "Source Type is editable"
              strTCRemarks = strTCRemarks & "<br />" & "Source Type is added in new folder"
             log.Message "Source Type is added in new folder"
         Else
             strTCRemarks = strTCRemarks & "<br />" & "Source Type is not editable"
             log.Message "Source Type is not editable"
         End if
        
        
        
        Call objDescCell.Content.set_URL("URL")
        strTCRemarks = strTCRemarks & "<br />" & "URL is added in new folder"
        log.Message "URL is added in new folder"
            
        
         
         Call objDescCell.Content.set_MacroPath("macro")
        strTCRemarks = strTCRemarks & "<br />" & "Macro Path is added in new folder"
        log.Message "Macro Path is added in new folder"
        
         Call objDescCell.Content.set_MacroCapFlag("macrocapflag")
        strTCRemarks = strTCRemarks & "<br />" & "Macro Cap Flag is added in new folder"
        log.Message "Macro Cap Flag is added in new folder"
        
         Call objDescCell.Content.set_Remark("Remarks")
        strTCRemarks = strTCRemarks & "<br />" & "Remark is added in new folder"
        log.Message "Remark is added in new folder"
        Delay(5000)
        
        
       Delay 15000,"Pls Wait.."
      Call SClosesource()
      Delay 5000,"Pls Wait.."
                   
    End if
 
    
    Delay 15000,"Pls Wait.."
    
    Dim objSaveWrk,objWait 
     set objSaveWrk=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 12).WPFObject("BarSubItemLinkControl", "", 1)
    strTemp="WPFObject(""ContentControlEx"", ""Workspace"", 2)"
    Set objTemp=objSaveWrk.FindChild("Name",strTemp,50)
   objWait=1
    Do until objTemp.Enabled = true 
        If objWait < 20 Then
          Delay 1000,"Pls Wait... Form is loading..."
          objWait=objWait+1
        else
          Call SClosesource()
          Call SourceWorkSpacevwr()
          Exit Sub
        end if 
    Loop 
    
    
    strTemp="WPFObject(""ContentControlEx"", ""Workspace"", 2)"
    Set objWrkSpace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,50,True)
    If objWrkSpace.Exists = True then
    Delay(1000)
      objWrkSpace.Click
      Delay(1000)
      objWrkSpace.Click
      strTemp="WPFObject(""PopupMenuBarControl"", """", 1)"
      Set objwrkspacepop=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").Findchild("Name",strTemp,50,True)
      'Set objwrkspacepop=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 2).WPFObject("BarButtonItemLinkControl", "", 1).WPFObject("ContentControlEx", "Upload Workspace", 2)
      If objwrkspacepop.Exists = True then
        strTemp="WPFObject(""ContentControlEx"", ""Upload Workspace"", 2)"
        set objwrkspcUpload=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).FindChild("Name",strTemp,50,True)
        If objwrkspcUpload.Exists = True then
          objwrkspcUpload.Click
          'Delay 1000,"Pls Wait.."
          strTemp="WPFObject(""PART_ContainerContent"")"
          Set objConfirm=Sys.Process("EdgeClient").WPFObject("HwndSource: WindowContentHolder", "Confirm").FindChild("Name",strTemp,50,True)
          strTemp="WPFObject(""DXMessageBox"", """", 1)"
          Set objConfirm=objConfirm.WaitChild(strTemp,180000)
          If objConfirm.Exists = True then
            objConfirm.Keys "[Enter]"
            'Delay 8000,"Uploading..."
            Set objConfirm = Sys.Process("EdgeClient")._
            Waitchild("WPFObject(""HwndSource: CustomMessageBoxWindow"", ""Upload Workspace"")",600000)._
            Waitchild("WPFObject(""CustomMessageBoxWindow"", ""Upload Workspace"", 1)",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""FloatingContainerBorder"")",60000)._
            Waitchild("WPFObject(""FloatingContainerBackground"")",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""FloatingContainerBody"")",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""PART_ContainerContent"")",60000)
            If objConfirm.Exists = True then
              Sys.Keys "[Enter]"
              'Delay 30000,"Pls Wait.."
              Call sEdgeProcessor
            End if
          End if
        End if
      End if
    End if
  'Call SClosesource()
  'Call SourceWorkSpacevwr()
End Sub


Sub  sCheckSrcOpenEdit2SourceType(strParameters)
On Error Resume Next 
   Dim strSource1,StrSource2,strSource3,strTemp,GridControl,GridSourceTree,intTotNodeCnt,intI,intJ,intRow,intK,objEdge
   Dim objNewWorkspace,objWrkspace_popup,objOpenView,strTemp1,objNewWrkSpaceName,objNewWrkSpace_Txtbox,objNewWrkSpace_okbtn,objNewWrkSpace_Name
   Dim strDesc1,strDesc2,DescText,DescLocalText
   Dim objEditSource
   Dim objTemp, objStrClose
   
    strSource1=getSplitValue(strParameters,"SOURCE")
    StrSource2=getSplitValue(strParameters,"LEVEL2SOURCE")
   
    
'    strSource1="Test"
'    StrSource2="Automation_UIT2"

    Call sHome_Source
    
    strDesc1=aqDateTime.Now
    strDesc2=aqDateTime.Now
    DescText=Replace(strDesc1,"/","-")
    DescText=Replace(DescText,":","_")
    DescLocalText=DescText
    strWrkSpaceName=DescText
    
    
    strTemp="WPFObject(""SourceTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""SourceTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    Delay 10000,"Pls Wait.."
    ''Selecting Country Name
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
          GridControl.Nodes_2.Item(intI).Expand(True)
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description       
          blnFlag=False  
          Exit For
        End If
    Next
    If blnFlag = True then
      strTCRemarks="Country Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
  
    Delay 10000,"Pls Wait.."
        blnFlag = True 
    ''Selecting Level2Source_Name
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
  For intJ=0 to intTotNodeCnt-1
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(StrSource2) then
        GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
        intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
'        Call GridSourceTree.ClickCell(intRow, "Edit")
        Call GridControl.ClearSelectionCore
        Call GridControl.FocusViewAndRow(GridControl,intRow)
        GridControl.SetFocusOnCurrentItem
        Call GridControl.SelectRowCore(intRow)
        log.Message "Level2 Source Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
        blnFlag = False 
        Exit For
      End If
    Next
    If blnFlag = True then
      log.Message "Level2 Source Name not found"
      strTCRemarks="Level2 Source Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
    
     Delay 10000,"Pls Wait.."
    blnFlag = True 
   
    Delay 2000,"Pls Wait.."

    strTemp="WPFObject(""ArrowControl"", """", 1)"
    Set objNewWorkspace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,20,True)
    If objNewWorkspace.Exists = True then
      objNewWorkspace.Click
       strTemp="WPFObject(""BarPopupBorderControl"", """", 1)"
      Set objWrkspace_popup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").FindChild("Name",strTemp,5,True)
      If objWrkspace_popup.Exists = True then
        strTemp="WPFObject(""ContentControlEx"", ""Open For Edit (Source)"", 2)"
        Set objopenforEdit=objWrkspace_popup.FindChild("Name",strTemp,8,True)
        If objopenforEdit.Exists then
          objopenforEdit.Click    
        End If
      End if
      
      strTemp1="WPFObject(""HwndSource: WorkspaceNamePrompt"", ""Please provide a new Workspace Name"")"
      Set objNewWrkSpaceName=Sys.Process("EdgeClient").WaitChild(strTemp1,50000)
      If objNewWrkSpaceName.Exists = True then
     
      ''Waiting for Workspace Name prompt
      strTemp="WPFObject(""FloatingContainerBorder"")"
      Set objNewWrkSpace_Name=Sys.Process("EdgeClient").WPFObject("HwndSource: WorkspaceNamePrompt", "Please provide a new Workspace Name").WPFObject("WorkspaceNamePrompt", "Please provide a new Workspace Name", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,15000000)
      If objNewWrkSpace_Name.Exists = True then
          strTemp="WPFObject(""ChangeNameTextEdit"")"
          ''Entering Workspace Name
          Set objNewWrkSpace_Txtbox=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
            If objNewWrkSpace_Txtbox.Exists = True then
              objNewWrkSpace_Txtbox.Click
              objNewWrkSpace_Txtbox.Text=strWrkSpaceName
      '        strTCRemarks=strTCRemarks & Chr(10) & "Entered Workspace Name - " & strWrkSpaceName
              ''Clicking on Ok Button 
              strTemp="WPFObject(""OkButton"")"
              Set objNewWrkSpace_okbtn=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
              If objNewWrkSpace_okbtn.Exists = True then
                objNewWrkSpace_okbtn.Click
                'Delay 5000,"Please wait..."
              End If
            End If
        End If
      End if 
     End if 
       
  
       ''Handling Validation for Source
    strTemp="WPFObject(""HwndSource: WindowContentHolder"", """")"
    Set objTemp=Sys.Process("EdgeClient").WaitChild(strTemp,10000)
    If objTemp.Exists = True then
      objTemp.Keys "[Enter]"
      strTestCaseResult = "FAIL"
      Exit Sub
    End If

    ''WorkSpace Edit Window
    strTemp="WPFObject(""LayoutPanel"", """", 2)"
    Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,13,True)
    If objTemp.Exists then
        Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WPFObject("SourceTreeListView")
        Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl")
       Delay 10000,"Pls Wait.."
        ''Expanding First Node in Tree      
        intTotNodeCnt=GridControl.Nodes_2.Count  
        For intI=0 to intTotNodeCnt-1         
          If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
           GridControl.Nodes_2.Item(intI).Expand(True)
           blnFlag=False  
           Exit For
          End If
        Next
         Delay 10000,"Pls Wait.."
        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
          For intJ=0 to intTotNodeCnt-1
            If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strSource2) then
              GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
              intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(0).get_RowHandle
              GridControl.Keys "^[Home]"
              Call GridControl.ClearSelectionCore
              Call GridControl.FocusViewAndRow(GridControl,intRow-1)
              GridControl.SetFocusOnCurrentItem
              Call GridControl.SelectRowCore(intRow-1)
        
              If objGridCell.Exists = True then
                objGridCell.Click
              End If
              blnFlag = False 
              Exit For
            End If
          Next
    End if
            
    strTemp="WPFObject(""SourceTreeListView"")"
    ''objEditSource=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WaitChild(strTemp,15000000)
   objEditSource=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WaitChild(strTemp,15000000)
    if objEditSource.Exists = True then
'
'''        ''Getting no. of Rows under level 2
        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count
        intK=intTotNodeCnt-1
''        'intRow
        Set objDescCell=Aliases.EdgeClient.HwndSource_RibbonWindow.RibbonWindow.ContentControl.Grid.Grid.ContentControl.Grid.ContentControl.PART_ContainerContent.BarManager.DockPanel.DockLayoutManager.LayoutGroup.LayoutPanel2.Root.BarManager.AdornerDecorator.AdornedControl.Grid.DockPanel.SourceTreeListControl.SourceTreeListView.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK)
        Call objDescCell.SelectNode_2(intK)
        
        Call objDescCell.Content.set_SourceAbbr("r")
        Sys.Keys("[Tab][Tab]")
        SYS.Keys "[Enter]"
        SYS.Keys "testl2"
        strTCRemarks = strTCRemarks & "<br />" & "Source Abbr is edited"
        log.Message "Source Abbr is added is edited"
'               
        Call objDescCell.SelectCell_2(intJ,5)
        Sys.Keys("[Tab][Tab]")
        SYS.Keys "[Enter]"
        strTemp="WPFObject(""ComboBoxEdit"", """", 1)"
        set objConfirm=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WPFObject("SourceTreeListView").WPFObject("HierarchyPanel", "", 1).FindChild("Name",strTemp,50,True)
         If objConfirm.Exists = True then
            Delay 10000,"Pls Wait.."
            strTemp="WPFObject(""PART_Item"")"
            set objConfirm=objConfirm.FindChild("Name",strTemp,50,True)
            Delay 10000,"Pls Wait.."
            objConfirm.Click
            Delay 10000,"Pls Wait.."
            SYS.Keys "[Down][Enter]"
            Delay 10000,"Pls Wait.."
            strTCRemarks = strTCRemarks & "<br />" & "Source Type is editable"
            log.Message "Source Type is editable"
            strTCRemarks = strTCRemarks & "<br />" & "Source Type is added in new folder"
            log.Message "Source Type is added in new folder"
         Else
             strTCRemarks = strTCRemarks & "<br />" & "Source Type is not editable"
             log.Message "Source Type is not editable"
         End if
         Call objDescCell.SelectCell_2(intJ,5)
         Sys.Keys("[Tab]")
'         Delay 10000,"Pls Wait.."
'         SYS.Keys "[Enter]"
         strTemp="WPFObject(""ComboBoxEdit"", """", 1)"
         set objConfirm=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WPFObject("SourceTreeListView").WPFObject("HierarchyPanel", "", 1).FindChild("Name",strTemp,50,True)
         If objConfirm.Exists = True then
            Delay 10000,"Pls Wait.."
            strTemp="WPFObject(""PART_Item"")"
            set objConfirm=objConfirm.FindChild("Name",strTemp,50,True)
            Delay 10000,"Pls Wait.."
            objConfirm.Click
            Delay 10000,"Pls Wait.."
            SYS.Keys "[Down][Enter]"
            Delay 10000,"Pls Wait.."
            
             objConfirm.Click
               Delay 10000,"Pls Wait.."
              SYS.Keys "[Down]"
              Delay 10000,"Pls Wait.."
              
              
              set objConfirm= Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("PopupBorderControl", "", 1).WPFObject("PopupContentContainer", "", 1).WPFObject("NonLogicalDecorator", "", 1).WPFObject("PopupContentControl", "", 1).WPFObject("ComboBoxEditItem", "", 1)
              strTemp="WPFObject(""TextBlock"", ""Association "", 1)"
              Set objTemp=objConfirm.FindChild("Name",strTemp,50)
              If objTemp.Exists = TRUE then
                strTCRemarks = strTCRemarks & "<br />" & "Association is found in Source Nature"
                log.Message "Association is found in Source Nature"
              Else
                 strTCRemarks = strTCRemarks & "<br />" & "Association is not found in Source Nature"
                log.Message "Association is not found in Source Nature"
              End If
              
 
              set objConfirm= Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("PopupBorderControl", "", 1).WPFObject("PopupContentContainer", "", 1).WPFObject("NonLogicalDecorator", "", 1).WPFObject("PopupContentControl", "", 1).WPFObject("ComboBoxEditItem", "", 2)
              strTemp="WPFObject(""TextBlock"", ""CEIC Generated "", 1)"
              Set objTemp=objConfirm.FindChild("Name",strTemp,50)
              If objTemp.Exists = TRUE then
                strTCRemarks = strTCRemarks & "<br />" & "CEIC Generated is found in Source Nature"
                log.Message "CEIC Generated is found in Source Nature"
              Else
                 strTCRemarks = strTCRemarks & "<br />" & "CEIC Generated is not found in Source Nature"
                log.Message "CEIC Generated is not found in Source Nature"
              End If
              
               set objConfirm= Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("PopupBorderControl", "", 1).WPFObject("PopupContentContainer", "", 1).WPFObject("NonLogicalDecorator", "", 1).WPFObject("PopupContentControl", "", 1).WPFObject("ComboBoxEditItem", "", 3)
              strTemp="WPFObject(""TextBlock"", ""Central Bank "", 1)"
              Set objTemp=objConfirm.FindChild("Name",strTemp,50)
              If objTemp.Exists = TRUE then
                strTCRemarks = strTCRemarks & "<br />" & "Central Bank is found in Source Nature"
                log.Message "Central Bank is found in Source Nature"
              Else
                 strTCRemarks = strTCRemarks & "<br />" & "Central Bank is not found in Source Nature"
                log.Message "Central Bank is not found in Source Nature"
              End If
             
              set objConfirm= Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("PopupBorderControl", "", 1).WPFObject("PopupContentContainer", "", 1).WPFObject("NonLogicalDecorator", "", 1).WPFObject("PopupContentControl", "", 1).WPFObject("ComboBoxEditItem", "", 4)
              strTemp="WPFObject(""TextBlock"", ""Company "", 1)"
              Set objTemp=objConfirm.FindChild("Name",strTemp,50)
              If objTemp.Exists = TRUE then
                strTCRemarks = strTCRemarks & "<br />" & "Company is found in Source Nature"
                log.Message "Company is found in Source Nature"
              Else
                 strTCRemarks = strTCRemarks & "<br />" & "Company is not found in Source Nature"
                log.Message "Company is not found in Source Nature"
              End If
             
              set objConfirm= Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("PopupBorderControl", "", 1).WPFObject("PopupContentContainer", "", 1).WPFObject("NonLogicalDecorator", "", 1).WPFObject("PopupContentControl", "", 1).WPFObject("ComboBoxEditItem", "", 5)
              strTemp="WPFObject(""TextBlock"", ""Government "", 1)"
              Set objTemp=objConfirm.FindChild("Name",strTemp,50)
              If objTemp.Exists = TRUE then
                strTCRemarks = strTCRemarks & "<br />" & "Government is found in Source Nature"
                log.Message "Government is found in Source Nature"
              Else
                 strTCRemarks = strTCRemarks & "<br />" & "Government is not found in Source Nature"
                log.Message "Government is not found in Source Nature"
              End If
             
              set objConfirm= Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("PopupBorderControl", "", 1).WPFObject("PopupContentContainer", "", 1).WPFObject("NonLogicalDecorator", "", 1).WPFObject("PopupContentControl", "", 1).WPFObject("ComboBoxEditItem", "", 6)
              strTemp="WPFObject(""TextBlock"", ""Stock Exchange "", 1)"
              Set objTemp=objConfirm.FindChild("Name",strTemp,50)
              If objTemp.Exists = TRUE then
                strTCRemarks = strTCRemarks & "<br />" & "Stock Exchange is found in Source Nature"
                log.Message "Stock Exchange is found in Source Nature"
              Else
                 strTCRemarks = strTCRemarks & "<br />" & "Stock Exchange is not found in Source Nature"
                log.Message "Stock Exchange is not found in Source Nature"
              End If
             
              
            strTCRemarks = strTCRemarks & "<br />" & "Source Nature is editable"
            log.Message "Source Nature is editable"
            strTCRemarks = strTCRemarks & "<br />" & "Source Nature is added in new folder"
            log.Message "Source Nature is added in new folder"
         Else
             strTCRemarks = strTCRemarks & "<br />" & "Source Nature is not editable"
             log.Message "Source Nature is not editable"
         End if 
         
         Call objDescCell.SelectCell_2(intJ,5)
          Sys.Keys("[Tab]")
          SYS.Keys "[Enter]"
         SYS.Keys "[Enter]"
         Delay 15000,"Pls Wait.."
        strTemp="WPFObject(""CheckEdit"", """", 1)"
        Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WPFObject("SourceTreeListView").WPFObject("HierarchyPanel", "", 1).FindChild("Name",strTemp,50)
       ' Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WPFObject("SourceTreeListView").WPFObject("HierarchyPanel", "", 1).WPFObject("RowControl", "", 2).WPFObject("CellsControl", "", 1).WPFObject("LightweightCellEditor", "", 7).WPFObject("InplaceBaseEdit", "", 1).WPFObject("CheckEdit", "", 1)
        If objTemp.Exists=True then 
          objTemp.IsChecked=True 
          if objTemp.IsChecked=True then
            strTCRemarks = strTCRemarks & "<br />" & "Is Official is editable"
            log.Message "Is official is editable"
          Else
            strTCRemarks = strTCRemarks & "<br />" & "Is Official is not editable"
            log.Message "Is Official is not editable"
          End if
        End if
        
                      
    End if
 
      Delay 15000,"Pls Wait.."
      Call SClosesource()
     ' Delay 5000,"Pls Wait.."
    
    Delay 15000,"Pls Wait.."
    
     Dim objSaveWrk ,objWait 
     set objSaveWrk=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 12).WPFObject("BarSubItemLinkControl", "", 1)
    strTemp="WPFObject(""ContentControlEx"", ""Workspace"", 2)"
    Set objTemp=objSaveWrk.FindChild("Name",strTemp,50)
    objWait=1
    Do until objTemp.Enabled = true 
        If objWait < 20 Then
          Delay 1000,"Pls Wait... Form is loading..."
          objWait=objWait+1
        else
          Call SClosesource()
          Call SourceWorkSpacevwr()
          Exit Sub
        end if 
    Loop 
   
    
    strTemp="WPFObject(""ContentControlEx"", ""Workspace"", 2)"
    Set objWrkSpace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,50,True)
    If objWrkSpace.Exists = True then
      Delay(6000)
      objWrkSpace.Click
      Delay(1000)
      objWrkSpace.Click
      strTemp="WPFObject(""PopupMenuBarControl"", """", 1)"
      Set objwrkspacepop=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").Findchild("Name",strTemp,50,True)
      If objwrkspacepop.Exists = True then
        Dim objEdgeFilter
      set objEdgeFilter= Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarButtonItemLinkControl", "", 1)
      strTemp="WPFObject(""ContentControlEx"", ""Save Workspace"", 2)"
      Set objTemp=objEdgeFilter.FindChild("Name",strTemp,50)
      If objTemp.Exists = TRUE then
        Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarButtonItemLinkControl", "", 1).WPFObject("ContentControlEx", "Save Workspace", 2).Click
        strTemp="WPFObject(""PART_ContainerContent"")"
        Set objConfirm=Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "Confirm save.").FindChild("Name",strTemp,50,True)
          'Set objConfirm=objConfirm.WaitChild(strTemp,900000)
          If objConfirm.Exists = True then
            sys.Keys("Y")
            
            Set objConfirm = Sys.Process("EdgeClient")._
            Waitchild("WPFObject(""HwndSource: CustomMessageBoxWindow"", """")",600000)._
            Waitchild("WPFObject(""CustomMessageBoxWindow"", """", 1)",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""FloatingContainerBorder"")",60000)._
            Waitchild("WPFObject(""FloatingContainerBackground"")",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""FloatingContainerBody"")",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""PART_ContainerContent"")",60000)
            If objConfirm.Exists = True Then
                objConfirm.Click
                SYS.Keys "[Enter]"
            End If
          End if 
      Else
        strTestCaseResult = "ABORT"
        Exit Sub  
      End If
      End if 
    End if
  Call SClosesource()
  Call SourceWorkSpacevwr()
End Sub


Sub  sCheckSrcOpenEdit3SourceType(strParameters)
On Error Resume Next 
   Dim strSource1,StrSource2,strSource3,strTemp,GridControl,GridSourceTree,intTotNodeCnt,intI,intJ,intRow,intK,objEdge
   Dim objNewWorkspace,objWrkspace_popup,objOpenView,strTemp1,objNewWrkSpaceName,objNewWrkSpace_Txtbox,objNewWrkSpace_okbtn,objNewWrkSpace_Name
   Dim strDesc1,strDesc2,DescText,DescLocalText
   Dim objEditSource
   Dim objTemp, objStrClose
   
    strSource1=getSplitValue(strParameters,"SOURCE")
    StrSource2=getSplitValue(strParameters,"LEVEL2SOURCE")
    StrSource3=getSplitValue(strParameters,"LEVEL3SOURCE")
    
'    strSource1="Test"
'    StrSource2="Automation_UIT2"
'    StrSource3="Test"

    Call sHome_Source
    
    strDesc1=aqDateTime.Now
    strDesc2=aqDateTime.Now
    DescText=Replace(strDesc1,"/","-")
    DescText=Replace(DescText,":","_")
    DescLocalText=DescText
    strWrkSpaceName=DescText
    
    
    strTemp="WPFObject(""SourceTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""SourceTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    Delay 10000,"Pls Wait.."
    ''Selecting Country Name
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
          GridControl.Nodes_2.Item(intI).Expand(True)
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description       
          blnFlag=False  
          Exit For
        End If
    Next
    If blnFlag = True then
      strTCRemarks="Country Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
  
    Delay 10000,"Pls Wait.."
        blnFlag = True 
    ''Selecting Level2Source_Name
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
  For intJ=0 to intTotNodeCnt-1
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(StrSource2) then
        GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
        intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
'        Call GridSourceTree.ClickCell(intRow, "Edit")
        Call GridControl.ClearSelectionCore
        Call GridControl.FocusViewAndRow(GridControl,intRow)
        GridControl.SetFocusOnCurrentItem
        Call GridControl.SelectRowCore(intRow)
        log.Message "Level2 Source Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
        blnFlag = False 
        Exit For
      End If
    Next
    If blnFlag = True then
      log.Message "Level2 Source Name not found"
      strTCRemarks="Level2 Source Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
    
     Delay 10000,"Pls Wait.."
    

    strTemp="WPFObject(""ArrowControl"", """", 1)"
    Set objNewWorkspace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,20,True)
    If objNewWorkspace.Exists = True then
      objNewWorkspace.Click
       strTemp="WPFObject(""BarPopupBorderControl"", """", 1)"
      Set objWrkspace_popup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").FindChild("Name",strTemp,5,True)
      If objWrkspace_popup.Exists = True then
        strTemp="WPFObject(""ContentControlEx"", ""Open For Edit (Source)"", 2)"
        Set objopenforEdit=objWrkspace_popup.FindChild("Name",strTemp,8,True)
        If objopenforEdit.Exists then
          objopenforEdit.Click    
        End If
      End if
      
      strTemp1="WPFObject(""HwndSource: WorkspaceNamePrompt"", ""Please provide a new Workspace Name"")"
      Set objNewWrkSpaceName=Sys.Process("EdgeClient").WaitChild(strTemp1,50000)
      If objNewWrkSpaceName.Exists = True then
     
      ''Waiting for Workspace Name prompt
      strTemp="WPFObject(""FloatingContainerBorder"")"
      Set objNewWrkSpace_Name=Sys.Process("EdgeClient").WPFObject("HwndSource: WorkspaceNamePrompt", "Please provide a new Workspace Name").WPFObject("WorkspaceNamePrompt", "Please provide a new Workspace Name", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,15000000)
      If objNewWrkSpace_Name.Exists = True then
          strTemp="WPFObject(""ChangeNameTextEdit"")"
          ''Entering Workspace Name
          Set objNewWrkSpace_Txtbox=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
            If objNewWrkSpace_Txtbox.Exists = True then
              objNewWrkSpace_Txtbox.Click
              objNewWrkSpace_Txtbox.Text=strWrkSpaceName
      '        strTCRemarks=strTCRemarks & Chr(10) & "Entered Workspace Name - " & strWrkSpaceName
              ''Clicking on Ok Button 
              strTemp="WPFObject(""OkButton"")"
              Set objNewWrkSpace_okbtn=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
              If objNewWrkSpace_okbtn.Exists = True then
                objNewWrkSpace_okbtn.Click
                'Delay 5000,"Please wait..."
              End If
            End If
        End If
      End if 
     End if 
       
  
       ''Handling Validation for Source
    strTemp="WPFObject(""HwndSource: WindowContentHolder"", """")"
    Set objTemp=Sys.Process("EdgeClient").WaitChild(strTemp,10000)
    If objTemp.Exists = True then
      objTemp.Keys "[Enter]"
      strTestCaseResult = "FAIL"
      Exit Sub
    End If

    ''WorkSpace Edit Window
    strTemp="WPFObject(""LayoutPanel"", """", 2)"
    Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,13,True)
    If objTemp.Exists then
        Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WPFObject("SourceTreeListView")
        Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl")
       Delay 10000,"Pls Wait.."
        ''Expanding First Node in Tree      
        intTotNodeCnt=GridControl.Nodes_2.Count  
        For intI=0 to intTotNodeCnt-1         
          If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
           GridControl.Nodes_2.Item(intI).Expand(True)
           blnFlag=False  
           Exit For
          End If
        Next
         Delay 10000,"Pls Wait.."
        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
          For intJ=0 to intTotNodeCnt-1
            If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strSource2) then
              GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
              intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(0).get_RowHandle
              GridControl.Keys "^[Home]"
              Call GridControl.ClearSelectionCore
              Call GridControl.FocusViewAndRow(GridControl,intRow-1)
              GridControl.SetFocusOnCurrentItem
              Call GridControl.SelectRowCore(intRow-1)
        
              If objGridCell.Exists = True then
                objGridCell.Click
              End If
              blnFlag = False 
              Exit For
            End If
          Next
    End if
        

    
    strTemp="WPFObject(""SourceTreeListView"")"
    'objEditSource=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WaitChild(strTemp,15000000)
    objEditSource=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WaitChild(strTemp,15000000)
    if objEditSource.Exists = True then
        strTemp="WPFObject(""ContentControlEx"", ""Add Folder"", 2)"
          'Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 4).WPFObject("BarButtonItemLinkControl", "", 1).FindChild("Name",strTemp,50,True)
          Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 4).WPFObject("BarButtonItemLinkControl", "", 1).FindChild("Name",strTemp,50,True)
          If objNewWrkSpace_okbtn.Exists = True then
             If objNewWrkSpace_okbtn.Enabled = True then
              objNewWrkSpace_okbtn.Click
              strTCRemarks = strTCRemarks & "<br />" & "Add Folder is found in Source"
              log.Message "Add Folder is found in Source"
             Else
              strTCRemarks = strTCRemarks & "<br />" & "Add Folder is Disabled in Source"
              log.Message "Add Folder is Disabled in Source"
             End if
          Else
            strTCRemarks = strTCRemarks & "<br />" & "Add Folder is  not found in Source"
            log.Message "Add Folder is not found in Source"
          End If   
          
          
          
          Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 4).WPFObject("BarButtonItemLinkControl", "", 1)      
         Delay 8000,"New Folder..."
         
        

''        ''Getting no. of Rows under level 2
        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count
        intK=intTotNodeCnt-1
''        'intRow
        Set objDescCell=Aliases.EdgeClient.HwndSource_RibbonWindow.RibbonWindow.ContentControl.Grid.Grid.ContentControl.Grid.ContentControl.PART_ContainerContent.BarManager.DockPanel.DockLayoutManager.LayoutGroup.LayoutPanel2.Root.BarManager.AdornerDecorator.AdornedControl.Grid.DockPanel.SourceTreeListControl.SourceTreeListView.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK)
        Call objDescCell.SelectNode_2(intK)
        
        Call objDescCell.Content.set_Description(DescText)
        strTCRemarks = strTCRemarks & "<br />" & "Description is added in new folder"
        log.Message "Description is added in new folder"
        
        Call objDescCell.Content.set_DescriptionLocal(DescLocalText)
        strTCRemarks = strTCRemarks & "<br />" & "Description local is added in new folder"
        log.Message "Description local is added in new folder"
        
        
        
        
         Delay 10000,"Pls Wait.."
              intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count
               For intK=0 to intTotNodeCnt-1
                  If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description)=Ucase(DescText) then
                      intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).get_RowHandle
                      Call GridControl.ClearSelectionCore
                      GridControl.set_FocusedRowHandle(intRow)
                      Call GridControl.FocusViewAndRow(GridControl,intRow)
                      GridControl.SetFocusOnCurrentItem
                      Call GridControl.SelectRowCore(intRow)
                      Exit For   
                  End If 
               Next
               
          Call objDescCell.Content.set_SourceAbbr("r")
        Sys.Keys("[Tab][Tab]")
        SYS.Keys "[Enter]"
        SYS.Keys "testl2"
        strTemp="WPFObject(""InplaceBaseEdit"", """", 1)"
        set objConfirm=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WPFObject("SourceTreeListView").WPFObject("HierarchyPanel", "", 1).FindChild("Name",strTemp,50,True)
        If objConfirm.WPFControlText = "" then
          strTCRemarks = strTCRemarks & "<br />" & "Source Abbr is not able to edit"
          log.Message "Source Abbr is not able to edit"
        else
          strTCRemarks = strTCRemarks & "<br />" & "Source Abbr is edited"
          log.Message "Source Abbr is added is edited"
        end if
        
        Call objDescCell.SelectCell_2(intK,5)
        Sys.Keys("[Tab][Tab]")
        ''Call objDescCell.Content.set_SourceType("Web")
        SYS.Keys "[Enter]"
        strTemp="WPFObject(""ComboBoxEdit"", """", 1)"
        set objConfirm=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WPFObject("SourceTreeListView").WPFObject("HierarchyPanel", "", 1).FindChild("Name",strTemp,50,True)
         If objConfirm.Exists = True then
              'objConfirm.Fullname.Click
              
'               SYS.Keys "[Enter]"
               Delay 10000,"Pls Wait.."
               strTemp="WPFObject(""PART_Item"")"
               set objConfirm=objConfirm.FindChild("Name",strTemp,50,True)
               Delay 10000,"Pls Wait.."
              objConfirm.Click
               Delay 10000,"Pls Wait.."
              SYS.Keys "[Down][Enter]"
              Delay 10000,"Pls Wait.."
              strTCRemarks = strTCRemarks & "<br />" & "Source Type is editable"
              log.Message "Source Type is editable"
              strTCRemarks = strTCRemarks & "<br />" & "Source Type is added in new folder"
             log.Message "Source Type is added in new folder"
         Else
             strTCRemarks = strTCRemarks & "<br />" & "Source Type is not editable"
             log.Message "Source Type is not editable"
         End if
                
        
         Call objDescCell.SelectCell_2(intJ,5)
         Sys.Keys("[Tab]")
'         Delay 10000,"Pls Wait.."
'         SYS.Keys "[Enter]"
         strTemp="WPFObject(""ComboBoxEdit"", """", 1)"
         set objConfirm=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WPFObject("SourceTreeListView").WPFObject("HierarchyPanel", "", 1).FindChild("Name",strTemp,50,True)
         If objConfirm.Exists = True then
            Delay 10000,"Pls Wait.."
            strTemp="WPFObject(""PART_Item"")"
            set objConfirm=objConfirm.FindChild("Name",strTemp,50,True)
            Delay 10000,"Pls Wait.."
            objConfirm.Click
            Delay 10000,"Pls Wait.."
            SYS.Keys "[Down][Enter]"
            Delay 10000,"Pls Wait.."
            strTCRemarks = strTCRemarks & "<br />" & "Source Nature is editable"
            log.Message "Source Nature is editable"
            strTCRemarks = strTCRemarks & "<br />" & "Source Nature is added in new folder"
            log.Message "Source Nature is added in new folder"
         Else
             strTCRemarks = strTCRemarks & "<br />" & "Source Nature is not editable"
             log.Message "Source Nature is not editable"
         End if 
       
          'Call objDescCell.SelectCell_2(intJ,5)
          Sys.Keys("[Tab]")
          SYS.Keys "[Enter]"
         SYS.Keys "[Enter]"
         Delay 15000,"Pls Wait.."
        strTemp="WPFObject(""CheckEdit"", """", 1)"
        Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WPFObject("SourceTreeListView").WPFObject("HierarchyPanel", "", 1).FindChild("Name",strTemp,50)
       ' Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WPFObject("SourceTreeListView").WPFObject("HierarchyPanel", "", 1).WPFObject("RowControl", "", 2).WPFObject("CellsControl", "", 1).WPFObject("LightweightCellEditor", "", 7).WPFObject("InplaceBaseEdit", "", 1).WPFObject("CheckEdit", "", 1)
        If objTemp.Exists=True then 
          objTemp.IsChecked=True 
          if objTemp.IsChecked=True then
            strTCRemarks = strTCRemarks & "<br />" & "Is Official is editable"
            log.Message "Is official is editable"
          Else
            strTCRemarks = strTCRemarks & "<br />" & "Is Official is not editable"
            log.Message "Is Official is not editable"
          End if
        Else
            strTCRemarks = strTCRemarks & "<br />" & "Is Official is not editable"
            log.Message "Is Official is not editable"
        End if
        
        
       Delay 15000,"Pls Wait.."
      Call SClosesource()
      Delay 5000,"Pls Wait.."
                   
    End if
 
    
    Delay 15000,"Pls Wait.."
    
    Dim objSaveWrk,objWait  
     set objSaveWrk=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 12).WPFObject("BarSubItemLinkControl", "", 1)
    strTemp="WPFObject(""ContentControlEx"", ""Workspace"", 2)"
    Set objTemp=objSaveWrk.FindChild("Name",strTemp,50)
    objWait=1
    Do until objTemp.Enabled = true 
        If objWait < 20 Then
          Delay 1000,"Pls Wait... Form is loading..."
          objWait=objWait+1
        else
          Call SClosesource()
          Call SourceWorkSpacevwr()
          Exit Sub
        end if 
    Loop 
    
    
    strTemp="WPFObject(""ContentControlEx"", ""Workspace"", 2)"
    Set objWrkSpace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,50,True)
    If objWrkSpace.Exists = True then
      Delay(1000)
      objWrkSpace.Click
'       Delay(1000)
'      objWrkSpace.Click
      strTemp="WPFObject(""PopupMenuBarControl"", """", 1)"
      Set objwrkspacepop=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").Findchild("Name",strTemp,50,True)
      If objwrkspacepop.Exists = True then
        Dim objEdgeFilter
      set objEdgeFilter= Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarButtonItemLinkControl", "", 1)
      strTemp="WPFObject(""ContentControlEx"", ""Save Workspace"", 2)"
      Set objTemp=objEdgeFilter.FindChild("Name",strTemp,50)
      If objTemp.Exists = TRUE then
        Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarButtonItemLinkControl", "", 1).WPFObject("ContentControlEx", "Save Workspace", 2).Click
        strTemp="WPFObject(""PART_ContainerContent"")"
        Set objConfirm=Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "Confirm save.").FindChild("Name",strTemp,50,True)

          If objConfirm.Exists = True then
            sys.Keys("Y")
            
            Set objConfirm = Sys.Process("EdgeClient")._
            Waitchild("WPFObject(""HwndSource: CustomMessageBoxWindow"", """")",600000)._
            Waitchild("WPFObject(""CustomMessageBoxWindow"", """", 1)",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""FloatingContainerBorder"")",60000)._
            Waitchild("WPFObject(""FloatingContainerBackground"")",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""FloatingContainerBody"")",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""PART_ContainerContent"")",60000)
            
            If objConfirm.Exists = True Then
                objConfirm.Click
                SYS.Keys "[Enter]"
            End If
          End if 
      Else
        strTestCaseResult = "ABORT"
        Exit Sub  
      End If
      End if 
    End if
  Call SClosesource()
  Call SourceWorkSpacevwr()
End Sub
Sub  sCheckSrcOpenEdit3SourceTypeField(strParameters)
On Error Resume Next 
   Dim strSource1,StrSource2,strSource3,strTemp,GridControl,GridSourceTree,intTotNodeCnt,intI,intJ,intRow,intK,objEdge
   Dim objNewWorkspace,objWrkspace_popup,objOpenView,strTemp1,objNewWrkSpaceName,objNewWrkSpace_Txtbox,objNewWrkSpace_okbtn,objNewWrkSpace_Name
   Dim strDesc1,strDesc2,DescText,DescLocalText
   Dim objEditSource
   Dim objTemp, objStrClose
   
    strSource1=getSplitValue(strParameters,"SOURCE")
    StrSource2=getSplitValue(strParameters,"LEVEL2SOURCE")
    StrSource3=getSplitValue(strParameters,"LEVEL3SOURCE")
    
'    strSource1="Test"
'    StrSource2="Automation_UIT2"
'    StrSource3="Test"

    Call sHome_Source
    
    strDesc1=aqDateTime.Now
    strDesc2=aqDateTime.Now
    DescText=Replace(strDesc1,"/","-")
    DescText=Replace(DescText,":","_")
    DescLocalText=DescText
    strWrkSpaceName=DescText
    
    
    strTemp="WPFObject(""SourceTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""SourceTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    Delay 10000,"Pls Wait.."
    ''Selecting Country Name
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
          GridControl.Nodes_2.Item(intI).Expand(True)
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description       
          blnFlag=False  
          Exit For
        End If
    Next
    If blnFlag = True then
      strTCRemarks="Country Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
  
    Delay 10000,"Pls Wait.."
        blnFlag = True 
    ''Selecting Level2Source_Name
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
  For intJ=0 to intTotNodeCnt-1
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(StrSource2) then
        GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
        intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
'        Call GridSourceTree.ClickCell(intRow, "Edit")
        Call GridControl.ClearSelectionCore
        Call GridControl.FocusViewAndRow(GridControl,intRow)
        GridControl.SetFocusOnCurrentItem
        Call GridControl.SelectRowCore(intRow)
        log.Message "Level2 Source Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
        blnFlag = False 
        Exit For
      End If
    Next
    If blnFlag = True then
      log.Message "Level2 Source Name not found"
      strTCRemarks="Level2 Source Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
    
     Delay 10000,"Pls Wait.."
    

    strTemp="WPFObject(""ArrowControl"", """", 1)"
    Set objNewWorkspace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,20,True)
    If objNewWorkspace.Exists = True then
      objNewWorkspace.Click
       strTemp="WPFObject(""BarPopupBorderControl"", """", 1)"
      Set objWrkspace_popup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").FindChild("Name",strTemp,5,True)
      If objWrkspace_popup.Exists = True then
        strTemp="WPFObject(""ContentControlEx"", ""Open For Edit (Source)"", 2)"
        Set objopenforEdit=objWrkspace_popup.FindChild("Name",strTemp,8,True)
        If objopenforEdit.Exists then
          objopenforEdit.Click    
        End If
      End if
      
      strTemp1="WPFObject(""HwndSource: WorkspaceNamePrompt"", ""Please provide a new Workspace Name"")"
      Set objNewWrkSpaceName=Sys.Process("EdgeClient").WaitChild(strTemp1,50000)
      If objNewWrkSpaceName.Exists = True then
     
      ''Waiting for Workspace Name prompt
      strTemp="WPFObject(""FloatingContainerBorder"")"
      Set objNewWrkSpace_Name=Sys.Process("EdgeClient").WPFObject("HwndSource: WorkspaceNamePrompt", "Please provide a new Workspace Name").WPFObject("WorkspaceNamePrompt", "Please provide a new Workspace Name", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,15000000)
      If objNewWrkSpace_Name.Exists = True then
          strTemp="WPFObject(""ChangeNameTextEdit"")"
          ''Entering Workspace Name
          Set objNewWrkSpace_Txtbox=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
            If objNewWrkSpace_Txtbox.Exists = True then
              objNewWrkSpace_Txtbox.Click
              objNewWrkSpace_Txtbox.Text=strWrkSpaceName
      '        strTCRemarks=strTCRemarks & Chr(10) & "Entered Workspace Name - " & strWrkSpaceName
              ''Clicking on Ok Button 
              strTemp="WPFObject(""OkButton"")"
              Set objNewWrkSpace_okbtn=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
              If objNewWrkSpace_okbtn.Exists = True then
                objNewWrkSpace_okbtn.Click
                'Delay 5000,"Please wait..."
              End If
            End If
        End If
      End if 
     End if 
       
  
       ''Handling Validation for Source
    strTemp="WPFObject(""HwndSource: WindowContentHolder"", """")"
    Set objTemp=Sys.Process("EdgeClient").WaitChild(strTemp,10000)
    If objTemp.Exists = True then
      objTemp.Keys "[Enter]"
      strTestCaseResult = "FAIL"
      Exit Sub
    End If

    ''WorkSpace Edit Window
    strTemp="WPFObject(""LayoutPanel"", """", 2)"
    Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,13,True)
    If objTemp.Exists then
        Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WPFObject("SourceTreeListView")
        Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl")
       Delay 10000,"Pls Wait.."
        ''Expanding First Node in Tree      
        intTotNodeCnt=GridControl.Nodes_2.Count  
        For intI=0 to intTotNodeCnt-1         
          If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
           GridControl.Nodes_2.Item(intI).Expand(True)
           blnFlag=False  
           Exit For
          End If
        Next
         Delay 10000,"Pls Wait.."
        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
          For intJ=0 to intTotNodeCnt-1
            If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strSource2) then
              GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
              intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(0).get_RowHandle
              GridControl.Keys "^[Home]"
              Call GridControl.ClearSelectionCore
              Call GridControl.FocusViewAndRow(GridControl,intRow-1)
              GridControl.SetFocusOnCurrentItem
              Call GridControl.SelectRowCore(intRow-1)
        
              If objGridCell.Exists = True then
                objGridCell.Click
              End If
              blnFlag = False 
              Exit For
            End If
          Next
    End if
        

    
    strTemp="WPFObject(""SourceTreeListView"")"
    'objEditSource=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WaitChild(strTemp,15000000)
    objEditSource=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WaitChild(strTemp,15000000)
    if objEditSource.Exists = True then
        strTemp="WPFObject(""ContentControlEx"", ""Add Folder"", 2)"
          'Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 4).WPFObject("BarButtonItemLinkControl", "", 1).FindChild("Name",strTemp,50,True)
          Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 4).WPFObject("BarButtonItemLinkControl", "", 1).FindChild("Name",strTemp,50,True)
          If objNewWrkSpace_okbtn.Exists = True then
             If objNewWrkSpace_okbtn.Enabled = True then
              objNewWrkSpace_okbtn.Click
              strTCRemarks = strTCRemarks & "<br />" & "Add Folder is found in Source"
              log.Message "Add Folder is found in Source"
             Else
              strTCRemarks = strTCRemarks & "<br />" & "Add Folder is Disabled in Source"
              log.Message "Add Folder is Disabled in Source"
             End if
          Else
            strTCRemarks = strTCRemarks & "<br />" & "Add Folder is  not found in Source"
            log.Message "Add Folder is not found in Source"
          End If   
          
          
          
          Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 4).WPFObject("BarButtonItemLinkControl", "", 1)      
         Delay 8000,"New Folder..."
         
        

''        ''Getting no. of Rows under level 2
        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count
        intK=intTotNodeCnt-1
''        'intRow
        Set objDescCell=Aliases.EdgeClient.HwndSource_RibbonWindow.RibbonWindow.ContentControl.Grid.Grid.ContentControl.Grid.ContentControl.PART_ContainerContent.BarManager.DockPanel.DockLayoutManager.LayoutGroup.LayoutPanel2.Root.BarManager.AdornerDecorator.AdornedControl.Grid.DockPanel.SourceTreeListControl.SourceTreeListView.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK)
        Call objDescCell.SelectNode_2(intK)
        
        Call objDescCell.Content.set_Description(DescText)
        strTCRemarks = strTCRemarks & "<br />" & "Description is added in new folder"
        log.Message "Description is added in new folder"
        
        Call objDescCell.Content.set_DescriptionLocal(DescLocalText)
        strTCRemarks = strTCRemarks & "<br />" & "Description local is added in new folder"
        log.Message "Description local is added in new folder"
        
        
        
        
         Delay 10000,"Pls Wait.."
              intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count
               For intK=0 to intTotNodeCnt-1
                  If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description)=Ucase(DescText) then
                      intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).get_RowHandle
                      Call GridControl.ClearSelectionCore
                      GridControl.set_FocusedRowHandle(intRow)
                      Call GridControl.FocusViewAndRow(GridControl,intRow)
                      GridControl.SetFocusOnCurrentItem
                      Call GridControl.SelectRowCore(intRow)
                      Exit For   
                  End If 
               Next
               
          Call objDescCell.Content.set_SourceAbbr("r")
        Sys.Keys("[Tab][Tab]")
        SYS.Keys "[Enter]"
        SYS.Keys "testl2"
        strTemp="WPFObject(""InplaceBaseEdit"", """", 1)"
        set objConfirm=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WPFObject("SourceTreeListView").WPFObject("HierarchyPanel", "", 1).FindChild("Name",strTemp,50,True)
        If objConfirm.WPFControlText = "" then
          strTCRemarks = strTCRemarks & "<br />" & "Source Abbr is not able to edit"
          log.Message "Source Abbr is not able to edit"
        else
          strTCRemarks = strTCRemarks & "<br />" & "Source Abbr is edited"
          log.Message "Source Abbr is added is edited"
        end if
        
        Call objDescCell.SelectCell_2(intK,5)
        Sys.Keys("[Tab][Tab]")
        ''Call objDescCell.Content.set_SourceType("Web")
        SYS.Keys "[Enter]"
        strTemp="WPFObject(""ComboBoxEdit"", """", 1)"
        set objConfirm=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WPFObject("SourceTreeListView").WPFObject("HierarchyPanel", "", 1).FindChild("Name",strTemp,50,True)
         If objConfirm.Exists = True then
              'objConfirm.Fullname.Click
              
'               SYS.Keys "[Enter]"
               Delay 10000,"Pls Wait.."
               strTemp="WPFObject(""PART_Item"")"
               set objConfirm=objConfirm.FindChild("Name",strTemp,50,True)
               Delay 10000,"Pls Wait.."
              objConfirm.Click
               Delay 10000,"Pls Wait.."
              SYS.Keys "[Down]"
              Delay 10000,"Pls Wait.."
              
              
              set objConfirm= Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("PopupBorderControl", "", 1).WPFObject("PopupContentContainer", "", 1).WPFObject("NonLogicalDecorator", "", 1).WPFObject("PopupContentControl", "", 1).WPFObject("ComboBoxEditItem", "", 1)
              strTemp="WPFObject(""TextBlock"", ""Direct Arrangement"", 1)"
              Set objTemp=objConfirm.FindChild("Name",strTemp,50)
              If objTemp.Exists = TRUE then
                strTCRemarks = strTCRemarks & "<br />" & "Direct Arrangement is found in Source Type"
                log.Message "Direct Arrangement is found in Source Type"
              Else
                 strTCRemarks = strTCRemarks & "<br />" & "Direct Arrangement is not found in Source Type"
                log.Message "Direct Arrangement is not found in Source Type"
              End If
              
              set objConfirm= Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("PopupBorderControl", "", 1).WPFObject("PopupContentContainer", "", 1).WPFObject("NonLogicalDecorator", "", 1).WPFObject("PopupContentControl", "", 1).WPFObject("ComboBoxEditItem", "", 2)
              strTemp="WPFObject(""TextBlock"", ""Equivalent Series"", 1)"
              Set objTemp=objConfirm.FindChild("Name",strTemp,50)
              If objTemp.Exists = TRUE then
                strTCRemarks = strTCRemarks & "<br />" & "Equivalent Series is found in Source Type"
                log.Message "Equivalent Series is found in Source Type"
              Else
                 strTCRemarks = strTCRemarks & "<br />" & "Equivalent Series is not found in Source Type"
                log.Message "Equivalent Series is not found in Source Type"
              End If
              
              set objConfirm= Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("PopupBorderControl", "", 1).WPFObject("PopupContentContainer", "", 1).WPFObject("NonLogicalDecorator", "", 1).WPFObject("PopupContentControl", "", 1).WPFObject("ComboBoxEditItem", "", 3)
              strTemp="WPFObject(""TextBlock"", ""Generated Series"", 1)"
              Set objTemp=objConfirm.FindChild("Name",strTemp,50)
              If objTemp.Exists = TRUE then
                strTCRemarks = strTCRemarks & "<br />" & "Generated Series is found in Source Type"
                log.Message "Generated Series is found in Source Type"
              Else
                 strTCRemarks = strTCRemarks & "<br />" & "Generated Series is not found in Source Type"
                log.Message "Generated Series is not found in Source Type"
              End If
              
              
              set objConfirm= Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("PopupBorderControl", "", 1).WPFObject("PopupContentContainer", "", 1).WPFObject("NonLogicalDecorator", "", 1).WPFObject("PopupContentControl", "", 1).WPFObject("ComboBoxEditItem", "", 4)
              strTemp="WPFObject(""TextBlock"", ""Newspaper"", 1)"
              Set objTemp=objConfirm.FindChild("Name",strTemp,50)
              If objTemp.Exists = TRUE then
                strTCRemarks = strTCRemarks & "<br />" & "Newspaper is found in Source Type"
                log.Message "Newspaper is found in Source Type"
              Else
                 strTCRemarks = strTCRemarks & "<br />" & "Newspaper is not found in Source Type"
                log.Message "Newspaper is not found in Source Type"
              End If
              
              set objConfirm= Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("PopupBorderControl", "", 1).WPFObject("PopupContentContainer", "", 1).WPFObject("NonLogicalDecorator", "", 1).WPFObject("PopupContentControl", "", 1).WPFObject("ComboBoxEditItem", "", 5)
              strTemp="WPFObject(""TextBlock"", ""Newswire"", 1)"
              Set objTemp=objConfirm.FindChild("Name",strTemp,50)
              If objTemp.Exists = TRUE then
                strTCRemarks = strTCRemarks & "<br />" & "Newswire is found in Source Type"
                log.Message "Newswire is found in Source Type"
              Else
                 strTCRemarks = strTCRemarks & "<br />" & "Newswire is not found in Source Type"
                log.Message "Newswire is not found in Source Type"
              End If
              
               set objConfirm= Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("PopupBorderControl", "", 1).WPFObject("PopupContentContainer", "", 1).WPFObject("NonLogicalDecorator", "", 1).WPFObject("PopupContentControl", "", 1).WPFObject("ComboBoxEditItem", "", 6)
              strTemp="WPFObject(""TextBlock"", ""Publication"", 1)"
              Set objTemp=objConfirm.FindChild("Name",strTemp,50)
              If objTemp.Exists = TRUE then
                strTCRemarks = strTCRemarks & "<br />" & "Publication is found in Source Type"
                log.Message "Publication is found in Source Type"
              Else
                 strTCRemarks = strTCRemarks & "<br />" & "Publication is not found in Source Type"
                log.Message "Publication is not found in Source Type"
              End If
              
              
              set objConfirm= Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("PopupBorderControl", "", 1).WPFObject("PopupContentContainer", "", 1).WPFObject("NonLogicalDecorator", "", 1).WPFObject("PopupContentControl", "", 1).WPFObject("ComboBoxEditItem", "", 7)
              strTemp="WPFObject(""TextBlock"", ""Web"", 1)"
              Set objTemp=objConfirm.FindChild("Name",strTemp,50)
              If objTemp.Exists = TRUE then
                strTCRemarks = strTCRemarks & "<br />" & "Web is found in Source Type"
                log.Message "Web is found in Source Type"
              Else
                 strTCRemarks = strTCRemarks & "<br />" & "Web is not found in Source Type"
                log.Message "Web is not found in Source Type"
              End If
              
              set objConfirm= Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("PopupBorderControl", "", 1).WPFObject("PopupContentContainer", "", 1).WPFObject("NonLogicalDecorator", "", 1).WPFObject("PopupContentControl", "", 1).WPFObject("ComboBoxEditItem", "", 8)
              strTemp="WPFObject(""TextBlock"", ""Web & Publication"", 1)"
              Set objTemp=objConfirm.FindChild("Name",strTemp,50)
              If objTemp.Exists = TRUE then
                strTCRemarks = strTCRemarks & "<br />" & "Web & Publication is found in Source Type"
                log.Message "Web & Publication is found in Source Type"
              Else
                 strTCRemarks = strTCRemarks & "<br />" & "Web & Publication is not found in Source Type"
                log.Message "Web & Publication is not found in Source Type"
              End If
             
              
         Else
             strTCRemarks = strTCRemarks & "<br />" & "Source Type is not editable"
             log.Message "Source Type is not editable"
         End if
                
        
         Call objDescCell.SelectCell_2(intJ,5)
         Sys.Keys("[Tab]")
'         Delay 10000,"Pls Wait.."
'         SYS.Keys "[Enter]"
         strTemp="WPFObject(""ComboBoxEdit"", """", 1)"
         set objConfirm=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WPFObject("SourceTreeListView").WPFObject("HierarchyPanel", "", 1).FindChild("Name",strTemp,50,True)
         If objConfirm.Exists = True then
            Delay 10000,"Pls Wait.."
            strTemp="WPFObject(""PART_Item"")"
            set objConfirm=objConfirm.FindChild("Name",strTemp,50,True)
            Delay 10000,"Pls Wait.."
            objConfirm.Click
            Delay 10000,"Pls Wait.."
            SYS.Keys "[Down][Enter]"
            Delay 10000,"Pls Wait.."
            strTCRemarks = strTCRemarks & "<br />" & "Source Nature is editable"
            log.Message "Source Nature is editable"
            strTCRemarks = strTCRemarks & "<br />" & "Source Nature is added in new folder"
            log.Message "Source Nature is added in new folder"
         Else
             strTCRemarks = strTCRemarks & "<br />" & "Source Nature is not editable"
             log.Message "Source Nature is not editable"
         End if 
       
          'Call objDescCell.SelectCell_2(intJ,5)
          Sys.Keys("[Tab]")
          SYS.Keys "[Enter]"
         SYS.Keys "[Enter]"
         Delay 15000,"Pls Wait.."
        strTemp="WPFObject(""CheckEdit"", """", 1)"
        Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WPFObject("SourceTreeListView").WPFObject("HierarchyPanel", "", 1).FindChild("Name",strTemp,50)
       ' Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WPFObject("SourceTreeListView").WPFObject("HierarchyPanel", "", 1).WPFObject("RowControl", "", 2).WPFObject("CellsControl", "", 1).WPFObject("LightweightCellEditor", "", 7).WPFObject("InplaceBaseEdit", "", 1).WPFObject("CheckEdit", "", 1)
        If objTemp.Exists=True then 
          objTemp.IsChecked=True 
          if objTemp.IsChecked=True then
            strTCRemarks = strTCRemarks & "<br />" & "Is Official is editable"
            log.Message "Is official is editable"
          Else
            strTCRemarks = strTCRemarks & "<br />" & "Is Official is not editable"
            log.Message "Is Official is not editable"
          End if
        Else
            strTCRemarks = strTCRemarks & "<br />" & "Is Official is not editable"
            log.Message "Is Official is not editable"
        End if
        
        
       Delay 15000,"Pls Wait.."
      Call SClosesource()
      Delay 5000,"Pls Wait.."
                   
    End if
 
    
    Delay 15000,"Pls Wait.."
    
    Dim objSaveWrk,objWait  
     set objSaveWrk=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 12).WPFObject("BarSubItemLinkControl", "", 1)
    strTemp="WPFObject(""ContentControlEx"", ""Workspace"", 2)"
    Set objTemp=objSaveWrk.FindChild("Name",strTemp,50)
    objWait=1
    Do until objTemp.Enabled = true 
        If objWait < 20 Then
          Delay 1000,"Pls Wait... Form is loading..."
          objWait=objWait+1
        else
          Call SClosesource()
          Call SourceWorkSpacevwr()
          Exit Sub
        end if 
    Loop 
    
    
    strTemp="WPFObject(""ContentControlEx"", ""Workspace"", 2)"
    Set objWrkSpace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,50,True)
    If objWrkSpace.Exists = True then
      Delay(1000)
      objWrkSpace.Click
'       Delay(1000)
'      objWrkSpace.Click
      strTemp="WPFObject(""PopupMenuBarControl"", """", 1)"
      Set objwrkspacepop=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").Findchild("Name",strTemp,50,True)
      If objwrkspacepop.Exists = True then
        Dim objEdgeFilter
      set objEdgeFilter= Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarButtonItemLinkControl", "", 1)
      strTemp="WPFObject(""ContentControlEx"", ""Save Workspace"", 2)"
      Set objTemp=objEdgeFilter.FindChild("Name",strTemp,50)
      If objTemp.Exists = TRUE then
        Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarButtonItemLinkControl", "", 1).WPFObject("ContentControlEx", "Save Workspace", 2).Click
        strTemp="WPFObject(""PART_ContainerContent"")"
        Set objConfirm=Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "Confirm save.").FindChild("Name",strTemp,50,True)

          If objConfirm.Exists = True then
            sys.Keys("Y")
            
           Set objConfirm = Sys.Process("EdgeClient")._
            Waitchild("WPFObject(""HwndSource: CustomMessageBoxWindow"", """")",600000)._
            Waitchild("WPFObject(""CustomMessageBoxWindow"", """", 1)",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""FloatingContainerBorder"")",60000)._
            Waitchild("WPFObject(""FloatingContainerBackground"")",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""FloatingContainerBody"")",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""PART_ContainerContent"")",60000)
            
            If objConfirm.Exists = True Then
                objConfirm.Click
                SYS.Keys "[Enter]"
            End If
          End if 
      Else
        strTestCaseResult = "ABORT"
        Exit Sub  
      End If
      End if 
    End if
  Call SClosesource()
  Call SourceWorkSpacevwr()
End Sub


Sub  sCheckSrcOpenEditMultiLLAddFolder(strParameters)
On Error Resume Next 
   Dim strSource1,StrSource2,strSource3,strTemp,GridControl,GridSourceTree,intTotNodeCnt,intI,intJ,intRow,intK,objEdge,intL
   Dim objNewWorkspace,objWrkspace_popup,objOpenView,strTemp1,objNewWrkSpaceName,objNewWrkSpace_Txtbox,objNewWrkSpace_okbtn,objNewWrkSpace_Name
   Dim strDesc1,strDesc2,DescText,DescLocalText
   Dim objEditSource
   
    strSource1=getSplitValue(strParameters,"SOURCE")
    StrSource2=getSplitValue(strParameters,"LEVEL2SOURCE")

    
'    strSource1="Test"
'    StrSource2="Automation_UIT2"
    

    Call sHome_Source
    
    strDesc1=aqDateTime.Now
    strDesc2=aqDateTime.Now
    DescText=Replace(strDesc1,"/","-")
    DescText=Replace(DescText,":","_")
    DescLocalText=DescText
    strWrkSpaceName=DescText
    
    
    strTemp="WPFObject(""SourceTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""SourceTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    Delay 10000,"Pls Wait.."
    ''Selecting Country Name
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
          GridControl.Nodes_2.Item(intI).Expand(True)
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description       
          blnFlag=False  
          Exit For
        End If
    Next
    If blnFlag = True then
      strTCRemarks="Country Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
  
    Delay 10000,"Pls Wait.."
        blnFlag = True 
    ''Selecting Level2Source_Name
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
  For intJ=0 to intTotNodeCnt-1
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(StrSource2) then
        GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
        intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
'        Call GridSourceTree.ClickCell(intRow, "Edit")
        Call GridControl.ClearSelectionCore
        Call GridControl.FocusViewAndRow(GridControl,intRow)
        GridControl.SetFocusOnCurrentItem
        Call GridControl.SelectRowCore(intRow)
        log.Message "Level2 Source Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
        blnFlag = False 
        Exit For
      End If
    Next
    If blnFlag = True then
      log.Message "Level2 Source Name not found"
      strTCRemarks="Level2 Source Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If

    Delay 2000,"Pls Wait.."

    strTemp="WPFObject(""ArrowControl"", """", 1)"
    Set objNewWorkspace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,20,True)
    If objNewWorkspace.Exists = True then
      objNewWorkspace.Click
       strTemp="WPFObject(""BarPopupBorderControl"", """", 1)"
      Set objWrkspace_popup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").FindChild("Name",strTemp,5,True)
      If objWrkspace_popup.Exists = True then
        strTemp="WPFObject(""ContentControlEx"", ""Open For Edit (Source)"", 2)"
        Set objopenforEdit=objWrkspace_popup.FindChild("Name",strTemp,8,True)
        If objopenforEdit.Exists then
          objopenforEdit.Click    
          'Delay 20000,"Please Wait..."
        End If
      End if
      
      strTemp1="WPFObject(""HwndSource: WorkspaceNamePrompt"", ""Please provide a new Workspace Name"")"
      Set objNewWrkSpaceName=Sys.Process("EdgeClient").WaitChild(strTemp1,50000)
      If objNewWrkSpaceName.Exists = True then
     
      ''Waiting for Workspace Name prompt
      strTemp="WPFObject(""FloatingContainerBorder"")"
      Set objNewWrkSpace_Name=Sys.Process("EdgeClient").WPFObject("HwndSource: WorkspaceNamePrompt", "Please provide a new Workspace Name").WPFObject("WorkspaceNamePrompt", "Please provide a new Workspace Name", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,15000000)
      If objNewWrkSpace_Name.Exists = True then
          strTemp="WPFObject(""ChangeNameTextEdit"")"
          ''Entering Workspace Name
          Set objNewWrkSpace_Txtbox=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
            If objNewWrkSpace_Txtbox.Exists = True then
              objNewWrkSpace_Txtbox.Click
              objNewWrkSpace_Txtbox.Text=strWrkSpaceName
      '        strTCRemarks=strTCRemarks & Chr(10) & "Entered Workspace Name - " & strWrkSpaceName
              ''Clicking on Ok Button 
              strTemp="WPFObject(""OkButton"")"
              Set objNewWrkSpace_okbtn=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
              If objNewWrkSpace_okbtn.Exists = True then
                objNewWrkSpace_okbtn.Click
                'Delay 5000,"Please wait..."
              End If
            End If
        End If
      End if 
     End if 
       
  
       ''Handling Validation for Source
    strTemp="WPFObject(""HwndSource: WindowContentHolder"", """")"
    Set objTemp=Sys.Process("EdgeClient").WaitChild(strTemp,10000)
    If objTemp.Exists = True then
      objTemp.Keys "[Enter]"
      strTestCaseResult = "FAIL"
      Exit Sub
    End If

    ''WorkSpace Edit Window
    strTemp="WPFObject(""LayoutPanel"", """", 2)"
    Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,13,True)
    If objTemp.Exists then
        Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WPFObject("SourceTreeListView")
        Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl")
       Delay 10000,"Pls Wait.."
        ''Expanding First Node in Tree      
        intTotNodeCnt=GridControl.Nodes_2.Count  
        For intI=0 to intTotNodeCnt-1         
          If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
           GridControl.Nodes_2.Item(intI).Expand(True)
           'GridControl.Keys "^[Home]"
            blnFlag=False  
            Exit For
          End If
        Next
         Delay 10000,"Pls Wait.."
        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
          For intJ=0 to intTotNodeCnt-1
            If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strSource2) then
              GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
              intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(0).get_RowHandle
              GridControl.Keys "^[Home]"
              Call GridControl.ClearSelectionCore
              Call GridControl.FocusViewAndRow(GridControl,intRow-1)
              GridControl.SetFocusOnCurrentItem
              Call GridControl.SelectRowCore(intRow-1)
        
              If objGridCell.Exists = True then
                objGridCell.Click
              End If
              blnFlag = False 
              Exit For
            End If
          Next
'           Delay 10000,"Pls Wait.."
'              intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count
'               For intK=0 to intTotNodeCnt-1
'                  If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description)=Ucase(strSource3) then
'                      intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).get_RowHandle
'                      Call GridControl.ClearSelectionCore
'                      GridControl.set_FocusedRowHandle(intRow)
'                      Call GridControl.FocusViewAndRow(GridControl,intRow)
'                      GridControl.SetFocusOnCurrentItem
'                      Call GridControl.SelectRowCore(intRow)
''                      log.Message "New Source Created"
''                      strTCRemarks="Upload successful" & "<br />" & "Level3 Source Created - " & DescText & "<br />" & "Attach Series - " & intSeriesID
'                      Exit For   
'                  End If 
'               Next
    End if
        
'        Delay 15000,"Pls Wait.."
'      Call SClosesource()
'      Delay 5000,"Pls Wait.."
    
    strTemp="WPFObject(""SourceTreeListView"")"
    'objEditSource=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WaitChild(strTemp,15000000)
    objEditSource=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WaitChild(strTemp,15000000)
    if objEditSource.Exists = True then
                 
          strTemp="WPFObject(""ContentControlEx"", ""Add Folder"", 2)"
          Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 4).WPFObject("BarButtonItemLinkControl", "", 1).FindChild("Name",strTemp,50,True)
          If objNewWrkSpace_okbtn.Exists = True then
             If objNewWrkSpace_okbtn.Enabled = True then
              objNewWrkSpace_okbtn.Click
              strTCRemarks = strTCRemarks & "<br />" & "Add Folder is found in Source"
              log.Message "Add Folder is found in Source"
             Else
              strTCRemarks = strTCRemarks & "<br />" & "Add Folder is Disabled in Source"
              log.Message "Add Folder is Disabled in Source"
             End if
          Else
            strTCRemarks = strTCRemarks & "<br />" & "Add Folder is  not found in Source"
            log.Message "Add Folder is not found in Source"
          End If
          
        Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 4).WPFObject("BarButtonItemLinkControl", "", 1)      
                    'Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WPFObject("SourceTreeListView")
         Delay 8000,"New Folder..."

        ''Getting no. of Rows under level 2
        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count
        intK=intTotNodeCnt-1
    
        Set objDescCell=Aliases.EdgeClient.HwndSource_RibbonWindow.RibbonWindow.ContentControl.Grid.Grid.ContentControl.Grid.ContentControl.PART_ContainerContent.BarManager.DockPanel.DockLayoutManager.LayoutGroup.LayoutPanel2.Root.BarManager.AdornerDecorator.AdornedControl.Grid.DockPanel.SourceTreeListControl.SourceTreeListView.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK)
        Call objDescCell.Content.set_Description(DescText)
        strTCRemarks = strTCRemarks & "<br />" & "Description is added in new folder"
        log.Message "Description is added in new folder"
        
        Call objDescCell.Content.set_DescriptionLocal(DescLocalText)
        strTCRemarks = strTCRemarks & "<br />" & "Description local is added in new folder"
        log.Message "Description local is added in new folder"
          
        
         Delay 10000,"Pls Wait.."
        ''Expanding First Node in Tree      
        intTotNodeCnt=GridControl.Nodes_2.Count  
        For intI=0 to intTotNodeCnt-1         
          If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
           GridControl.Nodes_2.Item(intI).Expand(True)
           'GridControl.Keys "^[Home]"
            blnFlag=False  
            Exit For
          End If
        Next
         Delay 10000,"Pls Wait.."
        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
          For intJ=0 to intTotNodeCnt-1
            If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strSource2) then
              GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
              intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(0).get_RowHandle
              GridControl.Keys "^[Home]"
              Call GridControl.ClearSelectionCore
              Call GridControl.FocusViewAndRow(GridControl,intRow-1)
              GridControl.SetFocusOnCurrentItem
              Call GridControl.SelectRowCore(intRow-1)
        
              If objGridCell.Exists = True then
                objGridCell.Click
              End If
              blnFlag = False 
              Exit For
            End If
          Next
           Delay 10000,"Pls Wait.."
              intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count
               For intK=0 to intTotNodeCnt-1
                  If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description)=Ucase(DescText) then
                      intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).get_RowHandle
                      Call GridControl.ClearSelectionCore
                      GridControl.set_FocusedRowHandle(intRow)
                      Call GridControl.FocusViewAndRow(GridControl,intRow)
                      GridControl.SetFocusOnCurrentItem
                      Call GridControl.SelectRowCore(intRow)
                      Exit For   
                  End If 
               Next
               
               strTemp="WPFObject(""SourceTreeListView"")"
           objEditSource=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WaitChild(strTemp,15000000)
          if objEditSource.Exists = True then
              strTemp="WPFObject(""ContentControlEx"", ""Add Folder"", 2)"
              Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 4).WPFObject("BarButtonItemLinkControl", "", 1).FindChild("Name",strTemp,50,True)
              If objNewWrkSpace_okbtn.Exists = True then
                 If objNewWrkSpace_okbtn.Enabled = True then
                  objNewWrkSpace_okbtn.Click
                  strTCRemarks = strTCRemarks & "<br />" & "Add Folder is found in Source"
                  log.Message "Add Folder is found in Source"
                 Else
                  strTCRemarks = strTCRemarks & "<br />" & "Add Folder is Disabled in Source"
                  log.Message "Add Folder is Disabled in Source"
                 End if
              Else
                strTCRemarks = strTCRemarks & "<br />" & "Add Folder is  not found in Source"
                log.Message "Add Folder is not found in Source"
              End If
          
              Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 4).WPFObject("BarButtonItemLinkControl", "", 1)      
                          'Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WPFObject("SourceTreeListView")
               Delay 8000,"New Folder..."

              ''Getting no. of Rows under level 2
              intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Count
              intL=0
              
              Set objDescCell=Aliases.EdgeClient.HwndSource_RibbonWindow.RibbonWindow.ContentControl.Grid.Grid.ContentControl.Grid.ContentControl.PART_ContainerContent.BarManager.DockPanel.DockLayoutManager.LayoutGroup.LayoutPanel2.Root.BarManager.AdornerDecorator.AdornedControl.Grid.DockPanel.SourceTreeListControl.SourceTreeListView.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Nodes.Item(intL)
              Call objDescCell.Content.set_Description(DescText)
              strTCRemarks = strTCRemarks & "<br />" & "Description is added in new folder"
              log.Message "Description is added in new folder"
        
              Call objDescCell.Content.set_DescriptionLocal(DescLocalText)
              strTCRemarks = strTCRemarks & "<br />" & "Description local is added in new folder"
              log.Message "Description local is added in new folder"
    End if
               
               
               
               
   ' End if  
          
        Delay 15000,"Pls Wait.."
        Call SClosesource()
        Delay 5000,"Pls Wait.."             
    End if
 

    Dim objSaveWrk,objWait 
     set objSaveWrk=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 12).WPFObject("BarSubItemLinkControl", "", 1)
    strTemp="WPFObject(""ContentControlEx"", ""Workspace"", 2)"
    Set objTemp=objSaveWrk.FindChild("Name",strTemp,50)
    objWait=1
    Do until objTemp.Enabled = true 
        If objWait < 20 Then
          Delay 1000,"Pls Wait... Form is loading..."
          objWait=objWait+1
        else
          Call SClosesource()
          Call SourceWorkSpacevwr()
          Exit Sub
        end if 
    Loop 
   
    
    ''Save WorkSpace
    strTemp="WPFObject(""ContentControlEx"", ""Workspace"", 2)"
    Set objWrkSpace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,50,True)
    If objWrkSpace.Exists = True then
      objWrkSpace.Click
     If objwrkspacepop.Exists = True then
        strTemp="WPFObject(""ContentControlEx"", ""Upload Workspace"", 2)"
        set objwrkspcUpload=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).FindChild("Name",strTemp,50,True)
        If objwrkspcUpload.Exists = True then
          objwrkspcUpload.Click
          'Delay 1000,"Pls Wait.."
          strTemp="WPFObject(""PART_ContainerContent"")"
        Set objConfirm=Sys.Process("EdgeClient").WPFObject("HwndSource: WindowContentHolder", "Confirm").FindChild("Name",strTemp,50,True)

         ' Set objConfirm=objConfirm.WaitChild(strTemp,180000)
          If objConfirm.Exists = True then
            Sys.Keys "[Enter]"
            'Delay 8000,"Uploading..."
           ' Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "Upload Workspace").WPFObject("CustomMessageBoxWindow", "Upload Workspace", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent")
            Set objConfirm = Sys.Process("EdgeClient")._
            Waitchild("WPFObject(""HwndSource: CustomMessageBoxWindow"", ""Upload Workspace"")",600000)._
            Waitchild("WPFObject(""CustomMessageBoxWindow"", ""Upload Workspace"", 1)",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""FloatingContainerBorder"")",60000)._
            Waitchild("WPFObject(""FloatingContainerBackground"")",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""FloatingContainerBody"")",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""PART_ContainerContent"")",60000)
            If objConfirm.Exists = True then
            Sys.Keys "[Enter]"
              'Delay 30000,"Pls Wait.."
              Call sEdgeProcessor
            End if
          End if
        End if
      End if
  End if
 
End Sub

Sub  sCheckSrcOpenEdit3Update(strParameters)
On Error Resume Next 
   Dim strSource1,StrSource2,strSource3,strTemp,GridControl,GridSourceTree,intTotNodeCnt,intI,intJ,intRow,intK,objEdge
   Dim objNewWorkspace,objWrkspace_popup,objOpenView,strTemp1,objNewWrkSpaceName,objNewWrkSpace_Txtbox,objNewWrkSpace_okbtn,objNewWrkSpace_Name
   Dim strDesc1,strDesc2,DescText,DescLocalText
   Dim objEditSource
   Dim objTemp, objStrClose
   
    strSource1=getSplitValue(strParameters,"SOURCE")
    StrSource2=getSplitValue(strParameters,"LEVEL2SOURCE")
    StrSource3=getSplitValue(strParameters,"LEVEL3SOURCE")
    
'    strSource1="Test"
'    StrSource2="Automation_UIT2"
'    StrSource3="Test"

    Call sHome_Source
    
    strDesc1=aqDateTime.Now
    strDesc2=aqDateTime.Now
    DescText=Replace(strDesc1,"/","-")
    DescText=Replace(DescText,":","_")
    DescLocalText=DescText
    strWrkSpaceName=DescText
    
    
    strTemp="WPFObject(""SourceTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""SourceTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    Delay 10000,"Pls Wait.."
    ''Selecting Country Name
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
          GridControl.Nodes_2.Item(intI).Expand(True)
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description       
          blnFlag=False  
          Exit For
        End If
    Next
    If blnFlag = True then
      strTCRemarks="Country Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
  
    Delay 10000,"Pls Wait.."
        blnFlag = True 
    ''Selecting Level2Source_Name
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
  For intJ=0 to intTotNodeCnt-1
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(StrSource2) then
        GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
        intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
'        Call GridSourceTree.ClickCell(intRow, "Edit")
        Call GridControl.ClearSelectionCore
        Call GridControl.FocusViewAndRow(GridControl,intRow)
        GridControl.SetFocusOnCurrentItem
        Call GridControl.SelectRowCore(intRow)
        log.Message "Level2 Source Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
        blnFlag = False 
        Exit For
      End If
    Next
    If blnFlag = True then
      log.Message "Level2 Source Name not found"
      strTCRemarks="Level2 Source Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
    
     Delay 10000,"Pls Wait.."
    blnFlag = True 
   
    Delay 2000,"Pls Wait.."

    strTemp="WPFObject(""ArrowControl"", """", 1)"
    Set objNewWorkspace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,20,True)
    If objNewWorkspace.Exists = True then
      objNewWorkspace.Click
       strTemp="WPFObject(""BarPopupBorderControl"", """", 1)"
      Set objWrkspace_popup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").FindChild("Name",strTemp,5,True)
      If objWrkspace_popup.Exists = True then
        strTemp="WPFObject(""ContentControlEx"", ""Open For Edit (Source)"", 2)"
        Set objopenforEdit=objWrkspace_popup.FindChild("Name",strTemp,8,True)
        If objopenforEdit.Exists then
          objopenforEdit.Click    
        End If
      End if
      
      strTemp1="WPFObject(""HwndSource: WorkspaceNamePrompt"", ""Please provide a new Workspace Name"")"
      Set objNewWrkSpaceName=Sys.Process("EdgeClient").WaitChild(strTemp1,50000)
      If objNewWrkSpaceName.Exists = True then
     
      ''Waiting for Workspace Name prompt
      strTemp="WPFObject(""FloatingContainerBorder"")"
      Set objNewWrkSpace_Name=Sys.Process("EdgeClient").WPFObject("HwndSource: WorkspaceNamePrompt", "Please provide a new Workspace Name").WPFObject("WorkspaceNamePrompt", "Please provide a new Workspace Name", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,15000000)
      If objNewWrkSpace_Name.Exists = True then
          strTemp="WPFObject(""ChangeNameTextEdit"")"
          ''Entering Workspace Name
          Set objNewWrkSpace_Txtbox=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
            If objNewWrkSpace_Txtbox.Exists = True then
              objNewWrkSpace_Txtbox.Click
              objNewWrkSpace_Txtbox.Text=strWrkSpaceName
      '        strTCRemarks=strTCRemarks & Chr(10) & "Entered Workspace Name - " & strWrkSpaceName
              ''Clicking on Ok Button 
              strTemp="WPFObject(""OkButton"")"
              Set objNewWrkSpace_okbtn=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
              If objNewWrkSpace_okbtn.Exists = True then
                objNewWrkSpace_okbtn.Click
                'Delay 5000,"Please wait..."
              End If
            End If
        End If
      End if 
     End if 
       
  
       ''Handling Validation for Source
    strTemp="WPFObject(""HwndSource: WindowContentHolder"", """")"
    Set objTemp=Sys.Process("EdgeClient").WaitChild(strTemp,10000)
    If objTemp.Exists = True then
      objTemp.Keys "[Enter]"
      strTestCaseResult = "FAIL"
      Exit Sub
    End If

    ''WorkSpace Edit Window
    strTemp="WPFObject(""LayoutPanel"", """", 2)"
    Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,13,True)
    If objTemp.Exists then
        Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WPFObject("SourceTreeListView")
        Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl")
       Delay 10000,"Pls Wait.."
        ''Expanding First Node in Tree      
        intTotNodeCnt=GridControl.Nodes_2.Count  
        For intI=0 to intTotNodeCnt-1         
          If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
           GridControl.Nodes_2.Item(intI).Expand(True)
           blnFlag=False  
           Exit For
          End If
        Next
         Delay 10000,"Pls Wait.."
        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
          For intJ=0 to intTotNodeCnt-1
            If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strSource2) then
              GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
              intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(0).get_RowHandle
              GridControl.Keys "^[Home]"
              Call GridControl.ClearSelectionCore
              Call GridControl.FocusViewAndRow(GridControl,intRow-1)
              GridControl.SetFocusOnCurrentItem
              Call GridControl.SelectRowCore(intRow-1)
        
              If objGridCell.Exists = True then
                objGridCell.Click
              End If
              blnFlag = False 
              Exit For
            End If
          Next
          
                     Delay 10000,"Pls Wait.."
              intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count
               For intK=0 to intTotNodeCnt-1
                  If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description)=Ucase(strSource3) then
                      intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).get_RowHandle
                      Call GridControl.ClearSelectionCore
                      GridControl.set_FocusedRowHandle(intRow)
                      Call GridControl.FocusViewAndRow(GridControl,intRow)
                      GridControl.SetFocusOnCurrentItem
                      Call GridControl.SelectRowCore(intRow)
                      Exit For   
                  End If 
               Next
    End if
        

    
    strTemp="WPFObject(""SourceTreeListView"")"
    'objEditSource=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WaitChild(strTemp,15000000)
    objEditSource=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WaitChild(strTemp,15000000)
    if objEditSource.Exists = True then
'          
'          
          
'          Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 4).WPFObject("BarButtonItemLinkControl", "", 1)      
'         Delay 8000,"New Folder..."
         
        

''        ''Getting no. of Rows under level 2
        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Count
        'intK=intTotNodeCnt-1
''        'intRow
        Set objDescCell=Aliases.EdgeClient.HwndSource_RibbonWindow.RibbonWindow.ContentControl.Grid.Grid.ContentControl.Grid.ContentControl.PART_ContainerContent.BarManager.DockPanel.DockLayoutManager.LayoutGroup.LayoutPanel2.Root.BarManager.AdornerDecorator.AdornedControl.Grid.DockPanel.SourceTreeListControl.SourceTreeListView.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK)
        Call objDescCell.SelectNode_2(intK)
        
'        Call objDescCell.Content.set_Description(DescText)
'        strTCRemarks = strTCRemarks & "<br />" & "Description is added in new folder"
'        log.Message "Description is added in new folder"
'        
'        Call objDescCell.Content.set_DescriptionLocal(DescLocalText)
'        strTCRemarks = strTCRemarks & "<br />" & "Description local is added in new folder"
'        log.Message "Description local is added in new folder"
        
        
        Call objDescCell.SelectCell_2(intK,5)
        Sys.Keys("[Tab][Tab][Tab][Tab]")
        ''Call objDescCell.Content.set_SourceType("Web")
        SYS.Keys "[Enter]"
        strTemp="WPFObject(""ComboBoxEdit"", """", 1)"
        set objConfirm=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WPFObject("SourceTreeListView").WPFObject("HierarchyPanel", "", 1).FindChild("Name",strTemp,50,True)
         If objConfirm.Exists = True then
              'objConfirm.Fullname.Click
              
'               SYS.Keys "[Enter]"
               Delay 10000,"Pls Wait.."
               strTemp="WPFObject(""PART_Item"")"
               set objConfirm=objConfirm.FindChild("Name",strTemp,50,True)
               Delay 10000,"Pls Wait.."
              objConfirm.Click
               Delay 10000,"Pls Wait.."
              SYS.Keys "[Down][Enter]"
              Delay 10000,"Pls Wait.."
              strTCRemarks = strTCRemarks & "<br />" & "Source Type is editable"
              log.Message "Source Type is editable"
              strTCRemarks = strTCRemarks & "<br />" & "Source Type is added in new folder"
             log.Message "Source Type is added in new folder"
         Else
             strTCRemarks = strTCRemarks & "<br />" & "Source Type is not editable"
             log.Message "Source Type is not editable"
         End if
        
        
        
        Call objDescCell.Content.set_URL("URL1")
        strTCRemarks = strTCRemarks & "<br />" & "URL is added in new folder"
        log.Message "URL is added in new folder"
            
        
         
         Call objDescCell.Content.set_MacroPath("macro1")
        strTCRemarks = strTCRemarks & "<br />" & "Macro Path is added in new folder"
        log.Message "Macro Path is added in new folder"
        
         Call objDescCell.Content.set_MacroCapFlag("macrocapflag1")
        strTCRemarks = strTCRemarks & "<br />" & "Macro Cap Flag is added in new folder"
        log.Message "Macro Cap Flag is added in new folder"
        
         Call objDescCell.Content.set_Remark("Remarks1")
        strTCRemarks = strTCRemarks & "<br />" & "Remark is added in new folder"
        log.Message "Remark is added in new folder"
        Delay(5000)
        
        
       Delay 15000,"Pls Wait.."
      Call SClosesource()
      Delay 5000,"Pls Wait.."
                   
    End if
 
    
    Delay 15000,"Pls Wait.."
    
    Dim objSaveWrk,objWait 
     set objSaveWrk=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 12).WPFObject("BarSubItemLinkControl", "", 1)
    strTemp="WPFObject(""ContentControlEx"", ""Workspace"", 2)"
    Set objTemp=objSaveWrk.FindChild("Name",strTemp,50)
    objWait=1
    Do until objTemp.Enabled = true 
        If objWait < 20 Then
          Delay 1000,"Pls Wait... Form is loading..."
          objWait=objWait+1
        else
          Call SClosesource()
          Call SourceWorkSpacevwr()
          Exit Sub
        end if 
    Loop 
    
    
    strTemp="WPFObject(""ContentControlEx"", ""Workspace"", 2)"
    Set objWrkSpace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,50,True)
    If objWrkSpace.Exists = True then
    Delay(1000)
      objWrkSpace.Click
      Delay(1000)
      objWrkSpace.Click
      strTemp="WPFObject(""PopupMenuBarControl"", """", 1)"
      Set objwrkspacepop=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").Findchild("Name",strTemp,50,True)
      'Set objwrkspacepop=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 2).WPFObject("BarButtonItemLinkControl", "", 1).WPFObject("ContentControlEx", "Upload Workspace", 2)
      If objwrkspacepop.Exists = True then
        strTemp="WPFObject(""ContentControlEx"", ""Upload Workspace"", 2)"
        set objwrkspcUpload=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).FindChild("Name",strTemp,50,True)
        If objwrkspcUpload.Exists = True then
          objwrkspcUpload.Click
          'Delay 1000,"Pls Wait.."
          strTemp="WPFObject(""PART_ContainerContent"")"
          Set objConfirm=Sys.Process("EdgeClient").WPFObject("HwndSource: WindowContentHolder", "Confirm").FindChild("Name",strTemp,50,True)
          strTemp="WPFObject(""DXMessageBox"", """", 1)"
          Set objConfirm=objConfirm.WaitChild(strTemp,180000)
          If objConfirm.Exists = True then
            objConfirm.Keys "[Enter]"
            'Delay 8000,"Uploading..."
           Set objConfirm = Sys.Process("EdgeClient")._
            Waitchild("WPFObject(""HwndSource: CustomMessageBoxWindow"", ""Upload Workspace"")",600000)._
            Waitchild("WPFObject(""CustomMessageBoxWindow"", ""Upload Workspace"", 1)",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""FloatingContainerBorder"")",60000)._
            Waitchild("WPFObject(""FloatingContainerBackground"")",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""FloatingContainerBody"")",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""PART_ContainerContent"")",60000)
            If objConfirm.Exists = True then
              Sys.Keys "[Enter]"
              'Delay 30000,"Pls Wait.."
              Call sEdgeProcessor
            End if
          End if
        End if
      End if
    End if
  'Call SClosesource()
  'Call SourceWorkSpacevwr()
End Sub
Sub  sCheckSrcOpenEdit3MacroFlag(strParameters)
On Error Resume Next 
   Dim strSource1,StrSource2,strSource3,strTemp,GridControl,GridSourceTree,intTotNodeCnt,intI,intJ,intRow,intK,objEdge
   Dim objNewWorkspace,objWrkspace_popup,objOpenView,strTemp1,objNewWrkSpaceName,objNewWrkSpace_Txtbox,objNewWrkSpace_okbtn,objNewWrkSpace_Name
   Dim strDesc1,strDesc2,DescText,DescLocalText
   Dim objEditSource
   Dim objTemp, objStrClose
   
    strSource1=getSplitValue(strParameters,"SOURCE")
    StrSource2=getSplitValue(strParameters,"LEVEL2SOURCE")
    StrSource3=getSplitValue(strParameters,"LEVEL3SOURCE")
    
'    strSource1="Test"
'    StrSource2="Automation_UIT2"
'    StrSource3="Test"

    Call sHome_Source
    
    strDesc1=aqDateTime.Now
    strDesc2=aqDateTime.Now
    DescText=Replace(strDesc1,"/","-")
    DescText=Replace(DescText,":","_")
    DescLocalText=DescText
    strWrkSpaceName=DescText
    
    
    strTemp="WPFObject(""SourceTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""SourceTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    Delay 10000,"Pls Wait.."
    ''Selecting Country Name
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
          GridControl.Nodes_2.Item(intI).Expand(True)
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description       
          blnFlag=False  
          Exit For
        End If
    Next
    If blnFlag = True then
      strTCRemarks="Country Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
  
    Delay 10000,"Pls Wait.."
        blnFlag = True 
    ''Selecting Level2Source_Name
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
  For intJ=0 to intTotNodeCnt-1
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(StrSource2) then
        GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
        intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
'        Call GridSourceTree.ClickCell(intRow, "Edit")
        Call GridControl.ClearSelectionCore
        Call GridControl.FocusViewAndRow(GridControl,intRow)
        GridControl.SetFocusOnCurrentItem
        Call GridControl.SelectRowCore(intRow)
        log.Message "Level2 Source Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
        blnFlag = False 
        Exit For
      End If
    Next
    If blnFlag = True then
      log.Message "Level2 Source Name not found"
      strTCRemarks="Level2 Source Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
    
     Delay 10000,"Pls Wait.."
    blnFlag = True 
   
    Delay 2000,"Pls Wait.."

    strTemp="WPFObject(""ArrowControl"", """", 1)"
    Set objNewWorkspace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,20,True)
    If objNewWorkspace.Exists = True then
      objNewWorkspace.Click
       strTemp="WPFObject(""BarPopupBorderControl"", """", 1)"
      Set objWrkspace_popup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").FindChild("Name",strTemp,5,True)
      If objWrkspace_popup.Exists = True then
        strTemp="WPFObject(""ContentControlEx"", ""Open For Edit (Source)"", 2)"
        Set objopenforEdit=objWrkspace_popup.FindChild("Name",strTemp,8,True)
        If objopenforEdit.Exists then
          objopenforEdit.Click    
        End If
      End if
      
      strTemp1="WPFObject(""HwndSource: WorkspaceNamePrompt"", ""Please provide a new Workspace Name"")"
      Set objNewWrkSpaceName=Sys.Process("EdgeClient").WaitChild(strTemp1,50000)
      If objNewWrkSpaceName.Exists = True then
     
      ''Waiting for Workspace Name prompt
      strTemp="WPFObject(""FloatingContainerBorder"")"
      Set objNewWrkSpace_Name=Sys.Process("EdgeClient").WPFObject("HwndSource: WorkspaceNamePrompt", "Please provide a new Workspace Name").WPFObject("WorkspaceNamePrompt", "Please provide a new Workspace Name", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,15000000)
      If objNewWrkSpace_Name.Exists = True then
          strTemp="WPFObject(""ChangeNameTextEdit"")"
          ''Entering Workspace Name
          Set objNewWrkSpace_Txtbox=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
            If objNewWrkSpace_Txtbox.Exists = True then
              objNewWrkSpace_Txtbox.Click
              objNewWrkSpace_Txtbox.Text=strWrkSpaceName
      '        strTCRemarks=strTCRemarks & Chr(10) & "Entered Workspace Name - " & strWrkSpaceName
              ''Clicking on Ok Button 
              strTemp="WPFObject(""OkButton"")"
              Set objNewWrkSpace_okbtn=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
              If objNewWrkSpace_okbtn.Exists = True then
                objNewWrkSpace_okbtn.Click
                'Delay 5000,"Please wait..."
              End If
            End If
        End If
      End if 
     End if 
       
  
       ''Handling Validation for Source
    strTemp="WPFObject(""HwndSource: WindowContentHolder"", """")"
    Set objTemp=Sys.Process("EdgeClient").WaitChild(strTemp,10000)
    If objTemp.Exists = True then
      objTemp.Keys "[Enter]"
      strTestCaseResult = "FAIL"
      Exit Sub
    End If

    ''WorkSpace Edit Window
    strTemp="WPFObject(""LayoutPanel"", """", 2)"
    Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,13,True)
    If objTemp.Exists then
        Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WPFObject("SourceTreeListView")
        Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl")
       Delay 10000,"Pls Wait.."
        ''Expanding First Node in Tree      
        intTotNodeCnt=GridControl.Nodes_2.Count  
        For intI=0 to intTotNodeCnt-1         
          If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
           GridControl.Nodes_2.Item(intI).Expand(True)
           blnFlag=False  
           Exit For
          End If
        Next
         Delay 10000,"Pls Wait.."
        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
          For intJ=0 to intTotNodeCnt-1
            If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strSource2) then
              GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
              intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(0).get_RowHandle
              GridControl.Keys "^[Home]"
              Call GridControl.ClearSelectionCore
              Call GridControl.FocusViewAndRow(GridControl,intRow-1)
              GridControl.SetFocusOnCurrentItem
              Call GridControl.SelectRowCore(intRow-1)
        
              If objGridCell.Exists = True then
                objGridCell.Click
              End If
              blnFlag = False 
              Exit For
            End If
          Next
    End if
            
    strTemp="WPFObject(""SourceTreeListView"")"
    objEditSource=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WaitChild(strTemp,15000000)
    if objEditSource.Exists = True then
       strTemp="WPFObject(""ContentControlEx"", ""Add Folder"", 2)"
          Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 4).WPFObject("BarButtonItemLinkControl", "", 1).FindChild("Name",strTemp,50,True)
          If objNewWrkSpace_okbtn.Exists = True then
             If objNewWrkSpace_okbtn.Enabled = True then
                objNewWrkSpace_okbtn.Click
                strTCRemarks = strTCRemarks & "<br />" & "New Folder Added "
                log.Message "New Folder Added"
             Else
                strTCRemarks = strTCRemarks & "<br />" & "Add Folder is Disabled in Source"
                log.Message "Add Folder is Disabled in Source"
             End if
          Else
            strTCRemarks = strTCRemarks & "<br />" & "Add Folder is  not found in Source"
            log.Message "Add Folder is not found in Source"
          End If
          
          
          
          
          Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 4).WPFObject("BarButtonItemLinkControl", "", 1)      
         Delay 8000,"New Folder..."
         
        

''        ''Getting no. of Rows under level 2
        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count
        intK=intTotNodeCnt-1
''        'intRow
        Set objDescCell=Aliases.EdgeClient.HwndSource_RibbonWindow.RibbonWindow.ContentControl.Grid.Grid.ContentControl.Grid.ContentControl.PART_ContainerContent.BarManager.DockPanel.DockLayoutManager.LayoutGroup.LayoutPanel2.Root.BarManager.AdornerDecorator.AdornedControl.Grid.DockPanel.SourceTreeListControl.SourceTreeListView.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK)
        Call objDescCell.SelectNode_2(intJ)
        
        Call objDescCell.Content.set_Description(DescText)
        strTCRemarks = strTCRemarks & "<br />" & "Description is added in new folder"
        log.Message "Description is added in new folder"
        
        Call objDescCell.Content.set_DescriptionLocal(DescLocalText)
        strTCRemarks = strTCRemarks & "<br />" & "Description local is added in new folder"
        log.Message "Description local is added in new folder"
        
        
        
      
         Call objDescCell.Content.set_MacroPath("macro")
        strTCRemarks = strTCRemarks & "<br />" & "Macro Path is added in new folder"
        log.Message "Macro Path is added in new folder"
        
         Call objDescCell.Content.set_MacroCapFlag("macrocapflag")
        strTCRemarks = strTCRemarks & "<br />" & "Macro Cap Flag is added in new folder"
        log.Message "Macro Cap Flag is added in new folder"
        
        Call objDescCell.SelectCell_2(intK,5)
       ' Sys.Keys("[Tab]")
        
        
         SYS.Keys("[Right][Right][Right][Right][Right][Right][Right][Right][Enter]")
            SYS.Keys("^[End]23")
            Delay 10000,"Pls Wait.."
            Sys.Keys("[Up]")
'             Delay 10000,"Pls Wait.."
'            Set objConfirm = Sys.Process("EdgeClient")._
'            Waitchild("WPFObject(""HwndSource: CustomMessageBoxWindow"", ""Confirm"")",600000)._
'            Waitchild("WPFObject(""CustomMessageBoxWindow"", ""Confirm"", 1)",60000)._
'            Waitchild("WPFObject(""Grid"", ""Confirm"", 1)",60000)._
'            Waitchild("WPFObject(""FloatingContainerBorder"")",60000)._
'            Waitchild("WPFObject(""FloatingContainerBackground"")",60000)._
'            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
'            Waitchild("WPFObject(""FloatingContainerBody"")",60000)._
'            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
'            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
'            Waitchild("WPFObject(""PART_ContainerContent"")",60000)
'            If objConfirm.Exists = True Then
'                objConfirm.Click
'                SYS.Keys "[Enter]"
'            End If
    
            strTemp="WPFObject(""PART_ContainerContent"")"
            Set objConfirm= Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "Confirm").WPFObject("CustomMessageBoxWindow", "Confirm", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).FindChild("Name",strTemp,9,True)
            If objConfirm.Exists = True Then
                objConfirm.Click
                SYS.Keys "[Enter]"
            End If
            Call sEdgeProcessor
            strTemp="WPFObject(""PART_ContainerContent"")"
            Set objConfirm=Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "Confirm").WPFObject("CustomMessageBoxWindow", "Confirm", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).FindChild("Name",strTemp,9,True)
            If objConfirm.Exists = True Then
                objConfirm.Click
                SYS.Keys "[Enter]"
            End If
            Call sEdgeProcessor
       Delay 15000,"Pls Wait.."
      Call SClosesource()
      Delay 5000,"Pls Wait.."
                   
    End if
 
    
    Delay 15000,"Pls Wait.."
    
    Dim objSaveWrk,objWait  
     set objSaveWrk=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 12).WPFObject("BarSubItemLinkControl", "", 1)
    strTemp="WPFObject(""ContentControlEx"", ""Workspace"", 2)"
    objWait=1
    Set objTemp=objSaveWrk.FindChild("Name",strTemp,50)
    Do until objTemp.Enabled = true 
        If objWait < 20 Then
          Delay 1000,"Pls Wait... Form is loading..."
          objWait=objWait+1
        else
          Call SClosesource()
          Call SourceWorkSpacevwr()
          Exit Sub
        end if 

    Loop 
    
    
    strTemp="WPFObject(""ContentControlEx"", ""Workspace"", 2)"
    Set objWrkSpace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,50,True)
    If objWrkSpace.Exists = True then
    Delay(1000)
      objWrkSpace.Click
'      Delay(1000)
'      objWrkSpace.Click
      strTemp="WPFObject(""PopupMenuBarControl"", """", 1)"
      Set objwrkspacepop=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").Findchild("Name",strTemp,50,True)
      'Set objwrkspacepop=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 2).WPFObject("BarButtonItemLinkControl", "", 1).WPFObject("ContentControlEx", "Upload Workspace", 2)
      If objwrkspacepop.Exists = True then
        Dim objEdgeFilter
      set objEdgeFilter= Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarButtonItemLinkControl", "", 1)
      strTemp="WPFObject(""ContentControlEx"", ""Save Workspace"", 2)"
      Set objTemp=objEdgeFilter.FindChild("Name",strTemp,50)
      If objTemp.Exists = TRUE then
        Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarButtonItemLinkControl", "", 1).WPFObject("ContentControlEx", "Save Workspace", 2).Click
        strTemp="WPFObject(""PART_ContainerContent"")"
        Set objConfirm=Sys.Process("EdgeClient").WPFObject("HwndSource: WindowContentHolder", "Confirm save.").FindChild("Name",strTemp,50,True)
'          strTemp="WPFObject(""DXMessageBox"", """", 1)"
'          Set objConfirm=objConfirm.WaitChild(strTemp,900000)
          If objConfirm.Exists = True then
            sys.Keys("Y")
            Set objConfirm = Sys.Process("EdgeClient")._
            Waitchild("WPFObject(""HwndSource: CustomMessageBoxWindow"", """")",600000)._
            Waitchild("WPFObject(""CustomMessageBoxWindow"", """", 1)",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""FloatingContainerBorder"")",60000)._
            Waitchild("WPFObject(""FloatingContainerBackground"")",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""FloatingContainerBody"")",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""PART_ContainerContent"")",60000)
                        
            If objConfirm.Exists = True Then
                objConfirm.Click
                SYS.Keys "[Enter]"
            End If
          End if 
        End if 

      End if
    End if
  Call SClosesource()
  Call SourceWorkSpacevwr()
End Sub

Sub  sCheckSrcOpenEdit3Red()
On Error Resume Next 
   Dim strSource1,StrSource2,strSource3,strTemp,GridControl,GridSourceTree,intTotNodeCnt,intI,intJ,intRow,intK,objEdge
   Dim objNewWorkspace,objWrkspace_popup,objOpenView,strTemp1,objNewWrkSpaceName,objNewWrkSpace_Txtbox,objNewWrkSpace_okbtn,objNewWrkSpace_Name
   Dim strDesc1,strDesc2,DescText,DescLocalText
   Dim objEditSource
   Dim objTemp, objStrClose
   
'    strSource1=getSplitValue(strParameters,"SOURCE")
'    StrSource2=getSplitValue(strParameters,"LEVEL2SOURCE")
'    StrSource3=getSplitValue(strParameters,"LEVEL3SOURCE")
    
    strSource1="Test"
    StrSource2="Automation_UIT2"
    StrSource3="Test"

    Call sHome_Source
    
    strDesc1=aqDateTime.Now
    strDesc2=aqDateTime.Now
    DescText=Replace(strDesc1,"/","-")
    DescText=Replace(DescText,":","_")
    DescLocalText=DescText
    strWrkSpaceName=DescText
'    intSeriesID=getSplitValue(strParameters,"SERIESID")
'    if intSeriesID=0 then
'      Call sSourceseries
'      intSeriesID=strSourceFileText
'    End if 
    
    strTemp="WPFObject(""SourceTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""SourceTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    Delay 10000,"Pls Wait.."
    ''Selecting Country Name
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
          GridControl.Nodes_2.Item(intI).Expand(True)
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description       
          blnFlag=False  
          Exit For
        End If
    Next
    If blnFlag = True then
      strTCRemarks="Country Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
  
    Delay 10000,"Pls Wait.."
        blnFlag = True 
    ''Selecting Level2Source_Name
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
  For intJ=0 to intTotNodeCnt-1
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(StrSource2) then
        GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
        intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
'        Call GridSourceTree.ClickCell(intRow, "Edit")
        Call GridControl.ClearSelectionCore
        Call GridControl.FocusViewAndRow(GridControl,intRow)
        GridControl.SetFocusOnCurrentItem
        Call GridControl.SelectRowCore(intRow)
        log.Message "Level2 Source Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
        blnFlag = False 
        Exit For
      End If
    Next
    If blnFlag = True then
      log.Message "Level2 Source Name not found"
      strTCRemarks="Level2 Source Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
    
     Delay 10000,"Pls Wait.."
    blnFlag = True 
   
    Delay 2000,"Pls Wait.."

    strTemp="WPFObject(""ArrowControl"", """", 1)"
    Set objNewWorkspace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,20,True)
    If objNewWorkspace.Exists = True then
      objNewWorkspace.Click
       strTemp="WPFObject(""BarPopupBorderControl"", """", 1)"
      Set objWrkspace_popup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").FindChild("Name",strTemp,5,True)
      If objWrkspace_popup.Exists = True then
        strTemp="WPFObject(""ContentControlEx"", ""Open For Edit (Source)"", 2)"
        Set objopenforEdit=objWrkspace_popup.FindChild("Name",strTemp,8,True)
        If objopenforEdit.Exists then
          objopenforEdit.Click    
        End If
      End if
      
      strTemp1="WPFObject(""HwndSource: WorkspaceNamePrompt"", ""Please provide a new Workspace Name"")"
      Set objNewWrkSpaceName=Sys.Process("EdgeClient").WaitChild(strTemp1,50000)
      If objNewWrkSpaceName.Exists = True then
     
      ''Waiting for Workspace Name prompt
      strTemp="WPFObject(""FloatingContainerBorder"")"
      Set objNewWrkSpace_Name=Sys.Process("EdgeClient").WPFObject("HwndSource: WorkspaceNamePrompt", "Please provide a new Workspace Name").WPFObject("WorkspaceNamePrompt", "Please provide a new Workspace Name", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,15000000)
      If objNewWrkSpace_Name.Exists = True then
          strTemp="WPFObject(""ChangeNameTextEdit"")"
          ''Entering Workspace Name
          Set objNewWrkSpace_Txtbox=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
            If objNewWrkSpace_Txtbox.Exists = True then
              objNewWrkSpace_Txtbox.Click
              objNewWrkSpace_Txtbox.Text=strWrkSpaceName
      '        strTCRemarks=strTCRemarks & Chr(10) & "Entered Workspace Name - " & strWrkSpaceName
              ''Clicking on Ok Button 
              strTemp="WPFObject(""OkButton"")"
              Set objNewWrkSpace_okbtn=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
              If objNewWrkSpace_okbtn.Exists = True then
                objNewWrkSpace_okbtn.Click
                'Delay 5000,"Please wait..."
              End If
            End If
        End If
      End if 
     End if 
       
  
       ''Handling Validation for Source
    strTemp="WPFObject(""HwndSource: WindowContentHolder"", """")"
    Set objTemp=Sys.Process("EdgeClient").WaitChild(strTemp,10000)
    If objTemp.Exists = True then
      objTemp.Keys "[Enter]"
      strTestCaseResult = "FAIL"
      Exit Sub
    End If

    ''WorkSpace Edit Window
    strTemp="WPFObject(""LayoutPanel"", """", 2)"
    Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,13,True)
    If objTemp.Exists then
        Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WPFObject("SourceTreeListView")
        Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl")
       Delay 10000,"Pls Wait.."
        ''Expanding First Node in Tree      
        intTotNodeCnt=GridControl.Nodes_2.Count  
        For intI=0 to intTotNodeCnt-1         
          If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
           GridControl.Nodes_2.Item(intI).Expand(True)
           blnFlag=False  
           Exit For
          End If
        Next
         Delay 10000,"Pls Wait.."
        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
          For intJ=0 to intTotNodeCnt-1
            If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strSource2) then
              GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
              intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(0).get_RowHandle
              GridControl.Keys "^[Home]"
              Call GridControl.ClearSelectionCore
              Call GridControl.FocusViewAndRow(GridControl,intRow-1)
              GridControl.SetFocusOnCurrentItem
              Call GridControl.SelectRowCore(intRow-1)
        
              If objGridCell.Exists = True then
                objGridCell.Click
              End If
              blnFlag = False 
              Exit For
            End If
          Next
'           Delay 10000,"Pls Wait.."
'              intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count
'               For intK=0 to intTotNodeCnt-1
'                  If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description)=Ucase(strSource3) then
'                      intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).get_RowHandle
'                      Call GridControl.ClearSelectionCore
'                      GridControl.set_FocusedRowHandle(intRow)
'                      Call GridControl.FocusViewAndRow(GridControl,intRow)
'                      GridControl.SetFocusOnCurrentItem
'                      Call GridControl.SelectRowCore(intRow)
'                      Exit For   
'                  End If 
'               Next
    End if
        
'        Delay 15000,"Pls Wait.."
'      Call SClosesource()
'      Delay 5000,"Pls Wait.."
    
    strTemp="WPFObject(""SourceTreeListView"")"
    'objEditSource=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WaitChild(strTemp,15000000)
    objEditSource=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WaitChild(strTemp,15000000)
    if objEditSource.Exists = True then
          
           
        ''Getting no. of Rows under level 2
        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count
        intK=intTotNodeCnt-1
    
        Set objDescCell=Aliases.EdgeClient.HwndSource_RibbonWindow.RibbonWindow.ContentControl.Grid.Grid.ContentControl.Grid.ContentControl.PART_ContainerContent.BarManager.DockPanel.DockLayoutManager.LayoutGroup.LayoutPanel2.Root.BarManager.AdornerDecorator.AdornedControl.Grid.DockPanel.SourceTreeListControl.SourceTreeListView.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK)
        Call objDescCell.Content.set_Description("")
        strTCRemarks = strTCRemarks & "<br />" & "Description is added in new folder"
        log.Message "Description is cleared"
        
        Call objDescCell.Content.set_DescriptionLocal("")
        strTCRemarks = strTCRemarks & "<br />" & "Description local is added in new folder"
        log.Message "Description local is Cleared"
        
        Call objDescCell.SelectCell_2(intK,5)
        Sys.Keys("[Tab]")
        SYS.Keys "[Enter]"
        
        strTemp="WPFObject(""LampRedStatePresentationControl"", """", 1)"
        set objConfirm=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WPFObject("SourceTreeListView").WPFObject("HierarchyPanel", "", 1).FindChild("Name",strTemp,50,True)
        If objConfirm.Exists = True then
          strTCRemarks = strTCRemarks & "<br />" & "Red Dot shown in description"
          log.Message "Red Dot shown in description"
        else
          strTCRemarks = strTCRemarks & "<br />" & "Red Dot is not shown in description"
          log.Message "Red Dotis not shown in description"
          
        End if 
          
        Delay 15000,"Pls Wait.."
        Call SClosesource()
        Delay 5000,"Pls Wait.."             
    End if
 

    Dim objSaveWrk,objWait  
     set objSaveWrk=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 12).WPFObject("BarSubItemLinkControl", "", 1)
    strTemp="WPFObject(""ContentControlEx"", ""Workspace"", 2)"
    Set objTemp=objSaveWrk.FindChild("Name",strTemp,50)
    objWait=1
    Do until objTemp.Enabled = true 
        If objWait < 20 Then
          Delay 1000,"Pls Wait... Form is loading..."
          objWait=objWait+1
        else
          Call SClosesource()
          Call SourceWorkSpacevwr()
          Exit Sub
        end if 
    Loop 
    
    ''Save WorkSpace
    strTemp="WPFObject(""ContentControlEx"", ""Workspace"", 2)"
    Set objWrkSpace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,50,True)
    If objWrkSpace.Exists = True then
      objWrkSpace.Click
      Dim objEdgeFilter
      set objEdgeFilter= Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarButtonItemLinkControl", "", 1)
      strTemp="WPFObject(""ContentControlEx"", ""Save Workspace"", 2)"
      Set objTemp=objEdgeFilter.FindChild("Name",strTemp,50)
      If objTemp.Exists = TRUE then
        Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarButtonItemLinkControl", "", 1).WPFObject("ContentControlEx", "Save Workspace", 2).Click
        strTemp="WPFObject(""PART_ContainerContent"")"
        Set objConfirm=Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "Confirm save.").FindChild("Name",strTemp,50,True)

          If objConfirm.Exists = True then
            sys.Keys("Y")
            Set objConfirm = Sys.Process("EdgeClient")._
            Waitchild("WPFObject(""HwndSource: CustomMessageBoxWindow"", """")",600000)._
            Waitchild("WPFObject(""CustomMessageBoxWindow"", """", 1)",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""FloatingContainerBorder"")",60000)._
            Waitchild("WPFObject(""FloatingContainerBackground"")",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""FloatingContainerBody"")",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""PART_ContainerContent"")",60000)
                        
            If objConfirm.Exists = True Then
                objConfirm.Click
                SYS.Keys "[Enter]"
            End If
          End if 
        End if 
    End if 

  Call SClosesource()
  Call SourceOpenWorkSpacevwr()
  Call SourceWorkSpacevwr()
End Sub

Sub sCheckSrcSave(strParameters)
On Error Resume Next

    Dim strSource_Name,strLevel2src_Name,objNewWrkSpace_okbtn,objNewWrkSpace_Name,strWrkSpaceName
    Dim objNewWrkSpace_Txtbox,objopenforEdit,objWrkspace_popup
    Dim strTemp,objTemp,intRow,barManager,intTotNodeCnt,Text,strDesc1,strDesc2
    Dim objWrkSpace,objwrkspacepop,objwrkspcUpload,objConfirm,objGridCell,DescLocalText,intSeriesID,SERIESID
    Dim layoutGroup
    Dim strTemp1,objNewWrkSpaceName

    strSource_Name=getSplitValue(strParameters,"SOURCE")
    strLevel2src_Name=getSplitValue(strParameters,"LEVEL2SOURCE")
    
'    strSource_Name="Test"
'    strLevel2src_Name="Automation_UIT2"
'    intSeriesID="368766057"
    
    strDesc1=aqDateTime.Now
    strDesc2=aqDateTime.Now
    DescText=Replace(strDesc1,"/","-")
    DescText=Replace(DescText,":","_")
    DescLocalText=DescText
    strWrkSpaceName=DescText
    
    intSeriesID=getSplitValue(strParameters,"SERIESID")
'    if intSeriesID=0 then
'      Call sSourceseries
'      intSeriesID=strSourceFileText
'    End if 

    
    strTemp="WPFObject(""SourceTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""SourceTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    Delay 10000,"Pls Wait.."
    ''Selecting Country Name
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource_Name) then
          GridControl.Nodes_2.Item(intI).Expand(True)
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description       
    '      strTCRemarks=strTCRemarks & Chr(10) & "Selected Node - " & GridControl.Nodes_2.Item(intI).Content.Description  
          blnFlag=False  
          Exit For
        End If
    Next
    If blnFlag = True then
      strTCRemarks="Country Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
  
    Delay 10000,"Pls Wait.."
        blnFlag = True 
    ''Selecting Level2Source_Name
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
    For intJ=0 to intTotNodeCnt-1
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strLevel2src_Name) then
        GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
    '    intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(0).get_RowHandle
        intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
'        Call GridSourceTree.ClickCell(intRow, "Edit")
        Call GridControl.ClearSelectionCore
        Call GridControl.FocusViewAndRow(GridControl,intRow)
        GridControl.SetFocusOnCurrentItem
        Call GridControl.SelectRowCore(intRow)
        log.Message "Level2 Source Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
        blnFlag = False 
        Exit For
      End If
    Next
    If blnFlag = True then
      log.Message "Level2 Source Name not found"
      strTCRemarks="Level2 Source Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
    Delay 2000,"Pls Wait.."

    ''Clicking on "New Workspace" Button and selecting "Open for Edit(Souce)" option 
    strTemp="WPFObject(""ArrowControl"", """", 1)"
    Set objNewWorkspace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,20,True)
    If objNewWorkspace.Exists = True then
      objNewWorkspace.Click
      strTemp="WPFObject(""BarPopupBorderControl"", """", 1)"
      Set objWrkspace_popup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").FindChild("Name",strTemp,5,True)
      If objWrkspace_popup.Exists = True then
        strTemp="WPFObject(""ContentControlEx"", ""Open For Edit (Source)"", 2)"
        Set objopenforEdit=objWrkspace_popup.FindChild("Name",strTemp,8,True)
        If objopenforEdit.Exists then
          objopenforEdit.Click    
          'Delay 20000,"Please Wait..."
        End If
      End If
     
    
      strTemp1="WPFObject(""HwndSource: WorkspaceNamePrompt"", ""Please provide a new Workspace Name"")"
      Set objNewWrkSpaceName=Sys.Process("EdgeClient").WaitChild(strTemp1,50000)
      If objNewWrkSpaceName.Exists = True then
     
      ''Waiting for Workspace Name prompt
      strTemp="WPFObject(""FloatingContainerBorder"")"
      Set objNewWrkSpace_Name=Sys.Process("EdgeClient").WPFObject("HwndSource: WorkspaceNamePrompt", "Please provide a new Workspace Name").WPFObject("WorkspaceNamePrompt", "Please provide a new Workspace Name", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,15000000)
     ' Set objNewWrkSpace_Name=Sys.Process("EdgeClient").WaitChild(strTemp,15000000)
        If objNewWrkSpace_Name.Exists = True then
          strTemp="WPFObject(""ChangeNameTextEdit"")"
          ''Entering Workspace Name
          Set objNewWrkSpace_Txtbox=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
            If objNewWrkSpace_Txtbox.Exists = True then
              objNewWrkSpace_Txtbox.Click
              objNewWrkSpace_Txtbox.Text=strWrkSpaceName
      '        strTCRemarks=strTCRemarks & Chr(10) & "Entered Workspace Name - " & strWrkSpaceName
              ''Clicking on Ok Button 
              strTemp="WPFObject(""OkButton"")"
              Set objNewWrkSpace_okbtn=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
              If objNewWrkSpace_okbtn.Exists = True then
                objNewWrkSpace_okbtn.Click
                'Delay 5000,"Please wait..."
              End If
            End If
        End If
    

    ''Handling Validation for Source
    strTemp="WPFObject(""HwndSource: WindowContentHolder"", """")"
    Set objTemp=Sys.Process("EdgeClient").WaitChild(strTemp,10000)
    If objTemp.Exists = True then
      objTemp.Keys "[Enter]"
      strTestCaseResult = "FAIL"
      Exit Sub
    End If

    ''WorkSpace Edit Window
    strTemp="WPFObject(""LayoutPanel"", """", 2)"
    Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,13,True)
    If objTemp.Exists then
        Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WPFObject("SourceTreeListView")
        Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl")

        ''Expanding First Node in Tree      
        intTotNodeCnt=GridControl.Nodes_2.Count  
        For intI=0 to intTotNodeCnt-1         
          If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource_Name) then
            GridControl.Nodes_2.Item(intI).Expand(True)
            blnFlag=False  
            Exit For
          End If
        Next
    
        ''Expanding Second Node in Tree
        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
        For intJ=0 to intTotNodeCnt-1
          If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strLevel2src_Name) then
            GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
            intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(0).get_RowHandle
            GridControl.Keys "^[Home]"
'            Set objGridCell=GridControl.WPFObject("HierarchyPanel", "", 1).WPFObject("GridRow", "", intRow).WPFObject("ScrollablePart").WPFObject("CellItemsControl", "", 1).WPFObject("GridCellContentPresenter", "", 1).WPFObject("TextEdit", "", 1)
            Call GridControl.ClearSelectionCore
            Call GridControl.FocusViewAndRow(GridControl,intRow-1)
            GridControl.SetFocusOnCurrentItem
            Call GridControl.SelectRowCore(intRow-1)
        
            If objGridCell.Exists = True then
              objGridCell.Click
    '          strTCRemarks=strTCRemarks & Chr(10) & "Selected - " & strLevel2src_Name
            End If
            blnFlag = False 
            Exit For
          End If
        Next
    
        ''Clicking on New Folder
    '   strTemp="WPFObject(""BarButtonItemLinkControl"", """", 1)"
        Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 4).WPFObject("BarButtonItemLinkControl", "", 1)
        If objTemp.Exists = True then
          Delay 3000,"New Folder..."
          objTemp.Click
          Delay 8000,"New Folder..."
        End If
    
        ''Getting no. of Rows under level 2
        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count
        intK=intTotNodeCnt-1
    
        Set objDescCell=Aliases.EdgeClient.HwndSource_RibbonWindow.RibbonWindow.ContentControl.Grid.Grid.ContentControl.Grid.ContentControl.PART_ContainerContent.BarManager.DockPanel.DockLayoutManager.LayoutGroup.LayoutPanel2.Root.BarManager.AdornerDecorator.AdornedControl.Grid.DockPanel.SourceTreeListControl.SourceTreeListView.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK)
        Call objDescCell.Content.set_Description(DescText)
        Call objDescCell.Content.set_DescriptionLocal(DescLocalText)
        
        ''Attach Series
        Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("SourceSeriesViewControl").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarButtonItemLinkControl", "", 1)
        If objTemp.Exists = True then
          objTemp.DblClick
          ''Entering Series      
          Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: SourceSeriesPrompt", "Attach Source Series").WPFObject("SourceSeriesPrompt", "Attach Source Series", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("SeriesIdTextEdit")
          If objTemp.Exists = True then
             objTemp.Text=intSeriesID
             Delay(10000)
             ''Clicking on OK Button
             Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: SourceSeriesPrompt", "Attach Source Series").WPFObject("SourceSeriesPrompt", "Attach Source Series", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 1).WPFObject("OkButton")
             If objTemp.Exists = True then
                objTemp.Click
    '            strTCRemarks=strTCRemarks & Chr(10) & "Attached Series- " & intSeriesID
            End If
          End If            
        End If

    
      ''Closing Source
      Call SClosesource()
      Delay 10000,"Closing Source..."  
      
    ''Save WorkSpace
    strTemp="WPFObject(""ContentControlEx"", ""Workspace"", 2)"
    Set objWrkSpace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,50,True)
    If objWrkSpace.Exists = True then
      Delay(1000)
      objWrkSpace.Click
      Delay(1000)
      Dim objEdgeFilter
      set objEdgeFilter= Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarButtonItemLinkControl", "", 1)
      strTemp="WPFObject(""ContentControlEx"", ""Save Workspace"", 2)"
      Set objTemp=objEdgeFilter.FindChild("Name",strTemp,50)
      If objTemp.Exists = TRUE then
        Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarButtonItemLinkControl", "", 1).WPFObject("ContentControlEx", "Save Workspace", 2).Click
        strTemp="WPFObject(""PART_ContainerContent"")"
        Set objConfirm=Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "Confirm save.").FindChild("Name",strTemp,50,True)

          If objConfirm.Exists = True then
            sys.Keys("Y")
            Set objConfirm = Sys.Process("EdgeClient")._
            Waitchild("WPFObject(""HwndSource: CustomMessageBoxWindow"", """")",600000)._
            Waitchild("WPFObject(""CustomMessageBoxWindow"", """", 1)",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""FloatingContainerBorder"")",60000)._
            Waitchild("WPFObject(""FloatingContainerBackground"")",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""FloatingContainerBody"")",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""PART_ContainerContent"")",60000)                     
            If objConfirm.Exists = True Then
                objConfirm.Click
                SYS.Keys "[Enter]"
            End If
          End if 
        End if 
    End if 
    End if
  End if
  End if
  Call SClosesource()
  Call SourceOpenWorkSpacevwr()
  Call SourceWorkSpacevwr()
End Sub
Sub sCloseEdge()
  Dim strTemp,strClose,objCloseButton
  strTemp="WPFObject(""PART_CloseButton"")"
  Set objCloseButton=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,true)
  Call objCloseButton.Click
  strTemp="WPFObject(""HwndSource: CustomMessageBoxWindow"", ""Edge"")"
  Set strClose=Sys.Process("EdgeClient").WaitChild(strTemp,120000)
  If strClose.Exists Then
    sys.Keys "Y"
  End If
End Sub

Sub sChkSrcCopyPaste(strParameters)
On Error Resume Next 
   Dim strSource1,StrSource2,strSource3,strTemp,GridControl,GridSourceTree,intTotNodeCnt,intI,intJ,intRow,intK,objEdge
   Dim objNewWorkspace,objWrkspace_popup,objOpenView,strTemp1,objNewWrkSpaceName,objNewWrkSpace_Txtbox,objNewWrkSpace_okbtn,objNewWrkSpace_Name
   Dim strDesc1,strDesc2,DescText,DescLocalText
   Dim objEditSource
   Dim objTemp, objStrClose
   Dim objEdgeFilter
   
    strSource1=getSplitValue(strParameters,"SOURCE")
    StrSource2=getSplitValue(strParameters,"LEVEL2SOURCE")
    StrSource3=getSplitValue(strParameters,"LEVEL3SOURCE")
    
'    strSource1="Test"
'    StrSource2="Automation_UIT2"
'    StrSource3="Test"

    Call sHome_Source
    
    strDesc1=aqDateTime.Now
    strDesc2=aqDateTime.Now
    DescText=Replace(strDesc1,"/","-")
    DescText=Replace(DescText,":","_")
    DescLocalText=DescText
    strWrkSpaceName=DescText
'    intSeriesID=getSplitValue(strParameters,"SERIESID")
'    if intSeriesID=0 then
'      Call sSourceseries
'      intSeriesID=strSourceFileText
'    End if 
    
    strTemp="WPFObject(""SourceTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""SourceTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    Delay 10000,"Pls Wait.."
    ''Selecting Country Name
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
          GridControl.Nodes_2.Item(intI).Expand(True)
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description       
          blnFlag=False  
          Exit For
        End If
    Next
    If blnFlag = True then
      strTCRemarks="Country Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
  
    Delay 10000,"Pls Wait.."
        blnFlag = True 
    ''Selecting Level2Source_Name
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
  For intJ=0 to intTotNodeCnt-1
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(StrSource2) then
        GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
        intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
'        Call GridSourceTree.ClickCell(intRow, "Edit")
        Call GridControl.ClearSelectionCore
        Call GridControl.FocusViewAndRow(GridControl,intRow)
        GridControl.SetFocusOnCurrentItem
        Call GridControl.SelectRowCore(intRow)
        log.Message "Level2 Source Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
        blnFlag = False 
        Exit For
      End If
    Next
    If blnFlag = True then
      log.Message "Level2 Source Name not found"
      strTCRemarks="Level2 Source Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
    
     Delay 10000,"Pls Wait.."
    blnFlag = True 
   
    Delay 2000,"Pls Wait.."

    strTemp="WPFObject(""ArrowControl"", """", 1)"
    Set objNewWorkspace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,20,True)
    If objNewWorkspace.Exists = True then
      objNewWorkspace.Click
       strTemp="WPFObject(""BarPopupBorderControl"", """", 1)"
      Set objWrkspace_popup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").FindChild("Name",strTemp,5,True)
      If objWrkspace_popup.Exists = True then
        strTemp="WPFObject(""ContentControlEx"", ""Open For Edit (Source)"", 2)"
        Set objopenforEdit=objWrkspace_popup.FindChild("Name",strTemp,8,True)
        If objopenforEdit.Exists then
          objopenforEdit.Click    
        End If
      End if
      
      strTemp1="WPFObject(""HwndSource: WorkspaceNamePrompt"", ""Please provide a new Workspace Name"")"
      Set objNewWrkSpaceName=Sys.Process("EdgeClient").WaitChild(strTemp1,50000)
      If objNewWrkSpaceName.Exists = True then
     
      ''Waiting for Workspace Name prompt
      strTemp="WPFObject(""FloatingContainerBorder"")"
      Set objNewWrkSpace_Name=Sys.Process("EdgeClient").WPFObject("HwndSource: WorkspaceNamePrompt", "Please provide a new Workspace Name").WPFObject("WorkspaceNamePrompt", "Please provide a new Workspace Name", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,15000000)
      If objNewWrkSpace_Name.Exists = True then
          strTemp="WPFObject(""ChangeNameTextEdit"")"
          ''Entering Workspace Name
          Set objNewWrkSpace_Txtbox=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
            If objNewWrkSpace_Txtbox.Exists = True then
              objNewWrkSpace_Txtbox.Click
              objNewWrkSpace_Txtbox.Text=strWrkSpaceName
      '        strTCRemarks=strTCRemarks & Chr(10) & "Entered Workspace Name - " & strWrkSpaceName
              ''Clicking on Ok Button 
              strTemp="WPFObject(""OkButton"")"
              Set objNewWrkSpace_okbtn=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
              If objNewWrkSpace_okbtn.Exists = True then
                objNewWrkSpace_okbtn.Click
                'Delay 5000,"Please wait..."
              End If
            End If
        End If
      End if 
     End if 
       
  
       ''Handling Validation for Source
    strTemp="WPFObject(""HwndSource: WindowContentHolder"", """")"
    Set objTemp=Sys.Process("EdgeClient").WaitChild(strTemp,10000)
    If objTemp.Exists = True then
      objTemp.Keys "[Enter]"
      strTestCaseResult = "FAIL"
      Exit Sub
    End If

    ''WorkSpace Edit Window
    strTemp="WPFObject(""LayoutPanel"", """", 2)"
    Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,13,True)
    If objTemp.Exists then
        Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WPFObject("SourceTreeListView")
        Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl")
       Delay 10000,"Pls Wait.."
        ''Expanding First Node in Tree      
        intTotNodeCnt=GridControl.Nodes_2.Count  
        For intI=0 to intTotNodeCnt-1         
          If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
            GridControl.Nodes_2.Item(intI).Expand(True)
            blnFlag=False  
            Exit For
          End If
        Next
         Delay 10000,"Pls Wait.."
        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
          For intJ=0 to intTotNodeCnt-1
            If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strSource2) then
              GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
              intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(0).get_RowHandle
              GridControl.Keys "^[Home]"
              Call GridControl.ClearSelectionCore
              Call GridControl.FocusViewAndRow(GridControl,intRow-1)
              GridControl.SetFocusOnCurrentItem
              Call GridControl.SelectRowCore(intRow-1)
        
              If objGridCell.Exists = True then
                objGridCell.Click
              End If
              blnFlag = False 
              Exit For
            End If
          Next
'           Delay 10000,"Pls Wait.."
'              intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count
'               For intK=0 to intTotNodeCnt-1
'                  If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description)=Ucase(strSource3) then
'                      intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).get_RowHandle
'                      Call GridControl.ClearSelectionCore
'                      GridControl.set_FocusedRowHandle(intRow)
'                      Call GridControl.FocusViewAndRow(GridControl,intRow)
'                      GridControl.SetFocusOnCurrentItem
'                      Call GridControl.SelectRowCore(intRow)
'                      Exit For   
'                  End If 
'               Next
    End if
            
    strTemp="WPFObject(""SourceTreeListView"")"
    objEditSource=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WaitChild(strTemp,15000000)
    if objEditSource.Exists = True then

          strTemp="WPFObject(""ContentControlEx"", ""Add Folder"", 2)"
          Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 4).WPFObject("BarButtonItemLinkControl", "", 1).FindChild("Name",strTemp,50,True)
          If objNewWrkSpace_okbtn.Exists = True then
             If objNewWrkSpace_okbtn.Enabled = True then
              objNewWrkSpace_okbtn.Click
              strTCRemarks = strTCRemarks & "<br />" & "Add Folder is found in Source"
              log.Message "Add Folder is found in Source"
             Else
              strTCRemarks = strTCRemarks & "<br />" & "Add Folder is Disabled in Source"
              log.Message "Add Folder is Disabled in Source"
             End if
          Else
            strTCRemarks = strTCRemarks & "<br />" & "Add Folder is  not found in Source"
            log.Message "Add Folder is not found in Source"
          End If   
        
          
           Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 4).WPFObject("BarButtonItemLinkControl", "", 1)      
         Delay 8000,"New Folder..."

        ''Getting no. of Rows under level 2
        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count
        intK=intTotNodeCnt-1
    
        Set objDescCell=Aliases.EdgeClient.HwndSource_RibbonWindow.RibbonWindow.ContentControl.Grid.Grid.ContentControl.Grid.ContentControl.PART_ContainerContent.BarManager.DockPanel.DockLayoutManager.LayoutGroup.LayoutPanel2.Root.BarManager.AdornerDecorator.AdornedControl.Grid.DockPanel.SourceTreeListControl.SourceTreeListView.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK)
        Call objDescCell.Content.set_Description(DescText)
        strTCRemarks = strTCRemarks & "<br />" & "Description is added in new folder"
        log.Message "Description is added in new folder"
        
        Call objDescCell.Content.set_DescriptionLocal(DescLocalText)
        strTCRemarks = strTCRemarks & "<br />" & "Description local is added in new folder"
        log.Message "Description local is added in new folder"
            
        Delay 15000,"Pls Wait.."
        Call SClosesource()
        Delay 5000,"Pls Wait.."
                   
    End if
 
    strTemp="WPFObject(""SourceTreeListView"")"
    objEditSource=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WaitChild(strTemp,15000000)
    if objEditSource.Exists = True then
          sys.Keys("[Up]")
           Call sEdgeProcessor
          strTemp="WPFObject(""ContentControlEx"", ""Copy Folder"", 2)"
          Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 8).WPFObject("BarSubItemLinkControl", "", 1).FindChild("Name",strTemp,50,True)
          If objNewWrkSpace_okbtn.Exists = True then
            objNewWrkSpace_okbtn.click
            'Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").Keys("[Down]")
            delay(10000)
            strTemp="WPFObject(""PopupMenuBarControl"", """", 1)"
            Set objwrkspacepop=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).Findchild("Name",strTemp,50,True)
          
            If objwrkspacepop.Exists = True then
            objwrkspacepop.Click
            sys.Keys("[Down]")
           ' Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").Keys("[Down]")
            delay(10000)
            set objEdgeFilter=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarButtonItemLinkControl", "", 1)
            strTemp="WPFObject(""ContentControlEx"", ""Copy Folder Only"", 2)"
            Set objTemp=objEdgeFilter.FindChild("Name",strTemp,50)
            If objTemp.Exists = TRUE then
               If objTemp.Enabled = False then
                strTCRemarks = strTCRemarks & "<br />" & "Copy Folder Only is disabled"
                log.Message "Copy Folder Only is disabled"
               Else
                strTCRemarks = strTCRemarks & "<br />" & "Copy Folder Only is Enabled"
                log.Message "Copy Folder Only is Enabled"
                objTemp.Click
                sys.Keys("[Down]")
                Call sEdgeProcessor
                
                set objEdgeFilter= Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 10).WPFObject("BarSubItemLinkControl", "", 1)
                strTemp="WPFObject(""ContentControlEx"", ""Paste Folder"", 2)"
                Set objTemp=objEdgeFilter.FindChild("Name",strTemp,50)
                If objTemp.Exists = TRUE then
                   If objTemp.Enabled = False then
                    strTCRemarks = strTCRemarks & "<br />" & "Paste Folder is disabled"
                    log.Message "Paste Folder is disabled"
                   Else
                    strTCRemarks = strTCRemarks & "<br />" & "Paste Folder is Enabled"
                    log.Message "Paste Folder is Enabled"
                    objTemp.Click
                    set objEdgeFilter= Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 2).WPFObject("BarButtonItemLinkControl", "", 1)
                    strTemp="WPFObject(""ContentControlEx"", ""Paste Inside"", 2)"
                    Set objTemp=objEdgeFilter.FindChild("Name",strTemp,50)
                    If objTemp.Exists = TRUE then
                       If objTemp.Enabled = False then
                        strTCRemarks = strTCRemarks & "<br />" & "Paste Inside is disabled"
                        log.Message "Paste Inside is disabled"
                       Else
                        strTCRemarks = strTCRemarks & "<br />" & "Paste Insideis Enabled"
                        log.Message "Paste Inside is Enabled"
                        objTemp.Click
                       End if 
                    End If
                   End if 
                End If
               End if 
            End If 
        End if                
    End if 
    End if
    
    Dim objSaveWrk,objWait  
     set objSaveWrk=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 12).WPFObject("BarSubItemLinkControl", "", 1)
    strTemp="WPFObject(""ContentControlEx"", ""Workspace"", 2)"
    Set objTemp=objSaveWrk.FindChild("Name",strTemp,50)
    objWait=1
    Do until objTemp.Enabled = true 
        If objWait < 20 Then
          Delay 1000,"Pls Wait... Form is loading..."
          objWait=objWait+1
        else
          Call SClosesource()
          Call SourceWorkSpacevwr()
          Exit Sub
        end if 
    Loop 
    
    strTemp="WPFObject(""ContentControlEx"", ""Workspace"", 2)"
    Set objWrkSpace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,50,True)
    If objWrkSpace.Exists = True then
      Delay(1000)
      objWrkSpace.Click
      Delay(1000)
      strTemp="WPFObject(""PopupMenuBarControl"", """", 1)"
      Set objwrkspacepop=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").Findchild("Name",strTemp,50,True)
      'Set objwrkspacepop=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 2).WPFObject("BarButtonItemLinkControl", "", 1).WPFObject("ContentControlEx", "Upload Workspace", 2)
      If objwrkspacepop.Exists = True then
        strTemp="WPFObject(""ContentControlEx"", ""Upload Workspace"", 2)"
        set objwrkspcUpload=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).FindChild("Name",strTemp,50,True)
        If objwrkspcUpload.Exists = True then
          objwrkspcUpload.Click
          'Delay 1000,"Pls Wait.."
          strTemp="WPFObject(""PART_ContainerContent"")"
        Set objConfirm=Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "Confirm save.").FindChild("Name",strTemp,50,True)

          If objConfirm.Exists = True then
            Sys.Keys "[Enter]"
            'Delay 8000,"Uploading..."
            Set objConfirm = Sys.Process("EdgeClient")._
            Waitchild("WPFObject(""HwndSource: CustomMessageBoxWindow"", ""Upload Workspace"")",600000)._
            Waitchild("WPFObject(""CustomMessageBoxWindow"", ""Upload Workspace"", 1)",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""FloatingContainerBorder"")",60000)._
            Waitchild("WPFObject(""FloatingContainerBackground"")",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""FloatingContainerBody"")",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""PART_ContainerContent"")",60000)
            
            If objConfirm.Exists = True then
              Sys.Keys("O")
              'Delay 30000,"Pls Wait.."
              Call sEdgeProcessor
            End if
          End if
        End if
      End if
    End if
'  Call SClosesource()
  'Call SourceWorkSpacevwr()
End Sub
Sub sChkSrcCopyPasteSeries(strParameters)
On Error Resume Next 
   Dim strSource1,StrSource2,strSource3,strTemp,GridControl,GridSourceTree,intTotNodeCnt,intI,intJ,intRow,intK,objEdge
   Dim objNewWorkspace,objWrkspace_popup,objOpenView,strTemp1,objNewWrkSpaceName,objNewWrkSpace_Txtbox,objNewWrkSpace_okbtn,objNewWrkSpace_Name
   Dim strDesc1,strDesc2,DescText,DescLocalText
   Dim objEditSource
   Dim objTemp, objStrClose
   Dim objEdgeFilter
   
    strSource1=getSplitValue(strParameters,"SOURCE")
    StrSource2=getSplitValue(strParameters,"LEVEL2SOURCE")
    StrSource3=getSplitValue(strParameters,"LEVEL3SOURCE")
    
'    strSource1="Test"
'    StrSource2="Automation_UIT2"
'    StrSource3="Test"

    Call sHome_Source
    
    strDesc1=aqDateTime.Now
    strDesc2=aqDateTime.Now
    DescText=Replace(strDesc1,"/","-")
    DescText=Replace(DescText,":","_")
    DescLocalText=DescText
    strWrkSpaceName=DescText
'    intSeriesID=getSplitValue(strParameters,"SERIESID")
'    if intSeriesID=0 then
'      Call sSourceseries
'      intSeriesID=strSourceFileText
'    End if 
    
    strTemp="WPFObject(""SourceTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""SourceTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    Delay 10000,"Pls Wait.."
    ''Selecting Country Name
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
          GridControl.Nodes_2.Item(intI).Expand(True)
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description       
          blnFlag=False  
          Exit For
        End If
    Next
    If blnFlag = True then
      strTCRemarks="Country Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
  
    Delay 10000,"Pls Wait.."
        blnFlag = True 
    ''Selecting Level2Source_Name
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
  For intJ=0 to intTotNodeCnt-1
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(StrSource2) then
        GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
        intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
'        Call GridSourceTree.ClickCell(intRow, "Edit")
        Call GridControl.ClearSelectionCore
        Call GridControl.FocusViewAndRow(GridControl,intRow)
        GridControl.SetFocusOnCurrentItem
        Call GridControl.SelectRowCore(intRow)
        log.Message "Level2 Source Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
        blnFlag = False 
        Exit For
      End If
    Next
    If blnFlag = True then
      log.Message "Level2 Source Name not found"
      strTCRemarks="Level2 Source Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
    
     Delay 10000,"Pls Wait.."
    blnFlag = True 
   
    Delay 2000,"Pls Wait.."

    strTemp="WPFObject(""ArrowControl"", """", 1)"
    Set objNewWorkspace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,20,True)
    If objNewWorkspace.Exists = True then
      objNewWorkspace.Click
       strTemp="WPFObject(""BarPopupBorderControl"", """", 1)"
      Set objWrkspace_popup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").FindChild("Name",strTemp,5,True)
      If objWrkspace_popup.Exists = True then
        strTemp="WPFObject(""ContentControlEx"", ""Open For Edit (Source)"", 2)"
        Set objopenforEdit=objWrkspace_popup.FindChild("Name",strTemp,8,True)
        If objopenforEdit.Exists then
          objopenforEdit.Click    
        End If
      End if
      
      strTemp1="WPFObject(""HwndSource: WorkspaceNamePrompt"", ""Please provide a new Workspace Name"")"
      Set objNewWrkSpaceName=Sys.Process("EdgeClient").WaitChild(strTemp1,50000)
      If objNewWrkSpaceName.Exists = True then
     
      ''Waiting for Workspace Name prompt
      strTemp="WPFObject(""FloatingContainerBorder"")"
      Set objNewWrkSpace_Name=Sys.Process("EdgeClient").WPFObject("HwndSource: WorkspaceNamePrompt", "Please provide a new Workspace Name").WPFObject("WorkspaceNamePrompt", "Please provide a new Workspace Name", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,15000000)
      If objNewWrkSpace_Name.Exists = True then
          strTemp="WPFObject(""ChangeNameTextEdit"")"
          ''Entering Workspace Name
          Set objNewWrkSpace_Txtbox=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
            If objNewWrkSpace_Txtbox.Exists = True then
              objNewWrkSpace_Txtbox.Click
              objNewWrkSpace_Txtbox.Text=strWrkSpaceName
      '        strTCRemarks=strTCRemarks & Chr(10) & "Entered Workspace Name - " & strWrkSpaceName
              ''Clicking on Ok Button 
              strTemp="WPFObject(""OkButton"")"
              Set objNewWrkSpace_okbtn=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
              If objNewWrkSpace_okbtn.Exists = True then
                objNewWrkSpace_okbtn.Click
                'Delay 5000,"Please wait..."
              End If
            End If
        End If
      End if 
     End if 
       
  
       ''Handling Validation for Source
    strTemp="WPFObject(""HwndSource: WindowContentHolder"", """")"
    Set objTemp=Sys.Process("EdgeClient").WaitChild(strTemp,10000)
    If objTemp.Exists = True then
      objTemp.Keys "[Enter]"
      strTestCaseResult = "FAIL"
      Exit Sub
    End If

    ''WorkSpace Edit Window
    strTemp="WPFObject(""LayoutPanel"", """", 2)"
    Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,13,True)
    If objTemp.Exists then
        Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WPFObject("SourceTreeListView")
        Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl")
       Delay 10000,"Pls Wait.."
        ''Expanding First Node in Tree      
        intTotNodeCnt=GridControl.Nodes_2.Count  
        For intI=0 to intTotNodeCnt-1         
          If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
           GridControl.Nodes_2.Item(intI).Expand(True)
           blnFlag=False  
           Exit For
          End If
        Next
         Delay 10000,"Pls Wait.."
        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
          For intJ=0 to intTotNodeCnt-1
            If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strSource2) then
              GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
              intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(0).get_RowHandle
              GridControl.Keys "^[Home]"
              Call GridControl.ClearSelectionCore
              Call GridControl.FocusViewAndRow(GridControl,intRow-1)
              GridControl.SetFocusOnCurrentItem
              Call GridControl.SelectRowCore(intRow-1)
        
              If objGridCell.Exists = True then
                objGridCell.Click
              End If
              blnFlag = False 
              Exit For
            End If
          Next
'           Delay 10000,"Pls Wait.."
'              intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count
'               For intK=0 to intTotNodeCnt-1
'                  If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description)=Ucase(strSource3) then
'                      intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).get_RowHandle
'                      Call GridControl.ClearSelectionCore
'                      GridControl.set_FocusedRowHandle(intRow)
'                      Call GridControl.FocusViewAndRow(GridControl,intRow)
'                      GridControl.SetFocusOnCurrentItem
'                      Call GridControl.SelectRowCore(intRow)
'                      Exit For   
'                  End If 
'               Next
    End if
            
    strTemp="WPFObject(""SourceTreeListView"")"
    objEditSource=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WaitChild(strTemp,15000000)
    if objEditSource.Exists = True then

          strTemp="WPFObject(""ContentControlEx"", ""Add Folder"", 2)"
          Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 4).WPFObject("BarButtonItemLinkControl", "", 1).FindChild("Name",strTemp,50,True)
          If objNewWrkSpace_okbtn.Exists = True then
             If objNewWrkSpace_okbtn.Enabled = True then
              objNewWrkSpace_okbtn.Click
              strTCRemarks = strTCRemarks & "<br />" & "Add Folder is found in Source"
              log.Message "Add Folder is found in Source"
             Else
              strTCRemarks = strTCRemarks & "<br />" & "Add Folder is Disabled in Source"
              log.Message "Add Folder is Disabled in Source"
             End if
          Else
            strTCRemarks = strTCRemarks & "<br />" & "Add Folder is  not found in Source"
            log.Message "Add Folder is not found in Source"
          End If   
        
          
           Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 4).WPFObject("BarButtonItemLinkControl", "", 1)      
         Delay 8000,"New Folder..."

        ''Getting no. of Rows under level 2
        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count
        intK=intTotNodeCnt-1
    
        Set objDescCell=Aliases.EdgeClient.HwndSource_RibbonWindow.RibbonWindow.ContentControl.Grid.Grid.ContentControl.Grid.ContentControl.PART_ContainerContent.BarManager.DockPanel.DockLayoutManager.LayoutGroup.LayoutPanel2.Root.BarManager.AdornerDecorator.AdornedControl.Grid.DockPanel.SourceTreeListControl.SourceTreeListView.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK)
        Call objDescCell.Content.set_Description(DescText)
        strTCRemarks = strTCRemarks & "<br />" & "Description is added in new folder"
        log.Message "Description is added in new folder"
        
        Call objDescCell.Content.set_DescriptionLocal(DescLocalText)
        strTCRemarks = strTCRemarks & "<br />" & "Description local is added in new folder"
        log.Message "Description local is added in new folder"
            
        Delay 15000,"Pls Wait.."
        Call SClosesource()
        Delay 5000,"Pls Wait.."
        
        
                   
    End if
 
    strTemp="WPFObject(""SourceTreeListView"")"
    objEditSource=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WaitChild(strTemp,15000000)
    if objEditSource.Exists = True then
          sys.Keys("[Up]")
           Call sEdgeProcessor
          strTemp="WPFObject(""ContentControlEx"", ""Copy Folder"", 2)"
          Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 8).WPFObject("BarSubItemLinkControl", "", 1).FindChild("Name",strTemp,50,True)
          If objNewWrkSpace_okbtn.Exists = True then
            objNewWrkSpace_okbtn.click
            'Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").Keys("[Down]")
            delay(10000)
            strTemp="WPFObject(""PopupMenuBarControl"", """", 1)"
            Set objwrkspacepop=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).Findchild("Name",strTemp,50,True)
          
            If objwrkspacepop.Exists = True then
            objwrkspacepop.Click
            sys.Keys("[Down][Down]")
            delay(10000)
            
            set objEdgeFilter=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 2).WPFObject("BarButtonItemLinkControl", "", 1)
            strTemp="WPFObject(""ContentControlEx"", ""Copy Folder with Series"", 2)"
            Set objTemp=objEdgeFilter.FindChild("Name",strTemp,50)
            If objTemp.Exists = TRUE then
               If objTemp.Enabled = False then
                strTCRemarks = strTCRemarks & "<br />" & "Copy Folder with Series is disabled"
                log.Message "Copy Folder with Series is disabled"
               Else
                strTCRemarks = strTCRemarks & "<br />" & "Copy Folder with Series is Enabled"
                log.Message "Copy Folder with Series is Enabled"
                objTemp.Click
                
                sys.Keys("[Down]")
                Call sEdgeProcessor
                set objEdgeFilter= Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 10).WPFObject("BarSubItemLinkControl", "", 1)
                strTemp="WPFObject(""ContentControlEx"", ""Paste Folder"", 2)"
                Set objTemp=objEdgeFilter.FindChild("Name",strTemp,50)
                If objTemp.Exists = TRUE then
                   If objTemp.Enabled = False then
                    strTCRemarks = strTCRemarks & "<br />" & "Paste Folder is disabled"
                    log.Message "Paste Folder is disabled"
                   Else
                    strTCRemarks = strTCRemarks & "<br />" & "Paste Folder is Enabled"
                    log.Message "Paste Folder is Enabled"
                    objTemp.Click
                    set objEdgeFilter= Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 2).WPFObject("BarButtonItemLinkControl", "", 1)
                    strTemp="WPFObject(""ContentControlEx"", ""Paste Inside"", 2)"
                    Set objTemp=objEdgeFilter.FindChild("Name",strTemp,50)
                    If objTemp.Exists = TRUE then
                       If objTemp.Enabled = False then
                        strTCRemarks = strTCRemarks & "<br />" & "Paste Inside is disabled"
                        log.Message "Paste Inside is disabled"
                       Else
                        strTCRemarks = strTCRemarks & "<br />" & "Paste Inside is Enabled"
                        log.Message "Paste Inside is Enabled"
                        objTemp.Click
                        
                        strTemp="WPFObject(""PART_ContainerContent"")"
                        Set objConfirm=Sys.Process("EdgeClient").WPFObject("HwndSource: WindowContentHolder", "Copy and paste source folder with series").WPFObject("WindowContentHolder", "Copy and paste source folder with series", 1).FindChild("Name",strTemp,50,True)
                        strTemp="WPFObject(""DXMessageBox"", """", 1)"
                        Set objConfirm=objConfirm.WaitChild(strTemp,180000)
                        If objConfirm.Exists = True then
                          objConfirm.Keys "[Enter]"
                          'Delay 30000,"Pls Wait.."
                          Call sEdgeProcessor
                        End if
                       End if 
                    End If
                   End if 
                End If
               End if 
            End If 
        End if        
    End if 
    End if
    
    Dim objSaveWrk,objWait  
     set objSaveWrk=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 12).WPFObject("BarSubItemLinkControl", "", 1)
    strTemp="WPFObject(""ContentControlEx"", ""Workspace"", 2)"
    Set objTemp=objSaveWrk.FindChild("Name",strTemp,50)
    objWait=1
    Do until objTemp.Enabled = true 
        If objWait < 20 Then
          Delay 1000,"Pls Wait... Form is loading..."
          objWait=objWait+1
        else
          Call SClosesource()
          Call SourceWorkSpacevwr()
          Exit Sub
        end if 
    Loop  
    
    strTemp="WPFObject(""ContentControlEx"", ""Workspace"", 2)"
    Set objWrkSpace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,50,True)
    If objWrkSpace.Exists = True then
      Delay(1000)
      objWrkSpace.Click
      Delay(1000)
      strTemp="WPFObject(""PopupMenuBarControl"", """", 1)"
      Set objwrkspacepop=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").Findchild("Name",strTemp,50,True)
      'Set objwrkspacepop=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 2).WPFObject("BarButtonItemLinkControl", "", 1).WPFObject("ContentControlEx", "Upload Workspace", 2)
      If objwrkspacepop.Exists = True then
        strTemp="WPFObject(""ContentControlEx"", ""Upload Workspace"", 2)"
        set objwrkspcUpload=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).FindChild("Name",strTemp,50,True)
        If objwrkspcUpload.Exists = True then
          objwrkspcUpload.Click
          'Delay 1000,"Pls Wait.."
          strTemp="WPFObject(""PART_ContainerContent"")"
        Set objConfirm=Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "Confirm save.").FindChild("Name",strTemp,50,True)

          If objConfirm.Exists = True then
            Sys.Keys "[Enter]"
            'Delay 8000,"Uploading..."
            Set objConfirm = Sys.Process("EdgeClient")._
            Waitchild("WPFObject(""HwndSource: CustomMessageBoxWindow"", ""Upload Workspace"")",600000)._
            Waitchild("WPFObject(""CustomMessageBoxWindow"", ""Upload Workspace"", 1)",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""FloatingContainerBorder"")",60000)._
            Waitchild("WPFObject(""FloatingContainerBackground"")",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""FloatingContainerBody"")",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""PART_ContainerContent"")",60000)
            
            If objConfirm.Exists = True then
              Sys.Keys("O")
  
              'Delay 30000,"Pls Wait.."
              Call sEdgeProcessor
            End if
          End if
        End if
      End if
    End if
'  Call SClosesource()
  'Call SourceWorkSpacevwr()
End Sub
Sub sChkSrcCopyPasteAbove(strParameters)
On Error Resume Next 
   Dim strSource1,StrSource2,strSource3,strTemp,GridControl,GridSourceTree,intTotNodeCnt,intI,intJ,intRow,intK,objEdge
   Dim objNewWorkspace,objWrkspace_popup,objOpenView,strTemp1,objNewWrkSpaceName,objNewWrkSpace_Txtbox,objNewWrkSpace_okbtn,objNewWrkSpace_Name
   Dim strDesc1,strDesc2,DescText,DescLocalText
   Dim objEditSource
   Dim objTemp, objStrClose
   Dim objEdgeFilter
   
    strSource1=getSplitValue(strParameters,"SOURCE")
    StrSource2=getSplitValue(strParameters,"LEVEL2SOURCE")
    StrSource3=getSplitValue(strParameters,"LEVEL3SOURCE")
    
'    strSource1="Test"
'    StrSource2="Automation_UIT2"
'    StrSource3="Test"

    Call sHome_Source
    
    strDesc1=aqDateTime.Now
    strDesc2=aqDateTime.Now
    DescText=Replace(strDesc1,"/","-")
    DescText=Replace(DescText,":","_")
    DescLocalText=DescText
    strWrkSpaceName=DescText
'    intSeriesID=getSplitValue(strParameters,"SERIESID")
'    if intSeriesID=0 then
'      Call sSourceseries
'      intSeriesID=strSourceFileText
'    End if 
    
    strTemp="WPFObject(""SourceTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""SourceTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    Delay 10000,"Pls Wait.."
    ''Selecting Country Name
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
          GridControl.Nodes_2.Item(intI).Expand(True)
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description       
          blnFlag=False  
          Exit For
        End If
    Next
    If blnFlag = True then
      strTCRemarks="Country Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
  
    Delay 10000,"Pls Wait.."
        blnFlag = True 
    ''Selecting Level2Source_Name
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
  For intJ=0 to intTotNodeCnt-1
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(StrSource2) then
        GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
        intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
'        Call GridSourceTree.ClickCell(intRow, "Edit")
        Call GridControl.ClearSelectionCore
        Call GridControl.FocusViewAndRow(GridControl,intRow)
        GridControl.SetFocusOnCurrentItem
        Call GridControl.SelectRowCore(intRow)
        log.Message "Level2 Source Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
        blnFlag = False 
        Exit For
      End If
    Next
    If blnFlag = True then
      log.Message "Level2 Source Name not found"
      strTCRemarks="Level2 Source Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
    
     Delay 10000,"Pls Wait.."
    blnFlag = True 
   
    Delay 2000,"Pls Wait.."

    strTemp="WPFObject(""ArrowControl"", """", 1)"
    Set objNewWorkspace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,20,True)
    If objNewWorkspace.Exists = True then
      objNewWorkspace.Click
       strTemp="WPFObject(""BarPopupBorderControl"", """", 1)"
      Set objWrkspace_popup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").FindChild("Name",strTemp,5,True)
      If objWrkspace_popup.Exists = True then
        strTemp="WPFObject(""ContentControlEx"", ""Open For Edit (Source)"", 2)"
        Set objopenforEdit=objWrkspace_popup.FindChild("Name",strTemp,8,True)
        If objopenforEdit.Exists then
          objopenforEdit.Click    
        End If
      End if
      
      strTemp1="WPFObject(""HwndSource: WorkspaceNamePrompt"", ""Please provide a new Workspace Name"")"
      Set objNewWrkSpaceName=Sys.Process("EdgeClient").WaitChild(strTemp1,50000)
      If objNewWrkSpaceName.Exists = True then
     
      ''Waiting for Workspace Name prompt
      strTemp="WPFObject(""FloatingContainerBorder"")"
      Set objNewWrkSpace_Name=Sys.Process("EdgeClient").WPFObject("HwndSource: WorkspaceNamePrompt", "Please provide a new Workspace Name").WPFObject("WorkspaceNamePrompt", "Please provide a new Workspace Name", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,15000000)
      If objNewWrkSpace_Name.Exists = True then
          strTemp="WPFObject(""ChangeNameTextEdit"")"
          ''Entering Workspace Name
          Set objNewWrkSpace_Txtbox=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
            If objNewWrkSpace_Txtbox.Exists = True then
              objNewWrkSpace_Txtbox.Click
              objNewWrkSpace_Txtbox.Text=strWrkSpaceName
      '        strTCRemarks=strTCRemarks & Chr(10) & "Entered Workspace Name - " & strWrkSpaceName
              ''Clicking on Ok Button 
              strTemp="WPFObject(""OkButton"")"
              Set objNewWrkSpace_okbtn=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
              If objNewWrkSpace_okbtn.Exists = True then
                objNewWrkSpace_okbtn.Click
                'Delay 5000,"Please wait..."
              End If
            End If
        End If
      End if 
     End if 
       
  
       ''Handling Validation for Source
    strTemp="WPFObject(""HwndSource: WindowContentHolder"", """")"
    Set objTemp=Sys.Process("EdgeClient").WaitChild(strTemp,10000)
    If objTemp.Exists = True then
      objTemp.Keys "[Enter]"
      strTestCaseResult = "FAIL"
      Exit Sub
    End If

    ''WorkSpace Edit Window
    strTemp="WPFObject(""LayoutPanel"", """", 2)"
    Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,13,True)
    If objTemp.Exists then
        Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WPFObject("SourceTreeListView")
        Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl")
       Delay 10000,"Pls Wait.."
        ''Expanding First Node in Tree      
        intTotNodeCnt=GridControl.Nodes_2.Count  
        For intI=0 to intTotNodeCnt-1         
          If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
           GridControl.Nodes_2.Item(intI).Expand(True)
           blnFlag=False  
           Exit For
          End If
        Next
         Delay 10000,"Pls Wait.."
        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
          For intJ=0 to intTotNodeCnt-1
            If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strSource2) then
              GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
              intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(0).get_RowHandle
              GridControl.Keys "^[Home]"
              Call GridControl.ClearSelectionCore
              Call GridControl.FocusViewAndRow(GridControl,intRow-1)
              GridControl.SetFocusOnCurrentItem
              Call GridControl.SelectRowCore(intRow-1)
        
              If objGridCell.Exists = True then
                objGridCell.Click
              End If
              blnFlag = False 
              Exit For
            End If
          Next
    End if
            
    strTemp="WPFObject(""SourceTreeListView"")"
    objEditSource=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WaitChild(strTemp,15000000)
    if objEditSource.Exists = True then

          strTemp="WPFObject(""ContentControlEx"", ""Add Folder"", 2)"
          Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 4).WPFObject("BarButtonItemLinkControl", "", 1).FindChild("Name",strTemp,50,True)
          If objNewWrkSpace_okbtn.Exists = True then
             If objNewWrkSpace_okbtn.Enabled = True then
              objNewWrkSpace_okbtn.Click
              strTCRemarks = strTCRemarks & "<br />" & "Add Folder is found in Source"
              log.Message "Add Folder is found in Source"
             Else
              strTCRemarks = strTCRemarks & "<br />" & "Add Folder is Disabled in Source"
              log.Message "Add Folder is Disabled in Source"
             End if
          Else
            strTCRemarks = strTCRemarks & "<br />" & "Add Folder is  not found in Source"
            log.Message "Add Folder is not found in Source"
          End If   
        
          
           Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 4).WPFObject("BarButtonItemLinkControl", "", 1)      
         Delay 8000,"New Folder..."

        ''Getting no. of Rows under level 2
        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count
        intK=intTotNodeCnt-1
    
        Set objDescCell=Aliases.EdgeClient.HwndSource_RibbonWindow.RibbonWindow.ContentControl.Grid.Grid.ContentControl.Grid.ContentControl.PART_ContainerContent.BarManager.DockPanel.DockLayoutManager.LayoutGroup.LayoutPanel2.Root.BarManager.AdornerDecorator.AdornedControl.Grid.DockPanel.SourceTreeListControl.SourceTreeListView.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK)
        Call objDescCell.Content.set_Description(DescText)
        strTCRemarks = strTCRemarks & "<br />" & "Description is added in new folder"
        log.Message "Description is added in new folder"
        
        Call objDescCell.Content.set_DescriptionLocal(DescLocalText)
        strTCRemarks = strTCRemarks & "<br />" & "Description local is added in new folder"
        log.Message "Description local is added in new folder"
            
        Delay 15000,"Pls Wait.."
        Call SClosesource()
        Delay 5000,"Pls Wait.."
        
        
                   
    End if
 
    strTemp="WPFObject(""SourceTreeListView"")"
    objEditSource=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WaitChild(strTemp,15000000)
    if objEditSource.Exists = True then
          sys.Keys("[Up]")
           Call sEdgeProcessor
          strTemp="WPFObject(""ContentControlEx"", ""Copy Folder"", 2)"
          Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 8).WPFObject("BarSubItemLinkControl", "", 1).FindChild("Name",strTemp,50,True)
          If objNewWrkSpace_okbtn.Exists = True then
            objNewWrkSpace_okbtn.click
            'Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").Keys("[Down]")
            delay(10000)
            strTemp="WPFObject(""PopupMenuBarControl"", """", 1)"
            Set objwrkspacepop=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).Findchild("Name",strTemp,50,True)
          
            If objwrkspacepop.Exists = True then
            objwrkspacepop.Click
            sys.Keys("[Down]")
            delay(10000)
            
            set objEdgeFilter=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarButtonItemLinkControl", "", 1)
            strTemp="WPFObject(""ContentControlEx"", ""Copy Folder Only"", 2)"
            Set objTemp=objEdgeFilter.FindChild("Name",strTemp,50)
            If objTemp.Exists = TRUE then
               If objTemp.Enabled = False then
                strTCRemarks = strTCRemarks & "<br />" & "Copy Folder Only is disabled"
                log.Message "Copy Folder Only is disabled"
               Else
                strTCRemarks = strTCRemarks & "<br />" & "Copy Folder Only is Enabled"
                log.Message "Copy Folder Only is Enabled"
                objTemp.Click
                sys.Keys("[Down]")
                Call sEdgeProcessor
                
                set objEdgeFilter= Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 10).WPFObject("BarSubItemLinkControl", "", 1)
                strTemp="WPFObject(""ContentControlEx"", ""Paste Folder"", 2)"
                Set objTemp=objEdgeFilter.FindChild("Name",strTemp,50)
                If objTemp.Exists = TRUE then
                   If objTemp.Enabled = False then
                    strTCRemarks = strTCRemarks & "<br />" & "Paste Folder is disabled"
                    log.Message "Paste Folder is disabled"
                   Else
                    strTCRemarks = strTCRemarks & "<br />" & "Paste Folder is Enabled"
                    log.Message "Paste Folder is Enabled"
                    objTemp.Click
                    set objEdgeFilter=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarButtonItemLinkControl", "", 1)
                    strTemp="WPFObject(""ContentControlEx"", ""Paste Above"", 2)"
                    Set objTemp=objEdgeFilter.FindChild("Name",strTemp,50)
                    If objTemp.Exists = TRUE then
                       If objTemp.Enabled = False then
                        strTCRemarks = strTCRemarks & "<br />" & "Paste Above is disabled"
                        log.Message "Paste Above is disabled"
                       Else
                        strTCRemarks = strTCRemarks & "<br />" & "Paste Above is Enabled"
                        log.Message "Paste Above is Enabled"
                        objTemp.Click
                        Call sEdgeProcessor
                        sys.Keys("[Down]")
                        
                        strDesc1=aqDateTime.Now
                        strDesc2=aqDateTime.Now
                        DescText=Replace(strDesc1,"/","-")
                        DescText=Replace(DescText,":","_")
                        
                        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count
                        intK=intTotNodeCnt-2
    
                        Set objDescCell=Aliases.EdgeClient.HwndSource_RibbonWindow.RibbonWindow.ContentControl.Grid.Grid.ContentControl.Grid.ContentControl.PART_ContainerContent.BarManager.DockPanel.DockLayoutManager.LayoutGroup.LayoutPanel2.Root.BarManager.AdornerDecorator.AdornedControl.Grid.DockPanel.SourceTreeListControl.SourceTreeListView.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK)
                        Call objDescCell.Content.set_Description(DescText)
                        strTCRemarks = strTCRemarks & "<br />" & "Description is Updated in Pasted folder"
                        log.Message "Description is updated in Pasted folder"
        
                        Call objDescCell.Content.set_DescriptionLocal(DescText)
                        strTCRemarks = strTCRemarks & "<br />" & "Description local is Updated in Pasted folder"
                        log.Message "Description local is Updated in Pasted folder"
                        
                       End if 
                    End If
                   End if 
                End If
               End if 
            End If 
        End if    
          end if 
    End if
    
    Dim objSaveWrk,objWait  
     set objSaveWrk=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 12).WPFObject("BarSubItemLinkControl", "", 1)
    strTemp="WPFObject(""ContentControlEx"", ""Workspace"", 2)"
    Set objTemp=objSaveWrk.FindChild("Name",strTemp,50)
    objWait=1
    Do until objTemp.Enabled = true 
        If objWait < 20 Then
          Delay 1000,"Pls Wait... Form is loading..."
          objWait=objWait+1
        else
          Call SClosesource()
          Call SourceWorkSpacevwr()
          Exit Sub
        end if 
    Loop 
    
    strTemp="WPFObject(""ContentControlEx"", ""Workspace"", 2)"
    Set objWrkSpace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,50,True)
    If objWrkSpace.Exists = True then
      Delay(1000)
      objWrkSpace.Click
      Delay(1000)
      strTemp="WPFObject(""PopupMenuBarControl"", """", 1)"
      Set objwrkspacepop=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").Findchild("Name",strTemp,50,True)
      'Set objwrkspacepop=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 2).WPFObject("BarButtonItemLinkControl", "", 1).WPFObject("ContentControlEx", "Upload Workspace", 2)
      If objwrkspacepop.Exists = True then
        strTemp="WPFObject(""ContentControlEx"", ""Upload Workspace"", 2)"
        set objwrkspcUpload=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).FindChild("Name",strTemp,50,True)
        If objwrkspcUpload.Exists = True then
          objwrkspcUpload.Click
          'Delay 1000,"Pls Wait.."
          strTemp="WPFObject(""PART_ContainerContent"")"
        Set objConfirm=Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "Confirm save.").FindChild("Name",strTemp,50,True)

          If objConfirm.Exists = True then
            Sys.Keys "[Enter]"
            'Delay 8000,"Uploading..."
            Set objConfirm = Sys.Process("EdgeClient")._
            Waitchild("WPFObject(""HwndSource: CustomMessageBoxWindow"", ""Upload Workspace"")",600000)._
            Waitchild("WPFObject(""CustomMessageBoxWindow"", ""Upload Workspace"", 1)",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""FloatingContainerBorder"")",60000)._
            Waitchild("WPFObject(""FloatingContainerBackground"")",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""FloatingContainerBody"")",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""PART_ContainerContent"")",60000)
            
            If objConfirm.Exists = True then
              Sys.Keys("O")
    'Delay 30000,"Pls Wait.."
              Call sEdgeProcessor
            End if
          End if
        End if
      End if
    End if
'  Call SClosesource()
  'Call SourceWorkSpacevwr()
End Sub

Sub sChkSrcCopyPasteBelow(strParameters)
On Error Resume Next 
   Dim strSource1,StrSource2,strSource3,strTemp,GridControl,GridSourceTree,intTotNodeCnt,intI,intJ,intRow,intK,objEdge
   Dim objNewWorkspace,objWrkspace_popup,objOpenView,strTemp1,objNewWrkSpaceName,objNewWrkSpace_Txtbox,objNewWrkSpace_okbtn,objNewWrkSpace_Name
   Dim strDesc1,strDesc2,DescText,DescLocalText
   Dim objEditSource
   Dim objTemp, objStrClose
   Dim objEdgeFilter
   
    strSource1=getSplitValue(strParameters,"SOURCE")
    StrSource2=getSplitValue(strParameters,"LEVEL2SOURCE")
    StrSource3=getSplitValue(strParameters,"LEVEL3SOURCE")
    
'    strSource1="Test"
'    StrSource2="Automation_UIT2"
'    StrSource3="Test"

    Call sHome_Source
    
    strDesc1=aqDateTime.Now
    strDesc2=aqDateTime.Now
    DescText=Replace(strDesc1,"/","-")
    DescText=Replace(DescText,":","_")
    DescLocalText=DescText
    strWrkSpaceName=DescText
'    intSeriesID=getSplitValue(strParameters,"SERIESID")
'    if intSeriesID=0 then
'      Call sSourceseries
'      intSeriesID=strSourceFileText
'    End if 
    
    strTemp="WPFObject(""SourceTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""SourceTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    Delay 10000,"Pls Wait.."
    ''Selecting Country Name
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
          GridControl.Nodes_2.Item(intI).Expand(True)
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description       
          blnFlag=False  
          Exit For
        End If
    Next
    If blnFlag = True then
      strTCRemarks="Country Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
  
    Delay 10000,"Pls Wait.."
        blnFlag = True 
    ''Selecting Level2Source_Name
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
  For intJ=0 to intTotNodeCnt-1
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(StrSource2) then
        GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
        intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
'        Call GridSourceTree.ClickCell(intRow, "Edit")
        Call GridControl.ClearSelectionCore
        Call GridControl.FocusViewAndRow(GridControl,intRow)
        GridControl.SetFocusOnCurrentItem
        Call GridControl.SelectRowCore(intRow)
        log.Message "Level2 Source Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
        blnFlag = False 
        Exit For
      End If
    Next
    If blnFlag = True then
      log.Message "Level2 Source Name not found"
      strTCRemarks="Level2 Source Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
    
     Delay 10000,"Pls Wait.."
    blnFlag = True 
   
    Delay 2000,"Pls Wait.."

    strTemp="WPFObject(""ArrowControl"", """", 1)"
    Set objNewWorkspace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,20,True)
    If objNewWorkspace.Exists = True then
      objNewWorkspace.Click
       strTemp="WPFObject(""BarPopupBorderControl"", """", 1)"
      Set objWrkspace_popup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").FindChild("Name",strTemp,5,True)
      If objWrkspace_popup.Exists = True then
        strTemp="WPFObject(""ContentControlEx"", ""Open For Edit (Source)"", 2)"
        Set objopenforEdit=objWrkspace_popup.FindChild("Name",strTemp,8,True)
        If objopenforEdit.Exists then
          objopenforEdit.Click    
        End If
      End if
      
      strTemp1="WPFObject(""HwndSource: WorkspaceNamePrompt"", ""Please provide a new Workspace Name"")"
      Set objNewWrkSpaceName=Sys.Process("EdgeClient").WaitChild(strTemp1,50000)
      If objNewWrkSpaceName.Exists = True then
     
      ''Waiting for Workspace Name prompt
      strTemp="WPFObject(""FloatingContainerBorder"")"
      Set objNewWrkSpace_Name=Sys.Process("EdgeClient").WPFObject("HwndSource: WorkspaceNamePrompt", "Please provide a new Workspace Name").WPFObject("WorkspaceNamePrompt", "Please provide a new Workspace Name", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,15000000)
      If objNewWrkSpace_Name.Exists = True then
          strTemp="WPFObject(""ChangeNameTextEdit"")"
          ''Entering Workspace Name
          Set objNewWrkSpace_Txtbox=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
            If objNewWrkSpace_Txtbox.Exists = True then
              objNewWrkSpace_Txtbox.Click
              objNewWrkSpace_Txtbox.Text=strWrkSpaceName
      '        strTCRemarks=strTCRemarks & Chr(10) & "Entered Workspace Name - " & strWrkSpaceName
              ''Clicking on Ok Button 
              strTemp="WPFObject(""OkButton"")"
              Set objNewWrkSpace_okbtn=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
              If objNewWrkSpace_okbtn.Exists = True then
                objNewWrkSpace_okbtn.Click
                'Delay 5000,"Please wait..."
              End If
            End If
        End If
      End if 
     End if 
       
  
       ''Handling Validation for Source
    strTemp="WPFObject(""HwndSource: WindowContentHolder"", """")"
    Set objTemp=Sys.Process("EdgeClient").WaitChild(strTemp,10000)
    If objTemp.Exists = True then
      objTemp.Keys "[Enter]"
      strTestCaseResult = "FAIL"
      Exit Sub
    End If

    ''WorkSpace Edit Window
    strTemp="WPFObject(""LayoutPanel"", """", 2)"
    Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,13,True)
    If objTemp.Exists then
        Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WPFObject("SourceTreeListView")
        Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl")
       Delay 10000,"Pls Wait.."
        ''Expanding First Node in Tree      
        intTotNodeCnt=GridControl.Nodes_2.Count  
        For intI=0 to intTotNodeCnt-1         
          If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
           GridControl.Nodes_2.Item(intI).Expand(True)
           blnFlag=False  
           Exit For
          End If
        Next
         Delay 10000,"Pls Wait.."
        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
          For intJ=0 to intTotNodeCnt-1
            If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strSource2) then
              GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
              intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(0).get_RowHandle
              GridControl.Keys "^[Home]"
              Call GridControl.ClearSelectionCore
              Call GridControl.FocusViewAndRow(GridControl,intRow-1)
              GridControl.SetFocusOnCurrentItem
              Call GridControl.SelectRowCore(intRow-1)
        
              If objGridCell.Exists = True then
                objGridCell.Click
              End If
              blnFlag = False 
              Exit For
            End If
          Next
'           Delay 10000,"Pls Wait.."
'              intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count
'               For intK=0 to intTotNodeCnt-1
'                  If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description)=Ucase(strSource3) then
'                      intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).get_RowHandle
'                      Call GridControl.ClearSelectionCore
'                      GridControl.set_FocusedRowHandle(intRow)
'                      Call GridControl.FocusViewAndRow(GridControl,intRow)
'                      GridControl.SetFocusOnCurrentItem
'                      Call GridControl.SelectRowCore(intRow)
'                      Exit For   
'                  End If 
'               Next
    End if
            
    strTemp="WPFObject(""SourceTreeListView"")"
    objEditSource=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WaitChild(strTemp,15000000)
    if objEditSource.Exists = True then

          strTemp="WPFObject(""ContentControlEx"", ""Add Folder"", 2)"
          Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 4).WPFObject("BarButtonItemLinkControl", "", 1).FindChild("Name",strTemp,50,True)
          If objNewWrkSpace_okbtn.Exists = True then
             If objNewWrkSpace_okbtn.Enabled = True then
              objNewWrkSpace_okbtn.Click
              strTCRemarks = strTCRemarks & "<br />" & "Add Folder is found in Source"
              log.Message "Add Folder is found in Source"
             Else
              strTCRemarks = strTCRemarks & "<br />" & "Add Folder is Disabled in Source"
              log.Message "Add Folder is Disabled in Source"
             End if
          Else
            strTCRemarks = strTCRemarks & "<br />" & "Add Folder is  not found in Source"
            log.Message "Add Folder is not found in Source"
          End If   
        
          
           Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 4).WPFObject("BarButtonItemLinkControl", "", 1)      
         Delay 8000,"New Folder..."

        ''Getting no. of Rows under level 2
        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count
        intK=intTotNodeCnt-1
    
        Set objDescCell=Aliases.EdgeClient.HwndSource_RibbonWindow.RibbonWindow.ContentControl.Grid.Grid.ContentControl.Grid.ContentControl.PART_ContainerContent.BarManager.DockPanel.DockLayoutManager.LayoutGroup.LayoutPanel2.Root.BarManager.AdornerDecorator.AdornedControl.Grid.DockPanel.SourceTreeListControl.SourceTreeListView.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK)
        Call objDescCell.Content.set_Description(DescText)
        strTCRemarks = strTCRemarks & "<br />" & "Description is added in new folder"
        log.Message "Description is added in new folder"
        
        Call objDescCell.Content.set_DescriptionLocal(DescLocalText)
        strTCRemarks = strTCRemarks & "<br />" & "Description local is added in new folder"
        log.Message "Description local is added in new folder"
            
        Delay 15000,"Pls Wait.."
        Call SClosesource()
        Delay 5000,"Pls Wait.."
        
        
                   
    End if
 
    strTemp="WPFObject(""SourceTreeListView"")"
    objEditSource=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WaitChild(strTemp,15000000)
    if objEditSource.Exists = True then
          sys.Keys("[Up]")
           Call sEdgeProcessor
          strTemp="WPFObject(""ContentControlEx"", ""Copy Folder"", 2)"
          Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 8).WPFObject("BarSubItemLinkControl", "", 1).FindChild("Name",strTemp,50,True)
          If objNewWrkSpace_okbtn.Exists = True then
            objNewWrkSpace_okbtn.click
            'Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").Keys("[Down]")
            delay(10000)
            strTemp="WPFObject(""PopupMenuBarControl"", """", 1)"
            Set objwrkspacepop=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).Findchild("Name",strTemp,50,True)
          
            If objwrkspacepop.Exists = True then
            objwrkspacepop.Click
            sys.Keys("[Down]")
            delay(10000)
            
            set objEdgeFilter=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarButtonItemLinkControl", "", 1)
            strTemp="WPFObject(""ContentControlEx"", ""Copy Folder Only"", 2)"
            Set objTemp=objEdgeFilter.FindChild("Name",strTemp,50)
            If objTemp.Exists = TRUE then
               If objTemp.Enabled = False then
                strTCRemarks = strTCRemarks & "<br />" & "Copy Folder Only is disabled"
                log.Message "Copy Folder Only is disabled"
               Else
                strTCRemarks = strTCRemarks & "<br />" & "Copy Folder Only is Enabled"
                log.Message "Copy Folder Only is Enabled"
                objTemp.Click
                sys.Keys("[Down]")
                Call sEdgeProcessor
            
                set objEdgeFilter= Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 10).WPFObject("BarSubItemLinkControl", "", 1)
                strTemp="WPFObject(""ContentControlEx"", ""Paste Folder"", 2)"
                Set objTemp=objEdgeFilter.FindChild("Name",strTemp,50)
                If objTemp.Exists = TRUE then
                   If objTemp.Enabled = False then
                    strTCRemarks = strTCRemarks & "<br />" & "Paste Folder is disabled"
                    log.Message "Paste Folder is disabled"
                   Else
                    strTCRemarks = strTCRemarks & "<br />" & "Paste Folder is Enabled"
                    log.Message "Paste Folder is Enabled"
                    objTemp.Click
                    set objEdgeFilter= Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 3).WPFObject("BarButtonItemLinkControl", "", 1)
                    strTemp="WPFObject(""ContentControlEx"", ""Paste Below"", 2)"
                    Set objTemp=objEdgeFilter.FindChild("Name",strTemp,50)
                    If objTemp.Exists = TRUE then
                       If objTemp.Enabled = False then
                        strTCRemarks = strTCRemarks & "<br />" & "Paste Below is disabled"
                        log.Message "Paste Below is disabled"
                       Else
                        strTCRemarks = strTCRemarks & "<br />" & "Paste Below is Enabled"
                        log.Message "Paste Below is Enabled"
                        objTemp.Click
                        Call sEdgeProcessor
                        
                        strDesc1=aqDateTime.Now
                        strDesc2=aqDateTime.Now
                        DescText=Replace(strDesc1,"/","-")
                        DescText=Replace(DescText,":","_")
                        
                        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count
                        intK=intTotNodeCnt-1
    
                        Set objDescCell=Aliases.EdgeClient.HwndSource_RibbonWindow.RibbonWindow.ContentControl.Grid.Grid.ContentControl.Grid.ContentControl.PART_ContainerContent.BarManager.DockPanel.DockLayoutManager.LayoutGroup.LayoutPanel2.Root.BarManager.AdornerDecorator.AdornedControl.Grid.DockPanel.SourceTreeListControl.SourceTreeListView.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK)
                        Call objDescCell.Content.set_Description(DescText)
                        strTCRemarks = strTCRemarks & "<br />" & "Description is Updated in Pasted folder"
                        log.Message "Description is updated in Pasted folder"
        
                        Call objDescCell.Content.set_DescriptionLocal(DescText)
                        strTCRemarks = strTCRemarks & "<br />" & "Description local is Updated in Pasted folder"
                        log.Message "Description local is Updated in Pasted folder"
    
                       End if 
                    End If
                   End if 
                End If
               End if 
            End If 
        End if    
'            set objEdgeFilter= Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 2).WPFObject("BarButtonItemLinkControl", "", 1)
'            strTemp="WPFObject(""ContentControlEx"", ""Copy Folder with Series"", 2)"
'            Set objTemp=objEdgeFilter.FindChild("Name",strTemp,50)
'            If objTemp.Exists = TRUE then
'               If objTemp.Enabled = False then
'                strTCRemarks = strTCRemarks & "<br />" & "Copy Folder with Series is disabled"
'                log.Message "Copy Folder with Series is disabled"
'               Else
'                strTCRemarks = strTCRemarks & "<br />" & "Copy Folder with Series is Enabled"
'                log.Message "Copy Folder with Series is Enabled"
'               End if 
'            End If 
          '  Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1)
            
            
            
          end if 
    End if
    
    Dim objSaveWrk,objWait  
     set objSaveWrk=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 12).WPFObject("BarSubItemLinkControl", "", 1)
    strTemp="WPFObject(""ContentControlEx"", ""Workspace"", 2)"
    Set objTemp=objSaveWrk.FindChild("Name",strTemp,50)
    objWait=1
    Do until objTemp.Enabled = true 
        If objWait < 20 Then
          Delay 1000,"Pls Wait... Form is loading..."
          objWait=objWait+1
        else
          Call SClosesource()
          Call SourceWorkSpacevwr()
          Exit Sub
        end if 
    Loop 
    
    strTemp="WPFObject(""ContentControlEx"", ""Workspace"", 2)"
    Set objWrkSpace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,50,True)
    If objWrkSpace.Exists = True then
      Delay(1000)
      objWrkSpace.Click
      Delay(1000)
      strTemp="WPFObject(""PopupMenuBarControl"", """", 1)"
      Set objwrkspacepop=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").Findchild("Name",strTemp,50,True)
      'Set objwrkspacepop=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 2).WPFObject("BarButtonItemLinkControl", "", 1).WPFObject("ContentControlEx", "Upload Workspace", 2)
      If objwrkspacepop.Exists = True then
        strTemp="WPFObject(""ContentControlEx"", ""Upload Workspace"", 2)"
        set objwrkspcUpload=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).FindChild("Name",strTemp,50,True)
        If objwrkspcUpload.Exists = True then
          objwrkspcUpload.Click
          'Delay 1000,"Pls Wait.."
         strTemp="WPFObject(""PART_ContainerContent"")"
        Set objConfirm=Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "Confirm save.").FindChild("Name",strTemp,50,True)

          If objConfirm.Exists = True then
            Sys.Keys "[Enter]"
            'Delay 8000,"Uploading..."
            Set objConfirm = Sys.Process("EdgeClient")._
            Waitchild("WPFObject(""HwndSource: CustomMessageBoxWindow"", ""Upload Workspace"")",600000)._
            Waitchild("WPFObject(""CustomMessageBoxWindow"", ""Upload Workspace"", 1)",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""FloatingContainerBorder"")",60000)._
            Waitchild("WPFObject(""FloatingContainerBackground"")",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""FloatingContainerBody"")",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""PART_ContainerContent"")",60000)
            
            If objConfirm.Exists = True then
              Sys.Keys("O")

              'Delay 30000,"Pls Wait.."
              Call sEdgeProcessor
            End if
          End if
        End if
      End if
    End if
'  Call SClosesource()
  'Call SourceWorkSpacevwr()
End Sub
Sub sChkSrcCopyPasteBelowWithSeries(strParameters)
On Error Resume Next 
   Dim strSource1,StrSource2,strSource3,strTemp,GridControl,GridSourceTree,intTotNodeCnt,intI,intJ,intRow,intK,objEdge
   Dim objNewWorkspace,objWrkspace_popup,objOpenView,strTemp1,objNewWrkSpaceName,objNewWrkSpace_Txtbox,objNewWrkSpace_okbtn,objNewWrkSpace_Name
   Dim strDesc1,strDesc2,DescText,DescLocalText
   Dim objEditSource
   Dim objTemp, objStrClose
   Dim objEdgeFilter
   
    strSource1=getSplitValue(strParameters,"SOURCE")
    StrSource2=getSplitValue(strParameters,"LEVEL2SOURCE")
    StrSource3=getSplitValue(strParameters,"LEVEL3SOURCE")
    
'    strSource1="Test"
'    StrSource2="Automation_UIT2"
'    StrSource3="Test"

    Call sHome_Source
    
    strDesc1=aqDateTime.Now
    strDesc2=aqDateTime.Now
    DescText=Replace(strDesc1,"/","-")
    DescText=Replace(DescText,":","_")
    DescLocalText=DescText
    strWrkSpaceName=DescText
'    intSeriesID=getSplitValue(strParameters,"SERIESID")
'    if intSeriesID=0 then
'      Call sSourceseries
'      intSeriesID=strSourceFileText
'    End if 
    
    strTemp="WPFObject(""SourceTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""SourceTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    Delay 10000,"Pls Wait.."
    ''Selecting Country Name
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
          GridControl.Nodes_2.Item(intI).Expand(True)
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description       
          blnFlag=False  
          Exit For
        End If
    Next
    If blnFlag = True then
      strTCRemarks="Country Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
  
    Delay 10000,"Pls Wait.."
        blnFlag = True 
    ''Selecting Level2Source_Name
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
  For intJ=0 to intTotNodeCnt-1
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(StrSource2) then
        GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
        intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
'        Call GridSourceTree.ClickCell(intRow, "Edit")
        Call GridControl.ClearSelectionCore
        Call GridControl.FocusViewAndRow(GridControl,intRow)
        GridControl.SetFocusOnCurrentItem
        Call GridControl.SelectRowCore(intRow)
        log.Message "Level2 Source Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
        blnFlag = False 
        Exit For
      End If
    Next
    If blnFlag = True then
      log.Message "Level2 Source Name not found"
      strTCRemarks="Level2 Source Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
    
     Delay 10000,"Pls Wait.."
    blnFlag = True 
   
    Delay 2000,"Pls Wait.."

    strTemp="WPFObject(""ArrowControl"", """", 1)"
    Set objNewWorkspace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,20,True)
    If objNewWorkspace.Exists = True then
      objNewWorkspace.Click
       strTemp="WPFObject(""BarPopupBorderControl"", """", 1)"
      Set objWrkspace_popup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").FindChild("Name",strTemp,5,True)
      If objWrkspace_popup.Exists = True then
        strTemp="WPFObject(""ContentControlEx"", ""Open For Edit (Source)"", 2)"
        Set objopenforEdit=objWrkspace_popup.FindChild("Name",strTemp,8,True)
        If objopenforEdit.Exists then
          objopenforEdit.Click    
        End If
      End if
      
      strTemp1="WPFObject(""HwndSource: WorkspaceNamePrompt"", ""Please provide a new Workspace Name"")"
      Set objNewWrkSpaceName=Sys.Process("EdgeClient").WaitChild(strTemp1,50000)
      If objNewWrkSpaceName.Exists = True then
     
      ''Waiting for Workspace Name prompt
      strTemp="WPFObject(""FloatingContainerBorder"")"
      Set objNewWrkSpace_Name=Sys.Process("EdgeClient").WPFObject("HwndSource: WorkspaceNamePrompt", "Please provide a new Workspace Name").WPFObject("WorkspaceNamePrompt", "Please provide a new Workspace Name", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,15000000)
      If objNewWrkSpace_Name.Exists = True then
          strTemp="WPFObject(""ChangeNameTextEdit"")"
          ''Entering Workspace Name
          Set objNewWrkSpace_Txtbox=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
            If objNewWrkSpace_Txtbox.Exists = True then
              objNewWrkSpace_Txtbox.Click
              objNewWrkSpace_Txtbox.Text=strWrkSpaceName
      '        strTCRemarks=strTCRemarks & Chr(10) & "Entered Workspace Name - " & strWrkSpaceName
              ''Clicking on Ok Button 
              strTemp="WPFObject(""OkButton"")"
              Set objNewWrkSpace_okbtn=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
              If objNewWrkSpace_okbtn.Exists = True then
                objNewWrkSpace_okbtn.Click
                'Delay 5000,"Please wait..."
              End If
            End If
        End If
      End if 
     End if 
       
  
       ''Handling Validation for Source
    strTemp="WPFObject(""HwndSource: WindowContentHolder"", """")"
    Set objTemp=Sys.Process("EdgeClient").WaitChild(strTemp,10000)
    If objTemp.Exists = True then
      objTemp.Keys "[Enter]"
      strTestCaseResult = "FAIL"
      Exit Sub
    End If

    ''WorkSpace Edit Window
    strTemp="WPFObject(""LayoutPanel"", """", 2)"
    Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,13,True)
    If objTemp.Exists then
        Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WPFObject("SourceTreeListView")
        Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl")
       Delay 10000,"Pls Wait.."
        ''Expanding First Node in Tree      
        intTotNodeCnt=GridControl.Nodes_2.Count  
        For intI=0 to intTotNodeCnt-1         
          If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
           GridControl.Nodes_2.Item(intI).Expand(True)
           blnFlag=False  
           Exit For
          End If
        Next
         Delay 10000,"Pls Wait.."
        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
          For intJ=0 to intTotNodeCnt-1
            If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strSource2) then
              GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
              intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(0).get_RowHandle
              GridControl.Keys "^[Home]"
              Call GridControl.ClearSelectionCore
              Call GridControl.FocusViewAndRow(GridControl,intRow-1)
              GridControl.SetFocusOnCurrentItem
              Call GridControl.SelectRowCore(intRow-1)
        
              If objGridCell.Exists = True then
                objGridCell.Click
              End If
              blnFlag = False 
              Exit For
            End If
          Next
'           Delay 10000,"Pls Wait.."
'              intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count
'               For intK=0 to intTotNodeCnt-1
'                  If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description)=Ucase(strSource3) then
'                      intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).get_RowHandle
'                      Call GridControl.ClearSelectionCore
'                      GridControl.set_FocusedRowHandle(intRow)
'                      Call GridControl.FocusViewAndRow(GridControl,intRow)
'                      GridControl.SetFocusOnCurrentItem
'                      Call GridControl.SelectRowCore(intRow)
'                      Exit For   
'                  End If 
'               Next
    End if
            
    strTemp="WPFObject(""SourceTreeListView"")"
    objEditSource=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WaitChild(strTemp,15000000)
    if objEditSource.Exists = True then

          strTemp="WPFObject(""ContentControlEx"", ""Add Folder"", 2)"
          Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 4).WPFObject("BarButtonItemLinkControl", "", 1).FindChild("Name",strTemp,50,True)
          If objNewWrkSpace_okbtn.Exists = True then
             If objNewWrkSpace_okbtn.Enabled = True then
              objNewWrkSpace_okbtn.Click
              strTCRemarks = strTCRemarks & "<br />" & "Add Folder is found in Source"
              log.Message "Add Folder is found in Source"
             Else
              strTCRemarks = strTCRemarks & "<br />" & "Add Folder is Disabled in Source"
              log.Message "Add Folder is Disabled in Source"
             End if
          Else
            strTCRemarks = strTCRemarks & "<br />" & "Add Folder is  not found in Source"
            log.Message "Add Folder is not found in Source"
          End If   
        
          
           Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 4).WPFObject("BarButtonItemLinkControl", "", 1)      
         Delay 8000,"New Folder..."

        ''Getting no. of Rows under level 2
        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count
        intK=intTotNodeCnt-1
    
        Set objDescCell=Aliases.EdgeClient.HwndSource_RibbonWindow.RibbonWindow.ContentControl.Grid.Grid.ContentControl.Grid.ContentControl.PART_ContainerContent.BarManager.DockPanel.DockLayoutManager.LayoutGroup.LayoutPanel2.Root.BarManager.AdornerDecorator.AdornedControl.Grid.DockPanel.SourceTreeListControl.SourceTreeListView.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK)
        Call objDescCell.Content.set_Description(DescText)
        strTCRemarks = strTCRemarks & "<br />" & "Description is added in new folder"
        log.Message "Description is added in new folder"
        
        Call objDescCell.Content.set_DescriptionLocal(DescLocalText)
        strTCRemarks = strTCRemarks & "<br />" & "Description local is added in new folder"
        log.Message "Description local is added in new folder"
            
        Delay 15000,"Pls Wait.."
        Call SClosesource()
        Delay 5000,"Pls Wait.."
        
        
                   
    End if
 
    strTemp="WPFObject(""SourceTreeListView"")"
    objEditSource=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WaitChild(strTemp,15000000)
    if objEditSource.Exists = True then
          sys.Keys("[Up]")
           Call sEdgeProcessor
          strTemp="WPFObject(""ContentControlEx"", ""Copy Folder"", 2)"
          Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 8).WPFObject("BarSubItemLinkControl", "", 1).FindChild("Name",strTemp,50,True)
          If objNewWrkSpace_okbtn.Exists = True then
            objNewWrkSpace_okbtn.click
            'Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").Keys("[Down]")
            delay(10000)
            strTemp="WPFObject(""PopupMenuBarControl"", """", 1)"
            Set objwrkspacepop=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).Findchild("Name",strTemp,50,True)
          
            If objwrkspacepop.Exists = True then
            objwrkspacepop.Click
             sys.Keys("[Down][Down]")
            delay(10000)
            
            set objEdgeFilter=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 2).WPFObject("BarButtonItemLinkControl", "", 1)
            strTemp="WPFObject(""ContentControlEx"", ""Copy Folder with Series"", 2)"
            Set objTemp=objEdgeFilter.FindChild("Name",strTemp,50)
            If objTemp.Exists = TRUE then
               If objTemp.Enabled = False then
                strTCRemarks = strTCRemarks & "<br />" & "Copy Folder with Series is disabled"
                log.Message "Copy Folder with Series is disabled"
               Else
                strTCRemarks = strTCRemarks & "<br />" & "Copy Folder with Series is Enabled"
                log.Message "Copy Folder with Series is Enabled"
                objTemp.Click
                sys.Keys("[Down]")
                Call sEdgeProcessor
            
                set objEdgeFilter= Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 10).WPFObject("BarSubItemLinkControl", "", 1)
                strTemp="WPFObject(""ContentControlEx"", ""Paste Folder"", 2)"
                Set objTemp=objEdgeFilter.FindChild("Name",strTemp,50)
                If objTemp.Exists = TRUE then
                   If objTemp.Enabled = False then
                    strTCRemarks = strTCRemarks & "<br />" & "Paste Folder is disabled"
                    log.Message "Paste Folder is disabled"
                   Else
                    strTCRemarks = strTCRemarks & "<br />" & "Paste Folder is Enabled"
                    log.Message "Paste Folder is Enabled"
                    objTemp.Click
                    set objEdgeFilter= Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 3).WPFObject("BarButtonItemLinkControl", "", 1)
                    strTemp="WPFObject(""ContentControlEx"", ""Paste Below"", 2)"
                    Set objTemp=objEdgeFilter.FindChild("Name",strTemp,50)
                    If objTemp.Exists = TRUE then
                       If objTemp.Enabled = False then
                        strTCRemarks = strTCRemarks & "<br />" & "Paste Below is disabled"
                        log.Message "Paste Below is disabled"
                       Else
                        strTCRemarks = strTCRemarks & "<br />" & "Paste Below is Enabled"
                        log.Message "Paste Below is Enabled"
                        objTemp.Click
                        Call sEdgeProcessor
                        
                        strDesc1=aqDateTime.Now
                        strDesc2=aqDateTime.Now
                        DescText=Replace(strDesc1,"/","-")
                        DescText=Replace(DescText,":","_")
                        
                        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count
                        intK=intTotNodeCnt-1
    
                        Set objDescCell=Aliases.EdgeClient.HwndSource_RibbonWindow.RibbonWindow.ContentControl.Grid.Grid.ContentControl.Grid.ContentControl.PART_ContainerContent.BarManager.DockPanel.DockLayoutManager.LayoutGroup.LayoutPanel2.Root.BarManager.AdornerDecorator.AdornedControl.Grid.DockPanel.SourceTreeListControl.SourceTreeListView.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK)
                        Call objDescCell.Content.set_Description(DescText)
                        strTCRemarks = strTCRemarks & "<br />" & "Description is Updated in Pasted folder"
                        log.Message "Description is updated in Pasted folder"
        
                        Call objDescCell.Content.set_DescriptionLocal(DescText)
                        strTCRemarks = strTCRemarks & "<br />" & "Description local is Updated in Pasted folder"
                        log.Message "Description local is Updated in Pasted folder"
    
                       End if 
                    End If
                   End if 
                End If
               End if 
            End If 
        End if    
'            set objEdgeFilter= Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 2).WPFObject("BarButtonItemLinkControl", "", 1)
'            strTemp="WPFObject(""ContentControlEx"", ""Copy Folder with Series"", 2)"
'            Set objTemp=objEdgeFilter.FindChild("Name",strTemp,50)
'            If objTemp.Exists = TRUE then
'               If objTemp.Enabled = False then
'                strTCRemarks = strTCRemarks & "<br />" & "Copy Folder with Series is disabled"
'                log.Message "Copy Folder with Series is disabled"
'               Else
'                strTCRemarks = strTCRemarks & "<br />" & "Copy Folder with Series is Enabled"
'                log.Message "Copy Folder with Series is Enabled"
'               End if 
'            End If 
          '  Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1)
            
            
            
          end if 
    End if
    
    Dim objSaveWrk,objWait  
     set objSaveWrk=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 12).WPFObject("BarSubItemLinkControl", "", 1)
    strTemp="WPFObject(""ContentControlEx"", ""Workspace"", 2)"
    Set objTemp=objSaveWrk.FindChild("Name",strTemp,50)
    objWait=1
    Do until objTemp.Enabled = true 
        If objWait < 20 Then
          Delay 1000,"Pls Wait... Form is loading..."
          objWait=objWait+1
        else
          Call SClosesource()
          Call SourceWorkSpacevwr()
          Exit Sub
        end if 
    Loop 
    
    strTemp="WPFObject(""ContentControlEx"", ""Workspace"", 2)"
    Set objWrkSpace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,50,True)
    If objWrkSpace.Exists = True then
      Delay(1000)
      objWrkSpace.Click
      Delay(1000)
      strTemp="WPFObject(""PopupMenuBarControl"", """", 1)"
      Set objwrkspacepop=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").Findchild("Name",strTemp,50,True)
      'Set objwrkspacepop=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 2).WPFObject("BarButtonItemLinkControl", "", 1).WPFObject("ContentControlEx", "Upload Workspace", 2)
      If objwrkspacepop.Exists = True then
        strTemp="WPFObject(""ContentControlEx"", ""Upload Workspace"", 2)"
        set objwrkspcUpload=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).FindChild("Name",strTemp,50,True)
        If objwrkspcUpload.Exists = True then
          objwrkspcUpload.Click
          'Delay 1000,"Pls Wait.."
          strTemp="WPFObject(""PART_ContainerContent"")"
        Set objConfirm=Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "Confirm save.").FindChild("Name",strTemp,50,True)

          If objConfirm.Exists = True then
            Sys.Keys "[Enter]"
            'Delay 8000,"Uploading..."
            Set objConfirm = Sys.Process("EdgeClient")._
            Waitchild("WPFObject(""HwndSource: CustomMessageBoxWindow"", ""Upload Workspace"")",600000)._
            Waitchild("WPFObject(""CustomMessageBoxWindow"", ""Upload Workspace"", 1)",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""FloatingContainerBorder"")",60000)._
            Waitchild("WPFObject(""FloatingContainerBackground"")",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""FloatingContainerBody"")",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""PART_ContainerContent"")",60000)
            
            If objConfirm.Exists = True then
              Sys.Keys("O")

              'Delay 30000,"Pls Wait.."
              Call sEdgeProcessor
            End if
          End if
        End if
      End if
    End if
'  Call SClosesource()
  'Call SourceWorkSpacevwr()
End Sub
Sub sChkSrcCopyPasteAboveWithSeries(strParameters)
On Error Resume Next 
   Dim strSource1,StrSource2,strSource3,strTemp,GridControl,GridSourceTree,intTotNodeCnt,intI,intJ,intRow,intK,objEdge
   Dim objNewWorkspace,objWrkspace_popup,objOpenView,strTemp1,objNewWrkSpaceName,objNewWrkSpace_Txtbox,objNewWrkSpace_okbtn,objNewWrkSpace_Name
   Dim strDesc1,strDesc2,DescText,DescLocalText
   Dim objEditSource
   Dim objTemp, objStrClose
   Dim objEdgeFilter
   
    strSource1=getSplitValue(strParameters,"SOURCE")
    StrSource2=getSplitValue(strParameters,"LEVEL2SOURCE")
    StrSource3=getSplitValue(strParameters,"LEVEL3SOURCE")
    
'    strSource1="Test"
'    StrSource2="Automation_UIT2"
'    StrSource3="Test"

    Call sHome_Source
    
    strDesc1=aqDateTime.Now
    strDesc2=aqDateTime.Now
    DescText=Replace(strDesc1,"/","-")
    DescText=Replace(DescText,":","_")
    DescLocalText=DescText
    strWrkSpaceName=DescText
'    intSeriesID=getSplitValue(strParameters,"SERIESID")
'    if intSeriesID=0 then
'      Call sSourceseries
'      intSeriesID=strSourceFileText
'    End if 
    
    strTemp="WPFObject(""SourceTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""SourceTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    Delay 10000,"Pls Wait.."
    ''Selecting Country Name
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
          GridControl.Nodes_2.Item(intI).Expand(True)
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description       
          blnFlag=False  
          Exit For
        End If
    Next
    If blnFlag = True then
      strTCRemarks="Country Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
  
    Delay 10000,"Pls Wait.."
        blnFlag = True 
    ''Selecting Level2Source_Name
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
  For intJ=0 to intTotNodeCnt-1
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(StrSource2) then
        GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
        intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
'        Call GridSourceTree.ClickCell(intRow, "Edit")
        Call GridControl.ClearSelectionCore
        Call GridControl.FocusViewAndRow(GridControl,intRow)
        GridControl.SetFocusOnCurrentItem
        Call GridControl.SelectRowCore(intRow)
        log.Message "Level2 Source Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
        blnFlag = False 
        Exit For
      End If
    Next
    If blnFlag = True then
      log.Message "Level2 Source Name not found"
      strTCRemarks="Level2 Source Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
    
     Delay 10000,"Pls Wait.."
    blnFlag = True 
   
    Delay 2000,"Pls Wait.."

    strTemp="WPFObject(""ArrowControl"", """", 1)"
    Set objNewWorkspace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,20,True)
    If objNewWorkspace.Exists = True then
      objNewWorkspace.Click
       strTemp="WPFObject(""BarPopupBorderControl"", """", 1)"
      Set objWrkspace_popup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").FindChild("Name",strTemp,5,True)
      If objWrkspace_popup.Exists = True then
        strTemp="WPFObject(""ContentControlEx"", ""Open For Edit (Source)"", 2)"
        Set objopenforEdit=objWrkspace_popup.FindChild("Name",strTemp,8,True)
        If objopenforEdit.Exists then
          objopenforEdit.Click    
        End If
      End if
      
      strTemp1="WPFObject(""HwndSource: WorkspaceNamePrompt"", ""Please provide a new Workspace Name"")"
      Set objNewWrkSpaceName=Sys.Process("EdgeClient").WaitChild(strTemp1,50000)
      If objNewWrkSpaceName.Exists = True then
     
      ''Waiting for Workspace Name prompt
      strTemp="WPFObject(""FloatingContainerBorder"")"
      Set objNewWrkSpace_Name=Sys.Process("EdgeClient").WPFObject("HwndSource: WorkspaceNamePrompt", "Please provide a new Workspace Name").WPFObject("WorkspaceNamePrompt", "Please provide a new Workspace Name", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,15000000)
      If objNewWrkSpace_Name.Exists = True then
          strTemp="WPFObject(""ChangeNameTextEdit"")"
          ''Entering Workspace Name
          Set objNewWrkSpace_Txtbox=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
            If objNewWrkSpace_Txtbox.Exists = True then
              objNewWrkSpace_Txtbox.Click
              objNewWrkSpace_Txtbox.Text=strWrkSpaceName
      '        strTCRemarks=strTCRemarks & Chr(10) & "Entered Workspace Name - " & strWrkSpaceName
              ''Clicking on Ok Button 
              strTemp="WPFObject(""OkButton"")"
              Set objNewWrkSpace_okbtn=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
              If objNewWrkSpace_okbtn.Exists = True then
                objNewWrkSpace_okbtn.Click
                'Delay 5000,"Please wait..."
              End If
            End If
        End If
      End if 
     End if 
       
  
       ''Handling Validation for Source
    strTemp="WPFObject(""HwndSource: WindowContentHolder"", """")"
    Set objTemp=Sys.Process("EdgeClient").WaitChild(strTemp,10000)
    If objTemp.Exists = True then
      objTemp.Keys "[Enter]"
      strTestCaseResult = "FAIL"
      Exit Sub
    End If

    ''WorkSpace Edit Window
    strTemp="WPFObject(""LayoutPanel"", """", 2)"
    Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,13,True)
    If objTemp.Exists then
        Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WPFObject("SourceTreeListView")
        Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl")
       Delay 10000,"Pls Wait.."
        ''Expanding First Node in Tree      
        intTotNodeCnt=GridControl.Nodes_2.Count  
        For intI=0 to intTotNodeCnt-1         
          If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
           GridControl.Nodes_2.Item(intI).Expand(True)
           blnFlag=False  
           Exit For
          End If
        Next
         Delay 10000,"Pls Wait.."
        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
          For intJ=0 to intTotNodeCnt-1
            If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strSource2) then
              GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
              intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(0).get_RowHandle
              GridControl.Keys "^[Home]"
              Call GridControl.ClearSelectionCore
              Call GridControl.FocusViewAndRow(GridControl,intRow-1)
              GridControl.SetFocusOnCurrentItem
              Call GridControl.SelectRowCore(intRow-1)
        
              If objGridCell.Exists = True then
                objGridCell.Click
              End If
              blnFlag = False 
              Exit For
            End If
          Next
'           Delay 10000,"Pls Wait.."
'              intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count
'               For intK=0 to intTotNodeCnt-1
'                  If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description)=Ucase(strSource3) then
'                      intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).get_RowHandle
'                      Call GridControl.ClearSelectionCore
'                      GridControl.set_FocusedRowHandle(intRow)
'                      Call GridControl.FocusViewAndRow(GridControl,intRow)
'                      GridControl.SetFocusOnCurrentItem
'                      Call GridControl.SelectRowCore(intRow)
'                      Exit For   
'                  End If 
'               Next
    End if
            
    strTemp="WPFObject(""SourceTreeListView"")"
    objEditSource=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WaitChild(strTemp,15000000)
    if objEditSource.Exists = True then

          strTemp="WPFObject(""ContentControlEx"", ""Add Folder"", 2)"
          Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 4).WPFObject("BarButtonItemLinkControl", "", 1).FindChild("Name",strTemp,50,True)
          If objNewWrkSpace_okbtn.Exists = True then
             If objNewWrkSpace_okbtn.Enabled = True then
              objNewWrkSpace_okbtn.Click
              strTCRemarks = strTCRemarks & "<br />" & "Add Folder is found in Source"
              log.Message "Add Folder is found in Source"
             Else
              strTCRemarks = strTCRemarks & "<br />" & "Add Folder is Disabled in Source"
              log.Message "Add Folder is Disabled in Source"
             End if
          Else
            strTCRemarks = strTCRemarks & "<br />" & "Add Folder is  not found in Source"
            log.Message "Add Folder is not found in Source"
          End If   
        
          
           Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 4).WPFObject("BarButtonItemLinkControl", "", 1)      
         Delay 8000,"New Folder..."

        ''Getting no. of Rows under level 2
        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count
        intK=intTotNodeCnt-1
    
        Set objDescCell=Aliases.EdgeClient.HwndSource_RibbonWindow.RibbonWindow.ContentControl.Grid.Grid.ContentControl.Grid.ContentControl.PART_ContainerContent.BarManager.DockPanel.DockLayoutManager.LayoutGroup.LayoutPanel2.Root.BarManager.AdornerDecorator.AdornedControl.Grid.DockPanel.SourceTreeListControl.SourceTreeListView.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK)
        Call objDescCell.Content.set_Description(DescText)
        strTCRemarks = strTCRemarks & "<br />" & "Description is added in new folder"
        log.Message "Description is added in new folder"
        
        Call objDescCell.Content.set_DescriptionLocal(DescLocalText)
        strTCRemarks = strTCRemarks & "<br />" & "Description local is added in new folder"
        log.Message "Description local is added in new folder"
            
        Delay 15000,"Pls Wait.."
        Call SClosesource()
        Delay 5000,"Pls Wait.."
        
        
                   
    End if
 
    strTemp="WPFObject(""SourceTreeListView"")"
    objEditSource=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WaitChild(strTemp,15000000)
    if objEditSource.Exists = True then
          sys.Keys("[Up]")
           Call sEdgeProcessor
          strTemp="WPFObject(""ContentControlEx"", ""Copy Folder"", 2)"
          Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 8).WPFObject("BarSubItemLinkControl", "", 1).FindChild("Name",strTemp,50,True)
          If objNewWrkSpace_okbtn.Exists = True then
            objNewWrkSpace_okbtn.click
            'Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").Keys("[Down]")
            delay(10000)
            strTemp="WPFObject(""PopupMenuBarControl"", """", 1)"
            Set objwrkspacepop=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).Findchild("Name",strTemp,50,True)
          
            If objwrkspacepop.Exists = True then
            objwrkspacepop.Click
            sys.Keys("[Down][Down]")
            delay(10000)
            
            set objEdgeFilter=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 2).WPFObject("BarButtonItemLinkControl", "", 1)
            strTemp="WPFObject(""ContentControlEx"", ""Copy Folder with Series"", 2)"
            Set objTemp=objEdgeFilter.FindChild("Name",strTemp,50)
            If objTemp.Exists = TRUE then
               If objTemp.Enabled = False then
                strTCRemarks = strTCRemarks & "<br />" & "Copy Folder with Series is disabled"
                log.Message "Copy Folder with Series is disabled"
               Else
                strTCRemarks = strTCRemarks & "<br />" & "Copy Folder with Series is Enabled"
                log.Message "Copy Folder with Series is Enabled"
                objTemp.Click
           
                sys.Keys("[Down]")
                Call sEdgeProcessor
                
                set objEdgeFilter= Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 10).WPFObject("BarSubItemLinkControl", "", 1)
                strTemp="WPFObject(""ContentControlEx"", ""Paste Folder"", 2)"
                Set objTemp=objEdgeFilter.FindChild("Name",strTemp,50)
                If objTemp.Exists = TRUE then
                   If objTemp.Enabled = False then
                    strTCRemarks = strTCRemarks & "<br />" & "Paste Folder is disabled"
                    log.Message "Paste Folder is disabled"
                   Else
                    strTCRemarks = strTCRemarks & "<br />" & "Paste Folder is Enabled"
                    log.Message "Paste Folder is Enabled"
                    objTemp.Click
                    set objEdgeFilter=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarButtonItemLinkControl", "", 1)
                    strTemp="WPFObject(""ContentControlEx"", ""Paste Above"", 2)"
                    Set objTemp=objEdgeFilter.FindChild("Name",strTemp,50)
                    If objTemp.Exists = TRUE then
                       If objTemp.Enabled = False then
                        strTCRemarks = strTCRemarks & "<br />" & "Paste Above is disabled"
                        log.Message "Paste Above is disabled"
                       Else
                        strTCRemarks = strTCRemarks & "<br />" & "Paste Above is Enabled"
                        log.Message "Paste Above is Enabled"
                        objTemp.Click
                        Call sEdgeProcessor
                        sys.Keys("[Down]")
                        
                        strDesc1=aqDateTime.Now
                        strDesc2=aqDateTime.Now
                        DescText=Replace(strDesc1,"/","-")
                        DescText=Replace(DescText,":","_")
                        
                        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count
                        intK=intTotNodeCnt-2
    
                        Set objDescCell=Aliases.EdgeClient.HwndSource_RibbonWindow.RibbonWindow.ContentControl.Grid.Grid.ContentControl.Grid.ContentControl.PART_ContainerContent.BarManager.DockPanel.DockLayoutManager.LayoutGroup.LayoutPanel2.Root.BarManager.AdornerDecorator.AdornedControl.Grid.DockPanel.SourceTreeListControl.SourceTreeListView.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK)
                        Call objDescCell.Content.set_Description(DescText)
                        strTCRemarks = strTCRemarks & "<br />" & "Description is Updated in Pasted folder"
                        log.Message "Description is updated in Pasted folder"
        
                        Call objDescCell.Content.set_DescriptionLocal(DescText)
                        strTCRemarks = strTCRemarks & "<br />" & "Description local is Updated in Pasted folder"
                        log.Message "Description local is Updated in Pasted folder"
                        
'                        strTemp="WPFObject(""PART_ContainerContent"")"
'                        Set objConfirm=Sys.Process("EdgeClient").WPFObject("HwndSource: WindowContentHolder", "Copy and paste source folder with series").WPFObject("WindowContentHolder", "Copy and paste source folder with series", 1).FindChild("Name",strTemp,50,True)
'                        strTemp="WPFObject(""DXMessageBox"", """", 1)"
'                        Set objConfirm=objConfirm.WaitChild(strTemp,180000)
'                        If objConfirm.Exists = True then
'                          objConfirm.Keys "[Enter]"
'                          'Delay 30000,"Pls Wait.."
'                          Call sEdgeProcessor
'                        End if
                       End if 
                    End If
                   End if 
                End If
               End if 
            End If 
        End if    
'            set objEdgeFilter= Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 2).WPFObject("BarButtonItemLinkControl", "", 1)
'            strTemp="WPFObject(""ContentControlEx"", ""Copy Folder with Series"", 2)"
'            Set objTemp=objEdgeFilter.FindChild("Name",strTemp,50)
'            If objTemp.Exists = TRUE then
'               If objTemp.Enabled = False then
'                strTCRemarks = strTCRemarks & "<br />" & "Copy Folder with Series is disabled"
'                log.Message "Copy Folder with Series is disabled"
'               Else
'                strTCRemarks = strTCRemarks & "<br />" & "Copy Folder with Series is Enabled"
'                log.Message "Copy Folder with Series is Enabled"
'               End if 
'            End If 
          '  Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1)
            
            
            
          end if 
    End if
    
    Dim objSaveWrk,objWork 
     set objSaveWrk=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 12).WPFObject("BarSubItemLinkControl", "", 1)
    strTemp="WPFObject(""ContentControlEx"", ""Workspace"", 2)"
    Set objTemp=objSaveWrk.FindChild("Name",strTemp,50)
    objWait=1
    Do until objTemp.Enabled = true 
        If objWait < 20 Then
          Delay 1000,"Pls Wait... Form is loading..."
          objWait=objWait+1
        else
          Call SClosesource()
          Call SourceWorkSpacevwr()
          Exit Sub
        end if 
    Loop 
    strTemp="WPFObject(""ContentControlEx"", ""Workspace"", 2)"
    Set objWrkSpace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,50,True)
    If objWrkSpace.Exists = True then
      Delay(1000)
      objWrkSpace.Click
      Delay(1000)
      strTemp="WPFObject(""PopupMenuBarControl"", """", 1)"
      Set objwrkspacepop=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").Findchild("Name",strTemp,50,True)
      'Set objwrkspacepop=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 2).WPFObject("BarButtonItemLinkControl", "", 1).WPFObject("ContentControlEx", "Upload Workspace", 2)
      If objwrkspacepop.Exists = True then
        strTemp="WPFObject(""ContentControlEx"", ""Upload Workspace"", 2)"
        set objwrkspcUpload=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).FindChild("Name",strTemp,50,True)
        If objwrkspcUpload.Exists = True then
          objwrkspcUpload.Click
          'Delay 1000,"Pls Wait.."
          strTemp="WPFObject(""PART_ContainerContent"")"
        Set objConfirm=Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "Confirm save.").FindChild("Name",strTemp,50,True)

          If objConfirm.Exists = True then
            Sys.Keys "[Enter]"
            'Delay 8000,"Uploading..."
            Set objConfirm = Sys.Process("EdgeClient")._
            Waitchild("WPFObject(""HwndSource: CustomMessageBoxWindow"", ""Upload Workspace"")",600000)._
            Waitchild("WPFObject(""CustomMessageBoxWindow"", ""Upload Workspace"", 1)",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""FloatingContainerBorder"")",60000)._
            Waitchild("WPFObject(""FloatingContainerBackground"")",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""FloatingContainerBody"")",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""PART_ContainerContent"")",60000)
            
            If objConfirm.Exists = True then
              Sys.Keys("O")
           'Delay 30000,"Pls Wait.."
              Call sEdgeProcessor
            End if
          End if
        End if
      End if
    End if
'  Call SClosesource()
  'Call SourceWorkSpacevwr()
End Sub
Sub sChkSrcCutPasteAbove(strParameters)
On Error Resume Next 
   Dim strSource1,StrSource2,strSource3,strTemp,GridControl,GridSourceTree,intTotNodeCnt,intI,intJ,intRow,intK,objEdge
   Dim objNewWorkspace,objWrkspace_popup,objOpenView,strTemp1,objNewWrkSpaceName,objNewWrkSpace_Txtbox,objNewWrkSpace_okbtn,objNewWrkSpace_Name
   Dim strDesc1,strDesc2,DescText,DescLocalText
   Dim objEditSource
   Dim objTemp, objStrClose
   Dim objEdgeFilter
   
    strSource1=getSplitValue(strParameters,"SOURCE")
    StrSource2=getSplitValue(strParameters,"LEVEL2SOURCE")
    StrSource3=getSplitValue(strParameters,"LEVEL3SOURCE")
    
'    strSource1="Test"
'    StrSource2="Automation_UIT2"
'    StrSource3="Test"

    Call sHome_Source
    
    strDesc1=aqDateTime.Now
    strDesc2=aqDateTime.Now
    DescText=Replace(strDesc1,"/","-")
    DescText=Replace(DescText,":","_")
    DescLocalText=DescText
    strWrkSpaceName=DescText
'    intSeriesID=getSplitValue(strParameters,"SERIESID")
'    if intSeriesID=0 then
'      Call sSourceseries
'      intSeriesID=strSourceFileText
'    End if 
    
    strTemp="WPFObject(""SourceTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""SourceTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    Delay 10000,"Pls Wait.."
    ''Selecting Country Name
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
          GridControl.Nodes_2.Item(intI).Expand(True)
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description       
          blnFlag=False  
          Exit For
        End If
    Next
    If blnFlag = True then
      strTCRemarks="Country Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
  
    Delay 10000,"Pls Wait.."
        blnFlag = True 
    ''Selecting Level2Source_Name
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
  For intJ=0 to intTotNodeCnt-1
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(StrSource2) then
        GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
        intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
'        Call GridSourceTree.ClickCell(intRow, "Edit")
        Call GridControl.ClearSelectionCore
        Call GridControl.FocusViewAndRow(GridControl,intRow)
        GridControl.SetFocusOnCurrentItem
        Call GridControl.SelectRowCore(intRow)
        log.Message "Level2 Source Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
        blnFlag = False 
        Exit For
      End If
    Next
    If blnFlag = True then
      log.Message "Level2 Source Name not found"
      strTCRemarks="Level2 Source Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
    
     Delay 10000,"Pls Wait.."
    blnFlag = True 
   
    Delay 2000,"Pls Wait.."

    strTemp="WPFObject(""ArrowControl"", """", 1)"
    Set objNewWorkspace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,20,True)
    If objNewWorkspace.Exists = True then
      objNewWorkspace.Click
       strTemp="WPFObject(""BarPopupBorderControl"", """", 1)"
      Set objWrkspace_popup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").FindChild("Name",strTemp,5,True)
      If objWrkspace_popup.Exists = True then
        strTemp="WPFObject(""ContentControlEx"", ""Open For Edit (Source)"", 2)"
        Set objopenforEdit=objWrkspace_popup.FindChild("Name",strTemp,8,True)
        If objopenforEdit.Exists then
          objopenforEdit.Click    
        End If
      End if
      
      strTemp1="WPFObject(""HwndSource: WorkspaceNamePrompt"", ""Please provide a new Workspace Name"")"
      Set objNewWrkSpaceName=Sys.Process("EdgeClient").WaitChild(strTemp1,50000)
      If objNewWrkSpaceName.Exists = True then
     
      ''Waiting for Workspace Name prompt
      strTemp="WPFObject(""FloatingContainerBorder"")"
      Set objNewWrkSpace_Name=Sys.Process("EdgeClient").WPFObject("HwndSource: WorkspaceNamePrompt", "Please provide a new Workspace Name").WPFObject("WorkspaceNamePrompt", "Please provide a new Workspace Name", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,15000000)
      If objNewWrkSpace_Name.Exists = True then
          strTemp="WPFObject(""ChangeNameTextEdit"")"
          ''Entering Workspace Name
          Set objNewWrkSpace_Txtbox=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
            If objNewWrkSpace_Txtbox.Exists = True then
              objNewWrkSpace_Txtbox.Click
              objNewWrkSpace_Txtbox.Text=strWrkSpaceName
      '        strTCRemarks=strTCRemarks & Chr(10) & "Entered Workspace Name - " & strWrkSpaceName
              ''Clicking on Ok Button 
              strTemp="WPFObject(""OkButton"")"
              Set objNewWrkSpace_okbtn=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
              If objNewWrkSpace_okbtn.Exists = True then
                objNewWrkSpace_okbtn.Click
                'Delay 5000,"Please wait..."
              End If
            End If
        End If
      End if 
     End if 
       
  
       ''Handling Validation for Source
    strTemp="WPFObject(""HwndSource: WindowContentHolder"", """")"
    Set objTemp=Sys.Process("EdgeClient").WaitChild(strTemp,10000)
    If objTemp.Exists = True then
      objTemp.Keys "[Enter]"
      strTestCaseResult = "FAIL"
      Exit Sub
    End If

    ''WorkSpace Edit Window
    strTemp="WPFObject(""LayoutPanel"", """", 2)"
    Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,13,True)
    If objTemp.Exists then
        Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WPFObject("SourceTreeListView")
        Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl")
       Delay 10000,"Pls Wait.."
        ''Expanding First Node in Tree      
        intTotNodeCnt=GridControl.Nodes_2.Count  
        For intI=0 to intTotNodeCnt-1         
          If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
           GridControl.Nodes_2.Item(intI).Expand(True)
           blnFlag=False  
           Exit For
          End If
        Next
         Delay 10000,"Pls Wait.."
        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
          For intJ=0 to intTotNodeCnt-1
            If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strSource2) then
              GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
              intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(0).get_RowHandle
              GridControl.Keys "^[Home]"
              Call GridControl.ClearSelectionCore
              Call GridControl.FocusViewAndRow(GridControl,intRow-1)
              GridControl.SetFocusOnCurrentItem
              Call GridControl.SelectRowCore(intRow-1)
        
              If objGridCell.Exists = True then
                objGridCell.Click
              End If
              blnFlag = False 
              Exit For
            End If
          Next
'           Delay 10000,"Pls Wait.."
'              intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count
'               For intK=0 to intTotNodeCnt-1
'                  If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description)=Ucase(strSource3) then
'                      intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).get_RowHandle
'                      Call GridControl.ClearSelectionCore
'                      GridControl.set_FocusedRowHandle(intRow)
'                      Call GridControl.FocusViewAndRow(GridControl,intRow)
'                      GridControl.SetFocusOnCurrentItem
'                      Call GridControl.SelectRowCore(intRow)
'                      Exit For   
'                  End If 
'               Next
    End if
            
    strTemp="WPFObject(""SourceTreeListView"")"
    objEditSource=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WaitChild(strTemp,15000000)
    if objEditSource.Exists = True then

          strTemp="WPFObject(""ContentControlEx"", ""Add Folder"", 2)"
          Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 4).WPFObject("BarButtonItemLinkControl", "", 1).FindChild("Name",strTemp,50,True)
          If objNewWrkSpace_okbtn.Exists = True then
             If objNewWrkSpace_okbtn.Enabled = True then
              objNewWrkSpace_okbtn.Click
              strTCRemarks = strTCRemarks & "<br />" & "Add Folder is found in Source"
              log.Message "Add Folder is found in Source"
             Else
              strTCRemarks = strTCRemarks & "<br />" & "Add Folder is Disabled in Source"
              log.Message "Add Folder is Disabled in Source"
             End if
          Else
            strTCRemarks = strTCRemarks & "<br />" & "Add Folder is  not found in Source"
            log.Message "Add Folder is not found in Source"
          End If   
        
          
           Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 4).WPFObject("BarButtonItemLinkControl", "", 1)      
         Delay 8000,"New Folder..."

        ''Getting no. of Rows under level 2
        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count
        intK=intTotNodeCnt-1
    
        Set objDescCell=Aliases.EdgeClient.HwndSource_RibbonWindow.RibbonWindow.ContentControl.Grid.Grid.ContentControl.Grid.ContentControl.PART_ContainerContent.BarManager.DockPanel.DockLayoutManager.LayoutGroup.LayoutPanel2.Root.BarManager.AdornerDecorator.AdornedControl.Grid.DockPanel.SourceTreeListControl.SourceTreeListView.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK)
        Call objDescCell.Content.set_Description(DescText)
        strTCRemarks = strTCRemarks & "<br />" & "Description is added in new folder"
        log.Message "Description is added in new folder"
        
        Call objDescCell.Content.set_DescriptionLocal(DescLocalText)
        strTCRemarks = strTCRemarks & "<br />" & "Description local is added in new folder"
        log.Message "Description local is added in new folder"
            
        Delay 15000,"Pls Wait.."
        Call SClosesource()
        Delay 5000,"Pls Wait.."
                       
    End if
 
    strTemp="WPFObject(""SourceTreeListView"")"
    objEditSource=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WaitChild(strTemp,15000000)
    if objEditSource.Exists = True then
          sys.Keys("[Up]")
          Call sEdgeProcessor
          strTemp="WPFObject(""ContentControlEx"", ""Cut Folder"", 2)"
          Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 9).WPFObject("BarButtonItemLinkControl", "", 1).FindChild("Name",strTemp,50,True)
          If objNewWrkSpace_okbtn.Exists = True then
                
                If objNewWrkSpace_okbtn.Enabled = False then
                  strTCRemarks = strTCRemarks & "<br />" & "Cut Folder is disabled"
                  log.Message "Cut Folder is disabled"
                Else
                strTCRemarks = strTCRemarks & "<br />" & "Cut Folder only is Enabled"
                log.Message "Cut Folder is Enabled"
                objNewWrkSpace_okbtn.Click
                sys.Keys("[Up]")
                Call sEdgeProcessor
                
                set objEdgeFilter= Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 10).WPFObject("BarSubItemLinkControl", "", 1)
                strTemp="WPFObject(""ContentControlEx"", ""Paste Folder"", 2)"
                Set objTemp=objEdgeFilter.FindChild("Name",strTemp,50)
                If objTemp.Exists = TRUE then
                   If objTemp.Enabled = False then
                    strTCRemarks = strTCRemarks & "<br />" & "Paste Folder is disabled"
                    log.Message "Paste Folder is disabled"
                   Else
                    strTCRemarks = strTCRemarks & "<br />" & "Paste Folder is Enabled"
                    log.Message "Paste Folder is Enabled"
                    objTemp.Click
                    set objEdgeFilter=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarButtonItemLinkControl", "", 1)
                    strTemp="WPFObject(""ContentControlEx"", ""Paste Above"", 2)"
                    Set objTemp=objEdgeFilter.FindChild("Name",strTemp,50)
                    If objTemp.Exists = TRUE then
                       If objTemp.Enabled = False then
                        strTCRemarks = strTCRemarks & "<br />" & "Paste Above is disabled"
                        log.Message "Paste Above is disabled"
                       Else
                        strTCRemarks = strTCRemarks & "<br />" & "Paste Above is Enabled"
                        log.Message "Paste Above is Enabled"
                        objTemp.Click
                        'Call sEdgeProcessor
                        strTemp="WPFObject(""PART_ContainerContent"")"
                        Set objConfirm=Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "Cut and paste source series").WPFObject("CustomMessageBoxWindow", "Cut and paste source series", 1).FindChild("Name",strTemp,50,True)
'                        strTemp="WPFObject(""DXMessageBox"", """", 1)"
'                        Set objConfirm=objConfirm.WaitChild(strTemp,180000)
                        If objConfirm.Exists = True then
                          Sys.Keys "[Enter]"
                          'Delay 30000,"Pls Wait.."
                          'Call sEdgeProcessor
                        End if
                       End if 
                    End If
                   End if 
                End If
        End if    
        End if 
    End if
    
    Dim objSaveWrk,objWait  
     set objSaveWrk=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 12).WPFObject("BarSubItemLinkControl", "", 1)
    strTemp="WPFObject(""ContentControlEx"", ""Workspace"", 2)"
    Set objTemp=objSaveWrk.FindChild("Name",strTemp,50)
    objWait=1
    Do until objTemp.Enabled = true 
        If objWait < 20 Then
          Delay 1000,"Pls Wait... Form is loading..."
          objWait=objWait+1
        else
          Call SClosesource()
          Call SourceWorkSpacevwr()
          Exit Sub
        end if 
    Loop 
    
    strTemp="WPFObject(""ContentControlEx"", ""Workspace"", 2)"
    Set objWrkSpace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,50,True)
    If objWrkSpace.Exists = True then
      Delay(1000)
      objWrkSpace.Click
      Delay(1000)
      strTemp="WPFObject(""PopupMenuBarControl"", """", 1)"
      Set objwrkspacepop=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").Findchild("Name",strTemp,50,True)
      'Set objwrkspacepop=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 2).WPFObject("BarButtonItemLinkControl", "", 1).WPFObject("ContentControlEx", "Upload Workspace", 2)
      If objwrkspacepop.Exists = True then
        strTemp="WPFObject(""ContentControlEx"", ""Upload Workspace"", 2)"
        set objwrkspcUpload=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).FindChild("Name",strTemp,50,True)
        If objwrkspcUpload.Exists = True then
          objwrkspcUpload.Click
          'Delay 1000,"Pls Wait.."
          strTemp="WPFObject(""PART_ContainerContent"")"
        Set objConfirm=Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "Confirm").FindChild("Name",strTemp,50,True)

          If objConfirm.Exists = True then
            Sys.Keys "[Enter]"
            'Delay 8000,"Uploading..."
            Set objConfirm = Sys.Process("EdgeClient")._
            Waitchild("WPFObject(""HwndSource: CustomMessageBoxWindow"", ""Upload Workspace"")",600000)._
            Waitchild("WPFObject(""CustomMessageBoxWindow"", ""Upload Workspace"", 1)",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""FloatingContainerBorder"")",60000)._
            Waitchild("WPFObject(""FloatingContainerBackground"")",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""FloatingContainerBody"")",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""PART_ContainerContent"")",60000)
            
            If objConfirm.Exists = True then
              Sys.Keys("O")
    'Delay 30000,"Pls Wait.."
              Call sEdgeProcessor
            End if
          End if
        End if
      End if
    End if
    Call sHome_Source
    
    strTemp="WPFObject(""SourceTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""SourceTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    Delay 10000,"Pls Wait.."
    ''Selecting Country Name
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
          GridControl.Nodes_2.Item(intI).Expand(True)
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description       
          blnFlag=False  
          Exit For
        End If
    Next
    If blnFlag = True then
      strTCRemarks="Country Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
  
    Delay 10000,"Pls Wait.."
        blnFlag = True 
    ''Selecting Level2Source_Name
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
  For intJ=0 to intTotNodeCnt-1
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(StrSource2) then
        GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
        intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
'        Call GridSourceTree.ClickCell(intRow, "Edit")
        Call GridControl.ClearSelectionCore
        Call GridControl.FocusViewAndRow(GridControl,intRow)
        GridControl.SetFocusOnCurrentItem
        Call GridControl.SelectRowCore(intRow)
        log.Message "Level2 Source Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
        blnFlag = False 
        Exit For
      End If
    Next
    If blnFlag = True then
      log.Message "Level2 Source Name not found"
      strTCRemarks="Level2 Source Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
    
     Delay 10000,"Pls Wait.."
    blnFlag = True 
   
    Delay 2000,"Pls Wait.."

    strTemp="WPFObject(""ArrowControl"", """", 1)"
    Set objNewWorkspace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,20,True)
    If objNewWorkspace.Exists = True then
      objNewWorkspace.Click
       strTemp="WPFObject(""BarPopupBorderControl"", """", 1)"
      Set objWrkspace_popup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").FindChild("Name",strTemp,5,True)
      If objWrkspace_popup.Exists = True then
        strTemp="WPFObject(""ContentControlEx"", ""Open For Edit (Source)"", 2)"
        Set objopenforEdit=objWrkspace_popup.FindChild("Name",strTemp,8,True)
        If objopenforEdit.Exists then
          objopenforEdit.Click    
        End If
      End if
      
      strTemp1="WPFObject(""HwndSource: WorkspaceNamePrompt"", ""Please provide a new Workspace Name"")"
      Set objNewWrkSpaceName=Sys.Process("EdgeClient").WaitChild(strTemp1,50000)
      If objNewWrkSpaceName.Exists = True then
     
      ''Waiting for Workspace Name prompt
      strTemp="WPFObject(""FloatingContainerBorder"")"
      Set objNewWrkSpace_Name=Sys.Process("EdgeClient").WPFObject("HwndSource: WorkspaceNamePrompt", "Please provide a new Workspace Name").WPFObject("WorkspaceNamePrompt", "Please provide a new Workspace Name", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,15000000)
      If objNewWrkSpace_Name.Exists = True then
          strTemp="WPFObject(""ChangeNameTextEdit"")"
          ''Entering Workspace Name
          Set objNewWrkSpace_Txtbox=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
            If objNewWrkSpace_Txtbox.Exists = True then
              objNewWrkSpace_Txtbox.Click
              objNewWrkSpace_Txtbox.Text=strWrkSpaceName
      '        strTCRemarks=strTCRemarks & Chr(10) & "Entered Workspace Name - " & strWrkSpaceName
              ''Clicking on Ok Button 
              strTemp="WPFObject(""OkButton"")"
              Set objNewWrkSpace_okbtn=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
              If objNewWrkSpace_okbtn.Exists = True then
                objNewWrkSpace_okbtn.Click
                'Delay 5000,"Please wait..."
              End If
            End If
        End If
      End if 
     End if 
       
  
       ''Handling Validation for Source
    strTemp="WPFObject(""HwndSource: WindowContentHolder"", """")"
    Set objTemp=Sys.Process("EdgeClient").WaitChild(strTemp,10000)
    If objTemp.Exists = True then
      objTemp.Keys "[Enter]"
      strTestCaseResult = "FAIL"
      Exit Sub
    End If

    ''WorkSpace Edit Window
    strTemp="WPFObject(""LayoutPanel"", """", 2)"
    Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,13,True)
    If objTemp.Exists then
        Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WPFObject("SourceTreeListView")
        Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl")
       Delay 10000,"Pls Wait.."
        ''Expanding First Node in Tree      
        intTotNodeCnt=GridControl.Nodes_2.Count  
        For intI=0 to intTotNodeCnt-1         
          If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
           GridControl.Nodes_2.Item(intI).Expand(True)
           blnFlag=False  
           Exit For
          End If
        Next
         Delay 10000,"Pls Wait.."
        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
          For intJ=0 to intTotNodeCnt-1
            If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strSource2) then
              GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
              intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(0).get_RowHandle
              GridControl.Keys "^[Home]"
              Call GridControl.ClearSelectionCore
              Call GridControl.FocusViewAndRow(GridControl,intRow-1)
              GridControl.SetFocusOnCurrentItem
              Call GridControl.SelectRowCore(intRow-1)
        
              If objGridCell.Exists = True then
                objGridCell.Click
              End If
              blnFlag = False 
              Exit For
            End If
          Next
           Delay 10000,"Pls Wait.."
              intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count
               For intK=0 to intTotNodeCnt-1
                  If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description)=Ucase(DescText) then
                      intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).get_RowHandle
                      Call GridControl.ClearSelectionCore
                      GridControl.set_FocusedRowHandle(intRow)
                      Call GridControl.FocusViewAndRow(GridControl,intRow)
                      GridControl.SetFocusOnCurrentItem
                      Call GridControl.SelectRowCore(intRow)
                      strTCRemarks = strTCRemarks & "<br />" & " Folder is found in Source"
                      log.Message "Folder is  found in Source"
                      Exit For   
                  else
                    strTCRemarks = strTCRemarks & "<br />" & "Folder is not found in Source"
                    log.Message "Folder is not found in Source"
                    Exit For   
                  End If 
               Next
               
      Call SClosesource()
      Delay 5000,"Pls Wait.."
      Call SClosesource()
      Call SourceWorkSpacevwr()
    End if

End Sub
Sub sChkSrcCutPasteBelow(strParameters)
On Error Resume Next 
   Dim strSource1,StrSource2,strSource3,strTemp,GridControl,GridSourceTree,intTotNodeCnt,intI,intJ,intRow,intK,objEdge
   Dim objNewWorkspace,objWrkspace_popup,objOpenView,strTemp1,objNewWrkSpaceName,objNewWrkSpace_Txtbox,objNewWrkSpace_okbtn,objNewWrkSpace_Name
   Dim strDesc1,strDesc2,DescText,DescLocalText
   Dim objEditSource
   Dim objTemp, objStrClose
   Dim objEdgeFilter
   
    strSource1=getSplitValue(strParameters,"SOURCE")
    StrSource2=getSplitValue(strParameters,"LEVEL2SOURCE")
    StrSource3=getSplitValue(strParameters,"LEVEL3SOURCE")
    
'    strSource1="Test"
'    StrSource2="Automation_UIT2"
'    StrSource3="Test"

    Call sHome_Source
    
    strDesc1=aqDateTime.Now
    strDesc2=aqDateTime.Now
    DescText=Replace(strDesc1,"/","-")
    DescText=Replace(DescText,":","_")
    DescLocalText=DescText
    strWrkSpaceName=DescText
'    intSeriesID=getSplitValue(strParameters,"SERIESID")
'    if intSeriesID=0 then
'      Call sSourceseries
'      intSeriesID=strSourceFileText
'    End if 
    
    strTemp="WPFObject(""SourceTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""SourceTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    Delay 10000,"Pls Wait.."
    ''Selecting Country Name
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
          GridControl.Nodes_2.Item(intI).Expand(True)
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description       
          blnFlag=False  
          Exit For
        End If
    Next
    If blnFlag = True then
      strTCRemarks="Country Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
  
    Delay 10000,"Pls Wait.."
        blnFlag = True 
    ''Selecting Level2Source_Name
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
  For intJ=0 to intTotNodeCnt-1
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(StrSource2) then
        GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
        intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
'        Call GridSourceTree.ClickCell(intRow, "Edit")
        Call GridControl.ClearSelectionCore
        Call GridControl.FocusViewAndRow(GridControl,intRow)
        GridControl.SetFocusOnCurrentItem
        Call GridControl.SelectRowCore(intRow)
        log.Message "Level2 Source Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
        blnFlag = False 
        Exit For
      End If
    Next
    If blnFlag = True then
      log.Message "Level2 Source Name not found"
      strTCRemarks="Level2 Source Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
    
     Delay 10000,"Pls Wait.."
    blnFlag = True 
   
    Delay 2000,"Pls Wait.."

    strTemp="WPFObject(""ArrowControl"", """", 1)"
    Set objNewWorkspace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,20,True)
    If objNewWorkspace.Exists = True then
      objNewWorkspace.Click
       strTemp="WPFObject(""BarPopupBorderControl"", """", 1)"
      Set objWrkspace_popup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").FindChild("Name",strTemp,5,True)
      If objWrkspace_popup.Exists = True then
        strTemp="WPFObject(""ContentControlEx"", ""Open For Edit (Source)"", 2)"
        Set objopenforEdit=objWrkspace_popup.FindChild("Name",strTemp,8,True)
        If objopenforEdit.Exists then
          objopenforEdit.Click    
        End If
      End if
      
      strTemp1="WPFObject(""HwndSource: WorkspaceNamePrompt"", ""Please provide a new Workspace Name"")"
      Set objNewWrkSpaceName=Sys.Process("EdgeClient").WaitChild(strTemp1,50000)
      If objNewWrkSpaceName.Exists = True then
     
      ''Waiting for Workspace Name prompt
      strTemp="WPFObject(""FloatingContainerBorder"")"
      Set objNewWrkSpace_Name=Sys.Process("EdgeClient").WPFObject("HwndSource: WorkspaceNamePrompt", "Please provide a new Workspace Name").WPFObject("WorkspaceNamePrompt", "Please provide a new Workspace Name", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,15000000)
      If objNewWrkSpace_Name.Exists = True then
          strTemp="WPFObject(""ChangeNameTextEdit"")"
          ''Entering Workspace Name
          Set objNewWrkSpace_Txtbox=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
            If objNewWrkSpace_Txtbox.Exists = True then
              objNewWrkSpace_Txtbox.Click
              objNewWrkSpace_Txtbox.Text=strWrkSpaceName
      '        strTCRemarks=strTCRemarks & Chr(10) & "Entered Workspace Name - " & strWrkSpaceName
              ''Clicking on Ok Button 
              strTemp="WPFObject(""OkButton"")"
              Set objNewWrkSpace_okbtn=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
              If objNewWrkSpace_okbtn.Exists = True then
                objNewWrkSpace_okbtn.Click
                'Delay 5000,"Please wait..."
              End If
            End If
        End If
      End if 
     End if 
       
  
       ''Handling Validation for Source
    strTemp="WPFObject(""HwndSource: WindowContentHolder"", """")"
    Set objTemp=Sys.Process("EdgeClient").WaitChild(strTemp,10000)
    If objTemp.Exists = True then
      objTemp.Keys "[Enter]"
      strTestCaseResult = "FAIL"
      Exit Sub
    End If

    ''WorkSpace Edit Window
    strTemp="WPFObject(""LayoutPanel"", """", 2)"
    Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,13,True)
    If objTemp.Exists then
        Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WPFObject("SourceTreeListView")
        Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl")
       Delay 10000,"Pls Wait.."
        ''Expanding First Node in Tree      
        intTotNodeCnt=GridControl.Nodes_2.Count  
        For intI=0 to intTotNodeCnt-1         
          If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
           GridControl.Nodes_2.Item(intI).Expand(True)
           blnFlag=False  
           Exit For
          End If
        Next
         Delay 10000,"Pls Wait.."
        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
          For intJ=0 to intTotNodeCnt-1
            If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strSource2) then
              GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
              intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(0).get_RowHandle
              GridControl.Keys "^[Home]"
              Call GridControl.ClearSelectionCore
              Call GridControl.FocusViewAndRow(GridControl,intRow-1)
              GridControl.SetFocusOnCurrentItem
              Call GridControl.SelectRowCore(intRow-1)
        
              If objGridCell.Exists = True then
                objGridCell.Click
              End If
              blnFlag = False 
              Exit For
            End If
          Next
'           Delay 10000,"Pls Wait.."
'              intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count
'               For intK=0 to intTotNodeCnt-1
'                  If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description)=Ucase(strSource3) then
'                      intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).get_RowHandle
'                      Call GridControl.ClearSelectionCore
'                      GridControl.set_FocusedRowHandle(intRow)
'                      Call GridControl.FocusViewAndRow(GridControl,intRow)
'                      GridControl.SetFocusOnCurrentItem
'                      Call GridControl.SelectRowCore(intRow)
'                      Exit For   
'                  End If 
'               Next
    End if
            
    strTemp="WPFObject(""SourceTreeListView"")"
    objEditSource=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WaitChild(strTemp,15000000)
    if objEditSource.Exists = True then

          strTemp="WPFObject(""ContentControlEx"", ""Add Folder"", 2)"
          Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 4).WPFObject("BarButtonItemLinkControl", "", 1).FindChild("Name",strTemp,50,True)
          If objNewWrkSpace_okbtn.Exists = True then
             If objNewWrkSpace_okbtn.Enabled = True then
              objNewWrkSpace_okbtn.Click
              strTCRemarks = strTCRemarks & "<br />" & "Add Folder is found in Source"
              log.Message "Add Folder is found in Source"
             Else
              strTCRemarks = strTCRemarks & "<br />" & "Add Folder is Disabled in Source"
              log.Message "Add Folder is Disabled in Source"
             End if
          Else
            strTCRemarks = strTCRemarks & "<br />" & "Add Folder is  not found in Source"
            log.Message "Add Folder is not found in Source"
          End If   
        
          
           Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 4).WPFObject("BarButtonItemLinkControl", "", 1)      
         Delay 8000,"New Folder..."

        ''Getting no. of Rows under level 2
        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count
        intK=intTotNodeCnt-1
    
        Set objDescCell=Aliases.EdgeClient.HwndSource_RibbonWindow.RibbonWindow.ContentControl.Grid.Grid.ContentControl.Grid.ContentControl.PART_ContainerContent.BarManager.DockPanel.DockLayoutManager.LayoutGroup.LayoutPanel2.Root.BarManager.AdornerDecorator.AdornedControl.Grid.DockPanel.SourceTreeListControl.SourceTreeListView.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK)
        Call objDescCell.Content.set_Description(DescText)
        strTCRemarks = strTCRemarks & "<br />" & "Description is added in new folder"
        log.Message "Description is added in new folder"
        
        Call objDescCell.Content.set_DescriptionLocal(DescLocalText)
        strTCRemarks = strTCRemarks & "<br />" & "Description local is added in new folder"
        log.Message "Description local is added in new folder"
            
        Delay 15000,"Pls Wait.."
        Call SClosesource()
        Delay 5000,"Pls Wait.."
                       
    End if
 
    strTemp="WPFObject(""SourceTreeListView"")"
    objEditSource=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WaitChild(strTemp,15000000)
    if objEditSource.Exists = True then
          sys.Keys("[Up]")
          Call sEdgeProcessor
          strTemp="WPFObject(""ContentControlEx"", ""Cut Folder"", 2)"
          Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 9).WPFObject("BarButtonItemLinkControl", "", 1).FindChild("Name",strTemp,50,True)
          If objNewWrkSpace_okbtn.Exists = True then
                
                If objNewWrkSpace_okbtn.Enabled = False then
                  strTCRemarks = strTCRemarks & "<br />" & "Cut Folder is disabled"
                  log.Message "Cut Folder is disabled"
                Else
                strTCRemarks = strTCRemarks & "<br />" & "Cut Folder only is Enabled"
                log.Message "Cut Folder is Enabled"
                objNewWrkSpace_okbtn.Click
                sys.Keys("[Up]")
                Call sEdgeProcessor
                
                set objEdgeFilter= Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 10).WPFObject("BarSubItemLinkControl", "", 1)
                strTemp="WPFObject(""ContentControlEx"", ""Paste Folder"", 2)"
                Set objTemp=objEdgeFilter.FindChild("Name",strTemp,50)
                If objTemp.Exists = TRUE then
                   If objTemp.Enabled = False then
                    strTCRemarks = strTCRemarks & "<br />" & "Paste Folder is disabled"
                    log.Message "Paste Folder is disabled"
                   Else
                    strTCRemarks = strTCRemarks & "<br />" & "Paste Folder is Enabled"
                    log.Message "Paste Folder is Enabled"
                    objTemp.Click
                    set objEdgeFilter= Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 3).WPFObject("BarButtonItemLinkControl", "", 1)
                    strTemp="WPFObject(""ContentControlEx"", ""Paste Below"", 2)"
                    Set objTemp=objEdgeFilter.FindChild("Name",strTemp,50)
                    If objTemp.Exists = TRUE then
                       If objTemp.Enabled = False then
                        strTCRemarks = strTCRemarks & "<br />" & "Paste Below is disabled"
                        log.Message "Paste Below is disabled"
                       Else
                        strTCRemarks = strTCRemarks & "<br />" & "Paste Below is Enabled"
                        log.Message "Paste Below is Enabled"
                        objTemp.Click
                        
                        strTemp="WPFObject(""PART_ContainerContent"")"
                        Set objConfirm=Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "Cut and paste source series").WPFObject("CustomMessageBoxWindow", "Cut and paste source series", 1).FindChild("Name",strTemp,50,True)
'                        strTemp="WPFObject(""DXMessageBox"", """", 1)"
'                        Set objConfirm=objConfirm.WaitChild(strTemp,180000)
                        If objConfirm.Exists = True then
                          Sys.Keys "[Enter]"
                          'Delay 30000,"Pls Wait.."
                          'Call sEdgeProcessor
                        End if
                       End if 
                    End If
                   End if 
                End If
        End if    
        End if 
    End if
    
    Dim objSaveWrk,objWait  
     set objSaveWrk=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 12).WPFObject("BarSubItemLinkControl", "", 1)
    strTemp="WPFObject(""ContentControlEx"", ""Workspace"", 2)"
    Set objTemp=objSaveWrk.FindChild("Name",strTemp,50)
    objWait=1
    Do until objTemp.Enabled = true 
        If objWait < 20 Then
          Delay 1000,"Pls Wait... Form is loading..."
          objWait=objWait+1
        else
          Call SClosesource()
          Call SourceWorkSpacevwr()
          Exit Sub
        end if 
    Loop 
    
    strTemp="WPFObject(""ContentControlEx"", ""Workspace"", 2)"
    Set objWrkSpace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,50,True)
    If objWrkSpace.Exists = True then
      Delay(1000)
      objWrkSpace.Click
      Delay(1000)
      strTemp="WPFObject(""PopupMenuBarControl"", """", 1)"
      Set objwrkspacepop=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").Findchild("Name",strTemp,50,True)
      'Set objwrkspacepop=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 2).WPFObject("BarButtonItemLinkControl", "", 1).WPFObject("ContentControlEx", "Upload Workspace", 2)
      If objwrkspacepop.Exists = True then
        strTemp="WPFObject(""ContentControlEx"", ""Upload Workspace"", 2)"
        set objwrkspcUpload=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).FindChild("Name",strTemp,50,True)
        If objwrkspcUpload.Exists = True then
          objwrkspcUpload.Click
          'Delay 1000,"Pls Wait.."
          strTemp="WPFObject(""PART_ContainerContent"")"
        Set objConfirm=Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "Confirm save.").FindChild("Name",strTemp,50,True)

          If objConfirm.Exists = True then
            Sys.Keys "[Enter]"
            'Delay 8000,"Uploading..."
            Set objConfirm = Sys.Process("EdgeClient")._
            Waitchild("WPFObject(""HwndSource: CustomMessageBoxWindow"", ""Upload Workspace"")",600000)._
            Waitchild("WPFObject(""CustomMessageBoxWindow"", ""Upload Workspace"", 1)",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""FloatingContainerBorder"")",60000)._
            Waitchild("WPFObject(""FloatingContainerBackground"")",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""FloatingContainerBody"")",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""PART_ContainerContent"")",60000)
            
            If objConfirm.Exists = True then
              Sys.Keys("O")
    'Delay 30000,"Pls Wait.."
              Call sEdgeProcessor
            End if
          End if
        End if
      End if
    End if
Call sHome_Source
    
    strTemp="WPFObject(""SourceTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""SourceTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    Delay 10000,"Pls Wait.."
    ''Selecting Country Name
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
          GridControl.Nodes_2.Item(intI).Expand(True)
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description       
          blnFlag=False  
          Exit For
        End If
    Next
    If blnFlag = True then
      strTCRemarks="Country Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
  
    Delay 10000,"Pls Wait.."
        blnFlag = True 
    ''Selecting Level2Source_Name
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
  For intJ=0 to intTotNodeCnt-1
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(StrSource2) then
        GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
        intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
'        Call GridSourceTree.ClickCell(intRow, "Edit")
        Call GridControl.ClearSelectionCore
        Call GridControl.FocusViewAndRow(GridControl,intRow)
        GridControl.SetFocusOnCurrentItem
        Call GridControl.SelectRowCore(intRow)
        log.Message "Level2 Source Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
        blnFlag = False 
        Exit For
      End If
    Next
    If blnFlag = True then
      log.Message "Level2 Source Name not found"
      strTCRemarks="Level2 Source Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
    
     Delay 10000,"Pls Wait.."
    blnFlag = True 
   
    Delay 2000,"Pls Wait.."

    strTemp="WPFObject(""ArrowControl"", """", 1)"
    Set objNewWorkspace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,20,True)
    If objNewWorkspace.Exists = True then
      objNewWorkspace.Click
       strTemp="WPFObject(""BarPopupBorderControl"", """", 1)"
      Set objWrkspace_popup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").FindChild("Name",strTemp,5,True)
      If objWrkspace_popup.Exists = True then
        strTemp="WPFObject(""ContentControlEx"", ""Open For Edit (Source)"", 2)"
        Set objopenforEdit=objWrkspace_popup.FindChild("Name",strTemp,8,True)
        If objopenforEdit.Exists then
          objopenforEdit.Click    
        End If
      End if
      
      strTemp1="WPFObject(""HwndSource: WorkspaceNamePrompt"", ""Please provide a new Workspace Name"")"
      Set objNewWrkSpaceName=Sys.Process("EdgeClient").WaitChild(strTemp1,50000)
      If objNewWrkSpaceName.Exists = True then
     
      ''Waiting for Workspace Name prompt
      strTemp="WPFObject(""FloatingContainerBorder"")"
      Set objNewWrkSpace_Name=Sys.Process("EdgeClient").WPFObject("HwndSource: WorkspaceNamePrompt", "Please provide a new Workspace Name").WPFObject("WorkspaceNamePrompt", "Please provide a new Workspace Name", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,15000000)
      If objNewWrkSpace_Name.Exists = True then
          strTemp="WPFObject(""ChangeNameTextEdit"")"
          ''Entering Workspace Name
          Set objNewWrkSpace_Txtbox=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
            If objNewWrkSpace_Txtbox.Exists = True then
              objNewWrkSpace_Txtbox.Click
              objNewWrkSpace_Txtbox.Text=strWrkSpaceName
      '        strTCRemarks=strTCRemarks & Chr(10) & "Entered Workspace Name - " & strWrkSpaceName
              ''Clicking on Ok Button 
              strTemp="WPFObject(""OkButton"")"
              Set objNewWrkSpace_okbtn=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
              If objNewWrkSpace_okbtn.Exists = True then
                objNewWrkSpace_okbtn.Click
                'Delay 5000,"Please wait..."
              End If
            End If
        End If
      End if 
     End if 
       
  
       ''Handling Validation for Source
    strTemp="WPFObject(""HwndSource: WindowContentHolder"", """")"
    Set objTemp=Sys.Process("EdgeClient").WaitChild(strTemp,10000)
    If objTemp.Exists = True then
      objTemp.Keys "[Enter]"
      strTestCaseResult = "FAIL"
      Exit Sub
    End If

    ''WorkSpace Edit Window
    strTemp="WPFObject(""LayoutPanel"", """", 2)"
    Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,13,True)
    If objTemp.Exists then
        Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WPFObject("SourceTreeListView")
        Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl")
       Delay 10000,"Pls Wait.."
        ''Expanding First Node in Tree      
        intTotNodeCnt=GridControl.Nodes_2.Count  
        For intI=0 to intTotNodeCnt-1         
          If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
           GridControl.Nodes_2.Item(intI).Expand(True)
           blnFlag=False  
           Exit For
          End If
        Next
         Delay 10000,"Pls Wait.."
        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
          For intJ=0 to intTotNodeCnt-1
            If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strSource2) then
              GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
              intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(0).get_RowHandle
              GridControl.Keys "^[Home]"
              Call GridControl.ClearSelectionCore
              Call GridControl.FocusViewAndRow(GridControl,intRow-1)
              GridControl.SetFocusOnCurrentItem
              Call GridControl.SelectRowCore(intRow-1)
        
              If objGridCell.Exists = True then
                objGridCell.Click
              End If
              blnFlag = False 
              Exit For
            End If
          Next
           Delay 10000,"Pls Wait.."
              intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count
               For intK=0 to intTotNodeCnt-1
                  If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description)=Ucase(DescText) then
                      intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).get_RowHandle
                      Call GridControl.ClearSelectionCore
                      GridControl.set_FocusedRowHandle(intRow)
                      Call GridControl.FocusViewAndRow(GridControl,intRow)
                      GridControl.SetFocusOnCurrentItem
                      Call GridControl.SelectRowCore(intRow)
                      strTCRemarks = strTCRemarks & "<br />" & " Folder is found in Source"
                      log.Message "Folder is  found in Source"
                      Exit For   
                  else
                    strTCRemarks = strTCRemarks & "<br />" & "Folder is not found in Source"
                    log.Message "Folder is not found in Source"
                    Exit For   
                  End If 
               Next
               
      Call SClosesource()
      Delay 5000,"Pls Wait.."
      Call SClosesource()
      Call SourceWorkSpacevwr()
    End if

End Sub
Sub sChkSrcCutPasteInside(strParameters)
On Error Resume Next 
   Dim strSource1,StrSource2,strSource3,strTemp,GridControl,GridSourceTree,intTotNodeCnt,intI,intJ,intRow,intK,objEdge
   Dim objNewWorkspace,objWrkspace_popup,objOpenView,strTemp1,objNewWrkSpaceName,objNewWrkSpace_Txtbox,objNewWrkSpace_okbtn,objNewWrkSpace_Name
   Dim strDesc1,strDesc2,DescText,DescLocalText
   Dim objEditSource
   Dim objTemp, objStrClose
   Dim objEdgeFilter
   
    strSource1=getSplitValue(strParameters,"SOURCE")
    StrSource2=getSplitValue(strParameters,"LEVEL2SOURCE")
    StrSource3=getSplitValue(strParameters,"LEVEL3SOURCE")
    
'    strSource1="Test"
'    StrSource2="Automation_UIT2"
'    StrSource3="Test"

    Call sHome_Source
    
    strDesc1=aqDateTime.Now
    strDesc2=aqDateTime.Now
    DescText=Replace(strDesc1,"/","-")
    DescText=Replace(DescText,":","_")
    DescLocalText=DescText
    strWrkSpaceName=DescText
'    intSeriesID=getSplitValue(strParameters,"SERIESID")
'    if intSeriesID=0 then
'      Call sSourceseries
'      intSeriesID=strSourceFileText
'    End if 
    
    strTemp="WPFObject(""SourceTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""SourceTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    Delay 10000,"Pls Wait.."
    ''Selecting Country Name
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
          GridControl.Nodes_2.Item(intI).Expand(True)
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description       
          blnFlag=False  
          Exit For
        End If
    Next
    If blnFlag = True then
      strTCRemarks="Country Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
  
    Delay 10000,"Pls Wait.."
        blnFlag = True 
    ''Selecting Level2Source_Name
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
  For intJ=0 to intTotNodeCnt-1
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(StrSource2) then
        GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
        intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
'        Call GridSourceTree.ClickCell(intRow, "Edit")
        Call GridControl.ClearSelectionCore
        Call GridControl.FocusViewAndRow(GridControl,intRow)
        GridControl.SetFocusOnCurrentItem
        Call GridControl.SelectRowCore(intRow)
        log.Message "Level2 Source Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
        blnFlag = False 
        Exit For
      End If
    Next
    If blnFlag = True then
      log.Message "Level2 Source Name not found"
      strTCRemarks="Level2 Source Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
    
     Delay 10000,"Pls Wait.."
    blnFlag = True 
   
    Delay 2000,"Pls Wait.."

    strTemp="WPFObject(""ArrowControl"", """", 1)"
    Set objNewWorkspace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,20,True)
    If objNewWorkspace.Exists = True then
      objNewWorkspace.Click
       strTemp="WPFObject(""BarPopupBorderControl"", """", 1)"
      Set objWrkspace_popup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").FindChild("Name",strTemp,5,True)
      If objWrkspace_popup.Exists = True then
        strTemp="WPFObject(""ContentControlEx"", ""Open For Edit (Source)"", 2)"
        Set objopenforEdit=objWrkspace_popup.FindChild("Name",strTemp,8,True)
        If objopenforEdit.Exists then
          objopenforEdit.Click    
        End If
      End if
      
      strTemp1="WPFObject(""HwndSource: WorkspaceNamePrompt"", ""Please provide a new Workspace Name"")"
      Set objNewWrkSpaceName=Sys.Process("EdgeClient").WaitChild(strTemp1,50000)
      If objNewWrkSpaceName.Exists = True then
     
      ''Waiting for Workspace Name prompt
      strTemp="WPFObject(""FloatingContainerBorder"")"
      Set objNewWrkSpace_Name=Sys.Process("EdgeClient").WPFObject("HwndSource: WorkspaceNamePrompt", "Please provide a new Workspace Name").WPFObject("WorkspaceNamePrompt", "Please provide a new Workspace Name", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,15000000)
      If objNewWrkSpace_Name.Exists = True then
          strTemp="WPFObject(""ChangeNameTextEdit"")"
          ''Entering Workspace Name
          Set objNewWrkSpace_Txtbox=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
            If objNewWrkSpace_Txtbox.Exists = True then
              objNewWrkSpace_Txtbox.Click
              objNewWrkSpace_Txtbox.Text=strWrkSpaceName
      '        strTCRemarks=strTCRemarks & Chr(10) & "Entered Workspace Name - " & strWrkSpaceName
              ''Clicking on Ok Button 
              strTemp="WPFObject(""OkButton"")"
              Set objNewWrkSpace_okbtn=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
              If objNewWrkSpace_okbtn.Exists = True then
                objNewWrkSpace_okbtn.Click
                'Delay 5000,"Please wait..."
              End If
            End If
        End If
      End if 
     End if 
       
  
       ''Handling Validation for Source
    strTemp="WPFObject(""HwndSource: WindowContentHolder"", """")"
    Set objTemp=Sys.Process("EdgeClient").WaitChild(strTemp,10000)
    If objTemp.Exists = True then
      objTemp.Keys "[Enter]"
      strTestCaseResult = "FAIL"
      Exit Sub
    End If

    ''WorkSpace Edit Window
    strTemp="WPFObject(""LayoutPanel"", """", 2)"
    Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,13,True)
    If objTemp.Exists then
        Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WPFObject("SourceTreeListView")
        Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl")
       Delay 10000,"Pls Wait.."
        ''Expanding First Node in Tree      
        intTotNodeCnt=GridControl.Nodes_2.Count  
        For intI=0 to intTotNodeCnt-1         
          If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
           GridControl.Nodes_2.Item(intI).Expand(True)
           blnFlag=False  
           Exit For
          End If
        Next
         Delay 10000,"Pls Wait.."
        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
          For intJ=0 to intTotNodeCnt-1
            If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strSource2) then
              GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
              intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(0).get_RowHandle
              GridControl.Keys "^[Home]"
              Call GridControl.ClearSelectionCore
              Call GridControl.FocusViewAndRow(GridControl,intRow-1)
              GridControl.SetFocusOnCurrentItem
              Call GridControl.SelectRowCore(intRow-1)
        
              If objGridCell.Exists = True then
                objGridCell.Click
              End If
              blnFlag = False 
              Exit For
            End If
          Next
'           Delay 10000,"Pls Wait.."
'              intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count
'               For intK=0 to intTotNodeCnt-1
'                  If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description)=Ucase(strSource3) then
'                      intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).get_RowHandle
'                      Call GridControl.ClearSelectionCore
'                      GridControl.set_FocusedRowHandle(intRow)
'                      Call GridControl.FocusViewAndRow(GridControl,intRow)
'                      GridControl.SetFocusOnCurrentItem
'                      Call GridControl.SelectRowCore(intRow)
'                      Exit For   
'                  End If 
'               Next
    End if
            
    strTemp="WPFObject(""SourceTreeListView"")"
    objEditSource=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WaitChild(strTemp,15000000)
    if objEditSource.Exists = True then

          strTemp="WPFObject(""ContentControlEx"", ""Add Folder"", 2)"
          Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 4).WPFObject("BarButtonItemLinkControl", "", 1).FindChild("Name",strTemp,50,True)
          If objNewWrkSpace_okbtn.Exists = True then
             If objNewWrkSpace_okbtn.Enabled = True then
              objNewWrkSpace_okbtn.Click
              strTCRemarks = strTCRemarks & "<br />" & "Add Folder is found in Source"
              log.Message "Add Folder is found in Source"
             Else
              strTCRemarks = strTCRemarks & "<br />" & "Add Folder is Disabled in Source"
              log.Message "Add Folder is Disabled in Source"
             End if
          Else
            strTCRemarks = strTCRemarks & "<br />" & "Add Folder is  not found in Source"
            log.Message "Add Folder is not found in Source"
          End If   
        
          
           Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 4).WPFObject("BarButtonItemLinkControl", "", 1)      
         Delay 8000,"New Folder..."

        ''Getting no. of Rows under level 2
        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count
        intK=intTotNodeCnt-1
    
        Set objDescCell=Aliases.EdgeClient.HwndSource_RibbonWindow.RibbonWindow.ContentControl.Grid.Grid.ContentControl.Grid.ContentControl.PART_ContainerContent.BarManager.DockPanel.DockLayoutManager.LayoutGroup.LayoutPanel2.Root.BarManager.AdornerDecorator.AdornedControl.Grid.DockPanel.SourceTreeListControl.SourceTreeListView.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK)
        Call objDescCell.Content.set_Description(DescText)
        strTCRemarks = strTCRemarks & "<br />" & "Description is added in new folder"
        log.Message "Description is added in new folder"
        
        Call objDescCell.Content.set_DescriptionLocal(DescLocalText)
        strTCRemarks = strTCRemarks & "<br />" & "Description local is added in new folder"
        log.Message "Description local is added in new folder"
            
        Delay 15000,"Pls Wait.."
        Call SClosesource()
        Delay 5000,"Pls Wait.."
                       
    End if
 
    strTemp="WPFObject(""SourceTreeListView"")"
    objEditSource=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WaitChild(strTemp,15000000)
    if objEditSource.Exists = True then
          sys.Keys("[Up]")
          Call sEdgeProcessor
          strTemp="WPFObject(""ContentControlEx"", ""Cut Folder"", 2)"
          Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 9).WPFObject("BarButtonItemLinkControl", "", 1).FindChild("Name",strTemp,50,True)
          If objNewWrkSpace_okbtn.Exists = True then
                
                If objNewWrkSpace_okbtn.Enabled = False then
                  strTCRemarks = strTCRemarks & "<br />" & "Cut Folder is disabled"
                  log.Message "Cut Folder is disabled"
                Else
                strTCRemarks = strTCRemarks & "<br />" & "Cut Folder only is Enabled"
                log.Message "Cut Folder is Enabled"
                objNewWrkSpace_okbtn.Click
                sys.Keys("[Up]")
                Call sEdgeProcessor
                
                set objEdgeFilter= Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 10).WPFObject("BarSubItemLinkControl", "", 1)
                strTemp="WPFObject(""ContentControlEx"", ""Paste Folder"", 2)"
                Set objTemp=objEdgeFilter.FindChild("Name",strTemp,50)
                If objTemp.Exists = TRUE then
                   If objTemp.Enabled = False then
                    strTCRemarks = strTCRemarks & "<br />" & "Paste Folder is disabled"
                    log.Message "Paste Folder is disabled"
                   Else
                    strTCRemarks = strTCRemarks & "<br />" & "Paste Folder is Enabled"
                    log.Message "Paste Folder is Enabled"
                    objTemp.Click
                   set objEdgeFilter= Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 2).WPFObject("BarButtonItemLinkControl", "", 1)
                    strTemp="WPFObject(""ContentControlEx"", ""Paste Inside"", 2)"
                    Set objTemp=objEdgeFilter.FindChild("Name",strTemp,50)
                    If objTemp.Exists = TRUE then
                       If objTemp.Enabled = False then
                        strTCRemarks = strTCRemarks & "<br />" & "Paste Inside is disabled"
                        log.Message "Paste Inside is disabled"
                       Else
                        strTCRemarks = strTCRemarks & "<br />" & "Paste Inside is Enabled"
                        log.Message "Paste Inside is Enabled"
                        objTemp.Click
                        
                        strTemp="WPFObject(""PART_ContainerContent"")"
                        Set objConfirm=Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "Cut and paste source series").WPFObject("CustomMessageBoxWindow", "Cut and paste source series", 1).FindChild("Name",strTemp,50,True)
'                        strTemp="WPFObject(""DXMessageBox"", """", 1)"
'                        Set objConfirm=objConfirm.WaitChild(strTemp,180000)
                        If objConfirm.Exists = True then
                          Sys.Keys "[Enter]"
                          'Delay 30000,"Pls Wait.."
                          'Call sEdgeProcessor
                        End if
                       End if 
                    End If
                   End if 
                End If
        End if    
        End if 
    End if
    
    Dim objSaveWrk,objWait  
     set objSaveWrk=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 12).WPFObject("BarSubItemLinkControl", "", 1)
    strTemp="WPFObject(""ContentControlEx"", ""Workspace"", 2)"
    Set objTemp=objSaveWrk.FindChild("Name",strTemp,50)
    objWait=1
    Do until objTemp.Enabled = true 
        If objWait < 20 Then
          Delay 1000,"Pls Wait... Form is loading..."
          objWait=objWait+1
        else
          Call SClosesource()
          Call SourceWorkSpacevwr()
          Exit Sub
        end if 
    Loop 
    
    strTemp="WPFObject(""ContentControlEx"", ""Workspace"", 2)"
    Set objWrkSpace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,50,True)
    If objWrkSpace.Exists = True then
      Delay(1000)
      objWrkSpace.Click
      Delay(1000)
      strTemp="WPFObject(""PopupMenuBarControl"", """", 1)"
      Set objwrkspacepop=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").Findchild("Name",strTemp,50,True)
      'Set objwrkspacepop=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 2).WPFObject("BarButtonItemLinkControl", "", 1).WPFObject("ContentControlEx", "Upload Workspace", 2)
      If objwrkspacepop.Exists = True then
        strTemp="WPFObject(""ContentControlEx"", ""Upload Workspace"", 2)"
        set objwrkspcUpload=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).FindChild("Name",strTemp,50,True)
        If objwrkspcUpload.Exists = True then
          objwrkspcUpload.Click
          'Delay 1000,"Pls Wait.."
          strTemp="WPFObject(""PART_ContainerContent"")"
        Set objConfirm=Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "Confirm save.").FindChild("Name",strTemp,50,True)

          If objConfirm.Exists = True then
            Sys.Keys "[Enter]"
            'Delay 8000,"Uploading..."
            Set objConfirm = Sys.Process("EdgeClient")._
            Waitchild("WPFObject(""HwndSource: CustomMessageBoxWindow"", ""Upload Workspace"")",600000)._
            Waitchild("WPFObject(""CustomMessageBoxWindow"", ""Upload Workspace"", 1)",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""FloatingContainerBorder"")",60000)._
            Waitchild("WPFObject(""FloatingContainerBackground"")",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""FloatingContainerBody"")",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""PART_ContainerContent"")",60000)
            
            If objConfirm.Exists = True then
              Sys.Keys("O")

              'Delay 30000,"Pls Wait.."
              Call sEdgeProcessor
            End if
          End if
        End if
      End if
    End if
Call sHome_Source
    
    strTemp="WPFObject(""SourceTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""SourceTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    Delay 10000,"Pls Wait.."
    ''Selecting Country Name
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
          GridControl.Nodes_2.Item(intI).Expand(True)
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description       
          blnFlag=False  
          Exit For
        End If
    Next
    If blnFlag = True then
      strTCRemarks="Country Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
  
    Delay 10000,"Pls Wait.."
        blnFlag = True 
    ''Selecting Level2Source_Name
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
  For intJ=0 to intTotNodeCnt-1
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(StrSource2) then
        GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
        intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
'        Call GridSourceTree.ClickCell(intRow, "Edit")
        Call GridControl.ClearSelectionCore
        Call GridControl.FocusViewAndRow(GridControl,intRow)
        GridControl.SetFocusOnCurrentItem
        Call GridControl.SelectRowCore(intRow)
        log.Message "Level2 Source Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
        blnFlag = False 
        Exit For
      End If
    Next
    If blnFlag = True then
      log.Message "Level2 Source Name not found"
      strTCRemarks="Level2 Source Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
    
     Delay 10000,"Pls Wait.."
    blnFlag = True 
   
    Delay 2000,"Pls Wait.."

    strTemp="WPFObject(""ArrowControl"", """", 1)"
    Set objNewWorkspace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,20,True)
    If objNewWorkspace.Exists = True then
      objNewWorkspace.Click
       strTemp="WPFObject(""BarPopupBorderControl"", """", 1)"
      Set objWrkspace_popup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").FindChild("Name",strTemp,5,True)
      If objWrkspace_popup.Exists = True then
        strTemp="WPFObject(""ContentControlEx"", ""Open For Edit (Source)"", 2)"
        Set objopenforEdit=objWrkspace_popup.FindChild("Name",strTemp,8,True)
        If objopenforEdit.Exists then
          objopenforEdit.Click    
        End If
      End if
      
      strTemp1="WPFObject(""HwndSource: WorkspaceNamePrompt"", ""Please provide a new Workspace Name"")"
      Set objNewWrkSpaceName=Sys.Process("EdgeClient").WaitChild(strTemp1,50000)
      If objNewWrkSpaceName.Exists = True then
     
      ''Waiting for Workspace Name prompt
      strTemp="WPFObject(""FloatingContainerBorder"")"
      Set objNewWrkSpace_Name=Sys.Process("EdgeClient").WPFObject("HwndSource: WorkspaceNamePrompt", "Please provide a new Workspace Name").WPFObject("WorkspaceNamePrompt", "Please provide a new Workspace Name", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,15000000)
      If objNewWrkSpace_Name.Exists = True then
          strTemp="WPFObject(""ChangeNameTextEdit"")"
          ''Entering Workspace Name
          Set objNewWrkSpace_Txtbox=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
            If objNewWrkSpace_Txtbox.Exists = True then
              objNewWrkSpace_Txtbox.Click
              objNewWrkSpace_Txtbox.Text=strWrkSpaceName
      '        strTCRemarks=strTCRemarks & Chr(10) & "Entered Workspace Name - " & strWrkSpaceName
              ''Clicking on Ok Button 
              strTemp="WPFObject(""OkButton"")"
              Set objNewWrkSpace_okbtn=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
              If objNewWrkSpace_okbtn.Exists = True then
                objNewWrkSpace_okbtn.Click
                'Delay 5000,"Please wait..."
              End If
            End If
        End If
      End if 
     End if 
       
  
       ''Handling Validation for Source
    strTemp="WPFObject(""HwndSource: WindowContentHolder"", """")"
    Set objTemp=Sys.Process("EdgeClient").WaitChild(strTemp,10000)
    If objTemp.Exists = True then
      objTemp.Keys "[Enter]"
      strTestCaseResult = "FAIL"
      Exit Sub
    End If

    ''WorkSpace Edit Window
    strTemp="WPFObject(""LayoutPanel"", """", 2)"
    Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,13,True)
    If objTemp.Exists then
        Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WPFObject("SourceTreeListView")
        Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl")
       Delay 10000,"Pls Wait.."
        ''Expanding First Node in Tree      
        intTotNodeCnt=GridControl.Nodes_2.Count  
        For intI=0 to intTotNodeCnt-1         
          If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
           GridControl.Nodes_2.Item(intI).Expand(True)
           blnFlag=False  
           Exit For
          End If
        Next
         Delay 10000,"Pls Wait.."
        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
          For intJ=0 to intTotNodeCnt-1
            If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strSource2) then
              GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
              intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(0).get_RowHandle
              GridControl.Keys "^[Home]"
              Call GridControl.ClearSelectionCore
              Call GridControl.FocusViewAndRow(GridControl,intRow-1)
              GridControl.SetFocusOnCurrentItem
              Call GridControl.SelectRowCore(intRow-1)
        
              If objGridCell.Exists = True then
                objGridCell.Click
              End If
              blnFlag = False 
              Exit For
            End If
          Next
           Delay 10000,"Pls Wait.."
              intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count
               For intK=0 to intTotNodeCnt-1
                  If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description)=Ucase(DescText) then
                      intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).get_RowHandle
                      Call GridControl.ClearSelectionCore
                      GridControl.set_FocusedRowHandle(intRow)
                      Call GridControl.FocusViewAndRow(GridControl,intRow)
                      GridControl.SetFocusOnCurrentItem
                      Call GridControl.SelectRowCore(intRow)
                      strTCRemarks = strTCRemarks & "<br />" & " Folder is found in Source"
                      log.Message "Folder is  found in Source"
                      Exit For   
                  else
                    strTCRemarks = strTCRemarks & "<br />" & "Folder is not found in Source"
                    log.Message "Folder is not found in Source"
                    Exit For   
                  End If 
               Next
               
      Call SClosesource()
      Delay 5000,"Pls Wait.."
      Call SClosesource()
      Call SourceWorkSpacevwr()
    End if
End Sub

Sub sChkSrcCopyPasteSH(strParameters)
On Error Resume Next 
   Dim strSource1,StrSource2,strSource3,strTemp,GridControl,GridSourceTree,intTotNodeCnt,intI,intJ,intRow,intK,objEdge
   Dim objNewWorkspace,objWrkspace_popup,objOpenView,strTemp1,objNewWrkSpaceName,objNewWrkSpace_Txtbox,objNewWrkSpace_okbtn,objNewWrkSpace_Name
   Dim strDesc1,strDesc2,DescText,DescLocalText
   Dim objEditSource
   Dim objTemp, objStrClose
   Dim objEdgeFilter
   
    strSource1=getSplitValue(strParameters,"SOURCE")
    StrSource2=getSplitValue(strParameters,"LEVEL2SOURCE")
    StrSource3=getSplitValue(strParameters,"LEVEL3SOURCE")
    
'    strSource1="Test"
'    StrSource2="Automation_UIT2"
'    StrSource3="Test"

    Call sHome_Source
    
    strDesc1=aqDateTime.Now
    strDesc2=aqDateTime.Now
    DescText=Replace(strDesc1,"/","-")
    DescText=Replace(DescText,":","_")
    DescLocalText=DescText
    strWrkSpaceName=DescText
'    intSeriesID=getSplitValue(strParameters,"SERIESID")
'    if intSeriesID=0 then
'      Call sSourceseries
'      intSeriesID=strSourceFileText
'    End if 
    
    strTemp="WPFObject(""SourceTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""SourceTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    Delay 10000,"Pls Wait.."
    ''Selecting Country Name
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
          GridControl.Nodes_2.Item(intI).Expand(True)
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description       
          blnFlag=False  
          Exit For
        End If
    Next
    If blnFlag = True then
      strTCRemarks="Country Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
  
    Delay 10000,"Pls Wait.."
        blnFlag = True 
    ''Selecting Level2Source_Name
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
  For intJ=0 to intTotNodeCnt-1
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(StrSource2) then
        GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
        intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
'        Call GridSourceTree.ClickCell(intRow, "Edit")
        Call GridControl.ClearSelectionCore
        Call GridControl.FocusViewAndRow(GridControl,intRow)
        GridControl.SetFocusOnCurrentItem
        Call GridControl.SelectRowCore(intRow)
        log.Message "Level2 Source Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
        blnFlag = False 
        Exit For
      End If
    Next
    If blnFlag = True then
      log.Message "Level2 Source Name not found"
      strTCRemarks="Level2 Source Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
    
     Delay 10000,"Pls Wait.."
    blnFlag = True 
   
    Delay 2000,"Pls Wait.."

    strTemp="WPFObject(""ArrowControl"", """", 1)"
    Set objNewWorkspace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,20,True)
    If objNewWorkspace.Exists = True then
      objNewWorkspace.Click
       strTemp="WPFObject(""BarPopupBorderControl"", """", 1)"
      Set objWrkspace_popup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").FindChild("Name",strTemp,5,True)
      If objWrkspace_popup.Exists = True then
        strTemp="WPFObject(""ContentControlEx"", ""Open For Edit (Source)"", 2)"
        Set objopenforEdit=objWrkspace_popup.FindChild("Name",strTemp,8,True)
        If objopenforEdit.Exists then
          objopenforEdit.Click    
        End If
      End if
      
      strTemp1="WPFObject(""HwndSource: WorkspaceNamePrompt"", ""Please provide a new Workspace Name"")"
      Set objNewWrkSpaceName=Sys.Process("EdgeClient").WaitChild(strTemp1,50000)
      If objNewWrkSpaceName.Exists = True then
     
      ''Waiting for Workspace Name prompt
      strTemp="WPFObject(""FloatingContainerBorder"")"
      Set objNewWrkSpace_Name=Sys.Process("EdgeClient").WPFObject("HwndSource: WorkspaceNamePrompt", "Please provide a new Workspace Name").WPFObject("WorkspaceNamePrompt", "Please provide a new Workspace Name", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,15000000)
      If objNewWrkSpace_Name.Exists = True then
          strTemp="WPFObject(""ChangeNameTextEdit"")"
          ''Entering Workspace Name
          Set objNewWrkSpace_Txtbox=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
            If objNewWrkSpace_Txtbox.Exists = True then
              objNewWrkSpace_Txtbox.Click
              objNewWrkSpace_Txtbox.Text=strWrkSpaceName
      '        strTCRemarks=strTCRemarks & Chr(10) & "Entered Workspace Name - " & strWrkSpaceName
              ''Clicking on Ok Button 
              strTemp="WPFObject(""OkButton"")"
              Set objNewWrkSpace_okbtn=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
              If objNewWrkSpace_okbtn.Exists = True then
                objNewWrkSpace_okbtn.Click
                'Delay 5000,"Please wait..."
              End If
            End If
        End If
      End if 
     End if 
       
  
       ''Handling Validation for Source
    strTemp="WPFObject(""HwndSource: WindowContentHolder"", """")"
    Set objTemp=Sys.Process("EdgeClient").WaitChild(strTemp,10000)
    If objTemp.Exists = True then
      objTemp.Keys "[Enter]"
      strTestCaseResult = "FAIL"
      Exit Sub
    End If

    ''WorkSpace Edit Window
    strTemp="WPFObject(""LayoutPanel"", """", 2)"
    Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,13,True)
    If objTemp.Exists then
        Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WPFObject("SourceTreeListView")
        Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl")
       Delay 10000,"Pls Wait.."
        ''Expanding First Node in Tree      
        intTotNodeCnt=GridControl.Nodes_2.Count  
        For intI=0 to intTotNodeCnt-1         
          If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
           GridControl.Nodes_2.Item(intI).Expand(True)
           blnFlag=False  
           Exit For
          End If
        Next
         Delay 10000,"Pls Wait.."
        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
          For intJ=0 to intTotNodeCnt-1
            If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strSource2) then
              GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
              intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(0).get_RowHandle
              GridControl.Keys "^[Home]"
              Call GridControl.ClearSelectionCore
              Call GridControl.FocusViewAndRow(GridControl,intRow-1)
              GridControl.SetFocusOnCurrentItem
              Call GridControl.SelectRowCore(intRow-1)
        
              If objGridCell.Exists = True then
                objGridCell.Click
              End If
              blnFlag = False 
              Exit For
            End If
          Next
    End if
            
    strTemp="WPFObject(""SourceTreeListView"")"
    objEditSource=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WaitChild(strTemp,15000000)
    if objEditSource.Exists = True then

          strTemp="WPFObject(""ContentControlEx"", ""Add Folder"", 2)"
          Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 4).WPFObject("BarButtonItemLinkControl", "", 1).FindChild("Name",strTemp,50,True)
          If objNewWrkSpace_okbtn.Exists = True then
             If objNewWrkSpace_okbtn.Enabled = True then
              objNewWrkSpace_okbtn.Click
              strTCRemarks = strTCRemarks & "<br />" & "Add Folder is found in Source"
              log.Message "Add Folder is found in Source"
             Else
              strTCRemarks = strTCRemarks & "<br />" & "Add Folder is Disabled in Source"
              log.Message "Add Folder is Disabled in Source"
             End if
          Else
            strTCRemarks = strTCRemarks & "<br />" & "Add Folder is  not found in Source"
            log.Message "Add Folder is not found in Source"
          End If   
        
          
           Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 4).WPFObject("BarButtonItemLinkControl", "", 1)      
         Delay 8000,"New Folder..."

        ''Getting no. of Rows under level 2
        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count
        intK=intTotNodeCnt-1
    
        Set objDescCell=Aliases.EdgeClient.HwndSource_RibbonWindow.RibbonWindow.ContentControl.Grid.Grid.ContentControl.Grid.ContentControl.PART_ContainerContent.BarManager.DockPanel.DockLayoutManager.LayoutGroup.LayoutPanel2.Root.BarManager.AdornerDecorator.AdornedControl.Grid.DockPanel.SourceTreeListControl.SourceTreeListView.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK)
        Call objDescCell.Content.set_Description(DescText)
        strTCRemarks = strTCRemarks & "<br />" & "Description is added in new folder"
        log.Message "Description is added in new folder"
        
        Call objDescCell.Content.set_DescriptionLocal(DescLocalText)
        strTCRemarks = strTCRemarks & "<br />" & "Description local is added in new folder"
        log.Message "Description local is added in new folder"
            
        Delay 15000,"Pls Wait.."
        Call SClosesource()
        Delay 5000,"Pls Wait.."
        
        
                   
    End if
 
    strTemp="WPFObject(""SourceTreeListView"")"
    objEditSource=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WaitChild(strTemp,15000000)
    if objEditSource.Exists = True then
          sys.Keys("[Up]")
           Call sEdgeProcessor

                sys.Keys("^f")
                sys.Keys("[Down]")
                Call sEdgeProcessor
                sys.Keys("^i")
                
    End if
    
    Dim objSaveWrk,objWait  
     set objSaveWrk=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 12).WPFObject("BarSubItemLinkControl", "", 1)
    strTemp="WPFObject(""ContentControlEx"", ""Workspace"", 2)"
    Set objTemp=objSaveWrk.FindChild("Name",strTemp,50)
    objWait=1
    Do until objTemp.Enabled = true 
        If objWait < 20 Then
          Delay 1000,"Pls Wait... Form is loading..."
          objWait=objWait+1
        else
          Call SClosesource()
          Call SourceWorkSpacevwr()
          Exit Sub
        end if 
    Loop  
    
    strTemp="WPFObject(""ContentControlEx"", ""Workspace"", 2)"
    Set objWrkSpace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,50,True)
    If objWrkSpace.Exists = True then
      Delay(1000)
      objWrkSpace.Click
      Delay(1000)
      strTemp="WPFObject(""PopupMenuBarControl"", """", 1)"
      Set objwrkspacepop=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").Findchild("Name",strTemp,50,True)
      'Set objwrkspacepop=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 2).WPFObject("BarButtonItemLinkControl", "", 1).WPFObject("ContentControlEx", "Upload Workspace", 2)
      If objwrkspacepop.Exists = True then
        strTemp="WPFObject(""ContentControlEx"", ""Upload Workspace"", 2)"
        set objwrkspcUpload=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).FindChild("Name",strTemp,50,True)
        If objwrkspcUpload.Exists = True then
          objwrkspcUpload.Click
          'Delay 1000,"Pls Wait.."
          strTemp="WPFObject(""PART_ContainerContent"")"
        Set objConfirm=Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "Confirm save.").FindChild("Name",strTemp,50,True)

          If objConfirm.Exists = True then
            Sys.Keys "[Enter]"
            'Delay 8000,"Uploading..."
            Set objConfirm = Sys.Process("EdgeClient")._
            Waitchild("WPFObject(""HwndSource: CustomMessageBoxWindow"", ""Upload Workspace"")",600000)._
            Waitchild("WPFObject(""CustomMessageBoxWindow"", ""Upload Workspace"", 1)",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""FloatingContainerBorder"")",60000)._
            Waitchild("WPFObject(""FloatingContainerBackground"")",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""FloatingContainerBody"")",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""PART_ContainerContent"")",60000)
            
            If objConfirm.Exists = True then
              Sys.Keys("O")

              'Delay 30000,"Pls Wait.."
              Call sEdgeProcessor
            End if
          End if
        End if
      End if
    End if

End Sub

Sub sChkSrcCopyPasteBelowSH(strParameters)
On Error Resume Next 
   Dim strSource1,StrSource2,strSource3,strTemp,GridControl,GridSourceTree,intTotNodeCnt,intI,intJ,intRow,intK,objEdge
   Dim objNewWorkspace,objWrkspace_popup,objOpenView,strTemp1,objNewWrkSpaceName,objNewWrkSpace_Txtbox,objNewWrkSpace_okbtn,objNewWrkSpace_Name
   Dim strDesc1,strDesc2,DescText,DescLocalText
   Dim objEditSource
   Dim objTemp, objStrClose
   Dim objEdgeFilter
   
    strSource1=getSplitValue(strParameters,"SOURCE")
    StrSource2=getSplitValue(strParameters,"LEVEL2SOURCE")
    StrSource3=getSplitValue(strParameters,"LEVEL3SOURCE")
    
'    strSource1="Test"
'    StrSource2="Automation_UIT2"
'    StrSource3="Test"

    Call sHome_Source
    
    strDesc1=aqDateTime.Now
    strDesc2=aqDateTime.Now
    DescText=Replace(strDesc1,"/","-")
    DescText=Replace(DescText,":","_")
    DescLocalText=DescText
    strWrkSpaceName=DescText
'    intSeriesID=getSplitValue(strParameters,"SERIESID")
'    if intSeriesID=0 then
'      Call sSourceseries
'      intSeriesID=strSourceFileText
'    End if 
    
    strTemp="WPFObject(""SourceTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""SourceTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    Delay 10000,"Pls Wait.."
    ''Selecting Country Name
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
          GridControl.Nodes_2.Item(intI).Expand(True)
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description       
          blnFlag=False  
          Exit For
        End If
    Next
    If blnFlag = True then
      strTCRemarks="Country Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
  
    Delay 10000,"Pls Wait.."
        blnFlag = True 
    ''Selecting Level2Source_Name
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
  For intJ=0 to intTotNodeCnt-1
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(StrSource2) then
        GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
        intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
'        Call GridSourceTree.ClickCell(intRow, "Edit")
        Call GridControl.ClearSelectionCore
        Call GridControl.FocusViewAndRow(GridControl,intRow)
        GridControl.SetFocusOnCurrentItem
        Call GridControl.SelectRowCore(intRow)
        log.Message "Level2 Source Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
        blnFlag = False 
        Exit For
      End If
    Next
    If blnFlag = True then
      log.Message "Level2 Source Name not found"
      strTCRemarks="Level2 Source Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
    
     Delay 10000,"Pls Wait.."
    blnFlag = True 
   
    Delay 2000,"Pls Wait.."

    strTemp="WPFObject(""ArrowControl"", """", 1)"
    Set objNewWorkspace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,20,True)
    If objNewWorkspace.Exists = True then
      objNewWorkspace.Click
       strTemp="WPFObject(""BarPopupBorderControl"", """", 1)"
      Set objWrkspace_popup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").FindChild("Name",strTemp,5,True)
      If objWrkspace_popup.Exists = True then
        strTemp="WPFObject(""ContentControlEx"", ""Open For Edit (Source)"", 2)"
        Set objopenforEdit=objWrkspace_popup.FindChild("Name",strTemp,8,True)
        If objopenforEdit.Exists then
          objopenforEdit.Click    
        End If
      End if
      
      strTemp1="WPFObject(""HwndSource: WorkspaceNamePrompt"", ""Please provide a new Workspace Name"")"
      Set objNewWrkSpaceName=Sys.Process("EdgeClient").WaitChild(strTemp1,50000)
      If objNewWrkSpaceName.Exists = True then
     
      ''Waiting for Workspace Name prompt
      strTemp="WPFObject(""FloatingContainerBorder"")"
      Set objNewWrkSpace_Name=Sys.Process("EdgeClient").WPFObject("HwndSource: WorkspaceNamePrompt", "Please provide a new Workspace Name").WPFObject("WorkspaceNamePrompt", "Please provide a new Workspace Name", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,15000000)
      If objNewWrkSpace_Name.Exists = True then
          strTemp="WPFObject(""ChangeNameTextEdit"")"
          ''Entering Workspace Name
          Set objNewWrkSpace_Txtbox=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
            If objNewWrkSpace_Txtbox.Exists = True then
              objNewWrkSpace_Txtbox.Click
              objNewWrkSpace_Txtbox.Text=strWrkSpaceName
      '        strTCRemarks=strTCRemarks & Chr(10) & "Entered Workspace Name - " & strWrkSpaceName
              ''Clicking on Ok Button 
              strTemp="WPFObject(""OkButton"")"
              Set objNewWrkSpace_okbtn=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
              If objNewWrkSpace_okbtn.Exists = True then
                objNewWrkSpace_okbtn.Click
                'Delay 5000,"Please wait..."
              End If
            End If
        End If
      End if 
     End if 
       
  
       ''Handling Validation for Source
    strTemp="WPFObject(""HwndSource: WindowContentHolder"", """")"
    Set objTemp=Sys.Process("EdgeClient").WaitChild(strTemp,10000)
    If objTemp.Exists = True then
      objTemp.Keys "[Enter]"
      strTestCaseResult = "FAIL"
      Exit Sub
    End If

    ''WorkSpace Edit Window
    strTemp="WPFObject(""LayoutPanel"", """", 2)"
    Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,13,True)
    If objTemp.Exists then
        Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WPFObject("SourceTreeListView")
        Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl")
       Delay 10000,"Pls Wait.."
        ''Expanding First Node in Tree      
        intTotNodeCnt=GridControl.Nodes_2.Count  
        For intI=0 to intTotNodeCnt-1         
          If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
           GridControl.Nodes_2.Item(intI).Expand(True)
           blnFlag=False  
           Exit For
          End If
        Next
         Delay 10000,"Pls Wait.."
        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
          For intJ=0 to intTotNodeCnt-1
            If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strSource2) then
              GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
              intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(0).get_RowHandle
              GridControl.Keys "^[Home]"
              Call GridControl.ClearSelectionCore
              Call GridControl.FocusViewAndRow(GridControl,intRow-1)
              GridControl.SetFocusOnCurrentItem
              Call GridControl.SelectRowCore(intRow-1)
        
              If objGridCell.Exists = True then
                objGridCell.Click
              End If
              blnFlag = False 
              Exit For
            End If
          Next

    End if
            
    strTemp="WPFObject(""SourceTreeListView"")"
    objEditSource=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WaitChild(strTemp,15000000)
    if objEditSource.Exists = True then

          strTemp="WPFObject(""ContentControlEx"", ""Add Folder"", 2)"
          Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 4).WPFObject("BarButtonItemLinkControl", "", 1).FindChild("Name",strTemp,50,True)
          If objNewWrkSpace_okbtn.Exists = True then
             If objNewWrkSpace_okbtn.Enabled = True then
              objNewWrkSpace_okbtn.Click
              strTCRemarks = strTCRemarks & "<br />" & "Add Folder is found in Source"
              log.Message "Add Folder is found in Source"
             Else
              strTCRemarks = strTCRemarks & "<br />" & "Add Folder is Disabled in Source"
              log.Message "Add Folder is Disabled in Source"
             End if
          Else
            strTCRemarks = strTCRemarks & "<br />" & "Add Folder is  not found in Source"
            log.Message "Add Folder is not found in Source"
          End If   
        
          
           Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 4).WPFObject("BarButtonItemLinkControl", "", 1)      
         Delay 8000,"New Folder..."

        ''Getting no. of Rows under level 2
        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count
        intK=intTotNodeCnt-1
    
        Set objDescCell=Aliases.EdgeClient.HwndSource_RibbonWindow.RibbonWindow.ContentControl.Grid.Grid.ContentControl.Grid.ContentControl.PART_ContainerContent.BarManager.DockPanel.DockLayoutManager.LayoutGroup.LayoutPanel2.Root.BarManager.AdornerDecorator.AdornedControl.Grid.DockPanel.SourceTreeListControl.SourceTreeListView.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK)
        Call objDescCell.Content.set_Description(DescText)
        strTCRemarks = strTCRemarks & "<br />" & "Description is added in new folder"
        log.Message "Description is added in new folder"
        
        Call objDescCell.Content.set_DescriptionLocal(DescLocalText)
        strTCRemarks = strTCRemarks & "<br />" & "Description local is added in new folder"
        log.Message "Description local is added in new folder"
            
        Delay 15000,"Pls Wait.."
        Call SClosesource()
        Delay 5000,"Pls Wait.."
        
        
                   
    End if
 
    strTemp="WPFObject(""SourceTreeListView"")"
    objEditSource=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WaitChild(strTemp,15000000)
    if objEditSource.Exists = True then
        sys.Keys("[Up]")
        Call sEdgeProcessor
        sys.Keys("^f")
        strTCRemarks = strTCRemarks & "<br />" & "Copy Folder Only is Click"
        log.Message "Copy Folder Only is Click"
        sys.Keys("[Down]")
        Call sEdgeProcessor
    
        sys.Keys("^b")
        Call sEdgeProcessor
        strTCRemarks = strTCRemarks & "<br />" & "Paste Below is Clicked"
        log.Message "Paste Below is Clicked"
        strDesc1=aqDateTime.Now
        strDesc2=aqDateTime.Now
        DescText=Replace(strDesc1,"/","-")
        DescText=Replace(DescText,":","_")
                        
        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count
        intK=intTotNodeCnt-2
    
        Set objDescCell=Aliases.EdgeClient.HwndSource_RibbonWindow.RibbonWindow.ContentControl.Grid.Grid.ContentControl.Grid.ContentControl.PART_ContainerContent.BarManager.DockPanel.DockLayoutManager.LayoutGroup.LayoutPanel2.Root.BarManager.AdornerDecorator.AdornedControl.Grid.DockPanel.SourceTreeListControl.SourceTreeListView.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK)
        Call objDescCell.Content.set_Description(DescText)
        strTCRemarks = strTCRemarks & "<br />" & "Description is Updated in Pasted folder"
        log.Message "Description is updated in Pasted folder"
        
        Call objDescCell.Content.set_DescriptionLocal(DescText)
        strTCRemarks = strTCRemarks & "<br />" & "Description local is Updated in Pasted folder"
        log.Message "Description local is Updated in Pasted folder"
                        
    End if
    
    Dim objSaveWrk,objWait  
     set objSaveWrk=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 12).WPFObject("BarSubItemLinkControl", "", 1)
    strTemp="WPFObject(""ContentControlEx"", ""Workspace"", 2)"
    Set objTemp=objSaveWrk.FindChild("Name",strTemp,50)
    objWait=1
    Do until objTemp.Enabled = true 
        If objWait < 20 Then
          Delay 1000,"Pls Wait... Form is loading..."
          objWait=objWait+1
        else
          Call SClosesource()
          Call SourceWorkSpacevwr()
          Exit Sub
        end if 
    Loop 
    
    strTemp="WPFObject(""ContentControlEx"", ""Workspace"", 2)"
    Set objWrkSpace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,50,True)
    If objWrkSpace.Exists = True then
      Delay(1000)
      objWrkSpace.Click
      Delay(1000)
      strTemp="WPFObject(""PopupMenuBarControl"", """", 1)"
      Set objwrkspacepop=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").Findchild("Name",strTemp,50,True)
      'Set objwrkspacepop=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 2).WPFObject("BarButtonItemLinkControl", "", 1).WPFObject("ContentControlEx", "Upload Workspace", 2)
      If objwrkspacepop.Exists = True then
        strTemp="WPFObject(""ContentControlEx"", ""Upload Workspace"", 2)"
        set objwrkspcUpload=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).FindChild("Name",strTemp,50,True)
        If objwrkspcUpload.Exists = True then
          objwrkspcUpload.Click
          'Delay 1000,"Pls Wait.."
          strTemp="WPFObject(""PART_ContainerContent"")"
          Set objConfirm=Sys.Process("EdgeClient").WPFObject("HwndSource: WindowContentHolder", "Confirm").FindChild("Name",strTemp,50,True)
          strTemp="WPFObject(""DXMessageBox"", """", 1)"
          Set objConfirm=objConfirm.WaitChild(strTemp,180000)
          If objConfirm.Exists = True then
            Sys.Keys "[Enter]"
            'Delay 8000,"Uploading..."
            Set objConfirm = Sys.Process("EdgeClient")._
            Waitchild("WPFObject(""HwndSource: CustomMessageBoxWindow"", ""Upload Workspace"")",600000)._
            Waitchild("WPFObject(""CustomMessageBoxWindow"", ""Upload Workspace"", 1)",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""FloatingContainerBorder"")",60000)._
            Waitchild("WPFObject(""FloatingContainerBackground"")",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""FloatingContainerBody"")",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""PART_ContainerContent"")",60000)
            If objConfirm.Exists = True then
              Sys.Keys "[Enter]"
              'Delay 30000,"Pls Wait.."
              Call sEdgeProcessor
            End if
          End if
        End if
      End if
    End if

End Sub
Sub sChkSrcCopyPasteAboveSH(strParameters)
On Error Resume Next 
   Dim strSource1,StrSource2,strSource3,strTemp,GridControl,GridSourceTree,intTotNodeCnt,intI,intJ,intRow,intK,objEdge
   Dim objNewWorkspace,objWrkspace_popup,objOpenView,strTemp1,objNewWrkSpaceName,objNewWrkSpace_Txtbox,objNewWrkSpace_okbtn,objNewWrkSpace_Name
   Dim strDesc1,strDesc2,DescText,DescLocalText
   Dim objEditSource
   Dim objTemp, objStrClose
   Dim objEdgeFilter
   
    strSource1=getSplitValue(strParameters,"SOURCE")
    StrSource2=getSplitValue(strParameters,"LEVEL2SOURCE")
    StrSource3=getSplitValue(strParameters,"LEVEL3SOURCE")
    
'    strSource1="Test"
'    StrSource2="Automation_UIT2"
'    StrSource3="Test"

    Call sHome_Source
    
    strDesc1=aqDateTime.Now
    strDesc2=aqDateTime.Now
    DescText=Replace(strDesc1,"/","-")
    DescText=Replace(DescText,":","_")
    DescLocalText=DescText
    strWrkSpaceName=DescText
'    intSeriesID=getSplitValue(strParameters,"SERIESID")
'    if intSeriesID=0 then
'      Call sSourceseries
'      intSeriesID=strSourceFileText
'    End if 
    
    strTemp="WPFObject(""SourceTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""SourceTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    Delay 10000,"Pls Wait.."
    ''Selecting Country Name
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
          GridControl.Nodes_2.Item(intI).Expand(True)
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description       
          blnFlag=False  
          Exit For
        End If
    Next
    If blnFlag = True then
      strTCRemarks="Country Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
  
    Delay 10000,"Pls Wait.."
        blnFlag = True 
    ''Selecting Level2Source_Name
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
  For intJ=0 to intTotNodeCnt-1
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(StrSource2) then
        GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
        intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
'        Call GridSourceTree.ClickCell(intRow, "Edit")
        Call GridControl.ClearSelectionCore
        Call GridControl.FocusViewAndRow(GridControl,intRow)
        GridControl.SetFocusOnCurrentItem
        Call GridControl.SelectRowCore(intRow)
        log.Message "Level2 Source Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
        blnFlag = False 
        Exit For
      End If
    Next
    If blnFlag = True then
      log.Message "Level2 Source Name not found"
      strTCRemarks="Level2 Source Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
    
     Delay 10000,"Pls Wait.."
    blnFlag = True 
   
    Delay 2000,"Pls Wait.."

    strTemp="WPFObject(""ArrowControl"", """", 1)"
    Set objNewWorkspace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,20,True)
    If objNewWorkspace.Exists = True then
      objNewWorkspace.Click
       strTemp="WPFObject(""BarPopupBorderControl"", """", 1)"
      Set objWrkspace_popup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").FindChild("Name",strTemp,5,True)
      If objWrkspace_popup.Exists = True then
        strTemp="WPFObject(""ContentControlEx"", ""Open For Edit (Source)"", 2)"
        Set objopenforEdit=objWrkspace_popup.FindChild("Name",strTemp,8,True)
        If objopenforEdit.Exists then
          objopenforEdit.Click    
        End If
      End if
      
      strTemp1="WPFObject(""HwndSource: WorkspaceNamePrompt"", ""Please provide a new Workspace Name"")"
      Set objNewWrkSpaceName=Sys.Process("EdgeClient").WaitChild(strTemp1,50000)
      If objNewWrkSpaceName.Exists = True then
     
      ''Waiting for Workspace Name prompt
      strTemp="WPFObject(""FloatingContainerBorder"")"
      Set objNewWrkSpace_Name=Sys.Process("EdgeClient").WPFObject("HwndSource: WorkspaceNamePrompt", "Please provide a new Workspace Name").WPFObject("WorkspaceNamePrompt", "Please provide a new Workspace Name", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,15000000)
      If objNewWrkSpace_Name.Exists = True then
          strTemp="WPFObject(""ChangeNameTextEdit"")"
          ''Entering Workspace Name
          Set objNewWrkSpace_Txtbox=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
            If objNewWrkSpace_Txtbox.Exists = True then
              objNewWrkSpace_Txtbox.Click
              objNewWrkSpace_Txtbox.Text=strWrkSpaceName
      '        strTCRemarks=strTCRemarks & Chr(10) & "Entered Workspace Name - " & strWrkSpaceName
              ''Clicking on Ok Button 
              strTemp="WPFObject(""OkButton"")"
              Set objNewWrkSpace_okbtn=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
              If objNewWrkSpace_okbtn.Exists = True then
                objNewWrkSpace_okbtn.Click
                'Delay 5000,"Please wait..."
              End If
            End If
        End If
      End if 
     End if 
       
  
       ''Handling Validation for Source
    strTemp="WPFObject(""HwndSource: WindowContentHolder"", """")"
    Set objTemp=Sys.Process("EdgeClient").WaitChild(strTemp,10000)
    If objTemp.Exists = True then
      objTemp.Keys "[Enter]"
      strTestCaseResult = "FAIL"
      Exit Sub
    End If

    ''WorkSpace Edit Window
    strTemp="WPFObject(""LayoutPanel"", """", 2)"
    Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,13,True)
    If objTemp.Exists then
        Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WPFObject("SourceTreeListView")
        Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl")
       Delay 10000,"Pls Wait.."
        ''Expanding First Node in Tree      
        intTotNodeCnt=GridControl.Nodes_2.Count  
        For intI=0 to intTotNodeCnt-1         
          If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
           GridControl.Nodes_2.Item(intI).Expand(True)
           blnFlag=False  
           Exit For
          End If
        Next
         Delay 10000,"Pls Wait.."
        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
          For intJ=0 to intTotNodeCnt-1
            If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strSource2) then
              GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
              intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(0).get_RowHandle
              GridControl.Keys "^[Home]"
              Call GridControl.ClearSelectionCore
              Call GridControl.FocusViewAndRow(GridControl,intRow-1)
              GridControl.SetFocusOnCurrentItem
              Call GridControl.SelectRowCore(intRow-1)
        
              If objGridCell.Exists = True then
                objGridCell.Click
              End If
              blnFlag = False 
              Exit For
            End If
          Next

    End if
            
    strTemp="WPFObject(""SourceTreeListView"")"
    objEditSource=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WaitChild(strTemp,15000000)
    if objEditSource.Exists = True then

          strTemp="WPFObject(""ContentControlEx"", ""Add Folder"", 2)"
          Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 4).WPFObject("BarButtonItemLinkControl", "", 1).FindChild("Name",strTemp,50,True)
          If objNewWrkSpace_okbtn.Exists = True then
             If objNewWrkSpace_okbtn.Enabled = True then
              objNewWrkSpace_okbtn.Click
              strTCRemarks = strTCRemarks & "<br />" & "Add Folder is found in Source"
              log.Message "Add Folder is found in Source"
             Else
              strTCRemarks = strTCRemarks & "<br />" & "Add Folder is Disabled in Source"
              log.Message "Add Folder is Disabled in Source"
             End if
          Else
            strTCRemarks = strTCRemarks & "<br />" & "Add Folder is  not found in Source"
            log.Message "Add Folder is not found in Source"
          End If   
        
          
           Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 4).WPFObject("BarButtonItemLinkControl", "", 1)      
         Delay 8000,"New Folder..."

        ''Getting no. of Rows under level 2
        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count
        intK=intTotNodeCnt-1
    
        Set objDescCell=Aliases.EdgeClient.HwndSource_RibbonWindow.RibbonWindow.ContentControl.Grid.Grid.ContentControl.Grid.ContentControl.PART_ContainerContent.BarManager.DockPanel.DockLayoutManager.LayoutGroup.LayoutPanel2.Root.BarManager.AdornerDecorator.AdornedControl.Grid.DockPanel.SourceTreeListControl.SourceTreeListView.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK)
        Call objDescCell.Content.set_Description(DescText)
        strTCRemarks = strTCRemarks & "<br />" & "Description is added in new folder"
        log.Message "Description is added in new folder"
        
        Call objDescCell.Content.set_DescriptionLocal(DescLocalText)
        strTCRemarks = strTCRemarks & "<br />" & "Description local is added in new folder"
        log.Message "Description local is added in new folder"
            
        Delay 15000,"Pls Wait.."
        Call SClosesource()
        Delay 5000,"Pls Wait.."
        
        
                   
    End if
 
    strTemp="WPFObject(""SourceTreeListView"")"
    objEditSource=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WaitChild(strTemp,15000000)
    if objEditSource.Exists = True then
        sys.Keys("[Up]")
        Call sEdgeProcessor
        sys.Keys("^f")
        strTCRemarks = strTCRemarks & "<br />" & "Copy Folder Only is Click"
        log.Message "Copy Folder Only is Click"
        sys.Keys("[Down]")
        Call sEdgeProcessor
    
        sys.Keys("^o")
        Call sEdgeProcessor
        strTCRemarks = strTCRemarks & "<br />" & "Paste Below is Clicked"
        log.Message "Paste Below is Clicked"
        strDesc1=aqDateTime.Now
        strDesc2=aqDateTime.Now
        DescText=Replace(strDesc1,"/","-")
        DescText=Replace(DescText,":","_")
                        
        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count
        intK=intTotNodeCnt-2
    
        Set objDescCell=Aliases.EdgeClient.HwndSource_RibbonWindow.RibbonWindow.ContentControl.Grid.Grid.ContentControl.Grid.ContentControl.PART_ContainerContent.BarManager.DockPanel.DockLayoutManager.LayoutGroup.LayoutPanel2.Root.BarManager.AdornerDecorator.AdornedControl.Grid.DockPanel.SourceTreeListControl.SourceTreeListView.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK)
        Call objDescCell.Content.set_Description(DescText)
        strTCRemarks = strTCRemarks & "<br />" & "Description is Updated in Pasted folder"
        log.Message "Description is updated in Pasted folder"
        
        Call objDescCell.Content.set_DescriptionLocal(DescText)
        strTCRemarks = strTCRemarks & "<br />" & "Description local is Updated in Pasted folder"
        log.Message "Description local is Updated in Pasted folder"
                        
    End if
    
    Dim objSaveWrk,objWait  
     set objSaveWrk=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 12).WPFObject("BarSubItemLinkControl", "", 1)
    strTemp="WPFObject(""ContentControlEx"", ""Workspace"", 2)"
    Set objTemp=objSaveWrk.FindChild("Name",strTemp,50)
   objWait=1
    Do until objTemp.Enabled = true 
        If objWait < 20 Then
          Delay 1000,"Pls Wait... Form is loading..."
          objWait=objWait+1
        else
          Call SClosesource()
          Call SourceWorkSpacevwr()
          Exit Sub
        end if 
    Loop 
    
    strTemp="WPFObject(""ContentControlEx"", ""Workspace"", 2)"
    Set objWrkSpace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,50,True)
    If objWrkSpace.Exists = True then
      Delay(1000)
      objWrkSpace.Click
      Delay(1000)
      strTemp="WPFObject(""PopupMenuBarControl"", """", 1)"
      Set objwrkspacepop=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").Findchild("Name",strTemp,50,True)
      'Set objwrkspacepop=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 2).WPFObject("BarButtonItemLinkControl", "", 1).WPFObject("ContentControlEx", "Upload Workspace", 2)
      If objwrkspacepop.Exists = True then
        strTemp="WPFObject(""ContentControlEx"", ""Upload Workspace"", 2)"
        set objwrkspcUpload=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).FindChild("Name",strTemp,50,True)
        If objwrkspcUpload.Exists = True then
          objwrkspcUpload.Click
          'Delay 1000,"Pls Wait.."
          strTemp="WPFObject(""PART_ContainerContent"")"
        Set objConfirm=Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "Confirm save.").FindChild("Name",strTemp,50,True)

          If objConfirm.Exists = True then
            Sys.Keys "[Enter]"
            'Delay 8000,"Uploading..."
            Set objConfirm = Sys.Process("EdgeClient")._
            Waitchild("WPFObject(""HwndSource: CustomMessageBoxWindow"", ""Upload Workspace"")",600000)._
            Waitchild("WPFObject(""CustomMessageBoxWindow"", ""Upload Workspace"", 1)",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""FloatingContainerBorder"")",60000)._
            Waitchild("WPFObject(""FloatingContainerBackground"")",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""FloatingContainerBody"")",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""PART_ContainerContent"")",60000)
            
            If objConfirm.Exists = True then
              Sys.Keys("O")
    'Delay 30000,"Pls Wait.."
              Call sEdgeProcessor
            End if
          End if
        End if
      End if
    End if
'  Call SClosesource()
  'Call SourceWorkSpacevwr()
End Sub
Sub sChkSrcCopyPasteAboveWithSeriesSH(strParameters)
On Error Resume Next 
   Dim strSource1,StrSource2,strSource3,strTemp,GridControl,GridSourceTree,intTotNodeCnt,intI,intJ,intRow,intK,objEdge
   Dim objNewWorkspace,objWrkspace_popup,objOpenView,strTemp1,objNewWrkSpaceName,objNewWrkSpace_Txtbox,objNewWrkSpace_okbtn,objNewWrkSpace_Name
   Dim strDesc1,strDesc2,DescText,DescLocalText
   Dim objEditSource
   Dim objTemp, objStrClose
   Dim objEdgeFilter
   
    strSource1=getSplitValue(strParameters,"SOURCE")
    StrSource2=getSplitValue(strParameters,"LEVEL2SOURCE")
    StrSource3=getSplitValue(strParameters,"LEVEL3SOURCE")
    
'    strSource1="Test"
'    StrSource2="Automation_UIT2"
'    StrSource3="Test"

    Call sHome_Source
    
    strDesc1=aqDateTime.Now
    strDesc2=aqDateTime.Now
    DescText=Replace(strDesc1,"/","-")
    DescText=Replace(DescText,":","_")
    DescLocalText=DescText
    strWrkSpaceName=DescText
'    intSeriesID=getSplitValue(strParameters,"SERIESID")
'    if intSeriesID=0 then
'      Call sSourceseries
'      intSeriesID=strSourceFileText
'    End if 
    
    strTemp="WPFObject(""SourceTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""SourceTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    Delay 10000,"Pls Wait.."
    ''Selecting Country Name
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
          GridControl.Nodes_2.Item(intI).Expand(True)
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description       
          blnFlag=False  
          Exit For
        End If
    Next
    If blnFlag = True then
      strTCRemarks="Country Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
  
    Delay 10000,"Pls Wait.."
        blnFlag = True 
    ''Selecting Level2Source_Name
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
  For intJ=0 to intTotNodeCnt-1
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(StrSource2) then
        GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
        intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
'        Call GridSourceTree.ClickCell(intRow, "Edit")
        Call GridControl.ClearSelectionCore
        Call GridControl.FocusViewAndRow(GridControl,intRow)
        GridControl.SetFocusOnCurrentItem
        Call GridControl.SelectRowCore(intRow)
        log.Message "Level2 Source Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
        blnFlag = False 
        Exit For
      End If
    Next
    If blnFlag = True then
      log.Message "Level2 Source Name not found"
      strTCRemarks="Level2 Source Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
    
     Delay 10000,"Pls Wait.."
    blnFlag = True 
   
    Delay 2000,"Pls Wait.."

    strTemp="WPFObject(""ArrowControl"", """", 1)"
    Set objNewWorkspace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,20,True)
    If objNewWorkspace.Exists = True then
      objNewWorkspace.Click
       strTemp="WPFObject(""BarPopupBorderControl"", """", 1)"
      Set objWrkspace_popup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").FindChild("Name",strTemp,5,True)
      If objWrkspace_popup.Exists = True then
        strTemp="WPFObject(""ContentControlEx"", ""Open For Edit (Source)"", 2)"
        Set objopenforEdit=objWrkspace_popup.FindChild("Name",strTemp,8,True)
        If objopenforEdit.Exists then
          objopenforEdit.Click    
        End If
      End if
      
      strTemp1="WPFObject(""HwndSource: WorkspaceNamePrompt"", ""Please provide a new Workspace Name"")"
      Set objNewWrkSpaceName=Sys.Process("EdgeClient").WaitChild(strTemp1,50000)
      If objNewWrkSpaceName.Exists = True then
     
      ''Waiting for Workspace Name prompt
      strTemp="WPFObject(""FloatingContainerBorder"")"
      Set objNewWrkSpace_Name=Sys.Process("EdgeClient").WPFObject("HwndSource: WorkspaceNamePrompt", "Please provide a new Workspace Name").WPFObject("WorkspaceNamePrompt", "Please provide a new Workspace Name", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,15000000)
      If objNewWrkSpace_Name.Exists = True then
          strTemp="WPFObject(""ChangeNameTextEdit"")"
          ''Entering Workspace Name
          Set objNewWrkSpace_Txtbox=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
            If objNewWrkSpace_Txtbox.Exists = True then
              objNewWrkSpace_Txtbox.Click
              objNewWrkSpace_Txtbox.Text=strWrkSpaceName
      '        strTCRemarks=strTCRemarks & Chr(10) & "Entered Workspace Name - " & strWrkSpaceName
              ''Clicking on Ok Button 
              strTemp="WPFObject(""OkButton"")"
              Set objNewWrkSpace_okbtn=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
              If objNewWrkSpace_okbtn.Exists = True then
                objNewWrkSpace_okbtn.Click
                'Delay 5000,"Please wait..."
              End If
            End If
        End If
      End if 
     End if 
       
  
       ''Handling Validation for Source
    strTemp="WPFObject(""HwndSource: WindowContentHolder"", """")"
    Set objTemp=Sys.Process("EdgeClient").WaitChild(strTemp,10000)
    If objTemp.Exists = True then
      objTemp.Keys "[Enter]"
      strTestCaseResult = "FAIL"
      Exit Sub
    End If

    ''WorkSpace Edit Window
    strTemp="WPFObject(""LayoutPanel"", """", 2)"
    Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,13,True)
    If objTemp.Exists then
        Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WPFObject("SourceTreeListView")
        Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl")
       Delay 10000,"Pls Wait.."
        ''Expanding First Node in Tree      
        intTotNodeCnt=GridControl.Nodes_2.Count  
        For intI=0 to intTotNodeCnt-1         
          If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
           GridControl.Nodes_2.Item(intI).Expand(True)
           blnFlag=False  
           Exit For
          End If
        Next
         Delay 10000,"Pls Wait.."
        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
          For intJ=0 to intTotNodeCnt-1
            If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strSource2) then
              GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
              intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(0).get_RowHandle
              GridControl.Keys "^[Home]"
              Call GridControl.ClearSelectionCore
              Call GridControl.FocusViewAndRow(GridControl,intRow-1)
              GridControl.SetFocusOnCurrentItem
              Call GridControl.SelectRowCore(intRow-1)
        
              If objGridCell.Exists = True then
                objGridCell.Click
              End If
              blnFlag = False 
              Exit For
            End If
          Next

    End if
            
    strTemp="WPFObject(""SourceTreeListView"")"
    objEditSource=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WaitChild(strTemp,15000000)
    if objEditSource.Exists = True then

          strTemp="WPFObject(""ContentControlEx"", ""Add Folder"", 2)"
          Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 4).WPFObject("BarButtonItemLinkControl", "", 1).FindChild("Name",strTemp,50,True)
          If objNewWrkSpace_okbtn.Exists = True then
             If objNewWrkSpace_okbtn.Enabled = True then
              objNewWrkSpace_okbtn.Click
              strTCRemarks = strTCRemarks & "<br />" & "Add Folder is found in Source"
              log.Message "Add Folder is found in Source"
             Else
              strTCRemarks = strTCRemarks & "<br />" & "Add Folder is Disabled in Source"
              log.Message "Add Folder is Disabled in Source"
             End if
          Else
            strTCRemarks = strTCRemarks & "<br />" & "Add Folder is  not found in Source"
            log.Message "Add Folder is not found in Source"
          End If   
        
          
           Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 4).WPFObject("BarButtonItemLinkControl", "", 1)      
         Delay 8000,"New Folder..."

        ''Getting no. of Rows under level 2
        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count
        intK=intTotNodeCnt-1
    
        Set objDescCell=Aliases.EdgeClient.HwndSource_RibbonWindow.RibbonWindow.ContentControl.Grid.Grid.ContentControl.Grid.ContentControl.PART_ContainerContent.BarManager.DockPanel.DockLayoutManager.LayoutGroup.LayoutPanel2.Root.BarManager.AdornerDecorator.AdornedControl.Grid.DockPanel.SourceTreeListControl.SourceTreeListView.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK)
        Call objDescCell.Content.set_Description(DescText)
        strTCRemarks = strTCRemarks & "<br />" & "Description is added in new folder"
        log.Message "Description is added in new folder"
        
        Call objDescCell.Content.set_DescriptionLocal(DescLocalText)
        strTCRemarks = strTCRemarks & "<br />" & "Description local is added in new folder"
        log.Message "Description local is added in new folder"
            
        Delay 15000,"Pls Wait.."
        Call SClosesource()
        Delay 5000,"Pls Wait.."
        
        
                   
    End if
 
    strTemp="WPFObject(""SourceTreeListView"")"
    objEditSource=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WaitChild(strTemp,15000000)
    if objEditSource.Exists = True then
          sys.Keys("[Up]")
           Call sEdgeProcessor
            sys.Keys("^s")
        strTCRemarks = strTCRemarks & "<br />" & "Copy Folder Only is Click"
        log.Message "Copy Folder Only is Click"
        sys.Keys("[Down]")
        Call sEdgeProcessor
    
        sys.Keys("^o")
        'Call sEdgeProcessor
        strTCRemarks = strTCRemarks & "<br />" & "Paste Below is Clicked"
        log.Message "Paste Below is Clicked"
        
'        strTemp="WPFObject(""PART_ContainerContent"")"
'          Set objConfirm=Sys.Process("EdgeClient").WPFObject("HwndSource: WindowContentHolder", "Copy and paste source folder with series").WPFObject("WindowContentHolder", "Copy and paste source folder with series", 1).FindChild("Name",strTemp,50,True)
'          strTemp="WPFObject(""DXMessageBox"", """", 1)"
'          Set objConfirm=objConfirm.WaitChild(strTemp,180000)
'          If objConfirm.Exists = True then
'            objConfirm.Keys "[Enter]"
           Delay 30000,"Pls Wait.."
'            Call sEdgeProcessor
'          End if
            
         strDesc1=aqDateTime.Now
          strDesc2=aqDateTime.Now
          DescText=Replace(strDesc1,"/","-")
          DescText=Replace(DescText,":","_")
                        
          intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count
          intK=intTotNodeCnt-2
    
          Set objDescCell=Aliases.EdgeClient.HwndSource_RibbonWindow.RibbonWindow.ContentControl.Grid.Grid.ContentControl.Grid.ContentControl.PART_ContainerContent.BarManager.DockPanel.DockLayoutManager.LayoutGroup.LayoutPanel2.Root.BarManager.AdornerDecorator.AdornedControl.Grid.DockPanel.SourceTreeListControl.SourceTreeListView.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK)
          Call objDescCell.Content.set_Description(DescText)
          strTCRemarks = strTCRemarks & "<br />" & "Description is Updated in Pasted folder"
          log.Message "Description is updated in Pasted folder"
        
          Call objDescCell.Content.set_DescriptionLocal(DescText)
          strTCRemarks = strTCRemarks & "<br />" & "Description local is Updated in Pasted folder"
          log.Message "Description local is Updated in Pasted folder"
                        
    End if
    
    Dim objSaveWrk,objWait  
     set objSaveWrk=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 12).WPFObject("BarSubItemLinkControl", "", 1)
    strTemp="WPFObject(""ContentControlEx"", ""Workspace"", 2)"
    Set objTemp=objSaveWrk.FindChild("Name",strTemp,50)
    objWait=1
    Do until objTemp.Enabled = true 
        If objWait < 20 Then
          Delay 1000,"Pls Wait... Form is loading..."
          objWait=objWait+1
        else
          Call SClosesource()
          Call SourceWorkSpacevwr()
          Exit Sub
        end if 
    Loop 
    
    strTemp="WPFObject(""ContentControlEx"", ""Workspace"", 2)"
    Set objWrkSpace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,50,True)
    If objWrkSpace.Exists = True then
      Delay(1000)
      objWrkSpace.Click
      Delay(1000)
      strTemp="WPFObject(""PopupMenuBarControl"", """", 1)"
      Set objwrkspacepop=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").Findchild("Name",strTemp,50,True)
      'Set objwrkspacepop=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 2).WPFObject("BarButtonItemLinkControl", "", 1).WPFObject("ContentControlEx", "Upload Workspace", 2)
      If objwrkspacepop.Exists = True then
        strTemp="WPFObject(""ContentControlEx"", ""Upload Workspace"", 2)"
        set objwrkspcUpload=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).FindChild("Name",strTemp,50,True)
        If objwrkspcUpload.Exists = True then
          objwrkspcUpload.Click
          'Delay 1000,"Pls Wait.."
          strTemp="WPFObject(""PART_ContainerContent"")"
        Set objConfirm=Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "Confirm save.").FindChild("Name",strTemp,50,True)

          If objConfirm.Exists = True then
            Sys.Keys "[Enter]"
            'Delay 8000,"Uploading..."
            Set objConfirm = Sys.Process("EdgeClient")._
            Waitchild("WPFObject(""HwndSource: CustomMessageBoxWindow"", ""Upload Workspace"")",600000)._
            Waitchild("WPFObject(""CustomMessageBoxWindow"", ""Upload Workspace"", 1)",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""FloatingContainerBorder"")",60000)._
            Waitchild("WPFObject(""FloatingContainerBackground"")",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""FloatingContainerBody"")",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""PART_ContainerContent"")",60000)
            
            If objConfirm.Exists = True then
              Sys.Keys("O")
    'Delay 30000,"Pls Wait.."
              Call sEdgeProcessor
            End if
          End if
        End if
      End if
    End if

End Sub
Sub sChkSrcCopyPasteBelowWithSeriesSH(strParameters)
On Error Resume Next 
   Dim strSource1,StrSource2,strSource3,strTemp,GridControl,GridSourceTree,intTotNodeCnt,intI,intJ,intRow,intK,objEdge
   Dim objNewWorkspace,objWrkspace_popup,objOpenView,strTemp1,objNewWrkSpaceName,objNewWrkSpace_Txtbox,objNewWrkSpace_okbtn,objNewWrkSpace_Name
   Dim strDesc1,strDesc2,DescText,DescLocalText
   Dim objEditSource
   Dim objTemp, objStrClose
   Dim objEdgeFilter
   
    strSource1=getSplitValue(strParameters,"SOURCE")
    StrSource2=getSplitValue(strParameters,"LEVEL2SOURCE")
    StrSource3=getSplitValue(strParameters,"LEVEL3SOURCE")
'    
'    strSource1="Test"
'    StrSource2="Automation_UIT2"
'    StrSource3="Test"

    Call sHome_Source
    
    strDesc1=aqDateTime.Now
    strDesc2=aqDateTime.Now
    DescText=Replace(strDesc1,"/","-")
    DescText=Replace(DescText,":","_")
    DescLocalText=DescText
    strWrkSpaceName=DescText
'    intSeriesID=getSplitValue(strParameters,"SERIESID")
'    if intSeriesID=0 then
'      Call sSourceseries
'      intSeriesID=strSourceFileText
'    End if 
    
    strTemp="WPFObject(""SourceTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""SourceTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    Delay 10000,"Pls Wait.."
    ''Selecting Country Name
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
          GridControl.Nodes_2.Item(intI).Expand(True)
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description       
          blnFlag=False  
          Exit For
        End If
    Next
    If blnFlag = True then
      strTCRemarks="Country Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
  
    Delay 10000,"Pls Wait.."
        blnFlag = True 
    ''Selecting Level2Source_Name
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
  For intJ=0 to intTotNodeCnt-1
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(StrSource2) then
        GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
        intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
'        Call GridSourceTree.ClickCell(intRow, "Edit")
        Call GridControl.ClearSelectionCore
        Call GridControl.FocusViewAndRow(GridControl,intRow)
        GridControl.SetFocusOnCurrentItem
        Call GridControl.SelectRowCore(intRow)
        log.Message "Level2 Source Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
        blnFlag = False 
        Exit For
      End If
    Next
    If blnFlag = True then
      log.Message "Level2 Source Name not found"
      strTCRemarks="Level2 Source Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
    
     Delay 10000,"Pls Wait.."
    blnFlag = True 
   
    Delay 2000,"Pls Wait.."

    strTemp="WPFObject(""ArrowControl"", """", 1)"
    Set objNewWorkspace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,20,True)
    If objNewWorkspace.Exists = True then
      objNewWorkspace.Click
       strTemp="WPFObject(""BarPopupBorderControl"", """", 1)"
      Set objWrkspace_popup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").FindChild("Name",strTemp,5,True)
      If objWrkspace_popup.Exists = True then
        strTemp="WPFObject(""ContentControlEx"", ""Open For Edit (Source)"", 2)"
        Set objopenforEdit=objWrkspace_popup.FindChild("Name",strTemp,8,True)
        If objopenforEdit.Exists then
          objopenforEdit.Click    
        End If
      End if
      
      strTemp1="WPFObject(""HwndSource: WorkspaceNamePrompt"", ""Please provide a new Workspace Name"")"
      Set objNewWrkSpaceName=Sys.Process("EdgeClient").WaitChild(strTemp1,50000)
      If objNewWrkSpaceName.Exists = True then
     
      ''Waiting for Workspace Name prompt
      strTemp="WPFObject(""FloatingContainerBorder"")"
      Set objNewWrkSpace_Name=Sys.Process("EdgeClient").WPFObject("HwndSource: WorkspaceNamePrompt", "Please provide a new Workspace Name").WPFObject("WorkspaceNamePrompt", "Please provide a new Workspace Name", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,15000000)
      If objNewWrkSpace_Name.Exists = True then
          strTemp="WPFObject(""ChangeNameTextEdit"")"
          ''Entering Workspace Name
          Set objNewWrkSpace_Txtbox=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
            If objNewWrkSpace_Txtbox.Exists = True then
              objNewWrkSpace_Txtbox.Click
              objNewWrkSpace_Txtbox.Text=strWrkSpaceName
      '        strTCRemarks=strTCRemarks & Chr(10) & "Entered Workspace Name - " & strWrkSpaceName
              ''Clicking on Ok Button 
              strTemp="WPFObject(""OkButton"")"
              Set objNewWrkSpace_okbtn=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
              If objNewWrkSpace_okbtn.Exists = True then
                objNewWrkSpace_okbtn.Click
                'Delay 5000,"Please wait..."
              End If
            End If
        End If
      End if 
     End if 
       
  
       ''Handling Validation for Source
    strTemp="WPFObject(""HwndSource: WindowContentHolder"", """")"
    Set objTemp=Sys.Process("EdgeClient").WaitChild(strTemp,10000)
    If objTemp.Exists = True then
      objTemp.Keys "[Enter]"
      strTestCaseResult = "FAIL"
      Exit Sub
    End If

    ''WorkSpace Edit Window
    strTemp="WPFObject(""LayoutPanel"", """", 2)"
    Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,13,True)
    If objTemp.Exists then
        Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WPFObject("SourceTreeListView")
        Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl")
       Delay 10000,"Pls Wait.."
        ''Expanding First Node in Tree      
        intTotNodeCnt=GridControl.Nodes_2.Count  
        For intI=0 to intTotNodeCnt-1         
          If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
           GridControl.Nodes_2.Item(intI).Expand(True)
           blnFlag=False  
           Exit For
          End If
        Next
         Delay 10000,"Pls Wait.."
        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
          For intJ=0 to intTotNodeCnt-1
            If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strSource2) then
              GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
              intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(0).get_RowHandle
              GridControl.Keys "^[Home]"
              Call GridControl.ClearSelectionCore
              Call GridControl.FocusViewAndRow(GridControl,intRow-1)
              GridControl.SetFocusOnCurrentItem
              Call GridControl.SelectRowCore(intRow-1)
        
              If objGridCell.Exists = True then
                objGridCell.Click
              End If
              blnFlag = False 
              Exit For
            End If
          Next

    End if
            
    strTemp="WPFObject(""SourceTreeListView"")"
    objEditSource=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WaitChild(strTemp,15000000)
    if objEditSource.Exists = True then

          strTemp="WPFObject(""ContentControlEx"", ""Add Folder"", 2)"
          Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 4).WPFObject("BarButtonItemLinkControl", "", 1).FindChild("Name",strTemp,50,True)
          If objNewWrkSpace_okbtn.Exists = True then
             If objNewWrkSpace_okbtn.Enabled = True then
              objNewWrkSpace_okbtn.Click
              strTCRemarks = strTCRemarks & "<br />" & "Add Folder is found in Source"
              log.Message "Add Folder is found in Source"
             Else
              strTCRemarks = strTCRemarks & "<br />" & "Add Folder is Disabled in Source"
              log.Message "Add Folder is Disabled in Source"
             End if
          Else
            strTCRemarks = strTCRemarks & "<br />" & "Add Folder is  not found in Source"
            log.Message "Add Folder is not found in Source"
          End If   
        
          
           Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 4).WPFObject("BarButtonItemLinkControl", "", 1)      
         Delay 8000,"New Folder..."

        ''Getting no. of Rows under level 2
        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count
        intK=intTotNodeCnt-1
    
        Set objDescCell=Aliases.EdgeClient.HwndSource_RibbonWindow.RibbonWindow.ContentControl.Grid.Grid.ContentControl.Grid.ContentControl.PART_ContainerContent.BarManager.DockPanel.DockLayoutManager.LayoutGroup.LayoutPanel2.Root.BarManager.AdornerDecorator.AdornedControl.Grid.DockPanel.SourceTreeListControl.SourceTreeListView.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK)
        Call objDescCell.Content.set_Description(DescText)
        strTCRemarks = strTCRemarks & "<br />" & "Description is added in new folder"
        log.Message "Description is added in new folder"
        
        Call objDescCell.Content.set_DescriptionLocal(DescLocalText)
        strTCRemarks = strTCRemarks & "<br />" & "Description local is added in new folder"
        log.Message "Description local is added in new folder"
            
        Delay 15000,"Pls Wait.."
        Call SClosesource()
        Delay 5000,"Pls Wait.."
        
        
                   
    End if
 
    strTemp="WPFObject(""SourceTreeListView"")"
    objEditSource=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WaitChild(strTemp,15000000)
    if objEditSource.Exists = True then
          sys.Keys("[Up]")
           Call sEdgeProcessor
            sys.Keys("^s")
        strTCRemarks = strTCRemarks & "<br />" & "Copy Folder Only is Click"
        log.Message "Copy Folder Only is Click"
        sys.Keys("[Down]")
        Call sEdgeProcessor
    
        sys.Keys("^b")
        'Call sEdgeProcessor
        strTCRemarks = strTCRemarks & "<br />" & "Paste Below is Clicked"
        log.Message "Paste Below is Clicked"
        
'        strTemp="WPFObject(""PART_ContainerContent"")"
'          Set objConfirm=Sys.Process("EdgeClient").WPFObject("HwndSource: WindowContentHolder", "Copy and paste source folder with series").WPFObject("WindowContentHolder", "Copy and paste source folder with series", 1).FindChild("Name",strTemp,50,True)
'          strTemp="WPFObject(""DXMessageBox"", """", 1)"
'          Set objConfirm=objConfirm.WaitChild(strTemp,180000)
'          If objConfirm.Exists = True then
'            objConfirm.Keys "[Enter]"
           Delay 30000,"Pls Wait.."
'            Call sEdgeProcessor
'          End if
            
         strDesc1=aqDateTime.Now
          strDesc2=aqDateTime.Now
          DescText=Replace(strDesc1,"/","-")
          DescText=Replace(DescText,":","_")
                        
          intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count
          intK=intTotNodeCnt-1
    
          Set objDescCell=Aliases.EdgeClient.HwndSource_RibbonWindow.RibbonWindow.ContentControl.Grid.Grid.ContentControl.Grid.ContentControl.PART_ContainerContent.BarManager.DockPanel.DockLayoutManager.LayoutGroup.LayoutPanel2.Root.BarManager.AdornerDecorator.AdornedControl.Grid.DockPanel.SourceTreeListControl.SourceTreeListView.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK)
          Call objDescCell.Content.set_Description(DescText)
          strTCRemarks = strTCRemarks & "<br />" & "Description is Updated in Pasted folder"
          log.Message "Description is updated in Pasted folder"
        
          Call objDescCell.Content.set_DescriptionLocal(DescText)
          strTCRemarks = strTCRemarks & "<br />" & "Description local is Updated in Pasted folder"
          log.Message "Description local is Updated in Pasted folder"
                        
    End if
    
    Dim objSaveWrk,objWait  
     set objSaveWrk=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 12).WPFObject("BarSubItemLinkControl", "", 1)
    strTemp="WPFObject(""ContentControlEx"", ""Workspace"", 2)"
    Set objTemp=objSaveWrk.FindChild("Name",strTemp,50)
    objWait=1
    Do until objTemp.Enabled = true 
        If objWait < 20 Then
          Delay 1000,"Pls Wait... Form is loading..."
          objWait=objWait+1
        else
          Call SClosesource()
          Call SourceWorkSpacevwr()
          Exit Sub
        end if 
    Loop  
    
    strTemp="WPFObject(""ContentControlEx"", ""Workspace"", 2)"
    Set objWrkSpace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,50,True)
    If objWrkSpace.Exists = True then
      Delay(1000)
      objWrkSpace.Click
      Delay(1000)
      strTemp="WPFObject(""PopupMenuBarControl"", """", 1)"
      Set objwrkspacepop=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").Findchild("Name",strTemp,50,True)
      'Set objwrkspacepop=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 2).WPFObject("BarButtonItemLinkControl", "", 1).WPFObject("ContentControlEx", "Upload Workspace", 2)
      If objwrkspacepop.Exists = True then
        strTemp="WPFObject(""ContentControlEx"", ""Upload Workspace"", 2)"
        set objwrkspcUpload=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).FindChild("Name",strTemp,50,True)
        If objwrkspcUpload.Exists = True then
          objwrkspcUpload.Click
          'Delay 1000,"Pls Wait.."
          strTemp="WPFObject(""PART_ContainerContent"")"
          Set objConfirm=Sys.Process("EdgeClient").WPFObject("HwndSource: WindowContentHolder", "Confirm").FindChild("Name",strTemp,50,True)
          strTemp="WPFObject(""DXMessageBox"", """", 1)"
          Set objConfirm=objConfirm.WaitChild(strTemp,180000)
          If objConfirm.Exists = True then
            Sys.Keys "[Enter]"
            'Delay 8000,"Uploading..."
            Set objConfirm = Sys.Process("EdgeClient")._
            Waitchild("WPFObject(""HwndSource: CustomMessageBoxWindow"", ""Upload Workspace"")",600000)._
            Waitchild("WPFObject(""CustomMessageBoxWindow"", ""Upload Workspace"", 1)",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""FloatingContainerBorder"")",60000)._
            Waitchild("WPFObject(""FloatingContainerBackground"")",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""FloatingContainerBody"")",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""PART_ContainerContent"")",60000)
            If objConfirm.Exists = True then
              Sys.Keys "[Enter]"
              'Delay 30000,"Pls Wait.."
              Call sEdgeProcessor
            End if
          End if
        End if
      End if
    End if
    Call sHome_Source
    
    strTemp="WPFObject(""SourceTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""SourceTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    Delay 10000,"Pls Wait.."
    ''Selecting Country Name
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
          GridControl.Nodes_2.Item(intI).Expand(True)
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description       
          blnFlag=False  
          Exit For
        End If
    Next
    If blnFlag = True then
      strTCRemarks="Country Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
  
    Delay 10000,"Pls Wait.."
        blnFlag = True 
    ''Selecting Level2Source_Name
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
  For intJ=0 to intTotNodeCnt-1
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(StrSource2) then
        GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
        intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
'        Call GridSourceTree.ClickCell(intRow, "Edit")
        Call GridControl.ClearSelectionCore
        Call GridControl.FocusViewAndRow(GridControl,intRow)
        GridControl.SetFocusOnCurrentItem
        Call GridControl.SelectRowCore(intRow)
        log.Message "Level2 Source Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
        blnFlag = False 
        Exit For
      End If
    Next
    If blnFlag = True then
      log.Message "Level2 Source Name not found"
      strTCRemarks="Level2 Source Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
    
     Delay 10000,"Pls Wait.."
    blnFlag = True 
   
    Delay 2000,"Pls Wait.."

    strTemp="WPFObject(""ArrowControl"", """", 1)"
    Set objNewWorkspace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,20,True)
    If objNewWorkspace.Exists = True then
      objNewWorkspace.Click
       strTemp="WPFObject(""BarPopupBorderControl"", """", 1)"
      Set objWrkspace_popup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").FindChild("Name",strTemp,5,True)
      If objWrkspace_popup.Exists = True then
        strTemp="WPFObject(""ContentControlEx"", ""Open For Edit (Source)"", 2)"
        Set objopenforEdit=objWrkspace_popup.FindChild("Name",strTemp,8,True)
        If objopenforEdit.Exists then
          objopenforEdit.Click    
        End If
      End if
      
      strTemp1="WPFObject(""HwndSource: WorkspaceNamePrompt"", ""Please provide a new Workspace Name"")"
      Set objNewWrkSpaceName=Sys.Process("EdgeClient").WaitChild(strTemp1,50000)
      If objNewWrkSpaceName.Exists = True then
     
      ''Waiting for Workspace Name prompt
      strTemp="WPFObject(""FloatingContainerBorder"")"
      Set objNewWrkSpace_Name=Sys.Process("EdgeClient").WPFObject("HwndSource: WorkspaceNamePrompt", "Please provide a new Workspace Name").WPFObject("WorkspaceNamePrompt", "Please provide a new Workspace Name", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,15000000)
      If objNewWrkSpace_Name.Exists = True then
          strTemp="WPFObject(""ChangeNameTextEdit"")"
          ''Entering Workspace Name
          Set objNewWrkSpace_Txtbox=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
            If objNewWrkSpace_Txtbox.Exists = True then
              objNewWrkSpace_Txtbox.Click
              objNewWrkSpace_Txtbox.Text=strWrkSpaceName
      '        strTCRemarks=strTCRemarks & Chr(10) & "Entered Workspace Name - " & strWrkSpaceName
              ''Clicking on Ok Button 
              strTemp="WPFObject(""OkButton"")"
              Set objNewWrkSpace_okbtn=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
              If objNewWrkSpace_okbtn.Exists = True then
                objNewWrkSpace_okbtn.Click
                'Delay 5000,"Please wait..."
              End If
            End If
        End If
      End if 
     End if 
       
  
       ''Handling Validation for Source
    strTemp="WPFObject(""HwndSource: WindowContentHolder"", """")"
    Set objTemp=Sys.Process("EdgeClient").WaitChild(strTemp,10000)
    If objTemp.Exists = True then
      objTemp.Keys "[Enter]"
      strTestCaseResult = "FAIL"
      Exit Sub
    End If

    ''WorkSpace Edit Window
    strTemp="WPFObject(""LayoutPanel"", """", 2)"
    Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,13,True)
    If objTemp.Exists then
        Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WPFObject("SourceTreeListView")
        Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl")
       Delay 10000,"Pls Wait.."
        ''Expanding First Node in Tree      
        intTotNodeCnt=GridControl.Nodes_2.Count  
        For intI=0 to intTotNodeCnt-1         
          If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
           GridControl.Nodes_2.Item(intI).Expand(True)
           blnFlag=False  
           Exit For
          End If
        Next
         Delay 10000,"Pls Wait.."
        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
          For intJ=0 to intTotNodeCnt-1
            If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strSource2) then
              GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
              intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(0).get_RowHandle
              GridControl.Keys "^[Home]"
              Call GridControl.ClearSelectionCore
              Call GridControl.FocusViewAndRow(GridControl,intRow-1)
              GridControl.SetFocusOnCurrentItem
              Call GridControl.SelectRowCore(intRow-1)
        
              If objGridCell.Exists = True then
                objGridCell.Click
              End If
              blnFlag = False 
              Exit For
            End If
          Next
           Delay 10000,"Pls Wait.."
              intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count
               For intK=0 to intTotNodeCnt-1
                  If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description)=Ucase(DescText) then
                      intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).get_RowHandle
                      Call GridControl.ClearSelectionCore
                      GridControl.set_FocusedRowHandle(intRow)
                      Call GridControl.FocusViewAndRow(GridControl,intRow)
                      GridControl.SetFocusOnCurrentItem
                      Call GridControl.SelectRowCore(intRow)
                      strTCRemarks = strTCRemarks & "<br />" & " Folder is found in Source"
                      log.Message "Folder is  found in Source"
                      Exit For   
                  else
                    strTCRemarks = strTCRemarks & "<br />" & "Folder is not found in Source"
                    log.Message "Folder is not found in Source"
                    Exit For   
                  End If 
               Next
               
      Call SClosesource()
      Delay 5000,"Pls Wait.."
      Call SClosesource()
      Call SourceWorkSpacevwr()
    End if

End Sub
Sub sChkSrcCopyPasteInsideWithSeriesSH(strParameters)
On Error Resume Next 
   Dim strSource1,StrSource2,strSource3,strTemp,GridControl,GridSourceTree,intTotNodeCnt,intI,intJ,intRow,intK,objEdge
   Dim objNewWorkspace,objWrkspace_popup,objOpenView,strTemp1,objNewWrkSpaceName,objNewWrkSpace_Txtbox,objNewWrkSpace_okbtn,objNewWrkSpace_Name
   Dim strDesc1,strDesc2,DescText,DescLocalText
   Dim objEditSource
   Dim objTemp, objStrClose
   Dim objEdgeFilter
   
    strSource1=getSplitValue(strParameters,"SOURCE")
    StrSource2=getSplitValue(strParameters,"LEVEL2SOURCE")
    StrSource3=getSplitValue(strParameters,"LEVEL3SOURCE")
    
'    strSource1="Test"
'    StrSource2="Automation_UIT2"
'    StrSource3="Test"

    Call sHome_Source
    
    strDesc1=aqDateTime.Now
    strDesc2=aqDateTime.Now
    DescText=Replace(strDesc1,"/","-")
    DescText=Replace(DescText,":","_")
    DescLocalText=DescText
    strWrkSpaceName=DescText
'    intSeriesID=getSplitValue(strParameters,"SERIESID")
'    if intSeriesID=0 then
'      Call sSourceseries
'      intSeriesID=strSourceFileText
'    End if 
    
    strTemp="WPFObject(""SourceTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""SourceTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    Delay 10000,"Pls Wait.."
    ''Selecting Country Name
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
          GridControl.Nodes_2.Item(intI).Expand(True)
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description       
          blnFlag=False  
          Exit For
        End If
    Next
    If blnFlag = True then
      strTCRemarks="Country Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
  
    Delay 10000,"Pls Wait.."
        blnFlag = True 
    ''Selecting Level2Source_Name
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
  For intJ=0 to intTotNodeCnt-1
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(StrSource2) then
        GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
        intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
'        Call GridSourceTree.ClickCell(intRow, "Edit")
        Call GridControl.ClearSelectionCore
        Call GridControl.FocusViewAndRow(GridControl,intRow)
        GridControl.SetFocusOnCurrentItem
        Call GridControl.SelectRowCore(intRow)
        log.Message "Level2 Source Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
        blnFlag = False 
        Exit For
      End If
    Next
    If blnFlag = True then
      log.Message "Level2 Source Name not found"
      strTCRemarks="Level2 Source Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
    
     Delay 10000,"Pls Wait.."
    blnFlag = True 
   
    Delay 2000,"Pls Wait.."

    strTemp="WPFObject(""ArrowControl"", """", 1)"
    Set objNewWorkspace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,20,True)
    If objNewWorkspace.Exists = True then
      objNewWorkspace.Click
       strTemp="WPFObject(""BarPopupBorderControl"", """", 1)"
      Set objWrkspace_popup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").FindChild("Name",strTemp,5,True)
      If objWrkspace_popup.Exists = True then
        strTemp="WPFObject(""ContentControlEx"", ""Open For Edit (Source)"", 2)"
        Set objopenforEdit=objWrkspace_popup.FindChild("Name",strTemp,8,True)
        If objopenforEdit.Exists then
          objopenforEdit.Click    
        End If
      End if
      
      strTemp1="WPFObject(""HwndSource: WorkspaceNamePrompt"", ""Please provide a new Workspace Name"")"
      Set objNewWrkSpaceName=Sys.Process("EdgeClient").WaitChild(strTemp1,50000)
      If objNewWrkSpaceName.Exists = True then
     
      ''Waiting for Workspace Name prompt
      strTemp="WPFObject(""FloatingContainerBorder"")"
      Set objNewWrkSpace_Name=Sys.Process("EdgeClient").WPFObject("HwndSource: WorkspaceNamePrompt", "Please provide a new Workspace Name").WPFObject("WorkspaceNamePrompt", "Please provide a new Workspace Name", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,15000000)
      If objNewWrkSpace_Name.Exists = True then
          strTemp="WPFObject(""ChangeNameTextEdit"")"
          ''Entering Workspace Name
          Set objNewWrkSpace_Txtbox=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
            If objNewWrkSpace_Txtbox.Exists = True then
              objNewWrkSpace_Txtbox.Click
              objNewWrkSpace_Txtbox.Text=strWrkSpaceName
      '        strTCRemarks=strTCRemarks & Chr(10) & "Entered Workspace Name - " & strWrkSpaceName
              ''Clicking on Ok Button 
              strTemp="WPFObject(""OkButton"")"
              Set objNewWrkSpace_okbtn=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
              If objNewWrkSpace_okbtn.Exists = True then
                objNewWrkSpace_okbtn.Click
                'Delay 5000,"Please wait..."
              End If
            End If
        End If
      End if 
     End if 
       
  
       ''Handling Validation for Source
    strTemp="WPFObject(""HwndSource: WindowContentHolder"", """")"
    Set objTemp=Sys.Process("EdgeClient").WaitChild(strTemp,10000)
    If objTemp.Exists = True then
      objTemp.Keys "[Enter]"
      strTestCaseResult = "FAIL"
      Exit Sub
    End If

    ''WorkSpace Edit Window
    strTemp="WPFObject(""LayoutPanel"", """", 2)"
    Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,13,True)
    If objTemp.Exists then
        Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WPFObject("SourceTreeListView")
        Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl")
       Delay 10000,"Pls Wait.."
        ''Expanding First Node in Tree      
        intTotNodeCnt=GridControl.Nodes_2.Count  
        For intI=0 to intTotNodeCnt-1         
          If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
           GridControl.Nodes_2.Item(intI).Expand(True)
           blnFlag=False  
           Exit For
          End If
        Next
         Delay 10000,"Pls Wait.."
        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
          For intJ=0 to intTotNodeCnt-1
            If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strSource2) then
              GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
              intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(0).get_RowHandle
              GridControl.Keys "^[Home]"
              Call GridControl.ClearSelectionCore
              Call GridControl.FocusViewAndRow(GridControl,intRow-1)
              GridControl.SetFocusOnCurrentItem
              Call GridControl.SelectRowCore(intRow-1)
        
              If objGridCell.Exists = True then
                objGridCell.Click
              End If
              blnFlag = False 
              Exit For
            End If
          Next

    End if
            
    strTemp="WPFObject(""SourceTreeListView"")"
    objEditSource=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WaitChild(strTemp,15000000)
    if objEditSource.Exists = True then

          strTemp="WPFObject(""ContentControlEx"", ""Add Folder"", 2)"
          Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 4).WPFObject("BarButtonItemLinkControl", "", 1).FindChild("Name",strTemp,50,True)
          If objNewWrkSpace_okbtn.Exists = True then
             If objNewWrkSpace_okbtn.Enabled = True then
              objNewWrkSpace_okbtn.Click
              strTCRemarks = strTCRemarks & "<br />" & "Add Folder is found in Source"
              log.Message "Add Folder is found in Source"
             Else
              strTCRemarks = strTCRemarks & "<br />" & "Add Folder is Disabled in Source"
              log.Message "Add Folder is Disabled in Source"
             End if
          Else
            strTCRemarks = strTCRemarks & "<br />" & "Add Folder is  not found in Source"
            log.Message "Add Folder is not found in Source"
          End If   
        
          
           Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 4).WPFObject("BarButtonItemLinkControl", "", 1)      
         Delay 8000,"New Folder..."

        ''Getting no. of Rows under level 2
        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count
        intK=intTotNodeCnt-1
    
        Set objDescCell=Aliases.EdgeClient.HwndSource_RibbonWindow.RibbonWindow.ContentControl.Grid.Grid.ContentControl.Grid.ContentControl.PART_ContainerContent.BarManager.DockPanel.DockLayoutManager.LayoutGroup.LayoutPanel2.Root.BarManager.AdornerDecorator.AdornedControl.Grid.DockPanel.SourceTreeListControl.SourceTreeListView.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK)
        Call objDescCell.Content.set_Description(DescText)
        strTCRemarks = strTCRemarks & "<br />" & "Description is added in new folder"
        log.Message "Description is added in new folder"
        
        Call objDescCell.Content.set_DescriptionLocal(DescLocalText)
        strTCRemarks = strTCRemarks & "<br />" & "Description local is added in new folder"
        log.Message "Description local is added in new folder"
            
        Delay 15000,"Pls Wait.."
        Call SClosesource()
        Delay 5000,"Pls Wait.."
        
        
                   
    End if
 
    strTemp="WPFObject(""SourceTreeListView"")"
    objEditSource=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WaitChild(strTemp,15000000)
    if objEditSource.Exists = True then
          sys.Keys("[Up]")
           Call sEdgeProcessor
            sys.Keys("^s")
        strTCRemarks = strTCRemarks & "<br />" & "Copy Folder Only is Click"
        log.Message "Copy Folder Only is Click"
        sys.Keys("[Down]")
        Call sEdgeProcessor
    
        sys.Keys("^i")
        'Call sEdgeProcessor
        strTCRemarks = strTCRemarks & "<br />" & "Paste Below is Clicked"
        log.Message "Paste Below is Clicked"
        
'        strTemp="WPFObject(""PART_ContainerContent"")"
'          Set objConfirm=Sys.Process("EdgeClient").WPFObject("HwndSource: WindowContentHolder", "Copy and paste source folder with series").WPFObject("WindowContentHolder", "Copy and paste source folder with series", 1).FindChild("Name",strTemp,50,True)
'          strTemp="WPFObject(""DXMessageBox"", """", 1)"
'          Set objConfirm=objConfirm.WaitChild(strTemp,180000)
'          If objConfirm.Exists = True then
'            objConfirm.Keys "[Enter]"
           Delay 30000,"Pls Wait.."
'            Call sEdgeProcessor
'          End if
            
         strDesc1=aqDateTime.Now
          strDesc2=aqDateTime.Now
          DescText=Replace(strDesc1,"/","-")
          DescText=Replace(DescText,":","_")
                        
          intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count
          intK=intTotNodeCnt-2
    
          Set objDescCell=Aliases.EdgeClient.HwndSource_RibbonWindow.RibbonWindow.ContentControl.Grid.Grid.ContentControl.Grid.ContentControl.PART_ContainerContent.BarManager.DockPanel.DockLayoutManager.LayoutGroup.LayoutPanel2.Root.BarManager.AdornerDecorator.AdornedControl.Grid.DockPanel.SourceTreeListControl.SourceTreeListView.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK)
          Call objDescCell.Content.set_Description(DescText)
          strTCRemarks = strTCRemarks & "<br />" & "Description is Updated in Pasted folder"
          log.Message "Description is updated in Pasted folder"
        
          Call objDescCell.Content.set_DescriptionLocal(DescText)
          strTCRemarks = strTCRemarks & "<br />" & "Description local is Updated in Pasted folder"
          log.Message "Description local is Updated in Pasted folder"
                        
    End if
    
    Dim objSaveWrk,objWait  
     set objSaveWrk=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 12).WPFObject("BarSubItemLinkControl", "", 1)
    strTemp="WPFObject(""ContentControlEx"", ""Workspace"", 2)"
    Set objTemp=objSaveWrk.FindChild("Name",strTemp,50)
    objWait=1
    Do until objTemp.Enabled = true 
        If objWait < 20 Then
          Delay 1000,"Pls Wait... Form is loading..."
          objWait=objWait+1
        else
          Call SClosesource()
          Call SourceWorkSpacevwr()
          Exit Sub
        end if 
    Loop  
    
    strTemp="WPFObject(""ContentControlEx"", ""Workspace"", 2)"
    Set objWrkSpace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,50,True)
    If objWrkSpace.Exists = True then
      Delay(1000)
      objWrkSpace.Click
      Delay(1000)
      strTemp="WPFObject(""PopupMenuBarControl"", """", 1)"
      Set objwrkspacepop=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").Findchild("Name",strTemp,50,True)
      'Set objwrkspacepop=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 2).WPFObject("BarButtonItemLinkControl", "", 1).WPFObject("ContentControlEx", "Upload Workspace", 2)
      If objwrkspacepop.Exists = True then
        strTemp="WPFObject(""ContentControlEx"", ""Upload Workspace"", 2)"
        set objwrkspcUpload=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).FindChild("Name",strTemp,50,True)
        If objwrkspcUpload.Exists = True then
          objwrkspcUpload.Click
          'Delay 1000,"Pls Wait.."
          strTemp="WPFObject(""PART_ContainerContent"")"
        Set objConfirm=Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "Confirm save.").FindChild("Name",strTemp,50,True)

          If objConfirm.Exists = True then
            Sys.Keys "[Enter]"
            'Delay 8000,"Uploading..."
            Set objConfirm = Sys.Process("EdgeClient")._
            Waitchild("WPFObject(""HwndSource: CustomMessageBoxWindow"", ""Upload Workspace"")",600000)._
            Waitchild("WPFObject(""CustomMessageBoxWindow"", ""Upload Workspace"", 1)",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""FloatingContainerBorder"")",60000)._
            Waitchild("WPFObject(""FloatingContainerBackground"")",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""FloatingContainerBody"")",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""PART_ContainerContent"")",60000)
            
            If objConfirm.Exists = True then
              Sys.Keys("O")

              'Delay 30000,"Pls Wait.."
              Call sEdgeProcessor
            End if
          End if
        End if
      End if
    End if

End Sub

Sub sChkSrcCutPasteInsideSH(strParameters)
On Error Resume Next 
   Dim strSource1,StrSource2,strSource3,strTemp,GridControl,GridSourceTree,intTotNodeCnt,intI,intJ,intRow,intK,objEdge
   Dim objNewWorkspace,objWrkspace_popup,objOpenView,strTemp1,objNewWrkSpaceName,objNewWrkSpace_Txtbox,objNewWrkSpace_okbtn,objNewWrkSpace_Name
   Dim strDesc1,strDesc2,DescText,DescLocalText
   Dim objEditSource
   Dim objTemp, objStrClose
   Dim objEdgeFilter
   
    strSource1=getSplitValue(strParameters,"SOURCE")
    StrSource2=getSplitValue(strParameters,"LEVEL2SOURCE")
    StrSource3=getSplitValue(strParameters,"LEVEL3SOURCE")
    
'    strSource1="Test"
'    StrSource2="Automation_UIT2"
'    StrSource3="Test"

    Call sHome_Source
    
    strDesc1=aqDateTime.Now
    strDesc2=aqDateTime.Now
    DescText=Replace(strDesc1,"/","-")
    DescText=Replace(DescText,":","_")
    DescLocalText=DescText
    strWrkSpaceName=DescText
    
    strTemp="WPFObject(""SourceTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""SourceTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    Delay 10000,"Pls Wait.."
    ''Selecting Country Name
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
          GridControl.Nodes_2.Item(intI).Expand(True)
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description       
          blnFlag=False  
          Exit For
        End If
    Next
    If blnFlag = True then
      strTCRemarks="Country Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
  
    Delay 10000,"Pls Wait.."
        blnFlag = True 
    ''Selecting Level2Source_Name
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
  For intJ=0 to intTotNodeCnt-1
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(StrSource2) then
        GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
        intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
'        Call GridSourceTree.ClickCell(intRow, "Edit")
        Call GridControl.ClearSelectionCore
        Call GridControl.FocusViewAndRow(GridControl,intRow)
        GridControl.SetFocusOnCurrentItem
        Call GridControl.SelectRowCore(intRow)
        log.Message "Level2 Source Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
        blnFlag = False 
        Exit For
      End If
    Next
    If blnFlag = True then
      log.Message "Level2 Source Name not found"
      strTCRemarks="Level2 Source Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
    
     Delay 10000,"Pls Wait.."
    blnFlag = True 
   
    Delay 2000,"Pls Wait.."

    strTemp="WPFObject(""ArrowControl"", """", 1)"
    Set objNewWorkspace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,20,True)
    If objNewWorkspace.Exists = True then
      objNewWorkspace.Click
       strTemp="WPFObject(""BarPopupBorderControl"", """", 1)"
      Set objWrkspace_popup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").FindChild("Name",strTemp,5,True)
      If objWrkspace_popup.Exists = True then
        strTemp="WPFObject(""ContentControlEx"", ""Open For Edit (Source)"", 2)"
        Set objopenforEdit=objWrkspace_popup.FindChild("Name",strTemp,8,True)
        If objopenforEdit.Exists then
          objopenforEdit.Click    
        End If
      End if
      
      strTemp1="WPFObject(""HwndSource: WorkspaceNamePrompt"", ""Please provide a new Workspace Name"")"
      Set objNewWrkSpaceName=Sys.Process("EdgeClient").WaitChild(strTemp1,50000)
      If objNewWrkSpaceName.Exists = True then
     
      ''Waiting for Workspace Name prompt
      strTemp="WPFObject(""FloatingContainerBorder"")"
      Set objNewWrkSpace_Name=Sys.Process("EdgeClient").WPFObject("HwndSource: WorkspaceNamePrompt", "Please provide a new Workspace Name").WPFObject("WorkspaceNamePrompt", "Please provide a new Workspace Name", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,15000000)
      If objNewWrkSpace_Name.Exists = True then
          strTemp="WPFObject(""ChangeNameTextEdit"")"
          ''Entering Workspace Name
          Set objNewWrkSpace_Txtbox=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
            If objNewWrkSpace_Txtbox.Exists = True then
              objNewWrkSpace_Txtbox.Click
              objNewWrkSpace_Txtbox.Text=strWrkSpaceName
      '        strTCRemarks=strTCRemarks & Chr(10) & "Entered Workspace Name - " & strWrkSpaceName
              ''Clicking on Ok Button 
              strTemp="WPFObject(""OkButton"")"
              Set objNewWrkSpace_okbtn=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
              If objNewWrkSpace_okbtn.Exists = True then
                objNewWrkSpace_okbtn.Click
                'Delay 5000,"Please wait..."
              End If
            End If
        End If
      End if 
     End if 
       
  
       ''Handling Validation for Source
    strTemp="WPFObject(""HwndSource: WindowContentHolder"", """")"
    Set objTemp=Sys.Process("EdgeClient").WaitChild(strTemp,10000)
    If objTemp.Exists = True then
      objTemp.Keys "[Enter]"
      strTestCaseResult = "FAIL"
      Exit Sub
    End If

    ''WorkSpace Edit Window
    strTemp="WPFObject(""LayoutPanel"", """", 2)"
    Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,13,True)
    If objTemp.Exists then
        Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WPFObject("SourceTreeListView")
        Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl")
       Delay 10000,"Pls Wait.."
        ''Expanding First Node in Tree      
        intTotNodeCnt=GridControl.Nodes_2.Count  
        For intI=0 to intTotNodeCnt-1         
          If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
           GridControl.Nodes_2.Item(intI).Expand(True)
           blnFlag=False  
           Exit For
          End If
        Next
         Delay 10000,"Pls Wait.."
        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
          For intJ=0 to intTotNodeCnt-1
            If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strSource2) then
              GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
              intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(0).get_RowHandle
              GridControl.Keys "^[Home]"
              Call GridControl.ClearSelectionCore
              Call GridControl.FocusViewAndRow(GridControl,intRow-1)
              GridControl.SetFocusOnCurrentItem
              Call GridControl.SelectRowCore(intRow-1)
        
              If objGridCell.Exists = True then
                objGridCell.Click
              End If
              blnFlag = False 
              Exit For
            End If
          Next
    End if
            
    strTemp="WPFObject(""SourceTreeListView"")"
    objEditSource=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WaitChild(strTemp,15000000)
    if objEditSource.Exists = True then

          strTemp="WPFObject(""ContentControlEx"", ""Add Folder"", 2)"
          Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 4).WPFObject("BarButtonItemLinkControl", "", 1).FindChild("Name",strTemp,50,True)
          If objNewWrkSpace_okbtn.Exists = True then
             If objNewWrkSpace_okbtn.Enabled = True then
              objNewWrkSpace_okbtn.Click
              strTCRemarks = strTCRemarks & "<br />" & "Add Folder is found in Source"
              log.Message "Add Folder is found in Source"
             Else
              strTCRemarks = strTCRemarks & "<br />" & "Add Folder is Disabled in Source"
              log.Message "Add Folder is Disabled in Source"
             End if
          Else
            strTCRemarks = strTCRemarks & "<br />" & "Add Folder is  not found in Source"
            log.Message "Add Folder is not found in Source"
          End If   
        
          
           Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 4).WPFObject("BarButtonItemLinkControl", "", 1)      
         Delay 8000,"New Folder..."

        ''Getting no. of Rows under level 2
        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count
        intK=intTotNodeCnt-1
    
        Set objDescCell=Aliases.EdgeClient.HwndSource_RibbonWindow.RibbonWindow.ContentControl.Grid.Grid.ContentControl.Grid.ContentControl.PART_ContainerContent.BarManager.DockPanel.DockLayoutManager.LayoutGroup.LayoutPanel2.Root.BarManager.AdornerDecorator.AdornedControl.Grid.DockPanel.SourceTreeListControl.SourceTreeListView.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK)
        Call objDescCell.Content.set_Description(DescText)
        strTCRemarks = strTCRemarks & "<br />" & "Description is added in new folder"
        log.Message "Description is added in new folder"
        
        Call objDescCell.Content.set_DescriptionLocal(DescLocalText)
        strTCRemarks = strTCRemarks & "<br />" & "Description local is added in new folder"
        log.Message "Description local is added in new folder"
            
        Delay 15000,"Pls Wait.."
        Call SClosesource()
        Delay 5000,"Pls Wait.."
                       
    End if
 
    strTemp="WPFObject(""SourceTreeListView"")"
    objEditSource=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WaitChild(strTemp,15000000)
    if objEditSource.Exists = True then
          sys.Keys("[Up]")
          Call sEdgeProcessor
        sys.Keys("^u")
        strTCRemarks = strTCRemarks & "<br />" & "Cut Folder is Click"
        log.Message "Cut Folder is Click"
        sys.Keys("[Down]")
        Call sEdgeProcessor
    
        sys.Keys("^i")
        'Call sEdgeProcessor
        strTCRemarks = strTCRemarks & "<br />" & "Paste inside is Clicked"
        log.Message "Paste inside is Clicked"
        
        strTemp="WPFObject(""PART_ContainerContent"")"
        Set objConfirm=Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "Cut and paste source series").WPFObject("CustomMessageBoxWindow", "Cut and paste source series", 1).FindChild("Name",strTemp,50,True)
'        strTemp="WPFObject(""DXMessageBox"", """", 1)"
'        Set objConfirm=objConfirm.WaitChild(strTemp,180000)
        If objConfirm.Exists = True then
          Sys.Keys "[Enter]"
          'Delay 30000,"Pls Wait.."
          'Call sEdgeProcessor
        End if

    End if
    
    Dim objSaveWrk,objWait  
     set objSaveWrk=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 12).WPFObject("BarSubItemLinkControl", "", 1)
    strTemp="WPFObject(""ContentControlEx"", ""Workspace"", 2)"
    Set objTemp=objSaveWrk.FindChild("Name",strTemp,50)
    objWait=1
    Do until objTemp.Enabled = true 
        If objWait < 20 Then
          Delay 1000,"Pls Wait... Form is loading..."
          objWait=objWait+1
        else
          Call SClosesource()
          Call SourceWorkSpacevwr()
          Exit Sub
        end if 
    Loop 
    
    strTemp="WPFObject(""ContentControlEx"", ""Workspace"", 2)"
    Set objWrkSpace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,50,True)
    If objWrkSpace.Exists = True then
      Delay(1000)
      objWrkSpace.Click
      Delay(1000)
      strTemp="WPFObject(""PopupMenuBarControl"", """", 1)"
      Set objwrkspacepop=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").Findchild("Name",strTemp,50,True)
      'Set objwrkspacepop=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 2).WPFObject("BarButtonItemLinkControl", "", 1).WPFObject("ContentControlEx", "Upload Workspace", 2)
      If objwrkspacepop.Exists = True then
        strTemp="WPFObject(""ContentControlEx"", ""Upload Workspace"", 2)"
        set objwrkspcUpload=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).FindChild("Name",strTemp,50,True)
        If objwrkspcUpload.Exists = True then
          objwrkspcUpload.Click
          'Delay 1000,"Pls Wait.."
          strTemp="WPFObject(""PART_ContainerContent"")"
        Set objConfirm=Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "Confirm save.").FindChild("Name",strTemp,50,True)

          If objConfirm.Exists = True then
            Sys.Keys "[Enter]"
            'Delay 8000,"Uploading..."
            Set objConfirm = Sys.Process("EdgeClient")._
            Waitchild("WPFObject(""HwndSource: CustomMessageBoxWindow"", ""Upload Workspace"")",600000)._
            Waitchild("WPFObject(""CustomMessageBoxWindow"", ""Upload Workspace"", 1)",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""FloatingContainerBorder"")",60000)._
            Waitchild("WPFObject(""FloatingContainerBackground"")",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""FloatingContainerBody"")",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""PART_ContainerContent"")",60000)
            
            If objConfirm.Exists = True then
              Sys.Keys("O")

              Delay 10000,"Pls Wait.."
''              Call sEdgeProcessor
            End if
          End if
        End if
      End if
    End if
    Call sHome_Source
    
    strTemp="WPFObject(""SourceTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""SourceTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    Delay 10000,"Pls Wait.."
    ''Selecting Country Name
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
          GridControl.Nodes_2.Item(intI).Expand(True)
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description       
          blnFlag=False  
          Exit For
        End If
    Next
    If blnFlag = True then
      strTCRemarks="Country Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
  
    Delay 10000,"Pls Wait.."
        blnFlag = True 
    ''Selecting Level2Source_Name
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
  For intJ=0 to intTotNodeCnt-1
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(StrSource2) then
        GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
        intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
'        Call GridSourceTree.ClickCell(intRow, "Edit")
        Call GridControl.ClearSelectionCore
        Call GridControl.FocusViewAndRow(GridControl,intRow)
        GridControl.SetFocusOnCurrentItem
        Call GridControl.SelectRowCore(intRow)
        log.Message "Level2 Source Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
        blnFlag = False 
        Exit For
      End If
    Next
    If blnFlag = True then
      log.Message "Level2 Source Name not found"
      strTCRemarks="Level2 Source Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
    
     Delay 10000,"Pls Wait.."
   ' blnFlag = True 
   
    Delay 2000,"Pls Wait.."

    strTemp="WPFObject(""ArrowControl"", """", 1)"
    Set objNewWorkspace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,20,True)
    If objNewWorkspace.Exists = True then
      objNewWorkspace.Click
       strTemp="WPFObject(""BarPopupBorderControl"", """", 1)"
      Set objWrkspace_popup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").FindChild("Name",strTemp,5,True)
      If objWrkspace_popup.Exists = True then
        strTemp="WPFObject(""ContentControlEx"", ""Open For Edit (Source)"", 2)"
        Set objopenforEdit=objWrkspace_popup.FindChild("Name",strTemp,8,True)
        If objopenforEdit.Exists then
          objopenforEdit.Click    
        End If
      End if
      
      strTemp1="WPFObject(""HwndSource: WorkspaceNamePrompt"", ""Please provide a new Workspace Name"")"
      Set objNewWrkSpaceName=Sys.Process("EdgeClient").WaitChild(strTemp1,50000)
      If objNewWrkSpaceName.Exists = True then
     
      ''Waiting for Workspace Name prompt
      strTemp="WPFObject(""FloatingContainerBorder"")"
      Set objNewWrkSpace_Name=Sys.Process("EdgeClient").WPFObject("HwndSource: WorkspaceNamePrompt", "Please provide a new Workspace Name").WPFObject("WorkspaceNamePrompt", "Please provide a new Workspace Name", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,15000000)
      If objNewWrkSpace_Name.Exists = True then
          strTemp="WPFObject(""ChangeNameTextEdit"")"
          ''Entering Workspace Name
          Set objNewWrkSpace_Txtbox=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
            If objNewWrkSpace_Txtbox.Exists = True then
              objNewWrkSpace_Txtbox.Click
              objNewWrkSpace_Txtbox.Text=strWrkSpaceName
      '        strTCRemarks=strTCRemarks & Chr(10) & "Entered Workspace Name - " & strWrkSpaceName
              ''Clicking on Ok Button 
              strTemp="WPFObject(""OkButton"")"
              Set objNewWrkSpace_okbtn=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
              If objNewWrkSpace_okbtn.Exists = True then
                objNewWrkSpace_okbtn.Click
                'Delay 5000,"Please wait..."
              End If
            End If
        End If
      End if 
     End if 
       
  
       ''Handling Validation for Source
    strTemp="WPFObject(""HwndSource: WindowContentHolder"", """")"
    Set objTemp=Sys.Process("EdgeClient").WaitChild(strTemp,10000)
    If objTemp.Exists = True then
      objTemp.Keys "[Enter]"
      strTestCaseResult = "FAIL"
      Exit Sub
    End If

    ''WorkSpace Edit Window
    strTemp="WPFObject(""LayoutPanel"", """", 2)"
    Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,13,True)
    If objTemp.Exists then
        Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WPFObject("SourceTreeListView")
        Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl")
       Delay 10000,"Pls Wait.."
        ''Expanding First Node in Tree      
        intTotNodeCnt=GridControl.Nodes_2.Count  
        For intI=0 to intTotNodeCnt-1         
          If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
           GridControl.Nodes_2.Item(intI).Expand(True)
           blnFlag=False  
           Exit For
          End If
        Next
         Delay 10000,"Pls Wait.."
        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
          For intJ=0 to intTotNodeCnt-1
            If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strSource2) then
              GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
              intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(0).get_RowHandle
              GridControl.Keys "^[Home]"
              Call GridControl.ClearSelectionCore
              Call GridControl.FocusViewAndRow(GridControl,intRow-1)
              GridControl.SetFocusOnCurrentItem
              Call GridControl.SelectRowCore(intRow-1)
        
              If objGridCell.Exists = True then
                objGridCell.Click
              End If
              blnFlag = False 
              Exit For
            End If
          Next
           Delay 10000,"Pls Wait.."
              intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count
               For intK=0 to intTotNodeCnt-1
                  If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description)=Ucase(DescText) then
                      intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).get_RowHandle
                      Call GridControl.ClearSelectionCore
                      GridControl.set_FocusedRowHandle(intRow)
                      Call GridControl.FocusViewAndRow(GridControl,intRow)
                      GridControl.SetFocusOnCurrentItem
                      Call GridControl.SelectRowCore(intRow)
                      strTCRemarks = strTCRemarks & "<br />" & " Folder is found in Source"
                      log.Message "Folder is  found in Source"
                      Exit For   
                  else
                    strTCRemarks = strTCRemarks & "<br />" & "Folder is not found in Source"
                    log.Message "Folder is not found in Source"
                    Exit For   
                  End If 
               Next
               
      Call SClosesource()
      Delay 5000,"Pls Wait.."
      Call SClosesource()
      Call SourceWorkSpacevwr()
    End if

End Sub
Sub sChkSrcCutPasteAboveSH(strParameters)
On Error Resume Next 
   Dim strSource1,StrSource2,strSource3,strTemp,GridControl,GridSourceTree,intTotNodeCnt,intI,intJ,intRow,intK,objEdge
   Dim objNewWorkspace,objWrkspace_popup,objOpenView,strTemp1,objNewWrkSpaceName,objNewWrkSpace_Txtbox,objNewWrkSpace_okbtn,objNewWrkSpace_Name
   Dim strDesc1,strDesc2,DescText,DescLocalText
   Dim objEditSource
   Dim objTemp, objStrClose
   Dim objEdgeFilter
   
    strSource1=getSplitValue(strParameters,"SOURCE")
    StrSource2=getSplitValue(strParameters,"LEVEL2SOURCE")
    StrSource3=getSplitValue(strParameters,"LEVEL3SOURCE")
    
'    strSource1="Test"
'    StrSource2="Automation_UIT2"
'    StrSource3="Test"

    Call sHome_Source
    
    strDesc1=aqDateTime.Now
    strDesc2=aqDateTime.Now
    DescText=Replace(strDesc1,"/","-")
    DescText=Replace(DescText,":","_")
    DescLocalText=DescText
    strWrkSpaceName=DescText
    
    strTemp="WPFObject(""SourceTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""SourceTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    Delay 10000,"Pls Wait.."
    ''Selecting Country Name
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
          GridControl.Nodes_2.Item(intI).Expand(True)
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description       
          blnFlag=False  
          Exit For
        End If
    Next
    If blnFlag = True then
      strTCRemarks="Country Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
  
    Delay 10000,"Pls Wait.."
        blnFlag = True 
    ''Selecting Level2Source_Name
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
  For intJ=0 to intTotNodeCnt-1
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(StrSource2) then
        GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
        intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
'        Call GridSourceTree.ClickCell(intRow, "Edit")
        Call GridControl.ClearSelectionCore
        Call GridControl.FocusViewAndRow(GridControl,intRow)
        GridControl.SetFocusOnCurrentItem
        Call GridControl.SelectRowCore(intRow)
        log.Message "Level2 Source Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
        blnFlag = False 
        Exit For
      End If
    Next
    If blnFlag = True then
      log.Message "Level2 Source Name not found"
      strTCRemarks="Level2 Source Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
    
     Delay 10000,"Pls Wait.."
    blnFlag = True 
   
    Delay 2000,"Pls Wait.."

    strTemp="WPFObject(""ArrowControl"", """", 1)"
    Set objNewWorkspace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,20,True)
    If objNewWorkspace.Exists = True then
      objNewWorkspace.Click
       strTemp="WPFObject(""BarPopupBorderControl"", """", 1)"
      Set objWrkspace_popup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").FindChild("Name",strTemp,5,True)
      If objWrkspace_popup.Exists = True then
        strTemp="WPFObject(""ContentControlEx"", ""Open For Edit (Source)"", 2)"
        Set objopenforEdit=objWrkspace_popup.FindChild("Name",strTemp,8,True)
        If objopenforEdit.Exists then
          objopenforEdit.Click    
        End If
      End if
      
      strTemp1="WPFObject(""HwndSource: WorkspaceNamePrompt"", ""Please provide a new Workspace Name"")"
      Set objNewWrkSpaceName=Sys.Process("EdgeClient").WaitChild(strTemp1,50000)
      If objNewWrkSpaceName.Exists = True then
     
      ''Waiting for Workspace Name prompt
      strTemp="WPFObject(""FloatingContainerBorder"")"
      Set objNewWrkSpace_Name=Sys.Process("EdgeClient").WPFObject("HwndSource: WorkspaceNamePrompt", "Please provide a new Workspace Name").WPFObject("WorkspaceNamePrompt", "Please provide a new Workspace Name", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,15000000)
      If objNewWrkSpace_Name.Exists = True then
          strTemp="WPFObject(""ChangeNameTextEdit"")"
          ''Entering Workspace Name
          Set objNewWrkSpace_Txtbox=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
            If objNewWrkSpace_Txtbox.Exists = True then
              objNewWrkSpace_Txtbox.Click
              objNewWrkSpace_Txtbox.Text=strWrkSpaceName
      '        strTCRemarks=strTCRemarks & Chr(10) & "Entered Workspace Name - " & strWrkSpaceName
              ''Clicking on Ok Button 
              strTemp="WPFObject(""OkButton"")"
              Set objNewWrkSpace_okbtn=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
              If objNewWrkSpace_okbtn.Exists = True then
                objNewWrkSpace_okbtn.Click
                'Delay 5000,"Please wait..."
              End If
            End If
        End If
      End if 
     End if 
       
  
       ''Handling Validation for Source
    strTemp="WPFObject(""HwndSource: WindowContentHolder"", """")"
    Set objTemp=Sys.Process("EdgeClient").WaitChild(strTemp,10000)
    If objTemp.Exists = True then
      objTemp.Keys "[Enter]"
      strTestCaseResult = "FAIL"
      Exit Sub
    End If

    ''WorkSpace Edit Window
    strTemp="WPFObject(""LayoutPanel"", """", 2)"
    Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,13,True)
    If objTemp.Exists then
        Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WPFObject("SourceTreeListView")
        Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl")
       Delay 10000,"Pls Wait.."
        ''Expanding First Node in Tree      
        intTotNodeCnt=GridControl.Nodes_2.Count  
        For intI=0 to intTotNodeCnt-1         
          If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
           GridControl.Nodes_2.Item(intI).Expand(True)
           blnFlag=False  
           Exit For
          End If
        Next
         Delay 10000,"Pls Wait.."
        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
          For intJ=0 to intTotNodeCnt-1
            If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strSource2) then
              GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
              intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(0).get_RowHandle
              GridControl.Keys "^[Home]"
              Call GridControl.ClearSelectionCore
              Call GridControl.FocusViewAndRow(GridControl,intRow-1)
              GridControl.SetFocusOnCurrentItem
              Call GridControl.SelectRowCore(intRow-1)
        
              If objGridCell.Exists = True then
                objGridCell.Click
              End If
              blnFlag = False 
              Exit For
            End If
          Next

    End if
            
    strTemp="WPFObject(""SourceTreeListView"")"
    objEditSource=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WaitChild(strTemp,15000000)
    if objEditSource.Exists = True then

          strTemp="WPFObject(""ContentControlEx"", ""Add Folder"", 2)"
          Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 4).WPFObject("BarButtonItemLinkControl", "", 1).FindChild("Name",strTemp,50,True)
          If objNewWrkSpace_okbtn.Exists = True then
             If objNewWrkSpace_okbtn.Enabled = True then
              objNewWrkSpace_okbtn.Click
              strTCRemarks = strTCRemarks & "<br />" & "Add Folder is found in Source"
              log.Message "Add Folder is found in Source"
             Else
              strTCRemarks = strTCRemarks & "<br />" & "Add Folder is Disabled in Source"
              log.Message "Add Folder is Disabled in Source"
             End if
          Else
            strTCRemarks = strTCRemarks & "<br />" & "Add Folder is  not found in Source"
            log.Message "Add Folder is not found in Source"
          End If   
        
          
           Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 4).WPFObject("BarButtonItemLinkControl", "", 1)      
         Delay 8000,"New Folder..."

        ''Getting no. of Rows under level 2
        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count
        intK=intTotNodeCnt-1
    
        Set objDescCell=Aliases.EdgeClient.HwndSource_RibbonWindow.RibbonWindow.ContentControl.Grid.Grid.ContentControl.Grid.ContentControl.PART_ContainerContent.BarManager.DockPanel.DockLayoutManager.LayoutGroup.LayoutPanel2.Root.BarManager.AdornerDecorator.AdornedControl.Grid.DockPanel.SourceTreeListControl.SourceTreeListView.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK)
        Call objDescCell.Content.set_Description(DescText)
        strTCRemarks = strTCRemarks & "<br />" & "Description is added in new folder"
        log.Message "Description is added in new folder"
        
        Call objDescCell.Content.set_DescriptionLocal(DescLocalText)
        strTCRemarks = strTCRemarks & "<br />" & "Description local is added in new folder"
        log.Message "Description local is added in new folder"
            
        Delay 15000,"Pls Wait.."
        Call SClosesource()
        Delay 5000,"Pls Wait.."
                       
    End if
 
    strTemp="WPFObject(""SourceTreeListView"")"
    objEditSource=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WaitChild(strTemp,15000000)
    if objEditSource.Exists = True then
          sys.Keys("[Up]")
          Call sEdgeProcessor
        sys.Keys("^u")
        strTCRemarks = strTCRemarks & "<br />" & "Cut Folder is Click"
        log.Message "Cut Folder is Click"
        sys.Keys("[Down]")
        Call sEdgeProcessor
    
        sys.Keys("^o")
        'Call sEdgeProcessor
        strTCRemarks = strTCRemarks & "<br />" & "Paste Above is Clicked"
        log.Message "Paste Above is Clicked"
        
        strTemp="WPFObject(""PART_ContainerContent"")"
        Set objConfirm=Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "Cut and paste source series").WPFObject("CustomMessageBoxWindow", "Cut and paste source series", 1).FindChild("Name",strTemp,50,True)
'        strTemp="WPFObject(""DXMessageBox"", """", 1)"
'        Set objConfirm=objConfirm.WaitChild(strTemp,180000)
        If objConfirm.Exists = True then
          Sys.Keys "[Enter]"
          'Delay 30000,"Pls Wait.."
          'Call sEdgeProcessor
        End if

    End if
    
    Dim objSaveWrk,objWait  
     set objSaveWrk=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 12).WPFObject("BarSubItemLinkControl", "", 1)
    strTemp="WPFObject(""ContentControlEx"", ""Workspace"", 2)"
    Set objTemp=objSaveWrk.FindChild("Name",strTemp,50)
    objWait=1
    Do until objTemp.Enabled = true 
        If objWait < 20 Then
          Delay 1000,"Pls Wait... Form is loading..."
          objWait=objWait+1
        else
          Call SClosesource()
          Call SourceWorkSpacevwr()
          Exit Sub
        end if 
    Loop  
    
    strTemp="WPFObject(""ContentControlEx"", ""Workspace"", 2)"
    Set objWrkSpace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,50,True)
    If objWrkSpace.Exists = True then
      Delay(1000)
      objWrkSpace.Click
      Delay(1000)
      strTemp="WPFObject(""PopupMenuBarControl"", """", 1)"
      Set objwrkspacepop=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").Findchild("Name",strTemp,50,True)
      'Set objwrkspacepop=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 2).WPFObject("BarButtonItemLinkControl", "", 1).WPFObject("ContentControlEx", "Upload Workspace", 2)
      If objwrkspacepop.Exists = True then
        strTemp="WPFObject(""ContentControlEx"", ""Upload Workspace"", 2)"
        set objwrkspcUpload=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).FindChild("Name",strTemp,50,True)
        If objwrkspcUpload.Exists = True then
          objwrkspcUpload.Click
          'Delay 1000,"Pls Wait.."
         strTemp="WPFObject(""PART_ContainerContent"")"
        Set objConfirm=Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "Confirm save.").FindChild("Name",strTemp,50,True)

          If objConfirm.Exists = True then
            Sys.Keys "[Enter]"
            'Delay 8000,"Uploading..."
            Set objConfirm = Sys.Process("EdgeClient")._
            Waitchild("WPFObject(""HwndSource: CustomMessageBoxWindow"", ""Upload Workspace"")",600000)._
            Waitchild("WPFObject(""CustomMessageBoxWindow"", ""Upload Workspace"", 1)",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""FloatingContainerBorder"")",60000)._
            Waitchild("WPFObject(""FloatingContainerBackground"")",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""FloatingContainerBody"")",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""PART_ContainerContent"")",60000)
            
            If objConfirm.Exists = True then
              Sys.Keys("O")
              Delay 10000,"Pls Wait.."
''              Call sEdgeProcessor
            End if
          End if
        End if
      End if
    End if
    Call sHome_Source
    
    strTemp="WPFObject(""SourceTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""SourceTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    Delay 10000,"Pls Wait.."
    ''Selecting Country Name
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
          GridControl.Nodes_2.Item(intI).Expand(True)
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description       
          blnFlag=False  
          Exit For
        End If
    Next
    If blnFlag = True then
      strTCRemarks="Country Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
  
    Delay 10000,"Pls Wait.."
        blnFlag = True 
    ''Selecting Level2Source_Name
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
  For intJ=0 to intTotNodeCnt-1
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(StrSource2) then
        GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
        intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
'        Call GridSourceTree.ClickCell(intRow, "Edit")
        Call GridControl.ClearSelectionCore
        Call GridControl.FocusViewAndRow(GridControl,intRow)
        GridControl.SetFocusOnCurrentItem
        Call GridControl.SelectRowCore(intRow)
        log.Message "Level2 Source Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
        blnFlag = False 
        Exit For
      End If
    Next
    If blnFlag = True then
      log.Message "Level2 Source Name not found"
      strTCRemarks="Level2 Source Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
    
     Delay 10000,"Pls Wait.."
    'blnFlag = True 
   
    Delay 2000,"Pls Wait.."

    strTemp="WPFObject(""ArrowControl"", """", 1)"
    Set objNewWorkspace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,20,True)
    If objNewWorkspace.Exists = True then
      objNewWorkspace.Click
       strTemp="WPFObject(""BarPopupBorderControl"", """", 1)"
      Set objWrkspace_popup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").FindChild("Name",strTemp,5,True)
      If objWrkspace_popup.Exists = True then
        strTemp="WPFObject(""ContentControlEx"", ""Open For Edit (Source)"", 2)"
        Set objopenforEdit=objWrkspace_popup.FindChild("Name",strTemp,8,True)
        If objopenforEdit.Exists then
          objopenforEdit.Click    
        End If
      End if
      
      strTemp1="WPFObject(""HwndSource: WorkspaceNamePrompt"", ""Please provide a new Workspace Name"")"
      Set objNewWrkSpaceName=Sys.Process("EdgeClient").WaitChild(strTemp1,50000)
      If objNewWrkSpaceName.Exists = True then
     
      ''Waiting for Workspace Name prompt
      strTemp="WPFObject(""FloatingContainerBorder"")"
      Set objNewWrkSpace_Name=Sys.Process("EdgeClient").WPFObject("HwndSource: WorkspaceNamePrompt", "Please provide a new Workspace Name").WPFObject("WorkspaceNamePrompt", "Please provide a new Workspace Name", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,15000000)
      If objNewWrkSpace_Name.Exists = True then
          strTemp="WPFObject(""ChangeNameTextEdit"")"
          ''Entering Workspace Name
          Set objNewWrkSpace_Txtbox=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
            If objNewWrkSpace_Txtbox.Exists = True then
              objNewWrkSpace_Txtbox.Click
              objNewWrkSpace_Txtbox.Text=strWrkSpaceName
      '        strTCRemarks=strTCRemarks & Chr(10) & "Entered Workspace Name - " & strWrkSpaceName
              ''Clicking on Ok Button 
              strTemp="WPFObject(""OkButton"")"
              Set objNewWrkSpace_okbtn=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
              If objNewWrkSpace_okbtn.Exists = True then
                objNewWrkSpace_okbtn.Click
                'Delay 5000,"Please wait..."
              End If
            End If
        End If
      End if 
     End if 
       
  
       ''Handling Validation for Source
    strTemp="WPFObject(""HwndSource: WindowContentHolder"", """")"
    Set objTemp=Sys.Process("EdgeClient").WaitChild(strTemp,10000)
    If objTemp.Exists = True then
      objTemp.Keys "[Enter]"
      strTestCaseResult = "FAIL"
      Exit Sub
    End If

    ''WorkSpace Edit Window
    strTemp="WPFObject(""LayoutPanel"", """", 2)"
    Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,13,True)
    If objTemp.Exists then
        Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WPFObject("SourceTreeListView")
        Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl")
       Delay 10000,"Pls Wait.."
        ''Expanding First Node in Tree      
        intTotNodeCnt=GridControl.Nodes_2.Count  
        For intI=0 to intTotNodeCnt-1         
          If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
           GridControl.Nodes_2.Item(intI).Expand(True)
           blnFlag=False  
           Exit For
          End If
        Next
         Delay 10000,"Pls Wait.."
        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
          For intJ=0 to intTotNodeCnt-1
            If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strSource2) then
              GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
              intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(0).get_RowHandle
              GridControl.Keys "^[Home]"
              Call GridControl.ClearSelectionCore
              Call GridControl.FocusViewAndRow(GridControl,intRow-1)
              GridControl.SetFocusOnCurrentItem
              Call GridControl.SelectRowCore(intRow-1)
        
              If objGridCell.Exists = True then
                objGridCell.Click
              End If
              blnFlag = False 
              Exit For
            End If
          Next
           Delay 10000,"Pls Wait.."
              intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count
               For intK=0 to intTotNodeCnt-1
                  If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description)=Ucase(DescText) then
                      intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).get_RowHandle
                      Call GridControl.ClearSelectionCore
                      GridControl.set_FocusedRowHandle(intRow)
                      Call GridControl.FocusViewAndRow(GridControl,intRow)
                      GridControl.SetFocusOnCurrentItem
                      Call GridControl.SelectRowCore(intRow)
                      strTCRemarks = strTCRemarks & "<br />" & " Folder is found in Source"
                      log.Message "Folder is  found in Source"
                      Exit For   
                  else
                    strTCRemarks = strTCRemarks & "<br />" & "Folder is not found in Source"
                    log.Message "Folder is not found in Source"
                    Exit For   
                  End If 
               Next
               
      Call SClosesource()
      Delay 5000,"Pls Wait.."
      Call SClosesource()
      Call SourceWorkSpacevwr()
    End if

End Sub

Sub sChkSrcCutPasteBelowSH(strParameters)
On Error Resume Next 
   Dim strSource1,StrSource2,strSource3,strTemp,GridControl,GridSourceTree,intTotNodeCnt,intI,intJ,intRow,intK,objEdge
   Dim objNewWorkspace,objWrkspace_popup,objOpenView,strTemp1,objNewWrkSpaceName,objNewWrkSpace_Txtbox,objNewWrkSpace_okbtn,objNewWrkSpace_Name
   Dim strDesc1,strDesc2,DescText,DescLocalText
   Dim objEditSource
   Dim objTemp, objStrClose
   Dim objEdgeFilter
   
    strSource1=getSplitValue(strParameters,"SOURCE")
    StrSource2=getSplitValue(strParameters,"LEVEL2SOURCE")
    StrSource3=getSplitValue(strParameters,"LEVEL3SOURCE")
    
'    strSource1="Test"
'    StrSource2="Automation_UIT2"
'    StrSource3="Test"

    Call sHome_Source
    
    strDesc1=aqDateTime.Now
    strDesc2=aqDateTime.Now
    DescText=Replace(strDesc1,"/","-")
    DescText=Replace(DescText,":","_")
    DescLocalText=DescText
    strWrkSpaceName=DescText
'    intSeriesID=getSplitValue(strParameters,"SERIESID")
'    if intSeriesID=0 then
'      Call sSourceseries
'      intSeriesID=strSourceFileText
'    End if 
    
    strTemp="WPFObject(""SourceTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""SourceTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    Delay 10000,"Pls Wait.."
    ''Selecting Country Name
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
          GridControl.Nodes_2.Item(intI).Expand(True)
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description       
          blnFlag=False  
          Exit For
        End If
    Next
    If blnFlag = True then
      strTCRemarks="Country Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
  
    Delay 10000,"Pls Wait.."
        blnFlag = True 
    ''Selecting Level2Source_Name
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
  For intJ=0 to intTotNodeCnt-1
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(StrSource2) then
        GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
        intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
'        Call GridSourceTree.ClickCell(intRow, "Edit")
        Call GridControl.ClearSelectionCore
        Call GridControl.FocusViewAndRow(GridControl,intRow)
        GridControl.SetFocusOnCurrentItem
        Call GridControl.SelectRowCore(intRow)
        log.Message "Level2 Source Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
        blnFlag = False 
        Exit For
      End If
    Next
    If blnFlag = True then
      log.Message "Level2 Source Name not found"
      strTCRemarks="Level2 Source Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
    
     Delay 10000,"Pls Wait.."
    blnFlag = True 
   
    Delay 2000,"Pls Wait.."

    strTemp="WPFObject(""ArrowControl"", """", 1)"
    Set objNewWorkspace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,20,True)
    If objNewWorkspace.Exists = True then
      objNewWorkspace.Click
       strTemp="WPFObject(""BarPopupBorderControl"", """", 1)"
      Set objWrkspace_popup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").FindChild("Name",strTemp,5,True)
      If objWrkspace_popup.Exists = True then
        strTemp="WPFObject(""ContentControlEx"", ""Open For Edit (Source)"", 2)"
        Set objopenforEdit=objWrkspace_popup.FindChild("Name",strTemp,8,True)
        If objopenforEdit.Exists then
          objopenforEdit.Click    
        End If
      End if
      
      strTemp1="WPFObject(""HwndSource: WorkspaceNamePrompt"", ""Please provide a new Workspace Name"")"
      Set objNewWrkSpaceName=Sys.Process("EdgeClient").WaitChild(strTemp1,50000)
      If objNewWrkSpaceName.Exists = True then
     
      ''Waiting for Workspace Name prompt
      strTemp="WPFObject(""FloatingContainerBorder"")"
      Set objNewWrkSpace_Name=Sys.Process("EdgeClient").WPFObject("HwndSource: WorkspaceNamePrompt", "Please provide a new Workspace Name").WPFObject("WorkspaceNamePrompt", "Please provide a new Workspace Name", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,15000000)
      If objNewWrkSpace_Name.Exists = True then
          strTemp="WPFObject(""ChangeNameTextEdit"")"
          ''Entering Workspace Name
          Set objNewWrkSpace_Txtbox=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
            If objNewWrkSpace_Txtbox.Exists = True then
              objNewWrkSpace_Txtbox.Click
              objNewWrkSpace_Txtbox.Text=strWrkSpaceName
      '        strTCRemarks=strTCRemarks & Chr(10) & "Entered Workspace Name - " & strWrkSpaceName
              ''Clicking on Ok Button 
              strTemp="WPFObject(""OkButton"")"
              Set objNewWrkSpace_okbtn=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
              If objNewWrkSpace_okbtn.Exists = True then
                objNewWrkSpace_okbtn.Click
                'Delay 5000,"Please wait..."
              End If
            End If
        End If
      End if 
     End if 
       
  
       ''Handling Validation for Source
    strTemp="WPFObject(""HwndSource: WindowContentHolder"", """")"
    Set objTemp=Sys.Process("EdgeClient").WaitChild(strTemp,10000)
    If objTemp.Exists = True then
      objTemp.Keys "[Enter]"
      strTestCaseResult = "FAIL"
      Exit Sub
    End If

    ''WorkSpace Edit Window
    strTemp="WPFObject(""LayoutPanel"", """", 2)"
    Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,13,True)
    If objTemp.Exists then
        Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WPFObject("SourceTreeListView")
        Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl")
       Delay 10000,"Pls Wait.."
        ''Expanding First Node in Tree      
        intTotNodeCnt=GridControl.Nodes_2.Count  
        For intI=0 to intTotNodeCnt-1         
          If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
           GridControl.Nodes_2.Item(intI).Expand(True)
           blnFlag=False  
           Exit For
          End If
        Next
         Delay 10000,"Pls Wait.."
        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
          For intJ=0 to intTotNodeCnt-1
            If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strSource2) then
              GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
              intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(0).get_RowHandle
              GridControl.Keys "^[Home]"
              Call GridControl.ClearSelectionCore
              Call GridControl.FocusViewAndRow(GridControl,intRow-1)
              GridControl.SetFocusOnCurrentItem
              Call GridControl.SelectRowCore(intRow-1)
        
              If objGridCell.Exists = True then
                objGridCell.Click
              End If
              blnFlag = False 
              Exit For
            End If
          Next

    End if
            
    strTemp="WPFObject(""SourceTreeListView"")"
    objEditSource=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WaitChild(strTemp,15000000)
    if objEditSource.Exists = True then

          strTemp="WPFObject(""ContentControlEx"", ""Add Folder"", 2)"
          Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 4).WPFObject("BarButtonItemLinkControl", "", 1).FindChild("Name",strTemp,50,True)
          If objNewWrkSpace_okbtn.Exists = True then
             If objNewWrkSpace_okbtn.Enabled = True then
              objNewWrkSpace_okbtn.Click
              strTCRemarks = strTCRemarks & "<br />" & "Add Folder is found in Source"
              log.Message "Add Folder is found in Source"
             Else
              strTCRemarks = strTCRemarks & "<br />" & "Add Folder is Disabled in Source"
              log.Message "Add Folder is Disabled in Source"
             End if
          Else
            strTCRemarks = strTCRemarks & "<br />" & "Add Folder is  not found in Source"
            log.Message "Add Folder is not found in Source"
          End If   
        
          
           Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 4).WPFObject("BarButtonItemLinkControl", "", 1)      
         Delay 8000,"New Folder..."

        ''Getting no. of Rows under level 2
        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count
        intK=intTotNodeCnt-1
    
        Set objDescCell=Aliases.EdgeClient.HwndSource_RibbonWindow.RibbonWindow.ContentControl.Grid.Grid.ContentControl.Grid.ContentControl.PART_ContainerContent.BarManager.DockPanel.DockLayoutManager.LayoutGroup.LayoutPanel2.Root.BarManager.AdornerDecorator.AdornedControl.Grid.DockPanel.SourceTreeListControl.SourceTreeListView.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK)
        Call objDescCell.Content.set_Description(DescText)
        strTCRemarks = strTCRemarks & "<br />" & "Description is added in new folder"
        log.Message "Description is added in new folder"
        
        Call objDescCell.Content.set_DescriptionLocal(DescLocalText)
        strTCRemarks = strTCRemarks & "<br />" & "Description local is added in new folder"
        log.Message "Description local is added in new folder"
            
        Delay 15000,"Pls Wait.."
        Call SClosesource()
        Delay 5000,"Pls Wait.."
                       
    End if
 
    strTemp="WPFObject(""SourceTreeListView"")"
    objEditSource=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WaitChild(strTemp,15000000)
    if objEditSource.Exists = True then
          sys.Keys("[Up]")
          Call sEdgeProcessor
        sys.Keys("^u")
        strTCRemarks = strTCRemarks & "<br />" & "Cut Folder is Click"
        log.Message "Cut Folder is Click"
        sys.Keys("[Down]")
        Call sEdgeProcessor
    
        sys.Keys("^b")
        'Call sEdgeProcessor
        strTCRemarks = strTCRemarks & "<br />" & "Paste inside is Clicked"
        log.Message "Paste inside is Clicked"
        
        strTemp="WPFObject(""PART_ContainerContent"")"
        Set objConfirm=Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "Cut and paste source series").WPFObject("CustomMessageBoxWindow", "Cut and paste source series", 1).FindChild("Name",strTemp,50,True)
'        strTemp="WPFObject(""DXMessageBox"", """", 1)"
'        Set objConfirm=objConfirm.WaitChild(strTemp,180000)
        If objConfirm.Exists = True then
          Sys.Keys "[Enter]"
          'Delay 30000,"Pls Wait.."
          'Call sEdgeProcessor
        End if

    End if
    
    Dim objSaveWrk,objWait  
     set objSaveWrk=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 12).WPFObject("BarSubItemLinkControl", "", 1)
    strTemp="WPFObject(""ContentControlEx"", ""Workspace"", 2)"
    Set objTemp=objSaveWrk.FindChild("Name",strTemp,50)
    objWait=1
    Do until objTemp.Enabled = true 
        If objWait < 20 Then
          Delay 1000,"Pls Wait... Form is loading..."
          objWait=objWait+1
        else
          Call SClosesource()
          Call SourceWorkSpacevwr()
          Exit Sub
        end if 
    Loop 
    
    strTemp="WPFObject(""ContentControlEx"", ""Workspace"", 2)"
    Set objWrkSpace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,50,True)
    If objWrkSpace.Exists = True then
      Delay(1000)
      objWrkSpace.Click
      Delay(1000)
      strTemp="WPFObject(""PopupMenuBarControl"", """", 1)"
      Set objwrkspacepop=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").Findchild("Name",strTemp,50,True)
      'Set objwrkspacepop=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 2).WPFObject("BarButtonItemLinkControl", "", 1).WPFObject("ContentControlEx", "Upload Workspace", 2)
      If objwrkspacepop.Exists = True then
        strTemp="WPFObject(""ContentControlEx"", ""Upload Workspace"", 2)"
        set objwrkspcUpload=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).FindChild("Name",strTemp,50,True)
        If objwrkspcUpload.Exists = True then
          objwrkspcUpload.Click
          'Delay 1000,"Pls Wait.."
          strTemp="WPFObject(""PART_ContainerContent"")"
        Set objConfirm=Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "Confirm save.").FindChild("Name",strTemp,50,True)

          If objConfirm.Exists = True then
            Sys.Keys "[Enter]"
            'Delay 8000,"Uploading..."
            Set objConfirm = Sys.Process("EdgeClient")._
            Waitchild("WPFObject(""HwndSource: CustomMessageBoxWindow"", ""Upload Workspace"")",600000)._
            Waitchild("WPFObject(""CustomMessageBoxWindow"", ""Upload Workspace"", 1)",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""FloatingContainerBorder"")",60000)._
            Waitchild("WPFObject(""FloatingContainerBackground"")",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""FloatingContainerBody"")",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""PART_ContainerContent"")",60000)
            
            If objConfirm.Exists = True then
              Sys.Keys("O")
    'Delay 30000,"Pls Wait.."
''              Call sEdgeProcessor
            End if
          End if
        End if
      End if
    End if

End Sub
Sub  sCheckSrcOpenEdit3Delete(strParameters)
On Error Resume Next 
   Dim strSource1,StrSource2,strSource3,strTemp,GridControl,GridSourceTree,intTotNodeCnt,intI,intJ,intRow,intK,objEdge
   Dim objNewWorkspace,objWrkspace_popup,objOpenView,strTemp1,objNewWrkSpaceName,objNewWrkSpace_Txtbox,objNewWrkSpace_okbtn,objNewWrkSpace_Name
   Dim strDesc1,strDesc2,DescText,DescLocalText
   Dim objEditSource
   Dim objTemp, objStrClose
   
    strSource1=getSplitValue(strParameters,"SOURCE")
    StrSource2=getSplitValue(strParameters,"LEVEL2SOURCE")
    StrSource3=getSplitValue(strParameters,"LEVEL3SOURCE")
    
''    strSource1="Test"
''    StrSource2="Automation_UIT2"
''    StrSource3="Test"

    Call sHome_Source
    
    strDesc1=aqDateTime.Now
    strDesc2=aqDateTime.Now
    DescText=Replace(strDesc1,"/","-")
    DescText=Replace(DescText,":","_")
    DescLocalText=DescText
    strWrkSpaceName=DescText
'    intSeriesID=getSplitValue(strParameters,"SERIESID")
'    if intSeriesID=0 then
'      Call sSourceseries
'      intSeriesID=strSourceFileText
'    End if 
    
    strTemp="WPFObject(""SourceTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""SourceTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    Delay 10000,"Pls Wait.."
    ''Selecting Country Name
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
          GridControl.Nodes_2.Item(intI).Expand(True)
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description       
          blnFlag=False  
          Exit For
        End If
    Next
    If blnFlag = True then
      strTCRemarks="Country Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
  
    Delay 10000,"Pls Wait.."
        blnFlag = True 
    ''Selecting Level2Source_Name
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
  For intJ=0 to intTotNodeCnt-1
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(StrSource2) then
        GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
        intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
'        Call GridSourceTree.ClickCell(intRow, "Edit")
        Call GridControl.ClearSelectionCore
        Call GridControl.FocusViewAndRow(GridControl,intRow)
        GridControl.SetFocusOnCurrentItem
        Call GridControl.SelectRowCore(intRow)
        log.Message "Level2 Source Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
        blnFlag = False 
        Exit For
      End If
    Next
    If blnFlag = True then
      log.Message "Level2 Source Name not found"
      strTCRemarks="Level2 Source Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
    
     Delay 10000,"Pls Wait.."
'    blnFlag = True 
   
    Delay 2000,"Pls Wait.."

    strTemp="WPFObject(""ArrowControl"", """", 1)"
    Set objNewWorkspace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,20,True)
    If objNewWorkspace.Exists = True then
      objNewWorkspace.Click
       strTemp="WPFObject(""BarPopupBorderControl"", """", 1)"
      Set objWrkspace_popup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").FindChild("Name",strTemp,5,True)
      If objWrkspace_popup.Exists = True then
        strTemp="WPFObject(""ContentControlEx"", ""Open For Edit (Source)"", 2)"
        Set objopenforEdit=objWrkspace_popup.FindChild("Name",strTemp,8,True)
        If objopenforEdit.Exists then
          objopenforEdit.Click    
        End If
      End if
      
      strTemp1="WPFObject(""HwndSource: WorkspaceNamePrompt"", ""Please provide a new Workspace Name"")"
      Set objNewWrkSpaceName=Sys.Process("EdgeClient").WaitChild(strTemp1,50000)
      If objNewWrkSpaceName.Exists = True then
     
      ''Waiting for Workspace Name prompt
      strTemp="WPFObject(""FloatingContainerBorder"")"
      Set objNewWrkSpace_Name=Sys.Process("EdgeClient").WPFObject("HwndSource: WorkspaceNamePrompt", "Please provide a new Workspace Name").WPFObject("WorkspaceNamePrompt", "Please provide a new Workspace Name", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,15000000)
      If objNewWrkSpace_Name.Exists = True then
          strTemp="WPFObject(""ChangeNameTextEdit"")"
          ''Entering Workspace Name
          Set objNewWrkSpace_Txtbox=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
            If objNewWrkSpace_Txtbox.Exists = True then
              objNewWrkSpace_Txtbox.Click
              objNewWrkSpace_Txtbox.Text=strWrkSpaceName
      '        strTCRemarks=strTCRemarks & Chr(10) & "Entered Workspace Name - " & strWrkSpaceName
              ''Clicking on Ok Button 
              strTemp="WPFObject(""OkButton"")"
              Set objNewWrkSpace_okbtn=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
'              If objNewWrkSpace_okbtn.Exists = True then
                objNewWrkSpace_okbtn.Click
                'Delay 5000,"Please wait..."
              End If
            End If
        End If
      End if 
    ' End if 
       
  
       ''Handling Validation for Source
    strTemp="WPFObject(""HwndSource: WindowContentHolder"", """")"
    Set objTemp=Sys.Process("EdgeClient").WaitChild(strTemp,10000)
    If objTemp.Exists = True then
      objTemp.Keys "[Enter]"
      strTestCaseResult = "FAIL"
      Exit Sub
    End If

    ''WorkSpace Edit Window
    strTemp="WPFObject(""LayoutPanel"", """", 2)"
    Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,13,True)
    If objTemp.Exists then
        Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WPFObject("SourceTreeListView")
        Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl")
       Delay 10000,"Pls Wait.."
        ''Expanding First Node in Tree      
        intTotNodeCnt=GridControl.Nodes_2.Count  
        For intI=0 to intTotNodeCnt-1         
          If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
           GridControl.Nodes_2.Item(intI).Expand(True)
           blnFlag=False  
           Exit For
          End If
        Next
         Delay 10000,"Pls Wait.."
        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
          For intJ=0 to intTotNodeCnt-1
            If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strSource2) then
              GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
              intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(0).get_RowHandle
              GridControl.Keys "^[Home]"
              Call GridControl.ClearSelectionCore
              Call GridControl.FocusViewAndRow(GridControl,intRow-1)
              GridControl.SetFocusOnCurrentItem
              Call GridControl.SelectRowCore(intRow-1)
        
              If objGridCell.Exists = True then
                objGridCell.Click
              End If
              blnFlag = False 
              Exit For
            End If
          Next
    End if
        
    
    strTemp="WPFObject(""SourceTreeListView"")"
    'objEditSource=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WaitChild(strTemp,15000000)
    objEditSource=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WaitChild(strTemp,15000000)
    if objEditSource.Exists = True then

          strTemp="WPFObject(""ContentControlEx"", ""Add Folder"", 2)"
          'Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 4).WPFObject("BarButtonItemLinkControl", "", 1).FindChild("Name",strTemp,50,True)
          Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 4).WPFObject("BarButtonItemLinkControl", "", 1).FindChild("Name",strTemp,50,True)
          If objNewWrkSpace_okbtn.Exists = True then
             If objNewWrkSpace_okbtn.Enabled = True then
              objNewWrkSpace_okbtn.Click
              strTCRemarks = strTCRemarks & "<br />" & "Add Folder is found in Source"
              log.Message "Add Folder is found in Source"
             Else
              strTCRemarks = strTCRemarks & "<br />" & "Add Folder is Disabled in Source"
              log.Message "Add Folder is Disabled in Source"
             End if
          Else
            strTCRemarks = strTCRemarks & "<br />" & "Add Folder is  not found in Source"
            log.Message "Add Folder is not found in Source"
          End If   
        
          
           Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 4).WPFObject("BarButtonItemLinkControl", "", 1)      
         Delay 8000,"New Folder..."

        ''Getting no. of Rows under level 2
        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count
        intK=intTotNodeCnt-1
    
        Set objDescCell=Aliases.EdgeClient.HwndSource_RibbonWindow.RibbonWindow.ContentControl.Grid.Grid.ContentControl.Grid.ContentControl.PART_ContainerContent.BarManager.DockPanel.DockLayoutManager.LayoutGroup.LayoutPanel2.Root.BarManager.AdornerDecorator.AdornedControl.Grid.DockPanel.SourceTreeListControl.SourceTreeListView.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK)
        Call objDescCell.Content.set_Description(DescText)
        strTCRemarks = strTCRemarks & "<br />" & "Description is added in new folder"
        log.Message "Description is added in new folder"
        
        Call objDescCell.Content.set_DescriptionLocal(DescLocalText)
        strTCRemarks = strTCRemarks & "<br />" & "Description local is added in new folder"
        log.Message "Description local is added in new folder"
            
          
         Delay 15000,"Pls Wait.."
      Call SClosesource()
      Delay 5000,"Pls Wait.."
                   
    End if
 

    Dim objSaveWrk,objWait  
     set objSaveWrk=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 12).WPFObject("BarSubItemLinkControl", "", 1)
    strTemp="WPFObject(""ContentControlEx"", ""Workspace"", 2)"
    Set objTemp=objSaveWrk.FindChild("Name",strTemp,50)
    objWait=1
    Do until objTemp.Enabled = true 
        If objWait < 20 Then
          Delay 1000,"Pls Wait... Form is loading..."
          objWait=objWait+1
        else
          Call SClosesource()
          Call SourceWorkSpacevwr()
          Exit Sub
        end if 
    Loop  
    
    strTemp="WPFObject(""ContentControlEx"", ""Workspace"", 2)"
    Set objWrkSpace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,50,True)
    If objWrkSpace.Exists = True then
      Delay(1000)
      objWrkSpace.Click
      Delay(1000)
      strTemp="WPFObject(""PopupMenuBarControl"", """", 1)"
      Set objwrkspacepop=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").Findchild("Name",strTemp,50,True)
      'Set objwrkspacepop=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 2).WPFObject("BarButtonItemLinkControl", "", 1).WPFObject("ContentControlEx", "Upload Workspace", 2)
      If objwrkspacepop.Exists = True then
        strTemp="WPFObject(""ContentControlEx"", ""Upload Workspace"", 2)"
        set objwrkspcUpload=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).FindChild("Name",strTemp,50,True)
        If objwrkspcUpload.Exists = True then
          objwrkspcUpload.Click
          'Delay 1000,"Pls Wait.."
          strTemp="WPFObject(""PART_ContainerContent"")"
          Set objConfirm=Sys.Process("EdgeClient").WPFObject("HwndSource: WindowContentHolder", "Confirm").FindChild("Name",strTemp,50,True)
          strTemp="WPFObject(""DXMessageBox"", """", 1)"
          Set objConfirm=objConfirm.WaitChild(strTemp,180000)
          If objConfirm.Exists = True then
            objConfirm.Keys "[Enter]"
            'Delay 8000,"Uploading..."
            Set objConfirm = Sys.Process("EdgeClient")._
            Waitchild("WPFObject(""HwndSource: CustomMessageBoxWindow"", ""Upload Workspace"")",600000)._
            Waitchild("WPFObject(""CustomMessageBoxWindow"", ""Upload Workspace"", 1)",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""FloatingContainerBorder"")",60000)._
            Waitchild("WPFObject(""FloatingContainerBackground"")",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""FloatingContainerBody"")",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""PART_ContainerContent"")",60000)
            
            If objConfirm.Exists = True then
              Sys.Keys("O")
              'Delay 30000,"Pls Wait.."
              Call sEdgeProcessor
            End if
          End if
        End if
      End if
    End if
    
    Call sHome_Source
    
    strTemp="WPFObject(""SourceTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""SourceTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    Delay 10000,"Pls Wait.."
    ''Selecting Country Name
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
          GridControl.Nodes_2.Item(intI).Expand(True)
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description       
          blnFlag=False  
          Exit For
        End If
    Next
    If blnFlag = True then
      strTCRemarks="Country Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
  
    Delay 10000,"Pls Wait.."
        blnFlag = True 
    ''Selecting Level2Source_Name
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
  For intJ=0 to intTotNodeCnt-1
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(StrSource2) then
        GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
        intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
'        Call GridSourceTree.ClickCell(intRow, "Edit")
        Call GridControl.ClearSelectionCore
        Call GridControl.FocusViewAndRow(GridControl,intRow)
        GridControl.SetFocusOnCurrentItem
        Call GridControl.SelectRowCore(intRow)
        log.Message "Level2 Source Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
        blnFlag = False 
        Exit For
      End If
    Next
    If blnFlag = True then
      log.Message "Level2 Source Name not found"
      strTCRemarks="Level2 Source Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
    
     Delay 10000,"Pls Wait.."
    'blnFlag = True 
   
    Delay 2000,"Pls Wait.."

    strTemp="WPFObject(""ArrowControl"", """", 1)"
    Set objNewWorkspace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,20,True)
    If objNewWorkspace.Exists = True then
      objNewWorkspace.Click
       strTemp="WPFObject(""BarPopupBorderControl"", """", 1)"
      Set objWrkspace_popup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").FindChild("Name",strTemp,5,True)
      If objWrkspace_popup.Exists = True then
        strTemp="WPFObject(""ContentControlEx"", ""Open For Edit (Source)"", 2)"
        Set objopenforEdit=objWrkspace_popup.FindChild("Name",strTemp,8,True)
        If objopenforEdit.Exists then
          objopenforEdit.Click    
        End If
      End if
      
      strTemp1="WPFObject(""HwndSource: WorkspaceNamePrompt"", ""Please provide a new Workspace Name"")"
      Set objNewWrkSpaceName=Sys.Process("EdgeClient").WaitChild(strTemp1,50000)
      If objNewWrkSpaceName.Exists = True then
     
      ''Waiting for Workspace Name prompt
      strTemp="WPFObject(""FloatingContainerBorder"")"
      Set objNewWrkSpace_Name=Sys.Process("EdgeClient").WPFObject("HwndSource: WorkspaceNamePrompt", "Please provide a new Workspace Name").WPFObject("WorkspaceNamePrompt", "Please provide a new Workspace Name", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,15000000)
      If objNewWrkSpace_Name.Exists = True then
          strTemp="WPFObject(""ChangeNameTextEdit"")"
          ''Entering Workspace Name
          Set objNewWrkSpace_Txtbox=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
            If objNewWrkSpace_Txtbox.Exists = True then
              objNewWrkSpace_Txtbox.Click
              objNewWrkSpace_Txtbox.Text=strWrkSpaceName
      '        strTCRemarks=strTCRemarks & Chr(10) & "Entered Workspace Name - " & strWrkSpaceName
              ''Clicking on Ok Button 
              strTemp="WPFObject(""OkButton"")"
              Set objNewWrkSpace_okbtn=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
              If objNewWrkSpace_okbtn.Exists = True then
                objNewWrkSpace_okbtn.Click
                'Delay 5000,"Please wait..."
              End If
            End If
        End If
      End if 
     End if 
       
  
       ''Handling Validation for Source
    strTemp="WPFObject(""HwndSource: WindowContentHolder"", """")"
    Set objTemp=Sys.Process("EdgeClient").WaitChild(strTemp,10000)
    If objTemp.Exists = True then
      objTemp.Keys "[Enter]"
      strTestCaseResult = "FAIL"
      Exit Sub
    End If

    ''WorkSpace Edit Window
    strTemp="WPFObject(""LayoutPanel"", """", 2)"
    Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,13,True)
    If objTemp.Exists then
        Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WPFObject("SourceTreeListView")
        Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl")
       Delay 10000,"Pls Wait.."
        ''Expanding First Node in Tree      
        intTotNodeCnt=GridControl.Nodes_2.Count  
        For intI=0 to intTotNodeCnt-1         
          If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
           GridControl.Nodes_2.Item(intI).Expand(True)
           blnFlag=False  
           Exit For
          End If
        Next
         Delay 10000,"Pls Wait.."
        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
          For intJ=0 to intTotNodeCnt-1
            If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strSource2) then
              GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
              intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(0).get_RowHandle
              GridControl.Keys "^[Home]"
              Call GridControl.ClearSelectionCore
              Call GridControl.FocusViewAndRow(GridControl,intRow-1)
              GridControl.SetFocusOnCurrentItem
              Call GridControl.SelectRowCore(intRow-1)
        
              If objGridCell.Exists = True then
                objGridCell.Click
              End If
              blnFlag = False 
              Exit For
            End If
          Next
           Delay 10000,"Pls Wait.."
              intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count
               For intK=0 to intTotNodeCnt-1
                  If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description)=Ucase(DescText) then
                      intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).get_RowHandle
                      Call GridControl.ClearSelectionCore
                      GridControl.set_FocusedRowHandle(intRow)
                      Call GridControl.FocusViewAndRow(GridControl,intRow)
                      GridControl.SetFocusOnCurrentItem
                      Call GridControl.SelectRowCore(intRow)
                      Exit For   
                  End If 
               Next
    End if
        
  Delay 15000,"Pls Wait.."
    strTemp="WPFObject(""SourceTreeListView"")"
    objEditSource=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WaitChild(strTemp,15000000)
    if objEditSource.Exists = True then
          strTemp="WPFObject(""ContentControlEx"", ""Delete Folder"", 2)"
          Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 7).WPFObject("BarButtonItemLinkControl", "", 1).FindChild("Name",strTemp,50,True)
          If objNewWrkSpace_okbtn.Exists = True then
             If objNewWrkSpace_okbtn.Enabled = True then
              objNewWrkSpace_okbtn.Click
              strTCRemarks = strTCRemarks & "<br />" & "Delete Folder is found in Source"
              log.Message "Delete Folder is found in Source"
              strTemp="WPFObject(""PART_ContainerContent"")"
              Set objConfirm=Sys.Process("EdgeClient").WPFObject("HwndSource: WindowContentHolder", "Confirm").WPFObject("WindowContentHolder", "Confirm", 1).FindChild("Name",strTemp,50,True)
              strTemp="WPFObject(""DXMessageBox"", """", 1)"
              Set objConfirm=objConfirm.WaitChild(strTemp,180000)
              If objConfirm.Exists = True then
                objConfirm.Keys "[Enter]"
                'Call sEdgeProcessor
              End if

             Else
              strTCRemarks = strTCRemarks & "<br />" & "Delete Folder is Disabled in Source"
              log.Message "Delete Folder is Disabled in Source"
             End if
          Else
            strTCRemarks = strTCRemarks & "<br />" & "Delete Folder is  not found in Source"
            log.Message "Delete Folder is not found in Source"
          End If   

    end if
    
      
      Delay 15000,"Pls Wait.."
      Call SClosesource()
      Delay 5000,"Pls Wait.."
     set objSaveWrk=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 12).WPFObject("BarSubItemLinkControl", "", 1)
    strTemp="WPFObject(""ContentControlEx"", ""Workspace"", 2)"
    Set objTemp=objSaveWrk.FindChild("Name",strTemp,50)
   objWait=1
    Do until objTemp.Enabled = true 
        If objWait < 20 Then
          Delay 1000,"Pls Wait... Form is loading..."
          objWait=objWait+1
        else
          Call SClosesource()
          Call SourceWorkSpacevwr()
          Exit Sub
        end if 
    Loop 
    
    strTemp="WPFObject(""ContentControlEx"", ""Workspace"", 2)"
    Set objWrkSpace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,50,True)
    If objWrkSpace.Exists = True then
      Delay(1000)
      objWrkSpace.Click
      Delay(1000)
      strTemp="WPFObject(""PopupMenuBarControl"", """", 1)"
      Set objwrkspacepop=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").Findchild("Name",strTemp,50,True)
      If objwrkspacepop.Exists = True then
        strTemp="WPFObject(""ContentControlEx"", ""Upload Workspace"", 2)"
        set objwrkspcUpload=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).FindChild("Name",strTemp,50,True)
        If objwrkspcUpload.Exists = True then
          objwrkspcUpload.Click
          'Delay 1000,"Pls Wait.."
          strTemp="WPFObject(""PART_ContainerContent"")"
          Set objConfirm=Sys.Process("EdgeClient").WPFObject("HwndSource: WindowContentHolder", "Confirm").FindChild("Name",strTemp,50,True)
          strTemp="WPFObject(""DXMessageBox"", """", 1)"
          Set objConfirm=objConfirm.WaitChild(strTemp,180000)
          If objConfirm.Exists = True then
            objConfirm.Keys "[Enter]"
            'Delay 8000,"Uploading..."
           Set objConfirm = Sys.Process("EdgeClient")._
            Waitchild("WPFObject(""HwndSource: CustomMessageBoxWindow"", ""Upload Workspace"")",600000)._
            Waitchild("WPFObject(""CustomMessageBoxWindow"", ""Upload Workspace"", 1)",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""FloatingContainerBorder"")",60000)._
            Waitchild("WPFObject(""FloatingContainerBackground"")",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""FloatingContainerBody"")",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""PART_ContainerContent"")",60000)
            
            If objConfirm.Exists = True then
              Sys.Keys("O")
              'Delay 30000,"Pls Wait.."
              Call sEdgeProcessor
            End if
          End if
        End if
      End if
    End if

     Call sHome_Source
    
    strTemp="WPFObject(""SourceTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""SourceTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    Delay 10000,"Pls Wait.."
    ''Selecting Country Name
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
          GridControl.Nodes_2.Item(intI).Expand(True)
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description       
          blnFlag=False  
          Exit For
        End If
    Next
    If blnFlag = True then
      strTCRemarks="Country Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
  
    Delay 10000,"Pls Wait.."
        blnFlag = True 
    ''Selecting Level2Source_Name
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
  For intJ=0 to intTotNodeCnt-1
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(StrSource2) then
        GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
        intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
'        Call GridSourceTree.ClickCell(intRow, "Edit")
        Call GridControl.ClearSelectionCore
        Call GridControl.FocusViewAndRow(GridControl,intRow)
        GridControl.SetFocusOnCurrentItem
        Call GridControl.SelectRowCore(intRow)
        log.Message "Level2 Source Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
        blnFlag = False 
        Exit For
      End If
    Next
    If blnFlag = True then
      log.Message "Level2 Source Name not found"
      strTCRemarks="Level2 Source Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
    
     Delay 10000,"Pls Wait.."
    blnFlag = True 
   
    Delay 2000,"Pls Wait.."

    strTemp="WPFObject(""ArrowControl"", """", 1)"
    Set objNewWorkspace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,20,True)
    If objNewWorkspace.Exists = True then
      objNewWorkspace.Click
       strTemp="WPFObject(""BarPopupBorderControl"", """", 1)"
      Set objWrkspace_popup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").FindChild("Name",strTemp,5,True)
      If objWrkspace_popup.Exists = True then
        strTemp="WPFObject(""ContentControlEx"", ""Open For Edit (Source)"", 2)"
        Set objopenforEdit=objWrkspace_popup.FindChild("Name",strTemp,8,True)
        If objopenforEdit.Exists then
          objopenforEdit.Click    
        End If
      End if
      
      strTemp1="WPFObject(""HwndSource: WorkspaceNamePrompt"", ""Please provide a new Workspace Name"")"
      Set objNewWrkSpaceName=Sys.Process("EdgeClient").WaitChild(strTemp1,50000)
      If objNewWrkSpaceName.Exists = True then
     
      ''Waiting for Workspace Name prompt
      strTemp="WPFObject(""FloatingContainerBorder"")"
      Set objNewWrkSpace_Name=Sys.Process("EdgeClient").WPFObject("HwndSource: WorkspaceNamePrompt", "Please provide a new Workspace Name").WPFObject("WorkspaceNamePrompt", "Please provide a new Workspace Name", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,15000000)
      If objNewWrkSpace_Name.Exists = True then
          strTemp="WPFObject(""ChangeNameTextEdit"")"
          ''Entering Workspace Name
          Set objNewWrkSpace_Txtbox=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
            If objNewWrkSpace_Txtbox.Exists = True then
              objNewWrkSpace_Txtbox.Click
              objNewWrkSpace_Txtbox.Text=strWrkSpaceName
      '        strTCRemarks=strTCRemarks & Chr(10) & "Entered Workspace Name - " & strWrkSpaceName
              ''Clicking on Ok Button 
              strTemp="WPFObject(""OkButton"")"
              Set objNewWrkSpace_okbtn=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
              If objNewWrkSpace_okbtn.Exists = True then
                objNewWrkSpace_okbtn.Click
                'Delay 5000,"Please wait..."
              End If
            End If
        End If
      End if 
     End if 
       
  
       ''Handling Validation for Source
    strTemp="WPFObject(""HwndSource: WindowContentHolder"", """")"
    Set objTemp=Sys.Process("EdgeClient").WaitChild(strTemp,10000)
    If objTemp.Exists = True then
      objTemp.Keys "[Enter]"
      strTestCaseResult = "FAIL"
      Exit Sub
    End If

    ''WorkSpace Edit Window
    strTemp="WPFObject(""LayoutPanel"", """", 2)"
    Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,13,True)
    If objTemp.Exists then
        Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WPFObject("SourceTreeListView")
        Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl")
       Delay 10000,"Pls Wait.."
        ''Expanding First Node in Tree      
        intTotNodeCnt=GridControl.Nodes_2.Count  
        For intI=0 to intTotNodeCnt-1         
          If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
           GridControl.Nodes_2.Item(intI).Expand(True)
           blnFlag=False  
           Exit For
          End If
        Next
         Delay 10000,"Pls Wait.."
        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
          For intJ=0 to intTotNodeCnt-1
            If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strSource2) then
              GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
              intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(0).get_RowHandle
              GridControl.Keys "^[Home]"
              Call GridControl.ClearSelectionCore
              Call GridControl.FocusViewAndRow(GridControl,intRow-1)
              GridControl.SetFocusOnCurrentItem
              Call GridControl.SelectRowCore(intRow-1)
        
              If objGridCell.Exists = True then
                objGridCell.Click
              End If
              blnFlag = False 
              Exit For
            End If
          Next
           Delay 10000,"Pls Wait.."
              intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count
               For intK=0 to intTotNodeCnt-1
                  If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description)=Ucase(DescText) then
                      intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).get_RowHandle
                      Call GridControl.ClearSelectionCore
                      GridControl.set_FocusedRowHandle(intRow)
                      Call GridControl.FocusViewAndRow(GridControl,intRow)
                      GridControl.SetFocusOnCurrentItem
                      Call GridControl.SelectRowCore(intRow)
                      Exit For   
                  else
                    strTCRemarks = strTCRemarks & "<br />" & "Delete Folder is not found in Source"
                    log.Message "Delete Folder is not found in Source"
                    Exit For   
                  End If 
               Next
               
      Call SClosesource()
      Delay 5000,"Pls Wait.."
      Call SClosesource()
      Call SourceWorkSpacevwr()
    End if

End Sub
Sub  sCheckSrcOpenEdit3DeleteSH(strParameters)
On Error Resume Next 
   Dim strSource1,StrSource2,strSource3,strTemp,GridControl,GridSourceTree,intTotNodeCnt,intI,intJ,intRow,intK,objEdge
   Dim objNewWorkspace,objWrkspace_popup,objOpenView,strTemp1,objNewWrkSpaceName,objNewWrkSpace_Txtbox,objNewWrkSpace_okbtn,objNewWrkSpace_Name
   Dim strDesc1,strDesc2,DescText,DescLocalText
   Dim objEditSource
   Dim objTemp, objStrClose
   
    strSource1=getSplitValue(strParameters,"SOURCE")
    StrSource2=getSplitValue(strParameters,"LEVEL2SOURCE")
    StrSource3=getSplitValue(strParameters,"LEVEL3SOURCE")
    
'    strSource1="Test"
'    StrSource2="Automation_UIT2"
'    StrSource3="Test"

    Call sHome_Source
    
    strDesc1=aqDateTime.Now
    strDesc2=aqDateTime.Now
    DescText=Replace(strDesc1,"/","-")
    DescText=Replace(DescText,":","_")
    DescLocalText=DescText
    strWrkSpaceName=DescText
'    intSeriesID=getSplitValue(strParameters,"SERIESID")
'    if intSeriesID=0 then
'      Call sSourceseries
'      intSeriesID=strSourceFileText
'    End if 
    
    strTemp="WPFObject(""SourceTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""SourceTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    Delay 10000,"Pls Wait.."
    ''Selecting Country Name
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
          GridControl.Nodes_2.Item(intI).Expand(True)
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description       
          blnFlag=False  
          Exit For
        End If
    Next
    If blnFlag = True then
      strTCRemarks="Country Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
  
    Delay 10000,"Pls Wait.."
        blnFlag = True 
    ''Selecting Level2Source_Name
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
  For intJ=0 to intTotNodeCnt-1
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(StrSource2) then
        GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
        intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
'        Call GridSourceTree.ClickCell(intRow, "Edit")
        Call GridControl.ClearSelectionCore
        Call GridControl.FocusViewAndRow(GridControl,intRow)
        GridControl.SetFocusOnCurrentItem
        Call GridControl.SelectRowCore(intRow)
        log.Message "Level2 Source Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
        blnFlag = False 
        Exit For
      End If
    Next
    If blnFlag = True then
      log.Message "Level2 Source Name not found"
      strTCRemarks="Level2 Source Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
    
     Delay 10000,"Pls Wait.."
    blnFlag = True 
   
    Delay 2000,"Pls Wait.."

    strTemp="WPFObject(""ArrowControl"", """", 1)"
    Set objNewWorkspace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,20,True)
    If objNewWorkspace.Exists = True then
      objNewWorkspace.Click
       strTemp="WPFObject(""BarPopupBorderControl"", """", 1)"
      Set objWrkspace_popup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").FindChild("Name",strTemp,5,True)
      If objWrkspace_popup.Exists = True then
        strTemp="WPFObject(""ContentControlEx"", ""Open For Edit (Source)"", 2)"
        Set objopenforEdit=objWrkspace_popup.FindChild("Name",strTemp,8,True)
        If objopenforEdit.Exists then
          objopenforEdit.Click    
        End If
      End if
      
      strTemp1="WPFObject(""HwndSource: WorkspaceNamePrompt"", ""Please provide a new Workspace Name"")"
      Set objNewWrkSpaceName=Sys.Process("EdgeClient").WaitChild(strTemp1,50000)
      If objNewWrkSpaceName.Exists = True then
     
      ''Waiting for Workspace Name prompt
      strTemp="WPFObject(""FloatingContainerBorder"")"
      Set objNewWrkSpace_Name=Sys.Process("EdgeClient").WPFObject("HwndSource: WorkspaceNamePrompt", "Please provide a new Workspace Name").WPFObject("WorkspaceNamePrompt", "Please provide a new Workspace Name", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,15000000)
      If objNewWrkSpace_Name.Exists = True then
          strTemp="WPFObject(""ChangeNameTextEdit"")"
          ''Entering Workspace Name
          Set objNewWrkSpace_Txtbox=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
            If objNewWrkSpace_Txtbox.Exists = True then
              objNewWrkSpace_Txtbox.Click
              objNewWrkSpace_Txtbox.Text=strWrkSpaceName
      '        strTCRemarks=strTCRemarks & Chr(10) & "Entered Workspace Name - " & strWrkSpaceName
              ''Clicking on Ok Button 
              strTemp="WPFObject(""OkButton"")"
              Set objNewWrkSpace_okbtn=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
              If objNewWrkSpace_okbtn.Exists = True then
                objNewWrkSpace_okbtn.Click
                'Delay 5000,"Please wait..."
              End If
            End If
        End If
      End if 
     End if 
       
  
       ''Handling Validation for Source
    strTemp="WPFObject(""HwndSource: WindowContentHolder"", """")"
    Set objTemp=Sys.Process("EdgeClient").WaitChild(strTemp,10000)
    If objTemp.Exists = True then
      objTemp.Keys "[Enter]"
      strTestCaseResult = "FAIL"
      Exit Sub
    End If

    ''WorkSpace Edit Window
    strTemp="WPFObject(""LayoutPanel"", """", 2)"
    Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,13,True)
    If objTemp.Exists then
        Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WPFObject("SourceTreeListView")
        Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl")
       Delay 10000,"Pls Wait.."
        ''Expanding First Node in Tree      
        intTotNodeCnt=GridControl.Nodes_2.Count  
        For intI=0 to intTotNodeCnt-1         
          If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
           GridControl.Nodes_2.Item(intI).Expand(True)
           blnFlag=False  
           Exit For
          End If
        Next
         Delay 10000,"Pls Wait.."
        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
          For intJ=0 to intTotNodeCnt-1
            If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strSource2) then
              GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
              intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(0).get_RowHandle
              GridControl.Keys "^[Home]"
              Call GridControl.ClearSelectionCore
              Call GridControl.FocusViewAndRow(GridControl,intRow-1)
              GridControl.SetFocusOnCurrentItem
              Call GridControl.SelectRowCore(intRow-1)
        
              If objGridCell.Exists = True then
                objGridCell.Click
              End If
              blnFlag = False 
              Exit For
            End If
          Next

    End if
            
    strTemp="WPFObject(""SourceTreeListView"")"
    objEditSource=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WaitChild(strTemp,15000000)
    if objEditSource.Exists = True then

          strTemp="WPFObject(""ContentControlEx"", ""Add Folder"", 2)"
          Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 4).WPFObject("BarButtonItemLinkControl", "", 1).FindChild("Name",strTemp,50,True)
          If objNewWrkSpace_okbtn.Exists = True then
             If objNewWrkSpace_okbtn.Enabled = True then
              objNewWrkSpace_okbtn.Click
              strTCRemarks = strTCRemarks & "<br />" & "Add Folder is found in Source"
              log.Message "Add Folder is found in Source"
             Else
              strTCRemarks = strTCRemarks & "<br />" & "Add Folder is Disabled in Source"
              log.Message "Add Folder is Disabled in Source"
             End if
          Else
            strTCRemarks = strTCRemarks & "<br />" & "Add Folder is  not found in Source"
            log.Message "Add Folder is not found in Source"
          End If   
        
          
           Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 4).WPFObject("BarButtonItemLinkControl", "", 1)      
         Delay 8000,"New Folder..."

        ''Getting no. of Rows under level 2
        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count
        intK=intTotNodeCnt-1
    
        Set objDescCell=Aliases.EdgeClient.HwndSource_RibbonWindow.RibbonWindow.ContentControl.Grid.Grid.ContentControl.Grid.ContentControl.PART_ContainerContent.BarManager.DockPanel.DockLayoutManager.LayoutGroup.LayoutPanel2.Root.BarManager.AdornerDecorator.AdornedControl.Grid.DockPanel.SourceTreeListControl.SourceTreeListView.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK)
        Call objDescCell.Content.set_Description(DescText)
        strTCRemarks = strTCRemarks & "<br />" & "Description is added in new folder"
        log.Message "Description is added in new folder"
        
        Call objDescCell.Content.set_DescriptionLocal(DescLocalText)
        strTCRemarks = strTCRemarks & "<br />" & "Description local is added in new folder"
        log.Message "Description local is added in new folder"
            
          
         Delay 15000,"Pls Wait.."
      Call SClosesource()
      Delay 5000,"Pls Wait.."
                   
    End if
 

    Dim objSaveWrk,objWait  
     set objSaveWrk=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 12).WPFObject("BarSubItemLinkControl", "", 1)
    strTemp="WPFObject(""ContentControlEx"", ""Workspace"", 2)"
    Set objTemp=objSaveWrk.FindChild("Name",strTemp,50)
    objWait=1
    Do until objTemp.Enabled = true 
        If objWait < 20 Then
          Delay 1000,"Pls Wait... Form is loading..."
          objWait=objWait+1
        else
          Call SClosesource()
          Call SourceWorkSpacevwr()
          Exit Sub
        end if 
    Loop 
    
    strTemp="WPFObject(""ContentControlEx"", ""Workspace"", 2)"
    Set objWrkSpace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,50,True)
    If objWrkSpace.Exists = True then
      Delay(1000)
      objWrkSpace.Click
      Delay(1000)
      strTemp="WPFObject(""PopupMenuBarControl"", """", 1)"
      Set objwrkspacepop=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").Findchild("Name",strTemp,50,True)
      'Set objwrkspacepop=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 2).WPFObject("BarButtonItemLinkControl", "", 1).WPFObject("ContentControlEx", "Upload Workspace", 2)
      If objwrkspacepop.Exists = True then
        strTemp="WPFObject(""ContentControlEx"", ""Upload Workspace"", 2)"
        set objwrkspcUpload=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).FindChild("Name",strTemp,50,True)
        If objwrkspcUpload.Exists = True then
          objwrkspcUpload.Click
          'Delay 1000,"Pls Wait.."
          strTemp="WPFObject(""PART_ContainerContent"")"
          Set objConfirm=Sys.Process("EdgeClient").WPFObject("HwndSource: WindowContentHolder", "Confirm").FindChild("Name",strTemp,50,True)
          strTemp="WPFObject(""DXMessageBox"", """", 1)"
          Set objConfirm=objConfirm.WaitChild(strTemp,180000)
          If objConfirm.Exists = True then
            objConfirm.Keys "[Enter]"
            'Delay 8000,"Uploading..."
            Set objConfirm = Sys.Process("EdgeClient")._
            Waitchild("WPFObject(""HwndSource: CustomMessageBoxWindow"", ""Upload Workspace"")",600000)._
            Waitchild("WPFObject(""CustomMessageBoxWindow"", ""Upload Workspace"", 1)",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""FloatingContainerBorder"")",60000)._
            Waitchild("WPFObject(""FloatingContainerBackground"")",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""FloatingContainerBody"")",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""PART_ContainerContent"")",60000)
            
            If objConfirm.Exists = True then
              Sys.Keys("O")
              'Delay 30000,"Pls Wait.."
              Call sEdgeProcessor
            End if
          End if
        End if
      End if
    End if
    
    Call sHome_Source
    
    strTemp="WPFObject(""SourceTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""SourceTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    Delay 10000,"Pls Wait.."
    ''Selecting Country Name
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
          GridControl.Nodes_2.Item(intI).Expand(True)
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description       
          blnFlag=False  
          Exit For
        End If
    Next
    If blnFlag = True then
      strTCRemarks="Country Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
  
    Delay 10000,"Pls Wait.."
        blnFlag = True 
    ''Selecting Level2Source_Name
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
  For intJ=0 to intTotNodeCnt-1
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(StrSource2) then
        GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
        intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
'        Call GridSourceTree.ClickCell(intRow, "Edit")
        Call GridControl.ClearSelectionCore
        Call GridControl.FocusViewAndRow(GridControl,intRow)
        GridControl.SetFocusOnCurrentItem
        Call GridControl.SelectRowCore(intRow)
        log.Message "Level2 Source Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
        blnFlag = False 
        Exit For
      End If
    Next
    If blnFlag = True then
      log.Message "Level2 Source Name not found"
      strTCRemarks="Level2 Source Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
    
     Delay 10000,"Pls Wait.."
    blnFlag = True 
   
    Delay 2000,"Pls Wait.."

    strTemp="WPFObject(""ArrowControl"", """", 1)"
    Set objNewWorkspace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,20,True)
    If objNewWorkspace.Exists = True then
      objNewWorkspace.Click
       strTemp="WPFObject(""BarPopupBorderControl"", """", 1)"
      Set objWrkspace_popup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").FindChild("Name",strTemp,5,True)
      If objWrkspace_popup.Exists = True then
        strTemp="WPFObject(""ContentControlEx"", ""Open For Edit (Source)"", 2)"
        Set objopenforEdit=objWrkspace_popup.FindChild("Name",strTemp,8,True)
        If objopenforEdit.Exists then
          objopenforEdit.Click    
        End If
      End if
      
      strTemp1="WPFObject(""HwndSource: WorkspaceNamePrompt"", ""Please provide a new Workspace Name"")"
      Set objNewWrkSpaceName=Sys.Process("EdgeClient").WaitChild(strTemp1,50000)
      If objNewWrkSpaceName.Exists = True then
     
      ''Waiting for Workspace Name prompt
      strTemp="WPFObject(""FloatingContainerBorder"")"
      Set objNewWrkSpace_Name=Sys.Process("EdgeClient").WPFObject("HwndSource: WorkspaceNamePrompt", "Please provide a new Workspace Name").WPFObject("WorkspaceNamePrompt", "Please provide a new Workspace Name", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,15000000)
      If objNewWrkSpace_Name.Exists = True then
          strTemp="WPFObject(""ChangeNameTextEdit"")"
          ''Entering Workspace Name
          Set objNewWrkSpace_Txtbox=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
            If objNewWrkSpace_Txtbox.Exists = True then
              objNewWrkSpace_Txtbox.Click
              objNewWrkSpace_Txtbox.Text=strWrkSpaceName
      '        strTCRemarks=strTCRemarks & Chr(10) & "Entered Workspace Name - " & strWrkSpaceName
              ''Clicking on Ok Button 
              strTemp="WPFObject(""OkButton"")"
              Set objNewWrkSpace_okbtn=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
              If objNewWrkSpace_okbtn.Exists = True then
                objNewWrkSpace_okbtn.Click
                'Delay 5000,"Please wait..."
              End If
            End If
        End If
      End if 
     End if 
       
  
       ''Handling Validation for Source
    strTemp="WPFObject(""HwndSource: WindowContentHolder"", """")"
    Set objTemp=Sys.Process("EdgeClient").WaitChild(strTemp,10000)
    If objTemp.Exists = True then
      objTemp.Keys "[Enter]"
      strTestCaseResult = "FAIL"
      Exit Sub
    End If

    ''WorkSpace Edit Window
    strTemp="WPFObject(""LayoutPanel"", """", 2)"
    Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,13,True)
    If objTemp.Exists then
        Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WPFObject("SourceTreeListView")
        Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl")
       Delay 10000,"Pls Wait.."
        ''Expanding First Node in Tree      
        intTotNodeCnt=GridControl.Nodes_2.Count  
        For intI=0 to intTotNodeCnt-1         
          If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
           GridControl.Nodes_2.Item(intI).Expand(True)
           blnFlag=False  
           Exit For
          End If
        Next
         Delay 10000,"Pls Wait.."
        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
          For intJ=0 to intTotNodeCnt-1
            If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strSource2) then
              GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
              intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(0).get_RowHandle
              GridControl.Keys "^[Home]"
              Call GridControl.ClearSelectionCore
              Call GridControl.FocusViewAndRow(GridControl,intRow-1)
              GridControl.SetFocusOnCurrentItem
              Call GridControl.SelectRowCore(intRow-1)
        
              If objGridCell.Exists = True then
                objGridCell.Click
              End If
              blnFlag = False 
              Exit For
            End If
          Next
           Delay 10000,"Pls Wait.."
              intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count
               For intK=0 to intTotNodeCnt-1
                  If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description)=Ucase(DescText) then
                      intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).get_RowHandle
                      Call GridControl.ClearSelectionCore
                      GridControl.set_FocusedRowHandle(intRow)
                      Call GridControl.FocusViewAndRow(GridControl,intRow)
                      GridControl.SetFocusOnCurrentItem
                      Call GridControl.SelectRowCore(intRow)
                      Exit For   
                  End If 
               Next
    End if
        
  Delay 15000,"Pls Wait.."
    strTemp="WPFObject(""SourceTreeListView"")"
    objEditSource=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WaitChild(strTemp,15000000)
    if objEditSource.Exists = True then
          strTemp="WPFObject(""ContentControlEx"", ""Delete Folder"", 2)"
          Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 7).WPFObject("BarButtonItemLinkControl", "", 1).FindChild("Name",strTemp,50,True)
          If objNewWrkSpace_okbtn.Exists = True then
             If objNewWrkSpace_okbtn.Enabled = True then
              'objNewWrkSpace_okbtn.Click
              sys.Keys("^[Del]")
              strTCRemarks = strTCRemarks & "<br />" & "Delete Folder is found in Source"
              log.Message "Delete Folder is found in Source"
              strTemp="WPFObject(""PART_ContainerContent"")"
              Set objConfirm=Sys.Process("EdgeClient").WPFObject("HwndSource: WindowContentHolder", "Confirm").WPFObject("WindowContentHolder", "Confirm", 1).FindChild("Name",strTemp,50,True)
              strTemp="WPFObject(""DXMessageBox"", """", 1)"
              Set objConfirm=objConfirm.WaitChild(strTemp,180000)
              If objConfirm.Exists = True then
                objConfirm.Keys "[Enter]"
                'Call sEdgeProcessor
              End if

             Else
              strTCRemarks = strTCRemarks & "<br />" & "Delete Folder is Disabled in Source"
              log.Message "Delete Folder is Disabled in Source"
             End if
          Else
            strTCRemarks = strTCRemarks & "<br />" & "Delete Folder is  not found in Source"
            log.Message "Delete Folder is not found in Source"
          End If   

    end if
    
      
      Delay 15000,"Pls Wait.."
      Call SClosesource()
      Delay 5000,"Pls Wait.."
     set objSaveWrk=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 12).WPFObject("BarSubItemLinkControl", "", 1)
    strTemp="WPFObject(""ContentControlEx"", ""Workspace"", 2)"
    Set objTemp=objSaveWrk.FindChild("Name",strTemp,50)
    objWait=1
    Do until objTemp.Enabled = true 
        If objWait < 20 Then
          Delay 1000,"Pls Wait... Form is loading..."
          objWait=objWait+1
        else
          Call SClosesource()
          Call SourceWorkSpacevwr()
          Exit Sub
        end if 
    Loop 
    
    strTemp="WPFObject(""ContentControlEx"", ""Workspace"", 2)"
    Set objWrkSpace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,50,True)
    If objWrkSpace.Exists = True then
      Delay(1000)
      objWrkSpace.Click
      Delay(1000)
      strTemp="WPFObject(""PopupMenuBarControl"", """", 1)"
      Set objwrkspacepop=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").Findchild("Name",strTemp,50,True)
      If objwrkspacepop.Exists = True then
        strTemp="WPFObject(""ContentControlEx"", ""Upload Workspace"", 2)"
        set objwrkspcUpload=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).FindChild("Name",strTemp,50,True)
        If objwrkspcUpload.Exists = True then
          objwrkspcUpload.Click
          'Delay 1000,"Pls Wait.."
          strTemp="WPFObject(""PART_ContainerContent"")"
          Set objConfirm=Sys.Process("EdgeClient").WPFObject("HwndSource: WindowContentHolder", "Confirm").FindChild("Name",strTemp,50,True)
          strTemp="WPFObject(""DXMessageBox"", """", 1)"
          Set objConfirm=objConfirm.WaitChild(strTemp,180000)
          If objConfirm.Exists = True then
            objConfirm.Keys "[Enter]"
            'Delay 8000,"Uploading..."
            Set objConfirm = Sys.Process("EdgeClient")._
            Waitchild("WPFObject(""HwndSource: CustomMessageBoxWindow"", ""Upload Workspace"")",600000)._
            Waitchild("WPFObject(""CustomMessageBoxWindow"", ""Upload Workspace"", 1)",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""FloatingContainerBorder"")",60000)._
            Waitchild("WPFObject(""FloatingContainerBackground"")",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""FloatingContainerBody"")",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""PART_ContainerContent"")",60000)
            
            If objConfirm.Exists = True then
              Sys.Keys("O")
              'Delay 30000,"Pls Wait.."
              Call sEdgeProcessor
            End if
          End if
        End if
      End if
    End if

     Call sHome_Source
    
    strTemp="WPFObject(""SourceTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""SourceTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    Delay 10000,"Pls Wait.."
    ''Selecting Country Name
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
          GridControl.Nodes_2.Item(intI).Expand(True)
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description       
          blnFlag=False  
          Exit For
        End If
    Next
    If blnFlag = True then
      strTCRemarks="Country Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
  
    Delay 10000,"Pls Wait.."
        blnFlag = True 
    ''Selecting Level2Source_Name
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
  For intJ=0 to intTotNodeCnt-1
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(StrSource2) then
        GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
        intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
'        Call GridSourceTree.ClickCell(intRow, "Edit")
        Call GridControl.ClearSelectionCore
        Call GridControl.FocusViewAndRow(GridControl,intRow)
        GridControl.SetFocusOnCurrentItem
        Call GridControl.SelectRowCore(intRow)
        log.Message "Level2 Source Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
        blnFlag = False 
        Exit For
      End If
    Next
    If blnFlag = True then
      log.Message "Level2 Source Name not found"
      strTCRemarks="Level2 Source Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
    
     Delay 10000,"Pls Wait.."
    blnFlag = True 
   
    Delay 2000,"Pls Wait.."

    strTemp="WPFObject(""ArrowControl"", """", 1)"
    Set objNewWorkspace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,20,True)
    If objNewWorkspace.Exists = True then
      objNewWorkspace.Click
       strTemp="WPFObject(""BarPopupBorderControl"", """", 1)"
      Set objWrkspace_popup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").FindChild("Name",strTemp,5,True)
      If objWrkspace_popup.Exists = True then
        strTemp="WPFObject(""ContentControlEx"", ""Open For Edit (Source)"", 2)"
        Set objopenforEdit=objWrkspace_popup.FindChild("Name",strTemp,8,True)
        If objopenforEdit.Exists then
          objopenforEdit.Click    
        End If
      End if
      
      strTemp1="WPFObject(""HwndSource: WorkspaceNamePrompt"", ""Please provide a new Workspace Name"")"
      Set objNewWrkSpaceName=Sys.Process("EdgeClient").WaitChild(strTemp1,50000)
      If objNewWrkSpaceName.Exists = True then
     
      ''Waiting for Workspace Name prompt
      strTemp="WPFObject(""FloatingContainerBorder"")"
      Set objNewWrkSpace_Name=Sys.Process("EdgeClient").WPFObject("HwndSource: WorkspaceNamePrompt", "Please provide a new Workspace Name").WPFObject("WorkspaceNamePrompt", "Please provide a new Workspace Name", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,15000000)
      If objNewWrkSpace_Name.Exists = True then
          strTemp="WPFObject(""ChangeNameTextEdit"")"
          ''Entering Workspace Name
          Set objNewWrkSpace_Txtbox=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
            If objNewWrkSpace_Txtbox.Exists = True then
              objNewWrkSpace_Txtbox.Click
              objNewWrkSpace_Txtbox.Text=strWrkSpaceName
      '        strTCRemarks=strTCRemarks & Chr(10) & "Entered Workspace Name - " & strWrkSpaceName
              ''Clicking on Ok Button 
              strTemp="WPFObject(""OkButton"")"
              Set objNewWrkSpace_okbtn=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
              If objNewWrkSpace_okbtn.Exists = True then
                objNewWrkSpace_okbtn.Click
                'Delay 5000,"Please wait..."
              End If
            End If
        End If
      End if 
     End if 
       
  
       ''Handling Validation for Source
    strTemp="WPFObject(""HwndSource: WindowContentHolder"", """")"
    Set objTemp=Sys.Process("EdgeClient").WaitChild(strTemp,10000)
    If objTemp.Exists = True then
      objTemp.Keys "[Enter]"
      strTestCaseResult = "FAIL"
      Exit Sub
    End If

    ''WorkSpace Edit Window
    strTemp="WPFObject(""LayoutPanel"", """", 2)"
    Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,13,True)
    If objTemp.Exists then
        Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WPFObject("SourceTreeListView")
        Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl")
       Delay 10000,"Pls Wait.."
        ''Expanding First Node in Tree      
        intTotNodeCnt=GridControl.Nodes_2.Count  
        For intI=0 to intTotNodeCnt-1         
          If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
           GridControl.Nodes_2.Item(intI).Expand(True)
           blnFlag=False  
           Exit For
          End If
        Next
         Delay 10000,"Pls Wait.."
        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
          For intJ=0 to intTotNodeCnt-1
            If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strSource2) then
              GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
              intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(0).get_RowHandle
              GridControl.Keys "^[Home]"
              Call GridControl.ClearSelectionCore
              Call GridControl.FocusViewAndRow(GridControl,intRow-1)
              GridControl.SetFocusOnCurrentItem
              Call GridControl.SelectRowCore(intRow-1)
        
              If objGridCell.Exists = True then
                objGridCell.Click
              End If
              blnFlag = False 
              Exit For
            End If
          Next
           Delay 10000,"Pls Wait.."
              intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count
               For intK=0 to intTotNodeCnt-1
                  If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description)=Ucase(DescText) then
                      intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).get_RowHandle
                      Call GridControl.ClearSelectionCore
                      GridControl.set_FocusedRowHandle(intRow)
                      Call GridControl.FocusViewAndRow(GridControl,intRow)
                      GridControl.SetFocusOnCurrentItem
                      Call GridControl.SelectRowCore(intRow)
                      Exit For   
                  else
                    strTCRemarks = strTCRemarks & "<br />" & "Delete Folder is not found in Source"
                    log.Message "Delete Folder is not found in Source"
                    Exit For   
                  End If 
               Next
               
      Call SClosesource()
      Delay 5000,"Pls Wait.."
      Call SClosesource()
      Call SourceWorkSpacevwr()
    End if

End Sub
Sub  sCheckSrcOpenEditSeries(strParameters)
On Error Resume Next 
   Dim strSource1,StrSource2,strSource3,strTemp,GridControl,GridSourceTree,intTotNodeCnt,intI,intJ,intRow,intK,objEdge
   Dim objNewWorkspace,objWrkspace_popup,objOpenView,strTemp1,objNewWrkSpaceName,objNewWrkSpace_Txtbox,objNewWrkSpace_okbtn,objNewWrkSpace_Name
   Dim strDesc1,strDesc2,DescText,DescLocalText
   Dim objEditSource
   Dim objTemp, objStrClose
   
  strSource1=getSplitValue(strParameters,"SOURCE")
  StrSource2=getSplitValue(strParameters,"LEVEL2SOURCE")
  StrSource3=getSplitValue(strParameters,"LEVEL3SOURCE")
    
'    strSource1="Test"
'    StrSource2="Automation_UIT2"
'    StrSource3="Test"

    Call sHome_Source
    
    strDesc1=aqDateTime.Now
    strDesc2=aqDateTime.Now
    DescText=Replace(strDesc1,"/","-")
    DescText=Replace(DescText,":","_")
    DescLocalText=DescText
    strWrkSpaceName=DescText
'    intSeriesID=getSplitValue(strParameters,"SERIESID")
'    if intSeriesID=0 then
'      Call sSourceseries
'      intSeriesID=strSourceFileText
'    End if 
    
    strTemp="WPFObject(""SourceTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""SourceTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    Delay 10000,"Pls Wait.."
    ''Selecting Country Name
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
          GridControl.Nodes_2.Item(intI).Expand(True)
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description       
          blnFlag=False  
          Exit For
        End If
    Next
    If blnFlag = True then
      strTCRemarks="Country Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
  
    Delay 10000,"Pls Wait.."
        blnFlag = True 
    ''Selecting Level2Source_Name
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
  For intJ=0 to intTotNodeCnt-1
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(StrSource2) then
        GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
        intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
'        Call GridSourceTree.ClickCell(intRow, "Edit")
        Call GridControl.ClearSelectionCore
        Call GridControl.FocusViewAndRow(GridControl,intRow)
        GridControl.SetFocusOnCurrentItem
        Call GridControl.SelectRowCore(intRow)
        log.Message "Level2 Source Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
        blnFlag = False 
        Exit For
      End If
    Next
    If blnFlag = True then
      log.Message "Level2 Source Name not found"
      strTCRemarks="Level2 Source Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
    
     Delay 10000,"Pls Wait.."
    blnFlag = True 
   
    Delay 2000,"Pls Wait.."

    strTemp="WPFObject(""ArrowControl"", """", 1)"
    Set objNewWorkspace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,20,True)
    If objNewWorkspace.Exists = True then
      objNewWorkspace.Click
       strTemp="WPFObject(""BarPopupBorderControl"", """", 1)"
      Set objWrkspace_popup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").FindChild("Name",strTemp,5,True)
      If objWrkspace_popup.Exists = True then
        strTemp="WPFObject(""ContentControlEx"", ""Open For Edit (Source)"", 2)"
        Set objopenforEdit=objWrkspace_popup.FindChild("Name",strTemp,8,True)
        If objopenforEdit.Exists then
          objopenforEdit.Click    
        End If
      End if
      
      strTemp1="WPFObject(""HwndSource: WorkspaceNamePrompt"", ""Please provide a new Workspace Name"")"
      Set objNewWrkSpaceName=Sys.Process("EdgeClient").WaitChild(strTemp1,50000)
      If objNewWrkSpaceName.Exists = True then
     
      ''Waiting for Workspace Name prompt
      strTemp="WPFObject(""FloatingContainerBorder"")"
      Set objNewWrkSpace_Name=Sys.Process("EdgeClient").WPFObject("HwndSource: WorkspaceNamePrompt", "Please provide a new Workspace Name").WPFObject("WorkspaceNamePrompt", "Please provide a new Workspace Name", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,15000000)
      If objNewWrkSpace_Name.Exists = True then
          strTemp="WPFObject(""ChangeNameTextEdit"")"
          ''Entering Workspace Name
          Set objNewWrkSpace_Txtbox=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
            If objNewWrkSpace_Txtbox.Exists = True then
              objNewWrkSpace_Txtbox.Click
              objNewWrkSpace_Txtbox.Text=strWrkSpaceName
      '        strTCRemarks=strTCRemarks & Chr(10) & "Entered Workspace Name - " & strWrkSpaceName
              ''Clicking on Ok Button 
              strTemp="WPFObject(""OkButton"")"
              Set objNewWrkSpace_okbtn=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
              If objNewWrkSpace_okbtn.Exists = True then
                objNewWrkSpace_okbtn.Click
                'Delay 5000,"Please wait..."
              End If
            End If
        End If
      End if 
     End if 
       
  
       ''Handling Validation for Source
    strTemp="WPFObject(""HwndSource: WindowContentHolder"", """")"
    Set objTemp=Sys.Process("EdgeClient").WaitChild(strTemp,10000)
    If objTemp.Exists = True then
      objTemp.Keys "[Enter]"
      strTestCaseResult = "FAIL"
      Exit Sub
    End If

    ''WorkSpace Edit Window
    strTemp="WPFObject(""LayoutPanel"", """", 2)"
    Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,13,True)
    If objTemp.Exists then
        Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WPFObject("SourceTreeListView")
        Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl")
       Delay 10000,"Pls Wait.."
        ''Expanding First Node in Tree      
        intTotNodeCnt=GridControl.Nodes_2.Count  
        For intI=0 to intTotNodeCnt-1         
          If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
           GridControl.Nodes_2.Item(intI).Expand(True)
           blnFlag=False  
           Exit For
          End If
        Next
         Delay 10000,"Pls Wait.."
        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
          For intJ=0 to intTotNodeCnt-1
            If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strSource2) then
              GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
              intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(0).get_RowHandle
              GridControl.Keys "^[Home]"
              Call GridControl.ClearSelectionCore
              Call GridControl.FocusViewAndRow(GridControl,intRow-1)
              GridControl.SetFocusOnCurrentItem
              Call GridControl.SelectRowCore(intRow-1)
        
              If objGridCell.Exists = True then
                objGridCell.Click
              End If
              blnFlag = False 
              Exit For
            End If
          Next
'           Delay 10000,"Pls Wait.."
'              intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count
'               For intK=0 to intTotNodeCnt-1
'                  If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description)=Ucase(strSource3) then
'                      intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).get_RowHandle
'                      Call GridControl.ClearSelectionCore
'                      GridControl.set_FocusedRowHandle(intRow)
'                      Call GridControl.FocusViewAndRow(GridControl,intRow)
'                      GridControl.SetFocusOnCurrentItem
'                      Call GridControl.SelectRowCore(intRow)
'                      Exit For   
'                  End If 
'               Next
    End if
        
'        Delay 15000,"Pls Wait.."
'      Call SClosesource()
'      Delay 5000,"Pls Wait.."
    
    strTemp="WPFObject(""SourceTreeListView"")"
    'objEditSource=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WaitChild(strTemp,15000000)
    objEditSource=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WaitChild(strTemp,15000000)
    if objEditSource.Exists = True then
          strTemp="WPFObject(""ContentControlEx"", ""Attach Series"", 2)"
          Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("SourceSeriesViewControl").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarButtonItemLinkControl", "", 1).FindChild("Name",strTemp,50,True)
          If objNewWrkSpace_okbtn.Exists = True then
             If objNewWrkSpace_okbtn.Enabled = True then
              strTCRemarks = strTCRemarks & "<br />" & "Attach Series is found in Source"
              log.Message "Attach Series is found in Source"
             Else
              strTCRemarks = strTCRemarks & "<br />" & "Attach Series is Disabled in Source"
              log.Message "Attach Series is Disabled in Source"
             End if
          Else
            strTCRemarks = strTCRemarks & "<br />" & "Attach Series is not found in Source"
            log.Message "Attach Series is not found in Source"
          End If
          
          
          strTemp="WPFObject(""ContentControlEx"", ""Detach Series"", 2)"
          Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("SourceSeriesViewControl").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 2).WPFObject("BarButtonItemLinkControl", "", 1).FindChild("Name",strTemp,50,True)
          If objNewWrkSpace_okbtn.Exists = True then
             If objNewWrkSpace_okbtn.Enabled = True then
              strTCRemarks = strTCRemarks & "<br />" & "Detach Series is found in Source"
              log.Message "Detach Series is found in Source"
             Else
              strTCRemarks = strTCRemarks & "<br />" & "Detach Series is Disabled in Source"
              log.Message "Detach Series is Disabled in Source"
             End if
          Else
            strTCRemarks = strTCRemarks & "<br />" & "Detach Series is not found in Source"
            log.Message "Detach Series is not found in Source"
          End If
     
          strTemp="WPFObject(""ContentControlEx"", ""Copy Series"", 2)"
          Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("SourceSeriesViewControl").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 4).WPFObject("BarButtonItemLinkControl", "", 1).FindChild("Name",strTemp,50,True)
          If objNewWrkSpace_okbtn.Exists = True then
             If objNewWrkSpace_okbtn.Enabled = True then
              strTCRemarks = strTCRemarks & "<br />" & "Copy Series is found in Source"
              log.Message "Copy Series is found in Source"
             Else
              strTCRemarks = strTCRemarks & "<br />" & "Copy Series is Disabled in Source"
              log.Message "Copy Series is Disabled in Source"
             End if
          Else
            strTCRemarks = strTCRemarks & "<br />" & "Copy Series is not found in Source"
            log.Message "Copy Series is not found in Source"
          End If
 
          strTemp="WPFObject(""ContentControlEx"", ""Add Separator"", 2)"
          Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("SourceSeriesViewControl").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 3).WPFObject("BarButtonItemLinkControl", "", 1).FindChild("Name",strTemp,50,True)
          If objNewWrkSpace_okbtn.Exists = True then
             If objNewWrkSpace_okbtn.Enabled = True then
              strTCRemarks = strTCRemarks & "<br />" & "Add Separator is found in Source"
              log.Message "Add Separator is found in Source"
             Else
              strTCRemarks = strTCRemarks & "<br />" & "Add Separator is Disabled in Source"
              log.Message "Add Separator is Disabled in Source"
             End if
          Else
            strTCRemarks = strTCRemarks & "<br />" & "Add Separator is not found in Source"
            log.Message "Add Separator is not found in Source"
          End If
          
          strTemp="WPFObject(""ContentControlEx"", ""Cut Series"", 2)"
          Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("SourceSeriesViewControl").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 5).WPFObject("BarButtonItemLinkControl", "", 1).FindChild("Name",strTemp,50,True)
          If objNewWrkSpace_okbtn.Exists = True then
             If objNewWrkSpace_okbtn.Enabled = True then
              strTCRemarks = strTCRemarks & "<br />" & "Cut Series is found in Source"
              log.Message "Cut Series is found in Source"
             Else
              strTCRemarks = strTCRemarks & "<br />" & "Cut Series is Disabled in Source"
              log.Message "Cut Series is Disabled in Source"
             End if
          Else
            strTCRemarks = strTCRemarks & "<br />" & "Cut Series is not found in Source"
            log.Message "Cut Series is not found in Source"
          End If
     
          strTemp="WPFObject(""ContentControlEx"", ""Paste Series"", 2)"
          Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("SourceSeriesViewControl").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 6).WPFObject("BarSubItemLinkControl", "", 1).FindChild("Name",strTemp,50,True)
          If objNewWrkSpace_okbtn.Exists = True then
             If objNewWrkSpace_okbtn.Enabled = True then
              strTCRemarks = strTCRemarks & "<br />" & "Paste Series is found in Source"
              log.Message "Paste Series is found in Source"
             Else
              strTCRemarks = strTCRemarks & "<br />" & "Paste Series is Disabled in Source"
              log.Message "Paste Series is Disabled in Source"
             End if
          Else
            strTCRemarks = strTCRemarks & "<br />" & "Paste Series is not found in Source"
            log.Message "Paste Series is not found in Source"
          End If
 
          strTemp="WPFObject(""ContentControlEx"", ""Make Primary"", 2)"
          Set objNewWrkSpace_okbtn=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("SourceSeriesViewControl").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 7).WPFObject("BarButtonItemLinkControl", "", 1).FindChild("Name",strTemp,50,True)
          If objNewWrkSpace_okbtn.Exists = True then
             If objNewWrkSpace_okbtn.Enabled = True then
              strTCRemarks = strTCRemarks & "<br />" & "Make Primary is found in Source"
              log.Message "Make Primary is found in Source"
             Else
              strTCRemarks = strTCRemarks & "<br />" & "Make Primary is Disabled in Source"
              log.Message "Make Primaryr is Disabled in Source"
             End if
          Else
            strTCRemarks = strTCRemarks & "<br />" & "Add Separator is  not found in Source"
            log.Message "Add Separator is not found in Source"
          End If

    End if
 

  Call SClosesource()
  Call SClosesource()
  Call SourceWorkSpacevwr()
End Sub

Sub sCheckSrcSourceModule()
On Error Resume Next

    Dim strSource_Name,strLevel2src_Name,objNewWrkSpace_okbtn,objNewWrkSpace_Name,strWrkSpaceName
    Dim objNewWrkSpace_Txtbox,objopenforEdit,objWrkspace_popup
    Dim strTemp,objTemp,intRow,barManager,intTotNodeCnt,Text,strDesc1,strDesc2
    Dim objWrkSpace,objwrkspacepop,objwrkspcUpload,objConfirm,objGridCell,DescLocalText,intSeriesID
    Dim layoutGroup,strSource1,StrSource2
    Dim strTemp1,objNewWrkSpaceName

'    strSource_Name=getSplitValue(strParameters,"SOURCE")
'    strLevel2src_Name=getSplitValue(strParameters,"LEVEL2SOURCE")
'    
'    'strWrkSpaceName=getSplitValue(strParameters,"WORKSPACENAME")
'    'DescText=getSplitValue(strParameters,"DESCRIPTIONTEXT")
'    'DescLocalText=getSplitValue(strParameters,"DESCRIPTIONLOCALTEXT")
'    
'    strDesc1=aqDateTime.Now
'    strDesc2=aqDateTime.Now
'    DescText=Replace(strDesc1,"/","-")
'    DescText=Replace(DescText,":","_")
'    DescLocalText=DescText
'    strWrkSpaceName=DescText

'   strSource1=getSplitValue(strParameters,"SOURCE")
'  StrSource2=getSplitValue(strParameters,"LEVEL2SOURCE")
'  StrSource3=getSplitValue(strParameters,"LEVEL3SOURCE")
    
    strSource1="Test"
    StrSource2="Automation_UIT2"
    StrSource3="Test"
    'intSeriesID=368766057

    Call sHome_Source
    
    strDesc1=aqDateTime.Now
    strDesc2=aqDateTime.Now
    DescText=Replace(strDesc1,"/","-")
    DescText=Replace(DescText,":","_")
    DescLocalText=DescText
    strWrkSpaceName=DescText
    intSeriesID=getSplitValue(strParameters,"SERIESID")
    if intSeriesID=0 then
      Call sSourceseries
      intSeriesID=strSourceFileText
    End if  
    
    strTemp="WPFObject(""SourceTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""SourceTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
    Delay 10000,"Pls Wait.."
    ''Selecting Country Name
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource1) then
          GridControl.Nodes_2.Item(intI).Expand(True)
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description       
    '      strTCRemarks=strTCRemarks & Chr(10) & "Selected Node - " & GridControl.Nodes_2.Item(intI).Content.Description  
          blnFlag=False  
          Exit For
        End If
    Next
    If blnFlag = True then
      strTCRemarks="Country Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
  
    Delay 10000,"Pls Wait.."
        blnFlag = True 
    ''Selecting Level2Source_Name
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
  For intJ=0 to intTotNodeCnt-1
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(StrSource2) then
        GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
    '    intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(0).get_RowHandle
        intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
'        Call GridSourceTree.ClickCell(intRow, "Edit")
        Call GridControl.ClearSelectionCore
        Call GridControl.FocusViewAndRow(GridControl,intRow)
        GridControl.SetFocusOnCurrentItem
        Call GridControl.SelectRowCore(intRow)
        log.Message "Level2 Source Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
        blnFlag = False 
        Exit For
      End If
    Next
    If blnFlag = True then
      log.Message "Level2 Source Name not found"
      strTCRemarks="Level2 Source Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
    Delay 2000,"Pls Wait.."

    ''Clicking on "New Workspace" Button and selecting "Open for Edit(Souce)" option 
    strTemp="WPFObject(""ArrowControl"", """", 1)"
    Set objNewWorkspace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,20,True)
    If objNewWorkspace.Exists = True then
      objNewWorkspace.Click
      strTemp="WPFObject(""BarPopupBorderControl"", """", 1)"
      Set objWrkspace_popup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").FindChild("Name",strTemp,5,True)
      If objWrkspace_popup.Exists = True then
        strTemp="WPFObject(""ContentControlEx"", ""Open For Edit (Source)"", 2)"
        Set objopenforEdit=objWrkspace_popup.FindChild("Name",strTemp,8,True)
        If objopenforEdit.Exists then
          objopenforEdit.Click    
          'Delay 20000,"Please Wait..."
        End If
      End If
     
    
      strTemp1="WPFObject(""HwndSource: WorkspaceNamePrompt"", ""Please provide a new Workspace Name"")"
      Set objNewWrkSpaceName=Sys.Process("EdgeClient").WaitChild(strTemp1,50000)
      If objNewWrkSpaceName.Exists = True then
     
      ''Waiting for Workspace Name prompt
      strTemp="WPFObject(""FloatingContainerBorder"")"
      Set objNewWrkSpace_Name=Sys.Process("EdgeClient").WPFObject("HwndSource: WorkspaceNamePrompt", "Please provide a new Workspace Name").WPFObject("WorkspaceNamePrompt", "Please provide a new Workspace Name", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,15000000)
     ' Set objNewWrkSpace_Name=Sys.Process("EdgeClient").WaitChild(strTemp,15000000)
        If objNewWrkSpace_Name.Exists = True then
          strTemp="WPFObject(""ChangeNameTextEdit"")"
          ''Entering Workspace Name
          Set objNewWrkSpace_Txtbox=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
            If objNewWrkSpace_Txtbox.Exists = True then
              objNewWrkSpace_Txtbox.Click
              objNewWrkSpace_Txtbox.Text=strWrkSpaceName
      '        strTCRemarks=strTCRemarks & Chr(10) & "Entered Workspace Name - " & strWrkSpaceName
              ''Clicking on Ok Button 
              strTemp="WPFObject(""OkButton"")"
              Set objNewWrkSpace_okbtn=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
              If objNewWrkSpace_okbtn.Exists = True then
                objNewWrkSpace_okbtn.Click
                'Delay 5000,"Please wait..."
              End If
            End If
        End If
      End if
    End If

    ''Handling Validation for Source
    strTemp="WPFObject(""HwndSource: WindowContentHolder"", """")"
    Set objTemp=Sys.Process("EdgeClient").WaitChild(strTemp,10000)
    If objTemp.Exists = True then
      objTemp.Keys "[Enter]"
      strTestCaseResult = "FAIL"
      Exit Sub
    End If

    ''WorkSpace Edit Window
    strTemp="WPFObject(""LayoutPanel"", """", 2)"
    Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,13,True)
    If objTemp.Exists then
        Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WPFObject("SourceTreeListView")
        Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl")

        ''Expanding First Node in Tree      
        intTotNodeCnt=GridControl.Nodes_2.Count  
        For intI=0 to intTotNodeCnt-1         
          If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(StrSource1) then
            GridControl.Nodes_2.Item(intI).Expand(True)
            blnFlag=False  
            Exit For
          End If
        Next
    
        ''Expanding Second Node in Tree
        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
        For intJ=0 to intTotNodeCnt-1
          If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(StrSource2) then
            GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
            intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(0).get_RowHandle
            GridControl.Keys "^[Home]"
'            Set objGridCell=GridControl.WPFObject("HierarchyPanel", "", 1).WPFObject("GridRow", "", intRow).WPFObject("ScrollablePart").WPFObject("CellItemsControl", "", 1).WPFObject("GridCellContentPresenter", "", 1).WPFObject("TextEdit", "", 1)
            Call GridControl.ClearSelectionCore
            Call GridControl.FocusViewAndRow(GridControl,intRow-1)
            GridControl.SetFocusOnCurrentItem
            Call GridControl.SelectRowCore(intRow-1)
        
            If objGridCell.Exists = True then
              objGridCell.Click
    '          strTCRemarks=strTCRemarks & Chr(10) & "Selected - " & strLevel2src_Name
            End If
            blnFlag = False 
            Exit For
          End If
        Next
    
        ''Clicking on New Folder
    '   strTemp="WPFObject(""BarButtonItemLinkControl"", """", 1)"
        Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 4).WPFObject("BarButtonItemLinkControl", "", 1)
        If objTemp.Exists = True then
          Delay 3000,"New Folder..."
          objTemp.Click
          Delay 8000,"New Folder..."
        End If
    
        ''Getting no. of Rows under level 2
        intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count
        intK=intTotNodeCnt-1
    
        Set objDescCell=Aliases.EdgeClient.HwndSource_RibbonWindow.RibbonWindow.ContentControl.Grid.Grid.ContentControl.Grid.ContentControl.PART_ContainerContent.BarManager.DockPanel.DockLayoutManager.LayoutGroup.LayoutPanel2.Root.BarManager.AdornerDecorator.AdornedControl.Grid.DockPanel.SourceTreeListControl.SourceTreeListView.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK)
        Call objDescCell.Content.set_Description(DescText)
        Call objDescCell.Content.set_DescriptionLocal(DescLocalText)
        
        ''Attach Series
        Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("SourceSeriesViewControl").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarButtonItemLinkControl", "", 1)
        If objTemp.Exists = True then
          objTemp.DblClick
          ''Entering Series      
          Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: SourceSeriesPrompt", "Attach Source Series").WPFObject("SourceSeriesPrompt", "Attach Source Series", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("SeriesIdTextEdit")
          If objTemp.Exists = True then
             objTemp.Text=intSeriesID
             Delay(10000)
             ''Clicking on OK Button
             Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: SourceSeriesPrompt", "Attach Source Series").WPFObject("SourceSeriesPrompt", "Attach Source Series", 1).WPFObject("Grid", "", 1).WPFObject("FloatingContainerBorder").WPFObject("FloatingContainerBackground").WPFObject("Grid", "", 1).WPFObject("FloatingContainerBody").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 1).WPFObject("OkButton")
             If objTemp.Exists = True then
                objTemp.Click
    '            strTCRemarks=strTCRemarks & Chr(10) & "Attached Series- " & intSeriesID
             End If
          End If            
        End If

    
      ''Closing Source
      Call SClosesource()
      Call sEdgeProcessor
      Delay(10000)
      Dim objSaveWrk,objWait 
      set objSaveWrk=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 12).WPFObject("BarSubItemLinkControl", "", 1)
      strTemp="WPFObject(""ContentControlEx"", ""Workspace"", 2)"
      Set objTemp=objSaveWrk.FindChild("Name",strTemp,50)
      objWait=1
    Do until objTemp.Enabled = true 
        If objWait < 20 Then
          Delay 1000,"Pls Wait... Form is loading..."
          objWait=objWait+1
        else
          Call SClosesource()
          Call SourceWorkSpacevwr()
          Exit Sub
        end if 
    Loop 
    ''Uploading WorkSpace
   strTemp="WPFObject(""ContentControlEx"", ""Workspace"", 2)"
    Set objWrkSpace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,50,True)
     Delay(10000)
    If objWrkSpace.Exists = True then
      Delay(1000)
      objWrkSpace.Click
      Delay(1000)

      strTemp="WPFObject(""PopupMenuBarControl"", """", 1)"
      Set objwrkspacepop=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").Findchild("Name",strTemp,50,True)
      'Set objwrkspacepop=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1).WPFObject("BarPopupBorderControl", "", 1).WPFObject("PopupMenuBarControl", "", 1).WPFObject("BarItemLinkInfo", "", 2).WPFObject("BarButtonItemLinkControl", "", 1).WPFObject("ContentControlEx", "Upload Workspace", 2)
      If objwrkspacepop.Exists = True then
        strTemp="WPFObject(""ContentControlEx"", ""Upload Workspace"", 2)"
        set objwrkspcUpload=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).FindChild("Name",strTemp,50,True)
        If objwrkspcUpload.Exists = True then
          objwrkspcUpload.Click
          'Delay 1000,"Pls Wait.."
          strTemp="WPFObject(""PART_ContainerContent"")"
          Set objConfirm=Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "Confirm").FindChild("Name",strTemp,50,True)
'          strTemp="WPFObject(""DXMessageBox"", """", 1)"
'          Set objConfirm=objConfirm.WaitChild(strTemp,180000)
          If objConfirm.Exists = True then
            objConfirm.Keys "[Enter]"
            'Delay 8000,"Uploading..."
            Set objConfirm = Sys.Process("EdgeClient")._
            Waitchild("WPFObject(""HwndSource: CustomMessageBoxWindow"", ""Upload Workspace"")",600000)._
            Waitchild("WPFObject(""CustomMessageBoxWindow"", ""Upload Workspace"", 1)",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""FloatingContainerBorder"")",60000)._
            Waitchild("WPFObject(""FloatingContainerBackground"")",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""FloatingContainerBody"")",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""Grid"", """", 1)",60000)._
            Waitchild("WPFObject(""PART_ContainerContent"")",60000)
            
            If objConfirm.Exists = True then
              Sys.Keys("O")
              'Delay 30000,"Pls Wait.."
             ' Call sEdgeProcessor
    '          strTCRemarks=strTCRemarks & Chr(10) & "WorkSpace Uploaded"
                  ''Reopen Source and Checking whether the new source is created              
                  strObject = "WPFObject(""HwndSource: RibbonWindow"")"
                  Set objEdgeMDI = Sys.Process("EdgeClient").WaitChild(strObject, 700000)
                  If objEdgeMDI.Exists then
                    objEdgeMDI.WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("RibbonControl").WPFObject("RibbonSelectedPageControl", "", 1).WPFObject("RibbonPagesControl", "", 1).WPFObject("RibbonPageGroupsControl", "", 1).WPFObject("RibbonPageGroupControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarButtonItemLinkControl", "", 1).WPFObject("TextSplitterControl", "", 1).WPFObject("ContentControl", "Source", 1).Click
                    Delay 6000,"Opening Source.."
                  Else
                    log.Message "RibbonWindow not found"
                  End If
    
                strTemp="WPFObject(""SourceTreeListView"")"
                Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)
                strTemp="WPFObject(""SourceTreeControl"")"
                Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,50,True)

                ''Selecting Country Name
                intTotNodeCnt=GridControl.Nodes_2.Count
                For intI=0 to intTotNodeCnt-1         
                    If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource_Name) then
                      GridControl.Nodes_2.Item(intI).Expand(True)
                      log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description       
                      blnFlag=False  
                      Exit For
                    End If
                Next
                If blnFlag = True then
                  strTCRemarks="Country Name not found"
                  strTestCaseResult="FAIL"
                  Exit Sub
                End If
  
                    blnFlag = True 
                ''Selecting Level2Source_Name
                intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
                For intJ=0 to intTotNodeCnt-1
                  If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strLevel2src_Name) then
                    GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
                '    intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(0).get_RowHandle
                    intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
            '        Call GridSourceTree.ClickCell(intRow, "Edit")
                    Call GridControl.ClearSelectionCore
                    Call GridControl.FocusViewAndRow(GridControl,intRow)
                    GridControl.SetFocusOnCurrentItem
                    Call GridControl.SelectRowCore(intRow)
                    log.Message "Level2 Source Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
                    blnFlag = False 
                    Exit For
                  End If
                Next
                
                    blnFlag = True 
                ''Selecting Level2Source_Name
                intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
                For intJ=0 to intTotNodeCnt-1
                  If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strLevel2src_Name) then
                    GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
                '    intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(0).get_RowHandle
                    intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
            '        Call GridSourceTree.ClickCell(intRow, "Edit")
                    Call GridControl.ClearSelectionCore
                    Call GridControl.FocusViewAndRow(GridControl,intRow)
                    GridControl.SetFocusOnCurrentItem
                    Call GridControl.SelectRowCore(intRow)
                    log.Message "Level2 Source Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
                    blnFlag = False 
                    Exit For
                  End If
                Next
    
                If blnFlag = True then
                  strTCRemarks="Level2 Source Name not found"
                  strTestCaseResult="FAIL"
                  Exit Sub
                End If
                
              strTemp="WPFObject(""ArrowControl"", """", 1)"
              Set objNewWorkspace=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).FindChild("Name",strTemp,20,True)
              If objNewWorkspace.Exists = True then
                objNewWorkspace.Click
                strTemp="WPFObject(""BarPopupBorderControl"", """", 1)"
                Set objWrkspace_popup=Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").FindChild("Name",strTemp,5,True)
                If objWrkspace_popup.Exists = True then
                  strTemp="WPFObject(""ContentControlEx"", ""Open For Edit (Source)"", 2)"
                  Set objopenforEdit=objWrkspace_popup.FindChild("Name",strTemp,8,True)
                  If objopenforEdit.Exists then
                    objopenforEdit.Click    
                   ' Delay 12000,"Please Wait..."
                  End If
                End If
                
                strTemp1="WPFObject(""HwndSource: WorkspaceNamePrompt"", ""Please provide a new Workspace Name"")"
                Set objNewWrkSpaceName=Sys.Process("EdgeClient").WaitChild(strTemp1,50000)
                If objNewWrkSpaceName.Exists = True then
   
                  ''Waiting for Workspace Name prompt
                  strTemp="WPFObject(""FloatingContainerBorder"")"
                  Set objNewWrkSpace_Name=Sys.Process("EdgeClient").WPFObject("HwndSource: WorkspaceNamePrompt", "Please provide a new Workspace Name").WPFObject("WorkspaceNamePrompt", "Please provide a new Workspace Name", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,900000)
                  If objNewWrkSpace_Name.Exists = True then
                    strTemp="WPFObject(""ChangeNameTextEdit"")"
                    ''Entering Workspace Name
                    Set objNewWrkSpace_Txtbox=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
                      If objNewWrkSpace_Txtbox.Exists = True then
                        objNewWrkSpace_Txtbox.Click
                        objNewWrkSpace_Txtbox.Text=strWrkSpaceName
                        ''Clicking on Ok Button 
                        strTemp="WPFObject(""OkButton"")"
                        Set objNewWrkSpace_okbtn=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
                        If objNewWrkSpace_okbtn.Exists = True then
                          objNewWrkSpace_okbtn.Click
                           Call sEdgeProcessor
                         ' Delay 5000,"Please wait..."
                        End If
                      End If
                  End If
                End if
            End If


          ''WorkSpace Edit Window
          strTemp="WPFObject(""LayoutPanel"", """", 2)"
          Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").FindChild("Name",strTemp,13,True)
          If objTemp.Exists then
              Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WPFObject("SourceTreeListView")
              Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl")

           
              intTotNodeCnt=GridControl.Nodes_2.Count  
              For intI=0 to intTotNodeCnt-1         
                If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource_Name) then
                  GridControl.Nodes_2.Item(intI).Expand(True)
                  blnFlag=False  
                  Exit For
                End If
              Next

              intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
              For intJ=0 to intTotNodeCnt-1
                If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strLevel2src_Name) then
                  GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Expand(True)
                  blnFlag = False 
                  Exit For
                End If
              Next
          
              intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count
               For intK=0 to intTotNodeCnt-1
                  If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description)=Ucase( DescText) then
                      intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).get_RowHandle
    '                  Set objGridCell=GridControl.WPFObject("HierarchyPanel", "", 1).WPFObject("GridRow", "", intRow+1).WPFObject("ScrollablePart").WPFObject("CellItemsControl", "", 1).WPFObject("GridCellContentPresenter", "", 1).WPFObject("TextEdit", "", 1)
    '                  If objGridCell.Exists = True then
    '                    objGridCell.Click
    '                  End If 
                      GridControl.set_FocusedRowHandle(intRow)
                      log.Message "New Source Created"
                      strTCRemarks="Upload successful" & "<br />" & "Level3 Source Created - " & DescText & "<br />" & "Attach Series - " & intSeriesID
                      Exit For   
                  End If 
               Next
              End If
            End If
          End If
        End If
      End If
    End If
    End If

    ''Closing Opened Window
    
    Call sCloseFileInsetLink()
    Call SClosesource()
    ''Dropping Workspace in Source Workspace viewer 
    Call SourceWorkSpacevwr 
End Sub

Sub sCheckPendingSTP(strParameters)
'Sub sCheckPendingSTP()
On Error Resume Next

'Sub sCheckPendingSTP
    Dim strFileName
'     strFileName="YYY-Automation-Test Source 1"  
'     strEnvi = "Edge ( US Production )"  
     strFileName=getSplitValue(strParameters,"TestDataFile")
     
    objArray = Sys.FindAllChildren("ProcessName","EXCEL", 5,True)
    For i=0 to ubound(objArray)
      log.Message objArray(i).FullName
      set oSTP_ExcelObj = objArray(i).FindChild("WndCaption", "*RUN*",1,True)
      If oSTP_ExcelObj.Exists = True Then
      Else
        objArray(i).Close
      End If
    Next 
        
    Call SClosesource()
    Call sAutoHidePanelDock("Pending STP")
    
    strTemp="WPFObject(""LayoutGroup"", """", 1)"
    Set objLayout=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,true)
    
    strTemp="WPFObject(""GridControl"")"
    Set objGridControl = objLayout.FindChild("Name",strTemp,50,true)    
    strTemp="WPFObject(""SourceLogTableView"")"
    Set objTableView = objLayout.FindChild("Name",strTemp,50,true)
    
    blnFlag=False
    intRefresh=0
    IntCount=0
    'msgbox objGridControl.wGroupCount
    Do
    For i = 0 to objGridControl.wGroupCount-1
    If objGridControl.DataController.GroupInfo.Item(i).GroupValue.OleValue="Test" then
        Call objGridControl.ExpandGroup(i,true)
        Call objTableView.set_FocusedRowHandle(objGridControl.DataController.GroupInfo.Item(i).Handle)
        Call objTableView.SelectRow(objGridControl.DataController.GroupInfo.Item(i).Handle)
        Delay 5000,"Loading Grid Rows"      
        Exit For 
    End If
    Next
    
    For I = 1 to objGridControl.wGroupCount
      Set objTemp = Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("DockPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("GridControl").WPFObject("SourceLogTableView").WPFObject("HierarchyPanel", "", 1).WPFObject("GroupRowControl", "", I).WPFObject("GroupValuePresenter", "", 1).Text 
      if objTemp = "Test" Then 
        IntCount = I
      End If
    Next
    'msgbox IntCount
    
    'Click on Refresh Buttton
    strTemp ="WPFObject(""Button"", ""Refresh"", 1)"
    set objTemp = Sys.Process("EdgeClient").FindChild("Name",strTemp,50,true)
    objTemp.Click
    
'    IntCnt = 1 
'    
'    Do While(objTableView.FocusedRowHandle=<0)
'    Sys.Keys("[Down]")  
'    IntCnt = IntCnt+1  
'    Loop
'    
    
  
    Dim IntNumber     
    
    Set StrCount = objTableView.WPFObject("HierarchyPanel", "", 1).WPFObject("GroupRowControl", "", IntCount).WPFObject("GroupRowDefaultSummaryControl", "", 1).WPFObject("GroupRowDefaultSummaryItemControl", "", 1).Text
    IntNumber = Split(StrCount,"=")
   ' msgbox IntNumber(1)
    
    
   IntCnt = 0
   Do While(objTableView.FocusedRowHandle>0)      
      If objTableView.FocusedRow.StpFileName=strFileName then
        If DateDiff("s",objTableView.FocusedRow.ExportedTimeLocal,aqDateTime.Now)<900 then
         strTCRemarks="STP file name found in Pending STP panel"
         log.Message(strTCRemarks)
         blnFlag=True
         intRefresh=3
         Exit Do
        Else
         Sys.Keys("[Down]")        
        End  If
      Else
       Sys.Keys("[Down]")
        IntCnt = IntCnt+1     
      End If
      
      If IntCnt = Cint(IntNumber) Then
        Exit Do
      End If
    Loop
    
     
    
    
    If intRefresh<3 then
      strTemp="WPFObject(""Button"", ""Refresh"", 1)"
      Set objRefresh=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,true)
      Call objRefresh.ClickButton
      Call sEdgeProcessor()
      intRefresh=intRefresh+1
    End If
    
    Loop while(intRefresh<3)
    
    Call objGridControl.CollapseGroup(i)
    Call SAutoHidePanelHide("Pending STP")
    
    If blnFlag=False then
      strTCRemarks="STP file name not found"
      strTestCaseResult="FAIL"
    End If
    
End Sub


Sub sPendingMG()  


On Error Resume Next  
     
    Call sAutoHidePanelDock("Pending MG/Released")
    
    Delay 3000,"Grid loading..."
    
    strTemp="WPFObject(""LayoutGroup"", """", 1)"
    Set objLayout=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,true)
    
    strTemp="WPFObject(""GridControl"")"
    Set objGridControl = objLayout.FindChild("Name",strTemp,50,true)    
    strTemp="WPFObject(""TodoListCounterTableView"")"
    Set objTableView = objLayout.FindChild("Name",strTemp,50,true)
  
    For i = 0 to objGridControl.wGroupCount-1
    If objGridControl.DataController.GroupInfo.Item(i).GroupValue.OleValue="Test" then
        Call objGridControl.ExpandGroup(i,true)
        Call objTableView.set_FocusedRowHandle(objGridControl.DataController.GroupInfo.Item(i).Handle)
        Call objTableView.SelectRow(objGridControl.DataController.GroupInfo.Item(i).Handle)
        Delay 5000,"Loading Grid Rows"
        Exit For 
    End If
    Next
    
    Do While(objTableView.FocusedRowHandle<0)
    log.Message objTableView.FocusedRowHandle
    Sys.Keys("[Down]")
    Loop
    
    Do
    If objTableView.FocusedRow.NotReleased>0 then
     Call objGridControl.ClickRowIndicatorR(objTableView.FocusedRowHandle)
     strTemp="WPFObject(""MenuItem"", ""Force Release"", 4)"
     Set objFRelease=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,True)
     Call objFRelease.Click    
     
     Set objConfirm=Sys.Process("EdgeClient").WaitChild("WPFObject(""HwndSource: WindowContentHolder"", ""Confirm"")",20000)
     If objConfirm.Exists=True then
      Sys.Keys("[Enter]")
     End If
     
     Set objMessageBox=Sys.Process("EdgeClient").WaitChild("WPFObject(""HwndSource: CustomMessageBoxWindow"", ""Todo List"")",20000)
     If objMessageBox.Exists=True then
      Sys.Keys("O")
      Call sEdgeProcessor
      Delay 3000,"Grid Changing..."
      If objTableView.FocusedRow.NotReleased=0 then
        strTCRemarks="Force Release successful"
        log.Message strTCRemarks
      Else
       strTestCaseResult="FAIL"
       strTCRemarks="Failed Force Release"
      End If      
      End If
     Exit Do
    Else
     Sys.Keys("[Down]")
    End If
    Loop 

    Call objGridControl.CollapseGroup(i)
    Call SAutoHidePanelHide("Pending MG/Released")
        
End Sub

Sub sUpdatelog1(strParameters)

On Error Resume Next
'Sub sUpdatelog1
 'strFileName="YYY-Automation-Test Source 1"   
  strFileName=getSplitValue(strParameters,"TestDataFile")
  strSourceName=getSplitValue(strParameters,"SourceName")
 
  Call sAutoHidePanelDock("Update Log")
  
  strTemp="WPFObject(""LayoutGroup"", """", 1)"
  Set objLayout=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,true)
 
  strTemp="WPFObject(""Button"", ""Refresh"", 1)"
  Set objRefresh = objLayout.FindChild("Name",strTemp,50,true) 
  If objRefresh.Exists = TRUE then
    Call objRefresh.Click
  End if
  Call sEdgeProcessor  
  
  strTemp="WPFObject(""GridControl"")"
  Set objGridControl = objLayout.FindChild("Name",strTemp,50,true)    
  strTemp="WPFObject(""SourceLogTableView"")"
  Set objTableView = objLayout.FindChild("Name",strTemp,50,true)
 
  If objGridControl.Exists = TRUE then
    Call objGridControl.ClickColumnHeaderRXY("Top Source Description", 94, 8)
  End if
  
  strTemp="WPFObject(""ContentControlEx"", ""Show Search Panel"", 2)"
  Set objSearchMenu = Sys.Process("EdgeClient").FindChild("Name",strTemp,50,true) 
  If objSearchMenu.Exists = TRUE then
    Call objSearchMenu.Click
  End if
  
  'Clicking the search text box
  Call objTableView.Click(95, 21)
  Call objTableView.Keys(strSourceName)
  Delay 5000,"Loading Grid Rows"
  
  For i = 0 to objGridControl.wGroupCount-1
    If objGridControl.DataController.GroupInfo.Item(i).GroupValue.OleValue="Test" then
        Call objGridControl.ExpandGroup(i,true)
        Call objTableView.set_FocusedRowHandle(objGridControl.DataController.GroupInfo.Item(i).Handle)
        Call objTableView.SelectRow(objGridControl.DataController.GroupInfo.Item(i).Handle)
        Delay 5000,"Loading Grid Rows"
        Exit For 
    End If
  Next
    
  Do While(objTableView.FocusedRowHandle<0)
  Sys.Keys("[Down]")
  Loop
  
  Do
  intHandle=objTableView.FocusedRowHandle
  blnFlag=False
  If strFileName=objTableView.FocusedRow.StpFileName and _
     DateDiff("s",objTableView.FocusedRow.ImportedTimeLocal,aqDateTime.Now)<600 and _
     objTableView.FocusedRow.ReleasedTimepointCount=8 and _
     objTableView.FocusedRow.RecordCountNew=4 and _
     objTableView.FocusedRow.RecordCountRevised=2 and _
     objTableView.FocusedRow.RecordCountDeleted=2 and _
     objTableView.FocusedRow.QcResultPass=3 and _
     objTableView.FocusedRow.QcResultFailed=3 and _
     objTableView.FocusedRow.QcResultMarkGood=3 then
   blnFlag=True
  Else
   blnFlag=False
  End If
  
  If blnFlag=True then
   strTCRemarks="Verified timepoints count in Update Log"
   Exit Do
  Else
   Sys.Keys("[Down]")
   'Delay 1000,"Cursor Down"
   If objTableView.FocusedRowHandle>0 and intHandle=objTableView.FocusedRowHandle then
    strTestCaseResult="FAIL"
    strTCRemarks="Unable to find the record for STP file"
    Exit Do
   End If
   If objTableView.FocusedRowHandle<0 then
    strTestCaseResult="FAIL"
    strTCRemarks="Unable to find the record for STP file"
    Exit Do
   End If
  End If  
  Loop
  
'  Call objTableView.Click(226, 18) 'Click search close button
'  Delay 2000
  Call objGridControl.CollapseGroup(i)
  Delay 2000
  Call objTableView.Click(226, 18) 'Click search close button
  Delay 2000
  Call sAutoHidePanelHide("Update Log")

End Sub

Sub sSourceSch_AddTP(strParameters)
'Sub sSourceSch_AddTP()

On Error Resume Next

  strLevel1=getsplitvalue(strParameters,"Source")
  strLevel2=getsplitvalue(strParameters,"Qcname")
  strLevel3=getsplitvalue(strParameters,"Workspace")
  
'  strLevel1="Test"
'  strLevel2="Automation"
'  strLevel3="Test Source 1"
'  strSeriesID="421317647"

  'open source schedule
  strTemp="WPFObject(""ContentControlEx"", ""New Workspace"", 2)"
  Set objWorkSpace=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,true)
  Call objWorkSpace.Click
  
  strTemp="WPFObject(""ContentControlEx"", ""Open For Edit (Source Schedule)"", 2)"
  Set objEdit=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,true)
  Call objEdit.Click
  
  strTemp="WPFObject(""HwndSource: WorkspaceNamePrompt"", ""Please provide a new Workspace Name"")"
  Set objWSName=Sys.Process("EdgeClient").WaitChild(strTemp,120000)
  If objWSName.Exists = True then
    strTemp="WPFObject(""ChangeNameTextEdit"")"
    Set objWSText=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,true)
    objWSText.Text="abc"
    
    strTemp="WPFObject(""OkButton"")"
    Set objOkButton=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,true)
    Call objOkButton.Click
    Delay 5000,"Loading Schedule..."
  End If
  
  Call sCloseSource
  
  Delay 5000
  
  'Activity on Source Schedule
  strTemp="WPFObject(""ContentControlEx"", ""Expand All"", 2)"
  Set objExpandButton=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,true)
  If objExpandButton.Exists Then 
    Call objExpandButton.Click
  End If
  Delay 3000,"Tree expanding..."
  
  Set objTreeViewFolder=Sys.Process("EdgeClient").FindChild("DisplayText",strLevel3,50,True)
  Call objTreeViewFolder.Click 'Clicking on cell having Test Source 1
  Call sEdgeProcessor
  
  'Scrolling and clicking on series ID
  strTemp="WPFObject(""SourceSeriesGridControl"")"
  Set objGridControl=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,true)
  Call sFindSeriesID(strSeriesID)
'  Call Aliases.EdgeClient.HwndSource_Shell.Shell.Grid.ContentControl.Grid.PART_RibbonLayout.Part_WindowContent.Grid.ContentControl.PART_ContainerContent.BarManager.DockPanel.DockLayoutManager.LayoutGroup.LayoutPanel.LayoutPanelContentPresenter.Root.AdornerDecorator.AdornedControl.Grid.Grid.Grid.SourceSeriesGridControl.RowControl2.LightweightCellEditor.InplaceBaseEdit.Keys("^f")
'
'  strTemp="WPFObject(""TableView"", """", 1)"
'  Set objTableView=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,true)
'  Call objTableView.SetFocusedRowHandle(objGridControl.FindRow("Series ID",strSeriesID))
'  Delay 3000
  
  'Adding timepoint
  strTemp="WPFObject(""DateEdit"", """", 1)"
  Set objTimepoint=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,true)
  Call objTimepoint.Click
  Delay 3000
  Sys.Keys DatePart("m",Now())
  Delay 3000
  Call objTimepoint.Click
  Delay 3000
  
  'Drag for UIT machine
  strTemp="WPFObject(""GridSplitter"", """", 1)"
  Set objSplitter=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,true)
  Call objSplitter.Drag(2, 218, -360, 3)
  Delay 3000
  
  'upload workspace
  strTemp="WPFObject(""ContentControlEx"", ""Workspace"", 2)"
  Set objWorkspace=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,true)
  Call objWorkspace.Click
  
  strTemp="WPFObject(""ContentControlEx"", ""Upload Workspace"", 2)"
  Set objUpload=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,true)
  Call objUpload.Click
  
  Set objConfirm=Sys.Process("EdgeClient").WPFObject("HwndSource: WindowContentHolder", "Confirm")
  If objConfirm.Exists=True then
    Sys.Keys "[Enter]"
  End If
  
  strTemp="WPFObject(""HwndSource: CustomMessageBoxWindow"", ""Upload Workspace"")"
  Set objUploadWindow=Sys.Process("EdgeClient").WaitChild(strTemp,120000)
  If objUploadWindow.Exists=True then
    Sys.Keys "O"
    strTCRemarks="Using Source Schedule,Timepoint has been added to the series"
    strTestCaseResult="PASS"
  End If
  
  Call sEdgeProcessor
  
  If strTCRemarks="" then
   strTestCaseResult="ABORT"
  End If
  
 ' msgbox RouTime
End Sub


Sub sSourceSch_DailyCheck(strParameters)
'Sub sSourceSch_DailyCheck()
 On Error Resume Next
 
  Dim strStatus
  Delay 5000 , "Please wait... "
 
  strLevel1=getsplitvalue(strParameters,"Source")
  strLevel2=getsplitvalue(strParameters,"Qcname")
  strLevel3=getsplitvalue(strParameters,"Workspace") 
  strStatus=getsplitvalue(strParameters,"SceduleStauts")
 ' msgbox strSeriesID
''
'  strLevel1="Test"
'  strLevel2="Automation"
'  strLevel3="Test Source 1"
'  strSeriesID="417652617"
'  strStatus = "Released"
'  strEnvi = "Edge ( US Integration )"  
   
  'opening panel
  Call sAutoHidePanelDock("Daily Check Panel")
  
  'setting country
  strTemp="WPFObject(""WrapPanel"", """", 1)"
  Set objPanel=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,True)
  strTemp="WPFObject(""ComboBox"", """", 1)"
  Set objCountry=objPanel.FindChild("Name",strTemp,50,True)
  Call objCountry.Set_Text(strLevel1)
  Delay 2000
  
  'Click Refresh
  strTemp="WPFObject(""ContentControlEx"", ""Refresh"", 2)"
  Set objRefresh=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,True)
  Call objRefresh.Click
  Call sEdgeProcessor
  
  'Expand Level2 folder in grid
  strTemp="WPFObject(""CheckListGridControl"")"
  Set objGridControl=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,True)
  For i = 0 to objGridControl.wGroupCount-1
    If cstr(objGridControl.DataController.GroupInfo.Item(i).GroupValue.OleValue)=cstr(strLevel2) then
      intRow=objGridControl.DataController.GroupInfo.Item(i).Handle
      Call objGridControl.ExpandGroupRow_2(intRow,True)
      Delay 5000,"Grid expanding..."
      Exit For
    End If
  Next
  
  'Finding series
'  intRow=objGridControl.FindRow("Series Id",strSeriesID)
'  log.Message "intRow="&intRow
  strTemp="WPFObject(""CheckListTableView"")"
  Set objTableView=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,True)
  Call objTableView.SetFocusedRowHandle(intRow)
  Call objTableView.SelectRow(intRow)
  Delay 1000
  
  Do While(objTableView.FocusedRowHandle<0)
    log.Message objTableView.FocusedRowHandle
    Sys.Keys("[Down]")
    Delay 1000
  Loop
  
  Do While(objTableView.FocusedRowHandle>0) And  Ucase(Trim(strStatus)) <>  Ucase(Trim("Released")) 
    If cstr(objTableView.FocusedRow.SeriesId)=cstr(strSeriesID) And ucase(objTableView.FocusedRow.ScheduleStatusDescription)=ucase("Delayed") Then      
      If Err.Number=0 then
        strTCRemarks="Series with Delayed schedule found in Daily Check Panel"
        Delay 3000,"Found Series..."        
        Exit Do
      End If
    Else
      Sys.Keys("[Down]")
      Delay 200
   
    End If      
    
  Loop
    
  'The release schedule should not be shown in daily check panel
  If Ucase(Trim(strStatus)) =  Ucase(Trim("Released")) Then    
       Do While(objTableView.FocusedRowHandle>0)
      If cstr(objTableView.FocusedRow.SeriesId)=cstr(strSeriesID) and ucase(objTableView.FocusedRow.ScheduleStatusDescription)=ucase("Delayed") then
        If Err.Number=0 then
          Delay 3000,"Found Series..."
          strTCRemarks  = "  Release SeriesID = " & strSeriesID &" still present in Daily Check Panel "    
          strTestCaseResult = "FAIL"    
          Exit Do
        End If        
      Else
        strTCRemarks  = " Release SeriesID = " & strSeriesID &" is not present in Daily Check Panel "    
        strTestCaseResult = "PASS" 
      End If      
      Sys.Keys("[Down]")
      Delay 200
    Loop  
  End If
      
  'Collapse Group
  Call objGridControl.CollapseGroup(i)
  
  'Close Panel
  Call sAutoHidePanelHide("Daily Check Panel")
  
  If strTCRemarks="" then
    strTestCaseResult="ABORT"
  End If
  
End Sub

Sub sToDo_PendingSTP(strParameters)


On Error Resume Next

  Delay 10000,"Pls Wait.."
  'open STP file for making entry in Pending STP panel
  
  
'  strTemp="WPFObject(""ContentControlEx"", ""Open Global STP"", 2)"
'  Set objSTP=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,True)
'  Set objSTP=Sys.Process("EdgeClient").Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 6).WPFObject("BarButtonItemLinkControl", "", 1)
'  'Set objSTP=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 6).WPFObject("BarButtonItemLinkControl", "", 1).WPFObject("ContentControlEx", "Open Global STP", 2)
'  Call objSTP.Click
  

  'Open STP  for selected Source
  Call sOpenSourceDispalyViewer()
  Delay 5000
  Call sGridSelection(strParameters)
  'click on Open STP Button
  Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 6).WPFObject("BarButtonItemLinkControl", "", 1).WPFObject("ContentControlEx", "Open Global STP", 2).Click
  Delay(5000)
  Call sExcelFullHistory
  Delay(5000)
  objArray = Sys.FindAllChildren("ProcessName","EXCEL", 5,True)
  For i=0 to ubound(objArray)
    log.Message objArray(i).FullName
    set oSTP_ExcelObj = objArray(i).FindChild("WndCaption", "*RUN*",1,True)
    If oSTP_ExcelObj.Exists = True Then
    Else
      objArray(i).Close
    End If
  Next
  Delay(5000)
      
  Call sClosesource()

End Sub

Sub sToDo_CheckAll(strParameters)
'Sub sToDo_CheckAll()


On Error Resume Next

  strLevel1=getSplitValue(strParameters,"Source")
  strLevel2=getSplitValue(strParameters,"Qcname")
  strLevel3=getSplitValue(strParameters,"Workspace")
  
'  strLevel1="Test"
'  strLevel2="PRT111"
'  strLevel3="PRT222"
'  strEnvi = "Edge ( US Integration )" 


  blnFlag1=False
  blnFlag2=False
  blnFlag3=False
  
  'ToDo:Pending STP
  Call sAutoHidePanelDock("Pending STP")
  Call Sys.Process("EdgeClient").Refresh
  strTemp="WPFObject(""LayoutGroup"", """", 1)"
  Set objLayout=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,true)
  
  strTemp="WPFObject(""Button"", ""Refresh"", 1)"
  Set objRefresh = objLayout.FindChild("Name",strTemp,50,true) 
  If objRefresh.Exists = TRUE then
    Call objRefresh.Click
  End if
  Call sEdgeProcessor
  
  strTemp="WPFObject(""GridControl"")"		
  Set objGridControl = Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).FindChild("Name",strTemp,50,true)
  strTemp="WPFObject(""SourceLogTableView"")"   
  Set objTableView=Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).FindChild("Name",strTemp,50,true)
  
  
  If objGridControl.Exists = TRUE then
    Call objGridControl.ClickColumnHeaderRXY("Top Source Description", 94, 8)
  End if
  
  SYS.Keys "^F"
  Delay 1000,""
  
  strTemp="WPFObject(""ContentControlEx"", ""Show Search Panel"", 2)"
  Set objSearchMenu = Sys.Process("EdgeClient").FindChild("Name",strTemp,50,true) 
  If objSearchMenu.Exists = TRUE then
    Call objSearchMenu.Click
  End if
  
  'Clicking the search text box
  Call objTableView.Click(95, 21)
  Call objTableView.Keys(strLevel2)
  Delay 5000,"Loading Grid Rows"
  
 
  'Set objGridControl = Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("DockPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("GridControl")
  'Set objGridControl = Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("TabbedGroup", "", 2).WPFObject("FastRenderPanelContentControl", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("DockPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("GridControl")
  strTemp="WPFObject(""GridControl"")"  	
  Set objGridControl = Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).FindChild("Name",strTemp,50,true)
 	Call objGridControl.ExpandGroup(0,true)
		Delay 5000,"Loading Grid Rows"
  
'  intRow1=objGridControl.FindRow("Top Source Description",strLevel2)
'  If intRow1>=0 And intRowCount1 > 0 then
'    blnFlag1=True
'  End If

	intRow1 = objGridControl.wRowCount
  If intRow1 > 0 then 
    blnFlag1=True
  End If
  
  Delay 2000
  Call objTableView.Click(226, 18) 'Click search close button
  Delay 2000
  
  Set objLayout=nothing
  Set objGridControl=nothing
 
  Call sAutoHidePanelHide("Pending STP")
  
  'ToDo:Pending MG/Released
  Call sAutoHidePanelDock("Pending MG/Released")
  Call Sys.Process("EdgeClient").Refresh
  strTemp="WPFObject(""LayoutGroup"", """", 1)"
  Set objLayout=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,true)
  
  strTemp="WPFObject(""Button"", ""Refresh"", 1)"
  Set objRefresh = objLayout.FindChild("Name",strTemp,50,true) 
  If objRefresh.Exists = TRUE then
    Call objRefresh.Click
  End if
  Call sEdgeProcessor
 
  strTemp="WPFObject(""GridControl"")"  	
  Set objGridControl = Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).FindChild("Name",strTemp,50,true)
  strTemp="WPFObject(""TodoListCounterTableView"")"	
  Set objTableView = Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).FindChild("Name",strTemp,50,true)
  
  
  
  If objGridControl.Exists = TRUE then
    Call objGridControl.ClickColumnHeaderRXY("Top Source Description", 94, 8)
  End if
  
  SYS.Keys "^F"
  Delay 1000,""
  
  strTemp="WPFObject(""ContentControlEx"", ""Show Search Panel"", 2)"
  Set objSearchMenu = Sys.Process("EdgeClient").FindChild("Name",strTemp,50,true) 
  If objSearchMenu.Exists = TRUE then
    Call objSearchMenu.Click
  End if
  
  'Clicking the search text box
  Call objTableView.Click(95, 21)
  Call objTableView.Keys(strLevel2)
  Delay 5000,"Loading Grid Rows"
  
 
  'Set objGridControl = Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1)
   'Set objGridControl = Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", "Edge ( US Integration )").WPFObject("Shell", "Edge ( US Integration )", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("TabbedGroup", "", 2).WPFObject("FastRenderPanelContentControl", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("DockPanel", "", 1).WPFObject("GridControl") 
  strTemp="WPFObject(""GridControl"")"  	
  Set objGridControl = Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).FindChild("Name",strTemp,50,true)
  Call objGridControl.ExpandGroup(0,true)
  Delay 5000,"Loading Grid Rows"
  
  'intRow2 = objGridControl.FindRow("Top Source Description",strLevel2)	
'		If intRow1>=0 And intRowCount2 > 0 then 
'    blnFlag2=True
'  End If

		intRow2 = objGridControl.wRowCount
  If intRow2 > 0 then 
    blnFlag2=True
  End If
  
  Delay 2000
  Call objTableView.Click(226, 18) 'Click search close button
  Delay 2000
  
  Set objLayout=nothing
  Set objGridControl=nothing
  
    
  Call sAutoHidePanelHide("Pending MG/Released")
  
  'ToDo:Update Log
  Call sAutoHidePanelDock("Update Log")
  Call Sys.Process("EdgeClient").Refresh


  strTemp="WPFObject(""LayoutGroup"", """", 1)"
  Set objLayout=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,true)
  
  strTemp="WPFObject(""Button"", ""Refresh"", 1)"
  Set objRefresh = objLayout.FindChild("Name",strTemp,50,true) 
  If objRefresh.Exists = TRUE then
    Call objRefresh.Click
  End if
  Call sEdgeProcessor
  

 	strTemp="WPFObject(""GridControl"")"		
  Set objGridControl = Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).FindChild("Name",strTemp,50,true)
  strTemp="WPFObject(""SourceLogTableView"")"  
	 Set objTableView=Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).FindChild("Name",strTemp,50,true)
    
  If objGridControl.Exists = TRUE then
    Call objGridControl.ClickColumnHeaderRXY("Top Source Description", 94, 8)
  End if
  
  SYS.Keys "^F"
  Delay 1000,""
  
  strTemp="WPFObject(""ContentControlEx"", ""Show Search Panel"", 2)"
  Set objSearchMenu = Sys.Process("EdgeClient").FindChild("Name",strTemp,50,true) 
  If objSearchMenu.Exists = TRUE then
    Call objSearchMenu.Click
  End if
  
  'Clicking the search text box
  Call objTableView.Click(95, 21)
  Call objTableView.Keys(strLevel2)
  Delay 5000,"Loading Grid Rows"
  
		strTemp="WPFObject(""GridControl"")"		
  Set objGridControl = Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).FindChild("Name",strTemp,50,true)
    For i = 0 to objGridControl.wGroupCount-1
    If Trim(cstr(ucase(objGridControl.DataController.GroupInfo.Item(i).GroupValue.OleValue)))=Trim(cstr(ucase(strLevel1))) then
        Call objGridControl.ExpandGroup(i,true)
'        intRow3=objGridControl.FindRow("Top Source Description",strLevel2)
'        If intRow3>=0 then
'          blnFlag3=True
'        End If
							 intRow3 = objGridControl.wRowCount
						  If intRow3 > 0 then 
						    blnFlag3=True
						  End If
        If blnFlag1=True and blnFlag2=True and blnFlag3=True then
          strTCRemarks="Found a record present in all three ToDo panels"
          'Call objGridControl.ClickRowIndicatorR(intRow3)
										'strTemp="WPFObject(""MenuItem"", ""Open Source"", 3)"
'          Set objSource=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,True)
'          Call objSource.Click
											Call objGridControl.ClickCell(1, "Top Source Description")
											Call objGridControl.ClickCellR(1, "Top Source Description")
											Call objGridControl.PopupMenu.Click("Open Source")
					 End If     
        Delay 5000,"Loading Grid Rows"
        Exit For 
    End If
  Next
  
  Delay 2000
  Call objTableView.Click(226, 18) 'Click search close button
  Delay 2000
  
  Set objLayout=nothing
  Set objGridControl=nothing
    
  Call sAutoHidePanelHide("Update Log")

End Sub

Sub sToDo_CheckAll1(strParameters)
'Sub sToDo_CheckAll1()

On Error Resume Next

  strLevel1=getSplitValue(strParameters,"Source")
  strLevel2=getSplitValue(strParameters,"Qcname")
  strLevel3=getSplitValue(strParameters,"Workspace")
  
'  strLevel1="Test"
'  strLevel2="PRT333"
'  strLevel3="PRT444"
'   strEnvi = "Edge ( US Integration )" 	

  blnFlag1=False
  blnFlag2=False
  blnFlag3=False
  
  Call Sys.Process("EdgeClient").Refresh
 

  'ToDo:Pending STP
  Call sAutoHidePanelDock("Pending STP")
  Call Sys.Process("EdgeClient").Refresh
  strTemp="WPFObject(""LayoutGroup"", """", 1)"
  Set objLayout=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,true)
  
  strTemp="WPFObject(""Button"", ""Refresh"", 1)"
  Set objRefresh = objLayout.FindChild("Name",strTemp,50,true) 
  If objRefresh.Exists = TRUE then
    Call objRefresh.Click
  End if
  Call sEdgeProcessor
  
  strTemp="WPFObject(""GridControl"")"		
  Set objGridControl = Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).FindChild("Name",strTemp,50,true)
  strTemp="WPFObject(""SourceLogTableView"")"   
  Set objTableView=Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).FindChild("Name",strTemp,50,true)
  
  
  
  If objGridControl.Exists = TRUE then
    Call objGridControl.ClickColumnHeaderRXY("Top Source Description", 94, 8)
  End if
  
   SYS.Keys "^F"
  Delay 1000,""
  
  strTemp="WPFObject(""ContentControlEx"", ""Show Search Panel"", 2)"
  Set objSearchMenu = Sys.Process("EdgeClient").FindChild("Name",strTemp,50,true) 
  If objSearchMenu.Exists = TRUE then
    Call objSearchMenu.Click
  End if
  
  'Clicking the search text box
  Call objTableView.Click(95, 21)
  Call objTableView.Keys(strLevel2)
  Delay 5000,"Loading Grid Rows"
  
 
'  Set objGridControl = Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("DockPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("GridControl")
'  Set objGridControl = Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("TabbedGroup", "", 2).WPFObject("FastRenderPanelContentControl", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("DockPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("GridControl")
'  Call objGridControl.ExpandGroup(0,true)
'  Delay 5000,"Loading Grid Rows"
'  
 	strTemp="WPFObject(""GridControl"")"  	
  Set objGridControl = Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).FindChild("Name",strTemp,50,true)
 	Call objGridControl.ExpandGroup(0,true)
  Delay 5000,"Loading Grid Rows"
  
		
  time1=aqdatetime.Now
  Call Sys.Process("EdgeClient").Refresh
  Do
'  intRow1=objGridControl.FindRow("Source Folder Description",strLevel3)
'  If intRow1>=0 then
'    blnFlag1=True
'  End If
		intRow1 = objGridControl.wRowCount
  If intRow1 > 0 then 
    blnFlag1=True
  End If
		
  If DateDiff("s",time1,aqdatetime.Now)>120 then
    Exit Do
  End If
  Loop until (intRow1>=0)
  
  Delay 2000
  Call objTableView.Click(226, 18) 'Click search close button
  Delay 2000
  
  Set objLayout=nothing
  Set objGridControl=nothing
 
  Call sAutoHidePanelHide("Pending STP")
  
  Call Sys.Process("EdgeClient").Refresh
  
  ' TODO: Pending MG/Released
  Call sAutoHidePanelDock("Pending MG/Released")
  Call Sys.Process("EdgeClient").Refresh
  strTemp="WPFObject(""LayoutGroup"", """", 1)"
  Set objLayout=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,true)
  
  strTemp="WPFObject(""Button"", ""Refresh"", 1)"
  Set objRefresh = objLayout.FindChild("Name",strTemp,50,true) 
  If objRefresh.Exists = TRUE then
    Call objRefresh.Click
  End if
  Call sEdgeProcessor
 
'  strTemp="WPFObject(""GridControl"")"
'  Set objGridControl = objLayout.FindChild("Name",strTemp,50,true)    
'  strTemp="WPFObject(""TodoListCounterTableView"")"
'  Set objTableView = objLayout.FindChild("Name",strTemp,50,true)

		strTemp="WPFObject(""GridControl"")"  	
  Set objGridControl = Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).FindChild("Name",strTemp,50,true)
  strTemp="WPFObject(""TodoListCounterTableView"")"	
  Set objTableView = Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).FindChild("Name",strTemp,50,true)
  
  If objGridControl.Exists = TRUE then
    Call objGridControl.ClickColumnHeaderRXY("Top Source Description", 94, 8)
  End if
  
   SYS.Keys "^F"
  Delay 1000,""
  
  strTemp="WPFObject(""ContentControlEx"", ""Show Search Panel"", 2)"
  Set objSearchMenu = Sys.Process("EdgeClient").FindChild("Name",strTemp,50,true) 
  If objSearchMenu.Exists = TRUE then
    Call objSearchMenu.Click
  End if
  
  'Clicking the search text box
  Call objTableView.Click(95, 21)
  Call objTableView.Keys(strLevel2)
  Delay 5000,"Loading Grid Rows"
  
 
  'Set objGridControl = Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("DockPanel", "", 1).WPFObject("GridControl")
  strTemp="WPFObject(""GridControl"")"  	
  Set objGridControl = Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).FindChild("Name",strTemp,50,true)
  Call objGridControl.ExpandGroup(0,true)
  Delay 5000,"Loading Grid Rows"
  
  time1=aqdatetime.Now
  Call Sys.Process("EdgeClient").Refresh
  Do
'  intRow2=objGridControl.FindRow("Source Folder Description",strLevel3)
'  If intRow2>=0 then
'    blnFlag2=True
'  End If

		intRow2 = objGridControl.wRowCount
  If intRow2 > 0 then 
    blnFlag2=True
  End If
		
  If DateDiff("s",time1,aqdatetime.Now)>120 then
    Exit Do
  End If
  Loop until (intRow2>=0)
  
  Delay 2000
  Call objTableView.Click(226, 18) 'Click search close button
  Delay 2000
  
  Set objLayout=nothing
  Set objGridControl=nothing
  
    
  Call sAutoHidePanelHide("Pending MG/Released")
  
  'ToDo:Update Log
  Call sAutoHidePanelDock("Update Log")
  Call Sys.Process("EdgeClient").Refresh


  strTemp="WPFObject(""LayoutGroup"", """", 1)"
  Set objLayout=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,true)
  
  strTemp="WPFObject(""Button"", ""Refresh"", 1)"
  Set objRefresh = objLayout.FindChild("Name",strTemp,50,true) 
  If objRefresh.Exists = TRUE then
    Call objRefresh.Click
  End if
  Call sEdgeProcessor
  
'  strTemp="WPFObject(""GridControl"")"
'  Set objGridControl = objLayout.FindChild("Name",strTemp,50,true)
'  Set objGridControl = Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("DockPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("GridControl")   
'  strTemp="WPFObject(""SourceLogTableView"")"
'  Set objTableView = objLayout.FindChild("Name",strTemp,50,true)

  strTemp="WPFObject(""GridControl"")"		
  Set objGridControl = Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).FindChild("Name",strTemp,50,true)
  strTemp="WPFObject(""SourceLogTableView"")"  
	 Set objTableView=Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).FindChild("Name",strTemp,50,true)
    
  
  If objGridControl.Exists = TRUE then
    Call objGridControl.ClickColumnHeaderRXY("Top Source Description", 94, 8)
  End if
  
   SYS.Keys "^F"
  Delay 1000,""
  
  strTemp="WPFObject(""ContentControlEx"", ""Show Search Panel"", 2)"
  Set objSearchMenu = Sys.Process("EdgeClient").FindChild("Name",strTemp,50,true) 
  If objSearchMenu.Exists = TRUE then
    Call objSearchMenu.Click
  End if
  
  'Clicking the search text box
  Call objTableView.Click(95, 21)
  Call objTableView.Keys(strLevel2)
  Delay 5000,"Loading Grid Rows"
  

' ' Set objGridControl = Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("DockPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("GridControl")
'  Set objGridControl = Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("TabbedGroup", "", 2).WPFObject("FastRenderPanelContentControl", "", 2).WPFObject("LayoutPanel", "", 1).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("WaitControl").WPFObject("DockPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("GridControl")
'  Call objGridControl.ExpandGroup(0,true)

		strTemp="WPFObject(""GridControl"")"		
  Set objGridControl = Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).FindChild("Name",strTemp,50,true)
  Call objGridControl.ExpandGroup(0,true)
  Delay 5000,"Loading Grid Rows"  
 
  time1=aqdatetime.Now
  Call Sys.Process("EdgeClient").Refresh
  Do
'  intRow3=objGridControl.FindRow("Source Folder Description",strLevel3)
'  If intRow3>=0 then
'    blnFlag3=True
'  End If
					intRow3 = objGridControl.wRowCount
						  If intRow3 > 0 then 
						    blnFlag3=True
						  End If
  If DateDiff("s",time1,aqdatetime.Now)>120 then
    Exit Do
  End If
  Loop until (intRow3>=0)
  
  log.Message intRow1&intRow2&intRow3
  log.Message blnFlag1&blnFlag2&blnFlag3
  If blnFlag1=True and blnFlag2=True and blnFlag3=True then   
   strTCRemarks="Top Source Description and Source Folder Description are modified in all three ToDo panels"
  Else
   strTestCaseResult="FAIL"
  End If       
  
  Delay 2000
  Call objTableView.Click(226, 18) 'Click search close button
  Delay 2000
  
  Set objLayout=nothing
  Set objGridControl=nothing
    
  Call sAutoHidePanelHide("Update Log")

End Sub

Sub sToDo_RenameSource(strParameters)
'Sub sToDo_RenameSource()

On Error Resume Next
 
  strLevel1=getSplitValue(strParameters,"Source")
  strLevel2_old=getSplitValue(strParameters,"Level2Source")
  strLevel3_old=getSplitValue(strParameters,"WORKSPACE")
  strLevel2_new=getSplitValue(strParameters,"NewQcname")
  strLevel3_new=getSplitValue(strParameters,"NewWorkspace")

'	        strLevel1="Test"
'				  strLevel2_old="PRT111"
'				  strLevel3_old="PRT222"
'				  strLevel2_new="PRT333"
'				  strLevel3_new="PRT444"	
'					strEnvi = "Edge ( US Integration )" 	

  
  'Call SelectLevel2Source(strLevel1,strLevel2_old)
  Call sGridSelection(strParameters)
  
  strTemp="WPFObject(""ContentControlEx"", ""New Workspace"", 2)"
  Set objWorkspace=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,True)
  Call objWorkspace.Click
  Delay 2000
  
  strTemp="WPFObject(""ContentControlEx"", ""Open For Edit (Source)"", 2)"
  Set objEdit=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,True)
  Call objEdit.Click
  Delay 2000
  
  strTemp="WPFObject(""HwndSource: WorkspaceNamePrompt"", ""Please provide a new Workspace Name"")"
  Set objWSname=Sys.Process("EdgeClient").WaitChild(strTemp,120000)
  strTemp="WPFObject(""ChangeNameTextEdit"")"
  Set objTextbox=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,True)
  objTextbox.Text="abc"
  strTemp="WPFObject(""OkButton"")"
  Set objOkButton=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,True)
  Call objOkButton.Click
  Call sEdgeProcessor
  Call sCloseSource
  
  strTemp="WPFObject(""SourceTreeListView"")"
  Set objListView=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,True)
  Set objListView= Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WPFObject("SourceTreeListView")
  

  strTemp="WPFObject(""ContentControlEx"", ""Expand All"", 2)"
  Set objTemp =Sys.Process("EdgeClient").FindChild("Name",strTemp,50,True)
  If objTemp.Exists then 
      objTemp.Click
      Delay 2000      
  End If
  
  Call objListView.Nodes_2.Item(0).Nodes.Item(0).Content.set_Description(strLevel2_new)
  Delay 200
  Call objListView.Nodes_2.Item(0).Nodes.Item(0).Nodes.Item(0).Content.set_Description(strLevel3_new)
  Delay 200
  
'  Call objListView.Nodes_2.Item(0).ExpandAll
'  Delay 2000
'  Call objListView.Nodes_2.Item(0).Nodes.Item(0).ExpandAll
'  Delay 2000
'  Call objListView.Nodes_2.Item(0).Nodes.Item(0).Content.set_Description(strLevel2_new)
'  Delay 2000
'  Call objListView.Nodes_2.Item(0).Nodes.Item(0).Nodes.Item(0).Content.set_Description(strLevel3_new)
'  Delay 2000
  
  strTemp="WPFObject(""ContentControlEx"", ""Workspace"", 2)"
  Set objWorkspace=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,True)
  Call objWorkspace.Click
  strTemp="WPFObject(""ContentControlEx"", ""Upload Workspace"", 2)"
  Set objUpload=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,True)
  Call objUpload.click
  
  Set objConfirm=Sys.Process("EdgeClient").WPFObject("HwndSource: WindowContentHolder", "Confirm")
  If objConfirm.Exists=True then
    Sys.Keys "[Enter]"
  End If
  
  strTemp="WPFObject(""HwndSource: CustomMessageBoxWindow"", ""Upload Workspace"")"
  Set objUConfirm=Sys.Process("EdgeClient").WaitChild(strTemp,120000)
  If objUConfirm.Exists=True then
    Sys.Keys "[Enter]"
    strTCRemarks="Renamed Level2 and Level3 folders"
  End If
  Call sEdgeProcessor
  
End Sub

Sub sAutoHidePanelDock(strPanelName)
  'strEnvi = "Edge ( US Integration )" 
  Set objEdge = Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager")
 ' Set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager")       
    objText = objEdge.FindAllChildren("ClrClassName","AutoHideGroup", 10,True)
        For i=0 to ubound(objText)
          log.Message objText(i).FullName
          log.Message objText(i).Name
          objCaption = objText(i).FindAllChildren("ClrClassName", "AutoHidePaneHeaderItem",10,True)
          For j=0 to ubound(objCaption)
            log.Message objCaption(j).FullName
            log.Message objCaption(j).Name
            If objCaption(j).Content.Caption = strPanelName then 
                  log.Message objCaption(j).FullName
                  objCaption(j).ClickR
                   Delay 2000,"Pls Wait.."
                  sys.Keys "[Down][Enter]"
                  Delay 5000,"Pls Wait.."
                  Call objEdge.Click(8,395)
                   Delay 5000,"Pls Wait.."
                  Exit For 
              End if 
          Next
        Next 
End Sub

Sub sAutoHidePanelHide(strPanelName)
  Set objEdge = Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager")
  'Set objEdge=Sys.Process("EdgeClient").WPFObject("HwndSource: RibbonWindow").WPFObject("RibbonWindow").WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 2).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager")       
   objText = objEdge.FindAllChildren("ClrClassName","LayoutGroup", 10,True)
        For i=0 to ubound(objText)
          log.Message objText(i).FullName
          log.Message objText(i).Name
          objCaption = objText(i).FindAllChildren("ClrClassName", "LayoutPanel",10,True)
          For j=0 to ubound(objCaption)
            log.Message objCaption(j).FullName
            log.Message objCaption(j).Name
            if objCaption(j).Content.Caption = strPanelName then 
                  log.Message objCaption(j).FullName
                   Call objCaption(j).ClickR(objCaption(j).top/2,objCaption(j).left/30,0)
                   Call objCaption(j).ClickR(275, 8)
                   Delay 5000,"Pls Wait.."
                  sys.Keys "[Down][Down][Enter]"
                  Delay 5000,"Pls Wait.."
                  Exit For 
              End if 
          Next
        Next  
End Sub


Sub EdgeCleanUp
On Error Resume Next
'Err.Raise 6
If RouTime<>0 then
If DateDiff("s",RouTime,aqDateTime.Now)>600 Then 
    
    Set PicObj = Utils.Picture
     Set PicObj = Sys.Desktop.Picture
     PicObj.SavetoFile(strLogFolder & "Screenshots\" & strTestCase_No &  "_" & picCount & ".jpg")
     picCount = picCount + 1 
    
    strTestCaseResult = "ABORT"
    strTCRemarks=Err.Description
   
    Call Sys.Process("EdgeClient").Close
    Call Sys.Process("EdgeClient").Terminate
    Call sLaunchEDGE()

    'Drop Workspace
     Call SourceWorkSpacevwr
     Call DropSourceSchWS
     Call sCheckLayoutWorkSpaceVwrDropWorkspace
     Call CloseWindow
     Call CloseWindow
     Call closeWindow

    'Close excel books
      objArray = Sys.FindAllChildren("ProcessName","EXCEL", 5,True)
      For i=0 to ubound(objArray)
        log.Message objArray(i).FullName
        set oSTP_ExcelObj = objArray(i).FindChild("WndCaption", "*RUN*",1,True)
        If oSTP_ExcelObj.Exists = True Then
        Else
          Set netUIHWND = Aliases.EXCEL.wndXLMAIN.EXCEL2.toolbarRibbon.Ribbon.NUIPane.NetUIHWND
          Call netUIHWND.Click(604, 40)
          objArray(i).Close
          Sys.Keys "[Enter]"
          Sys.Keys "[Enter]"
          Sys.Keys "S"
          Sys.Keys "S"
        End If
      Next
      Delay(5000)
      Sys.Process("ISI.CeicDataManager.Startup").Close
      Sys.Process("ISI.CeicDataManager.Startup").Terminate
      Delay(5000)
 Err.Clear
 RouTime=0
End  If  
End If
End Sub

Sub EdgeCleanUp1
On Error Resume Next

    Set PicObj = Utils.Picture
     Set PicObj = Sys.Desktop.Picture
     PicObj.SavetoFile(strLogFolder & "Screenshots\" & strTestCase_No &  "_" & picCount & ".jpg")
     picCount = picCount + 1 
    
    
    'strTestCaseResult = "ABORT"
    strTCRemarks=Err.Description
    'Close Panels
    Call sAutoHidePanelHide("Pending STP")
    Call sAutoHidePanelHide("Update Log")
    Call sAutoHidePanelHide("Pending MG/Released")
    Call sAutoHidePanelHide("Check List")
    Call sAutoHidePanelHide("Daily Check Panel")
   
    'Close Windows
    Sys.Keys "[Enter]"
    Sys.Keys "[Enter]"
    Sys.Keys "Y"
    Sys.Keys "Y"
    Sys.Keys "O"
    Sys.Keys "O"
    Call sCloseSource
    Call CloseWindow
    Call CloseWindow
    Call CloseWindow
    Call CloseSearch
    Sys.Keys "[Enter]"
    Sys.Keys "[Enter]"
    Sys.Keys "Y"
    Sys.Keys "Y"
    Sys.Keys "O"
    Sys.Keys "O"
    
    'Drop Workspace
     Call SourceWorkSpacevwr
     Call DropSourceSchWS
     Call sCheckLayoutWorkSpaceVwrDropWorkspace
     Call CloseWindow
     Call CloseWindow
     Call closeWindow

    'Close excel books
    Call ExcelProcessKill()
    
      Sys.Process("ISI.CeicDataManager.Startup").Close
      Sys.Process("ISI.CeicDataManager.Startup").Terminate
      Delay(5000)
      
       Err.Clear
       RouTime=0

End Sub


Sub EdgeCleanUp2
On Error Resume Next
    
     Set PicObj = Utils.Picture
     Set PicObj = Sys.Desktop.Picture
     PicObj.SavetoFile(strLogFolder & "Screenshots\" & strTestCase_No &  "_" & picCount & ".jpg")
     picCount = picCount + 1 
    
    
    strTestCaseResult = "ABORT"
    Call Sys.Process("EdgeClient").Close
    Call Sys.Process("EdgeClient").Terminate
    Call sLaunchEDGE()

    'Drop Workspace
     Call SourceWorkSpacevwr
     Call DropSourceSchWS
     Call sCheckLayoutWorkSpaceVwrDropWorkspace
     Call CloseWindow
     Call CloseWindow
     Call closeWindow

    'Close excel books
      objArray = Sys.FindAllChildren("ProcessName","EXCEL", 5,True)
      For i=0 to ubound(objArray)
        log.Message objArray(i).FullName
        set oSTP_ExcelObj = objArray(i).FindChild("WndCaption", "*RUN*",1,True)
        If oSTP_ExcelObj.Exists = True Then
        Else
          Set netUIHWND = Aliases.EXCEL.wndXLMAIN.EXCEL2.toolbarRibbon.Ribbon.NUIPane.NetUIHWND
          Call netUIHWND.Click(604, 40)
          objArray(i).Close
          Sys.Keys "[Enter]"
          Sys.Keys "[Enter]"
          Sys.Keys "S"
          Sys.Keys "S"     
          
        End If
      Next
      Delay(5000)
      Sys.Process("ISI.CeicDataManager.Startup").Close
      Sys.Process("ISI.CeicDataManager.Startup").Terminate
      Delay(5000)
      
      RouTime=0

End Sub



Sub eAIP_STP(strParameters)
'Sub eAIP_STP

On Error Resume Next

  strLevel1=getSplitValue(strParameters,"Level1")
  strLevel2=getSplitValue(strParameters,"Level2Abbr")
  strLevel3=getSplitValue(strParameters,"Level3")

'  strLevel1="YYY"
'  strLevel2="YYYeAIPTest"
'  strLevel3="YYY-eAIP Test 1"
'	strEnvi = "Edge ( US Integration )"
  
  'Open eAIP window
  strTemp="WPFObject(""ContentControl"", ""eAIP Event"", 1)"
  Set objeAIP=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,true)
  Call objeAIP.Click
  Call sEdgeProcessor
  
  'Import STP file
  strTemp="WPFObject(""ContentControlEx"", ""Import Files"", 2)"
  Set objImport=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,true)
  Call objImport.Click
  
  'Files Window
  strTemp="Window(""#32770"", ""Open Timepoint Observation Files"", 1)"
  Set objFilesWindow=Sys.Process("EdgeClient").WaitChild(strTemp,30000)
  If objFilesWindow.Exists=True then
    
    'Edit Box
    strTemp="Window(""Edit"", """", 1)"
    Set objFilenameEditbox=objFilesWindow.FindChild("Name",strTemp,50,true)
    FilePath = aqEnvironment.GetEnvironmentVariable("USERPROFILE") & "\Documents\Edge\EdgeAddinStorage\" & aqConvert.DateTimeToFormatStr(aqDateTime.Today,"%Y-%m-%d")
    'FilePath = aqEnvironment.GetEnvironmentVariable("USERPROFILE") & "\Documents\Edge\EdgeAddinStorage\2017-11-14"
    FileName=FilePath &"\"& strLevel1 &"-"& strLevel2 &"-"& strLevel3 & ".xls"
    log.Message FileName
		'msgbox FileName
    Delay 5000, ""
    Call objFilenameEditbox.SetText("")
    Delay 2000, "Waiting"
    
    Call objFilenameEditbox.SetText(FileName)
    Delay 2000, "Waiting..."
    
    'Click Open
    Set objOpenButton=Sys.Process("EdgeClient").Window("#32770", "Open Timepoint Observation Files", 1).Window("Button", "&Open", 1)
    Call objOpenButton.Click
    
    'Confirm import
    Set objMessageBox=Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "eAIP Event Manager")
    If objMessageBox.Exists=True then
      strTemp="WPFObject(""Button_Yes"")"
      Set objYesButton=objMessageBox.FindChild("Name",strTemp,50,true)
      Call objYesButton.Click
      
      strTemp = "WPFObject(""PART_InactiveBorder"")"
      Set objUpdateWindow = Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "eAIP Event Manager").WPFObject("CustomMessageBoxWindow", "eAIP Event Manager", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,30000)
      'Delay 30000,"Pls wait..."
      strTemp="WPFObject(""Button_OK"")"
      Set objOkButton=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,true)
      Call objOkButton.Click
      Call sEdgeProcessor
      Delay 20000,"Pls wait..."
      'Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1).WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 1).WPFObject("BarButtonItemLinkControl", "", 1).WPFObject("ContentControlEx", "Refresh", 2).Click
      Call sEdgeProcessor
      Delay 5000,"Pls wait..."
      'Finding file upload status
      strTemp="WPFObject(""ImportStatusGridControl"")"
      Set objGridControl=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,true)         
      For i=objGridControl.wRowCount-1 to 0 step -1
       'msgbox objGridControl.DataContext.Item(i).FileId=strLevel1 &"-"& strLevel2 &"-"& strLevel3 and objGridControl.DataContext.Item(i).ImportStatus
        If objGridControl.DataContext.Item(i).FileId = strLevel1 &"-"& strLevel2 &"-"& strLevel3 And objGridControl.DataContext.Item(i).ImportStatus= "Uploaded" then
         strTCRemarks="CN STP successfully uploaded in eAIP Event Manager"
         log.Message strTCRemarks
         Exit For
        End If
      Next
    Else
      strTCRemarks="Import Files Window Message Box not found"
      strTestCaseResult="ABORT"
    End If
  Else
    strTCRemarks="Import Files Window not found"
    strTestCaseResult="ABORT"
  End If
  
  If strTCRemarks="" then
    strTestCaseResult="ABORT"
  End If
  
  Call CloseWindow
  Call CloseWindow

End Sub

'Sub CNSTP(strParameters)
Sub CNSTP()

  strLevel1=getSplitValue(strParameters,"Level1")
  strLevel2=getSplitValue(strParameters,"Level2")
  strLevel3=getSplitValue(strParameters,"Level3")
  strLevel4=getSplitValue(strParameters,"Level4")
  strLevel5=getSplitValue(strParameters,"Level5")
  strEnvi = "Edge ( US Integration )" 

  'Open Source Dispaly Viewer  
  Call sOpenSourceDispalyViewer() 
  
  'Select the required Level  
  Call SelectLevel5Source(strParameters) 
  
  Delay 1000
  
  'Click on CnSTP 
  
  strTemp ="WPFObject(""ContentControlEx"", ""Open CN STP"", 2)"
  Set objTemp = Sys.Process("EdgeClient").FindChild("Name",strTemp,50,True)
  
  If objTemp.Exists Then 
      objTemp.Click
  End If

   
  
  
  

End Sub

'Sub SelectLevel5Source(strParameters)
Sub SelectLevel5Source(strLevel1,strLevel2,strLevel3,strLevel4,strLevel5)

On Error Resume Next
Dim IntRowNumber(6)

'strLevel1="China"
'strLevel2="Input Files"
'strLevel3="NA"
'strLevel4="Nationwide"
'strLevel5="CN-AC"
    'strEnvi = "Edge ( US Integration )" 



'  strLevel1=getSplitValue(strParameters,"Level1")
'  strLevel2=getSplitValue(strParameters,"Level2")
'  strLevel3=getSplitValue(strParameters,"Level3")
'  strLevel4=getSplitValue(strParameters,"Level4")
'  strLevel5=getSplitValue(strParameters,"Level5")
'
'    strSource_Name=strLevel1
'    strLevel2src_Name=strLevel2
  
     Delay 2000,"Pls Wait.."
    strTemp="WPFObject(""SourceTreeListView"")"
    Set GridControl=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,True)
    strTemp="WPFObject(""SourceTreeControl"")"
    Set GridSourceTree=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,True)
    Delay 5000,"Pls Wait.."
    ''Selecting Country Name
    intTotNodeCnt=GridControl.Nodes_2.Count
    For intI=0 to intTotNodeCnt-1         
        If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strLevel1) then
          GridControl.Nodes_2.Item(intI).ExpandAll
          log.Message "Country Name - " & GridControl.Nodes_2.Item(intI).Content.Description 
          IntRowNumber(0) = intI      
    '      strTCRemarks=strTCRemarks & Chr(10) & "Selected Node - " & GridControl.Nodes_2.Item(intI).Content.Description  
          blnFlag=False  
          Exit For
        End If
    Next
    If blnFlag = True then
      strTCRemarks="Country Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
  
    Delay 5000,"Pls Wait.."
        blnFlag = True 
    ''Selecting Level2Source_Name
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
  For intJ=0 to intTotNodeCnt-1
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strLevel2) then
        GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).ExpandAll
    '    intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(0).get_RowHandle
        intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
'        Call GridSourceTree.ClickCell(intRow, "Edit")
        Call GridControl.ClearSelectionCore
        Call GridControl.FocusViewAndRow(GridControl,intRow)
        GridControl.SetFocusOnCurrentItem
        Call GridControl.SelectRowCore(intRow)
        log.Message "Level2 Source Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
        IntRowNumber(1) = intJ 
        blnFlag = False 
        Exit For
      End If
    Next
    If blnFlag = True then
      log.Message "Level2 Source Name not found"
      strTCRemarks="Level2 Source Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
    Delay 2000,"Pls Wait.."
    
    ''Selecting Level3Source_Name
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count
  For intK=0 to intTotNodeCnt-1
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description)=Ucase(strLevel3) then
        GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).ExpandAll
        intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).get_RowHandle
        Call GridControl.ClearSelectionCore
        Call GridControl.FocusViewAndRow(GridControl,intRow)
        GridControl.SetFocusOnCurrentItem
        Call GridControl.SelectRowCore(intRow)
        IntRowNumber(2) = intK 
        'log.Message "Level2 Source Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
        blnFlag = False 
        Exit For
      End If
    Next
    If blnFlag = True then
      'log.Message "Level2 Source Name not found"
      strTCRemarks="Level3 Source Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
    Delay 2000,"Pls Wait.." 
    
    'selecting level4 source
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Nodes.Count
  For intL=0 to intTotNodeCnt-1
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Nodes.Item(intL).Content.Description)=Ucase(strLevel4) then
       GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Nodes.Item(intL).ExpandAll
        intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Nodes.Item(intL).get_RowHandle
        Call GridControl.ClearSelectionCore
        Call GridControl.FocusViewAndRow(GridControl,intRow)
        GridControl.SetFocusOnCurrentItem
        Call GridControl.SelectRowCore(intRow)
        IntRowNumber(3) = intL 
        'log.Message "Level2 Source Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
        blnFlag = False 
        Exit For
      End If
  Next
    If blnFlag = True then
      'log.Message "Level2 Source Name not found"
      strTCRemarks="Level4 Source Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
    Delay 2000,"Pls Wait.."
    
    'selecting level5 source
    intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Nodes.Item(intL).Nodes.Count
  For intM=0 to intTotNodeCnt-1
      If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Nodes.Item(intL).Nodes.Item(intM).Content.Description)=Ucase(strLevel5) then
       
        intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Nodes.Item(intL).Nodes.Item(intM).get_RowHandle
        Call GridControl.ClearSelectionCore
        Call GridControl.FocusViewAndRow(GridControl,intRow)
        GridControl.SetFocusOnCurrentItem
        Call GridControl.SelectRowCore(intRow)
         IntRowNumber(4) = intM 
        'log.Message "Level2 Source Name - " & GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description  
        blnFlag = False 
        Exit For
      End If
  Next
    If blnFlag = True then
      'log.Message "Level2 Source Name not found"
      strTCRemarks="Level5 Source Name not found"
      strTestCaseResult="FAIL"
      Exit Sub
    End If
    Delay 2000,"Pls Wait.."    
    
End Sub

Sub sCheckWorkspaceName()

    'msgbox DescText
    'msgbox strWrkSpaceName
    Call sOpenSourceWSViewer()
    Delay "2000", "Please Wait...."
    
    On Error Resume Next
    strTemp="WPFObject(""PendingChangeGridControl"")"
    Set objGridControl=Sys.Process("EdgeClient").FindChild("Name",strTemp,60,True)
    Set objTableView = objGridControl.WPFObject("PendingChangeTableView")
    Call objGridControl.ClickCell(0 , "Created by") 
    strWorkSpaceName= objTableView.WPFObject("HierarchyPanel", "", 1).WPFObject("RowControl", "", 1).WPFObject("CellsControl", "", 1).WPFObject("LightweightCellEditor", "", 1).WPFObject("InplaceBaseEdit", "", 1).DisplayText
    If Ucase(Trim(strWorkSpaceName)) = Ucase(Trim(DescText)) Then
'        strTCRemarks= "Entered Workspacename is displayed :" & strWorkSpaceName 
'        strTCRemarks = strTCRemarks & "...........TC_SOURCEWV_36 Testcase Pass........."       
        strTCRemarks = "TC_SOURCEWV_36  Pass"
        strTestCaseResult="PASS" 
    Else
'       strTCRemarks= "Entered Workspacename is not displayed"   
'       strTCRemarks = strTCRemarks & "...........TC_SOURCEWV_36 Testcase Fail........."     
       strTCRemarks = "TC_SOURCEWV_36  Fail"
       strTestCaseResult="FAIL" 
    End If
End Sub

Sub sCreatedAt()

   Call sOpenSourceWSViewer()
    Delay "2000", "Please Wait...."
    On Error Resume Next
    
    strTemp="WPFObject(""PendingChangeGridControl"")"    
    Set objGridControl=Sys.Process("EdgeClient").FindChild("Name",strTemp,60,True)
    Set objTableView = objGridControl.WPFObject("PendingChangeTableView")
    Call objGridControl.ClickCell(0 , "Created by") 
    
    
    strCreatedAt =objTableView.WPFObject("HierarchyPanel", "", 1).WPFObject("RowControl", "", 1).WPFObject("CellsControl", "", 1).WPFObject("LightweightCellEditor", "", 4).WPFObject("InplaceBaseEdit", "", 1).DisplayText
    strCreatedATSplit = Split(strCreatedAt," ")
    strWrkSpaceDateTimeSplit = Split(strWrkSpaceDateTime," ")
    If strWrkSpaceDateTimeSplit(0)<10 Then 
      numDate = 0&strWrkSpaceDateTimeSplit(0)
    Else
      numDate = strWrkSpaceDateTimeSplit(0)
    End IF
    strDate1 = numDate &" "&strWrkSpaceDateTimeSplit(1)&" "&strWrkSpaceDateTimeSplit(2)
    strDate2 = strCreatedATSplit(0)&" "&strCreatedATSplit(1)&" "&strCreatedATSplit(2)
 
    
   'Verify CreatedAt time with Time during creation of Workspace 
    If strDate1 = strDate2 And DateDiff("s",strWrkSpaceDateTimeSplit(3),strCreatedATSplit(3))<40 And strWrkSpaceDateTimeSplit(4) = strCreatedATSplit(4)Then
'      strTCRemarks= "CreatedAt cell  displayed the time , at which the Workspace has been created: "& strCreatedAt 
'      strTCRemarks = strTCRemarks & ".....TC_SOURCEWV_44 Testcase Pass........."
      strTCRemarks = "TC_SOURCEWV_44  Pass"
      strTestCaseResult="PASS" 
    Else
'      strTCRemarks= "CreatedAt cell  not displayed the time , at which the Workspace has been created , it shows : " & strCreatedAt 
'      strTCRemarks = strTCRemarks & ".....TC_SOURCEWV_44 Testcase Fail........."    
      strTCRemarks = "TC_SOURCEWV_44  Fail"
      strTestCaseResult="FAIL" 
    End If 
End Sub


Sub sSaveWorkspace(strParameters)

    strSource_Name=getSplitValue(strParameters,"SOURCE")
    strLevel2src_Name=getSplitValue(strParameters,"LEVEL2SOURCE") 
    
'      strTemp = "WPFObject(""ContentControlEx"", ""Open Workspace"", 2)"          
'      Set objTemp=Sys.Process("EdgeClient").FindChild("Name",strTemp,60,true)
'      If objTemp.IsEnabled  Then 
'          objTemp.Click
'        Call sEdgeProcessor 
    'Call objGridControl.ClickCell(0 , "Created by")
    
    'Open the workspace by shortcut key Ctrl+O
      
      Sys.Keys("^o")
      Delay 2000, "Please wait WorkSpace is Opening"
      Call sEdgeProcessor()          
      Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2)
       If objTemp.IsEnabled Then
          strCaption = objTemp.Caption.OleValue
          IF Trim(strCaption) = Trim("Source Workspace (For Edit) - " &strWorkSpaceName) Then
'              strTCRemarks= strTCRemarks & "Selected WorkSpace is opened by using Shortcut Keys---" 
'              strTCRemarks = strTCRemarks & "........TC_SOURCEWV_48 Testcase Pass...." 
              'strTestCaseResult="PASS"    
              strTCRemarks = "TC_SOURCEWV_48  Pass"        
           Else
'              strTCRemarks= strTCRemarks & "Selected WorkSpace is not opened  by using Shortcut Keys- ---"
'              strTCRemarks = strTCRemarks & "......TC_SOURCEWV_48 Testcase Fail..."               
              'sOpenGenral = strTCRemarks   
              'strTestCaseResult="FAIL"   
              strTCRemarks = "TC_SOURCEWV_48  Fail"       
            End IF
         End If 
       
       ' Call sCloseSWV()
        strTemp = "WPFObject(""LayoutPanel"", """", 2)"
        'Set objTemp=Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2)
        Set objTemp=Sys.Process("EdgeClient").FindChild("Name",strTemp,60,true)
        If objTemp.IsEnabled Then  
            Set GridControl=Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl").WPFObject("SourceTreeListView")
            Set GridSourceTree=Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("SourceTreeListControl")

'            ''Expanding First Node in Tree      
            intTotNodeCnt=GridControl.Nodes_2.Count  
            For intI=0 to intTotNodeCnt-1         
              If Ucase(GridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strSource_Name) then
                GridControl.Nodes_2.Item(intI).ExpandAll
                blnFlag=False  
                Exit For
              End If
            Next
    
            ''Expanding Second Node in Tree
            intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Count
            For intJ=0 to intTotNodeCnt-1
             'msgbox GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description
              If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strLevel2src_Name) then
                GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).ExpandAll
                intRow=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(0).get_RowHandle
                blnFlag=False  
                Exit For
              End If
            Next
            
           'update the opned Workspcae
            intTotNodeCnt=GridControl.Nodes_2.Item(intI).Nodes.Item(intI).Nodes.Count
            For intK=intTotNodeCnt-1 to 0 step-1
              If Ucase(GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description)=Ucase(strWorkSpaceName) then
                Set objDescCell=GridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK)
                strText = strWorkSpaceName &"_Updated"
                Call objDescCell.Content.set_Description(strText)
                blnFlag=False  
                Exit For
              End If         
            Next   
            
           'Closing SWV Window  
           Call sCloseSWV()
   
  'Save the Workspace            
        strTemp="WPFObject(""ContentControlEx"", ""Workspace"", 2)"
          Set objWrkSpace=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,true)
          If objWrkSpace.IsEnabled = True then         
            objWrkSpace.Click          
           If objWrkSpace.IsEnabled = True then
              strTemp="WPFObject(""ContentControlEx"", ""Save Workspace"", 2)"
               set objwrkspcSave=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,True)
              If objwrkspcSave.IsEnabled = True then
                 objwrkspcSave.Click
                  Delay(3000)         
                  'Clicking on Do you want to Save message box
                  strTemp="WPFObject(""HwndSource: CustomMessageBoxWindow"", ""Confirm save."")"
                  Set objConfirm=Sys.Process("EdgeClient").WaitChild(strTemp,60000)          
                  'Set objConfirm=Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "Confirm save.").WPFObject("CustomMessageBoxWindow", "Confirm save.", 1).WPFObject("Grid", "", 1).WPFObject("PART_InactiveBorder")
               If objConfirm.Exists = True then
                Sys.Keys "Y"              
                Set objConfirm = Sys.Process("EdgeClient")._
                Waitchild("WPFObject(""HwndSource: CustomMessageBoxWindow"", """")",600000)'._
                If objConfirm.Exists = True then
                   Sys.Keys("O")                
                   Call sEdgeProcessor
                   Call sCloseSWV()
	                 Delay 1000,"Closing SourceWorkspace for Edit..."
                End If
               End If 
              End If 
            End If
           End If
        End If
End Sub

Sub sUpdatedAT(strParameters)

   Call sOpenSourceWSViewer()
    Delay "2000", "Please Wait...."
    On Error Resume Next
    
    strSource_Name=getSplitValue(strParameters,"SOURCE")
    strLevel2src_Name=getSplitValue(strParameters,"LEVEL2SOURCE") 
  
'    strSource_Name = "Test"
'    strLevel2src_Name="ASW01" 
    
    strTemp="WPFObject(""PendingChangeGridControl"")"    
    Set objGridControl=Sys.Process("EdgeClient").FindChild("Name",strTemp,60,True)
    Set objTableView = objGridControl.WPFObject("PendingChangeTableView")
    Call objGridControl.ClickCell(0 , "Created by")
'-----------------------------------------------------------------------------------------------------------------------------------------    
    strWorkSpaceName = objTableView.WPFObject("HierarchyPanel", "", 1).WPFObject("RowControl", "", 1).WPFObject("CellsControl", "", 1).WPFObject("LightweightCellEditor", "", 1).WPFObject("InplaceBaseEdit", "", 1).DisplayText
    strUpdatedAt=  objTableView.WPFObject("HierarchyPanel", "", 1).WPFObject("RowControl", "", 1).WPFObject("CellsControl", "", 1).WPFObject("LightweightCellEditor", "", 5).WPFObject("InplaceBaseEdit", "", 1).DisplayText
    strWrkSpaceDateTimeSplit = Split(strWrkSpaceDateTime," ")
    strUpdatedAtSplit = Split(strUpdatedAt," ")
    
    If strWrkSpaceDateTimeSplit(0)<10 Then 
      numDate = 0&strWrkSpaceDateTimeSplit(0)
    Else
      numDate = strWrkSpaceDateTimeSplit(0)
    End IF
    strDate1 = numDate &" "&strWrkSpaceDateTimeSplit(1)&" "&strWrkSpaceDateTimeSplit(2)
    strDate2 = strUpdatedAtSplit(0)&" "&strUpdatedAtSplit(1)&" "&strUpdatedAtSplit(2)
    
    
     
   'Verify UpdatedAt time with Updated time  
    If strDate1 = strDate2 And DateDiff("s",strWrkSpaceDateTimeSplit(3),strUpdatedAtSplit(3))<60 And strWrkSpaceDateTimeSplit(4) = strUpdatedAtSplit(4)Then
'      strTCRemarks= "Updated cell  displayed the updated Time:  "& strUpdatedAt    
'      strTCRemarks = strTCRemarks & "----------------TC_SOURCEWV_45 Pass-------------"
      'strTestCaseResult="PASS" 
      strTCRemarks = "TC_SOURCEWV_45  Pass"
    Else
'      strTCRemarks= "Updated cell  displayed the updated Time: , it shows : " & strUpdatedAt     
'      strTCRemarks = strTCRemarks & "----------------TC_SOURCEWV_45 Fail-------------"
     ' strTestCaseResult="FAIL" 
      strTCRemarks = "TC_SOURCEWV_45  Fail"
    End If
    
'-----------------------------------------------------------------------------------------------------------------------------------------
'--------------------------------------------TC_SOURCEWV_46 Statred---------------------------------------------------------------------
      
  'Modify and Save Workspace
   Call sSaveWorkSpace(strParameters)
  'Reopening the Sorce Workspace viewer
       Call sOpenSourceWSViewer()
       
      'Verifying the updarted Time  
    strTemp="WPFObject(""PendingChangeGridControl"")"    
    Set objGridControl=Sys.Process("EdgeClient").FindChild("Name",strTemp,60,True)
    Set objTableView = objGridControl.WPFObject("PendingChangeTableView")
    Call objGridControl.ClickCell(0 , "Created by")
    
    strWorkSpaceName = objTableView.WPFObject("HierarchyPanel", "", 1).WPFObject("RowControl", "", 1).WPFObject("CellsControl", "", 1).WPFObject("LightweightCellEditor", "", 1).WPFObject("InplaceBaseEdit", "", 1).DisplayText
    strUpdatedAt=  objTableView.WPFObject("HierarchyPanel", "", 1).WPFObject("RowControl", "", 1).WPFObject("CellsControl", "", 1).WPFObject("LightweightCellEditor", "", 5).WPFObject("InplaceBaseEdit", "", 1).DisplayText
    strWrkSpaceDateTimeSplit = Split(strWrkSpaceDateTime," ")
    strUpdatedAtSplit = Split(strUpdatedAt," ")
    strDate1 = strWrkSpaceDateTimeSplit(0)&" "&strWrkSpaceDateTimeSplit(1)&" "&strWrkSpaceDateTimeSplit(2)
    strDate2 = strUpdatedAtSplit(0)&" "&strUpdatedAtSplit(1)&" "&strUpdatedAtSplit(2)
     
   'Verify UpdatedAt time with Updated time  
    If DateDiff("s",strWrkSpaceDateTimeSplit(3),strUpdatedAtSplit(3))> 0  And  DateDiff("s",strWrkSpaceDateTimeSplit(3),strUpdatedAtSplit(3))<240 Then
'      strTCRemarks= strTCRemarks & "Updated cell  displayed the updated Time:  "& strUpdatedAt    
'      strTCRemarks = strTCRemarks & "----------------TC_SOURCEWV_46 Pass-------------"
      strTCRemarks = "TC_SOURCEWV_46  Pass"
      strTestCaseResult="PASS" 
    Else
'      strTCRemarks= strTCRemarks & "Updated cell  displayed the updated Time: , it shows : " & strUpdatedAt     
'      strTCRemarks = strTCRemarks & "----------------TC_SOURCEWV_46 Fail-------------"
      strTCRemarks = "TC_SOURCEWV_46  Fail"
      strTestCaseResult="FAIL" 
    End If   
  
'...........................................................................................................................................        
   
   'Verify Ctrl+U to upload the workspace
    Sys.Keys("^u")
    strTemp="WPFObject(""HwndSource: CustomMessageBoxWindow"", ""Please Confirm."")"
    Set objConfirm=Sys.Process("EdgeClient").WaitChild(strTemp,60000)
    strTemp="WPFObject(""TextBlock_Message"")"
    If objConfirm.Exists Then
      SYS.Keys "[Enter]"
      Set objConfirm = Sys.Process("EdgeClient").Waitchild("WPFObject(""HwndSource: CustomMessageBoxWindow"", ""Upload Workspace"")",600000)'._
       If objConfirm.Exists = True then
        Sys.Keys("O")
        Call sEdgeProcessor
'        strTCRemarks= strTCRemarks & "Selected WorkSpace is Uploaded by using ShortCut Keys---" 
'        strTCRemarks = strTCRemarks & "---TC_SOURCEWV_49 Testcase Pass" 
        strTCRemarks = "TC_SOURCEWV_45_46_48_49 Pass"
        strTestCaseResult="PASS"      
       End If
    Else 
'      strTCRemarks= strTCRemarks & "Selected WorkSpace is not Uploaded by using ShortCut Keys---" 
'      strTCRemarks = strTCRemarks & "---TC_SOURCEWV_49 Testcase Fail" 
      strTCRemarks = "TC_SOURCEWV_45_46_48_49  Fail"
      strTestCaseResult="FAIL"      
    End If 
End Sub


Sub sShowSearchFilter(strParameters)
'Sub sShowSearchFilter()

  
    On Error Resume Next
    Dim arrName(10)
    
    Call sOpenSourceWSViewer()
    
    strCategory=getSplitValue(strParameters,"CATEGORY") 
    strCreatedBy=getSplitValue(strParameters,"CREATEDBY")
    strOwner=getSplitValue(strParameters,"OWNER")
    strWorkspaceName=DescText

    
     
'    strCategory="TC_SOURCEWV_54"
'    strEnvi = "Edge ( US Integration )" 
'    strCreatedBy="(Select All)" 
'    strOwner="Shilpa Bhopalapur"
'    strWorkspaceName= "1-3-2018 3_09_44 PM"

'.............................................................................................................................
    
      
     'To get the dispay name of the computer
      Set objSysInfo = CreateObject("ADSystemInfo")
      strUser = objSysInfo.UserName
      Set objUser = GetObject("LDAP://" & strUser)
      strFullName = objUser.Get("displayName")
      sDisplayName = Split(strFullName,",")
      'Ucase(Trim(strOwner)) = Ucase(Trim(sDisplayName(0))) 
'.............................................................................................................................

'Search Filter Window should display

  If strCategory ="TC_SOURCEWV_50" Then
    strShowSF = "WPFObject(""ContentControlEx"", ""Show Search Filter"", 2)"
    Set objTemp=Sys.Process("EdgeClient").FindChild("Name",strShowSF,60,true)
    strText =  objTemp.WPFControlText  
    If objTemp.IsEnabled And Ucase(Trim(strText)) = Ucase(Trim("Show Search Filter")) Then
      objTemp.Click
      strTemp = "WPFObject(""Border"", """", 1)" 
      Set ObjTemp = Sys.Process("EdgeClient").FindChild("Name",strTemp,60, True) 
      strHideSF = "WPFObject(""ContentControlEx"", ""Hide Search Filter"", 2)"
      Set objHideSF = Sys.Process("EdgeClient").FindChild("Name",strHideSF,60, True) 
      strText =  objHideSF.WPFControlText  
      If ObjTemp.IsEnabled And  Ucase(Trim(strText)) = Ucase(Trim("Hide Search Filter")) Then 
'        strTCRemarks=  "............Search Filter Window is Opened---" 
'        strTCRemarks = strTCRemarks & "---TC_SOURCEWV_50 Testcase Pass" 
        strTCRemarks = "TC_SOURCEWV_50  Pass"
        strTestCaseResult="PASS" 
        Exit Sub
      Else
'        strTCRemarks=  "............Search Filter Window is not Opened---" 
'        strTCRemarks = strTCRemarks & "---TC_SOURCEWV_50 Testcase Fail" 
        strTCRemarks = "TC_SOURCEWV_50  Fail"
        strTestCaseResult="FAIL" 
        Exit Sub       
      End If
    End If  
  End If

'.............................................................................................................................
 
'Click on HideSearch Filter button
 If strCategory ="TC_SOURCEWV_51" Then
   strHideSF = "WPFObject(""ContentControlEx"", ""Hide Search Filter"", 2)"
   Set objHideSF=Sys.Process("EdgeClient").FindChild("Name",strHideSF,60,true)
  ' strText =  Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", "Edge ( US Integration )").WPFObject("Shell", "Edge ( US Integration )", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 4).WPFObject("BarCheckItemLinkControl", "", 1).WPFObject("ContentControlEx", "Hide Search Filter", 2).WPFControlText
   strText = objHideSF.WPFControlText
   If objHideSF.IsEnabled And Ucase(Trim(strText)) = Ucase(Trim("Hide Search Filter")) Then 
      objHideSF.Click
      Delay 1000
      strShowSF = "WPFObject(""ContentControlEx"", ""Show Search Filter"", 2)"
      Set objTemp=Sys.Process("EdgeClient").FindChild("Name",strShowSF,60,true)
      strText = objTemp.WPFControlText
     If ObjTemp.IsEnabled And Ucase(Trim(strText)) = Ucase(Trim("Show Search Filter"))Then
        Call sCloseSWV()
'        strTCRemarks= strTCRemarks& "............Search Filter Window is Closed---" 
'        strTCRemarks = strTCRemarks & "---TC_SOURCEWV_51 Testcase Pass" 
        strTCRemarks = "TC_SOURCEWV_51  Pass"
        strTestCaseResult="PASS" 
        Exit Sub
      Else
'        strTCRemarks=  strTCRemarks & "............Search Filter Window is not Closed---" 
'        strTCRemarks = strTCRemarks & "---TC_SOURCEWV_51 Testcase Fail" 
        strTCRemarks = "TC_SOURCEWV_51  Fail"
        strTestCaseResult="FAIL" 
        Exit Sub     
      End IF
   End IF   
 End If
'.............................................................................................................................
  'Object Identification
   strShowSF = "WPFObject(""ContentControlEx"", ""Show Search Filter"", 2)"
    Set objTemp=Sys.Process("EdgeClient").FindChild("Name",strShowSF,60,true)
    strText =  objTemp.WPFControlText  
    'strText = Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", "Edge ( US Integration )").WPFObject("Shell", "Edge ( US Integration )", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("BarContainerControl", "", 1).WPFObject("BarControl", "", 1).WPFObject("BarItemLinkInfo", "", 4).WPFObject("BarCheckItemLinkControl", "", 1).WPFObject("ContentControlEx", "Show Search Filter", 2).WPFControlText
    If Ucase(Trim(strText)) = Ucase(Trim("Show Search Filter")) Then
      objTemp.Click
    End If
      Delay 200
  Set objStackPanel= Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Border", "", 1).WPFObject("SearchGrid").WPFObject("StackPanel", "", 1)             
  Set objWorkspaceName = objStackPanel.WPFObject("StackPanel", "", 1).WPFObject("StackPanel", "", 1).WPFObject("TextBox", "", 1)
  Set objCreatedBy = objStackPanel.WPFObject("StackPanel", "", 2).WPFObject("ComboBox", "", 1)
  Set objOwner = objStackPanel.WPFObject("StackPanel", "", 3).WPFObject("ComboBox", "", 1)
  Set objApplyFilter = objStackPanel.WPFObject("StackPanel", "", 6).WPFObject("Button", "Apply Filter", 1)
  Set objResetDefault = objStackPanel.WPFObject("StackPanel", "", 6).WPFObject("Button", "Reset Default", 2)

  objResetDefault.Click
  strTemp ="WPFObject(""Button_Yes"")" 
  Set objYesButton  = Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "Please Confirm.").FindChild("Name",strTemp,50,True)
  objYesButton.Click  
  objApplyFilter.Click 
'.............................................................................................................................

'Search by Workspace name:
  If strCategory ="TC_SOURCEWV_52" Then 
  
    'Enter workspace name
     objWorkspaceName.Click
     Call objWorkspaceName.SetText(strWorkspaceName)
     
     'Select Creaed By And Owner 
     Call sCreatedByAndOwner(strCreatedBy,strOwner)
    
     'Click on Apply Filter button
      If objApplyFilter.Exists Then
         objApplyFilter.Click
      End If
     
     Delay 2000 
     Set objGridControl =  Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("PendingChangeGridControl") 
     strCurrentWorkspaceName=objGridControl.WPFObject("PendingChangeTableView").WPFObject("HierarchyPanel", "", 1).WPFObject("RowControl", "", 1).WPFObject("CellsControl", "", 1).WPFObject("LightweightCellEditor", "", 1).WPFObject("InplaceBaseEdit", "", 1).DisplayText 
     IntRowCount = objGridControl.wRowCount 
     If IntRowCount > 0 And Trim(Ucase(strCurrentWorkspaceName)) = Trim(Ucase(strWorkspaceName)) Then
'        strTCRemarks=  strTCRemarks & strCurrentWorkspaceName&"............Workspace disaplyed---" 
'        strTCRemarks = strTCRemarks & "---TC_SOURCEWV_52 Testcase Pass" 
        strTCRemarks = "TC_SOURCEWV_52  Pass"
        strTestCaseResult="PASS" 
        Exit Sub
     Else
'        strTCRemarks=  strTCRemarks & strWorkspaceName &"............Workspace is not disaplyed---" 
'        strTCRemarks = strTCRemarks & "---TC_SOURCEWV_52 Testcase Pass" 
        strTCRemarks = "TC_SOURCEWV_52  Fail"
        strTestCaseResult="Fail" 
        Exit Sub      
     End If
    End If
'.............................................................................................................................

  'Search by Created By and Owner
  If strCategory ="TC_SOURCEWV_53" Then
    
      'Select Creaed By And Owner 
     Call sCreatedByAndOwner(strCreatedBy,strOwner)
   
    'Verify The Search Resutl 
      Delay 2000 
      IntCnt= 0 
      Set objGridControl =  Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("PendingChangeGridControl") 
      IntRowCount = objGridControl.wRowCount 
      For IntI= 0 to IntRowCount-1
        arrName(IntI) = objGridControl.WPFObject("PendingChangeTableView").WPFObject("HierarchyPanel", "", 1).WPFObject("RowControl", "", IntI+1).WPFObject("CellsControl", "", 1).WPFObject("LightweightCellEditor", "", 2).WPFObject("InplaceBaseEdit", "", 1).DisplayText
        If Ucase(Trim(arrName(IntI))) <> Ucase(Trim(sDisplayName(0))) Then 
          IntCnt = IntCnt+1
        End IF        
      Next 
      
      If IntCnt > 0 Then 
'        strTCRemarks=  strTCRemarks & "Right Panel displayed all Workspaces"
'        strTCRemarks = strTCRemarks & "---TC_SOURCEWV_53 Testcase Pass" 
        strTCRemarks = "TC_SOURCEWV_53  Pass"
        strTestCaseResult="PASS" 
        Exit Sub
      Else
'        strTCRemarks=  strTCRemarks & "Right Panel has not displayed all Workspaces"
'        strTCRemarks = strTCRemarks & "---TC_SOURCEWV_53 Testcase Fail" 
        strTCRemarks = "TC_SOURCEWV_53  Fail"
        strTestCaseResult="FAIL" 
        Exit Sub
      End If      
  End If
'.............................................................................................................................

  ' Change the Owner name 
  If strCategory ="TC_SOURCEWV_54" Then
  
  
  'Uncheck "Current User check box
    Call sUncheck()
    Call objCreatedBy.Click
  
    'Select Creaed By And Owner 
     Call sCreatedByAndOwner(strCreatedBy,strOwner)
     
      'Verify The Search Resutl 
      Delay 2000 
      IntCnt= 0 
      Set objGridControl =  Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("PendingChangeGridControl") 
      Set objOwner = objGridControl.WPFObject("PendingChangeTableView").WPFObject("HierarchyPanel", "", 1).WPFObject("RowControl", "", 1).WPFObject("CellsControl", "", 1).WPFObject("LightweightCellEditor", "", 3).WPFObject("PART_Editor")
      objOwner.Click    
      'objOwner.set_text(sDisplayName(0))   
      objOwner.keys("A")
      Dealy 2000
      strTemp = "WPFObject(""PART_InactiveBorder"")"
      objTemp = Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "Change Ownership").WPFObject("CustomMessageBoxWindow", "Change Ownership", 1).WPFObject("Grid", "", 1).WaitChild(strTemp,60000)
      Delay 200
      strText = Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "Change Ownership").WPFObject("CustomMessageBoxWindow", "Change Ownership", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContentOffset").WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 1).WPFObject("DockPanel", "", 1).WPFObject("TextBlock_Message").Text
      strMessage = "The workspace could not be transferred. Only the workspace owner may change the ownership."
      Set objOkButton =  Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "Change Ownership").WPFObject("CustomMessageBoxWindow", "Change Ownership", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContentOffset").WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("Grid", "", 2).WPFObject("DockPanel", "", 1).WPFObject("Button_OK") 
      If objOkButton.Exists = True  Then 
        objOkButton.Click    
      End If   
      If Ucase(trim(strText)) = Ucase(Trim(strMessage)) Then
'        strTCRemarks=  strTCRemarks & "The workspace could not be transferred, Message dispalyed"
'        strTCRemarks = strTCRemarks & "---TC_SOURCEWV_54 Testcase Pass" 
        strTCRemarks = "TC_SOURCEWV_54  Pass"
        strTestCaseResult="PASS" 
        Exit Sub
      Else
'        strTCRemarks=  strTCRemarks & "The workspace could not be transferred, Message is not dispalyed"
'        strTCRemarks = strTCRemarks & "---TC_SOURCEWV_54 Testcase Pass" 
        strTCRemarks = "TC_SOURCEWV_54  Fail"
        strTestCaseResult="FAIL" 
        Exit Sub
      End If 
      
  End If
'.............................................................................................................................
  
  'Search by workspace created by other than current user
  If strCategory ="TC_SOURCEWV_55" Then
  
      'Uncheck "Current User check box
        Call sUncheck()
        Call objCreatedBy.Click
      'Select Creaed By And Owner 
       Call sCreatedByAndOwner(strCreatedBy,strOwner)
     'Verify The Search Resutl 
      Delay 2000 
      IntJ = 0 
      IntK = 0 
      Set objGridControl = Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Grid", "", 1).WPFObject("PendingChangeGridControl") 
      IntRowCount = objGridControl.wRowCount 
      For IntI= 0 to IntRowCount-1
        arrName(IntI) = objGridControl.WPFObject("PendingChangeTableView").WPFObject("HierarchyPanel", "", 1).WPFObject("RowControl", "", IntI+1).WPFObject("CellsControl", "", 1).WPFObject("LightweightCellEditor", "", 3).WPFObject("PART_Editor").DisplayText
        If Ucase(Trim(arrName(IntI))) = Ucase(Trim(strOwner)) Then 
          IntJ = IntJ+1
        End IF        
      Next 
      
      For IntI= 0 to IntRowCount-1
        arrName(IntI)= objGridControl.WPFObject("PendingChangeTableView").WPFObject("HierarchyPanel", "", 1).WPFObject("RowControl", "", IntI+1).WPFObject("CellsControl", "", 1).WPFObject("LightweightCellEditor", "", 2).WPFObject("InplaceBaseEdit", "", 1).DisplayText
        If Ucase(Trim(arrName(IntI))) = Ucase(Trim(strCreatedBy)) Then 
          IntK = IntK+1
        End IF        
      Next
      
      If IntI = IntJ And IntK = IntRowCount Then 
'        strTCRemarks=  strTCRemarks & "Right Panel displayed all Workspaces with owner name: "& strOwner
'        strTCRemarks = strTCRemarks & "---TC_SOURCEWV_53 Testcase Pass" 
        strTCRemarks = "TC_SOURCEWV_55  Pass"
        strTestCaseResult="PASS" 
        Exit Sub
      Else
'        strTCRemarks=  strTCRemarks & "Right Panel has not displayed all Workspaces with Owner name :" & strOwner
'        strTCRemarks = strTCRemarks & "---TC_SOURCEWV_53 Testcase Fail" 
        strTCRemarks = "TC_SOURCEWV_55  Fail"
        strTestCaseResult="FAIL" 
        Exit Sub
      End If
  End If   
  
'.............................................................................................................................

 ' Change the Owner name 
  If strCategory ="TC_SOURCEWV_56_57" Then
    Call sCreatedByAndOwner(strCreatedBy,strOwner)
    If objResetDefault.Exists Then 
      objResetDefault.Click
    End If
    strTemp ="WPFObject(""TextBlock_Message"")" 
    Set objConfirmBox  = Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "Please Confirm.").FindChild("Name",strTemp,50,True)
    strText = objConfirmBox.Text
    strMessage = "Are you sure you want reset the search parameters to default?"
    
    If Ucase(Trim(strText)) = Ucase(Trim(strMessage)) Then
       
      'Click on yes Button to reset the Search Filter
      strTemp ="WPFObject(""Button_Yes"")" 
      Set objYesButton  = Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "Please Confirm.").FindChild("Name",strTemp,50,True)
      If objYesButton.Exists Then 
        objYesButton.Click
        Delay 200
        objApplyFilter.Click 
      End If
      Dealy 2000
      strText = objOwner.SelectedValue
      If Ucase(Trim(strText)) = Ucase(Trim("(Current User)" )) Then 
'         strHideSF = "WPFObject(""ContentControlEx"", ""Hide Search Filter"", 2)"
'         Set objHideSF=Sys.Process("EdgeClient").FindChild("Name",strHideSF,60,true)
'         objHideSF.Click
          Call sCloseSWV()
         Call SourceWorkSpacevwr()
'        strTCRemarks=  strTCRemarks & "-----Search Filter set to Default setting----" 
'        strTCRemarks = strTCRemarks & "---TC_SOURCEWV_57 Testcase Pass"       
        strTCRemarks = "TC_SOURCEWV_56_57  Pass"
        strTestCaseResult="PASS" 
        Exit Sub
      End If
    Else
'      strTCRemarks=  strTCRemarks & "------Confirmation Message is not Dispalyed-------"
'      strTCRemarks = strTCRemarks & "---TC_SOURCEWV_56_57 Testcases Fail" 
      strTCRemarks = "TC_SOURCEWV_56_57  Fail"
      strTestCaseResult="FAIL" 
      Exit Sub
    End If
  End If
  
End Sub

Sub sCreatedByAndOwner(strCreatedBy,strOwner)

  Set objStackPanel= Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Border", "", 1).WPFObject("SearchGrid").WPFObject("StackPanel", "", 1)             
  Set objCreatedBy = objStackPanel.WPFObject("StackPanel", "", 2).WPFObject("ComboBox", "", 1)
  Set objOwner = objStackPanel.WPFObject("StackPanel", "", 3).WPFObject("ComboBox", "", 1)
  Set objApplyFilter = objStackPanel.WPFObject("StackPanel", "", 6).WPFObject("Button", "Apply Filter", 1)
 
  'Select the required Created By Option and Check box  
       Call objCreatedBy.Click
       Set objPopUpRoot = Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1)
       intCount = objPopUpRoot.ChildCount
       For IntI = 0 to intCount-1
          strText = objPopUpRoot.WPFObject("ComboBoxItem", "", IntI+1).DataContext.Value.Description
          If Trim(Ucase(strText)) = Trim(Ucase(strCreatedBy)) Then
            Call objPopUpRoot.WPFObject("ComboBoxItem", "", IntI+1).WPFObject("StackPanel", "", 1).WPFObject("CheckBox", "", 1).ClickButton(cbChecked)
            Call objCreatedBy.ClickItem(IntI)
            Exit For
          End IF
          SYS.Keys "[Down]"
       Next
     
        'Select the required Owner and Check box
        Call objOwner.Click
        Set objPopUpRoot = Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1)
        intCount = objPopUpRoot.ChildCount
        For IntJ = 0 to intCount-1
          strText = objPopUpRoot.WPFObject("ComboBoxItem", "", IntJ+1).DataContext.Value.Description
          If Trim(Ucase(strText)) = Trim(Ucase(strOwner)) Then
            Call objPopUpRoot.WPFObject("ComboBoxItem", "", IntJ+1).WPFObject("StackPanel", "", 1).WPFObject("CheckBox", "", 1).ClickButton(cbChecked)
            Call objOwner.ClickItem(IntJ)
            Exit For
          End IF
          SYS.Keys "[Down]"
        Next 
        
       'Click on Apply Filter button
      If objApplyFilter.Exists Then
         objApplyFilter.Click
      End If
      
End Sub

Sub sUncheck()

  Set objStackPanel= Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("Border", "", 1).WPFObject("SearchGrid").WPFObject("StackPanel", "", 1)             
  Set objOwner = objStackPanel.WPFObject("StackPanel", "", 3).WPFObject("ComboBox", "", 1)
 
  'Select the required Owner and Check box
        Call objOwner.Click
        Set objPopUpRoot = Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").WPFObject("PopupRoot", "", 1).WPFObject("Decorator", "", 1).WPFObject("NonLogicalAdornerDecorator", "", 1)
        intCount = objPopUpRoot.ChildCount
        For IntJ = 0 to intCount-1
          strText = objPopUpRoot.WPFObject("ComboBoxItem", "", IntJ+1).DataContext.Value.Description
          If Trim(Ucase(strText)) = Trim(Ucase("(Current User)")) Then
            Call objPopUpRoot.WPFObject("ComboBoxItem", "", IntJ+1).WPFObject("StackPanel", "", 1).WPFObject("CheckBox", "", 1).ClickButton(cbUnchecked)
            Exit For
          End IF
          SYS.Keys "[Down]"
        Next  

End Sub 


'###################################################################################################################################################################

' Author        : Chethana
' Date          : 02-March-2018

'LAunch CDMNext Website o=in IE

Sub sLaunchCDMNext(strParameters)
'Sub sLaunchCDMNext()
  
   On Error Resume Next
  
  Dim strUserName,strPassword, strPage, strXpath
  Dim objTemp , objRequired 

  strUserName=getSplitValue(strParameters,"USERNAME")
  strPassword=getSplitValue(strParameters,"PASSWORD")
  strBrowserName = getSplitValue(strParameters,"BROWSERNAME")
'
'    strUserName    =  "rchethana"    
'    strPassword    =  "Cypress@2014"
'    strBrowserName =  "https://insights.ceicdata.com/" 
'    strTemp= strBrowserName & "login"

    'Launch Url
  
    Call Browsers.Item(btIExplorer).Run(strBrowserName)    
    'Call Browsers.Item(firefox).Run("https://insights.ceicdata.com/") 
    'Sys.Browser().BrowserWindow(0).Maximize
    Delay 8000 , "Please wait Browser is loading" 
'    
    
    
    'Verify alreday login  
    strXpath = "//div/i[@class='avatar-angle fa fa-angle-down']"
    strPage = strBrowserName & "Untitled-insight/views"
    Set objTemp = Sys.Browser("iexplore").Page(strPage).FindChildByXPath(strXpath,True)    
    If objTemp.Exists Then 
      log.Message  "CDMNext WebPage is Launched and already login"
      strTCRemarks="CDMNext WebPage is Launched and already login"
      strTestCaseResult="PASS" 
      Exit Sub  
    Else
      strPage = strBrowserName & "login"
      
      'Enter UserName 
      strXpath = "//input[@name='user_id']"
      Set objTemp = Sys.Browser("iexplore").Page(strPage).FindChildByXPath(strXpath,True)    
      If objTemp.Exists Then 
        objTemp.SetText("")
        objTemp.SetText(strUserName)
      End If
    
      'Enter Password
       strXpath = "//input[@name='password']"
      Set objTemp = Sys.Browser("iexplore").Page(strPage).FindChildByXPath(strXpath,True)    
      If objTemp.Exists Then 
      objTemp.SetText("")
        objTemp.SetText(strPassword)
      End If
    
      'Click on Login Button   
      strXpath = "//button[@type='submit']"
      Set objTemp = Sys.Browser("iexplore").Page(strPage).FindChildByXPath(strXpath,True)    
      If objTemp.Exists Then 
        objTemp.Click
        Delay 8000 , "Please wait Browser is loading" 
      End If
      
      'Verify Login 
      strXpath = "//div/i[@class='avatar-angle fa fa-angle-down']"
      strPage = strBrowserName & "Untitled-insight/views"
      Set objTemp = Sys.Browser("iexplore").Page(strPage).FindChildByXPath(strXpath,True)    
      If objTemp.Exists Then         
        strTCRemarks="CDMNEXT webpage is Launched Successfully and login"
        strTestCaseResult="PASS" 
      Else
        strTCRemarks="Unable to Launch CDMNEXT webpage"
        strTestCaseResult="ABORT"
        Exit Sub
      End If
      
      
    End If
    
    
End Sub

'###################################################################################################################################################################
'Verify Attached Series in CDM Next
'Sub sCDMNextTree(strParameters)
Sub sCDMNextTree()
  On Error Resume Next
  Dim objGrid,intRow,strTopic,intSectionCount,intI,intJ,intK,strSearch1,strs,strSearch2,strSearch3
  Dim objFSO, objFolder, objShell, objTextFile, objFile
  Dim strDirectory, strFile, strText

'  
'    strSearch1=getSplitValue(strParameters,"SEARCH1")
'    strSearch2=getSplitValue(strParameters,"SEARCH2")
'    strSearch3=getSplitValue(strParameters,"SEARCH3")
'    strSeriesID=getSplitValue(strParameters,"SERIESID")
'    strBrowserPage=getSplitValue(strParameters,"BROWSERPAGE")
  

    
    strSearch1="Global Database"
    strSearch2="Z-Testing Topic(IT-use only)"
    strSearch3="Post Release Test _Akshata"
    strSeriesID = "368765647"
    strCategory= aqdatetime.Now
    DescText="TestFile"
    strBrowserPage = "https://qa.ceicdata.com/Untitled-insight/views"  
'    
    
    Set objPanel = Sys.Browser("iexplore").Page(strBrowserPage).Panel(0).Panel(0).Panel(0).Panel(0).Panel(0).Panel(1).Panel(0).Panel(0).Panel(0).Panel(0).Panel(0).Panel(1).Panel(0).Panel(1).Panel(0).Panel(2).Panel(0).Panel(1).Panel(0).Panel(1).Panel(0).Panel(0)
    
    strText = objPanel.contentText
    strSplitText = Split(strText, "(")
    IntCount = Ubound(strSplitText)
   
    'Expand The First Node 
    For IntI= 0 to  IntCount
      strText = objPanel.Panel(0).Panel(0).Panel(IntI).Panel(1).Link(0).TextNode(0).contentText
      If Ucase(strText) = Ucase(strSearch1) Then
         objPanel.Panel(0).Panel(0).Panel(IntI).Panel(0).Click
         Exit For
      End If      
    Next

  Delay 5000 , "Please Wait"
  Set ObjSecondPanel = objPanel.Panel(0).Panel(0).Panel(1).Panel(2)
  IntCount1 = ObjSecondPanel.ChildCount
  
  'Expand The Second Node 
  For IntJ=0 to IntCount1  
    strText = ObjSecondPanel.Panel(IntJ).Panel(1).Link(0).TextNode(0).contentText
    If Ucase(strText) = Ucase(strSearch2) Then
      ObjSecondPanel.Panel(IntJ).Panel(0).Click
      Exit For
    End IF 
  Next
  
  Delay 5000 , "Please Wait"  
  
  Set ObjThirdPanel = ObjSecondPanel.Panel(IntJ).Panel(2)
  IntCount2 = ObjThirdPanel.ChildCount
  
  'Expand The third Node 
  For IntK=0 to IntCount2  
    strText = ObjThirdPanel.Panel(IntK).Panel(1).Link(0).TextNode(0).contentText
    If Ucase(strText) = Ucase(strSearch3) Then
        ObjThirdPanel.Panel(IntK).Panel(0).Click      
      Exit For
    End IF 
  Next 
  
  Delay 5000 , "Please Wait"
  
  Set objFourthPanel = ObjThirdPanel.Panel(IntK).Panel(2)
  IntCount3 = objFourthPanel.ChildCount
  
  ''Expand The Fourth Node 
  For IntL = 0 to IntCount3
    strText = objFourthPanel.Panel(IntL-1).Panel(1).Link(0).TextNode(0).contentText
    If Ucase(strText) = Ucase(DescText) Then
        objFourthPanel.Panel(IntL).Panel(0).Click
        Delay 2000 , "Please Wait"
        Set objInformation =  objFourthPanel.Panel(12).Panel(2).Panel(0).Link(0).Panel(1)
        If objInformation.Exists Then
        'Right click on Check box to open Dialog
          objInformation.ClickR
          Delay 200       
          Set objTemp = Sys.Browser("iexplore").Page(strBrowserPage)
          Set objSeriesInfo = objTemp.Panel(9).TextNode(13)
          If Ucase(objSeriesInfo.contentText) = Ucase("Series Info") Then 
            objSeriesInfo.Click
            Delay 2000 , "Please Wait"
            Set objInfoDialog = objTemp.Panel(0).Panel(0).Panel(2).Panel(1).Panel(1).Panel(0).Panel(0).Panel(0).Panel(2).Panel(1)
            IntID = objInfoDialog.Panel(0).Panel(0).Panel(0).Panel(1).Panel(0).Panel(1).Panel(1).Panel(0).contentText   
            If objInfoDialog.Exists And IntID =  strSeriesID Then          
                strTCRemarks=strTCRemarks& "<br />" & "Series Id verified in Source/Layout/CDM/CDMNext"
                strTestCaseResult="PASS"  
                log.Message(intId&":"&strSeriesId) 
                'Close Dialog 
                objTemp.Panel(0).Panel(0).Panel(2).Panel(1).Panel(0).Panel(1).Panel(2).Click
                'Close CDMNEXt Web Page
                Set objLogoutPanel = Sys.Browser("iexplore").Page(strBrowserPage).Panel(0).Panel(0).Panel(0).Panel(0).Panel(0).Panel(0).Panel(3).Panel(0)
                Set objLogout = objLogoutPanel.Panel(2).Link(0).Panel(0).Panel(0).Click
                'Click on Signout link
                strLogout = objLogoutPanel.Panel(2).Panel(0).Panel(0).Link(6).contentText
                If Ucase(strLogout) = Ucase("Sign out") Then
                  objLogoutPanel.Panel(2).Panel(0).Panel(0).Link(6).Click
                  Exit For
                 End If 
                Else
                  strTCRemarks=strTCRemarks& "<br />" & "Series Id is not match Source/Layout and CDM and CDMNEXT"
                  strTestCaseResult="PASS"                              
             End IF
          End If
        End If
    End If
  Next 
  'Closing the Webpage
  Sys.Keys("~[F4]") 
  
  Set objPanel =Nothing
  Set ObjSecondPanel=Nothing
  Set ObjThirdPanel=Nothing
  Set objFourthPanel=Nothing
  Set objInformation=Nothing
  Set objTemp=Nothing
  Set objSeriesInfo=Nothing
  Set objInfoDialog=Nothing
  Set objLogoutPanel=Nothing
  Set objLogout=Nothing
End Sub

'###################################################################################################################################################################

'**************************************************************
' Purpose     : Project Team Scripts-Execution starts from this procedure. 
' Create      : 13/May/2019
' Module      : Layout
' Last Updated: 
'**************************************************************

'Open Layout Module
Sub sOpenLayout()  
  On Error Resume Next
  Dim objEdgeMDI,strTemp,objTemp
  'strEnvi = "Edge ( US Integration )"
  
  'Open The Layout Module  
    'Set objText = Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("TextBlock", "Layout", 1)
    'If objText.WPFControlText = "Layout" then 
     ' Log.Message "Layout Module is already Opened"
    'else
    
    strTemp = "WPFObject(""LayoutTreeListView"")" 
    Set objTemp = Sys.Process("EdgeClient").FindChild("Name", strTemp, 50, True)
    If objTemp.Exists  Then
      Log.Message "Layout Module is already opened." 
      Exit Sub 
    Else
      strTemp="WPFObject(""ContentControl"", ""Layout"", 1)"
      all sObjClick(strTemp)
      Delay 2000 , "Please wait Layout Module is opening "
      Set objText = Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("TextBlock", "Layout", 1)
      If objText.WPFControlText = "Layout" then 
       Log.Message "Layout Module is Opened"
      Else
        log.Message "Layout module could not able to open"
        strTestCaseResult="FAIL"
      End If
    End If
End Sub
  

'################################################################################################################################################################33
'Testcase:TC_LAYOUT_PRT01: Verify user rights for level1 folder
sub sLevel1Right(strParameters)

  On Error Resume Next 
  Dim objTemp, strTemp
  
  strLevle1=getSplitValue(strParameters,"Level1")
  
  'Open source module
  Call sOpenLayout()  
  Call sEdgeProcessor()
  
  'Select First Level folder
  Call sLayoutGridSelection(strParameters)
  
  
  ''Verify "NewLayout Topic is anabled or not to check user rights  
  strTemp = "WPFObject(""ContentControlEx"", ""New Layout Topic"", 2)"
  Set objTemp = Sys.Process("EdgeClient").FindChild("Name", strTemp, 50, True)
  If objTemp.Enabled Then 
    strTCRemarks = "New layout topic is enabled for level1 folder: " & strLevle1 & "and , user have all access right for corresponding db "
    log.message "New layout topic is enabled for level1 folder: " & strLevle1 & "and , user have all access right for corresponding db "
    strTestCaseResult="PASS"       
  Else
    strTCRemarks = "New layout topic is disabled for level1 folder: " & strLevle1 & "and , user have all certain access right for corresponding db "
    log.message "New layout topic is disabled for level1 folder: " & strLevle1 & "and , user have all certain access right for corresponding db "
    strTestCaseResult="PASS"      
  End If

  Set objTemp = Nothing 
  
  
End Sub
'################################################################################################################################################################33


'Fucntion to select the Grid in Layout module 
Function sLayoutGridSelection(strParameters)
'Function sLayoutGridSelection()
   On Error Resume Next
   
   Dim strTemp, objGridControl, IntCount(4)
   
   strLevel1=getSplitValue(strParameters,"Level1")
   strLevel2=getSplitValue(strParameters,"Level2")  
   strLevel3=getSplitValue(strParameters,"Level3")
'  strLevel3src_Name=getSplitValue(strParameters,"WORKSPACE")
'  strCategory=getSplitValue(strParameters,"CATEGORY")
'  strLevel = getSplitValue(strParameters,"LEVEL")
  strMultiLevel = getSplitValue(strParameters,"MultiLevel")

'    strLevel1 = "dX Non-Asia Database (Current Eng Version)" 
'    strLevel2 = "Test"
'    strLevel3 = "abb"
    'strLevle1= 
   
   
   
   strTemp = "WPFObject(""LayoutTreeListView"")"
   Set objGridControl = Sys.Process("EdgeClient").FindChild("Name", strTemp, 50, True)
   
   'Expanding First Node
   intTotNodeCnt=objGridControl.Nodes_2.Count  
   For intI=0 to intTotNodeCnt-1         
     If Ucase(objGridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strLevel1) then
        objGridControl.Nodes_2.Item(intI).ExpandAll               
         intRow=objGridControl.Nodes_2.Item(intI).get_RowHandle         
         Call sSelcetLayoutLevel(objGridControl, intRow)
         IntCount(0) = intI
         Delay 200           
      Exit For
    End If
   Next
   
   
   'Selceting the Second Level 
   'strLevle2=getSplitValue(strParameters,"Levle2")
   'msgbox strLevle2  
   intTotNodeCnt=objGridControl.Nodes_2.Item(intI).Nodes.Count
   For intJ=0 to intTotNodeCnt-1
    If Ucase(objGridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strLevel2) then        
        objGridControl.Nodes_2.Item(intI).ExpandAll       
        intRow=objGridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
        Call sSelcetLayoutLevel(objGridControl, intRow)
'         If  Ucase(Trim(strMultiLevel)) = Ucase(Trim("Yes"))Then   
'           SYS.Keys("!") 
'           Call objGridControl.SelectRowCore(intRow+1)
'         End If             
        IntCount(1) = intJ
        Delay 200     
      Exit For
    End If
   Next
  
   
   'Selecting the Third Level 
  intTotNodeCnt=objGridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count        
  For intK=0 to intTotNodeCnt-1
    If Ucase(objGridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description)=Ucase(strLevel3) then
      objGridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).ExpandAll      
          intRow =objGridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).get_RowHandle          
          Call sSelcetLayoutLevel(objGridControl, intRow)  
          IntCount(2) = intK
          Dealy 200       
      Exit For
    End If
   Next
        
   sLayoutGridSelection = IntCount
   Set objGridControl = Nothing 
  
End Function
'################################################################################################################################################################33

'Fucntion to select Level

Function sSelcetLayoutLevel(objGridControl, intRow)
  on Error Resume Next
  
  objGridControl.Keys "^[Home]"
  Call objGridControl.ClearSelectionCore
  Call objGridControl.FocusViewAndRow(objGridControl,intRow)
  objGridControl.SetFocusOnCurrentItem
  Call objGridControl.SelectRowCore(intRow) 
  
End Function

'################################################################################################################################################################33
'Testcase:TC_LAYOUT_PRT01: Verify user rights for level1 folder
Sub sNewLayoutTopic(strParameters)
'Sub sNewLayoutTopic()

  On Error Resume Next
  Dim strTemp, objTemp 
  
  
  strLevle1=getSplitValue(strParameters,"Level1")
  strDesc=getSplitValue(strParameters,"Desc")
  strDescLocal=getSplitValue(strParameters,"DescLocal")
  strTop=getSplitValue(strParameters,"Top")
  strSelectLevel2=getSplitValue(strParameters,"SelectLevel2")
   blnFlag = False
  
  
  'Open source module
  Call sOpenLayout()  
  Call sEdgeProcessor()
  
  'Select First Level folder which have right acess
  intRcnt =  sLayoutGridSelection(strParameters)
  
  'Click on "NewLayouttopic" button  
  strTemp = "WPFObject(""ContentControlEx"", ""New Layout Topic"", 2)"
  Call sObjClick(strTemp)
  Delay 200
  
  '.Input all the fields in the pop up .Check the 'Top' button of 'Insert After Layout' 
  
  Set objTemp = Sys.Process("EdgeClient").WPFObject("HwndSource: NewLayoutTopicPrompt", "New Layout (Level 2)").WPFObject("NewLayoutTopicPrompt", "New Layout (Level 2)", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContentOffset").WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("StackPanel", "", 1)
  Call objTemp.WPFObject("StackPanel", "", 2).WPFObject("TextEdit", "", 1).Click
  SYS.Keys strDesc
  Call objTemp.WPFObject("StackPanel", "", 3).WPFObject("TextEdit", "", 1).Click
  SYS.Keys strDescLocal
  Call objTemp.WPFObject("StackPanel", "", 5).WPFObject("ComboBoxEdit", "", 1).SetText("Both")
  
  If strTop = "Yes" Then 
    Call objTemp.WPFObject("StackPanel", "", 6).WPFObject("InsertLayoutAfterCheckEdit").set_IsChecked(TRUE)    
  Else
    'Call objTemp.WPFObject("StackPanel", "", 6).WPFObject("InsertLayoutAfterCheckEdit").set_IsChecked(TRUE)  
    Call objTemp.WPFObject("StackPanel", "", 6).WPFObject("InsertSourceAfterComboEdit").SetText(strSelectLevel2)
  End If
  
  
  'Click on Save Button
  
  strTemp= "WPFObject(""Button"", ""Save"", 1)"
  Set objTemp = Sys.Process("EdgeClient").WPFObject("HwndSource: NewLayoutTopicPrompt", "New Layout (Level 2)").FindChild("Name",strTemp,50,True)
  Call objTemp.Click  
  Call sEdgeProcessor()
  
  strTemp = "WPFObject(""LayoutTreeListView"")"
  Set objGridControl = Sys.Process("EdgeClient").FindChild("Name", strTemp, 50, True)
  
  If strTop = "Yes" And Ucase(objGridControl.Nodes_2.Item(intRcnt(0)).Nodes.Item(0).Content.Description)=Ucase(strDesc) Then        
      strTCRemarks = "New Folder is created under " & strLevle1 & " Level1Folder"
      log.message  "New Folder is created under " & strLevle1 & " Level1Folder"
      strTestCaseResult="PASS"
      blnFlag = True
  Else
    intTotNodeCnt=objGridControl.Nodes_2.Item(intRcnt(0)).Nodes.Count
    For intJ=0 to intTotNodeCnt-1
      If Ucase(objGridControl.Nodes_2.Item(intRcnt(0)).Nodes.Item(intJ).Content.Description)=Ucase(strDesc) Then
        If Ucase(objGridControl.Nodes_2.Item(intRcnt(0)).Nodes.Item(intJ-1).Content.Description)=Ucase(strSelectLevel2) Then
            strTCRemarks = "New Folder is created under " & strLevle1 & " Level1Folder"
            log.message  "New Folder is created under " & strLevle1 & " Level1Folder"
            strTestCaseResult="PASS"
            blnFlag = True
            Exit For
       End If  
     End If     
    Next    
  End If
    
   
  
  
  
  'Verify the Added Folder just below the Level1 folder
   If blnFlag = False then       
      strTCRemarks = "New Folder is not created"
      log.message  "New Folder is not created"
      strTestCaseResult="PASS" 
   End If
   
   Set objGridControl = nothing 
   
End Sub


'################################################################################################################################################################33
'Testcase:TC_LAYOUT_PRT05: Verify Open for view for new Workspace

Sub sOpenForViewLayout(strParameters)
'Function fOpenLayoutWorkspace()
  on Error Resume Next
  Dim strTemp, objTemp
  
  'strButton = getSplitValue(strParameters,"Button") 
      

  
   'Open source module
  Call sOpenLayout()  
  Call sEdgeProcessor()
  
  'Select the Required Folder
  
  Call sLayoutGridSelection(strParameters)
  
'  DescText=Replace(aqDateTime.Now,"/","-")
'  DescText=Replace(DescText,":","_") 
'  'DescLocalText = DescText

  ''Clicking on "New Workspace" Button and selecting "Open for Edit(Souce)" option 
  strTemp="WPFObject(""ContentControlEx"", ""New Workspace"", 2)"  
  Set objNewWorkspace=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,True)
  Call sObjClick(strTemp)
  strTemp= "WPFObject(""ContentControlEx"", ""Open For View"", 2)" 
  Call sObjClick(strTemp)
  Call sEdgeProcessor()
  
  'Close the Layout 
  Call sCloseSWV()
  
  'Select the required Grid
  Call sLayoutGridSelection(strParameters)
  Call sEdgeProcessor()
  
  strTemp = "WPFObject(""ContentControlEx"", ""Add Folder"", 2)"
  Call sObjClick(strTemp)
  Delay 200 
  
  strTemp = "WPFObject(""Button_OK"")"
  Set objTemp = Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "Workspace").FindChild("Name",strTemp,50,True)
  If objTemp.Exists Then 
    objTemp.Click
    strTCRemarks = "The Workspace is opened in View Only Mode"
    log.message  "The Workspace is opened in View Only Mode"
    strTestCaseResult="PASS"
    Call sCloseSWV()
  Else
    strTCRemarks = "The Workspace is opened in View Only Mode message did not dispaly"
    log.message  "The Workspace is opened in View Only Mode message did not dispaly"
    strTestCaseResult="FAIL"
    Call sCloseSWV()    
  End If
End Sub

'################################################################################################################################################################33
'Testcase:TC_LAYOUT_PRT06-9: Verify Open for Edit testcases

'Sub sOpenForEditLayout(strParameters)
''Sub sOpenForEditLayout()
'  On Error Resume Next
'  Dim strTemp, objTemp
'  
'   'Open source module
'  Call sOpenLayout()  
'  Call sEdgeProcessor()
'  
'  'Select the Required Folder  
'  Call sLayoutGridSelection(strParameters)
'  
'  DescText=Replace(aqDateTime.Now,"/","-")
'  DescText=Replace(DescText,":","_") 
'  
'  ''Clicking on "New Workspace" Button and selecting "Open for Edit(Souce)" option 
'  strTemp="WPFObject(""ContentControlEx"", ""New Workspace"", 2)"  
'  Set objNewWorkspace=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,True)
'  Call sObjClick(strTemp)
'  strTemp="WPFObject(""ContentControlEx"", ""Open For Edit"", 2)"  
'  Call sObjClick(strTemp)
'  'Call sEdgeProcessor()
'  
'   ''Waiting for Workspace Name prompt
'      strTemp="WPFObject(""HwndSource: WorkspaceNamePrompt"", ""Please provide a new Workspace Name"")"
'      Set objNewWrkSpace_Name=Sys.Process("EdgeClient").WaitChild(strTemp,60000)
'        If objNewWrkSpace_Name.Exists = True then
'          strTemp="WPFObject(""ChangeNameTextEdit"")"
'          ''Entering Workspace Name
'          Set objNewWrkSpace_Txtbox=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
'            If objNewWrkSpace_Txtbox.Exists = True then
'              If  Ucase(Trim(strTestCase_no)) = Ucase(Trim("TC_LAYOUT_PRT07"))Then
'                  strTemp = "WPFObject(""CancelButton"")"
'                  Set objTemp = objNewWrkSpace_Name. FindChild("Name",strTemp,9,True)
'                  Call objTemp.Click
'                  Delay 2000
'                  Set objTemp = Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2)
'                  'Set objTemp = Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2)
'                  If objTemp.Exists Then 
'                    strTCRemarks = "New Workspace is created"
'                    log.message "New Workspace is created"
'                    strTestCaseResult="FAIL"
'                  Else
'                    strTCRemarks = "New Workspace is not created"
'                    log.message "New Workspace is not created"
'                    strTestCaseResult="PASS"                    
'                  End if 
'                  Exit Sub 
'               End If
'              
'              objNewWrkSpace_Txtbox.Click
'              objNewWrkSpace_Txtbox.Text=DescText
'              ''Clicking on Ok Button 
'              strTemp="WPFObject(""OkButton"")"
'              Set objNewWrkSpace_okbtn=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
'              If objNewWrkSpace_okbtn.Exists = True then
'                objNewWrkSpace_okbtn.Click 
'                Call sEdgeProcessor()
'                Call sCloseSWV()              
'              End If
'            End If
'        End If
'    
'   'Verify Workspace is opened for Edit Mode
'  ' If  Ucase(Trim(strTestCase_no)) = Ucase(Trim("TC_LAYOUT_PRT05"))Then
'      
'      Set objTemp =  Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", "Edge ( US Integration )").WPFObject("Shell", "Edge ( US Integration )", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1)
'      If objTemp.Caption = "Layout Workspace (For Edit) - "& DescText then 
'          strTCRemarks = "The selected workspace is opened in Edit Mode"
'          log.message "The selected workspace is opened in Edit Mode"
'          strTestCaseResult="PASS"                   
'      Else
'          strTCRemarks = "The selected workspace is not opened in Edit Mode"
'          log.message "The selected workspace is not opened in Edit Mode"
'          strTestCaseResult="FAIL"                      
'      End If      
'      Call sCloseSWV()
'      Call sLayoutWorkSpacevwr() 
'      Exit Sub    
'   'End If
' 
'End Sub


'################################################################################################################################################################33
'Testcase:TC_LAYOUT_PRT06-8: Verify Open for Edit testcases

Function sOpenForEditLayout(strParameters)
'Sub sOpenForEditLayout()
  On Error Resume Next
  Dim strTemp, objTemp
     
  strExitScript =getSplitValue(strParameters,"ExitScript")
   'Open source module
  Call sOpenLayout()  
  Call sEdgeProcessor()
  Delay 2000 , "Please wait Layout Form is loading"
  
  'Select the Required Folder  
  Call sLayoutGridSelection(strParameters)
  
  DescText=Replace(aqDateTime.Now,"/","-")
  DescText=Replace(DescText,":","_") 
  ''strDescText = DescText
  
  ''Clicking on "New Workspace" Button and selecting "Open for Edit(Souce)" option 
  strTemp="WPFObject(""ContentControlEx"", ""New Workspace"", 2)"  
  Set objNewWorkspace=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,True)
  Call sObjClick(strTemp)
  strTemp="WPFObject(""ContentControlEx"", ""Open For Edit"", 2)"  
  Call sObjClick(strTemp)
  'Call sEdgeProcessor()
  
   ''Waiting for Workspace Name prompt
      strTemp="WPFObject(""HwndSource: WorkspaceNamePrompt"", ""Please provide a new Workspace Name"")"
      Set objNewWrkSpace_Name=Sys.Process("EdgeClient").WaitChild(strTemp,60000)
        If objNewWrkSpace_Name.Exists = True then
          strTemp="WPFObject(""ChangeNameTextEdit"")"
          ''Entering Workspace Name
          Set objNewWrkSpace_Txtbox=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
            If objNewWrkSpace_Txtbox.Exists = True then
              If  Ucase(Trim(strTestCase_no)) = Ucase(Trim("TC_LAYOUT_PRT07"))Then
                  strTemp = "WPFObject(""CancelButton"")"
                  Set objTemp = objNewWrkSpace_Name. FindChild("Name",strTemp,9,True)
                  Call objTemp.Click
                  Delay 2000
                  Set objTemp = Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2)
                  'Set objTemp = Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 2)
                  If objTemp.Exists Then 
                    strTCRemarks = "New Workspace is created"
                    log.message "New Workspace is created"
                    strTestCaseResult="FAIL"
                  Else
                    strTCRemarks = "New Workspace is not created"
                    log.message "New Workspace is not created"
                    strTestCaseResult="PASS"                    
                  End if 
                  Exit Function 
               End If
              
              objNewWrkSpace_Txtbox.Click
              objNewWrkSpace_Txtbox.Text=DescText
              ''Clicking on Ok Button 
              strTemp="WPFObject(""OkButton"")"
              Set objNewWrkSpace_okbtn=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
              If objNewWrkSpace_okbtn.Exists = True then
                objNewWrkSpace_okbtn.Click 
                Call sEdgeProcessor()
                Call sCloseSWV()     
                If  strExitScript = "YES" Then  
                  sOpenForEditLayout = DescText
                  Exit Function 
                End If       
              End If
            End If
        End If
    
   'Verify Workspace is opened for Edit Mode
  ' If  Ucase(Trim(strTestCase_no)) = Ucase(Trim("TC_LAYOUT_PRT05"))Then
      
      Set objTemp =  Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1)
      If objTemp.Caption = "Layout Workspace (For Edit) - "& DescText then 
          strTCRemarks = "The selected workspace is opened in Edit Mode"
          log.message "The selected workspace is opened in Edit Mode"
          strTestCaseResult="PASS"                   
      Else
          strTCRemarks = "The selected workspace is not opened in Edit Mode"
          log.message "The selected workspace is not opened in Edit Mode"
          strTestCaseResult="FAIL"                      
      End If      
      Call sCloseSWV()
      Call sLayoutWorkSpacevwr() 
      Exit Function    
   'End If   
End Function

'################################################################################################################################################################33
'Testcase:TC_LAYOUT_PRT09-10: Verify delete layout folder

Sub sDeleteFolderLayout(strParameters)

  On Error Resume Next  
  Dim strTemp, objTemp, blnFlag 
  blnFlag = True
  
  strAddFolderLevel2 =getSplitValue(strParameters,"AddFolderLevel2")
  
  
  ''create a folder before delete
  strDescText =  sOpenForEditLayout(strParameters)  
  
  
  intRcnt = sLayoutGridSelection(strParameters)
  Call sEdgeProcessor()
  Delay 2000 
  
    If Ucase(Trim(strTestCase_no)) = Ucase(Trim("TC_LAYOUT_PRT16")) Then
      
      strTemp="WPFObject(""LayoutTreeListView"")"
      Set objGrid =Sys.Process("EdgeClient").FindChild("Name",strTemp,50,True)
      intRowCnt = objGrid.Nodes_2.Item(intRcnt(0)).Nodes.Item(intRcnt(1)).Nodes.Item(intRcnt(2)).Nodes.Count   
      Set objCellText=objGrid.Nodes_2.Item(intRcnt(0)).Nodes.Item(intRcnt(1)).Nodes.Item(intRcnt(2)).Nodes.Item(intRowCnt-1)
      intRowNumber = objGrid.Nodes_2.Item(intRcnt(0)).Nodes.Item(intRcnt(1)).Nodes.Item(intRcnt(2)).Nodes.Item(intRowCnt-1).RowHandle
      Call objCellText.Content.set_DisabledFlag(False)
      Dealy 200    
      strText = "Disabled flag must be set to true because Parent is set to true" 
      Call sDiableFalgVarification(intRowNumber, strText)
      Exit Sub     
    End IF
  
  
  If  Ucase(Trim(strTestCase_no)) = Ucase(Trim("TC_LAYOUT_PRT14"))Then
    strTemp="WPFObject(""LayoutTreeListView"")"
    Set objGrid =Sys.Process("EdgeClient").FindChild("Name",strTemp,50,True)
    intRowCnt = objGrid.Nodes_2.Item(intRcnt(0)).Nodes.Item(intRcnt(1)).Nodes.Count  
    Set objCellText=objGrid.Nodes_2.Item(intRcnt(0)).Nodes.Item(intRcnt(1)).Nodes.Item(intRowCnt-1)
    Call objCellText.Content.set_DisabledFlag(False)
    Delay 500
    strText = "The folder must be disabled since all folders /series underneath are disabled"
    Call sDiableFalgVarification(2, strText)
    Exit Sub       
    
  End If

  
  strTemp = "WPFObject(""ContentControlEx"", ""Add Folder"", 2)"
  Call sObjClick(strTemp)
  Delay 1000 
  
  
  If Ucase(strAddFolderLevel2) = "YES" Then  
   strDxFileName =getSplitValue(strParameters,"DxFileName")
    
    strTemp="WPFObject(""LayoutTreeListView"")"
    Set objGrid =Sys.Process("EdgeClient").FindChild("Name",strTemp,50,True)
    intRowCnt = objGrid.Nodes_2.Item(intRcnt(0)).Nodes.Item(intRcnt(1)).Nodes.Count 
    Set objCellText=objGrid.Nodes_2.Item(intRcnt(0)).Nodes.Item(intRcnt(1)).Nodes.Item(intRowCnt-1)
    intRowNumber = objGrid.Nodes_2.Item(intRcnt(0)).Nodes.Item(intRcnt(1)).Nodes.Item(intRowCnt-1).RowHandle
    Call objCellText.Content.set_Description(strDescText)    
    Call objCellText.Content.set_DescriptionLocal(strDescText)  
    If  Ucase(Trim(strTestCase_no)) = Ucase(Trim("TC_layout_PRT11"))Then 
      'Verify Disabled Flag
      Delay 2000 
      strText = "Disabled flag must be set to true because there are no layout series attached"
      Call sDiableFalgVarification(intRowNumber, strText)
      Exit Sub      
    End If
    Call objCellText.Content.set_DisabledFlag(True)
    Call objCellText.Content.set_DxFileNm(strDxFileName)
    ''Upload Workspace
    Call fUploadWorkSpace() 
    Call sEdgeProcessor()  
    
    
     'Open source module
      Call sOpenLayout()  
      Call sEdgeProcessor()
  
      'Select the Required Folder  
      intRCnt =  sLayoutGridSelection(strParameters)
  
      strTemp="WPFObject(""LayoutTreeListView"")"  
      Set objGrid =Sys.Process("EdgeClient").FindChild("Name",strTemp,50,True)
      intRowcnt = objGrid.Nodes_2.Item(intRcnt(0)).Nodes.Item(intRcnt(1)).Nodes.Count
      
      For intI = 0 to intRowCnt-1
        If Ucase(objGrid.Nodes_2.Item(intRcnt(0)).Nodes.Item(intRcnt(1)).Nodes.Item(IntI).Content.Description)=Ucase(strDescText) then
          blnFlag = True
          Exit For
        End If
      Next
      
       If blnFlag = True Then 
          strTCRemarks = "Level3 Folder is Added"
          log.message "Level3 Folder is Added"
          strTestCaseResult="PASS" 
        Else
          strTCRemarks = "Level3 Folder is not Added"
          log.message "Level3 Folder is not Added"
          strTestCaseResult="FAIL"            
        End if
        Exit sub       
  End If
  
  strTemp="WPFObject(""LayoutTreeListView"")"
  Set objGrid =Sys.Process("EdgeClient").FindChild("Name",strTemp,50,True)
  intRowCnt = objGrid.Nodes_2.Item(intRcnt(0)).Nodes.Item(intRcnt(1)).Nodes.Item(intRcnt(2)).Nodes.Count   
  Set objCellText=objGrid.Nodes_2.Item(intRcnt(0)).Nodes.Item(intRcnt(1)).Nodes.Item(intRcnt(2)).Nodes.Item(intRowCnt-1)
  intRowNumber = objGrid.Nodes_2.Item(intRcnt(0)).Nodes.Item(intRcnt(1)).Nodes.Item(intRcnt(2)).Nodes.Item(intRowCnt-1).RowHandle
  Call objCellText.Content.set_Description(DescText)    
  Call objCellText.Content.set_DescriptionLocal(DescText)
  
  If  Ucase(Trim(strTestCase_no)) = Ucase(Trim("TC_layout_PRT15"))Then 
      'Verify Disabled Flag
      Delay 2000    
      strText ="Disabled flag must be set to true because there are no layout series attached "  
      Call sDiableFalgVarification(intRowNumber, strText)     
      Exit Sub      
    End If
  
  Call objCellText.Content.set_DisabledFlag(True)
  
  If  Ucase(Trim(strTestCase_no)) = Ucase(Trim("TC_layout_PRT13"))Then     
    Set objTemp = Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("LayoutTreeListControl").WPFObject("LayoutTreeListView").WPFObject("HierarchyPanel", "", 1).WPFObject("RowControl", "", Cint(intRowNumber)+1).WPFObject("CellsControl", "", 1).WPFObject("LightweightCellEditor", "", 1).WPFObject("InplaceBaseEdit", "", 1).WPFObject("EditorControlStub", "", 1).WPFObject("StateIndicatorControl", "", 1).WPFObject("LampRedStatePresentationControl", "", 1)
    If objTemp.Exists = False Then 
      strTCRemarks = "Red Dot Validation is not displayed as Disable Flag is set to True" 
      log.message "Red Dot Validation is not displayed as Disable Flag is set to True" 
      strTestCaseResult="PASS" 
    Else
      strTCRemarks = "Red Dot Validation is  displayed even after Disable Flag is set to True" 
      log.message "Red Dot Validation is  displayed even after Disable Flag is set to True" 
      strTestCaseResult="FAIL"      
    End If
    
    'clean Up
      Call sCloseWithYes(1299)
      Delay 1000
      Call sLayoutWorkSpacevwr() 
      Exit Sub
      
  End If
  
  
  
  
  ''Upload Workspace
  Call fUploadWorkSpace() 
  Call sEdgeProcessor() 
  
  
  ''Open Folder for Delete Folder
  Call sOpenForEditLayout(strParameters)  
  IntRCnt = sLayoutGridSelection(strParameters)
  
  strTemp="WPFObject(""LayoutTreeListView"")"  
  Set objGrid =Sys.Process("EdgeClient").FindChild("Name",strTemp,50,True)
  
  intRowCnt = objGrid.Nodes_2.Item(intRcnt(0)).Nodes.Item(intRcnt(1)).Nodes.Item(intRcnt(2)).Nodes.Count
  
  For intI = 0 to intRowCnt-1
    If Ucase(objGrid.Nodes_2.Item(intRcnt(0)).Nodes.Item(intRcnt(1)).Nodes.Item(intRcnt(2)).Nodes.Item(intI).Content.Description)=Ucase(strDescText) then
          ''objGrid.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).ExpandAll      
          intRow =objGrid.Nodes_2.Item(intRcnt(0)).Nodes.Item(intRcnt(1)).Nodes.Item(intRcnt(2)).Nodes.Item(intI).get_RowHandle          
          Call sSelcetLayoutLevel(objGrid, intRow)
          Call sEdgeProcessor()
          strTemp = "WPFObject(""ContentControlEx"", ""Delete Folder"", 2)"
          Call sObjClick(strTemp)
          Delay 1000 
          Call Aliases.EdgeClient.HwndSource_WindowContentHolder6.WindowContentHolder.NonLogicalDecorator.ThemedManagedContentPresenter.Grid.DXMessageBox.Click(245, 58)
          Delay 1000 
          Exit For             
      End IF
  Next
  
    
  ''Upload Workspace
  Call fUploadWorkSpace() 
  Call sEdgeProcessor()
  
   'Open source module
  Call sOpenLayout()  
  Call sEdgeProcessor()
  
  'Select the Required Folder  
  intRCnt =  sLayoutGridSelection(strParameters)
  
  strTemp="WPFObject(""LayoutTreeListView"")"  
  Set objGrid =Sys.Process("EdgeClient").FindChild("Name",strTemp,50,True)
  
  intRowCnt = objGrid.Nodes_2.Item(intRcnt(0)).Nodes.Item(intRcnt(1)).Nodes.Item(intRcnt(2)).Nodes.Count
  
  For intI = 0 to intRowCnt-1
    If Ucase(objGrid.Nodes_2.Item(intRcnt(0)).Nodes.Item(intRcnt(1)).Nodes.Item(intRcnt(2)).Nodes.Item(intI).Content.Description)=Ucase(strDescText) then
      blnFlag = False
      Exit For
    End If
  Next
  
  If blnFlag = True Then 
    strTCRemarks = "Level4 Folder is deleted"
    log.message "Level4 Folder is deleted"
    strTestCaseResult="PASS" 
  Else
    strTCRemarks = "Level4 Folder is not deleted"
    log.message "Level4 Folder is not deleted"
    strTestCaseResult="FAIL"            
  End if
  
End Sub

'######################################################################################################################################

''Fucntion to veify Disable Flag

Function sDiableFalgVarification(intRowNumber, strText)

  on Error Resume Next
  
  Delay 2000       
      Set objTemp = Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("LayoutTreeListControl").WPFObject("LayoutTreeListView").WPFObject("HierarchyPanel", "", 1).WPFObject("RowControl", "", Cint(intRowNumber)+1).WPFObject("CellsControl", "", 1).WPFObject("LightweightCellEditor", "", 1).WPFObject("InplaceBaseEdit", "", 1).WPFObject("EditorControlStub", "", 1).WPFObject("StateIndicatorControl", "", 1).WPFObject("LampRedStatePresentationControl", "", 1)
      If objTemp.Exists Then 
          objTemp.HoverMouse
          Delay 200
          Set PicObj = Utils.Picture
          Set PicObj = Sys.Desktop.ActiveWindow.Picture() 
          PicObj.SavetoFile(strLogFolder & "Screenshots\" & strTestCase_No &  "_" & picCount & ".jpg") 
          strTCRemarks =  strText & "  message displayed" 
          log.message strText & "  message displayed" 
          strTestCaseResult="PASS" 
      Else
          PicObj.SavetoFile(strLogFolder & "Screenshots\" & strTestCase_No &  "_" & picCount & ".jpg") 
          strTCRemarks = strText & "  message is not displayed" 
          log.message strText & "  message is not displayed" 
          strTestCaseResult="FAIL"      
      End If
      
      'clean Up
      Call sCloseWithYes(1299)
      Delay 1000
      Call sLayoutWorkSpacevwr() 
  
End Function

'######################################################################################################################################33
'TestCases to verify Copyfolder and Paste Above, below

Sub sCopyLayoutFolder(strParameters)

  On Error Resume Next
  Dim strTemp, objGridControl, objTemp, blnFlag, newSourceName, intTotNodeCnt, intSeriesID(0), strSourceName(3)
  Dim IntRowNumber(4)
 
  strLevel1=getSplitValue(strParameters,"Level1")
  strLevel2=getSplitValue(strParameters,"Level2") 
  strLevel3=getSplitValue(strParameters,"Level3")
  strLevel4=getSplitValue(strParameters,"Level4")
     
  strPasteOption = getSplitValue(strParameters,"PASTEOPTION")
  strCopyOption= getSplitValue(strParameters,"COPYOPTION")  
  strWithSeries = getSplitValue(strParameters,"WITHSERIES")
  strFolderCount=getSplitValue(strParameters,"FolderCount")  
  strLevel = getSplitValue(strParameters,"LEVEL")
  strCategory = getSplitValue(strParameters,"Category")
  blnFlag = False
  
  
  Redim intSeriesID(Cint(strFolderCount))
  
  ''Select  level2 layout folder  and 'Open for Edit(layout)'
  Call sOpenForEditLayout(strParameters)  
  Call sEdgeProcessor()
  Delay 2000 
  
    
  'Expand the layout tree then select level4 layout folder
  IntRowNumber(0) = sLayoutLevel1GridSelection(strParameters)  
  IntRowNumber(1) = sLayoutLevel2GridSelection(strParameters,IntRowNumber(0))
  IntRowNumber(2) = sLayoutLevel3GridSelection(strParameters,IntRowNumber(0),IntRowNumber(1))  
  IntRowNumber(3)=  sLayoutLevel4GridSelection(strParameters,IntRowNumber(0),IntRowNumber(1),IntRowNumber(2))
  Call sEdgeProcessor()       
  
   
   Set objSeriesPanel = Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("LayoutSeriesViewControl").WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("LayoutSeriesGridControl").WPFObject("LayoutSeriesTableView")
   
  
  'Select the Required Number of rows to copy. 
  X=0
  Y=0 
   Delay 2000, "Pls Wait ..."
    If strFolderCount >1 Then       
        For I = 1 to strFolderCount-1          
          If Ucase(strWithSeries) = Ucase("Yes") Then
            intSeriesID(X) = objSeriesPanel.DataContext.Item(Y).SeriesId  
             X=X+1   
           End IF           
            SYS.Keys("![Down]") 
            Delay 1000
            Select Case strLevel
                   Case 2
                    IntRowNumber(1) = IntRowNumber(1)+1
                    intRowCount = IntRowNumber(1) 
                    'msgbox intRowCount
                   Case 3                            
                    IntRowNumber(2) = IntRowNumber(2)+1
                    intRowCount = IntRowNumber(2)  
                   Case 4              
                    IntRowNumber(3) = IntRowNumber(3)+1
                    intRowCount = IntRowNumber(3)
                   'msgbox intRowCount         
            End Select       
        Next  
    ElseIf strFolderCount = 1 Then 
          If Ucase(strWithSeries) = Ucase("Yes") Then
           intSeriesID(X) = objSeriesPanel.DataContext.Item(Y).SeriesId  
           'X=X+1
         End IF 
         Select Case strLevel
               Case 2
                 intRowCount = IntRowNumber(1) 
               Case 3
                  intRowCount = IntRowNumber(2) 
               Case 4
                  intRowCount = IntRowNumber(3)                                 
         End Select         
    End If
    
    'msgbox intRowCount  
    
    'Get the Row Count as per Paste above /Below               
    If strFolderCount > 0 And (Ucase(strCategory) = Ucase("Below"))  Then
      Select Case strLevel
             Case 2
                  IntRowNumber(1) = IntRowNumber(1)+1
                  intRowCount = IntRowNumber(1)
             Case 3
                  IntRowNumber(2) = IntRowNumber(2)+1
                  intRowCount = IntRowNumber(2)
                  'msgbox intRowCount  
             Case 4
                  IntRowNumber(3) = IntRowNumber(3)+1
                  intRowCount = IntRowNumber(3)               
      End Select             
    ElseIf strFolderCount < 0 Then 
       strTCRemarks = "'Copy' and 'Paste Below' Fucntionality requires atleast one folder to copy"
       strTestCaseResult="FAIL" 
       Exit Sub 
    End If
    
    'Copy and Paste selected Folder
   Call sCopyPaste(strCopyOption,strPasteOption)
   Delay 500
   P= 0
   
   strTemp = "WPFObject(""LayoutTreeListView"")"
   Set objGridControl = Sys.Process("EdgeClient").FindChild("Name", strTemp, 50, True)  
   
   'Amend The Description and Description Local Name   
   If Ucase(strCategory) = Ucase("Above") OR  Ucase(strCategory) = Ucase("Below")Then
    For J = 0 to strFolderCount-1 
        'intNewNumber = Minute(Time) + Second(Time) + J 
          DescText=Replace(aqDateTime.Now,"/","-")
          intNewNumber =Replace(DescText,":","_")         
          intNewNumber1 = left(intNewNumber,1)+ Minute(Time) + Second(Time) + J &"-" &intNewNumber
        If strLevel = 2 Then          
            intLen= Len(strLevel2Source)-Instr(strLevel2Source, "-")             
            newSourceName =  Replace(strLevel2Source ,Right(strLevel2Source ,intLen), intNewNumber1)       
            Delay 200       
            Call objGridControl.Nodes_2.Item(IntRowNumber(0)).Nodes.Item(IntRowNumber(1)).Content.set_Description(newSourceName)
            Delay 200  
            Call objGridControl.Nodes_2.Item(IntRowNumber(0)).Nodes.Item(IntRowNumber(1)).Content.set_DescriptionLocal(newSourceName)
            Delay 200  
            Call objGridControl.Nodes_2.Item(IntRowNumber(0)).Nodes.Item(IntRowNumber(1)).Content.set_SourceCode(newSourceName) 
            Delay 200  
            strName(P) =  newSourceName 
            IntRowNumber(1) = IntRowNumber(1)+1 
            P=P+1
            Delay 500         
        ElseIf  strLevel = 3 Then 
            intLen= Len(strLevel3Source)-Instr(strLevel3Source, "-")
            newSourceName =  Replace(strLevel3Source ,Right(strLevel3Source ,intLen), intNewNumber1) 
            Delay 200
            Call objGridControl.Nodes_2.Item(IntRowNumber(0)).Nodes.Item(IntRowNumber(1)).Nodes.Item(IntRowNumber(2)).Content.set_Description(newSourceName)
            Delay 200
            Call objGridControl.Nodes_2.Item(IntRowNumber(0)).Nodes.Item(IntRowNumber(1)).Nodes.Item(IntRowNumber(2)).Content.set_DescriptionLocal(newSourceName) 
            strName(P) =  newSourceName 
            IntRowNumber(2) = IntRowNumber(2)+1 
            P=P+1
            Delay 500     
        ElseIf  strLevel = 4 Then 
            intLen= Len(strLevel4)-Instr(strLevel4, "-")
            newSourceName =  Replace(strLevel4 ,Right(strLevel4 ,intLen), intNewNumber1) 
            Delay 200
            Call objGridControl.Nodes_2.Item(IntRowNumber(0)).Nodes.Item(IntRowNumber(1)).Nodes.Item(IntRowNumber(2)).Nodes.Item(IntRowNumber(3)).Content.set_Description(newSourceName)
            Delay 200
            Call objGridControl.Nodes_2.Item(IntRowNumber(0)).Nodes.Item(IntRowNumber(1)).Nodes.Item(IntRowNumber(2)).Nodes.Item(IntRowNumber(3)).Content.set_DescriptionLocal(newSourceName) 
            strName(P) =  newSourceName 
            IntRowNumber(3) = IntRowNumber(3)+1 
            P=P+1
            Delay 500    
       End If               
    Next
   End IF
      
   If Ucase(strWithSeries) = Ucase("Yes") Then   
       'msgbox strSourceName(0)
      
       intTotNodeCnt=objGridControl.Nodes_2.Item(IntRowNumber(0)).Nodes.Item(IntRowNumber(1)).Nodes.Item(IntRowNumber(2)).Nodes.Count  
       For intK=0 to intTotNodeCnt-1  
          If Ucase(objGridControl.Nodes_2.Item(IntRowNumber(0)).Nodes.Item(IntRowNumber(1)).Nodes.Item(IntRowNumber(2)).Nodes.Item(intK).Content.Description)=Ucase(strName(0)) then
          intRow=objGridControl.Nodes_2.Item(IntRowNumber(0)).Nodes.Item(IntRowNumber(1)).Nodes.Item(IntRowNumber(2)).Nodes.Item(intK).get_RowHandle
            objGridControl.Keys "^[Home]"
            Call objGridControl.ClearSelectionCore
            Call objGridControl.FocusViewAndRow(objGridControl,intRow)
            objGridControl.SetFocusOnCurrentItem        
            Call objGridControl.SelectRowCore(intRow) 
            Delay 2000, "Please Wait"         
            'Call objGridControl.SelectRowCore(intRow-1)
            'IntRowNumber(1) =intJ        
            Exit For
        End If 
       Next
   
    newSeriesCount = 0 
    
     For I = 0 to strFolderCount-1             
              intNewSeriesID(I) = objSeriesPanel.DataContext.Item(Y).SeriesId
               If intNewSeriesID(I) = intSeriesID(I) Then
                  newSeriesCount = newSeriesCount+1    
                  SYS.Keys("[Down]") 
                  Delay 1000                     
                End If
          Next        
       
         Delay 200
         If newSeriesCount = Cint(strFolderCount) Then 
           strTCRemarks = "All Series are Copied Correctly" & "<br />" 
           log.message "All Series are Copied Correctly" 
           strTestCaseResult="PASS"
        Else
          strTCRemarks = "All Series are Not Copied Correctly" & "<br />" 
          strTestCaseResult="FAIL" 
          Exit Sub  
        End If
      
   End If
    'Save and Verify Copied/Cut Folder
   Call sSaveAndVerifyCopyLayout(strParameters,IntRowNumber)
    
    
  
End Sub
'###############################################################################################################################

'Fucntion to selvet level1 in layout module

Function sLayoutLevel1GridSelection(strParameters)
'Function sLayoutLevel1GridSelection()
  On Error Resume Next   
  Dim strTemp, objGridControl, IntCount
   
   strLevel1=getSplitValue(strParameters,"Level1")
   'strLevel1 = "dX Non-Asia Database (Current Eng Version)"
   
   strTemp = "WPFObject(""LayoutTreeListView"")"
   Set objGridControl = Sys.Process("EdgeClient").FindChild("Name", strTemp, 50, True)
   
   'Expanding First Node
   intTotNodeCnt=objGridControl.Nodes_2.Count  
   For intI=0 to intTotNodeCnt-1         
     If Ucase(objGridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strLevel1) then
        'objGridControl.Nodes_2.Item(intI).ExpandAll               
         intRow=objGridControl.Nodes_2.Item(intI).get_RowHandle         
         Call sSelcetLayoutLevel(objGridControl, intRow)         
         Delay 200           
      Exit For
    End If
   Next 
   sLayoutLevel1GridSelection = IntI
   Set objGridControl = Nothing   
   
   
End Function


'###############################################################################################################################

'Fucntion to selvet level2 in layout module
Function sLayoutLevel2GridSelection(strParameters,intI)
'Function sLayoutLevel2GridSelection()
  On Error Resume Next   
  Dim strTemp, objGridControl, IntCount 
  
   strLevel2=getSplitValue(strParameters,"Level2") 
   strMultiLevel =  getSplitValue(strParameters,"MultiLevel") 
   
   'strLevel2 = "CopyFolder"   
   strTemp = "WPFObject(""LayoutTreeListView"")"
   Set objGridControl = Sys.Process("EdgeClient").FindChild("Name", strTemp, 50, True)
   
     
    'Selceting the Second Level 
  intTotNodeCnt=objGridControl.Nodes_2.Item(intI).Nodes.Count
   For intJ=0 to intTotNodeCnt-1
    If Ucase(objGridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strLevel2) then        
        objGridControl.Nodes_2.Item(intI).ExpandAll       
        intRow=objGridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
        Call sSelcetLayoutLevel(objGridControl, intRow)
         If  Ucase(Trim(strMultiLevel)) = Ucase(Trim("Yes"))Then   
           SYS.Keys("!") 
           Call objGridControl.SelectRowCore(intRow+1)
         End If        
        Delay 200     
      Exit For
    End If
   Next
   
   'msgbox IntJ
   sLayoutLevel2GridSelection = IntJ
   Set objGridControl = Nothing 
  
   
End Function
'##########################################################################################################################
'Fucntion to selvet level3 in layout module
Function sLayoutLevel3GridSelection(strParameters, IntI, IntJ)
  On Error Resume Next   
  Dim strTemp, objGridControl
  
  strLevel3=getSplitValue(strParameters,"Level3") 
  strLevel3FisrtFolder=getSplitValue(strParameters,"Level3FisrtFolder") 
  If strLevel3FisrtFolder <> "" And strLevel3 = "" Then 
    strLevel3 = strLevel3FisrtFolder
  End If
  
  strMultiLevel =  getSplitValue(strParameters,"MultiLevel") 
   
  'strLevel3 = "Level3Folder2"
  
   strTemp = "WPFObject(""LayoutTreeListView"")"
   Set objGridControl = Sys.Process("EdgeClient").FindChild("Name", strTemp, 50, True)
  
  'Selecting the Third Level 
  intTotNodeCnt=objGridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count        
  For intK=0 to intTotNodeCnt-1
    If Ucase(objGridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description)=Ucase(strLevel3) then
      objGridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).ExpandAll      
          intRow =objGridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).get_RowHandle          
          Call sSelcetLayoutLevel(objGridControl, intRow)         
          Dealy 200       
      Exit For
    End If
   Next
   
   'msgbox IntK
   sLayoutLevel3GridSelection = IntK
   Set objGridControl = Nothing        
  
End Function 



'##########################################################################################################################
'Fucntion to selvet level4 in layout module
Function sLayoutLevel4GridSelection(strParameters,IntI,IntJ,IntK)
  On Error Resume Next   
  Dim strTemp, objGridControl
  
  strLevel4=getSplitValue(strParameters,"Level4") 
  strMultiLevel =  getSplitValue(strParameters,"MultiLevel") 
  'strLevel4 = "Level4Folder3"
  
   strTemp = "WPFObject(""LayoutTreeListView"")"
   Set objGridControl = Sys.Process("EdgeClient").FindChild("Name", strTemp, 50, True)
  
  'Selecting the Third Level 
  intTotNodeCnt=objGridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Nodes.Count        
  For intL=0 to intTotNodeCnt-1
    If Ucase(objGridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Nodes.Item(intL).Content.Description)=Ucase(strLevel4) then
      objGridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Nodes.Item(intL).ExpandAll      
      intRow =objGridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Nodes.Item(intL).get_RowHandle          
      Call sSelcetLayoutLevel(objGridControl, intRow)   
      Delay 200
      If  Ucase(Trim(strMultiLevel)) = Ucase(Trim("Yes"))Then   
           SYS.Keys("!") 
           Call objGridControl.SelectRowCore(intRow+1)
         End If        
       Delay 200       
      Exit For
    End If
   Next
   
   'msgbox IntL
   sLayoutLevel4GridSelection = IntL
   Set objGridControl = Nothing        
  
End Function 

'######################################################################################################################################

'Procedure to Select Multilevel

Sub sLevel4Selector()

  On Error Resume Next
  Dim Row(4)
  Row(0) = sLayoutLevel1GridSelection(strParameters) 
  Row(1) = sLayoutLevel2GridSelection(strParameters,Row(0)) 
  Row(2) = sLayoutLevel3GridSelection(strParameters,Row(0),Row(1)) 
  Row(3)=  sLayoutLevel4GridSelection(strParameters,Row(0),Row(1),Row(2)) 
  Delay 2000
End Sub



'#####################################################################################################################################
Sub sSaveAndVerifyCopyLayout(strParameters,IntRowNumber)

On Error Resume Next
Delay 2000, "Please Wait"

    Dim intTotNodeCnt, strFolderCount ,strText , strCategory , strLevel

    strFolderCount=getSplitValue(strParameters,"FolderCount")
    strText =getSplitValue(strParameters,"DISPLAYTEXT") 
    strCategory =getSplitValue(strParameters,"CATEGORY")
    strLevel = getSplitValue(strParameters,"LEVEL")   
    
    blnFlag = False


   'Save the Workspace
    Call fSaveWorkspace() 
    Call sEdgeProcessor()         
    Call sCloseSWV() 
    
   ' Open the Saved Workspace from Source Workspace Viewer         
    Call sOpenLayoutViewrWS()
    Call sEdgeProcessor()  
    Delay 2000       
  
    strTemp="WPFObject(""LayoutTreeListView"")"      
    Set objGridControl = Sys.Process("EdgeClient").FindChild("Name", strTemp, 50, True) 
    
   strTemp = "WPFObject(""ContentControlEx"", ""Expand All"", 2)" 
   call sObjClick(strTemp)
       
    'Verify the copy and paste changed have been saved.
    P= 0
    If Ucase(strCategory) = Ucase("Above") OR  Ucase(strCategory) = Ucase("Below")Then  
    Select Case strLevel 
        Case 2
          intTotNodeCnt=objGridControl.Nodes_2.Item(IntRowNumber(0)).Nodes.Count
          For intJ = 0 to intTotNodeCnt-1
             If Ucase(objGridControl.Nodes_2.Item(IntRowNumber(0)).Nodes.Item(intJ).Content.Description)= Ucase(strName(P)) Then
                blnFlag= True  
                DescText = strName(P)
                P = P+1  
                Delay 200
             End If
          Next
        Case 3
          intTotNodeCnt=objGridControl.Nodes_2.Item(IntRowNumber(0)).Nodes.Item(IntRowNumber(1)).Nodes.Count
           For intK = 0 to intTotNodeCnt-1
             If Ucase(objGridControl.Nodes_2.Item(IntRowNumber(0)).Nodes.Item(IntRowNumber(1)).Nodes.Item(intK).Content.Description)= Ucase(strName(P))Then 
                 blnFlag= True  
                 DescText = strName(P)
                 P = P+1  
                 Delay 200        
              End IF 
            Next   
        Case 4
          intTotNodeCnt=objGridControl.Nodes_2.Item(IntRowNumber(0)).Nodes.Item(IntRowNumber(1)).Nodes.Item(IntRowNumber(2)).Nodes.Count
           For intK = 0 to intTotNodeCnt-1
             If Ucase(objGridControl.Nodes_2.Item(IntRowNumber(0)).Nodes.Item(IntRowNumber(1)).Nodes.Item(IntRowNumber(2)).Nodes.Item(intK).Content.Description)= Ucase(strName(P))Then 
                 blnFlag= True  
                 DescText = strName(P) 
                 P =P+1               
                 Delay 200 
                 'if intK = strFolderCount then 
                  'Exit For
                 'End If        
              End IF 
               
            Next 
          End Select    
     End If 
    
      intTotNodeCnt=objGridControl.Nodes_2.Item(IntRowNumber(0)).Nodes.Item(IntRowNumber(1)).Nodes.Item(IntRowNumber(2)).Nodes.Count
      If Ucase(strCategory) = Ucase("Inside") Then      
        For intK = 0 to intTotNodeCnt-1
           If Ucase(objGridControl.Nodes_2.Item(IntRowNumber(0)).Nodes.Item(IntRowNumber(1)).Nodes.Item(IntRowNumber(2)).Nodes.Item(intK).Content.Description)= Ucase(strName(P)) Then 
              blnFlag= True  
              DescText = strName(P)
              P = P+1  
              Delay 200         
          End IF   
        Next
       End IF
       
     
    'Verify Modified Rows are displayed or Not
      'msgbox strName(P-1)
      If blnFlag= True And P = CInt(strFolderCount)  Then 
        strTCRemarks = strTCRemarks & strText & " Fucntionality is working as expected"
        strTestCaseResult="PASS"
      Else
         strTCRemarks = strTCRemarks & strText & " Fucntionality is not working as expected"
         strTestCaseResult="FAIL"  
      End If 
     
End Sub

'********************************************************************************************************************************************************************8
'Function to Open Workspace form Layout workspace viwer

Sub sOpenLayoutViewrWS()

  On Error Resume Next
  
  'Click on Layout Workspace Viewr Butto   
   strTemp = "WPFObject(""ContentControl"", ""Layout Workspace"", 1)"
   Call sObjClick(strTemp)
   Call sEdgeProcessor()
      
   ''Selecting Workspace to open 
   strTemp="WPFObject(""PendingChangeGridControl"")"
   Set objGridControl=Sys.Process("EdgeClient").FindChild("Name",strTemp,60,True)
   
   Call objGridControl.ClickCell(0, "Workspace Name")
   Delay 100
   
   strTemp = "WPFObject(""ContentControlEx"", ""Open Workspace"", 2)"
   Call sObjClick(strTemp)   
   Call sEdgeProcessor()
   Delay 500 
   Call sCloseSWV()     
End Sub



''****************************************************************************************************************************************************************
'Testcase :TC_Layout_PRT20/*:Verify Copy Folder and Paste Above/Below/Inside Layout folder/Folders

Sub sDiffentLevel3CopyLayoutFolder(strParameters)
'Sub sDiffentLevel3CopyLayoutFolder()

  On Error Resume Next
   Dim strTemp, objGridControl, objTemp, blnFlag, newSourceName,  intTotNodeCnt
   Dim IntRowNumber(4)
  
  
   strLevel1 = getSplitValue(strParameters,"SOURCE")
   strLevel2 = getSplitValue(strParameters,"Level2Source")   
   strMultiLevel = getSplitValue(strParameters,"MultiLevel") 
   strCategory =getSplitValue(strParameters,"CATEGORY") 
    
   'Open The Layout Module
    Call sOpenLayout() 
    Call sEdgeProcessor()
    Delay 2000 , "Please wait Layout Form is loading"
  
    'Call sGridSelection(strParameters) 
    
    strTemp = "WPFObject(""LayoutTreeListView"")"
    Set objGridControl = Sys.Process("EdgeClient").FindChild("Name", strTemp, 50, True)
    
    'Expand the layout tree then select level4 layout folder
     intTotNodeCnt=objGridControl.Nodes_2.Count  
     For intI=0 to intTotNodeCnt-1         
     If Ucase(objGridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strLevel1)  Then
         intRow=objGridControl.Nodes_2.Item(intI).get_RowHandle         
         Call sSelcetLayoutLevel(objGridControl, intRow)         
         Delay 200           
         Exit For
     End If
    Next 
   IntRowNumber(0) = IntI   
   Sys.Keys "[Enter]"     
   Call sEdgeProcessor()
   Delay 2000 
   
   
   'Select the two Level2 Folder 
   
   intTotNodeCnt=objGridControl.Nodes_2.Item(intI).Nodes.Count
   For intJ=0 to intTotNodeCnt-1
    If Ucase(objGridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strLevel2) then  
        intRow=objGridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
        Call sSelcetLayoutLevel(objGridControl, intRow)
         If  Ucase(Trim(strMultiLevel)) = Ucase(Trim("Yes"))Then   
           SYS.Keys("!") 
           Call objGridControl.SelectRowCore(intRow+1)
         End If        
        Delay 200     
      Exit For
    End If
   Next
   IntRowNumber(1) = IntJ 
   
    
   'Click on Open for Edit
   Call fClickNewWorkSpace_Layout() 
      
    
   If strCategory = "Inside" then 
    Call fTwoLevel2RowSelectionForInside(strParameters)
   Else
    'Perform Copy First Level2->Level3 folder to second Level2->Level3 Folder   
     Call fTwoLevel2RowSelection(strParameters)
   End If 
   
  'Clean Up
   Call sCloseSWV()     
   Delay 1000
   Call sLayoutWorkSpacevwr()  
   
   Set objGridControl = Nothing     

End Sub 


''****************************************************************************************************************************************************************
'Function to Open for Edit Layout Module
Function fClickNewWorkSpace_Layout()
  
  On Error Resume Next
  Dim strTemp, objTemp
  
  DescText=Replace(aqDateTime.Now,"/","-")
  DescText=Replace(DescText,":","_") 
  ''strDescText = DescText
  
  ''Clicking on "New Workspace" Button and selecting "Open for Edit(Souce)" option 
  strTemp="WPFObject(""ContentControlEx"", ""New Workspace"", 2)"  
  Set objNewWorkspace=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,True)
  Call sObjClick(strTemp)
  strTemp="WPFObject(""ContentControlEx"", ""Open For Edit"", 2)"  
  Call sObjClick(strTemp)
  'Call sEdgeProcessor()
  
 ''Waiting for Workspace Name prompt
  strTemp="WPFObject(""HwndSource: WorkspaceNamePrompt"", ""Please provide a new Workspace Name"")"
  Set objNewWrkSpace_Name=Sys.Process("EdgeClient").WaitChild(strTemp,60000)
    If objNewWrkSpace_Name.Exists = True then
      strTemp="WPFObject(""ChangeNameTextEdit"")"
      ''Entering Workspace Name
      Set objNewWrkSpace_Txtbox=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
        If objNewWrkSpace_Txtbox.Exists = True then          
          objNewWrkSpace_Txtbox.Click
          objNewWrkSpace_Txtbox.Text=DescText
          ''Clicking on Ok Button 
          strTemp="WPFObject(""OkButton"")"
          Set objNewWrkSpace_okbtn=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
          If objNewWrkSpace_okbtn.Exists = True then
            objNewWrkSpace_okbtn.Click 
            Call sEdgeProcessor()
            Call sCloseSWV()  
          End If
        End If
    End If
End Function
''****************************************************************************************************************************************************************

'TestCases : TC_layout_PRT24 -To verify Copyfolder and Paste inside


Sub sCopyPasteInsideLayout(strParameters)
'Sub sCopyPasteInsideLayout()

On Error Resume Next
  Dim strTemp, objGridControl, objTemp, blnFlag, newSourceName, intTotNodeCnt, intSeriesID(0), strSourceName(3)
  Dim IntRowNumber(4)
 
  strLevel1=getSplitValue(strParameters,"Level1")
  strLevel2=getSplitValue(strParameters,"Level2") 
  strLevel3=getSplitValue(strParameters,"Level3")
  strLevel4=getSplitValue(strParameters,"Level4")
     
  strPasteOption = getSplitValue(strParameters,"PASTEOPTION")
  strCopyOption= getSplitValue(strParameters,"COPYOPTION")  
  strWithSeries = getSplitValue(strParameters,"WITHSERIES")
  strFolderCount=getSplitValue(strParameters,"FolderCount")
  strWithSeries = getSplitValue(strParameters,"WITHSERIES")
  strLevel = getSplitValue(strParameters,"LEVEL")
  strCategory = getSplitValue(strParameters,"Category")
  blnFlag = False
  
  
  Redim intSeriesID(Cint(strFolderCount))
  
  ''Select  level2 layout folder  and 'Open for Edit(layout)'
  Call sOpenForEditLayout(strParameters)  
  Call sEdgeProcessor()
  Delay 2000 
  
    
  'Expand the layout tree then select level4 layout folder
  IntRowNumber(0) = sLayoutLevel1GridSelection(strParameters) 
  IntRowNumber(1) = sLayoutLevel2GridSelection(strParameters,IntRowNumber(0)) 
  IntRowNumber(2) = sLayoutLevel3GridSelection(strParameters,IntRowNumber(0),IntRowNumber(1))  
  IntRowNumber(3)=  sLayoutLevel4GridSelection(strParameters,IntRowNumber(0),IntRowNumber(1),IntRowNumber(2))
  
  'Copy and Paste selected Folder
  Call  fCopy(strCopyOption)
  Call sEdgeProcessor()
   
  'Select the Lavel 3 Folder to paste Inside
  IntRowNumber(2) = sLayoutLevel3GridSelection(strParameters,IntRowNumber(0),IntRowNumber(1))  
  
  'Paste Indise
  Call  fPaste(strPasteOption)
  Call sEdgeProcessor()
  
  strTemp = "WPFObject(""LayoutTreeListView"")"
  Set objGridControl = Sys.Process("EdgeClient").FindChild("Name", strTemp, 50, True)
  
  intTotNodeCnt=objGridControl.Nodes_2.Item(IntRowNumber(0)).Nodes.Item(IntRowNumber(1)).Nodes.Item(IntRowNumber(2)).Nodes.Count  
  
  DescText=Replace(aqDateTime.Now,"/","-")
  intNewNumber =Replace(DescText,":","_")         
  intNewNumber1 = left(intNewNumber,1)+ Minute(Time) + Second(Time) + J &"-" &intNewNumber 
  intLen= Len(strLevel4)-Instr(strLevel4, "-")             
  newSourceName =  Replace(strLevel4 ,Right(strLevel4 ,intLen), intNewNumber1)       
  Delay 200       
  Call objGridControl.Nodes_2.Item(IntRowNumber(0)).Nodes.Item(IntRowNumber(1)).Nodes.Item(IntRowNumber(2)).Nodes.Item(intTotNodeCnt-1).Content.set_Description(newSourceName)
  Delay 200
  Call objGridControl.Nodes_2.Item(IntRowNumber(0)).Nodes.Item(IntRowNumber(1)).Nodes.Item(IntRowNumber(2)).Nodes.Item(intTotNodeCnt-1).Content.set_DescriptionLocal(newSourceName) 
  strName(P) =  newSourceName 
  P=P+1
  Delay 500         
  
  'Save and Verify Copied/Cut Folder
  Call sSaveAndVerifyCopyLayout(strParameters,IntRowNumber)  
  Set objGridControl = Nothing 
  
  
End Sub


'######################################################################################################################################
'Fucntion to Copy And Paste Inside to the differnt level Folder

Sub sTwoLevel2RowSelectionForInside(strParameters)
'Function fTwoLevel2RowSelectionForInside()
  On Error Resume Next
  Dim strTemp, objGridControl, IntRowNumber(4), strLevel3Category, strLevel2Category , intSeriesID(3), strSourceName(3), intNewSeriesID(3)
  Dim intLevel2Source2RowNumber(10)
  
  strSource_Name =getSplitValue(strParameters,"SOURCE")
  strLevel2Source1 =getSplitValue(strParameters,"Level2Source1")
  strLevel2Source2 =getSplitValue(strParameters,"Level2Source2")
  strLevel3Source1 =getSplitValue(strParameters,"Level3Source1")
  strLevel3Source2 =getSplitValue(strParameters,"Level3Source2")
  strLevel4Source1 = getSplitValue(strParameters,"Level4Source1")
  strLevel3Category = getSplitValue(strParameters,"Level3Category")
  strCopyOption  =getSplitValue(strParameters,"COPYOPTION") 
  strPasteOption  = getSplitValue(strParameters,"PASTEOPTION")
  strCategory =getSplitValue(strParameters,"CATEGORY")   
  strFolderCount =getSplitValue(strParameters,"FolderCount")
  strWithSeries = getSplitValue(strParameters,"WITHSERIES")
  strLayoutDV = getSplitValue(strParameters,"LayoutDV")
  strButton = getSplitValue(strParameters,"Button")
  
  
  
  ''Select  level2 layout folder  and 'Open for Edit(layout)'
  Call sOpenForEditLayout(strParameters)  
  Call sEdgeProcessor()
  Delay 2000 
     
'  strEnvi = "Edge ( US Integration )"   
'  strSource_Name="dX Non-Asia Database (Current Eng Version)"
'  strLevel2Source1="Level2-CopyFolder-1"
'  strLevel2Source2="Level2-CopyFolder-2"
'  strLevel3Source1="Level3-CopyFolder-3"
'  strLevel3Source2="Level3-CopyFolder-4"
'  strLevel4Source1="Level4-CopyFolder-1"
'  strLevel3Category="Select"
'  strCopyOption="WPFObject(""ContentControlEx"", ""Copy Folder Only"", 2)"
'  strPasteOption="WPFObject(""ContentControlEx"", ""Paste Inside"", 2)"
'  strCategory="Inside"
'  strFolderCount="1"
'  strWithSeries="Yes"
'  strLayoutDV = "Yes"
'  strButton = "WPFObject(""LayoutTreeListView"")"
    
     
  strTemp = "WPFObject(""ContentControlEx"", ""Expand All"", 2)"
  Call sObjClick(strTemp)
  Delay 2000
     
  strTemp = "WPFObject(""LayoutTreeListView"")"
  Set objGridControl = Sys.Process("EdgeClient").FindChild("Name", strTemp, 50, True)
     
  'Expand the layout tree then select level4 layout folder  IntRowNumber(0) = fGridone(strTemp,strSource_Name ) 
  IntRowNumber(0) = fGridone(strTemp,strSource_Name )
  IntRowNumber(1) = fGridTwo(strTemp,strLevel2Source1 ,IntRowNumber(0))  
  IntRowNumber(2) = fGridThree(strTemp,strLevel3Source1 ,IntRowNumber(0), IntRowNumber(1))
  IntRowNumber(3) =fGridFour(strTemp,strLevel4Source1 ,IntRowNumber(0), IntRowNumber(1),IntRowNumber(2))
  Call sEdgeProcessor() 
    
  'Copy Folder
  Call  fCopy(strCopyOption)
  Call sEdgeProcessor()
  
  'Select the other Level3 Folder
  IntRowNumber(2) = fGridThree(strTemp,strLevel3Source2 ,IntRowNumber(0), IntRowNumber(1))
  'IntRowNumber(3) =fGridFour(strTemp,strLevel4Source1 ,IntRowNumber(0), IntRowNumber(1),IntRowNumber(2))
  
  'Paste Folder
  Call  fPaste(strPasteOption)
  Call sEdgeProcessor()
  strFisrtLevel4Folder = objGridControl.Nodes_2.Item(IntRowNumber(0)).Nodes.Item(IntRowNumber(1)).Nodes.Item(IntRowNumber(2)).Nodes.Item(IntRowNumber(3)).Content.Description
  
  
  If strFisrtLevel4Folder = strLevel4Source1 Then 
    strName(0) =  strFisrtLevel4Folder   
    strTCRemarks = "'"& strFisrtLevel4Folder &"'  dispalyed in Layout Module after Coping the workspace"
    strTestCaseResult="PASS"
  Else
     strTCRemarks = "'"& strFisrtLevel4Folder &"'   dispalyed in Layout Module after Coping the workspace"
     strTestCaseResult="FAIL"   
  End If
  
End Sub




'###############################################################################################################################
'Fucnction to select First Row
Function fGridone(strTemp,strLevel1 )
  
  'Function sLayoutLevel1GridSelection()
  On Error Resume Next   
  Dim objGridControl, IntCount
  
  Set objGridControl = Sys.Process("EdgeClient").FindChild("Name", strTemp, 50, True)
  
   'Expanding First Node
   intTotNodeCnt=objGridControl.Nodes_2.Count  
   For intI=0 to intTotNodeCnt-1         
     If Ucase(objGridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strLevel1) then
         objGridControl.Nodes_2.Item(intI).ExpandAll                       
         intRow=objGridControl.Nodes_2.Item(intI).get_RowHandle         
         Call sSelcetLayoutLevel(objGridControl, intRow)   
         intRowControl =intRow +1 
         Call objGridControl.WPFObject("HierarchyPanel", "", 1).WPFObject("RowControl", "", intRowControl).WPFObject("RowMarginControl", "", 1).Click(12, 10)
        Delay 200           
      Exit For
    End If
   Next 
   fGridone = IntI
   Set objGridControl = Nothing   
 
End Function

'##################################################################################################################33
'Fucnction to select Second Level
Function fGridTwo(strTemp,strLevel2 ,intI)
'Function sLayoutLevel2GridSelection()
  On Error Resume Next   
  Dim objGridControl, IntCount 

  Set objGridControl = Sys.Process("EdgeClient").FindChild("Name", strTemp, 50, True)
  
  'Selceting the Second Level 
  intTotNodeCnt=objGridControl.Nodes_2.Item(intI).Nodes.Count
   For intJ=0 to intTotNodeCnt-1
    If Ucase(objGridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strLevel2) then        
       ' objGridControl.Nodes_2.Item(intI).ExpandAll       
        intRow=objGridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
        Call sSelcetLayoutLevel(objGridControl, intRow)
        'Call objGridControl.SelectRowCore(intRow+1)
'         If  Ucase(Trim(strMultiLevel)) = Ucase(Trim("Yes"))Then   
'           SYS.Keys("!")            
'         End If   
'         intRowControl =intRow +1 
'         Call objGridControl.WPFObject("HierarchyPanel", "", 1).WPFObject("RowControl", "", intRowControl).WPFObject("RowMarginControl", "", 1).Click(40, 13)
         Delay 200     
      Exit For
    End If
   Next
   
  'msgbox IntJ
   fGridTwo = IntJ
   Set objGridControl = Nothing 
End Function  
   
'##################################################################################################################33
'Fucnction to select Second Level
Function fGridThree(strTemp,strLevel3 ,intI, intJ)
'Function sLayoutLevel2GridSelection()
  On Error Resume Next   
  Dim objGridControl, IntCount   
  
  strLevel3FisrtFolder=getSplitValue(strParameters,"Level3FisrtFolder") 
  If strLevel3FisrtFolder <> "" And strLevel3 = "" Then 
    strLevel3 = strLevel3FisrtFolder
  End If
  
'  strMultiLevel =  getSplitValue(strParameters,"MultiLevel") 
'  strFolderCount = getSplitValue(strParameters,"FolderCount")
'  strFolderCount = 2
'  strMultiLevel = "Yes"
  Set objGridControl = Sys.Process("EdgeClient").FindChild("Name", strTemp, 50, True)
  
  'Selecting the Third Level 
  intTotNodeCnt=objGridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count        
  For intK=0 to intTotNodeCnt-1
    If Ucase(objGridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description)=Ucase(strLevel3) then
      'objGridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).ExpandAll      
          intRow =objGridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).get_RowHandle          
          Call sSelcetLayoutLevel(objGridControl, intRow) 
'           If  Ucase(Trim(strMultiLevel)) = Ucase(Trim("Yes"))Then
'            For  I = 0 to  strFolderCount-2 
'                SYS.Keys("![Down]") 
'            Next
'           End If        
          Dealy 200       
      Exit For
    End If
   Next
   
   'msgbox IntK
   fGridThree = IntK
   Set objGridControl = Nothing    
End Function 

'################################################################################################################################

'Fucnction to select Second Level
Function fGridFour(strTemp,strLevel4 ,intI, intJ,intK)
'Function sLayoutLevel2GridSelection()
  On Error Resume Next   
  Dim objGridControl, IntCount  
  
  Set objGridControl = Sys.Process("EdgeClient").FindChild("Name", strTemp, 50, True)
  
  'Selecting the Third Level 
  intTotNodeCnt=objGridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Nodes.Count        
  For intL=0 to intTotNodeCnt-1
    If Ucase(objGridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Nodes.Item(intL).Content.Description)=Ucase(strLevel4) then
      objGridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Nodes.Item(intL).ExpandAll      
      intRow =objGridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Nodes.Item(intL).get_RowHandle          
      Call sSelcetLayoutLevel(objGridControl, intRow)         
      Dealy 200       
      Exit For
    End If
   Next
   
   'msgbox IntL
   fGridFour = IntL
   Set objGridControl = Nothing    
End Function

'*****************************************************************************************************************************************
'TestCase:TC_layout_PRT29 : Select Level3 Multiple Folder Copy multiple folders with Series Paste Below and Verify the changes.
Sub sLevel3WithSeriesCopyFolder(strParameters)
'Sub sLevel3WithSeriesCopyFolder()
  On Error Resume Next
  Dim strTemp, objGridControl, IntRowNumber(4), strLevel3Category, strLevel2Category , intSeriesID(3), strSourceName(3), intNewSeriesID(3)
  Dim intLevel2Source2RowNumber(10)
  
  strLevel1 =getSplitValue(strParameters,"Level1")
  strLevel2 =getSplitValue(strParameters,"Level2")  
  strLevel3 =getSplitValue(strParameters,"Level3")
  strSecondLevel3 =getSplitValue(strParameters,"SecondLevel3")
  strButton = getSplitValue(strParameters,"Button") 
  strMultiLevel =  getSplitValue(strParameters,"MultiLevel")
  strCopyOption  =getSplitValue(strParameters,"COPYOPTION") 
  strPasteOption  = getSplitValue(strParameters,"PASTEOPTION")
  strCategory =getSplitValue(strParameters,"CATEGORY")   
  strFolderCount =getSplitValue(strParameters,"FolderCount")
  strWithSeries = getSplitValue(strParameters,"WITHSERIES")  
  
   

  
'  strLevel1 = "dX Non-Asia Database (Current Eng Version)"
'  strLevel2 = "Level2-CopyFolder-WithSeries"
'  strLevel3 = "Level3-CopyFolder-WithSeries-1"
'  strSecondLevel3 = "Level3-CopyFolder-WithSeries-3"
'  strButton = "WPFObject(""ContentControlEx"", ""Open For Edit"", 2)"
'  strMultiLevel = "Yes"
'  strCopyOption= "WPFObject(""ContentControlEx"", ""Copy Folder with Series"", 2)"
'  strPasteOption  = "WPFObject(""ContentControlEx"", ""Paste Below"", 2)"
'  strFolderCount  = 2
'  strEnvi = "Edge ( US Integration )" 
'  strCategory = "Below"  
  
  'Open Layout  
  Call sOpenLayout()  
  
  'Select the Level2 Folder and Open for Edit Layout
  strTemp = "WPFObject(""LayoutTreeListView"")" 
  IntRowNumber(0) = fGridone(strTemp,strLevel1 )
  Sys.Keys "[Enter]"
  Call sEdgeProcessor()
  IntRowNumber(1) = fGridTwo(strTemp,strLevel2 ,IntRowNumber(0))  
  Call sOpenWS(strButton)
  Delay 2000
  
 'Expand the layout tree then select multiple level3 layout folder    
  strTemp = "WPFObject(""LayoutTreeListView"")" 
  Set objGridControl = Sys.Process("EdgeClient").FindChild("Name", strTemp, 50, True)
  
  'Expand the First Level
   intTotNodeCnt=objGridControl.Nodes_2.Count  
   For intI=0 to intTotNodeCnt-1         
     If Ucase(objGridControl.Nodes_2.Item(intI).Content.Description)=Ucase(strLevel1) then
         'objGridControl.Nodes_2.Item(intI).ExpandAll                       
         intRow=objGridControl.Nodes_2.Item(intI).get_RowHandle         
         Call sSelcetLayoutLevel(objGridControl, intRow)   
         intRowControl =intRow +1 
         Call objGridControl.WPFObject("HierarchyPanel", "", 1).WPFObject("RowControl", "", intRowControl).WPFObject("RowMarginControl", "", 1).Click(12, 10)
        Delay 200           
      Exit For
    End If
   Next 
 
   'Selceting the Second Level 
  intTotNodeCnt=objGridControl.Nodes_2.Item(intI).Nodes.Count
   For intJ=0 to intTotNodeCnt-1
    If Ucase(objGridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Content.Description)=Ucase(strLevel2) then        
       ' objGridControl.Nodes_2.Item(intI).ExpandAll       
        intRow=objGridControl.Nodes_2.Item(intI).Nodes.Item(intJ).get_RowHandle
        Call sSelcetLayoutLevel(objGridControl, intRow)                
         intRowControl =intRow +1 
         Call objGridControl.WPFObject("HierarchyPanel", "", 1).WPFObject("RowControl", "", intRowControl).WPFObject("RowMarginControl", "", 1).Click(40, 13)
         Delay 200     
      Exit For
    End If
   Next
   
   
   'Selecting the Third Level 
  intTotNodeCnt=objGridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count        
  For intK=0 to intTotNodeCnt-1
    If Ucase(objGridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description)=Ucase(strLevel3) then
         intRow =objGridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).get_RowHandle          
          Call sSelcetLayoutLevel(objGridControl, intRow) 
           If  Ucase(Trim(strMultiLevel)) = Ucase(Trim("Yes"))Then
            For  I = 0 to  strFolderCount-2 
               'Call objGridControl.SelectRowCore(intRow+1+I)
                SYS.Keys("![Down]") 
            Next
           End If        
          Dealy 200       
      Exit For
    End If
   Next
   
   

  Call sEdgeProcessor() 
    
  'Copy Folder with series
  Call  fCopy(strCopyOption)
  Call sEdgeProcessor()
  
 intRowNumber(2) = fGridThree(strTemp,strSecondLevel3 ,intI, intJ) 
  
  'Paste The Copied Folder
  Call  fPaste(strPasteOption)
  Call sEdgeProcessor()
  
 For I = 0 to  strFolderCount-1
    DescText=Replace(aqDateTime.Now,"/","-")
    intNewNumber =Replace(DescText,":","_")         
    intNewNumber1 = left(intNewNumber,1)+ Minute(Time) + Second(Time) + J &"-" &intNewNumber 
    intLen= Len(strLevel3)-Instr(strLevel3, "-")             
    newSourceName =  Replace(strLevel3 ,Right(strLevel3 ,intLen), intNewNumber1)       
    Delay 200       
    Call objGridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(IntRowNumber(2)+I+1).Content.set_Description(newSourceName)
    Delay 200
    Call objGridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(IntRowNumber(2)+I+1).Content.set_DescriptionLocal(newSourceName) 
    strName(I) =  newSourceName    
    Delay 500
 Next
 
 
 'Verify the Copied Folder
  Dim strWorkspaceName(5), strSeriesID(5)
  Set objSeriesPanel = Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("LayoutSeriesViewControl").WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("LayoutSeriesGridControl").WPFObject("LayoutSeriesTableView")
  intTotNodeCnt=objGridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Count        
  X =0
  Y =0 
  For intK=0 to intTotNodeCnt-1
    If Ucase(objGridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description)=Ucase(strLevel3) then
       intRow =objGridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Nodes.Item(Y).get_RowHandle  
      For intL = 0 to strFolderCount-1                 
          Call sSelcetLayoutLevel(objGridControl, intRow) 
          strWorkspaceName(X) = objGridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Nodes.Item(Y).Content.Description 
          strSeriesID(X) = objSeriesPanel.DataContext.Item(Y).SeriesId
          intK = intK+1
          X =X+1
          intRow =objGridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Nodes.Item(Y).get_RowHandle
         ' intRow =  intRow+1
      Next
      Exit For
    End IF
  Next
  
 X=0 
  For intK=0 to intTotNodeCnt-1
    If Ucase(objGridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Content.Description)=Ucase(strSecondLevel3) then
    If  strCategory = "Below" then 
      intK = intK+1
    End If
    If strCategory = "Above" then
      intK = intK-1
    End IF
        
    intRow =objGridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Nodes.Item(Y).get_RowHandle 
    For intL = 0 to strFolderCount-1    
          Call sSelcetLayoutLevel(objGridControl, intRow) 
          If objGridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Nodes.Item(Y).Content.Description  =  strWorkspaceName(X) And   objSeriesPanel.DataContext.Item(Y).SeriesId = strSeriesID(X) Then 
            blnFlag = True 
          End If
          intK = intK+1
          X =X+1
          intRow =objGridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Nodes.Item(Y).get_RowHandle 
          'intRow = intRow+1
      Next
      Exit For
    End IF
  Next

  If   blnFlag = True And X = Cint(strFolderCount) Then 
    strTCRemarks = "All the copied Level 4 Folders with series are pasted correclty "
    log.Message  "All the copied Level 4 Folders with series are pasted correclty "
    strTestCaseResult="PASS"
  Else
    strTCRemarks = "All the copied Level 4 Folders with series are not pasted correclty "
    log.Message  "All the copied Level 4 Folders with series are not pasted correclty "
    strTestCaseResult="FAIL"
    Exit Sub    
  End IF   
  
   intK = intK-1
   X = X-1
  'Upload the Workspace
    Call fUploadWorkSpace()
    Call sEdgeProcessor() 
    
  'Open Layout  
    Call sOpenLayout()        
    strTemp = "WPFObject(""LayoutTreeListView"")" 
    IntRowNumber(0) = fGridone(strTemp,strLevel1 )
    ' Sys.Keys "[Enter]"
    Call sEdgeProcessor()
    Delay 2000
    IntRowNumber(1) = fGridTwo(strTemp,strLevel2 ,IntRowNumber(0))  
    Call sOpenWS(strButton)
    Delay 2000 
    
    intRow =objGridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Nodes.Item(Y).get_RowHandle  
    Call sSelcetLayoutLevel(objGridControl, intRow)     
    
    If objGridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).Nodes.Item(Y).Content.Description  =  strWorkspaceName(X) And   objSeriesPanel.DataContext.Item(Y).SeriesId = strSeriesID(X) Then 
        strTCRemarks = strTCRemarks  & "<br />" & "All the copied Level 4 Folders with series Uploaded Successfully"
        log.Message   "All the copied Level 4 Folders with series Uploaded Successfully"
        strTestCaseResult="PASS"
    Else
        strTCRemarks = strTCRemarks  & "<br />" & "All the copied Level 4 Folders with series are not Uploaded Successfully"
        log.Message   "All the copied Level 4 Folders with series are not Uploaded Successfully"
        strTestCaseResult="FAIL"
    End If
    
    'Clean Up
    Call sCloseSWV() 
    Set objGridControl = nothing 
    

End Sub

'#######################################################################################################################3
'Click on NewWorkspace and chose the required option


Function sOpenWS(strButton)
  On Error Resume Next
  
  
  DescText=Replace(aqDateTime.Now,"/","-")
  DescText=Replace(DescText,":","_") 
  ''strDescText = DescText
  
  ''Clicking on "New Workspace" Button and selecting "Open for Edit(Souce)" option 
  strTemp="WPFObject(""ContentControlEx"", ""New Workspace"", 2)"  
  Set objNewWorkspace=Sys.Process("EdgeClient").FindChild("Name",strTemp,50,True)
  Call sObjClick(strTemp)
  'click on Required Button 
  Call sObjClick(strButton)
  'Call sEdgeProcessor()
  
   ''Waiting for Workspace Name prompt
      strTemp="WPFObject(""HwndSource: WorkspaceNamePrompt"", ""Please provide a new Workspace Name"")"
      Set objNewWrkSpace_Name=Sys.Process("EdgeClient").WaitChild(strTemp,60000)
        If objNewWrkSpace_Name.Exists = True then
          strTemp="WPFObject(""ChangeNameTextEdit"")"
          ''Entering Workspace Name
          Set objNewWrkSpace_Txtbox=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
            If objNewWrkSpace_Txtbox.Exists = True then  
              objNewWrkSpace_Txtbox.Click
              objNewWrkSpace_Txtbox.Text=DescText
              ''Clicking on Ok Button 
              strTemp="WPFObject(""OkButton"")"
              Set objNewWrkSpace_okbtn=objNewWrkSpace_Name.FindChild("Name",strTemp,9,True)
              If objNewWrkSpace_okbtn.Exists = True then
                objNewWrkSpace_okbtn.Click 
                Call sEdgeProcessor()
                Call sCloseSWV()                         
              End If
            End If
        End If
End Function
'#######################################################################################################################3
'TestCase:TC_layout_PRT30: Verify Cut Folder and Paste Above/Below source folder/s.

Sub sCutLayoutFolders(strParameters)
'Sub sCutLayoutFolders()

  Delay 3000 , "Pls Wait..."
  On Error Resume Next
  Dim strTemp, objGridControl, objTemp, blnFlag, newSourceName, intTotNodeCnt,IntRowNumber(10),strSeriesID(5), strSourceName(10)
  
  
  strLevel1 =getSplitValue(strParameters,"Level1")
  strLevel2 =getSplitValue(strParameters,"Level2")  
  strLevel3 =getSplitValue(strParameters,"Level3")
  strLevel4 =getSplitValue(strParameters,"Level4")
  strSecondLevel3= getSplitValue(strParameters,"SecondLevel3")
  strSecondLevel4=getSplitValue(strParameters,"SecondLevel4")
  strMultiLevel =  getSplitValue(strParameters,"MultiLevel")
  strButton = getSplitValue(strParameters,"Button") 
  strPasteOption  = getSplitValue(strParameters,"PASTEOPTION")
  strFolderCount =getSplitValue(strParameters,"FolderCount") 
  strCategory =getSplitValue(strParameters,"CATEGORY")
  strWithSeries = getSplitValue(strParameters,"WITHSERIES")   
  
'    strLevel1 = "dX Non-Asia Database (Current Eng Version)"
'    strLevel2 = "Level2-CopyFolder-WithSeries"
'    strLevel3 = "Level3-CopyFolder-WithSeries-4" 
'    strLevel4 = "Level4-CF-WithSeries-1" 
'    strSecondLevel4 = "Level4-CF-WithSeries-3" 
'    'strSecondLevel3 = "Level3Folder-2"
'    'strMultiLevel = "Yes"
'    strButton = "WPFObject(""ContentControlEx"", ""Open For Edit"", 2)"
'    strPasteOption  = "WPFObject(""ContentControlEx"", ""Paste Below"", 2)"
'    'strTestCase_no = "TC_layout_PRT32"
'    strCategory = "Below"
'    strFolderCount = "1"
'    strWithSeries = "Yes"
  
  'Open Layout  
  Call sOpenLayout() 
  
  'Select Level3 Folder and Open For Edit 
  strTemp = "WPFObject(""LayoutTreeListView"")" 
  IntRowNumber(0) =   fGridone(strTemp,strLevel1 )
  IntRowNumber(1) =  fGridTwo(strTemp,strLevel2 ,IntRowNumber(0))
  IntRowNumber(2)=  fGridThree(strTemp,strLevel3 ,IntRowNumber(0), IntRowNumber(1)) 
  Set objGridControl = Sys.Process("EdgeClient").FindChild("Name", strTemp, 50, True)
  RowCnt = (objGridControl.Nodes_2.Item(IntRowNumber(0)).Nodes.Item(IntRowNumber(1)).Nodes.Count)    
  intRow =objGridControl.Nodes_2.Item(IntRowNumber(0)).Nodes.Item(IntRowNumber(1)).Nodes.Item(IntRowNumber(2)).get_RowHandle 
  If strMultiLevel = "Yes" Then 
    For  I =  0 to  RowCnt-1
      If Ucase(objGridControl.Nodes_2.Item(IntRowNumber(0)).Nodes.Item(IntRowNumber(1)).Nodes.Item(I).Content.Description)=Ucase(strSecondLevel3) Then
        intRow =objGridControl.Nodes_2.Item(IntRowNumber(0)).Nodes.Item(IntRowNumber(1)).Nodes.Item(I).get_RowHandle         
         SYS.Keys("!")
         Call objGridControl.SelectRowCore(intRow) 
      End If      
    Next         
    
   ' Call objGridControl.SelectRowCore(intRow+RowCnt)             
  End If
  
  Call sOpenWS(strButton)
  Delay 2000
  
  'Expand All Levels
  strTemp = "WPFObject(""ContentControlEx"", ""Expand All"", 2)"  
  Call sobjClick(strTemp) 
  
  'Select the Level4 Folder 
  strTemp = "WPFObject(""LayoutTreeListView"")" 
  IntRowNumber(0) = fGridone(strTemp,strLevel1 )
  IntRowNumber(1) = fGridTwo(strTemp,strLevel2 ,IntRowNumber(0)) 
  IntRowNumber(2)=  fGridThree(strTemp,strLevel3 ,IntRowNumber(0), IntRowNumber(1))    
  IntRowNumber(3) = fGridFour(strTemp,strLevel4 ,IntRowNumber(0), IntRowNumber(1),IntRowNumber(2))
  
  Set objSeriesPanel = Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("LayoutSeriesViewControl").WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("LayoutSeriesGridControl").WPFObject("LayoutSeriesTableView")

  
  If  Ucase(Trim(strTestCase_no)) = Ucase(Trim("TC_layout_PRT32"))Or Ucase(Trim(strTestCase_no)) = Ucase(Trim("TC_layout_PRT36"))Then
     For  I = 0 to  strFolderCount-2 
        strTemp = "WPFObject(""LayoutTreeListView"")" 
        Set objGridControl = Sys.Process("EdgeClient").FindChild("Name", strTemp, 50, True)
        SYS.Keys("![Down]") 
        strName(I+1) = objGridControl.Nodes_2.Item(IntRowNumber(0)).Nodes.Item(IntRowNumber(1)).Nodes.Item(IntRowNumber(2)).Nodes.Item(IntRowNumber(3)+I+1).Content.Description
        'msgbox  strName(I+1)
     Next
  End If
  
  X=0
  Y=0
   If strWithSeries = "Yes" then 
    Call sEdgeProcessor()
    Delay 2000, "Please wait Series Module is opening"
     For  I = 0 to  strFolderCount-1 
        strSeriesID(X) = objSeriesPanel.DataContext.Item(Y).SeriesId
        X=X+1
     Next
   End If 
   
  'Cut the Folder
  Call fCut()
  
  If  Ucase(Trim(strTestCase_no)) = Ucase(Trim("TC_layout_PRT32"))Or Ucase(Trim(strTestCase_no)) = Ucase(Trim("TC_layout_PRT36"))Then
    'Select the Other Level3 Folder
     IntRowNumber(2)=  fGridThree(strTemp,strSecondLevel3 ,IntRowNumber(0), IntRowNumber(1)) 
     'Select the Second Level4 Folder
     IntRowNumber(4) = fGridFour(strTemp,strSecondLevel4 ,IntRowNumber(0), IntRowNumber(1),IntRowNumber(2))
     Select Case Ucase(strCategory) 
'            Case Ucase("Above")
'                 IntRowNumber(4)= IntRowNumber(4)-1                   
'                   ' Exit For            
            Case Ucase("Below")  
                 IntRowNumber(4)= IntRowNumber(4)+1        
      End Select
  Else
    'Select the Second Level4 Folder
    IntRowNumber(4) = fGridFour(strTemp,strSecondLevel4 ,IntRowNumber(0), IntRowNumber(1),IntRowNumber(2))
'    If strCategory = "Above" Then 
'      IntRowNumber(4)= IntRowNumber(4)-1
'    End If
  
  End If
  
  
  'Paste The Cut Folder
  Call  fPaste(strPasteOption)
  Call sEdgeProcessor()
  
  'Save the Workspace
  Call fSaveWorkspace() 
  Call sEdgeProcessor()         
  Call sCloseSWV() 
    
  'Open the Saved Workspace from Source Workspace Viewer         
  Call sOpenLayoutViewrWS()
  Call sEdgeProcessor()  
  Delay 2000 
  
  
  'Expand All Levels
  strTemp = "WPFObject(""ContentControlEx"", ""Expand All"", 2)"  
  Call sobjClick(strTemp)
  
  strTemp = "WPFObject(""LayoutTreeListView"")" 
  Set objGridControl = Sys.Process("EdgeClient").FindChild("Name", strTemp, 50, True)
  
               
  'Verify the  updated changes reflected or not
  blnFlag = False
  blnSeriesFlag = False
  Cnt = 0
  X =0 
  msgbox  IntRowNumber(4)
  ' intTotNodeCnt=objGridControl.Nodes_2.Item(IntRowNumber(0)).Nodes.Item(IntRowNumber(1)).Nodes.Item(IntRowNumber(2)).Nodes.Count
   strName(0) = strLevel4 
   For  I = 0 to  strFolderCount-1      
        msgbox  IntRowNumber(4)
      If objGridControl.Nodes_2.Item(IntRowNumber(0)).Nodes.Item(IntRowNumber(1)).Nodes.Item(IntRowNumber(2)).Nodes.Item(IntRowNumber(4)+I).Content.Description = strName(I) Then 
        If strWithSeries = "Yes" Then 
          IntRowNumber(4) = fGridFour(strTemp,strLevel4 ,IntRowNumber(0), IntRowNumber(1),IntRowNumber(2))
          Delay 2000
          Call sEdgeProcessor()
          If  objSeriesPanel.DataContext.Item(Y).SeriesId  = strSeriesID(X) then 
            blnSeriesFlag = True
             X = X+1
           End If 
          End If
          blnFlag = True
          Cnt = Cnt +1
        End If    
    Next
  
    
     If strWithSeries = "Yes" Then 
       If blnSeriesFlag = True then
           blnFlag = True 
           strText = "With Series"
       Else
          blnFlag = False
       End If
    End If  
    
    
   If blnFlag = True and  Cnt  = CInt(strFolderCount) then 
    strTCRemarks = "Cut Level4 Folder/Folders "& strText &" are pasted correclty "
    log.Message  "Cut Level4 Folder/Folders "& strText &" are pasted correclty "
    strTestCaseResult= "PASS"
   Else
    strTCRemarks = "Cut Level4 Folder/Folders "& strText &" are not pasted correclty "
    log.Message  "Cut Level4 Folder/Folders "& strText &" are not pasted correclty "
    strTestCaseResult= "FAIL"   
  End If
  
End Sub
'**************************************************************************************************************************************************************8
'TestCase:TC_layout_PRT37{}: Verify Cut Folder and Paste Inside source folder/s.

Sub sCutLayoutFoldersInside(strParameters)
'Sub sCutLayoutFoldersInside()

  Delay 3000 , "Pls Wait..."
  On Error Resume Next
  Dim strTemp, objGridControl, objTemp, blnFlag, IntCnt , newSourceName, intTotNodeCnt,IntRowNumber(10),strSeriesID(5), strSourceName(10)
  
  strLevel1 =getSplitValue(strParameters,"Level1")
  strLevel2 =getSplitValue(strParameters,"Level2")  
  strLevel3 =getSplitValue(strParameters,"Level3")
  strLevel4 =getSplitValue(strParameters,"Level4")
  strSecondLevel3= getSplitValue(strParameters,"SecondLevel3")
  strSecondLevel4=getSplitValue(strParameters,"SecondLevel4")
  strMultiLevel =  getSplitValue(strParameters,"MultiLevel")
  strButton = getSplitValue(strParameters,"Button") 
  strPasteOption  = getSplitValue(strParameters,"PASTEOPTION")
  strFolderCount =getSplitValue(strParameters,"FolderCount") 
  strCategory =getSplitValue(strParameters,"CATEGORY")
  strWithSeries = getSplitValue(strParameters,"WITHSERIES") 
  blnFlag = False  
  IntCnt = 0 
  
'    strLevel1 = "dX Non-Asia Database (Current Eng Version)"
'    strLevel2 = "CopyFolder_3"
'    strLevel3 = "Level3Folder-1" 
'    strSecondLevel3 = "Level3Folder-2"
'    strLevel4 = "Level4Folder-1" 
'    'strSecondLevel4 = "Level4-CF-WithSeries-3"     
'    'strMultiLevel = "Yes"
'    strButton = "WPFObject(""ContentControlEx"", ""Open For Edit"", 2)"
'    strPasteOption  = "WPFObject(""ContentControlEx"", ""Paste Inside"", 2)"
'    'strTestCase_no = "TC_layout_PRT32"
'    'strCategory = "Below"
'     strFolderCount = "1"
'    'strWithSeries = "Yes"


 
  'Open Layout  
  Call sOpenLayout() 
  
  'Select Level3 Folder and Open For Edit 
  strTemp = "WPFObject(""LayoutTreeListView"")" 
  IntRowNumber(0) =   fGridone(strTemp,strLevel1 )
  IntRowNumber(1) =  fGridTwo(strTemp,strLevel2 ,IntRowNumber(0))
  'IntRowNumber(2)=  fGridThree(strTemp,strLevel3 ,IntRowNumber(0), IntRowNumber(1)) 
  
 'Open For Edit 
  Call sOpenWS(strButton)
  Delay 2000
  
  'Expand All Levels select level4 layout folder then Click on 'Cut Folder'
  strTemp = "WPFObject(""ContentControlEx"", ""Expand All"", 2)"  
  Call sobjClick(strTemp)
  Delay 2000
  Call sEdgeProcessor()
  
  strTemp = "WPFObject(""LayoutTreeListView"")" 
  IntRowNumber(0) = fGridone(strTemp,strLevel1 )
  IntRowNumber(1) = fGridTwo(strTemp,strLevel2 ,IntRowNumber(0)) 
  IntRowNumber(2)=  fGridThree(strTemp,strLevel3 ,IntRowNumber(0), IntRowNumber(1))    
  IntRowNumber(3) = fGridFour(strTemp,strLevel4 ,IntRowNumber(0), IntRowNumber(1),IntRowNumber(2))
  Call sEdgeProcessor()
  Delay 2000
  strName(0) = strLevel4
  For I = 1 To strFolderCount-1
    strTemp = "WPFObject(""LayoutTreeListView"")" 
    Set objGridControl = Sys.Process("EdgeClient").FindChild("Name", strTemp, 50, True)
    SYS.Keys("![Down]")
    strName(I)= objGridControl.Nodes_2.Item(IntRowNumber(0)).Nodes.Item(IntRowNumber(1)).Nodes.Item(IntRowNumber(2)).Nodes.Item(IntRowNumber(3)+I).Content.Description 
  Next
  'Cut the Folder
  Call fCut()
  
 'Select the other level3 layout folder   and click on 'Paste Folder'>'Paste Inside'
 IntRowNumber(2)=  fGridThree(strTemp,strSecondLevel3 ,IntRowNumber(0), IntRowNumber(1))    
 
 
  'Paste The Cut Folder
  Call  fPaste(strPasteOption)
  Call sEdgeProcessor()
  
  'Save the Workspace
  Call fSaveWorkspace() 
  Call sEdgeProcessor()         
  Call sCloseSWV() 
  
   'Open the Saved Workspace from Source Workspace Viewer         
  Call sOpenLayoutViewrWS()
  Call sEdgeProcessor()  
  Delay 2000 
  
  'Expand All Levels
  strTemp = "WPFObject(""ContentControlEx"", ""Expand All"", 2)"  
  Call sobjClick(strTemp)
  
  strTemp = "WPFObject(""LayoutTreeListView"")" 
  Set objGridControl = Sys.Process("EdgeClient").FindChild("Name", strTemp, 50, True)
  
  'Verify the  updated changes reflected or not  
  intTotNodeCnt= objGridControl.Nodes_2.Item(IntRowNumber(0)).Nodes.Item(IntRowNumber(1)).Nodes.Item(IntRowNumber(2)).Nodes.Count  
  For IntL = 0 to intTotNodeCnt-1
    If objGridControl.Nodes_2.Item(IntRowNumber(0)).Nodes.Item(IntRowNumber(1)).Nodes.Item(IntRowNumber(2)).Nodes.Item(IntL).Content.Description = strLevel4 then
      For I = 0 to strFolderCount-1
         If objGridControl.Nodes_2.Item(IntRowNumber(0)).Nodes.Item(IntRowNumber(1)).Nodes.Item(IntRowNumber(2)).Nodes.Item(IntL+I).Content.Description = strName(I) Then
          blnFlag = True 
         IntCnt = IntCnt+1  
      End If
     Next 
    End If
 Next 
 
 If blnFlag = True And IntCnt = Cint(strFolderCount) Then 
    strTCRemarks = "Cut Level4 Folder/Folders "& strText &" are pasted correclty "
    log.Message  "Cut Level4 Folder/Folders "& strText &" are pasted correclty "
    strTestCaseResult= "PASS"
  Else
    strTCRemarks = "Cut Level4 Folder/Folders "& strText &" are not pasted correclty "
    log.Message  "Cut Level4 Folder/Folders "& strText &" are not pasted correclty "
    strTestCaseResult= "FAIL"    
  End If
  
  Set objGridControl = Nothing  

End Sub

'**************************************************************************************************************************************************************8
'TestCase:TC_layout_PRT41{}: Verify Cut/Copy Folder and Paste across country:
Sub sCopyCutAccross()
'Sub sCopyCutAccross(strParameters)  
  Delay 3000 , "Pls Wait..."
  On Error Resume Next
  Dim strTemp, objGridControl, objTemp, blnFlag, IntCnt , newSourceName, intTotNodeCnt,IntRowNumber(15),strSeriesID(5), strFolderName 
  
  strLevel1 =getSplitValue(strParameters,"Level1")
  strLevel2 =getSplitValue(strParameters,"Level2")  
  strLevel3 =getSplitValue(strParameters,"Level3")
  strLevel4 =getSplitValue(strParameters,"Level4")
  strSecondLevel2= getSplitValue(strParameters,"SecondLevel2")
  strSecondLevel3= getSplitValue(strParameters,"SecondLevel3")
  strSecondLevel4=getSplitValue(strParameters,"SecondLevel4")
  strMultiLevel =  getSplitValue(strParameters,"MultiLevel")
  strButton = getSplitValue(strParameters,"Button") 
  strPasteOption  = getSplitValue(strParameters,"PASTEOPTION")
  strFolderCount =getSplitValue(strParameters,"FolderCount") 
  strCategory =getSplitValue(strParameters,"CATEGORY")
  strWithSeries = getSplitValue(strParameters,"WITHSERIES") 
  strAction =getSplitValue(strParameters,"Action")
  strCopyOption= getSplitValue(strParameters,"COPYOPTION")
  blnFlag = False  
  IntCnt = 0 
  
  
  
    strLevel1 = "dX Non-Asia Database (Current Eng Version)"
    strLevel2 = "FolderAcrossCountry-1"
    strSecondLevel2 ="FolderAcrossCountry-2"    
    strLevel3 = "Level3Folder-1" 
    strSecondLevel3 = "Level3Folder-4"
    strLevel4 = "Level4Folder-1" 
    strSecondLevel4 = "Level4Folder-4"     
'    'strMultiLevel = "Yes"
    strButton = "WPFObject(""ContentControlEx"", ""Open For Edit"", 2)"
    strCopyOption="WPFObject(""ContentControlEx"", ""Copy Folder Only"", 2)"
    strPasteOption  = "WPFObject(""ContentControlEx"", ""Paste Above"", 2)"
'    'strTestCase_no = "TC_layout_PRT32"
'    'strCategory = "Below"
'     strFolderCount = "1"
'    'strWithSeries = "Yes"
     strAction = "Copy" 


'
'    'Open Layout  
'   Call sOpenLayout()    
'   
'   'Select two level2 layout folder and 'Open for Edit(layout)' 
'  strTemp = "WPFObject(""LayoutTreeListView"")" 
'  IntRowNumber(0) =   fGridone(strTemp,strLevel1 )
'  IntRowNumber(1) =  fGridTwo(strTemp,strLevel2 ,IntRowNumber(0))
'  
'   
'  Set objGridControl = Sys.Process("EdgeClient").FindChild("Name", strTemp, 50, True)
'  intTotNodeCnt=objGridControl.Nodes_2.Item(IntRowNumber(0)).Nodes.Count
'   For intJ=0 to intTotNodeCnt-1
'    If Ucase(objGridControl.Nodes_2.Item(IntRowNumber(0)).Nodes.Item(intJ).Content.Description)=Ucase(strSecondLevel2) then      
'        intRow=objGridControl.Nodes_2.Item(IntRowNumber(0)).Nodes.Item(intJ).get_RowHandle
'        SYS.Keys("!")
'         Call objGridControl.SelectRowCore(intRow) 
'          IntRowNumber(3) = intJ
'    End If
'   Next
'
'  'Open For Edit 
'  Call sOpenWS(strButton)
'  Delay 2000
'  
'  'Expand All Levels select level4 layout folder then Click on 'Cut Folder'
'  strTemp = "WPFObject(""ContentControlEx"", ""Expand All"", 2)"  
'  Call sobjClick(strTemp)
'  Delay 2000
'  Call sEdgeProcessor() 

  'Select level4 layout folder from first level2 layout folder then 'Copy Folder Only
  
  strTemp = "WPFObject(""LayoutTreeListView"")" 
  IntRowNumber(4) = fGridone(strTemp,strLevel1 )
  IntRowNumber(5) = fGridTwo(strTemp,strLevel2 ,IntRowNumber(4)) 
  IntRowNumber(6)=  fGridThree(strTemp,strLevel3 ,IntRowNumber(4), IntRowNumber(5))    
  IntRowNumber(7) = fGridFour(strTemp,strLevel4 ,IntRowNumber(4), IntRowNumber(5),IntRowNumber(6))
  Call sEdgeProcessor()
  Delay 2000
  strFolderName = strLevel4
  
  'Cut/Copy Folder  
  If strAction = "Copy" Then
    fCopy(strCopyOption)
  Else
  End If
  
  
   'Now, select level4 layout folder from second level2 layout folder and 'Paste Above'
 IntRowNumber(8) = fGridTwo(strTemp,strSecondLevel2 ,IntRowNumber(4)) 
 IntRowNumber(9)=  fGridThree(strTemp,strSecondLevel3 ,IntRowNumber(4), IntRowNumber(8))    
 IntRowNumber(10) = fGridFour(strTemp,strSecondLevel4 ,IntRowNumber(4), IntRowNumber(8),IntRowNumber(9))
 Call sEdgeProcessor()
  
 
  'Paste The Cut/Copy Folder
  Call  fPaste(strPasteOption)
  Call sEdgeProcessor() 
  
  'Verification is Pasted Above/Below

End Sub

'###################################################################################################
'Testcase:TC_SeriesSearch_1-6:Verify Serached Series Id appeared 
Sub sSearchSeries(strParameters)
'Sub sSearchSeries()
  On Error Resume Next
  Dim strTemp, objTemp, blnFlag 
  blnFlag = False
  
  strSeriesID = getSplitValue(strParameters,"SeriesID")
  strCategory = getSplitValue(strParameters,"Category")
  strRightClickOption = getSplitValue(strParameters,"RightClickOption")
  strTestDataFile=getSplitValue(strParameters,"TestDataFile") 
  STPSheetName = getSplitValue(strParameters,"STPSheetName")
  strButton=  getSplitValue(strParameters,"Button") 
  strText =  getSplitValue(strParameters,"Text")

  
  
'   strSeriesID = "368766647"
'   strEnvi = "Edge ( US Integration )"
'   strCategory = "Source"
'   strButton = "WPFObject(""ContentControlEx"", ""Open Source"", 2)"
'   strText = "The Source for the series Id:"
'   'strTestDataFile = "YYY-Shilpa_STP-File 2 7-19-2015" 
'   'STPSheetName = "A1_1"
'   'strRightClickOption = "Yes"
'  
  'Open Serach Series Options as per the given category 
  Call SearchSeriesOption(strCategory)
    
  If strCategory = "Reference" Then 
       'Enter Series Id
     Set objTemp = Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("Grid", "", 1).WPFObject("GridControl").WPFObject("GridView").WPFObject("PART_FilterRow").WPFObject("ContentPresenter", "", 2).WPFObject("FilterCellContentPresenter", "", 1).WPFObject("TextEdit", "", 1)
     objTemp.Click
     objTemp.Keys(strSeriesID)
     Delay  5000 
     'Wait for First Row to appear
     Set objTemp = Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("Grid", "", 1).WPFObject("GridControl").WPFObject("GridView").WPFObject("HierarchyPanel", "", 1).WPFObject("RowControl", "", 1).WPFObject("CellsControl", "", 1).WaitChild("WPFObject(""LightweightCellEditor"", """", 2)",60000)
     If objTemp.Content.DisplayText = strSeriesID Then 
        strTCRemarks = "The Series Id: '" & strSeriesID & "'  is displayed "
        strTestCaseResult = "PASS" 
        log.Message "The Series Id: '" & strSeriesID & "'  is displayed "
     Else
         strTCRemarks = "The  Series Id :'" &strSeriesID&"'  is  not displayed " 
           strTestCaseResult = "FAIL"  
           log.Message  "The  Series Id :'" &strSeriesID&"'  is  not displayed "      
     End If  
     Call sCloseWithYes(1299)
     Delay 1000 
     Exit Sub 
  End If
  
   set objTemp= Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("Grid", "", 1).WPFObject("GridControl").WPFObject("GridView").WPFObject("PART_FilterRow").WPFObject("ContentPresenter", "", 1).WPFObject("FilterCellContentPresenter", "", 1).WPFObject("TextEdit", "", 1)
    objTemp.Click
    objTemp.Keys(strSeriesID)
    Delay  5000   
    
    'strGrid = "WPFObject(""GridControl"")"
    'Set objGrid=  Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("Grid", "", 1).WPFObject("GridControl")
     
   If strRightClickOption = "Yes" Then
      Delay 2000
      Call sSeries_Search_Delay()
     Delay 2000
     Set objGrid=  Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("Grid", "", 1).WPFObject("GridControl")
     Call objGrid.ClickCellR(0, "Series Id")
     Set objTemp =Sys.Process("EdgeClient").WPFObject("HwndSource: PopupRoot", "").FindChild("Name",strButton,50,True)
     If objTemp.Exists Then
         objTemp.Click
         log.message "Right click Open Layout is clickied"
         Delay 5000    
         Call sCloseWithYes(637)
         Delay 1000      
        'Open for View Workspace    
         Call sOpenForEditOrView(strParameters) 
         Delay 200
         Call sCloseSWV()    
         Call sEdgeProcessor()
         Delay   15000 , "Please wait form is loading "
    Else
        strTCRemarks = "Not able to find Open Layout button on rightclick "
        strTestCaseResult = "Fail" 
        log.Message "Not able to find Open Layout button on rightclick"
        Exit Sub    
     End if  
    End If
    
    If strRightClickOption <> "Yes" Then 
     If (strCategory ="Source" Or strCategory ="Layout") Then
     Set objGrid=  Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("Grid", "", 1).WPFObject("GridControl")
     'Click on Open Layout Button from module
     Call objGrid.ClickCell(0, "Series Id")   
     Call sSeries_Search_Delay()
     Delay 2000
     Call sObjClick(strButton)
     Call sEdgeProcessor()
     Delay 5000    
    'Close the Layoutseries window
     Call sCloseWithYes(637)
     Delay 1000      
     'Open for View Workspace    
     Call sOpenForEditOrView(strParameters) 
     Delay 200
     Call sCloseSWV()    
     Call sEdgeProcessor()
     Delay   15000 , "Please wait form is loading "
    End If
   End If
   
    If strCategory ="STP" Then
      Set objGrid=  Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("Grid", "", 1).WPFObject("GridControl")
        Call objGrid.ClickCell(0, "Series Id")
       Call sSeries_Search_Delay() 
      'Click on Open STP Button
       strTemp="WPFObject(""ContentControlEx"", ""Open Global STP"", 2)"
       Call sObjClick(strTemp)
       Call sEdgeProcessor()       
       Delay 2000,"Opening STP.. Pls wait.."
       Call sExcelFullHistory()
       Delay 5000
       Set NetUIHWND = Sys.Process("EXCEL", 2).Window("XLMAIN", strTestDataFile &"*", 1).Window("EXCEL2", "", 2).Window("MsoCommandBar", "Ribbon", 1).Window("MsoWorkPane", "Ribbon", 1).Window("NUIPane", "", 1).Window("NetUIHWND", "", 1)
       If NetUIHWND.Exists Then 
         blnFlag = True
         Call ExcelProcessKill          
         Call sCloseWithYes(1299)
         Delay 1000         
       End If
    End If
    If strCategory ="CNSTP"Then
       Set objGrid=  Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("Grid", "", 1).WPFObject("GridControl")
       Call objGrid.ClickCell(0, "Series Id") 
       Call sSeries_Search_Delay()
       
      'Click on Open CNSTP Button
       strTemp="WPFObject(""ContentControlEx"", ""Open CN STP"", 2)"
       Call sObjClick(strTemp)
       Call sEdgeProcessor()       
       Delay 2000,"Opening STP.. Pls wait.."
       Call sExcelFullHistory()
       Delay 2000
       blnFlag = fVerifyCNSTPFile(strTestDataFile, STPSheetName) 
       Call ExcelProcessKill  
       Call sCloseWithYes(1299)
       Delay 1000   
    End If
    
    If strCategory = "Layout" Then 
      'Expand all
      'strTemp = "WPFObject(""ContentControlEx"", ""Expand All"", 2)"
      'Call sObjClick(strTemp)
      Call Aliases.EdgeClient.HwndSource_Shell.Shell.Grid.ContentControl.Grid.PART_RibbonLayout.Part_WindowContent.Grid.ContentControl.PART_ContainerContent.BarManager.DockPanel.DockLayoutManager.LayoutGroup.LayoutPanel.LayoutPanelContentPresenter.Root.BarManager.ClickItem("[0]|Expand All")
      Call sEdgeProcessor()
      Set objTemp= Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("DockPanel", "", 3).WPFObject("LayoutTreeListControl").WPFObject("LayoutTreeListView").WPFObject("HierarchyPanel", "", 1).WPFObject("RowControl", "", 4).WPFObject("CellsControl", "", 1).WPFObject("LightweightCellEditor", "", 1).WPFObject("InplaceBaseEdit", "", 1).WPFObject("EditorControlStub", "", 1)
      objTemp.Click
      Delay 2000
      'Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", "Edge ( US Integration )").WPFObject("Shell", "Edge ( US Integration )", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("LayoutSeriesViewControl").WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("LayoutSeriesGridControl")
      strTemp = "WPFObject(""LayoutSeriesGridControl"")"
      Set objTemp = Sys.Process("EdgeClient").FindChild("Name",strTemp,50,True)
      intRowCount = objTemp.DataContext.Count
      For IntI = 0 to intRowCount-1
         ActualSeriesID = objTemp.DataContext.Item(IntI).SeriesId
         If (strSeriesID) = ActualSeriesID then         
            blnFlag = True
            Call sCloseSWV() 
            Exit For
         End If      
      Next
    End If
    
    If strCategory = "Source" Then      
           strTemp = "WPFObject(""ContentControlEx"", ""Expand All"", 2)"   
           Call sObjClick(strTemp)
           strTemp="WPFObject(""SourceTreeListView"")"  
           Set objGridControl = Sys.Process("EdgeClient").FindChild("Name", strTemp, 50, True)    
           objGridControl.Nodes_2.Item(0).Nodes.Item(0).Nodes.Item(0).ExpandAll      
          intRow =objGridControl.Nodes_2.Item(intI).Nodes.Item(intJ).Nodes.Item(intK).get_RowHandle
          objGridControl.Keys "^[Home]"
          Call objGridControl.ClearSelectionCore
          Call objGridControl.FocusViewAndRow(objGridControl,intRow)
          objGridControl.SetFocusOnCurrentItem
          Call objGridControl.SelectRowCore(intRow)    
          Call sEdgeProcessor()
          Delay 2000
          'Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", "Edge ( US Integration )").WPFObject("Shell", "Edge ( US Integration )", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("SourceSeriesViewControl").WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("SourceSeriesGridControl")       
          'strTemp= .WPFObject("SourceSeriesGridControl")   
          'Set objTemp = Sys.Process("EdgeClient").FindChild("Name",strTemp,50,True)
          Set objTemp = Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("AdornerDecorator", "", 1).WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("SourceSeriesViewControl").WPFObject("BarManager", "", 1).WPFObject("DockPanel", "", 1).WPFObject("SourceSeriesGridControl")
          intRowCount = objTemp.DataContext.Count
          For IntI = 0 to intRowCount-1
            ActualSeriesID = objTemp.DataContext.Item(IntI).SeriesId
            If Trim(strSeriesID) = Cstr(Trim(ActualSeriesID)) then         
              blnFlag = True
              Call sCloseSWV() 
              Exit For
            End If       
          Next  
      End If
   
    
    If blnFlag = True Then 
      strTCRemarks = strText & strSeriesID  & " is Opened "
      strTestCaseResult = "PASS" 
      log.Message strText & strSeriesID  & " is Opened "
    Else
      Call sCloseSWV() 
      strTCRemarks = strText & strSeriesID  & " is not Opened "
      strTestCaseResult = "PASS" 
      log.Message strText & strSeriesID  & " is not Opened "     
    End IF    
 
  Set objTemp = Nothing   
End Sub

'#######################################################################################################333
'Click on Sereis Series Button
Sub SearchSeriesOption(strOption)
  on Error Resume Next
  Dim strTemp, objTemp
  
  strTemp = "WPFObject(""ContentControl"", ""Series"", 1)"
  Call sObjClick(strTemp)  
  'Call SClosesource()
     
  Select Case strOption
         Case "Reference"
              strTemp = "WPFObject(""ContentControlEx"", ""Search for Reference"", 2)"              
         Case "Layout"
               strTemp = "WPFObject(""ContentControlEx"", ""Search on Layout"", 2)" 
         Case Else
              strTemp = "WPFObject(""ContentControlEx"", ""Search on Source Tree"", 2)"
              
        ' Case "Source"              
'        ' Case "STP"
'              strTemp = "WPFObject(""ContentControlEx"", ""Search on Source Tree"", 2)"
'         Case "CNSTP"
'              strTemp = "WPFObject(""ContentControlEx"", ""Search on Source Tree"", 2)"
  End Select
  
  Call sobjClick(strTemp)
  Delay 5000 , "Please wait for is loading"
  Set objTemp = Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1)
  log.message objTemp.ActualCaption + " Window is Opened"  
    
End Sub
'*********************************************************************************************************************

Sub sSeries_Search_Delay()

  On Error Resume Next
  Dim objEdgeWait,strTemp,objTemp
  Set objCell =Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("Grid", "", 1).WPFObject("GridControl").WPFObject("GridView").WPFObject("HierarchyPanel", "", 1).WPFObject("RowControl", "", 1).WPFObject("CellsControl", "", 1).WPFObject("LightweightCellEditor", "", 1).WaitChild("WPFObject(""InplaceBaseEdit"", """", 1)",60000)
  strTemp = "WPFObject(""GridControl"")"
  Set objTemp=  Sys.Process("EdgeClient").FindChild("Name", strTemp, 50, True)  
  Call objTemp.ClickCell(0, "Series Id")    
  Do until objTemp.get_CurrentCellValue <> ""      
      Delay 1000,"Pls Wait... Form is loading..." 
      Set objCell =Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("BarManager", "", 1).WPFObject("Grid", "", 1).WPFObject("GridControl").WPFObject("GridView").WPFObject("HierarchyPanel", "", 1).WPFObject("RowControl", "", 1).WPFObject("CellsControl", "", 1).WPFObject("LightweightCellEditor", "", 1).WaitChild("WPFObject(""InplaceBaseEdit"", """", 1)",60000)
      if objCell.Exists Then 
        Call objTemp.ClickCell(0, "Series Id") 
        Exit Do
      End If
  Loop     
End Sub
'*********************************************************************************************************************

Function fVerifyCNSTPFile(strTestDataFile, STPSheetName)
   On Error Resume Next
  
  Dim strTemp, objTemp, NetUIHWND, blnFlag1,blnFlag2
  
  objArray = Sys.FindAllChildren("ProcessName","EXCEL", 1,True)
  For i=0 to ubound(objArray)
    log.Message objArray(i).FullName
    set oSTP_ExcelObj = objArray(i).FindChild("WndCaption", "*" & strTestDataFile & "*",1,True)
    If oSTP_ExcelObj.Exists = True Then
      strAliasName=objArray(i).mappedname
      strFileName=oSTP_ExcelObj.WndCaption
      If instr(strFileName,"Microsoft Excel")>0 then
        strFileName=GetFileName(strFileName,"Microsoft Excel")
      Else
        strFileName=GetFileNameExcel13(strFileName," - Excel")
      End If
      FilePath = aqEnvironment.GetEnvironmentVariable("USERPROFILE") & "\Documents\Edge\EdgeAddinStorage\" & aqConvert.DateTimeToFormatStr(aqDateTime.Today,"%Y-%m-%d")
      FilePath=FilePath & "\" & iif(instr(strFileName,"xlsx") > 0,strFileName,strFileName & ".xlsx")  
      log.Message FilePath
      Exit For
    Else
      log.Message "STP file not found in " & objArray(i).FullName
    End If
  Next
  
  Set objSTPXls=GetObject(FilePath)
  With objSTPXls
    With .Sheets(STPSheetName).Select
    End With
  
    With .WorkSheets(STPSheetName)      
        lastColumn=.UsedRange.Columns.Count 
         For inti = 1 to lastColumn
          strText=.Cells(2,inti)
          If UCASE(strText)=UCase("Source Name [Eng]") then 
            fVerifyCNSTPFile = True
            Exit For
           End If
          Next
    End With
  End With 
End Function
'##########################################File Repository##########################################################
'Testcase:TC_SeriesSearch_1-6:Verify Serached Series Id appeared 
Function fOpenFileRep()
  On Error Resume Next
  Dim strTemp , objTemp 
  
  strEnvi = "Edge ( US Integration )"
  
  'Close all opened Window
  strTemp = "WPFObject(""LayoutPanel"", """", 1)"
  Set objTemp = Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).FindChild("Name",strTemp,10,True)
  If objTemp.Exists then 
    Call SClosesource()
    Delay 2000
  End If
  
  'Click on file Reposioty Button 
  strTemp = "WPFObject(""ContentControl"", ""Repository"", 2)"
  Call sObjClick(strTemp)
  Call sEdgeProcessor()
  
  strTemp = "WPFObject(""TextBlock"", ""File Repository"", 1)"
  Set objTemp = Sys.Process("EdgeClient").FindChild("Name",strTemp,50,True)
  If objTemp.get_Text = "File Repository" Then 
    log.message "File Reposiotry Module is opened"
  Else
    Log.Message "File Reposiotry Module is not opened"
  End If
  
End Function
'*********************************************************************************************************************

Sub sExportFootNote(strParameters)
  On Error Resume Next
  Dim strTemp, objTemp, objCombobox, intColumnNumber,intRownumber
  
  strCountry = getSplitValue(strParameters,"Country")
  strDescription = getSplitValue(strParameters,"Description")
  strFolderName = getSplitValue(strParameters,"FolderName")
  
'  strCountry = "Test"
'  strDescription = "v9.11 footnote.htm"
'  FolderName = "v9.11 footnote"  
'  strEnvi = "Edge ( US Integration )"
  
  'Open the File Repository Module
   Call fOpenFileRep()
     
  'Select the Required Country
  Call fSelectCountry(strCountry)
  Call sEdgeProcessor()
  Delay 5000
  
  'Select File Location
   FilePath = aqEnvironment.GetEnvironmentVariable("USERPROFILE") & "\My Documents\Edge\FileRepository\" & aqConvert.DateTimeToFormatStr(aqDateTime.Today,"%Y-%m-%d")
   'msgbox FilePath
   aqFileSystem.CreateFolder(FilePath)   
  ' msgbox FilePath
   Call sChooseLocation(FilePath)
  Delay 200
  'Select the FOOTNOTE
  strTemp = "WPFObject(""FileRepositoryTableControl"")"
  Set objTemp = Sys.Process("EdgeClient").FindChild("Name",strTemp,60,True)
  
  For intI= 0 to objTemp.wColumnCount-1
    if objTemp.wColumn(intI)= "Description" Then 
      intColumnNumber = intI
      Delay 200      
      Exit For
    End If
  Next
  For intI = 0 to objTemp.wRowCount-1
    if objTemp.wValue(intI, intColumnNumber)= strDescription Then
      intRownumber = intI     
      Exit For 
    End if 
  Next
  
  delay 200
  msgbox intRownumber
  Call objTemp.SelectItem(intRownumber)
  
  'Click on 'Export Selected' 
  strTemp = "WPFObject(""ContentControlEx"", ""Export Selected"", 2)"
  Call sObjClick(strTemp)  
  Delay 200
  'click on OK Button 
  Set objTemp = Sys.Process("EdgeClient").WPFObject("HwndSource: CustomMessageBoxWindow", "Export File Repository").WPFObject("CustomMessageBoxWindow", "Export File Repository", 1).WPFObject("Grid", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_ContentOffset").WPFObject("Grid", "", 1).WPFObject("PART_ContainerContent").WPFObject("Grid", "", 1).WPFObject("Grid", "", 2).WPFObject("DockPanel", "", 1).WPFObject("Button_OK").WPFObject("RenderContentPresenterElement", "", 1).WaitChild("WPFObject(""Label_Ok"")",180000)
  objTemp.Click
  
  'Validate Exported FootNote

  Set foundFolders  = aqFileSystem.FindFolders(FilePath, strFolderName)
  If Not foundFolders  Is Nothing Then
  While foundFolders.HasNext
       Set aFolder = foundFolders.Next
       strTCRemarks = "The Selected FootNote "+ strDescription + " is Exported"
       strTestCaseResult = "PASS" 
       log.Message "The Selected FootNote "+ strDescription + " is Exported"
  Wend
  Else
      strTCRemarks = "The Selected FootNote "+ strDescription + " is not Exported"
      strTestCaseResult = "FAIL" 
      Log.Message "The Selected FootNote "+ strDescription + " is not Exported"
  End If   
  
End Sub



'*********************************************************************************************************************88

'Function to seledct Country 
Function fSelectCountry(strCountry)
  
  on Error Resume Next
  
  'strEnvi = "Edge ( US Integration )"  
  
	Set objCombobox = Sys.Process("EdgeClient").WPFObject("HwndSource: Shell", ""& strEnvi &"").WPFObject("Shell", ""& strEnvi &"", 1).WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("Grid", "", 1).WPFObject("PART_RibbonLayout").WPFObject("Part_WindowContent").WPFObject("Grid", "", 1).WPFObject("ContentControl", "", 1).WPFObject("PART_ContainerContent").WPFObject("BarManager").WPFObject("DockPanel", "", 1).WPFObject("DockLayoutManager").WPFObject("LayoutGroup", "", 1).WPFObject("LayoutPanel", "", 1).WPFObject("LayoutPanelContentPresenter", "", 1).WPFObject("Root").WPFObject("Adorner").WPFObject("AdornedControl", "", 1).WPFObject("Grid", "", 1).WPFObject("WrapPanel", "", 1).WPFObject("StackPanel", "", 1).WPFObject("ComboBox", "", 1)
  objCombobox.DropDown
  Call objCombobox.Keys(strCountry)
  Delay(500)
  Call objCombobox.Keys("[Enter]") 
  
  Set objCombobox = Nothing 
End Function

'*********************************************************************************************************************
'Chose the Location

Function sChooseLocation(strLocation)
  On Error Resume Next
  
  Dim strTemp, objTemp
  strTemp ="WPFObject(""TextBox"", """", 1)"
  'strLocation = "C:\Users\rchethana\Documents\EDGE Automation\EDGE\EdgeFileRepository"
  Set objTemp = Sys.Process("EdgeClient").FindChild("Name",strTemp,60,True)
  Call objTemp.set_Text("")
  Call objTemp.set_Text(strLocation)
  Delay(500)
  'Call objTemp.Keys("[Enter]") 
  
  Set objTemp = Nothing 
End Function


